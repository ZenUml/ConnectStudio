//HEAD 
window["GLOBAL_TEMPLATES"] = {};

window["GLOBAL_TEMPLATES"]["src/html/admin/contact-flows/edit.html"] = "\n" +
    "<div id=\"angularContainer\" ng-controller=\"ContactFlowsController\" class=\"paper-div\"\n" +
    "     ng-init=\"initializeContactFlow();\"\n" +
    "     style=\"display:none\">\n" +
    "    \n" +
    "<script type=\"text/ng-template\" id=\"_transferToQueue.html\">\n" +
    "    <div class=\"queue-selection-box\">\n" +
    "        <label>\n" +
    "            <input type=\"checkbox\" ng-model=\"modalData.setOptionalQueue\" data-test-id=\"flow-editor-set-optional-queue\"/>\n" +
    "            <span class=\"title\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-queue-to-check-label\"] }}\n" +
    "            </span>\n" +
    "        </label>\n" +
    "        <div ng-if=\"modalData.setOptionalQueue\" class=\"indented-modal-div\">\n" +
    "            <ng-include src=\"'_dynamicQueue.html'\"></ng-include>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_dynamicQueue.html\">\n" +
    "    <div>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.byAgentQueue\" ng-value=\"false\" ng-change=\"resetQueueValue()\" data-test-id=\"flow-editor-queue-selector-is-queue\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-dynamic-queue-by-queue-label\"] }}\n" +
    "        </label>\n" +
    "\n" +
    "            <div ng-if=\"!modalData.byAgentQueue\" class=\"indented-modal-div\" data-test-id=\"flow-editor-queue-selector-is-queue-content\">\n" +
    "            <ng-include src=\"'_dynamicQueueSelector.html'\"></ng-include>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.byAgentQueue\" ng-value=\"true\" ng-change=\"resetQueueValue()\" data-test-id=\"flow-editor-queue-selector-is-agent\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-dynamic-queue-by-agent-label\"] }}\n" +
    "        </label>\n" +
    "\n" +
    "            <div ng-if=\"modalData.byAgentQueue\" class=\"indented-modal-div\" data-test-id=\"flow-editor-queue-selector-is-agent-content\">\n" +
    "            <ng-include src=\"'_agentQueueSelector.html'\"></ng-include>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_agentQueueSelector.html\">\n" +
    "    <label>\n" +
    "        <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\" data-test-id=\"flow-editor-form-dynamic-false\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-dynamic-queue-by-agent-selector-label\"] }}\n" +
    "    </label>\n" +
    "    <div ng-if=\"!modalData.useDynamic\" data-test-id=\"flow-editor-form-dynamic-false-content\">\n" +
    "        <agent-queue-selector ng-model=\"modalData.queue\" class=\"cf-multi-selector-one-row cf-multiple-options-container input-large form-control\"></agent-queue-selector>\n" +
    "    </div>\n" +
    "    <label class=\"cf-dynamic-option\">\n" +
    "        <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"true\" data-test-id=\"flow-editor-form-dynamic-true\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-queue-select-dynamically\"] }}\n" +
    "    </label>\n" +
    "    <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamic\" data-test-id=\"flow-editor-form-dynamic-true-content\">\n" +
    "        <flow-attribute-selector attribute=\"modalData.queueDynamic\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_dynamicQueueSelector.html\">\n" +
    "    <label>\n" +
    "        <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\" data-test-id=\"flow-editor-form-dynamic-false\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-select-a-queue-label\"] }}\n" +
    "    </label>\n" +
    "    <div ng-if=\"!modalData.useDynamic\" data-test-id=\"flow-editor-form-dynamic-false-content\">\n" +
    "        <skillselect ng-model=\"modalData.queue\" class=\"cf-multi-selector-one-row cf-multiple-options-container input-large form-control\"></skillselect>\n" +
    "    </div>\n" +
    "    <label class=\"cf-dynamic-option\">\n" +
    "        <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"true\" data-test-id=\"flow-editor-form-dynamic-true\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-queue-select-dynamically\"] }}\n" +
    "    </label>\n" +
    "    <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamic\" data-test-id=\"flow-editor-form-dynamic-true-content\">\n" +
    "        <flow-attribute-selector attribute=\"modalData.queueDynamic\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_dynamicChannelSelector.html\">\n" +
    "    <label>\n" +
    "        <input type=\"radio\" ng-model=\"modalData.isChannelDynamic\" ng-value=\"false\" ng-change=\"resetChannelValue()\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-get-metric-data-set-channel-manually-label\"] }}\n" +
    "    </label>\n" +
    "    <div ng-if=\"!modalData.isChannelDynamic\" class=\"indented-modal-div\">\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.selectedChannel\" value=\"{{channelType.VOICE}}\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-metric-data-voice-channel-label\"] }}\n" +
    "        </label>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.selectedChannel\" value=\"{{channelType.CHAT}}\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-metric-data-chat-channel-label\"] }}\n" +
    "        </label>\n" +
    "        <label ng-if=\"$root.globals['isQueueMetricsTaskChannelEnabled']\">\n" +
    "            <input type=\"radio\" ng-model=\"modalData.selectedChannel\" value=\"{{channelType.TASK}}\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-metric-data-task-channel-label\"] }}\n" +
    "        </label>\n" +
    "    </div>\n" +
    "    <label class=\"cf-dynamic-option\">\n" +
    "        <input type=\"radio\" ng-model=\"modalData.isChannelDynamic\" ng-value=\"true\" ng-change=\"resetChannelValue()\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attribute-label\"] }}\n" +
    "    </label>\n" +
    "    <div class=\"cf-multiple-options-container\" ng-if=\"modalData.isChannelDynamic\">\n" +
    "        <flow-attribute-selector attribute=\"modalData.channelDynamic\" namespace=\"modalData.channelNamespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_enqueueModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        <p>\n" +
    "            <span ng-if=\"contactFlowType === contactFlowTypes.CUSTOMER_QUEUE\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-and-callback-with-queue-selector-title\"] }}\n" +
    "            </span>\n" +
    "\n" +
    "            <span ng-if=\"contactFlowType !== contactFlowTypes.CUSTOMER_QUEUE\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-and-callback-title\"] }}\n" +
    "            </span>\n" +
    "\n" +
    "            <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/transfer-to-queue\" target=\"_blank\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "            </a>\n" +
    "        </p>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <span ng-if=\"contactFlowType !== contactFlowTypes.CUSTOMER_QUEUE\">\n" +
    "            <div class=\"cf-tab-display\" ng-click=\"setIsCallBackEnqueue(false)\" ng-class=\"{'cf-tab-display-active': !isCallBackEnqueue()}\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-transfer-to-queue\"] }}\n" +
    "            </div>\n" +
    "            <div class=\"cf-tab-display\" ng-click=\"setIsCallBackEnqueue(true)\"  ng-class=\"{'cf-tab-display-active': isCallBackEnqueue()}\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-transfer-to-callback-queue\"] }}\n" +
    "            </div>\n" +
    "        </span>\n" +
    "\n" +
    "        <!-- Clean up this once we enable the queue transfer in queueTransfer contact flow type -->\n" +
    "        <span ng-if=\"contactFlowType === contactFlowTypes.CUSTOMER_QUEUE\">\n" +
    "            <div class=\"cf-tab-display\" ng-click=\"setIsCallBackEnqueue(false)\" ng-class=\"{'cf-tab-display-active': !isCallBackEnqueue()}\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-transfer-to-queue\"] }}\n" +
    "            </div>\n" +
    "            <div class=\"cf-tab-display\" ng-click=\"setIsCallBackEnqueue(true)\"  ng-class=\"{'cf-tab-display-active': isCallBackEnqueue()}\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-transfer-to-callback-queue\"] }}\n" +
    "            </div>\n" +
    "        </span>\n" +
    "\n" +
    "        <div ng-show=\"!isCallBackEnqueue()\">\n" +
    "\n" +
    "            <p ng-if=\"contactFlowType === contactFlowTypes.CUSTOMER_QUEUE\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-with-queue-selector-description\"] }}\n" +
    "            </p>\n" +
    "\n" +
    "            <p ng-if=\"contactFlowType !== contactFlowTypes.CUSTOMER_QUEUE\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-description\"] }}\n" +
    "            </p>\n" +
    "\n" +
    "            <label>{{ $root.localizedStrings[\"lily-admin-contact-flow-outputs-label\"] }}</label>\n" +
    "            <div>\n" +
    "                <ul>\n" +
    "                    <li ng-if=\"contactFlowType === contactFlowTypes.CUSTOMER_QUEUE\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-success-label\"] }}\n" +
    "                    </li>\n" +
    "                    <li>{{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-at-capacity-label\"] }}</li>\n" +
    "                    <li>{{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-error-label\"] }}</li>\n" +
    "                </ul>\n" +
    "            </div>\n" +
    "            \n" +
    "            <!--\n" +
    "            Uncomment the below snippet once we enable the queue transfer in \n" +
    "            queueTransfer contact flow \n" +
    "            <span ng-if=\"contactFlowType !== contactFlowTypes.CUSTOMER_QUEUE\">\n" +
    "                <ng-include src=\"'_transferToQueue.html'\"></ng-include>\n" +
    "            </span>\n" +
    "            -->\n" +
    "\n" +
    "        <span ng-if=\"contactFlowType === contactFlowTypes.CUSTOMER_QUEUE\">\n" +
    "            <label class=\"label-spacing\">\n" +
    "                <span class=\"title\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-transfer-to-queue-label\"] }}:\n" +
    "                </span>\n" +
    "            </label>\n" +
    "                <div class=\"transfer-queue-selector\">\n" +
    "                <ng-include src=\"'_dynamicQueue.html'\"></ng-include>\n" +
    "            </div>\n" +
    "        </span>\n" +
    "\n" +
    "        </div>\n" +
    "        <div ng-show=\"isCallBackEnqueue()\">\n" +
    "            <p>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-callback-description\"] }}\n" +
    "            </p>\n" +
    "\n" +
    "            <table class=\"full-width\">\n" +
    "                <tbody class=\"cf-table-contents\">\n" +
    "                <tr class=\"cf-label-container\">\n" +
    "                    <td colspan=\"3\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-initial-delay\"] }}\n" +
    "                    </td>\n" +
    "                </tr>\n" +
    "                <tr class=\"cf-label-container\">\n" +
    "                    <td colspan=\"3\">\n" +
    "                        <input class=\"cf-edit-input modal-input\" type=\"number\" min=\"1\" ng-model=\"modalData.initialDelaySec\">\n" +
    "                        <label class=\"cf-input-description\">{{ $root.localizedStrings[\"lily-admin-contact-flow-in-seconds\"] }}</label>\n" +
    "                    </td>\n" +
    "                </tr>\n" +
    "                <tr>\n" +
    "                    <td>\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-maximum-amount-of-attempts-label\"] }}\n" +
    "                    </td>\n" +
    "                    <td colspan=\"2\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-minimum-time-between-attempts\"] }}\n" +
    "                    </td>\n" +
    "                </tr>\n" +
    "                <tr>\n" +
    "                    <td>\n" +
    "                        <input class=\"cf-edit-input modal-input\" type=\"number\" min=\"0\" ng-model=\"modalData.maxAmountOfRetries\">\n" +
    "                    </td>\n" +
    "                    <td>\n" +
    "                        <input class=\"cf-edit-input modal-input-medium\" type=\"number\" min=\"0\" ng-model=\"modalData.retryDelayMinPart\">\n" +
    "                        <label class=\"cf-input-description\">{{ $root.localizedStrings[\"lily-admin-contact-flow-minutes\"] }}</label>\n" +
    "                    </td>\n" +
    "                    <td>\n" +
    "                        <input class=\"cf-edit-input modal-input-medium\" type=\"number\" min=\"0\" max=\"60\" ng-model=\"modalData.retryDelaySecPart\">\n" +
    "                        <label class=\"cf-input-description\">{{ $root.localizedStrings[\"lily-admin-contact-flow-seconds\"] }}</label>\n" +
    "                    </td>\n" +
    "                </tr>\n" +
    "                </tbody>\n" +
    "            </table>\n" +
    "            <br/>\n" +
    "            <div class=\"cf-section-label cf-multi-column-header\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-optional-parameters-label\"] }}\n" +
    "            </div>\n" +
    "            <label>\n" +
    "                <input type=\"checkbox\" ng-model=\"modalData.setOptionalQueue\"/>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-enqueue-set-queue-label\"] }}\n" +
    "            </label>\n" +
    "            <div ng-if=\"modalData.setOptionalQueue\" class=\"indented-modal-div\">\n" +
    "                <ng-include src=\"'_dynamicQueue.html'\"></ng-include>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\" ng-disabled=\"enqueueModuleHasInputErrors()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setQueueModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-queue-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-queue-title\"] }}\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"modal-detail\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-queue-detail\"] }}\n" +
    "            <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-working-queue\" target=\"_blank\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "            </a>\n" +
    "        </div>\n" +
    "        <div class=\"cf-section-label modal-options-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-outputs-label\"] }}\n" +
    "        </div>\n" +
    "        <ng-include src=\"'_dynamicQueue.html'\"></ng-include>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_checkQueueStatusModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-check-queue-attr-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-check-queue-attr-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/check-queue-status\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"cf-section-label modal-options-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-outputs-label\"] }}\n" +
    "        </div>\n" +
    "        <ul data-test-id=\"flow-editor-transfer-to-queue-conditions\">\n" +
    "            <li class=\"cf-list-container-element cf-section-container-header cf-list-no-bullets\" ng-repeat=\"condition in modalData.conditions track by $index\" data-test-id=\"{{ 'flow-editor-transfer-to-queue-condition-' + $index }}\">\n" +
    "                <select class=\"cf-select-output-option modal-input modal-input-header\" ng-model=\"condition.attribute\" ng-options=\"attr as attr.name for attr in checkQueueStatusAttributes track by attr.name\" data-test-id=\"flow-editor-transfer-to-queue-condition-type\"></select>\n" +
    "                <div class=\"cf-element-container\">\n" +
    "                    <div ng-if=\"condition.attribute.name === $root.localizedStrings['lily-admin-contact-flow-queue-capacity']\">\n" +
    "                        <button class=\"close-button cf-left-button-container-element modal-input\" ng-click=\"modalData.conditions.splice($index, 1)\" data-test-id=\"flow-editor-transfer-to-queue-condition-delete\">x</button>\n" +
    "                        <select class=\"cf-select-output-option modal-input\" ng-model=\"condition.operator\" ng-options=\"op as op.name for op in numericComparatorConditions track by op.name\" data-test-id=\"flow-editor-transfer-to-queue-condition-operator\"></select>\n" +
    "                        <input class=\"cf-input-with-multi-options cf-edit-input modal-input\" ng-model=\"condition.value\" placeholder=\"value\" data-test-id=\"flow-editor-transfer-to-queue-condition-value\">\n" +
    "                    </div>\n" +
    "                    <div class=\"time-in-queue\" ng-if=\"condition.attribute.name === $root.localizedStrings['lily-admin-contact-flow-time-in-queue']\">\n" +
    "                        <button class=\"close-button cf-left-button-container-element modal-input\" ng-click=\"modalData.conditions.splice($index, 1)\" data-test-id=\"flow-editor-transfer-to-queue-condition-delete\">x</button>\n" +
    "                        <select class=\"cf-select-output-option modal-input\" ng-model=\"condition.operator\" ng-options=\"op as op.name for op in numericComparatorConditions track by op.name\" data-test-id=\"flow-editor-transfer-to-queue-condition-operator\"></select>\n" +
    "                        <input id=\"time-in-queue-time-value\" class=\"cf-input-with-multi-options cf-edit-input modal-input\" ng-model=\"condition.value\" placeholder=\"value\" data-test-id=\"flow-editor-transfer-to-queue-condition-value\">\n" +
    "                        <select id=\"time-options\" class=\"modal-input\" ng-model=\"condition.time\" ng-options=\"time for time in ['millisec.', 'sec.', 'min.', 'hrs.']\" data-test-id=\"flow-editor-transfer-to-queue-condition-unit\"></select>\n" +
    "                    </div>\n" +
    "                    <div class=\"cf-edit-input-error-message\" ng-show=\"condition.value && !isNonNegativeInteger(condition.value)\">\n" +
    "                        <div class=\"cf-edit-input-error-icon\"></div>\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-not-non-negative-integer-input\"] }}\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "            </li>\n" +
    "            <li>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-no-match-option\"] }}\n" +
    "            </li>\n" +
    "            <li>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-error-option\"] }}\n" +
    "            </li>\n" +
    "        </ul>\n" +
    "        <a href=\"#\" ng-click=\"modalData.conditions.push({id: null, attribute: null, operator: null, value: null})\" data-test-id=\"flow-editor-transfer-to-queue-add-condition\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-add-another-condition\"] }}\n" +
    "        </a>\n" +
    "        \n" +
    "        <ng-include src=\"'_transferToQueue.html'\"></ng-include>\n" +
    "\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\" ng-disabled=\"isQueueInvalid() || !methods.validateConditions(modalData.conditions) || areCheckQueueMetricsConditionsInvalid()\" >\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_updateRoutingPriorityModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-adjust-queue-priority-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-adjust-queue-priority-title\"] }}\n" +
    "    </div>\n" +
    "    <div class=\"modal-form\">\n" +
    "        <div class=\"modal-detail\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-adjust-queue-priority-detail\"] }}\n" +
    "            <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/change-routing-priority\" target=\"_blank\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "            </a>\n" +
    "        </div>\n" +
    "        <div class=\"cf-section-label modal-options-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-queue-priority-subtitle\"] }}\n" +
    "        </div>\n" +
    "        <div>\n" +
    "            <select class=\"modal-input\" ng-model=\"modalData.isAdjustPriority\" ng-options=\"op.value as op.name for op in [{name: 'Adjust by time', value: false}, {name: 'Set priority', value: true}]\">\n" +
    "            </select>\n" +
    "            <div ng-if=\"modalData.isAdjustPriority\" class=\"cf-list-container\">\n" +
    "                <input class=\"cf-edit-input modal-input\" type=\"number\" ng-model=\"modalData.adjustValue\">\n" +
    "            </div>\n" +
    "            <div class=\"cf-container-element-section\" ng-if=\"!modalData.isAdjustPriority\">\n" +
    "                <select class=\"modal-input\" ng-model=\"modalData.adjustSign\" ng-options=\"op as op for op in ['+', '-']\"></select>\n" +
    "                <input class=\"cf-input-with-multi-options cf-edit-input modal-input\" type=\"number\" ng-model=\"modalData.adjustValue\">\n" +
    "                <select class=\"cf-container-element-section modal-input\" ng-model=\"modalData.adjustUnit\" ng-options=\"op as op for op in ['seconds', 'minutes']\"></select>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_getMetricDataModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-get-metric-data-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-get-metric-data-title\"] }}\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"modal-detail\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-metric-data-detail\"] }}\n" +
    "            <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/get-queue-metrics\" target=\"_blank\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "            </a>\n" +
    "        </div>\n" +
    "        <div class=\"cf-section-label cf-multi-column-header\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-metric-data-optional-parameters-label\"] }}\n" +
    "        </div>\n" +
    "        <label ng-if=\"$root.globals['isQueueMetricsChannelFilterEnabled']\">\n" +
    "            <input type=\"checkbox\" ng-model=\"modalData.setOptionalChannel\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-metric-data-set-channel-label\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"$root.globals['isQueueMetricsChannelFilterEnabled'] && modalData.setOptionalChannel\" class=\"indented-modal-div\">\n" +
    "            <ng-include src=\"'_dynamicChannelSelector.html'\"></ng-include>\n" +
    "        </div>\n" +
    "        <label>\n" +
    "            <input type=\"checkbox\" ng-model=\"modalData.setOptionalQueue\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-metric-data-set-queue-label\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"modalData.setOptionalQueue\" class=\"indented-modal-div\">\n" +
    "            <ng-include src=\"'_dynamicQueue.html'\"></ng-include>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\" ng-disabled=\"getMetricDataModuleHasInputError()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setRoutingProficiency.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-routing-proficiency-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-routing-proficiency-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-routing-profiency\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "\n" +
    "        <!--Route by agent hierarchy-->\n" +
    "        <label class=\"cf-multi-column-header cf-list-container set-routing-proficiency-column-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-routing-proficiency-section-title-hierarchy\"] }}\n" +
    "        </label>\n" +
    "        <!--Set hierarchy manually-->\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-manually\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"!modalData.useDynamic\">\n" +
    "            <div class=\"cf-multi-selector-one-row cf-multiple-options-container input-large set-routing-proficiency-cascading-drop-downs\" >\n" +
    "                <td>\n" +
    "                    <agentgroupl1select data-placeholder = \"Level One {{levelToDisplay[0]}}\" ng-init = \"initializeL1AgentGroup()\" ng-model=\"modalData.agentHierarchySelection.l1Group\" ng-change=\"reinitializeAgentGroupsOnChange(1)\" style=\"width:100%;\">\n" +
    "                    </agentgroupl1select>\n" +
    "                    <label class=\"cf-input-description\">{{optionalLevelPlaceholder[0]}}</label>\n" +
    "                </td>\n" +
    "            </div>\n" +
    "            <div class=\"cf-multi-selector-one-row cf-multiple-options-container input-large set-routing-proficiency-cascading-drop-downs\" ng-if=\"modalData.agentHierarchySelection.l1Group\">\n" +
    "                <td>\n" +
    "                    <agentgroupl2select data-placeholder = \"Level Two {{levelToDisplay[1]}}\" ng-init = \"initializeL2AgentGroup()\" ng-model=\"modalData.agentHierarchySelection.l2Group\" style=\"width:100%;\">\n" +
    "                    </agentgroupl2select>\n" +
    "                    <label class=\"cf-input-description\">{{optionalLevelPlaceholder[1]}}</label>\n" +
    "                </td>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <!--Set hierarchy dynamically using attributes-->\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"true\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attributes\"] }}\n" +
    "        </label>\n" +
    "        <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamic\">\n" +
    "            <flow-attribute-selector attribute=\"modalData.attribute\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "        </div>\n" +
    "\n" +
    "        <!---Expiration Time--->\n" +
    "        <label class=\"cf-multi-column-header cf-list-container set-routing-proficiency-column-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-routing-proficiency-section-title-expiration-time\"] }}\n" +
    "        </label>\n" +
    "        <div>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-routing-proficiency-expiration-time-title\"] }}\n" +
    "            <br>\n" +
    "            <br>\n" +
    "        </div>\n" +
    "        <div>\n" +
    "            <!--Set Expiration Time manually-->\n" +
    "            <label>\n" +
    "                <input type=\"radio\" ng-model=\"modalData.useDynamicExpirationTime\" ng-value=\"false\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-manually\"] }}\n" +
    "            </label>\n" +
    "            <div ng-if=\"!modalData.useDynamicExpirationTime\">\n" +
    "                <td class=\"cf-multiple-options-container\">\n" +
    "                    <input class=\"cf-edit-input modal-input narrow-numeric cf-multiple-options-container\" type=\"number\" min=\"0\" max=\"600\" ng-model=\"modalData.expirationTime\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-seconds\"] }}\n" +
    "                </td>\n" +
    "                <label class=\"cf-input-description cf-multiple-options-container\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-routing-proficiency-maximum-time\"] }}</label>\n" +
    "            </div>\n" +
    "            <!--Set Expiration Time dynamically using attributes-->\n" +
    "            <label>\n" +
    "                <input type=\"radio\" ng-model=\"modalData.useDynamicExpirationTime\" ng-value=\"true\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attributes\"] }}\n" +
    "            </label>\n" +
    "            <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamicExpirationTime\">\n" +
    "                <flow-attribute-selector attribute=\"modalData.expirationTime\" namespace=\"modalData.namespaceExpirationTime\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\", ng-disabled=\"isSetRoutingAttributeSaveDisabled()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"_checkStaffingModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-check-staffing-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-check-staffing-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/check-staffing\" target=\"_blank\" rel=\"noopener\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "\n" +
    "        <label class=\"cf-multi-column-header\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-check-staffing-status-to-check\"] }}\n" +
    "        </label>\n" +
    "        <select class=\"cf-element-container modal-input\" ng-model=\"modalData.status\" ng-options=\"status as translateStatus(status) for status in statuses\"></select>\n" +
    "        \n" +
    "        <ng-include src=\"'_transferToQueue.html'\"></ng-include>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input ng-disabled=\"isQueueInvalid()\" class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_checkHoursModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-check-hours-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-check-hours-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/check-hours-of-operation\" target=\"_blank\" rel=\"noopener\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"cf-section-label modal-options-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-parameters-label\"] }}\n" +
    "        </div>\n" +
    "        <label class=\"cf-element-container\">\n" +
    "            <input type=\"checkbox\" ng-model=\"modalData.customHours\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-check-staffing-queue-label\"] }}\n" +
    "        </label>\n" +
    "        <hoopselect ng-if=\"modalData.customHours\" ng-model=\"modalData.hours\" class=\"cf-multi-selector-one-row cf-multiple-options-container cf-element-container input-large form-control\"></hoopselect>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_checkContactAttributesModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-check-contact-attributes-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-check-contact-attributes-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/check-contact-attributes\" target=\"_blank\" rel=\"noopener\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form\">\n" +
    "        <table class=\"full-width\">\n" +
    "            <tbody>\n" +
    "            <tr class=\"cf-label-container\">\n" +
    "                <td colspan=\"3\"><label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-check-contact-attributes-source-attribute\"] }}</label></td>\n" +
    "            </tr>\n" +
    "            <tr>\n" +
    "                <td colspan=\"3\">\n" +
    "                    <flow-attribute-selector attribute=\"modalData.attribute\" namespace=\"modalData.namespace\" category=\"modalData.category\"></flow-attribute-selector>\n" +
    "                </td>\n" +
    "            </tr>\n" +
    "            <tr><td colspan=\"3\"><hr></td></tr>\n" +
    "            <tr class=\"cf-list-container cf-label-container\">\n" +
    "                <td colspan=\"3\"><label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-check-contact-attributes-conditions\"] }}</label></td>\n" +
    "            </tr>\n" +
    "            <tr ng-repeat=\"condition in modalData.conditions track by $index\">\n" +
    "                <td class=\"cf-td-first\"><button class=\"close-button modal-input\" ng-click=\"modalData.conditions.splice($index, 1)\">x</button></td>\n" +
    "                <td class=\"cf-td-second\">\n" +
    "                    <select class=\"modal-input\" ng-model=\"condition.operator\" ng-options=\"op as op.name for op in allComparatorConditions track by op.name\" ></select>\n" +
    "                </td>\n" +
    "                <td>\n" +
    "                    <input class=\"cf-edit-input modal-input\" ng-model=\"condition.value\" placeholder=\"value\">\n" +
    "                </td>\n" +
    "            </tr>\n" +
    "            <tr>\n" +
    "                <td colspan=\"2\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-no-match-option\"] }}\n" +
    "                </td>\n" +
    "            </tr>\n" +
    "            </tbody>\n" +
    "        </table>\n" +
    "        <a class=\"cf-element-container\" href=\"#\" ng-click=\"modalData.conditions.push({id: null, operator: null, value: null})\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-check-contact-attributes-add-another-condition\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_distributeByPercentage.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-distribute-by-percentage-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-distribute-by-percentage-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/distribute-by-percentage\" target=\"_blank\" rel=\"noopener\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-distribute-by-percentage-branches\"] }}\n" +
    "        <br>\n" +
    "        <strong>{{getRemainingPercent(modalData.conditions)}}%</strong>\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-distribute-by-percentage-percent-remaining\"] }}\n" +
    "        <table class=\"full-width\">\n" +
    "            <tbody>\n" +
    "            <tr ng-repeat=\"condition in modalData.conditions track by $index\">\n" +
    "                <td>\n" +
    "                    <select class=\"modal-input\" ng-model=\"condition.value\" ng-options=\"num as (num + '%') for num in getAvailablePercent(modalData.conditions, condition)\">\n" +
    "                    </select>\n" +
    "                </td>\n" +
    "                <td><input class=\"cf-edit-input modal-input\" type=\"text\" ng-model=\"condition.name\"></td>\n" +
    "                <td><button class=\"modal-input\" ng-click=\"modalData.conditions.splice($index, 1)\">-</button></td>\n" +
    "            </tr>\n" +
    "            </tbody>\n" +
    "        </table>\n" +
    "        <a class=\"cf-element-container\" ng-if=\"getRemainingPercent(modalData.conditions) > 1\" href=\"#\" ng-click=\"modalData.conditions.push({id: null, percent: {value: 1, display: '1%'}, name: '', value: 1})\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-add-another-percentage\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_loopModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-loop-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-loop-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/loop\" target=\"_blank\" rel=\"noopener\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-loop-numbers\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"!modalData.useDynamic\">\n" +
    "            <input class=\"cf-edit-input cf-multiple-options-container modal-input-medium\" type=\"number\" min=\"0\" max=\"100\" ng-model=\"modalData.loopCount\">\n" +
    "            <label class=\"cf-input-description cf-multiple-options-container\">{{ $root.localizedStrings[\"lily-admin-contact-flow-loop-count-range\"] }}</label>\n" +
    "        </div>\n" +
    "        <label class=\"cf-dynamic-option\">\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"true\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attribute-label\"] }}\n" +
    "        </label>\n" +
    "        <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamic\">\n" +
    "            <flow-attribute-selector attribute=\"modalData.value\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\" ng-disabled=\"isLoopCountInvalid()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_waitModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-module-wait-name\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-module-wait-description\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/wait\" target=\"_blank\" rel=\"noopener\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"modal-detail cf-side-sheet-category-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-wait-attribute-label-timeout\"] }}\n" +
    "        </div>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-manually\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"!modalData.useDynamic\">\n" +
    "            <span class=\"cf-input-side-by-side\">\n" +
    "                <label class=\"cf-input-description cf-multiple-options-container\">{{ $root.localizedStrings[\"lily-admin-contact-flow-timeout-number\"] }}</label>\n" +
    "                <input ng-class=\"{'cf-edit-input-error': isWaitTimeoutExceeded()}\" class=\"cf-edit-input cf-multiple-options-container modal-input-medium\" type=\"number\" min=\"1\" ng-model=\"modalData.timeout.value\">\n" +
    "            </span>\n" +
    "            <span class=\"cf-input-side-by-side\">\n" +
    "                <label class=\"cf-input-description cf-multiple-options-container\">{{ $root.localizedStrings[\"lily-admin-contact-flow-timeout-unit\"] }}</label>\n" +
    "                <select class=\"cf-edit-input cf-multiple-options-container modal-input\" ng-model=\"modalData.timeout.unit\" ng-options=\"op as op.display for op in modalData.units  track by op.value\"></select>\n" +
    "            </span>\n" +
    "            <div class=\"cf-edit-input-error-message\" ng-show=\"isWaitTimeoutExceeded()\">\n" +
    "                <div class=\"cf-edit-input-error-icon\"></div>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-wait-too-large-timeout\"] }}\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <label class=\"cf-dynamic-option\">\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"true\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attribute-label\"] }}\n" +
    "        </label>\n" +
    "        <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamic\">\n" +
    "            <flow-attribute-selector attribute=\"modalData.timeout.value\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "        </div>\n" +
    "        \n" +
    "        <div class=\"modal-detail cf-separator-container cf-side-sheet-category-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-wait-optional-branches\"] }}\n" +
    "        </div>\n" +
    "        <div>\n" +
    "            <label>\n" +
    "                <input type=\"checkbox\" class=\"inline-checkbox\" ng-model=\"modalData.interruptOnCustomerReturn\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-wait-optional-branch-customer-return\"] }}\n" +
    "            </label>\n" +
    "        </div>\n" +
    "        <div ng-if=\"$root.globals['isContinueBranchOnWaitBlockEnabled']\">\n" +
    "            <label>\n" +
    "                <input type=\"checkbox\" class=\"inline-checkbox\" ng-model=\"modalData.continueExecuting\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-wait-optional-branch-continue-execution\"] }}\n" +
    "            </label>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\" ng-disabled=\"isWaitTimeoutInvalid()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"_dialBlockModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-modal-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "         <div class=\"modal-detail\">\n" +
    "            <p class=\"info\">{{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-description\"] }}\n" +
    "                <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/call-phone-number\" target=\"_blank\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "                </a>\n" +
    "            </p>\n" +
    "        </div>\n" +
    "        <!-- TODO: use flow-caller-id directive instead -->\n" +
    "        <div class=\"modal-form-container\">\n" +
    "            <label>\n" +
    "                <input type=\"checkbox\" ng-model=\"modalData.setOptionalCallerId\" \n" +
    "                class=\"modal-form-checkbox\" />\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-caller-id-label\"] }}\n" +
    "            </label>\n" +
    "\n" +
    "            <div ng-if=\"modalData.setOptionalCallerId\">\n" +
    "                 <div class=\"cf-multiple-options-container claimed-phone-number-container\">\n" +
    "                    \n" +
    "                    <label class=\"label-spacing\">\n" +
    "                        <input type=\"radio\" ng-model=\"modalData.callerIdSource\" value=\"claimed\"/>\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-phone-number-header\"] }}\n" +
    "                    </label>\n" +
    "\n" +
    "                    <div class=\"claimed cf-multiple-options-container\" ng-if=\"modalData.callerIdSource == 'claimed'\">\n" +
    "                        <label class=\"phone-number-label cf-section-label modal-options-label\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-phone-number-label\"] }}\n" +
    "                        </label>\n" +
    "                        <td><claimednumberarnselect class=\"dial-block-phone-number-input\" type=\"text\" ng-model=\"modalData.claimedPhoneNumber\"></claimednumberarnselect>\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "\n" +
    "                <div ng-if=\"$root.globals['allowCustomCallerId'] == '1' && (modalData.allowNonE164CallerId = $root.globals['allowNonE164CallerId'])\" class=\"ac-hidden\"></div>\n" +
    "                <div ng-if=\"$root.globals['allowCustomCallerId'] == '1'\" class=\"custom-phone-number-container cf-multiple-options-container\">\n" +
    "                    <label class=\"label-spacing\">\n" +
    "                        <input type=\"radio\" ng-model=\"modalData.callerIdSource\" value=\"custom\"/>\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-custom-phone-number-header\"] }}                    \n" +
    "                    </label>\n" +
    "                    <div class=\"custom cf-multiple-options-container\" \n" +
    "                    ng-if=\"modalData.callerIdSource == 'custom'\">\n" +
    "                        <label class=\"phone-number-label cf-section-label modal-options-label\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-phone-number-label\"] }}\n" +
    "                        </label>\n" +
    "                        <input type=\"text\" ng-model=\"modalData.callerId\" class=\"cf-edit-input dial-block-phone-number-input\">\n" +
    "\n" +
    "                        <div ng-show=\"modalData.invalidPhoneNumber\" class=\"warning-message dial-block-phone-number-input\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-custom-phone-number-format-error\"] }}\n" +
    "                            <a href=\"https://docs.aws.amazon.com/connect/latest/userguide/agentconsole-guide.html#international-calls-ccp\">\n" +
    "                                {{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-learn-more\"] }}\n" +
    "                            </a>\n" +
    "                        </div>\n" +
    "\n" +
    "                        <div ng-show=\"modalData.invalidNonE164PhoneNumber\" class=\"warning-message dial-block-phone-number-input\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-custom-non-e164-phone-number-error\"] }}\n" +
    "                        </div>\n" +
    "\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "\n" +
    "                <div class=\"cf-multiple-options-container dynamic-phone-number-container\">\n" +
    "                    <label class=\"label-spacing\">\n" +
    "                        <input type=\"radio\" ng-model=\"modalData.callerIdSource\" value=\"dynamic\"/>\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attribute-label\"] }}\n" +
    "                    </label>\n" +
    "\n" +
    "                    <div class=\"dynamic cf-multiple-options-container\" ng-if=\"modalData.callerIdSource == 'dynamic'\">\n" +
    "                        <flow-attribute-selector attribute=\"modalData.value\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "                    </div>\n" +
    "                </div> \n" +
    "                \n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\" ng-disabled=\"dialBlockModuleHasInputErrors()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_disconnectModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-disconnect-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-disconnect-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/disconnect-hang-up\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_resumeModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-resume-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-resume-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/end-flow-resume\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "\n" +
    "    <div class=\"modal-form\">\n" +
    "        <div class=\"lily-info-alert\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-resume-desc-bottom\"] }}\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setAttributesModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-screenpop-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-screenpop-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-contact-attributes\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form\">\n" +
    "\n" +
    "        <div class=\"modal-detail\">\n" +
    "            <div class=\"lily-info-alert\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-screenpop-detail\"] }}\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <div class=\"modal-padded cf-container-function\">\n" +
    "            <label class=\"cf-multi-column-header cf-section-label padded-label\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-save-contact-attribute-attribute-to-save\"] }}\n" +
    "            </label>\n" +
    "            <flow-attribute-list attributes=\"modalData.attributes\"\n" +
    "                                 text-add-an-attribute=\"{{ $root.localizedStrings['lily-admin-contact-flow-add-an-attribute'] }}\"\n" +
    "                                 text-add-another-attribute=\"{{ $root.localizedStrings['lily-admin-contact-flow-add-another-attribute'] }}\" ></flow-attribute-list>\n" +
    "            <br><br>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\" ng-disabled=\"methods.setAttributesBlockHasInputErrors(modalData.attributes)\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_transferModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"> </button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/transfer-to-phone-number\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form\">\n" +
    "        <table class=\"full-width indented-modal-div\">\n" +
    "            <tbody class=\"cf-table-contents\">\n" +
    "            <tr>\n" +
    "                <td><label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-external-country-code\"] }}</label></td>\n" +
    "                <td><label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-external-phone-number\"] }}</label></td>\n" +
    "            </tr>\n" +
    "            <tr class=\"cf-small-input\">\n" +
    "                <td>\n" +
    "                    <div>\n" +
    "                        <span class=\"country-code-real-input\" ng-click=\"toggleCountryDropdown()\">\n" +
    "                            <span ng-class=\"selectedCountry.flag\" class=\"country-flag\"></span>\n" +
    "                            {{selectedCountry.code}}\n" +
    "                            <span class=\"dropdown-icon cf-span-padding\" ng-class=\"{'lily-icon-arrow-sort-down-black':!showCountryDropdown, 'lily-icon-arrow-sort-up-black': showCountryDropdown}\"></span>\n" +
    "                        </span>\n" +
    "                        <ul class=\"country-dropdown\" ng-show=\"showCountryDropdown\">\n" +
    "                            <li class=\"country-option\" ng-repeat=\"country in countryList\" ng-click=\"setCountryCode(country)\">\n" +
    "                                <span ng-class=\"country.flag\" class=\"country-flag\"></span>{{country.name}}<span class=\"country-code\">{{country.code}}</span>\n" +
    "                            </li>\n" +
    "                        </ul>\n" +
    "                    </div>\n" +
    "                </td>\n" +
    "                <td>\n" +
    "                    <input class=\"cf-multi-column-header cf-edit-input\" type=\"text\" ng-model=\"modalData.phoneNumber\">\n" +
    "                </td>\n" +
    "            </tr>\n" +
    "            </tbody>\n" +
    "        </table>\n" +
    "        <hr>\n" +
    "        <label class=\"cf-multi-column-header\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flows-transfer-caller-id-hint\"] }}\n" +
    "        </label>\n" +
    "        <table class=\"full-width\">\n" +
    "            <tbody>\n" +
    "            <tr>\n" +
    "                <td>{{ $root.localizedStrings[\"lily-admin-contact-flows-transfer-caller-id-number\"] }}</td>\n" +
    "                <td>{{ $root.localizedStrings[\"lily-admin-contact-flows-transfer-caller-id-name\"] }}</td>\n" +
    "                <td>{{ $root.localizedStrings[\"lily-admin-contact-flows-transfer-timeout-sec\"] }}</td>\n" +
    "            </tr>\n" +
    "            <tr>\n" +
    "                <td><claimednumberarnselect class=\"modal-input\" type=\"text\" ng-model=\"modalData.sourceNumber\"></claimednumberarnselect></td>\n" +
    "                <td><input class=\"cf-small-input-field cf-edit-input modal-input\" type=\"text\" ng-model=\"modalData.sourceName\"></td>\n" +
    "                <td><input class=\"cf-small-input-field cf-edit-input modal-input\" type=\"number\" ng-model=\"modalData.timeoutSec\"></td>\n" +
    "            </tr>\n" +
    "            </tbody>\n" +
    "        </table>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveTransferModal()\" ng-disabled=\"disableSaveExternalTransfer()\" >\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_transferToPhoneNumberWithBlindTransferAndDtmfSupportModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"> </button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-title-withBlindTransfer-support\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/transfer-to-phone-number\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "\n" +
    "        <ng-include src=\"'_transferToPhoneNumberModalPhoneNumberInput.html'\"></ng-include>\n" +
    "\n" +
    "        <br>\n" +
    "        <ng-include src=\"'_transferToPhoneNumberModalTimeoutInput.html'\"></ng-include>\n" +
    "\n" +
    "        <br>\n" +
    "\n" +
    "        <ng-include src=\"'_transferToPhoneNumberModalBlindTransferInput.html'\"></ng-include>\n" +
    "\n" +
    "        <br>\n" +
    "        <div class=\"cf-sub-title\">\n" +
    "            <label>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-optional-parameters-label\"] }}\n" +
    "            </label>\n" +
    "        </div>\n" +
    "\n" +
    "        <ng-include src=\"'_transferToPhoneNumberModalDtmfInput.html'\"></ng-include>\n" +
    "\n" +
    "        <ng-include src=\"'_transferToPhoneNumberModalCallerIdInput.html'\"></ng-include>\n" +
    "\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveTransferModal()\" ng-disabled=\"disableSaveTransferBlockWithDtmfAndBlindTransferSupport()\" >\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "<script type=\"text/ng-template\" id=\"_transferToPhoneNumberModalDtmfInput.html\">\n" +
    "    <label>\n" +
    "        <input type=\"checkbox\" ng-model=\"modalData.dtmf.checked\"\n" +
    "               class=\"modal-form-checkbox\" />\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-send-dtmf\"] }}\n" +
    "    </label>\n" +
    "\n" +
    "\n" +
    "    <div ng-if=\"modalData.dtmf.checked\" class=\"indented-modal-checkbox-div\">\n" +
    "\n" +
    "        <text-input-with-custom-and-dynamic-support namespace=\"modalData.dtmf.namespace\"\n" +
    "                                                    value=\"modalData.dtmf.value\"\n" +
    "                                                    custom-input-validator=\"isValidDtmfDigits(val)\"\n" +
    "                                                    use-custom-label=\"{{ $root.localizedStrings['lily-admin-contact-flow-transfer-dtmf-digits-label'] }}\"\n" +
    "                                                    use-dynamic-label=\"{{ $root.localizedStrings['lily-admin-contact-flow-use-attribute-label'] }}\"\n" +
    "                                                    custom-input-validation-error-message=\"{{ $root.localizedStrings['lily-admin-contact-flow-transfer-valid-dtmf-digits-warn'] }}\" >\n" +
    "        </text-input-with-custom-and-dynamic-support>\n" +
    "\n" +
    "    </div>\n" +
    "</script>\n" +
    "<script type=\"text/ng-template\" id=\"_transferToPhoneNumberModalCallerIdInput.html\">\n" +
    "\n" +
    "    <label>\n" +
    "        <input type=\"checkbox\" ng-model=\"modalData.callerIdNumber.checked\"\n" +
    "               class=\"modal-form-checkbox\" />\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-block-caller-id-number-label\"] }}\n" +
    "    </label>\n" +
    "\n" +
    "    <div ng-if=\"modalData.callerIdNumber.checked\" class=\"indented-modal-checkbox-div\">\n" +
    "        <caller-id-input source=\"modalData.callerIdNumber.source\" namespace=\"modalData.callerIdNumber.namespace\" value=\"modalData.callerIdNumber.value\" ></caller-id-input>\n" +
    "    </div>\n" +
    "\n" +
    "    <label>\n" +
    "        <input type=\"checkbox\" ng-model=\"modalData.callerIdName.checked\"\n" +
    "               class=\"modal-form-checkbox\" />\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flows-transfer-caller-id-name\"] }}\n" +
    "    </label>\n" +
    "    <div ng-if=\"modalData.callerIdName.checked\" class=\"indented-modal-checkbox-div\">\n" +
    "        <text-input-with-custom-and-dynamic-support namespace=\"modalData.callerIdName.namespace\"\n" +
    "                                                    value=\"modalData.callerIdName.value\"\n" +
    "                                                    custom-input-validator=\"!isNullOrUndefinedOrEmpty(val)\"\n" +
    "                                                    use-custom-label=\"{{ $root.localizedStrings['lily-admin-contact-flows-transfer-caller-id-name'] }}\"\n" +
    "                                                    use-dynamic-label=\"{{ $root.localizedStrings['lily-admin-contact-flow-use-attribute-label'] }}\">\n" +
    "                                                    custom-input-validation-error-message=\"{{ $root.localizedStrings['lily-admin-contact-flow-Field-Cannot-be-empty-message'] }}\">\n" +
    "        </text-input-with-custom-and-dynamic-support>\n" +
    "    </div>\n" +
    "\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_transferToPhoneNumberModalTimeoutInput.html\">\n" +
    "\n" +
    "    <div class=\"heading\">\n" +
    "        <label>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flows-transfer-set-timeout\"] }}\n" +
    "        </label>\n" +
    "    </div>\n" +
    "    <div>\n" +
    "        <text-input-with-custom-and-dynamic-support namespace=\"modalData.timeout.namespace\"\n" +
    "                                                    value=\"modalData.timeout.value\"\n" +
    "                                                    use-custom-label=\"{{ $root.localizedStrings['lily-admin-contact-flows-transfer-timeout-sec'] }}\"\n" +
    "                                                    use-dynamic-label=\"{{ $root.localizedStrings['lily-admin-contact-flow-use-attribute-label'] }}\"\n" +
    "                                                    custom-input-default=\"30\"\n" +
    "                                                    custom-input-type=\"number\"\n" +
    "                                                    custom-input-validator=\"isTransferTimeoutValid(val)\"\n" +
    "                                                    custom-input-validation-error-message=\"{{ $root.localizedStrings['lily-admin-contact-flow-timeout-input-error-message'] }}\" >\n" +
    "        </text-input-with-custom-and-dynamic-support>\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_transferToPhoneNumberModalPhoneNumberInput.html\">\n" +
    "\n" +
    "    <div class=\"cf-sub-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-transfer-via\"] }}\n" +
    "    </div>\n" +
    "\n" +
    "    <div>\n" +
    "        <label class=\"label-spacing\">\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-phone-number-number\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"!modalData.useDynamic\">\n" +
    "            <table class=\"full-width indented-modal-div\">\n" +
    "                <tbody class=\"cf-table-contents\">\n" +
    "                <tr>\n" +
    "                    <td><label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-external-country-code\"] }}</label></td>\n" +
    "                    <td><label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-external-phone-number\"] }}</label></td>\n" +
    "                </tr>\n" +
    "                <tr class=\"cf-small-input\">\n" +
    "                    <td>\n" +
    "                        <div class=\"country-dropdown-div\">\n" +
    "                            <span class=\"country-code-real-input\" ng-click=\"toggleCountryDropdown()\">\n" +
    "                                <span ng-class=\"selectedCountry.flag\" class=\"country-flag\"></span>{{selectedCountry.code}}<span class=\"dropdown-icon cf-span-padding dropdown-icon-modal\" ng-class=\"{'lily-icon-arrow-sort-down-black':!showCountryDropdown, 'lily-icon-arrow-sort-up-black': showCountryDropdown}\"></span>\n" +
    "                            </span>\n" +
    "                            <ul class=\"country-dropdown\" ng-show=\"showCountryDropdown\">\n" +
    "                                <li class=\"country-option\" ng-repeat=\"country in countryList\" ng-click=\"setCountryCode(country)\">\n" +
    "                                    <span ng-class=\"country.flag\" class=\"country-flag\"></span>{{country.name}}<span class=\"country-code\">{{country.code}}</span>\n" +
    "                                </li>\n" +
    "                            </ul>\n" +
    "                        </div>\n" +
    "                    </td>\n" +
    "                    <td>\n" +
    "                        <input class=\"cf-multi-column-header cf-edit-input\" type=\"text\" ng-model=\"modalData.phoneNumber\">\n" +
    "                    </td>\n" +
    "                </tr>\n" +
    "                </tbody>\n" +
    "            </table>\n" +
    "        </div>\n" +
    "\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"true\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attribute-label\"] }}\n" +
    "        </label>\n" +
    "\n" +
    "        <div ng-if=\"modalData.useDynamic\">\n" +
    "            <flow-attribute-selector attribute=\"modalData.attribute\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_transferToPhoneNumberModalBlindTransferInput.html\">\n" +
    "\n" +
    "    <div class=\"cf-sub-title\">\n" +
    "        <label>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flows-transfer-resume-flow-after-disconnect\"] }}\n" +
    "        </label>\n" +
    "        <label class=\"cf-section-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flows-transfer-add-timeout-call-failed-and-success-branches\"] }}\n" +
    "        </label>\n" +
    "    </div>\n" +
    "\n" +
    "    <label>\n" +
    "        <input type=\"radio\" ng-model=\"modalData.blindTransfer\" ng-value=\"false\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-yes\"] }}\n" +
    "    </label>\n" +
    "\n" +
    "    <label>\n" +
    "        <input type=\"radio\" ng-model=\"modalData.blindTransfer\" ng-value=\"true\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-no\"] }}\n" +
    "    </label>\n" +
    "\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setLoggingBehaviorModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-logging-behavior-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title modal-title-higher\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-logging-behavior-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-logging-behavior-flow\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <br>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div ng-if=\"!isOrgContactFlowLoggingEnabled\">\n" +
    "            <div class=\"cf-box-style\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-logging-behavior-reminder\"] }}\n" +
    "                <a href=\"https://docs.aws.amazon.com/connect/latest/userguide/contactflow.html#contact-flow-logs\" target=\"_blank\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-set-logging-behavior-learn-more-how-to-enable-logs\"] }}\n" +
    "                </a>\n" +
    "            </div>\n" +
    "            <br>\n" +
    "        </div>\n" +
    "        <label class=\"cf-multi-column-header\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-logging-behavior-option\"] }}</label>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.behavior\" value=\"Enable\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-logging-behavior-option-enable\"] }}\n" +
    "        </label>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.behavior\" value=\"Disable\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-logging-behavior-option-disable\"] }}\n" +
    "        </label>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setRecordingBehaviorModal.html\">\n" +
    "\n" +
    "    <div ng-if=\"$root.globals['isContactLensGAEnabled']\">\n" +
    "        <h3 class=\"modal-header\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-header\"] }}\n" +
    "            <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "        </h3>\n" +
    "        <div class=\"modal-title\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-contact-lens-details\"] }}\n" +
    "        </div>\n" +
    "        <div class=\"modal-form modal-padded\">\n" +
    "            <div class=\"modal-detail\"><strong>{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-recording-header\"] }}</strong></div>\n" +
    "            <div class=\"modal-detail\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-contact-lens-recording-info\"] }}\n" +
    "            </div>\n" +
    "\n" +
    "            <div class=\"modal-detail\">\n" +
    "                <label>\n" +
    "                    <input type=\"radio\" ng-model=\"modalData.on\" ng-value=\"true\" data-test-id=\"flow-editor-set-recording-and-analytics-on-true\">\n" +
    "                    <strong class=\"modal-radio-option\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-recording-on\"] }}\n" +
    "                    </strong>\n" +
    "                </label>\n" +
    "\n" +
    "                <div ng-if=\"modalData.on === true\" class=\"indented-modal-div\">\n" +
    "                    <label>\n" +
    "                        <input type=\"radio\" ng-model=\"modalData.side\" value=\"Both\" data-test-id=\"flow-editor-set-recording-and-analytics-on-true-both\">\n" +
    "                        <strong class=\"modal-radio-option\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-both-sides-agent\"] }}</strong>\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-both-sides-and\"] }}\n" +
    "                        <strong >{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-both-sides-customer\"] }}</strong>\n" +
    "                    </label>\n" +
    "                    <label>\n" +
    "                        <input type=\"radio\" ng-model=\"modalData.side\" value=\"Agent\" data-test-id=\"flow-editor-set-recording-and-analytics-on-true-agent\">\n" +
    "                        <strong class=\"modal-radio-option\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-agent-side\"] }}</strong>\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-agent-side-only\"] }}\n" +
    "                    </label>\n" +
    "                    <label>\n" +
    "                        <input type=\"radio\" ng-model=\"modalData.side\" value=\"Customer\" data-test-id=\"flow-editor-set-recording-and-analytics-on-true-customer\">\n" +
    "                        <strong class=\"modal-radio-option\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-customer-side\"] }}</strong>\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-custmer-side-only\"] }}\n" +
    "                    </label>\n" +
    "                </div>\n" +
    "                <label>\n" +
    "                    <input type=\"radio\" ng-model=\"modalData.on\" ng-value=\"false\" data-test-id=\"flow-editor-set-recording-and-analytics-on-false\">\n" +
    "                    <strong class=\"modal-radio-option\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-recording-off\"] }}\n" +
    "                    </strong>\n" +
    "                </label>\n" +
    "            </div>\n" +
    "\n" +
    "            <hr/>\n" +
    "            <!--        Analytics Section-->\n" +
    "            <label class=\"modal-detail cf-side-sheet-category-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-contact-lens-analytics\"] }}</label>\n" +
    "            <div class=\"modal-detail\">\n" +
    "                <div>\n" +
    "                    <label>\n" +
    "                        <input ng-if=\"modalData.side === 'Both' && modalData.on === true\" type=\"checkbox\" class=\"inline-checkbox ng-pristine ng-valid\" ng-model=\"modalData.analyticsEnabled\" data-test-id=\"flow-editor-set-recording-and-analytics-on-true-customer\">\n" +
    "                        <!-- displays disabled unchecked checkbox -->\n" +
    "                        <input ng-if=\"modalData.side !== 'Both' || modalData.on !== true\" disabled type=\"checkbox\" class=\"inline-checkbox ng-pristine ng-valid\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-contact-lens-analytics-enable-checkbox\"] }}\n" +
    "                    </label>\n" +
    "                    <div ng-if=\"isContactLensRealTimeEnabled\" class=\"modal-detail indented-modal-detail-div\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-enable-description-real-time\"] }}\n" +
    "                        <a href=\"https://docs.aws.amazon.com/connect/latest/adminguide/enable-analytics.html\" target=\"_blank\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "                        </a>\n" +
    "                    </div>\n" +
    "                    <div ng-if=\"!isContactLensRealTimeEnabled\" class=\"modal-detail indented-modal-detail-div\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-enable-description\"] }}\n" +
    "                        <a href=\"https://docs.aws.amazon.com/connect/latest/adminguide/enable-analytics.html\" target=\"_blank\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "                        </a>\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "            <div ng-if=\"modalData.side === 'Both' && modalData.on === true\">\n" +
    "\n" +
    "                    <div class=\"indented-modal-detail-div\" ng-if=\"modalData.analyticsEnabled && modalData.side === 'Both'\">\n" +
    "                        <!-- Analytics type Realtime vs post call -->\n" +
    "                        <div ng-if=\"isContactLensRealTimeEnabled\">\n" +
    "                            <label class=\"cf-dynamic-option\">\n" +
    "                                <input type=\"radio\" ng-model=\"modalData.analyticsMode\" value=\"PostCall\" ng-change=\"methods.analyticsModeChange(modalData)\" data-test-id=\"flow-editor-analytics-mode-post-call-option\"/>\n" +
    "                                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-mode-post-call\"] }}\n" +
    "                            </label>\n" +
    "                            <div class=\"modal-detail indented-modal-detail-div\">\n" +
    "                                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-mode-post-call-description\"] }}\n" +
    "                            </div>\n" +
    "    \n" +
    "                            <label class=\"cf-dynamic-option\">\n" +
    "                                <input type=\"radio\" ng-model=\"modalData.analyticsMode\" value=\"RealTime\"  ng-change=\"methods.analyticsModeChange(modalData)\" data-test-id=\"flow-editor-analytics-mode-real-time-option\"/>\n" +
    "                                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-mode-real-time\"] }}\n" +
    "                            </label>\n" +
    "                            <div class=\"modal-detail indented-modal-detail-div\">\n" +
    "                                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-mode-real-time-description\"] }}\n" +
    "                            </div>\n" +
    "                        </div>\n" +
    "\n" +
    "                        <label class=\"modal-detail label-spacing\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-language\"] }}\n" +
    "                        </label>\n" +
    "                        <label class=\"cf-dynamic-option\">\n" +
    "                            <input type=\"radio\" ng-model=\"modalData.useDynamicLanguage\" ng-value=\"false\" ng-change=\"methods.analyticsLanguageChange(modalData)\" data-test-id=\"flow-editor-analytics-language-use-dynamic-false\"/>\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-manually\"] }}\n" +
    "                        </label>\n" +
    "\n" +
    "                        <div class=\"cf-select-output-option\" ng-if=\"!modalData.useDynamicLanguage && !isContactLensRealTimeEnabled\">\n" +
    "                            <analysislanguageselector style=\"width:100%;max-width:90%;\" ng-model=\"modalData.analysisLanguage\" ng-change=\"methods.analyticsLanguageChange(modalData)\" class=\"form-control awsui\" data-test-id=\"flow-editor-analytics-language-selector\"></analysislanguageselector>\n" +
    "                        </div>\n" +
    "\n" +
    "                        <div class=\"cf-select-output-option\" ng-if=\"!modalData.useDynamicLanguage && isContactLensRealTimeEnabled\">\n" +
    "                            <select ng-model=\"modalData.analysisLanguage\" ng-options=\"methods.getLanguageStringName(voiceId) for voiceId in methods.getSupportedAnalysisLanguage(modalData.analyticsMode)\"  ng-change=\"methods.analyticsLanguageChange(modalData)\" data-test-id=\"flow-editor-analytics-language-selector\"></select>\n" +
    "                        </div>\n" +
    "\n" +
    "                        <label class=\"cf-dynamic-option\">\n" +
    "                            <input type=\"radio\" ng-model=\"modalData.useDynamicLanguage\" ng-value=\"true\" data-test-id=\"flow-editor-analytics-language-use-dynamic-true\"/>\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-dynamic\"] }}\n" +
    "                        </label>\n" +
    "                        <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamicLanguage\">\n" +
    "                            <flow-attribute-selector attribute=\"modalData.analysisLanguageDynamicKey\" namespace=\"modalData.analysisLanguageNamespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "                        </div>\n" +
    "                        <!-- Redact option -->\n" +
    "                        <div>\n" +
    "                            <label>\n" +
    "                                <input type=\"checkbox\" class=\"inline-checkbox ng-pristine ng-valid\"  ng-model=\"modalData.redactionEnabled\" ng-change=\"methods.initializeRedactionOption(modalData)\" ng-disabled=\"!methods.allowRedaction(modalData.useDynamicLanguage, modalData.analysisLanguage, modalData.analyticsMode)\" data-test-id=\"flow-editor-analytics-redaction-checkbox\">\n" +
    "                                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-redact-sensitive-data\"] }}\n" +
    "                            </label>\n" +
    "                            <div class=\"modal-detail indented-modal-detail-div\">\n" +
    "                                <div ng-if=\"!isContactLensRealTimeEnabled\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-redact-sensitive-data-description\"] }}</div>\n" +
    "                                <div ng-if=\"isContactLensRealTimeEnabled\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-redact-sensitive-data-description-real-time\"] }}</div>\n" +
    "                                <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-recording-behavior-redact-data\" target=\"_blank\">\n" +
    "                                    {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "                                </a>\n" +
    "\n" +
    "                                <div ng-if=\"modalData.redactionEnabled\"  data-test-id=\"flow-editor-analytics-redaction-options\">\n" +
    "\n" +
    "                                    <label class=\"cf-dynamic-option\" >\n" +
    "                                        <input type=\"radio\" ng-model=\"modalData.analyticsRedactionOption\" value=\"RedactedAndOriginal\"/>\n" +
    "                                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-redact-get-redact-and-original\"] }}\n" +
    "                                    </label>\n" +
    "                                    <label class=\"cf-dynamic-option\">\n" +
    "                                        <input type=\"radio\" ng-model=\"modalData.analyticsRedactionOption\" value=\"RedactedOnly\"/>\n" +
    "                                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-redact-get-redact-only\"] }}\n" +
    "                                    </label>\n" +
    "                                    <label class=\"cf-dynamic-option\">\n" +
    "                                        <input type=\"radio\" ng-model=\"modalData.analyticsRedactionOption\" value=\"UseDynamic\"/>\n" +
    "                                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-dynamic\"] }}\n" +
    "                                    </label>\n" +
    "                                    <div class=\"cf-multiple-options-container\" ng-if=\"modalData.analyticsRedactionOption == 'UseDynamic'\">\n" +
    "                                        <flow-attribute-selector attribute=\"modalData.analyticsRedactionOptionKey\" namespace=\"modalData.analyticsRedactionOptionNamespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "                                    </div>\n" +
    "                                </div>\n" +
    "\n" +
    "                            </div>\n" +
    "\n" +
    "                        </div>\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <div class=\"modal-buttons modal-footer\">\n" +
    "            <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "            <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div ng-if=\"!$root.globals['isContactLensGAEnabled'] && !$root.globals['isContactAnalyticsFeatureEnabled']\">\n" +
    "        <h3 class=\"modal-header\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-header\"] }}\n" +
    "            <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "        </h3>\n" +
    "        <div class=\"modal-title\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-title\"] }}\n" +
    "            <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-recording-behavior\" target=\"_blank\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "            </a>\n" +
    "        </div>\n" +
    "        <div class=\"cf-section-label modal-form\">\n" +
    "            <label class=\"cf-multi-column-header\">{{ $root.localizedStrings[\"lily-admin-contact-flow-recording-label\"] }}</label>\n" +
    "            <label>\n" +
    "                <input type=\"radio\" ng-model=\"modalData.side\" value=\"None\">\n" +
    "                <strong class=\"modal-radio-option\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-none-side\"] }}</strong>\n" +
    "            </label>\n" +
    "            <label>\n" +
    "                <input type=\"radio\" ng-model=\"modalData.side\" value=\"Both\">\n" +
    "                <strong class=\"modal-radio-option\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-both-sides-agent\"] }}</strong>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-both-sides-and\"] }}\n" +
    "                <strong >{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-both-sides-customer\"] }}</strong>\n" +
    "            </label>\n" +
    "            <label>\n" +
    "                <input type=\"radio\" ng-model=\"modalData.side\" value=\"Agent\">\n" +
    "                <strong class=\"modal-radio-option\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-agent-side\"] }}</strong>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-agent-side-only\"] }}\n" +
    "            </label>\n" +
    "            <label>\n" +
    "                <input type=\"radio\" ng-model=\"modalData.side\" value=\"Customer\">\n" +
    "                <strong class=\"modal-radio-option\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-customer-side\"] }}</strong>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-custmer-side-only\"] }}\n" +
    "            </label>\n" +
    "        </div>\n" +
    "        <div class=\"modal-buttons modal-footer\">\n" +
    "            <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "            <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div ng-if=\"!$root.globals['isContactLensGAEnabled'] && $root.globals['isContactAnalyticsFeatureEnabled']\">\n" +
    "        <h3 class=\"modal-header\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-header\"] }}\n" +
    "            <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "        </h3>\n" +
    "        <div class=\"modal-title\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-details\"] }}\n" +
    "        </div>\n" +
    "        <div class=\"modal-form modal-padded\">\n" +
    "            <div class=\"modal-detail\"><strong>{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-recording-header\"] }}</strong></div>\n" +
    "            <div class=\"modal-detail\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-recording-info\"] }}\n" +
    "            </div>\n" +
    "\n" +
    "            <div class=\"modal-detail\">\n" +
    "                <label>\n" +
    "                    <input type=\"radio\" ng-model=\"modalData.on\" ng-value=\"true\">\n" +
    "                    <strong class=\"modal-radio-option\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-recording-on\"] }}\n" +
    "                    </strong>\n" +
    "                </label>\n" +
    "\n" +
    "                <div ng-if=\"modalData.on === true\" class=\"indented-modal-div\">\n" +
    "                    <label>\n" +
    "                        <input type=\"radio\" ng-model=\"modalData.side\" value=\"Both\">\n" +
    "                        <strong class=\"modal-radio-option\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-both-sides-agent\"] }}</strong>\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-both-sides-and\"] }}\n" +
    "                        <strong >{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-both-sides-customer\"] }}</strong>\n" +
    "                    </label>\n" +
    "                    <label>\n" +
    "                        <input type=\"radio\" ng-model=\"modalData.side\" value=\"Agent\">\n" +
    "                        <strong class=\"modal-radio-option\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-agent-side\"] }}</strong>\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-agent-side-only\"] }}\n" +
    "                    </label>\n" +
    "                    <label>\n" +
    "                        <input type=\"radio\" ng-model=\"modalData.side\" value=\"Customer\">\n" +
    "                        <strong class=\"modal-radio-option\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-customer-side\"] }}</strong>\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-behavior-custmer-side-only\"] }}\n" +
    "                    </label>\n" +
    "                </div>\n" +
    "                <label>\n" +
    "                    <input type=\"radio\" ng-model=\"modalData.on\" ng-value=\"false\">\n" +
    "                    <strong class=\"modal-radio-option\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-recording-off\"] }}\n" +
    "                    </strong>\n" +
    "                </label>\n" +
    "            </div>\n" +
    "\n" +
    "            <hr/>\n" +
    "            <!--        Analytics Section-->\n" +
    "            <label class=\"modal-detail\"><strong>Analytics</strong></label>\n" +
    "            <div class=\"modal-detail\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-info\"] }}\n" +
    "            </div>\n" +
    "\n" +
    "            <div ng-if=\"modalData.side === 'Both' && modalData.on === true\">\n" +
    "                <div class=\"modal-detail cf-side-sheet-category-label\">\n" +
    "                    <div>\n" +
    "                        <label>\n" +
    "                            <input type=\"checkbox\" class=\"inline-checkbox ng-pristine ng-valid\" ng-model=\"modalData.analyticsEnabled\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-enable-checkbox\"] }}\n" +
    "                        </label>\n" +
    "                    </div>\n" +
    "\n" +
    "                    <div ng-if=\"modalData.analyticsEnabled && modalData.side === 'Both'\">\n" +
    "                        <label class=\"modal-detail label-spacing\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-language\"] }}\n" +
    "                        </label>\n" +
    "                        <div>\n" +
    "                            <analysislanguageselector style=\"width:100%;max-width:90%;\" ng-model=\"modalData.analysisLanguage\" class=\"form-control awsui\"></analysislanguageselector>\n" +
    "                        </div>\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <div class=\"modal-buttons modal-footer\">\n" +
    "            <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "            <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "        </div>\n" +
    "    </div>\n" +
    "\n" +
    "\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setCallBackNumberModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-callback-number-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-callback-number-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-callback-number\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form\">\n" +
    "        <label class=\"cf-section-label padded-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-callback-number-use-attributes\"] }}\n" +
    "        </label>\n" +
    "\n" +
    "        <flow-attribute-selector attribute=\"modalData.value\" namespace=\"modalData.namespace\"></flow-attribute-selector>\n" +
    "\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_updateAgentStateModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-agent-status-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-agent-status-title\"] }}\n" +
    "    </div>\n" +
    "    <div class=\"modal-form\">\n" +
    "        <div class=\"modal-detail\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-agent-status-detail\"] }}\n" +
    "            <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/hold-customer-agent\" target=\"_blank\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "            </a>\n" +
    "        </div>\n" +
    "        <label class=\"cf-section-label padded-label options-header-container\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-agent-status\"] }}\n" +
    "        </label>\n" +
    "        <select class=\"modal-input\" ng-model=\"modalData.agentStatus\" ng-options=\"key as value for (key , value) in modalData.agentStatusMap\" ></select>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_transferToFlowModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-to-flow-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-to-flow-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/transfer-to-flow\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"cf-section-label modal-options-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-label\"] }}\n" +
    "        </div>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-select-flow-prompt\"] }}\n" +
    "        </label>\n" +
    "        <publishedcontactflowselect ng-if=\"!modalData.useDynamic\" ng-model=\"modalData.contactFlow\" class=\"cf-multiple-options-container input-large form-control\"></publishedcontactflowselect>\n" +
    "        <label class=\"cf-element-container\">\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"true\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-select-flow-dynamic-prompt\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"modalData.useDynamic\">\n" +
    "            <flow-attribute-selector attribute=\"modalData.value\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "<script type=\"text/ng-template\" id=\"_transferToAgentModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-to-agent-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-to-agent-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/transfer-to-agent-block\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"modal-detail\">\n" +
    "            <div class=\"lily-info-alert\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-transfer-to-agent-detail\"] }}\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setVoiceModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-voice\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form\">\n" +
    "        <table class=\"full-width\">\n" +
    "            <tr>\n" +
    "                <td>{{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-language\"] }}</td>\n" +
    "                <td>{{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-voice\"] }}</td>\n" +
    "            </tr>\n" +
    "            <tr>\n" +
    "                <td><select class=\"modal-input modal-input-wider\" ng-model=\"modalData.language\" ng-init=\"initializeLanguage(modalData.voice)\" ng-change=\"setVoiceOptions(modalData.language, true)\" ng-options=\"lg.code as lg.name for lg in ttsLanguages\" ></select></td>\n" +
    "                <td><select class=\"modal-input\" ng-model=\"modalData.voice\" ng-options=\"voice.id as voice.name for voice in voiceOptions\" ></select></td>\n" +
    "            </tr>\n" +
    "        </table>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setVoiceModalWithNTTSVoices.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-voice\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form\">\n" +
    "        <table class=\"full-width\">\n" +
    "            <tr>\n" +
    "                <td>{{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-language\"] }}</td>\n" +
    "                <td>{{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-voice\"] }}</td>\n" +
    "            </tr>\n" +
    "            <tr>\n" +
    "                <td><select class=\"modal-input modal-input-wider\" ng-model=\"modalData.language\" ng-init=\"initializeLanguage(modalData.voice)\" ng-change=\"setVoiceOptions(modalData.language, true)\" ng-options=\"lg.code as lg.name for lg in ttsLanguages\" ></select></td>\n" +
    "                <td><select class=\"modal-input\" ng-model=\"modalData.voice\" ng-options=\"voice.id as voice.name group by voice.supportedEngines for voice in voiceOptions | orderBy:['-supportedEngines', 'name']\" ></select></td>\n" +
    "            </tr>\n" +
    "        </table>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setVoiceModalWithNTTSConversationalVoices.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-voice\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-language\"] }}\n" +
    "        <select class=\"modal-input long-input\" ng-model=\"modalData.language\" ng-init=\"initializeLanguage(modalData.voice)\" ng-change=\"setVoiceOptions(modalData.language, true)\" ng-options=\"lg.code as lg.name for lg in ttsLanguages\" ></select>\n" +
    "\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-voice\"] }}\n" +
    "        <select class=\"modal-input long-input\" ng-model=\"modalData.voice\" ng-options=\"voice.id as voice.name for voice in voiceOptions\" ng-change=\"resetSelectedVoiceOptions()\"></select>\n" +
    "        <div ng-if=\"methods.allowNeural(modalData.voice)\">\n" +
    "            <label>\n" +
    "                <div class=\"override-default-section\">\n" +
    "                    <input type=\"checkbox\" class=\"override-console-checkbox ng-pristine ng-valid\" ng-model=\"modalData.overrideConsoleVoice\">\n" +
    "                    <div class=\"override-console-voice\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-override-console-voice-settings\"] }}\n" +
    "                        <span>\n" +
    "                            {{methods.getDefaultSpeakingLabel(modalData.voice)}}\n" +
    "                        </span>\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "            </label>\n" +
    "            <div class=\"override-section\" ng-if=\"modalData.overrideConsoleVoice\">\n" +
    "\n" +
    "                <label class=\"label-spacing\">\n" +
    "                    <input class=\"override-option-input\" type=\"radio\" ng-model=\"modalData.useVoiceStyle\" value=\"Neural\" ng-init=\"modalData.useVoiceStyle = (modalData.useVoiceStyle? modalData.useVoiceStyle:'Neural')\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-speaking-style\"] }}\n" +
    "                </label>\n" +
    "                <div ng-if=\"modalData.useVoiceStyle == 'Neural'\">\n" +
    "                    <select class=\"modal-input long-input\" ng-model=\"modalData.speakingStyle\" ng-options=\"methods.speakingStyleStrings[speakingStyle] for speakingStyle in methods.getSupportedSpeakingStyles(modalData.voice)\" ng-init=\"methods.initializeSpeakingStyle(modalData)\">\n" +
    "                    </select>\n" +
    "                </div>\n" +
    "                \n" +
    "\n" +
    "                <label ng-if=\"methods.allowStandard(modalData.voice)\" class=\"label-spacing\">\n" +
    "                    <input class=\"override-option-input\"type=\"radio\" ng-model=\"modalData.useVoiceStyle\" value=\"Standard\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-set-voice-standard\"] }}\n" +
    "                </label>\n" +
    "\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_startMediaStreamingModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-start-media-streaming-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        <p>{{ $root.localizedStrings[\"lily-admin-contact-flow-start-media-streaming-title\"] }}\n" +
    "            <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/start-media-streaming\" target=\"_blank\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "            </a>\n" +
    "        </p>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_startMediaStreamingModalWithFromAndToCustomer.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-start-media-streaming-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        <p>{{ $root.localizedStrings[\"lily-admin-contact-flow-start-media-streaming-title\"] }}\n" +
    "            <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/start-media-streaming\" target=\"_blank\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "            </a>\n" +
    "        </p>\n" +
    "    </div>\n" +
    "\n" +
    "    <div class=\"modal-form modal-detail cf-separator-container cf-side-sheet-category-label\">\n" +
    "        <div class=\"cf-multi-column-header\">\n" +
    "            <b>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-start-media-streaming-streams-to-start\"] }}\n" +
    "            </b>\n" +
    "        </div>\n" +
    "\n" +
    "        <div>\n" +
    "            <label>\n" +
    "                <input type=\"checkbox\" class=\"inline-checkbox ng-pristine ng-valid\" ng-model=\"modalData.fromCustomer\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-start-media-streaming-from-customer\"] }}\n" +
    "            </label>\n" +
    "        </div>\n" +
    "\n" +
    "        <div>\n" +
    "            <label>\n" +
    "                <input type=\"checkbox\" class=\"inline-checkbox ng-pristine ng-valid\" ng-model=\"modalData.toCustomer\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-start-media-streaming-to-customer\"] }}\n" +
    "            </label>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "\n" +
    "    <div class=\"modal-buttons modal-footer ng-scope\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\" ng-disabled=\"disableSaveStartMediaStreaming()\">\n" +
    "        <input class=\"btn btn-default pull right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_stopMediaStreamingModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-stop-media-streaming-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-stop-media-streaming-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/stop-media-streaming\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"_dynamicPrompt.html\">\n" +
    "\n" +
    "    <label>\n" +
    "        <input type=\"radio\" ng-model=\"modalData.useTts\" ng-value=\"false\" data-test-id=\"flow-editor-prompt-form-tts-false\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-select-from-prompt-library\"] }}\n" +
    "    </label>\n" +
    "\n" +
    "    <div ng-if=\"!modalData.useTts\" class=\"indented-modal-div\" data-test-id=\"flow-editor-prompt-form-without-tts\">\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\" data-test-id=\"flow-editor-form-dynamic-false\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-select-a-prompt\"] }}\n" +
    "        </label>\n" +
    "        <div class=\"cf-multiple-options-container\" ng-if=\"!modalData.useDynamic\" data-test-id=\"flow-editor-form-dynamic-false-content\">\n" +
    "            <label>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-prompt-label\"] }}\n" +
    "            </label>\n" +
    "            <promptselect ng-model=\"modalData.prompt\" class=\"cf-multi-selector-one-row input-large form-control\"></promptselect>\n" +
    "        </div>\n" +
    "        <label class=\"cf-dynamic-option\">\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"true\" data-test-id=\"flow-editor-form-dynamic-true\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-select-dynamically\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"modalData.useDynamic\" data-test-id=\"flow-editor-form-dynamic-true-content\">\n" +
    "            <flow-attribute-selector attribute=\"modalData.attribute\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <label>\n" +
    "        <input type=\"radio\" ng-model=\"modalData.useTts\" ng-value=\"true\" data-test-id=\"flow-editor-prompt-form-tts-true\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-tts-override-including-chat\"] }}<br>\n" +
    "\n" +
    "    </label>\n" +
    "    <div ng-if=\"modalData.useTts\" class=\"indented-modal-div\" data-test-id=\"flow-editor-prompt-form-with-tts\">\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\" data-test-id=\"flow-editor-form-dynamic-false\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-enter-text\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"!modalData.useDynamic\" data-test-id=\"flow-editor-form-dynamic-false-content\">\n" +
    "            <textarea ng-model=\"modalData.tts\" class=\"modal-input long-input\" placeholder='{{ $root.localizedStrings[\"lily-admin-contact-flow-tts-label\"] }}'></textarea>\n" +
    "        </div>\n" +
    "        <label class=\"cf-element-container\">\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"true\" data-test-id=\"flow-editor-form-dynamic-true\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-enter-dynamically\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"modalData.useDynamic\" data-test-id=\"flow-editor-form-dynamic-true-content\">\n" +
    "             <flow-attribute-selector attribute=\"modalData.attribute\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "        </div>\n" +
    "        <div>\n" +
    "            <table class=\"full-width\">\n" +
    "                <tbody>\n" +
    "                    <tr>\n" +
    "                        <td><label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-tts-interpret\"] }}</label></td>\n" +
    "                    </tr>\n" +
    "                    <tr>\n" +
    "                        <td>\n" +
    "                            <select class=\"modal-input\" ng-model=\"modalData.ttsType\" ng-options=\"attr.value as attr.name for attr in TextToSpeechType\" data-test-id=\"flow-editor-prompt-form-tts-type\"></select>\n" +
    "                        </td>\n" +
    "                    </tr>\n" +
    "                </tbody>\n" +
    "            </table>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_playAudioModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-play-audio-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-play-audio-title-including-chat\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/play\" target=\"_blank\" rel=\"noopener\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"modal-detail\">\n" +
    "           \n" +
    "        </div>\n" +
    "        <div class=\"cf-section-label modal-options-label modal-options-label-prompt\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-prompt-parameters-label\"] }}\n" +
    "        </div>\n" +
    "        <ng-include src=\"'_dynamicPrompt.html'\"></ng-include>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_loopAudioModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-loop-audio-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-loop-audio-title\"] }}\n" +
    "    </div>\n" +
    "    <div class=\"modal-form\">\n" +
    "        <div class=\"modal-detail\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-loop-audio-detail\"] }}\n" +
    "            <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/loop-prompts\" target=\"_blank\" rel=\"noopener\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "            </a>\n" +
    "        </div>\n" +
    "        <div class=\"cf-section-label cf-section-header modal-options-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-prompts-label\"] }}\n" +
    "        </div> \n" +
    "        <table ng-repeat=\"audio in modalData.audio\" class=\"loop-audio-prompt-info\">\n" +
    "            <tbody>\n" +
    "                <tr>\n" +
    "                    <td class=\"modal-remove-row\"><button class=\"pull-left close-button\" ng-click=\"modalData.audio.splice($index, 1)\">x</button></td>\n" +
    "                    <td><select class=\"modal-input pull-left loop-prompt-modal-input\" ng-model=\"audio.type\" ng-options=\"opt.val as opt.name for opt in [{name: 'Audio recording', val: 'Prompt'}, {name: 'Text to Speech', val: 'Text'}]\"></select></td>\n" +
    "                </tr>\n" +
    "                <tr>\n" +
    "                    <td></td>\n" +
    "                    <td ng-if=\"audio.type === 'Prompt'\"><promptselect class=\"cf-list-container-element pull-left loop-prompt-modal-input modal-input long-input\" ng-model=\"audio.prompt\"></promptselect></td>\n" +
    "                    <td ng-if=\"audio.type === 'Text'\">\n" +
    "                        <div ng-if=\"$root.globals['canTtsLeaveRegion']\">\n" +
    "                            <div class=\"lily-info-alert indented-radio-sub-div\">\n" +
    "                                {{ $root.localizedStrings[\"lily-admin-out-of-region-tts-summary\"] }}\n" +
    "                                <a href=\"https://docs.aws.amazon.com/connect/latest/userguide/contactflow.html#text-to-speech\" target=\"_blank\" rel=\"noopener\">\n" +
    "                                    {{ $root.localizedStrings[\"lily-admin-contact-flow-tts-link\"] }}\n" +
    "                                </a>\n" +
    "                            </div>\n" +
    "                        </div>\n" +
    "                        <a ng-if=\"!$root.globals['canTtsLeaveRegion']\" href=\"https://docs.aws.amazon.com/connect/latest/userguide/contactflow.html#text-to-speech\" target=\"_blank\" rel=\"noopener\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-tts-link\"] }}\n" +
    "                        </a>\n" +
    "                        <textarea ng-model=\"audio.tts\" class=\"cf-tts-input-element cf-list-container modal-input medium-input\" placeholder='{{ $root.localizedStrings[\"lily-admin-contact-flow-tts-label\"] }}'></textarea>\n" +
    "                    </td>\n" +
    "                <tr ng-if=\"audio.type === 'Text'\">\n" +
    "                    <td></td>\n" +
    "                    <td><select class=\"cf-list-container-element cf-list-container modal-input\" ng-init=\"audio.ttsType= audio.ttsType ? audio.ttsType : TextToSpeechType[0].value\" ng-model=\"audio.ttsType\" ng-options=\"attr.value as attr.name for attr in TextToSpeechType\"></select><td>\n" +
    "                </tr>\n" +
    "            </tbody>\n" +
    "        </table>\n" +
    "        <br>\n" +
    "        <a href=\"#\" ng-click=\"modalData.audio.push({type: 'Prompt', prompt: null, text: null, ttsType: 'text'})\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-add-another-prompt-to-sequence\"] }}\n" +
    "        </a>\n" +
    "        <br><br>\n" +
    "        <div ng-if=\"contactFlowType === 'customerQueue'\">\n" +
    "            <div class=\"cf-section-header modal-options-label\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flows-play-loop-interrupt\"] }}\n" +
    "            </div>\n" +
    "            <div class=\"cf-list-container-element\">\n" +
    "                <label class=\"cf-element-right-margin pull-left\" id=\"loop-audio-timeout-label\">\n" +
    "                    <input type=\"checkbox\" ng-model=\"modalData.useTimeout\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flows-play-loop-interrupt-every\"] }}\n" +
    "                </label>\n" +
    "                <input class=\"cf-edit-input\" type=\"number\" id=\"loop-audio-timeout\" ng-model=\"modalData.timeout\">\n" +
    "                <select class=\"cf-input-with-multi-options modal-input\" id=\"loop-audio-timeunit\" ng-options=\"opt as opt.display for opt in modalData.timeoutUnits track by opt.value\" ng-model=\"modalData.timeoutUnit\"></select>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_getUserInputModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-get-dtmf-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-get-dtmf-chat-title\"] }}\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"modal-detail\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-dtmf-detail-both-chat\"] }}\n" +
    "            <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/get-customer-input\" target=\"_blank\" rel=\"noopener\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "            </a>\n" +
    "        </div>\n" +
    "        <ng-include src=\"'_dynamicPrompt.html'\"></ng-include>\n" +
    "        <div class=\"cf-tab-display\" ng-click=\"modalData.useDtmf=true\" ng-class=\"{'cf-tab-display-active': modalData.useDtmf}\">{{ $root.localizedStrings[\"lily-admin-contact-flow-dtmf-tab\"] }}</div>\n" +
    "        <div class=\"cf-tab-display\" ng-click=\"modalData.useDtmf=false\"  ng-class=\"{'cf-tab-display-active': !modalData.useDtmf}\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-tab\"] }}</div>\n" +
    "        <hr class=\"cf-display-horizontal-line\">\n" +
    "        <div class=\"modal-title dtmf-lext-text-container\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-dtmf-detail-both\"] }}\n" +
    "        </div>\n" +
    "        <div class=\"cf-separator-container\"></div>\n" +
    "        <div ng-if=\"modalData.useDtmf\">\n" +
    "            <table class=\"full-width\">\n" +
    "                <tbody>\n" +
    "                <tr>\n" +
    "                    <td>{{ $root.localizedStrings[\"lily-admin-contact-flows-get-dtmf-timeout\"] }}</td>\n" +
    "                </tr>\n" +
    "                <tr>\n" +
    "                    <td>\n" +
    "                        <input class=\"cf-edit-input modal-input narrow-numeric\" type=\"number\" min=\"1\" ng-model=\"modalData.timeoutSec\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-seconds\"] }}\n" +
    "                    </td>\n" +
    "                </tr>\n" +
    "                </tbody>\n" +
    "            </table>\n" +
    "            <ul class=\"cf-list-style-container cf-list-container\">\n" +
    "                <li class=\"cf-list-style\" ng-repeat=\"condition in modalData.dtmfConditions track by $index\">\n" +
    "                    <div class=\"cf-add-conditon-container\">\n" +
    "                        <label>{{ $root.localizedStrings[\"lily-admin-contact-flow-get-dtmf-option\"] }}</label>\n" +
    "                        <button class=\"cf-element-right-margin modal-input close-button\" ng-click=\"modalData.dtmfConditions.splice($index, 1)\">x</button>\n" +
    "                        <input maxlength=\"1\" type=\"text\" pattern=\"[0-9*#]+\" class=\"cf-edit-input modal-input narrow-numeric\" ng-model=\"condition.value\">\n" +
    "                    </div>\n" +
    "                </li>\n" +
    "            </ul>\n" +
    "            <a class=\"cf-link-condition-container\" href=\"#\" ng-click=\"modalData.dtmfConditions.push({id: null, value: null})\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-add-another-condition\"] }}\n" +
    "            </a>\n" +
    "        </div>\n" +
    "            \n" +
    "        <div class=\"lex-section\" ng-if=\"!modalData.useDtmf\">\n" +
    "            <div class=\"header\">\n" +
    "                <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-header-label\"] }}</label>\n" +
    "            </div>\n" +
    "\n" +
    "\n" +
    "            <div class=\"lex-selector-container\" ng-if=\"$root.globals['isLexV2Enabled']\">\n" +
    "                <div>\n" +
    "                    <label>\n" +
    "                        <input type=\"radio\" ng-model=\"modalData.lexBotDropdownSelect\" ng-value=\"true\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-lex-bot-select\"] }}\n" +
    "                    </label>\n" +
    "                    <div class=\"indented-modal-div\" ng-if=\"modalData.lexBotDropdownSelect\">\n" +
    "                        <div class=\"selector\">\n" +
    "                            <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flows-lex-name\"] }}</label>\n" +
    "                            <lexbot-v2-selector class=\"cf-multi-selector-one-row\" ng-model=\"modalData.lexBot\"></lexbot-v2-selector>\n" +
    "                        </div>\n" +
    "\n" +
    "                        <div class=\"alias\">\n" +
    "                            <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flows-lex-alias\"] }}</label>\n" +
    "                            <input class=\"cf-edit-input cf-multi-selector-one-row\" ng-model=\"modalData.lexBotAlias\"></td>\n" +
    "                        </div>\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "                <div class=\"cf-element-container\">\n" +
    "                    <label>\n" +
    "                        <input type=\"radio\" ng-model=\"modalData.lexBotDropdownSelect\" ng-value=\"false\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-enter-arn\"] }}\n" +
    "                    </label>\n" +
    "                    <div ng-if=\"!modalData.lexBotDropdownSelect\" class=\"indented-modal-div\">\n" +
    "                        <label>\n" +
    "                            <input type=\"radio\" ng-model=\"modalData.useDynamicLexBotArn\" ng-value=\"false\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-manually\"] }}\n" +
    "                        </label>\n" +
    "                        <div class=\"cf-element-container\" ng-if=\"!modalData.useDynamicLexBotArn\">\n" +
    "                            <input class=\"cf-edit-input modal-input long-input\" ng-model=\"modalData.lexBotArn\">\n" +
    "                        </div>\n" +
    "                        <label>\n" +
    "                            <input type=\"radio\" ng-model=\"modalData.useDynamicLexBotArn\" ng-value=\"true\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attributes\"] }}\n" +
    "                        </label>\n" +
    "                        <div class=\"cf-element-container\" ng-if=\"modalData.useDynamicLexBotArn\">\n" +
    "                            <flow-attribute-selector></flow-attribute-selector>\n" +
    "                        </div>\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "\n" +
    "            <div class=\"lex-selector-container\" ng-if=\"!$root.globals['isLexV2Enabled']\">\n" +
    "                <div class=\"selector\">\n" +
    "                    <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flows-lex-name\"] }}</label>\n" +
    "                    <lexbot-selector class=\"cf-multi-selector-one-row\" ng-model=\"modalData.lexBot\"></lexbot-selector>\n" +
    "                </div>\n" +
    "\n" +
    "                <div class=\"alias\">\n" +
    "                    <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flows-lex-alias\"] }}</label>\n" +
    "                    <input class=\"cf-edit-input cf-multi-selector-one-row\" ng-model=\"modalData.lexBotAlias\"></td>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "\n" +
    "\n" +
    "\n" +
    "            <div class=\"modal-options-label modal-title-no-padding-left\">\n" +
    "                <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-attributes-label\"] }}</label>\n" +
    "            </div>\n" +
    "\n" +
    "            <flow-attribute-list attributes=\"modalData.variables\"\n" +
    "                                 is-external-integration=\"true\"\n" +
    "                                 text-add-an-attribute=\"{{ $root.localizedStrings['lily-admin-contact-flow-lex-add-an-attribute'] }}\"\n" +
    "                                 text-add-another-attribute=\"{{ $root.localizedStrings['lily-admin-contact-flow-lex-add-another-attribute'] }}\" ></flow-attribute-list>\n" +
    "\n" +
    "\n" +
    "            <hr>\n" +
    "            <div class=\"modal-options-label modal-title-no-padding-left cf-intents-header\">\n" +
    "                <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-intent-label\"] }}</label>\n" +
    "            </div>\n" +
    "            <div class=\"lex-intents-input-container repeated-option\" ng-repeat=\"condition in modalData.lexConditions track by $index\">\n" +
    "                    <button ng-click=\"modalData.lexConditions.splice($index, 1)\" class=\"pull-left close-button svg-button\"></button>\n" +
    "                    <div class=\"cf-indented\">\n" +
    "                        <input class=\"cf-edit-input modal-input\" type=\"text\" ng-model=\"condition.value\"></td>\n" +
    "                    </div>\n" +
    "            </div>\n" +
    "            <a href=\"#\" ng-click=\"modalData.lexConditions.push({id: null, value: null})\">\n" +
    "                <span ng-if=\"modalData.lexConditions.length > 0\" class=\"large-label cf-add-intent\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-add-another-intent\"] }}</span>\n" +
    "                <span ng-if=\"modalData.lexConditions.length === 0\" class=\"large-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-add-an-intent\"] }}</span>\n" +
    "            </a>\n" +
    "            <hr>\n" +
    "            <div ng-if=\"$root.globals['isLexSentimentOverrideEnabled']\" class=\"lex-sentiment-override-container\">\n" +
    "                <div class=\"modal-detail\">\n" +
    "                    <div>\n" +
    "                        <label>\n" +
    "                            <input type=\"checkbox\" class=\"inline-checkbox ng-pristine ng-valid\" ng-model=\"modalData.useLexSentimentOverride\"/>\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-customer-input-lex-sentiment-override\"] }}\n" +
    "                        </label>\n" +
    "                        <div class=\"modal-detail indented-modal-detail-div\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-sentiment-override-detail\"] }}\n" +
    "                            <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/get-customer-input/sentiment-override\" target=\"_blank\" rel=\"noopener\">\n" +
    "                                {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "                            </a>\n" +
    "                            <div class=\"cf-separator-container\"></div>\n" +
    "                            <div ng-if=\"modalData.useLexSentimentOverride\">\n" +
    "                                <ng-include src=\"'_sentimentOverride.html'\"></ng-include>\n" +
    "                            </div>\n" +
    "                        </div>\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\" ng-disabled=\"isGetCustomerInputSaveDisabled()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_sentimentOverride.html\">\n" +
    "    <div class=\"modal-detail\">\n" +
    "        <label>\n" +
    "            <input type=\"checkbox\" ng-model=\"modalData.hasNegativeOverride\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-customer-input-lex-branch-negative-sentiment\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"modalData.hasNegativeOverride\" class=\"indented-modal-div\">\n" +
    "            <ng-include src=\"'_dynamicNegativeThresholdSelector.html'\"></ng-include>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-detail\">\n" +
    "        <label>\n" +
    "            <input type=\"checkbox\" ng-model=\"modalData.hasPositiveOverride\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-customer-input-lex-branch-positive-sentiment\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"modalData.hasPositiveOverride\" class=\"indented-modal-div\">\n" +
    "            <ng-include src=\"'_dynamicPositiveThresholdSelector.html'\"></ng-include>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_dynamicNegativeThresholdSelector.html\">\n" +
    "    <div>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamicNegativeThreshold\" ng-value=\"false\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-customer-input-lex-set-threshold-manual-label\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"!modalData.useDynamicNegativeThreshold\">\n" +
    "            <select class=\"cf-multi-selector-one-row cf-multiple-options-container modal-input\" ng-model=\"modalData.negativeThreshold\" ng-options=\"percent.value as percent.display for percent in modalData.percentOptions\"></select>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div>\n" +
    "        <label class=\"cf-dynamic-option\">\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamicNegativeThreshold\" ng-value=\"true\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-customer-input-lex-set-threshold-dynamic-label\"] }}\n" +
    "        </label>\n" +
    "        <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamicNegativeThreshold\">\n" +
    "            <flow-attribute-selector attribute=\"modalData.negativeThresholdDynamic\" namespace=\"modalData.negativeThresholdNamespace\"></flow-attribute-selector>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_dynamicPositiveThresholdSelector.html\">\n" +
    "    <div>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamicPositiveThreshold\" ng-value=\"false\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-customer-input-lex-set-threshold-manual-label\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"!modalData.useDynamicPositiveThreshold\">\n" +
    "            <select class=\"cf-multi-selector-one-row cf-multiple-options-container modal-input\" ng-model=\"modalData.positiveThreshold\" ng-options=\"percent.value as percent.display for percent in modalData.percentOptions\"></select>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div>\n" +
    "        <label class=\"cf-dynamic-option\">\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamicPositiveThreshold\" ng-value=\"true\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-get-customer-input-lex-set-threshold-dynamic-label\"] }}\n" +
    "        </label>\n" +
    "        <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamicPositiveThreshold\">\n" +
    "            <flow-attribute-selector attribute=\"modalData.positiveThresholdDynamic\" namespace=\"modalData.positiveThresholdNamespace\"></flow-attribute-selector>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_storeUserInputModule.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-title\"] }}\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded cf-options-container\">\n" +
    "        <div class=\"modal-detail\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-detail\"] }}\n" +
    "            <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/store-customer-input\" target=\"_blank\" rel=\"noopener\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "            </a>\n" +
    "        </div>\n" +
    "        <div class=\"cf-section-label modal-options-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-prompt-parameters-label\"] }}\n" +
    "        </div>\n" +
    "        <ng-include src=\"'_dynamicPrompt.html'\"></ng-include>\n" +
    "        <hr>\n" +
    "        <div class=\"cf-section-container-header cf-section-label modal-options-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-custom-label\"] }}\n" +
    "        </div>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.customerInputType\" value=\"Custom\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-select-custom\"] }}\n" +
    "        </label>\n" +
    "        <div ng-show=\"modalData.customerInputType === 'Custom'\" class=\"indented-modal-div\">\n" +
    "            <table class=\"full-width\">\n" +
    "                <tbody class=\"cf-table-contents\">\n" +
    "                <tr>\n" +
    "                    <td>{{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-maximum-digits\"] }}</td>\n" +
    "                    <td>{{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-delay-between-entry\"] }}</td>\n" +
    "                </tr>\n" +
    "                <tr class=\"cf-small-input\">\n" +
    "                    <td>\n" +
    "                        <input class=\"cf-edit-input modal-input narrow-numeric\" type=\"number\" min=\"1\" ng-model=\"modalData.maxDigits\">\n" +
    "                    </td>\n" +
    "                    <td>\n" +
    "                        <input class=\"cf-edit-input modal-input narrow-numeric\" type=\"number\" min=\"1\" ng-model=\"modalData.timeoutSec\">\n" +
    "                        <label class=\"cf-input-description\">{{ $root.localizedStrings[\"lily-admin-contact-flow-in-seconds\"] }}</label>\n" +
    "                    </td>\n" +
    "                </tr>\n" +
    "                </tbody>\n" +
    "            </table>\n" +
    "\n" +
    "            <label>\n" +
    "                <input type=\"checkbox\" ng-model=\"modalData.encryptEntry\"/>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-encrypt-entry\"] }}\n" +
    "            </label>\n" +
    "            <div ng-if=\"modalData.encryptEntry\" class=\"indented-modal-div\">\n" +
    "                <label>\n" +
    "                    <input type=\"radio\" ng-model=\"modalData.useDynamicForEncryptionKeys\" ng-value=\"true\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attributes\"] }}\n" +
    "                </label>\n" +
    "                <div ng-if=\"modalData.useDynamicForEncryptionKeys\" class=\"indented-modal-div\">\n" +
    "                    <!--Dynamic selection-->\n" +
    "                    <table class=\"full-width\">\n" +
    "                        <tbody>\n" +
    "                        <tr>\n" +
    "                            <td colspan=\"2\">{{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-key-id\"] }}</td>\n" +
    "                        </tr>\n" +
    "                        <tr>\n" +
    "                            <td colspan=\"2\">\n" +
    "                                <flow-attribute-selector attribute=\"modalData.encryptionKeyId\" namespace=\"modalData.encryptionKeyIdNamespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "                            </td>\n" +
    "                        </tr>\n" +
    "                        <tr>\n" +
    "                            <td colspan=\"2\">{{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-key\"] }}</td>\n" +
    "                        </tr>\n" +
    "                        <tr>\n" +
    "                            <td colspan=\"2\">\n" +
    "                                <flow-attribute-selector attribute=\"modalData.encryptionKey\" namespace=\"modalData.encryptionKeyNamespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "                            </td>\n" +
    "                        </tr>\n" +
    "                        </tbody>\n" +
    "                    </table>\n" +
    "                </div>\n" +
    "                <label>\n" +
    "                    <input type=\"radio\" ng-model=\"modalData.useDynamicForEncryptionKeys\" ng-value=\"false\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-enter-a-key\"] }}\n" +
    "                </label>\n" +
    "                <div ng-if=\"!modalData.useDynamicForEncryptionKeys\" class=\"indented-modal-div\">\n" +
    "                    <table class=\"full-width\">\n" +
    "                        <tbody>\n" +
    "                        <tr>\n" +
    "                            <td>{{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-key-id\"] }}</td>\n" +
    "                        </tr>\n" +
    "                        <tr>\n" +
    "                            <td>\n" +
    "                                <input ng-model=\"modalData.encryptionKeyId\" class=\"cf-edit-input modal-input medium-input\">\n" +
    "                            </td>\n" +
    "                        </tr>\n" +
    "                        <tr>\n" +
    "                            <td>{{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-key\"] }}</td>\n" +
    "                        </tr>\n" +
    "                        <tr>\n" +
    "                            <td>\n" +
    "                                <textarea ng-model=\"modalData.encryptionKey\" class=\"modal-input medium-input\"></textarea>\n" +
    "                            </td>\n" +
    "                        </tr>\n" +
    "                        </tbody>\n" +
    "                    </table>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "\n" +
    "            <div ng-if=\"$root.globals['isStoreCustomerInputTerminatorFeatureEnabled']\">\n" +
    "                <label>\n" +
    "                    <input type=\"checkbox\" ng-model=\"modalData.enableTerminator\"/>\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-terminatorDigits\"] }}\n" +
    "                    <a href=\"https://docs.aws.amazon.com/console/connect/contact-flows/terminator\">{{ $root.localizedStrings[\"lily-admin-contact-flow-get-dtmf-detail-learn-more\"] }}</a>\n" +
    "                </label>\n" +
    "                <div ng-if=\"modalData.enableTerminator\" class=\"indented-modal-div\">\n" +
    "                    <label>\n" +
    "                        <input type=\"radio\" ng-model=\"modalData.useDynamicForTerminatorDigits\" ng-value=\"false\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-enterTerminator\"] }}\n" +
    "                    </label>\n" +
    "                    <div ng-if=\"!modalData.useDynamicForTerminatorDigits\" class=\"indented-modal-div\">\n" +
    "                        <td>\n" +
    "                            <input class=\"cf-edit-input modal-input medium-input\" type=\"text\" pattern=\"^[\\d#\\*]+$\" maxlength=\"5\" minlength=\"1\" ng-model=\"modalData.terminatorDigits\">\n" +
    "                            <label class=\"cf-input-description\">\n" +
    "                                {{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-allowedCharacters\"] }}\n" +
    "                            </label>\n" +
    "                        </td>\n" +
    "                    </div>\n" +
    "                    <label>\n" +
    "                        <input type=\"radio\" ng-model=\"modalData.useDynamicForTerminatorDigits\" ng-value=\"true\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attributes\"] }}\n" +
    "                    </label>\n" +
    "                    <div ng-if=\"modalData.useDynamicForTerminatorDigits\" class=\"indented-modal-div\">\n" +
    "                        <!--Dynamic selection-->\n" +
    "                        <td>\n" +
    "                            <flow-attribute-selector attribute=\"modalData.terminatorDigits\" namespace=\"modalData.terminatorDigitsNamespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "                        </td>\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "\n" +
    "                <label>\n" +
    "                    <input type=\"checkbox\" ng-model=\"modalData.disableCancel\"/>\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-disableCancel\"] }}\n" +
    "                    <a href=\"https://docs.aws.amazon.com/console/connect/contact-flows/terminator\">{{ $root.localizedStrings[\"lily-admin-contact-flow-get-dtmf-detail-learn-more\"] }}</a>\n" +
    "                </label>\n" +
    "            </div>\n" +
    "\n" +
    "        </div>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.customerInputType\" value=\"PhoneNumber\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-select-phone-number\"] }}\n" +
    "        </label>\n" +
    "        <div ng-show=\"modalData.customerInputType === 'PhoneNumber'\" class=\"indented-modal-div\">\n" +
    "            <label>\n" +
    "                <input type=\"radio\" ng-model=\"modalData.phoneNumberFormat\" value=\"Local\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-select-local-format\"] }}\n" +
    "            </label>\n" +
    "            <div ng-show=\"modalData.phoneNumberFormat === 'Local'\">\n" +
    "                <table class=\"full-width indented-modal-div\">\n" +
    "                    <tbody class=\"cf-table-contents\">\n" +
    "                    <tr>\n" +
    "                        <td><label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-country-code\"] }}</label></td>\n" +
    "                        <td><label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-delay-between-entry\"] }}</label></td>\n" +
    "                    </tr>\n" +
    "                    <tr class=\"cf-small-input\">\n" +
    "                        <td>\n" +
    "                            <div class=\"country-dropdown-div\">\n" +
    "                                <span class=\"country-code-real-input\" ng-click=\"toggleCountryDropdown()\"><span ng-class=\"selectedCountry.flag\" class=\"country-flag\"></span>{{selectedCountry.code}}<span class=\"dropdown-icon cf-span-padding dropdown-icon-modal\" ng-class=\"{'lily-icon-arrow-sort-down-black':!showCountryDropdown, 'lily-icon-arrow-sort-up-black': showCountryDropdown}\"></span></span>\n" +
    "                                <ul class=\"country-dropdown\" ng-show=\"showCountryDropdown\">\n" +
    "                                    <li class=\"country-option\" ng-repeat=\"country in countryList\" ng-click=\"setCountryCode(country)\">\n" +
    "                                        <span ng-class=\"country.flag\" class=\"country-flag\"></span>{{country.name}}<span class=\"country-code\">{{country.code}}</span>\n" +
    "                                    </li>\n" +
    "                                </ul>\n" +
    "                            </div>\n" +
    "                        </td>\n" +
    "                        <td>\n" +
    "                            <input class=\"cf-edit-input modal-input narrow-numeric\" type=\"number\" min=\"1\" ng-model=\"modalData.timeoutSec\">\n" +
    "                            <label class=\"cf-input-description\">{{ $root.localizedStrings[\"lily-admin-contact-flow-in-seconds\"] }}</label>\n" +
    "                        </td>\n" +
    "                    </tr>\n" +
    "                    </tbody>\n" +
    "                </table>\n" +
    "            </div>\n" +
    "            <label>\n" +
    "                <input type=\"radio\" ng-model=\"modalData.phoneNumberFormat\" value=\"International\" ng-click=\"closeCountryDropdown()\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-select-international-format\"] }}\n" +
    "            </label>\n" +
    "            <div ng-show=\"modalData.phoneNumberFormat === 'International'\">\n" +
    "                <table class=\"full-width indented-modal-div\">\n" +
    "                    <tbody>\n" +
    "                    <tr>\n" +
    "                        <td><label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-store-customer-input-delay-between-entry\"] }}</label></td>\n" +
    "                    </tr>\n" +
    "                    <tr class=\"cf-small-input\">\n" +
    "                        <td>\n" +
    "                            <input class=\"cf-edit-input modal-input narrow-numeric\" type=\"number\" min=\"1\" ng-model=\"modalData.timeoutSec\">\n" +
    "                            <label class=\"cf-input-description\">{{ $root.localizedStrings[\"lily-admin-contact-flow-in-seconds\"] }}</label>\n" +
    "                        </td>\n" +
    "                    </tr>\n" +
    "                    </tbody>\n" +
    "                </table>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\" ng-disabled=\"storeUserInputModuleHasInputErrors()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"_invokeExternalModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-invoke-external-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-invoke-external-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/invoke-lambda-function-block\" target=\"_blank\" rel=\"noopener\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <label class=\"cf-section-label padded-label cf-container-function\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-invoke-external-function-arn\"] }}\n" +
    "        </label>\n" +
    "\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-invoke-external-select-function\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"!modalData.useDynamic\">\n" +
    "            <lambda-function-select class=\"cf-multi-selector-one-row\" ng-model=\"modalData.lambdaFunction\"></lambda-function-select>\n" +
    "        </div>\n" +
    "        <label class=\"cf-element-container\">\n" +
    "            <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"true\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-invoke-external-use-attributes\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"modalData.useDynamic\">\n" +
    "            <flow-attribute-selector attribute=\"modalData.attribute\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "        </div>\n" +
    "\n" +
    "        <br>\n" +
    "        <label class=\"cf-section-label padded-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-invoke-lambda-input-parameters\"] }}\n" +
    "        </label>\n" +
    "        <flow-attribute-list attributes=\"modalData.variables\"\n" +
    "                             is-external-integration=\"true\"\n" +
    "                             text-add-an-attribute=\"{{ $root.localizedStrings['lily-admin-contact-flow-invoke-external-add-a-parameter'] }}\"\n" +
    "                             text-add-another-attribute=\"{{ $root.localizedStrings['lily-admin-contact-flow-invoke-external-add-another-parameter'] }}\" ></flow-attribute-list>\n" +
    "\n" +
    "        <br>\n" +
    "        <br>\n" +
    "        <label>\n" +
    "            <div>{{ $root.localizedStrings[\"lily-admin-contact-flow-invoke-lambda-timeout\"] }}</div>\n" +
    "            <input class=\"cf-edit-input\" type=\"number\" ng-model=\"modalData.timeoutSec\">\n" +
    "        </label>\n" +
    "\n" +
    "        <div ng-if=\"!modalData.timeoutSec || modalData.timeoutSec < 1 || modalData.timeoutSec > 8\" class=\"alert alert-error\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contat-flow-invoke-lamba-invalid-timeout\"] }}\n" +
    "        </div>\n" +
    "        <br>\n" +
    "\n" +
    "\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\" ng-disabled=\"isInvokeExternalSaveDisabled()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"_setHoldFlowModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-hold-flow-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-hold-flow-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-hold-flow\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"cf-section-label modal-options-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-hold-flow-label\"] }}\n" +
    "        </div>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-change=\"modalData.contactFlow = null; modalData.customerOrAgent = false\" ng-model=\"modalData.eventType\" value=\"AgentHold\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-flow-agent-label\"] }}\n" +
    "        </label>\n" +
    "        <agentholdcontactflowselect class=\"cf-multiple-options-container modal-input long-input\" ng-model=\"modalData.contactFlow\" ng-show=\"modalData.eventType === 'AgentHold'\"></agentholdcontactflowselect>\n" +
    "        <label class=\"cf-element-container\">\n" +
    "            <input type=\"radio\" ng-change=\"modalData.contactFlow = null; modalData.customerOrAgent = true\" ng-model=\"modalData.eventType\" value=\"CustomerHold\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-flow-customer-label\"] }}\n" +
    "        </label>\n" +
    "        <customerholdcontactflowselect class=\"cf-multiple-options-container modal-input long-input\" ng-model=\"modalData.contactFlow\" ng-show=\"modalData.eventType === 'CustomerHold'\"></customerholdcontactflowselect>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setHoldFlowModalV2.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-hold-flow-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-hold-flow-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-hold-flow\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"cf-section-label modal-options-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-hold-flow-label\"] }}\n" +
    "        </div>\n" +
    "        <div>\n" +
    "            <label>\n" +
    "                <input type=\"radio\" ng-change=\"modalData.contactFlow = null; modalData.eventType = 'AgentHold'\" ng-model=\"modalData.customerOrAgent\" ng-value=\"false\"/>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-flow-agent-label\"] }}\n" +
    "            </label>\n" +
    "\n" +
    "            <div ng-if=\"!modalData.customerOrAgent\" class=\"indented-modal-div\">\n" +
    "                <label>\n" +
    "                    <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-set-disconnect-flow-select-a-flow\"] }}\n" +
    "                </label>\n" +
    "                <div ng-if=\"!modalData.useDynamic\">\n" +
    "                    <agentholdcontactflowselect class=\"cf-multiple-options-container modal-input long-input\" ng-model=\"modalData.contactFlow\" ng-show=\"modalData.eventType === 'AgentHold'\"></agentholdcontactflowselect>\n" +
    "                </div>\n" +
    "                <label class=\"cf-dynamic-option\">\n" +
    "                    <input type=\"radio\" ng-change=\"modalData.contactFlow = null; modalData.namespace = null\" ng-model=\"modalData.useDynamic\" ng-value=\"true\"/>\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attribute-label\"] }}\n" +
    "                </label>\n" +
    "                <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamic\">\n" +
    "                    <flow-attribute-selector attribute=\"modalData.contactFlow\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <div>\n" +
    "            <label class=\"cf-element-container\">\n" +
    "                <input type=\"radio\" ng-change=\"modalData.contactFlow = null; modalData.eventType = 'CustomerHold'\" ng-model=\"modalData.customerOrAgent\" ng-value=\"true\"/>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-flow-customer-label\"] }}\n" +
    "            </label>\n" +
    "\n" +
    "            <div ng-if=\"modalData.customerOrAgent\" class=\"indented-modal-div\">\n" +
    "                <label>\n" +
    "                    <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-set-disconnect-flow-select-a-flow\"] }}\n" +
    "                </label>\n" +
    "                <div ng-if=\"!modalData.useDynamic\">\n" +
    "                    <customerholdcontactflowselect class=\"cf-multiple-options-container modal-input long-input\" ng-model=\"modalData.contactFlow\" ng-show=\"modalData.eventType === 'CustomerHold'\"></customerholdcontactflowselect>\n" +
    "                </div>\n" +
    "                <label class=\"cf-dynamic-option\">\n" +
    "                    <input type=\"radio\" ng-change=\"modalData.contactFlow = null; modalData.namespace = null\" ng-model=\"modalData.useDynamic\" ng-value=\"true\"/>\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attribute-label\"] }}\n" +
    "                </label>\n" +
    "                <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamic\">\n" +
    "                    <flow-attribute-selector attribute=\"modalData.contactFlow\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setWhisperFlowModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-whisper-flow-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-whisper-flow-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-whisper-flow\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"cf-section-label modal-options-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-whisper-flow-label\"] }}\n" +
    "        </div>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-change=\"modalData.contactFlow = null; modalData.customerOrAgent = false\" ng-model=\"modalData.eventType\" value=\"AgentWhisper\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-flow-whisper-to-agent-label\"] }}\n" +
    "        </label>\n" +
    "        <agentwhispercontactflowselect class=\"cf-multiple-options-container modal-input long-input\" ng-model=\"modalData.contactFlow\" ng-show=\"modalData.eventType === 'AgentWhisper'\"></agentwhispercontactflowselect>\n" +
    "        <label class=\"cf-element-container\">\n" +
    "            <input type=\"radio\" ng-change=\"modalData.contactFlow = null; modalData.customerOrAgent = true\" ng-model=\"modalData.eventType\" value=\"CustomerWhisper\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-flow-whisper-to-customer-label\"] }}\n" +
    "        </label>\n" +
    "        <customerwhispercontactflowselect class=\"cf-multiple-options-container modal-input long-input\" ng-model=\"modalData.contactFlow\" ng-show=\"modalData.eventType === 'CustomerWhisper'\"></customerwhispercontactflowselect>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setWhisperFlowModalV2.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-whisper-flow-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-whisper-flow-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-whisper-flow\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"cf-section-label modal-options-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-whisper-flow-label\"] }}\n" +
    "        </div>\n" +
    "        <div>\n" +
    "            <label>\n" +
    "                <input type=\"radio\" ng-change=\"modalData.contactFlow = null; modalData.eventType = 'AgentWhisper'\" ng-model=\"modalData.customerOrAgent\" ng-value=\"false\"/>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-flow-whisper-to-agent-label\"] }}\n" +
    "            </label>\n" +
    "\n" +
    "            <div ng-if=\"!modalData.customerOrAgent\" class=\"indented-modal-div\">\n" +
    "                <label>\n" +
    "                    <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-set-disconnect-flow-select-a-flow\"] }}\n" +
    "                </label>\n" +
    "                <div ng-if=\"!modalData.useDynamic\">\n" +
    "                    <agentwhispercontactflowselect class=\"cf-multiple-options-container modal-input long-input\" ng-model=\"modalData.contactFlow\" ng-show=\"modalData.eventType === 'AgentWhisper'\"></agentwhispercontactflowselect>\n" +
    "                </div>\n" +
    "                <label class=\"cf-dynamic-option\">\n" +
    "                    <input type=\"radio\" ng-change=\"modalData.contactFlow = null; modalData.namespace = null\" ng-model=\"modalData.useDynamic\" ng-value=\"true\"/>\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attribute-label\"] }}\n" +
    "                </label>\n" +
    "                <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamic\">\n" +
    "                    <flow-attribute-selector attribute=\"modalData.contactFlow\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <div>\n" +
    "            <label class=\"cf-element-container\">\n" +
    "                <input type=\"radio\" ng-change=\"modalData.contactFlow = null; modalData.eventType = 'CustomerWhisper'\" ng-model=\"modalData.customerOrAgent\" ng-value=\"true\"/>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-flow-whisper-to-customer-label\"] }}\n" +
    "            </label>\n" +
    "\n" +
    "            <div ng-if=\"modalData.customerOrAgent\" class=\"indented-modal-div\">\n" +
    "                <label>\n" +
    "                    <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-set-disconnect-flow-select-a-flow\"] }}\n" +
    "                </label>\n" +
    "                <div ng-if=\"!modalData.useDynamic\">\n" +
    "                    <customerwhispercontactflowselect class=\"cf-multiple-options-container modal-input long-input\" ng-model=\"modalData.contactFlow\" ng-show=\"modalData.eventType === 'CustomerWhisper'\"></customerwhispercontactflowselect>\n" +
    "                </div>\n" +
    "                <label class=\"cf-dynamic-option\">\n" +
    "                    <input type=\"radio\" ng-change=\"modalData.contactFlow = null; modalData.namespace = null\" ng-model=\"modalData.useDynamic\" ng-value=\"true\"/>\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attribute-label\"] }}\n" +
    "                </label>\n" +
    "                <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamic\">\n" +
    "                    <flow-attribute-selector attribute=\"modalData.contactFlow\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setCustomerQueueFlowModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-customer-queue-flow-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-customer-queue-flow-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-customer-queue-flow\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"cf-section-container-header cf-modal-header modal-form\">\n" +
    "        <div class=\"cf-section-label modal-options-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-customer-queue-flow-label\"] }}\n" +
    "        </div>\n" +
    "        <customerqueuecontactflowselect class=\"cf-multiple-options-container modal-input long-input\" ng-model=\"modalData.contactFlow\"></customerqueuecontactflowselect>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setCustomerQueueFlowModalV2.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-customer-queue-flow-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-customer-queue-flow-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-customer-queue-flow\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <label class=\"cf-section-label\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-customer-queue-flow-label\"] }}\n" +
    "        </label>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-change=\"modalData.contactFlow = null\" ng-model=\"modalData.useDynamic\" ng-value=\"false\"/>\n" +
    "            <input type=\"hidden\" ng-model=\"modalData.eventType\" value=\"CustomerQueue\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-disconnect-flow-select-a-flow\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"!modalData.useDynamic\">\n" +
    "            <customerqueuecontactflowselect class=\"cf-multiple-options-container modal-input long-input\" ng-model=\"modalData.contactFlow\" ng-show=\"modalData.eventType === 'CustomerQueue'\"></customerqueuecontactflowselect>\n" +
    "        </div>\n" +
    "        <label class=\"cf-dynamic-option\">\n" +
    "            <input type=\"radio\" ng-change=\"modalData.contactFlow = null; modalData.namespace = null\" ng-model=\"modalData.useDynamic\" ng-value=\"true\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attribute-label\"] }}\n" +
    "        </label>\n" +
    "        <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamic\">\n" +
    "            <flow-attribute-selector attribute=\"modalData.contactFlow\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_setDisconnectFlowModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-disconnect-flow-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-disconnect-flow-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/set-disconnect-flow\" target=\"_blank\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"cf-sub-title\">\n" +
    "            <label>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-disconnect-flow-remaining-participants\"] }}\n" +
    "            </label>\n" +
    "            <label class=\"cf-section-label\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-disconnect-flow-customer-only\"] }}\n" +
    "            </label>\n" +
    "        </div>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-change=\"modalData.contactFlow = null\" ng-model=\"modalData.useDynamic\" ng-value=\"false\"/>\n" +
    "            <input type=\"hidden\" ng-model=\"modalData.eventType\" value=\"CustomerRemaining\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-disconnect-flow-select-a-flow\"] }}\n" +
    "        </label>\n" +
    "        <div ng-if=\"!modalData.useDynamic\">\n" +
    "            <publishedcontactflowselect class=\"cf-multiple-options-container modal-input long-input\" ng-model=\"modalData.contactFlow\" ng-show=\"modalData.eventType === 'CustomerRemaining'\"></publishedcontactflowselect>\n" +
    "        </div>\n" +
    "        <label class=\"cf-dynamic-option\">\n" +
    "            <input type=\"radio\" ng-change=\"modalData.contactFlow = null; modalData.namespace = null\" ng-model=\"modalData.useDynamic\" ng-value=\"true\"/>\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attribute-label\"] }}\n" +
    "        </label>\n" +
    "        <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamic\">\n" +
    "            <flow-attribute-selector attribute=\"modalData.contactFlow\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"_invokeModuleModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-invoke-module-label\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-invoke-module-title\"] }}\n" +
    "        <!-- TODO: change href -->\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/invoke-module-block\" target=\"_blank\" rel=\"noopener\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <label class=\"cf-section-label padded-label cf-container-function\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-invoke-module-module-name\"] }}\n" +
    "        </label>\n" +
    "        <!-- TODO: replace with module dropdown -->\n" +
    "        <lambda-function-select class=\"cf-multi-selector-one-row\" ng-model=\"modalData.flowModule\"></lambda-function-select>\n" +
    "\n" +
    "\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_returnModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-flow-module-return-label\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-flow-module-return-description\"] }}\n" +
    "    </div>\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"_setSecurityBehaviorModule.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-module-set-security-behavior-name\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <!--Title Content-->\n" +
    "    <div class=\"modal-title modal-title-higher-two\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-security-behavior-title-part-one\"] }}\n" +
    "        <br><br>\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-set-security-behavior-title-part-two\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/connect/latest/adminguide/set-security-behavior\" target=\"_blank\" rel=\"noopener\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <!--Form Content-->\n" +
    "    <div class=\"modal-form modal-padded modal-form-under-higher-modal-title\">\n" +
    "        <!--Sigma Caller Authentication Section-->\n" +
    "        <div class=\"modal-detail\">\n" +
    "            <div class=\"cf-side-sheet-category-label-two\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-set-security-behavior-form-label\"] }}\n" +
    "            </div>\n" +
    "            <!--Voice Authentication Section-->\n" +
    "            <div class=\"indented-modal-detail-div cf-separator-container\">\n" +
    "                <div class=\"cf-side-sheet-category-label\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-set-security-behavior-enable-label\"] }}\n" +
    "                </div>\n" +
    "                <div class=\"cf-field-container\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-set-security-behavior-enable-description\"] }}\n" +
    "                </div>\n" +
    "\n" +
    "                <label class=\"label-spacing\">\n" +
    "                    <input type=\"radio\" ng-model=\"modalData.enableFlag\" ng-value=\"true\" data-test-id=\"set-security-behavior-is-enabled\"/>\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-set-security-behavior-enable-checkbox\"] }}\n" +
    "                </label>\n" +
    "                <label>\n" +
    "                    <input type=\"radio\" ng-model=\"modalData.enableFlag\" ng-value=\"false\" data-test-id=\"set-security-behavior-is-disabled\"/>\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-set-security-behavior-disable-checkbox\"] }}\n" +
    "                </label>\n" +
    "            </div>\n" +
    "\n" +
    "            <!--Authentication Threshold Section-->\n" +
    "            <div class=\"indented-modal-detail-div cf-separator-container\" ng-if=\"modalData.enableFlag\">\n" +
    "                <hr>\n" +
    "                <div class=\"cf-side-sheet-category-label\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-set-security-behavior-authentication-threshold-label\"] }}\n" +
    "                </div>\n" +
    "                <div class=\"cf-field-container\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-set-security-behavior-authentication-threshold-description\"] }}\n" +
    "                </div>\n" +
    "\n" +
    "                <!--Set manually-->\n" +
    "                <label class=\"label-spacing\">\n" +
    "                    <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"false\" data-test-id=\"flow-editor-form-dynamic-false\"/>\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-set-manually\"] }}\n" +
    "                </label>\n" +
    "                <div class=\"cf-multiple-options-container\" ng-if=\"!modalData.useDynamic\" data-test-id=\"flow-editor-form-dynamic-false-content\">\n" +
    "                    <span>\n" +
    "                        <label class=\"cf-section-label\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-set-security-behavior-authenticated-threshold\"] }}\n" +
    "                        </label>\n" +
    "                        <select class=\"modal-input-medium\" ng-model=\"modalData.percentage\" ng-options=\"percent.value as percent.display for percent in modalData.thresholdScores\"></select>\n" +
    "                    </span>\n" +
    "                </div>\n" +
    "\n" +
    "                <!--Use attribute-->\n" +
    "                <label class=\"cf-dynamic-option\">\n" +
    "                    <input type=\"radio\" ng-model=\"modalData.useDynamic\" ng-value=\"true\" data-test-id=\"flow-editor-form-dynamic-true\"/>\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attribute-label\"] }}\n" +
    "                </label>\n" +
    "                <div class=\"cf-multiple-options-container\" ng-if=\"modalData.useDynamic\" data-test-id=\"flow-editor-form-dynamic-true-content\">\n" +
    "                    <flow-attribute-selector attribute=\"modalData.attributeValue\" namespace=\"modalData.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "\n" +
    "    <!-- Save & Cancel Buttons-->\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\" ng-disabled=\"methods.isSetSecurityBehaviorSaveDisabled(modalData.enableFlag, modalData.useDynamic, modalData.percentage, modalData.namespace, modalData.attributeValue)\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "\n" +
    "</script>\n" +
    "\n" +
    "<script type=\"text/ng-template\" id=\"_invokeCheckSecurityStatusModal.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-check-security-status-header\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-check-security-status-title-part-one\"] }}\n" +
    "        <i>{{ $root.localizedStrings[\"lily-admin-contact-flow-module-set-security-behavior-name\"] }}</i>\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-check-security-status-title-part-two\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/connect/latest/adminguide/check-security-status\" target=\"_blank\" rel=\"noopener\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "\n" +
    "    <!--Form Content-->\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "        <div class=\"modal-detail cf-side-sheet-category-label cf-separator-container\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-check-security-status-partials-title\"] }}\n" +
    "        </div>\n" +
    "        <div class=\"modal-detail\">\n" +
    "            <div class=\"cf-side-sheet-category-label\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-module-check-security-status-condition-authenticated\"] }}\n" +
    "            </div>\n" +
    "            <div class=\"cf-field-container\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-check-security-status-partials-authenticated-description\"] }}\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <div class=\"modal-detail\">\n" +
    "            <div class=\"cf-side-sheet-category-label\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-module-check-security-status-condition-not-authenticated\"] }}\n" +
    "            </div>\n" +
    "            <div class=\"cf-field-container\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-check-security-status-partials-not-authenticated-description\"] }}\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <div class=\"modal-detail\">\n" +
    "            <div class=\"cf-side-sheet-category-label\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-module-check-security-status-condition-inconclusive\"] }}\n" +
    "            </div>\n" +
    "            <div class=\"cf-field-container\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-check-security-status-partials-inconclusive-description\"] }}\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <div class=\"modal-detail\">\n" +
    "            <div class=\"cf-side-sheet-category-label\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-module-check-security-status-condition-not-enrolled\"] }}\n" +
    "            </div>\n" +
    "            <div class=\"cf-field-container\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-check-security-status-partials-not-enrolled-description\"] }}\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <div class=\"modal-detail\">\n" +
    "            <div class=\"cf-side-sheet-category-label\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-module-check-security-status-condition-opted-out\"] }}\n" +
    "            </div>\n" +
    "            <div class=\"cf-field-container\">\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-check-security-status-partials-opted-out-description\"] }}\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</script>\n" +
    "    <script type=\"text/ng-template\" id=\"_checkOutboundCallStatusModule.html\">\n" +
    "    <h3 class=\"modal-header\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-module-check-outbound-call-status-name\"] }}\n" +
    "        <button ng-click=\"closeModal()\" class=\"pull-right close-button\" aria-label=\"close\"></button>\n" +
    "    </h3>\n" +
    "    <!--Title Content-->\n" +
    "    <div class=\"modal-title\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-contact-flow-check-outbound-call-status-title\"] }}\n" +
    "        <a href=\"https://docs.aws.amazon.com/console/connect/contact-block/check-call-progress\" target=\"_blank\" rel=\"noopener\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-block-learn-more\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "    <!--Form Content-->\n" +
    "    <div class=\"modal-form modal-padded\">\n" +
    "\n" +
    "    </div>\n" +
    "\n" +
    "    <!-- Save & Cancel Buttons-->\n" +
    "    <div class=\"modal-buttons modal-footer\">\n" +
    "        <input class=\"btn btn-primary pull-right\" type=\"button\" value=\"Save\" ng-click=\"saveModal()\" ng-disabled=\"\">\n" +
    "        <input class=\"btn btn-default pull-right\" type=\"button\" value=\"Cancel\" ng-click=\"closeModal()\">\n" +
    "    </div>\n" +
    "\n" +
    "</script>\n" +
    "    <script type=\"text/ng-template\" id=\"_copy-to-clipboard.html\">\n" +
    "  <span class=\"copy-to-clipboard awsui\">\n" +
    "      <i class=\"awsui-icon awsui-icon-has-hover files-o\" title=\"{{ $root.localizedStrings['lily-admin-copy-to-clipboard'] }}\"></i>\n" +
    "      <span class=\"message\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-copy-to-clipboard-copied\"] }}\n" +
    "      </span>\n" +
    "  </span>\n" +
    "</script>\n" +
    "\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"_flow_attribute_selector.html\">\n" +
    "    <div class=\"full-width\">\n" +
    "        <div class=\"cf-field-container\">\n" +
    "            <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-dynamic-value-namespace\"] }}</label>\n" +
    "            <div>\n" +
    "                <select class=\"modal-input-full-width\" ng-change=\"onCategoryChanged()\" ng-model=\"model.category\" ng-options=\"attr as attr.name for attr in model.attributeNamespaces track by attr.value\" data-test-id=\"flow-editor-attr-selector-namespace\"></select>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <div class=\"cf-field-container\">\n" +
    "            <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-dynamic-value-key\"] }}</label>\n" +
    "            <div>\n" +
    "                <select class=\"modal-input-full-width\" ng-change=\"onSystemAttributeChanged()\" ng-if=\"model.attributesAvailable\" ng-model=\"model.attribute\" ng-options=\"attr as attr.name for attr in model.attributesList track by attr.value\" data-test-id=\"flow-editor-attr-selector-key\"></select>\n" +
    "                <input class=\"cf-edit-input modal-input-full-width\" ng-change=\"onCustomAttributeChanged()\" type=\"text\" ng-if=\"!model.attributesAvailable\" ng-model=\"model.attribute\" data-test-id=\"flow-editor-attr-selector-key\">\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <lex-attribute-input ng-if=\"isConsolidatedLexAttributesEnabled()\" attribute=\"attribute\" namespace=\"namespace\" update=\"onLexAttributeInputChanged\"></lex-attribute-input>\n" +
    "        <contact-reference-input attribute=\"model.attribute\" update=\"onReferenceKeyChanged\" setAttributes=\"false\" ng-if=\"model.attribute.value.startsWith('References')\" data-test-id=\"flow-editor-reference-key-input\"></contact-reference-input>\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"_lex_attribute_input.html\">\n" +
    "    <div>  <!-- Template for directive must have exactly one root element. -->\n" +
    "        <div ng-if=\"namespace === 'Lex.AlternativeIntents'\" class=\"full-width\">\n" +
    "            <div class=\"cf-field-container\">\n" +
    "                <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-attr-lex-intentname\"] }}</label>\n" +
    "                <input class=\"cf-edit-input modal-input-full-width\" type=\"text\" ng-change=\"onLexAttributeInputChanged()\" ng-model=\"model.lexAlternativeIntentName\" data-test-id=\"flow-editor-attr-selector-lex-alternative-intent-name\">\n" +
    "            </div>\n" +
    "            <div class=\"cf-field-container\">\n" +
    "                <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-attr-alternative-intent-attr\"] }}</label>\n" +
    "                <select class=\"modal-input-full-width\" ng-change=\"onLexAlternativeAttributeChanged()\" ng-model=\"model.lexAlternativeIntentAttribute\" data-test-id=\"flow-editor-attr-selector-lex-alternative-intent-attr\">\n" +
    "                    <option value=\"IntentConfidence.Score\">{{ $root.localizedStrings[\"lily-admin-contact-flow-attr-lex-intentconfidence-score\"] }}</option>\n" +
    "                    <option value=\"Slots\">{{ $root.localizedStrings[\"lily-admin-contact-flow-attr-lex-slots\"] }}</option>\n" +
    "                </select>\n" +
    "            </div>\n" +
    "            <div ng-if=\"model.lexAlternativeIntentAttribute === 'Slots'\" class=\"cf-field-container\">\n" +
    "                <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-attr-slot-name\"] }}</label>\n" +
    "                <input class=\"cf-edit-input modal-input-full-width\" type=\"text\" ng-change=\"onLexAttributeInputChanged()\" ng-model=\"model.lexAttributeInput\" data-test-id=\"flow-editor-attr-selector-lex-alternative-intent-slot-name\">\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <div ng-if=\"namespace === 'Lex.SentimentResponse.Scores'\" class=\"full-width\">\n" +
    "            <div class=\"cf-field-container\">\n" +
    "                <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-attr-sentiment-label\"] }}</label>\n" +
    "                <select class=\"modal-input-full-width\" ng-change=\"onLexAttributeInputChanged()\" ng-model=\"model.lexAttributeInput\" data-test-id=\"flow-editor-attr-selector-lex-sentiment\">\n" +
    "                    <option value=\"Positive\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-attr-sentiment-positive\"] }}</option>\n" +
    "                    <option value=\"Negative\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-attr-sentiment-negative\"] }}</option>\n" +
    "                    <option value=\"Mixed\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-attr-sentiment-mixed\"] }}</option>\n" +
    "                    <option value=\"Neutral\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-attr-sentiment-neutral\"] }}</option>\n" +
    "                </select>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <div ng-if=\"namespace === 'Lex.SessionAttributes'\" class=\"full-width\">\n" +
    "            <div class=\"cf-field-container\">\n" +
    "                <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-attr-session-attribute-key\"] }}</label>\n" +
    "                <input class=\"cf-edit-input modal-input-full-width\" type=\"text\" ng-change=\"onLexAttributeInputChanged()\" ng-model=\"model.lexAttributeInput\" data-test-id=\"flow-editor-attr-selector-lex-session-attribute-key\">\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <div ng-if=\"namespace === 'Lex.Slots'\" class=\"full-width\">\n" +
    "            <div class=\"cf-field-container\">\n" +
    "                <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-lex-attr-slot-name\"] }}</label>\n" +
    "                <input class=\"cf-edit-input modal-input-full-width\" type=\"text\" ng-change=\"onLexAttributeInputChanged()\" ng-model=\"model.lexAttributeInput\" data-test-id=\"flow-editor-attr-selector-lex-slot-name\">\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</script>\n" +
    "    <script type=\"text/ng-template\" id=\"_contact_reference_input.html\">\n" +
    "    <div class=\"full-width\">\n" +
    "        <div class=\"cf-field-container\" ng-if=\"setAttributes\">\n" +
    "            <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-dynamic-value-reference-type\"] }}</label>\n" +
    "            <select class=\"modal-input-full-width\" ng-change=\"onReferenceTypeChanged()\" ng-model=\"model.referenceType\" ng-options=\"attr as attr.name for attr in referenceTypes track by attr.value\"></select>\n" +
    "        </div>\n" +
    "        <div class=\"cf-field-container\">\n" +
    "            <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-dynamic-value-reference-key\"] }}</label>\n" +
    "            <input class=\"cf-edit-input modal-input-full-width\" ng-change=\"onReferenceKeyChanged()\" type=\"text\" ng-model=\"model.referenceKey\">\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</script>\n" +
    "    <script type=\"text/ng-template\" id=\"_typeahead.html\">\n" +
    "    <div class=\"lily-typeahead\">\n" +
    "        <div class=\"awsui\">\n" +
    "            <awsui-button variant=\"standalone-icon\" class=\"lily-typeahead-toggle\" ng-click=\"$ctrl.toggleForceOpen()\">\n" +
    "                <span class=\"awsui-icon caret-down\" ng-class=\"{flipped: $ctrl.isForcedOpen}\" />\n" +
    "            </awsui-button>\n" +
    "        </div>\n" +
    "        <ul ng-show=\"$ctrl.visible && !loading\"\n" +
    "            class=\"cf-dropdown-menu\"\n" +
    "            tabindex=\"-1\">\n" +
    "            <li ng-if=\"$ctrl.items.length === 0\"\n" +
    "                class=\"cf-dropdown-menu-item disabled\">\n" +
    "                <span>{{ $root.localizedStrings[\"lily-admin-no-matches\"] }}</span>\n" +
    "            </li>\n" +
    "            <li ng-repeat=\"(itemIdx, item) in $ctrl.items\"\n" +
    "                class=\"cf-dropdown-menu-item\"\n" +
    "                ng-class=\"{selected: itemIdx === $ctrl.currentItemIndex}\"\n" +
    "                ng-mousedown=\"$ctrl.select(item)\"\n" +
    "                ng-mouseover=\"$ctrl.setCurrentIndex(itemIdx)\">\n" +
    "                <span>{{ item[textAttr] }}</span>\n" +
    "            </li>\n" +
    "        </ul>\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"_lambda-function-select.html\">\n" +
    "    <div class=\"lambda-function-select\">\n" +
    "        <input\n" +
    "            class=\"cf-edit-input modal-input long-input\"\n" +
    "            type=\"text\"\n" +
    "            ng-model=\"$ctrl.lambda\"\n" +
    "            lily-typeahead=\"$ctrl.fetchData(query)\"\n" +
    "            lily-typeahead-loading=\"$ctrl.loading\"\n" +
    "            lily-typeahead-on-change=\"$ctrl.onChange(text, item)\"\n" +
    "            lily-typeahead-ignore-input=\"$ctrl.isArn(text)\"\n" +
    "            lily-typeahead-text-attr=\"text\">\n" +
    "        <span\n" +
    "            ng-if=\"$ctrl.loading\"\n" +
    "            class=\"lily-spinner-small lily-spinner-small-right\"\n" +
    "        />\n" +
    "    </div>\n" +
    "</script>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"_text_input_with_custom_and_dynamic_support.html\">\n" +
    "\n" +
    "    <div>\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"ctrl.useDynamic\" ng-value=\"false\" ng-change=\"ctrl.onUseDynamicChange()\"/>\n" +
    "            {{ctrl.useCustomLabel}}\n" +
    "        </label>\n" +
    "\n" +
    "        <div ng-if=\"!ctrl.useDynamic\" class = \"cf-multiple-options-container\">\n" +
    "\n" +
    "            <input class=\"cf-edit-input modal-input-full-width\" type=\"{{ctrl.customInputType}}\" ng-model=\"ctrl.customInput\" ng-change=\"ctrl.onCustomInputChange(); ctrl.customInputValidator()\">\n" +
    "\n" +
    "            <div ng-if=\"!ctrl.isCustomInputValid\" class=\"warning-message\">\n" +
    "                 {{ctrl.customInputValidationErrorMessage}}\n" +
    "            </div>\n" +
    "        </div>\n" +
    "\n" +
    "        <label>\n" +
    "            <input type=\"radio\" ng-model=\"ctrl.useDynamic\" ng-value=\"true\" ng-change=\"ctrl.onUseDynamicChange()\"/>\n" +
    "            {{ctrl.useDynamicLabel}}\n" +
    "        </label>\n" +
    "\n" +
    "        <div ng-if=\"ctrl.useDynamic\" class = \"cf-multiple-options-container\">\n" +
    "            <flow-attribute-selector attribute=\"ctrl.attribute\" namespace=\"ctrl.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "\n" +
    "</script>\n" +
    "    <script type=\"text/ng-template\" id=\"_caller_id_input.html\">\n" +
    "\n" +
    "    <div>\n" +
    "\n" +
    "        <label class=\"label-spacing\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flows-transfer-caller-id-hint\"] }}\n" +
    "        </label>\n" +
    "\n" +
    "        <div class=\"claimed-phone-number-container\">\n" +
    "\n" +
    "            <label class=\"label-spacing\">\n" +
    "                <input type=\"radio\" ng-model=\"ctrl.source\" value=\"claimed\" ng-change=\"ctrl.onSourceChange()\"/>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-phone-number-header\"] }}\n" +
    "            </label>\n" +
    "\n" +
    "            <div class=\"claimed cf-multiple-options-container\" ng-if=\"ctrl.source == 'claimed'\">\n" +
    "                <td><claimednumberarnselect class=\"dial-block-phone-number-input\" type=\"text\" ng-model=\"ctrl.claimedPhoneNumber\"></claimednumberarnselect>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "\n" +
    "        <div ng-if=\"$root.globals['allowCustomCallerId'] == '1' && (ctrl.allowNonE164CallerId = $root.globals['allowNonE164CallerId'])\" class=\"ac-hidden\"></div>\n" +
    "        <div ng-if=\"$root.globals['allowCustomCallerId'] == '1'\" class=\"custom-phone-number-container\">\n" +
    "            <label class=\"label-spacing\">\n" +
    "                <input type=\"radio\" ng-model=\"ctrl.source\" value=\"custom\" ng-change=\"ctrl.onSourceChange()\"/>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-custom-phone-number-header\"] }}\n" +
    "            </label>\n" +
    "            <div class=\"custom cf-multiple-options-container\"\n" +
    "                    ng-if=\"ctrl.source == 'custom'\">\n" +
    "                <label class=\"phone-number-label cf-section-label modal-options-label\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-phone-number-label\"] }}\n" +
    "                </label>\n" +
    "\n" +
    "                <div ng-if=\"ctrl.allowNonE164CallerId === 1\">\n" +
    "                    <flow-input input=\"ctrl.customCallerId\"\n" +
    "                                validator=\"ctrl.isNumberInNonE164Format(val)\"\n" +
    "                                validation-error-message=\"{{ $root.localizedStrings['lily-admin-contact-flow-dial-block-custom-non-e164-phone-number-error'] }}\">\n" +
    "                    </flow-input>\n" +
    "                </div>\n" +
    "\n" +
    "                <div ng-if=\"ctrl.allowNonE164CallerId === 0\">\n" +
    "\n" +
    "                    <custom-caller-id-e164-format-input input=\"ctrl.customCallerId\"\n" +
    "                                validator=\"ctrl.isNumberInE164Format(val)\">\n" +
    "                    </custom-caller-id-e164-format-input>\n" +
    "                </div>\n" +
    "\n" +
    "            </div>\n" +
    "        </div>\n" +
    "\n" +
    "        <div class=\"dynamic-phone-number-container\">\n" +
    "            <label class=\"label-spacing\">\n" +
    "                <input type=\"radio\" ng-model=\"ctrl.source\" value=\"dynamic\" ng-change=\"ctrl.onSourceChange()\"/>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-use-attribute-label\"] }}\n" +
    "            </label>\n" +
    "\n" +
    "            <div class=\"dynamic cf-multiple-options-container\" ng-if=\"ctrl.source == 'dynamic'\">\n" +
    "                <flow-attribute-selector attribute=\"ctrl.attribute\" namespace=\"ctrl.namespace\" exclude-system-attributes=\"true\"></flow-attribute-selector>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</script>\n" +
    "    <script type=\"text/ng-template\" id=\"_flow_input.html\">\n" +
    "\n" +
    "    <div>\n" +
    "        <input class=\"cf-edit-input modal-input-full-width\" type=\"{{ctrl.inputType}}\" ng-model=\"ctrl.input\" ng-change=\"ctrl.onInputChange();\">\n" +
    "\n" +
    "        <div ng-if=\"!ctrl.isInputValid\" class=\"warning-message\">\n" +
    "            {{ctrl.validationErrorMessage}}\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</script>\n" +
    "    <script type=\"text/ng-template\" id=\"_custom_caller_id_e164_format_input.html\">\n" +
    "\n" +
    "    <div>\n" +
    "        <input class=\"cf-edit-input modal-input-full-width\" type=\"text\" ng-model=\"ctrl.input\" ng-change=\"ctrl.onInputChange();\">\n" +
    "\n" +
    "        <div ng-if=\"!ctrl.isInputValid\" class=\"warning-message\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-custom-phone-number-format-error\"] }}\n" +
    "            <a href='https://docs.aws.amazon.com/connect/latest/userguide/agentconsole-guide.html#international-calls-ccp'>\n" +
    "                {{ $root.localizedStrings[\"lily-admin-contact-flow-dial-block-learn-more\"] }}\n" +
    "            </a>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</script>\n" +
    "    <script type=\"text/ng-template\" id=\"_flow_attribute_list.html\">\n" +
    "    <div>\n" +
    "        <div ng-repeat=\"attribute in attributes\" class=\"full-width\" ng-if=\"$root.globals['isTaskContactAttributesEnabled'] && !isExternalIntegration\">\n" +
    "            <flow-attribute-contact-data-selector attribute=\"attribute\" attributes=\"attributes\"/>\n" +
    "        </div>\n" +
    "        <table ng-repeat=\"attribute in attributes\" class=\"full-width\" ng-if=\"!$root.globals['isTaskContactAttributesEnabled'] || isExternalIntegration\">\n" +
    "            <tbody class=\"cf-table-style\">\n" +
    "            <tr>\n" +
    "                <td><label class=\"cf-padded-attributes cf-element-container\">\n" +
    "                    <input type=\"radio\" ng-model=\"attribute.useDynamic\" ng-value=\"false\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-save-contact-attribute-as-text\"] }}\n" +
    "                </label></td>\n" +
    "                <td class=\"modal-remove-row\"><button id=\"cf-block-repeated-close-button\" class=\"pull-left close-button svg-button\" ng-click=\"attributes.splice($index, 1)\"></button></td>\n" +
    "            </tr>\n" +
    "            <tr ng-if=\"!attribute.useDynamic\" class=\"indented cf-padded-attributes\">\n" +
    "                <td>\n" +
    "                    <div class=\"cf-padded-attributes-indented\">\n" +
    "                        <div class=\"cf-field-container\">\n" +
    "                            <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-save-contact-attribute-key\"] }}</label>\n" +
    "                            <div>\n" +
    "                                <input class=\"cf-edit-input modal-input-full-width\" type=\"text\" ng-model=\"attribute.key\">\n" +
    "                            </div>\n" +
    "                        </div>\n" +
    "                        <div class=\"cf-field-container\">\n" +
    "                            <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-save-contact-attribute-value\"] }}</label>\n" +
    "                            <div>\n" +
    "                                <input class=\"cf-edit-input modal-input-full-width\" type=\"text\" ng-model=\"attribute.value\">\n" +
    "                            </div>\n" +
    "                        </div>\n" +
    "                    </div>\n" +
    "                </td>\n" +
    "                <td></td>\n" +
    "            </tr>\n" +
    "            <tr>\n" +
    "                <td><label class=\"cf-padded-attributes cf-element-container\">\n" +
    "                    <input type=\"radio\" ng-model=\"attribute.useDynamic\" ng-value=\"true\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-save-contact-attribute-set-dynamically\"] }}\n" +
    "                </label></td>\n" +
    "                <td></td>\n" +
    "            </tr>\n" +
    "            <tr ng-if=\"attribute.useDynamic\" class=\"indented cf-padded-attributes\">\n" +
    "                <td>\n" +
    "                    <div class=\"cf-padded-attributes-indented\">\n" +
    "                        <div class=\"cf-field-container\">\n" +
    "                            <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-contact-attribute-key\"] }}</label>\n" +
    "                            <div>\n" +
    "                                <input type=\"text\" class=\"cf-edit-input modal-input-full-width\" ng-model=\"attribute.key\">\n" +
    "                            </div>\n" +
    "                        </div>\n" +
    "                        <flow-attribute-selector attribute=\"attribute.value\" namespace=\"attribute.namespace\"></flow-attribute-selector>\n" +
    "                    </div>\n" +
    "                </td>\n" +
    "                <td></td>\n" +
    "            </tr>\n" +
    "            </tbody>\n" +
    "        </table>\n" +
    "        <a class=\"cf-element-container\" href=\"#\" ng-click=\"attributes.push({id: null, key: null, value: null, useDynamic: false})\">\n" +
    "            <span ng-if=\"attributes.length > 0\" class=\"large-label\">{{addAnotherAttributeString}}</span>\n" +
    "            <span ng-if=\"attributes.length === 0\" class=\"large-label\">{{addAnAttributeString}}</span>\n" +
    "        </a>\n" +
    "    </div>\n" +
    "</script>\n" +
    "    <script type=\"text/ng-template\" id=\"_flow_attribute_contact_data_selector.html\">\n" +
    "    <div class=\"full-width\">\n" +
    "        <table class=\"full-width\">\n" +
    "            <tbody class=\"cf-table-style\">\n" +
    "                <tr>\n" +
    "                    <td>\n" +
    "                        <label class=\"cf-padded-attributes\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-contact-attribute-destination-type\"] }}</label>\n" +
    "                    </td>\n" +
    "                    <td class=\"modal-remove-row\">\n" +
    "                        <button id=\"cf-block-repeated-close-button\" class=\"pull-left close-button svg-button\" ng-click=\"attributes.splice(attributes.indexOf(attribute), 1)\"></button>\n" +
    "                    </td>\n" +
    "                </tr>\n" +
    "                <tr>\n" +
    "                    <td>\n" +
    "                        <select class=\"modal-input-full-width cf-padded-attributes\" ng-model=\"model.destinationType\" ng-change=\"onDestinationTypeChanged()\" ng-options=\"destinationType as destinationType.name for destinationType in model.destinationTypes track by destinationType.value\"></select>\n" +
    "                    </td>\n" +
    "                    <td></td>\n" +
    "                </tr>\n" +
    "                <tr>\n" +
    "                    <td>\n" +
    "                    <label class=\"cf-padded-attributes\">{{ $root.localizedStrings[\"lily-admin-contact-flow-set-contact-attribute-destination-attribute\"] }}</label>\n" +
    "                    <div>\n" +
    "                        <select class=\"modal-input-full-width cf-padded-attributes\" ng-model=\"model.destinationAttribute\" ng-change=\"onDestinationAttributeChange()\" ng-if=\"model.showDestinationAttributes\" ng-options=\"destinationAttribute as destinationAttribute.name for destinationAttribute in model.destinationAttributes track by destinationAttribute.value\"></select>\n" +
    "                        <input class=\"cf-edit-input modal-input-full-width cf-padded-attributes\" type=\"text\" ng-if=\"!model.showDestinationAttributes\" ng-model=\"attribute.key\">\n" +
    "                    </div>\n" +
    "                    </td>\n" +
    "                    <td></td>\n" +
    "                </tr>\n" +
    "                <tr ng-if=\"model.showReferences\">\n" +
    "                    <td>\n" +
    "                        <label class=\"cf-padded-attributes\">{{ $root.localizedStrings[\"lily-admin-contact-flow-dynamic-value-reference-type\"] }}</label>\n" +
    "                        <div>\n" +
    "                            <select class=\"modal-input-full-width cf-padded-attributes\" ng-model=\"model.referenceType\" ng-change=\"onReferenceTypeChanged()\"  ng-options=\"referenceType as referenceType.name for referenceType in model.referenceTypes track by referenceType.value\"></select>\n" +
    "                        </div>\n" +
    "                    </td>\n" +
    "                    <td></td>\n" +
    "                </tr>\n" +
    "                <tr ng-if=\"model.showReferences\">\n" +
    "                    <td>\n" +
    "                        <label class=\"cf-padded-attributes\">{{ $root.localizedStrings[\"lily-admin-contact-flow-dynamic-value-reference-key\"] }}</label>\n" +
    "                        <div>\n" +
    "                            <input class=\"cf-edit-input modal-input-full-width cf-padded-attributes\" type=\"text\" ng-model=\"attribute.key\">\n" +
    "                        </div>\n" +
    "                    </td>\n" +
    "                    <td></td>\n" +
    "                </tr>\n" +
    "                <tr>\n" +
    "                    <td><label class=\"cf-padded-attributes cf-element-container\">\n" +
    "                        <input type=\"radio\" ng-model=\"attribute.useDynamic\" ng-value=\"false\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-save-contact-attribute-as-text\"] }}\n" +
    "                    </label></td>\n" +
    "                    <td></td>\n" +
    "                </tr>\n" +
    "                <tr ng-if=\"!attribute.useDynamic\" class=\"indented cf-padded-attributes\">\n" +
    "                    <td>\n" +
    "                        <div class=\"cf-padded-attributes-indented\">\n" +
    "                            <div class=\"cf-field-container\">\n" +
    "                                <label class=\"cf-section-label\">{{ $root.localizedStrings[\"lily-admin-contact-flow-save-contact-attribute-value\"] }}</label>\n" +
    "                                <div>\n" +
    "                                    <input class=\"cf-edit-input modal-input-full-width\" type=\"text\" ng-model=\"attribute.value\">\n" +
    "                                </div>\n" +
    "                            </div>\n" +
    "                        </div>\n" +
    "                    </td>\n" +
    "                    <td></td>\n" +
    "                </tr>\n" +
    "                <tr>\n" +
    "                    <td><label class=\"cf-padded-attributes cf-element-container\">\n" +
    "                        <input type=\"radio\" ng-model=\"attribute.useDynamic\" ng-value=\"true\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-contact-flow-save-contact-attribute-set-dynamically\"] }}\n" +
    "                    </label></td>\n" +
    "                    <td></td>\n" +
    "                </tr>\n" +
    "                <tr ng-if=\"attribute.useDynamic\" class=\"indented cf-padded-attributes\">\n" +
    "                    <td>\n" +
    "                        <div class=\"cf-padded-attributes-indented\">\n" +
    "                            <flow-attribute-selector attribute=\"attribute.value\" namespace=\"attribute.namespace\"></flow-attribute-selector>\n" +
    "                        </div>\n" +
    "                    </td>\n" +
    "                    <td></td>\n" +
    "                </tr>\n" +
    "            </tbody>\n" +
    "        </table>\n" +
    "\n" +
    "    </div>\n" +
    "</script>\n" +
    "    \n" +
    "    <div id=\"cf-name-header-id\" class=\"page-header\"></div>\n" +
    "    \n" +
    "    <div class=\"contact-flow-header full-width\" ng-if=\"$root.globals['canViewHistoricalChanges']\">\n" +
    "        <div class=\"pull-left pull-left-header-div\">\n" +
    "            <form class=\"header-form page-header full-width\" id=\"contact-flow-header-title\" ng-submit=\"saveContactFlowName()\">\n" +
    "                \n" +
    "                <input id=\"page-header-id\" class=\"page-header-input\" ng-maxlength=\"127\" maximum-characters-length=\"127\" ng-model=\"contactFlow.name\" set-focus-if=\"editingStatus.isEditingName\"\n" +
    "                placeholder=\"{{ $root.localizedStrings['lily-admin-contact-flow-name-placeholder'] }}\" ng-click=\"editingStatus.isEditingName = true\" ng-disabled=\"!$root.globals['canEdit']\" ng-mouseenter=\"isNameHover=true\" ng-mouseleave=\"isNameHover=false\" ng-class=\"{'disabled': !editingStatus.isEditingName}\" tooltip=\"{{contactFlow.name}}\" tooltip-placement=\"bottom\" ng-blur=\"saveContactFlowName(false)\">\n" +
    "            </form>\n" +
    "        </div>\n" +
    "        <span class=\"newSpinner\" id=\"spinner\" ng-show=\"loading || saving || exporting || importing\"></span>\n" +
    "        <div class=\"pull-right-header-div\">\n" +
    "            <div ng-if=\"!$root.globals['canEdit']\" class=\"cf-dropdown-btn dropdown awsui\">\n" +
    "                <button ng-if=\"hasContactFlowId()\" class=\"lily-save-resource-button table-top-right-button\" ng-click=\"verifyExport()\">{{ $root.localizedStrings[\"lily-admin-export-flow\"] }}</button>\n" +
    "            </div>\n" +
    "            <div ng-if=\"$root.globals['canEdit']\" id=\"can-edit-contact-flow\">\n" +
    "                <contactflowversionselector id=\"versionSelect\" ng-model=\"selectedTimestamp\" class=\"form-control awsui\" ng-change=\"openContactFlowVersion(selectedTimestamp)\" ng-disabled=\"disableVersionDropdown()\">\n" +
    "                </contactflowversionselector>\n" +
    "                <div class=\"header-buttons\">\n" +
    "                    <button id=\"publishContactFlowButton\" ng-if=\"$root.globals['canPublish']\" class=\"lily-save-resource-button header-button\" ng-click=\"verifyPublish()\" ng-disabled=\"invalidContactFlow()\" ng-class=\"{'disabled-button-state': invalidContactFlow()}\" tooltip=\"{{ $root.localizedStrings['lily-admin-name-required'] }}\" tooltip-placement=\"top\" >{{ $root.localizedStrings[\"lily-admin-permission-publish\"] }} </button>\n" +
    "                </div>\n" +
    "                <div class=\"cf-dropdown-btn dropdown awsui\">\n" +
    "                    <button id=\"saveContactFlowButton\" class=\"lily-save-resource-button table-top-right-button cf-save-button-default short-width\" ng-click=\"hasContactFlowId() ? verifySave() : createContactFlow(false, $root.globals['canEditAfterCreate'])\" ng-disabled=\"invalidContactFlow()\" ng-class=\"{'disabled-button-state': invalidContactFlow()}\" tooltip=\"{{ $root.localizedStrings['lily-admin-name-required'] }}\" tooltip-placement=\"top\" tooltip-enable=\"invalidContactFlow()\">{{ $root.localizedStrings[\"lily-admin-save\"] }} </button>\n" +
    "                    <awsui-button ng-if=\"hasContactFlowId() || $root.globals['canPublish']\" variant=\"primary\" class=\"sub-right dropdown-toggle\" data-toggle=\"dropdown\">\n" +
    "                        <div class=\"icon-wrapper\"><span class=\"awsui-icon awsui-icon-light caret-down\"/></div>\n" +
    "                    </awsui-button>\n" +
    "                    <ul class=\"dropdown-menu save-menu\" id=\"cf-dropdown\">\n" +
    "                        <li ng-show=\"hasContactFlowId()\" tooltip=\"{{ $root.localizedStrings['lily-admin-name-required'] }}\" tooltip-placement=\"left\" tooltip-enable=\"invalidContactFlow()\"><a ng-click=\"verifyCreateContactFlow()\" ng-class=\"{'drop-down-button-disabled': invalidContactFlow()}\">{{ $root.localizedStrings[\"lily-admin-save-as\"] }}</a></li>\n" +
    "                        <li ng-if=\"hasContactFlowId()\"><a ng-click=\"verifyExport()\">{{ $root.localizedStrings[\"lily-admin-export-flow\"] }}</a></li>\n" +
    "                        <li><a ng-click=\"verifyImport()\">{{ $root.localizedStrings[\"lily-admin-import-flow\"] }}</a></li>\n" +
    "                    </ul>\n" +
    "                    <div ng-if=\"!$root.globals['canEdit']\">\n" +
    "                        <a class=\"btn btn-default\" href=\"{{ $root.globals['requestPathPrefix'] }}/contact-flows\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-back\"] }}\n" +
    "                        </a>\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "     <div class=\"contact-flow-header\" ng-if=\"!$root.globals['canViewHistoricalChanges']\">\n" +
    "        <div class=\"pull-left\">\n" +
    "            <h1 class=\"page-header\" id=\"contact-flow-header-title\">{{pageHeader}}</h1>\n" +
    "        </div>\n" +
    "        <span class=\"newSpinner\" id=\"spinner\" ng-show=\"loading || saving || exporting || importing\"></span>\n" +
    "        <div class=\"pull-right\">\n" +
    "            <div ng-if=\"!$root.globals['canEdit']\" class=\"cf-dropdown-btn dropdown awsui\">\n" +
    "                <button ng-if=\"hasContactFlowId()\" class=\"lily-save-resource-button table-top-right-button cf-save-button-default\" ng-click=\"verifyExport()\">{{ $root.localizedStrings[\"lily-admin-export-flow\"] }}</button>\n" +
    "            </div>\n" +
    "            <div ng-if=\"$root.globals['canEdit']\" id=\"can-edit-contact-flow\">\n" +
    "                <label class=\"grid-snap\" ng-if=\"$root.globals['canEdit']\"><input type=\"checkbox\" id=\"gridSnap-check-box\"> {{ $root.localizedStrings[\"lily-admin-contact-flow-snap-to-grid\"] }}</label>\n" +
    "                <div class=\"cf-dropdown-btn dropdown awsui\">\n" +
    "                    <button ng-if=\"hasContactFlowId() || $root.globals['canPublish']\" class=\"lily-save-resource-button table-top-right-button cf-save-button-default\" ng-click=\"hasContactFlowId() ? verifySave() : createContactFlow(false, $root.globals['canEditAfterCreate'])\" ng-disabled=\"invalidContactFlow()\" ng-class=\"{'disabled-button-state': invalidContactFlow()}\" tooltip=\"{{ $root.localizedStrings['lily-admin-name-required'] }}\" tooltip-placement=\"top\" tooltip-enable=\"invalidContactFlow()\">{{ $root.localizedStrings[\"lily-admin-save\"] }} </button>\n" +
    "                    <awsui-button ng-if=\"hasContactFlowId() || $root.globals['canPublish']\" variant=\"primary\" class=\"sub-right dropdown-toggle\" data-toggle=\"dropdown\">\n" +
    "                        <div class=\"icon-wrapper\"><span class=\"awsui-icon awsui-icon-light caret-down\"/></div>\n" +
    "                    </awsui-button>\n" +
    "                    <ul class=\"dropdown-menu save-menu\" id=\"cf-dropdown\">\n" +
    "                        <li ng-if=\"$root.globals['canPublish']\" tooltip=\"{{ $root.localizedStrings['lily-admin-name-required'] }}\" tooltip-placement=\"left\" tooltip-enable=\"invalidContactFlow()\"><a ng-click=\"hasContactFlowId() ? verifySavePublish() : createContactFlow(true, $root.globals['canEditAfterCreate'])\" ng-class=\"{'drop-down-button-disabled': invalidContactFlow()}\">{{ $root.localizedStrings[\"lily-admin-publish-save\"] }}</a></li>\n" +
    "                        <li ng-show=\"hasContactFlowId()\" tooltip=\"{{ $root.localizedStrings['lily-admin-name-required'] }}\" tooltip-placement=\"left\" tooltip-enable=\"invalidContactFlow()\"><a ng-click=\"verifyCreateContactFlow()\" ng-class=\"{'drop-down-button-disabled': invalidContactFlow()}\">{{ $root.localizedStrings[\"lily-admin-save-as\"] }}</a></li>\n" +
    "                        <li ng-show=\"hasContactFlowId() && isPublished(contactFlow.contactFlowStatus)\"><a ng-click=\"verifyRevertPublished()\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-revert-published\"] }}</a></li>\n" +
    "                        <li ng-if=\"hasContactFlowId()\"><a ng-click=\"verifyRevertSaved()\">{{ $root.localizedStrings[\"lily-admin-revert-save\"] }}</a></li>\n" +
    "                        <li ng-if=\"hasContactFlowId()\"><a ng-click=\"verifyExport()\">{{ $root.localizedStrings[\"lily-admin-export-flow\"] }}</a></li>\n" +
    "                        <li><a ng-click=\"verifyImport()\">{{ $root.localizedStrings[\"lily-admin-import-flow\"] }}</a></li>\n" +
    "                    </ul>\n" +
    "                    <div ng-if=\"!$root.globals['canEdit']\">\n" +
    "                        <a class=\"btn btn-default\" href=\"{{ $root.globals['requestPathPrefix'] }}/contact-flows\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-back\"] }}\n" +
    "                        </a>\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div class=\"awsui\">\n" +
    "        <awsui-alert type=\"error\" ng-if=\"anyError()\" header=\"{{ $root.localizedStrings['lily-admin-contact-flow-save-failure'] }}\" dismissible=\"true\" dismiss=\"close()\">\n" +
    "            <p class=\"cf-alert-body\" ng-if=\"saveFailure\">{{ $root.localizedStrings[\"lily-admin-contact-flow-save-failure\"] }}</p>\n" +
    "            <p class=\"cf-alert-body\" ng-if=\"exportFailure\">{{ $root.localizedStrings[\"lily-admin-contact-flow-export-failure\"] }}</p>\n" +
    "            <p class=\"cf-alert-body\" ng-if=\"importFailure\">{{ $root.localizedStrings[\"lily-admin-contact-flow-import-failure\"] }}</p>\n" +
    "            <p class=\"cf-alert-body\" ng-if=\"incorrectFlowTypeFailure\">{{ $root.localizedStrings[\"lily-admin-contact-flow-incorrect-flow-type-failure\"] }}</p>\n" +
    "            <p class=\"cf-alert-body\" ng-if=\"invalidImportJson\">{{ $root.localizedStrings[\"lily-admin-contact-flow-import-failure\"] }}{{ $root.localizedStrings[\"lily-admin-contact-flow-invalid-import-json-failure\"] }}</p>\n" +
    "            <p class=\"cf-alert-body\" ng-if=\"importTooLargeFailure\">{{ $root.localizedStrings[\"lily-admin-contact-flow-import-failure\"] }}{{ $root.localizedStrings[\"lily-admin-contact-flow-file-too-large-failure\"] }}</p>\n" +
    "            <p class=\"cf-alert-body\" ng-if=\"exportTooLargeFailure\">{{ $root.localizedStrings[\"lily-admin-contact-flow-export-failure\"] }}{{ $root.localizedStrings[\"lily-admin-contact-flow-file-too-large-failure\"] }}</p>\n" +
    "            <p class=\"cf-alert-body\" ng-if=\"saveDuplicateFailure\">{{ $root.localizedStrings[\"lily-admin-contact-flow-duplicate-failure\"] }}</p>\n" +
    "            <p class=\"cf-alert-body\" ng-if=\"saveQuotaFailure\">{{ $root.localizedStrings[\"lily-admin-contact-flow-quota-failure\"] }}</p>\n" +
    "        </awsui-alert>\n" +
    "        <awsui-alert type=\"error\" ng-if=\"hasPasteError()\" header=\"{{ $root.localizedStrings['lily-admin-contact-flow-paste-failure-header'] }}\" dismissible=\"true\" dismiss=\"close()\">\n" +
    "            <p class=\"cf-alert-body\">{{ $root.localizedStrings[\"lily-admin-contact-flow-paste-failure\"] }}</p>\n" +
    "        </awsui-alert>\n" +
    "        <awsui-alert type=\"success\" ng-if=\"saveSuccess\" header=\"{{ $root.localizedStrings['lily-admin-contact-flow-save-success'] }}\" dismissible=\"true\" dismiss=\"close()\">\n" +
    "            <p class=\"cf-alert-body\">{{ $root.localizedStrings[\"lily-admin-contact-flow-save-success\"] }}</p>\n" +
    "        </awsui-alert>\n" +
    "    </div>\n" +
    "    <div id=\"wholePaper\" ng-class=\"{'loading' : loading}\">\n" +
    "        <div class=\"zoom-buttons\" ng-class=\"{'zoom-buttons-closed-ss': !showLeftPanel, 'zoom-buttons-open-ss': showLeftPanel}\">\n" +
    "            <button type=\"button\" class=\"btn btn-primary sub-left zoom-button\" id=\"zoom-in-button\" ng-click=\"zoom(true)\">+</button>\n" +
    "            <br/>\n" +
    "            <button type=\"button\" class=\"btn btn-primary sub-left zoom-button\" id=\"zoom-out-button\" ng-click=\"zoom(false)\">-</button>\n" +
    "        </div>\n" +
    "        <div id=\"show-status\" ng-if=\"!$root.globals['canViewHistoricalChanges']\" ng-show=\"showCurrentStatus()\">\n" +
    "            <p id=\"current-status\">{{contactFlowStatus}}</p>\n" +
    "        </div>\n" +
    "        <div id=\"left-paper-hidden\" class=\"scaling-full-height\" ng-show=\"!showLeftPanel\">\n" +
    "            <div class=\"awsui\">\n" +
    "                <awsui-button id=\"left-panel-toggle-button-closed\" ng-click=\"changeLeftPanelView()\" class=\"left-panel-toggle-button dropdown-toggle\" data-toggle=\"dropdown\" variant=\"standalone-icon\">\n" +
    "                    <span class=\"awsui-icon caret-right\"/>\n" +
    "                </awsui-button>\n" +
    "            </div>\n" +
    "        </div>\n" +
    "        <div id=\"leftPaper\" class=\"scaling-full-height\" ng-show=\"showLeftPanel\">\n" +
    "            <span id=\"leftContactFlowInfo\">\n" +
    "            <div class=\"left-contact-flow-data\">\n" +
    "                <div>\n" +
    "                    <div id=\"left-contact-flow-data-name\" ng-if=\"!$root.globals['canViewHistoricalChanges']\">\n" +
    "                        <p class=\"cf-field left-cf-field\">Name</p>\n" +
    "                        \n" +
    "                        <div id=\"contactFlowName\" class=\"contact-flow-container awsui\" ng-init=\"editingStatus.isEditingName = false\" ng-click=\"editingStatus.isEditingName = true\" ng-mouseenter=\"onNameHover=true\" ng-mouseleave=\"onNameHover=false\">\n" +
    "                            <input ng-maxlength=\"127\" class=\"contact-flow-name input-box-name cf-information-box\" ng-disabled=\"!$root.globals['canEdit']\" ng-model=\"contactFlow.name\" ng-class=\"{'disabled': !editingStatus.isEditingName, 'inline-edit-focus': editingStatus.isEditingName}\"\n" +
    "                                placeholder=\"{{ $root.localizedStrings['lily-admin-contact-flow-name-placeholder'] }}\" ng-blur=\"editingStatus.isEditingName = false\" set-focus-if=\"editingStatus.isEditingName\" maximum-characters-length=\"127\">\n" +
    "                            <span class=\"lily-icon lily-icon-pencil-gray cf-data-icon-pencil\"  ng-show=\"$root.globals['canEdit'] && !editingStatus.isEditingName && onNameHover\"></span>\n" +
    "                        </div>\n" +
    "                    </div>\n" +
    "                    <div class=\"awsui\">\n" +
    "                        <awsui-button id=\"left-panel-toggle-button-open\" ng-click=\"changeLeftPanelView()\" class=\"left-panel-toggle-button dropdown-toggle\" ng-class=\"{'left-panel-toggle-button-lower': hasAlert()}\" data-toggle=\"dropdown\" variant=\"standalone-icon\">\n" +
    "                            <span class=\"awsui-icon caret-left\"/>\n" +
    "                        </awsui-button>\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "                <div class=\"left-contact-flow-data-header\" ng-click=\"expandContactFlowData()\">\n" +
    "                    <div id=\"additional-info-header\" ng-if=\"flowType != entityTypes.MODULE\">\n" +
    "                        <span ng-if=\"!showContactFlowData\">{{ $root.localizedStrings[\"lily-admin-contact-flow-show-additional-info\"] }}</span>\n" +
    "                        <span ng-if=\"showContactFlowData\">{{ $root.localizedStrings[\"lily-admin-contact-flow-hide-additional-info\"] }}</span>\n" +
    "                    </div>                            \n" +
    "                    <div id=\"additional-info-header\" ng-if=\"flowType == entityTypes.MODULE\">\n" +
    "                        <span ng-if=\"!showContactFlowData\">{{ $root.localizedStrings[\"lily-admin-flow-module-show-additional-info\"] }}</span>\n" +
    "                        <span ng-if=\"showContactFlowData\">{{ $root.localizedStrings[\"lily-admin-flow-module-hide-additional-info\"] }}</span>\n" +
    "                    </div>\n" +
    "                    <i id=\"additional-info-chevron\" class=\"lily-icon-chevron-down-grey\" ng-class=\"{'sideInstructionGroupHeaderChevronDown': !showContactFlowData, 'sideInstructionGroupHeaderChevronUp': showContactFlowData}\"></i>\n" +
    "                </div>\n" +
    "                <div class=\"left-contact-flow-data-contents\" ng-show=\"showContactFlowData\">\n" +
    "                    <p class=\"cf-field left-cf-field\">Description</p>\n" +
    "                    \n" +
    "                    <div id=\"contactFlowDescription\" class=\"contact-flow-container awsui\" ng-init=\"editingStatus.isEditingDescription = false\" ng-click=\"editingStatus.isEditingDescription = true\" ng-mouseenter=\"onDescHover=true\" ng-mouseleave=\"onDescHover=false\">\n" +
    "                        <input class=\"input-box-description cf-information-box\" maximum-characters-length=\"250\" ng-model=\"contactFlow.description\" ng-blur=\"editingStatus.isEditingDescription = false\"\n" +
    "                            set-focus-if=\"editingStatus.isEditingDescription\" ng-disabled=\"!$root.globals['canEdit']\" ng-class=\"{'disabled': !editingStatus.isEditingDescription, 'inline-edit-focus': editingStatus.isEditingDescription}\" placeholder=\"{{ $root.localizedStrings['lily-admin-contact-flow-description-placeholder'] }}\"/>\n" +
    "                        <span class=\"lily-icon lily-icon-pencil-gray cf-data-icon-pencil\" ng-show=\"$root.globals['canEdit'] && !editingStatus.isEditingDescription && onDescHover\"></span>\n" +
    "                    </div>\n" +
    "                    <div class=\"cf-field-container\">\n" +
    "                        <p class=\"cf-field left-cf-field\">{{ $root.localizedStrings[\"lily-admin-audit-contact-flow-type\"] }}</p>\n" +
    "                        <div id=\"contact-flow-type\">\n" +
    "                           {{getLocalizedFlowType()}}\n" +
    "                        </div>\n" +
    "                    </div>\n" +
    "                    <div class=\"cf-field-container\" ng-if=\"$root.globals['canViewHistoricalChanges'] && isAuditAvailable\">\n" +
    "                        <p class=\"cf-field left-cf-field\">{{ $root.localizedStrings[\"lily-admin-contact-flow-user-name-header\"] }}</p>\n" +
    "                        <div id=\"contact-flow-type\">\n" +
    "                           {{auditUser}}\n" +
    "                        </div>\n" +
    "                    </div>\n" +
    "                    <div class=\"cf-field-container\" ng-if=\"showArn()\">\n" +
    "                        <p class=\"cf-field left-cf-field\">{{ $root.localizedStrings[\"lily-admin-contact-flow-arn-field-title\"] }}</p>\n" +
    "                        <div class=\"field-content\">\n" +
    "                            <span class=\"arn\">{{contactFlowId}}</span>\n" +
    "                            <copy-to-clipboard value=\"{{contactFlowId}}\"></copy-to-clipboard>\n" +
    "                        </div>\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "            </div>\n" +
    "            </span>\n" +
    "            <span id=\"leftInstructions\" class=\"scaling-full-height\">\n" +
    "                <div ng-repeat=\"moduleGroup in supportedBlocks\"\n" +
    "                     ng-click=\"expand(moduleGroup)\"\n" +
    "                     data-test-id=\"{{ 'flow-editor-block-doc-group-' + moduleGroup.type.toLowerCase() }}\">\n" +
    "                    <div class=\"sideInstructionGroupHeader\">\n" +
    "                        <div class=\"sideInstructionGroupName\">{{moduleGroup.name}}</div>\n" +
    "                        <i ng-show=\"moduleGroup.showChevron\" ng-init=\"moduleGroup.showChevron=true\" class=\"lily-icon-chevron-down-grey\" ng-class=\"{'sideInstructionGroupHeaderChevronDown': !moduleGroup.showModules, 'sideInstructionGroupHeaderChevronUp': moduleGroup.showModules}\"></i>\n" +
    "                    </div>\n" +
    "                    <div ng-show=\"moduleGroup.showModules || moduleGroup.searchModuleGroupMatch\">\n" +
    "                        <div ng-mousedown=\"createSideInstruction($event, module.createFunction)\"\n" +
    "                             ng-repeat=\"module in moduleGroup.modules | filter: {name:contactFlow.moduleSearchKey} | filter:filterModulesOnFeatureAccess | filter:filterModulesOnFeatureAccessFlowTypes\"\n" +
    "                             ng-class=\"getSideInstructionClass(moduleGroup)\"\n" +
    "                             data-test-id=\"{{ 'flow-editor-block-doc-block-' + module.type }}\">\n" +
    "                             <i class=\"sideInstructionDragIcon\"></i>\n" +
    "                            <div class=\"sideTitle\">{{module.name}}</div>\n" +
    "                            <div class=\"sideDescription\">{{module.description}}</div>\n" +
    "                        </div>\n" +
    "                    </div>\n" +
    "                </div>\n" +
    "            </span>\n" +
    "        </div>\n" +
    "        <div id=\"contact-flow-outer-area\" class=\"scaling-full-height {{entityType}}\" ng-click=\"onPaperClick()\" ng-mousedown=\"onMouseDown()\">\n" +
    "            <div id=\"entity-type-displayer\" ng-if=\"featureAccess.isFlowModuleEnabled()\">{{getLocalizedFlowType()}}</div>\n" +
    "            <div id=\"paper\" class=\"paper\" ng-class=\"{'marqueeMode': marqueeMode, 'mouseDown': mouseDown}\">\n" +
    "            </div>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "      <div class=\"awsui\">\n" +
    "        <awsui-modal header='{{ $root.localizedStrings[\"lily-admin-save-as\"] }}' id=\"contactflowSaveAsModal\" visible=\"saveAsModalVisible\" dismiss-fn=\"saveAsModalDismiss\">\n" +
    "            <span dom-region=\"content\">\n" +
    "                <p class=\"cf-field\">{{ $root.localizedStrings[\"lily-admin-contact-flow-new-name\"] }}</p>\n" +
    "                <input class=\"search-input-box modal-input-box\" ng-model=\"contactFlow.name\" placeholder=\"{{ $root.localizedStrings['lily-admin-contact-flow-name-placeholder'] }}\"/>\n" +
    "                <p class=\"cf-field\">{{ $root.localizedStrings[\"lily-admin-contact-flow-description\"] }}</p>\n" +
    "                <input class=\"search-input-box modal-input-box\" ng-model=\"contactFlow.description\"/>\n" +
    "            </span>\n" +
    "            <span dom-region=\"footer\">\n" +
    "                <div>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-save-as\"] }}' variant=\"primary\" class=\"awsui-util-f-r\" click=\"createContactFlow(false, $root.globals['canEdit'])\" loading=\"ongoingUpdate\" disabled=\"invalidContactFlow()\" tooltip=\"{{ $root.localizedStrings['lily-admin-name-required'] }}\" tooltip-placement=\"top\" tooltip-enable=\"invalidContactFlow()\"></awsui-button>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-cancel\"] }}' variant=\"link\" class=\"awsui-util-f-r modal-cancel-bt\" click=\"onSaveAsModalCancel()\"></awsui-button>\n" +
    "                </div>\n" +
    "            </span>\n" +
    "        </awsui-modal>\n" +
    "         <awsui-modal header='{{ $root.localizedStrings[\"lily-admin-revert-published\"] }}' id=\"contactflowRevertPublishedModal\" visible=\"revertPublishedModalVisible\" dismiss-fn=\"revertPublishedModalDismiss\">\n" +
    "           <span dom-region=\"content\">\n" +
    "                <p><strong>{{ $root.localizedStrings[\"lily-admin-contact-flow-revert-to-published-message-1\"] }}</strong></p>\n" +
    "                <br/>\n" +
    "                <div class=\"awsui-alert-inside awsui-alert-type-warning awsui-alert\">\n" +
    "                    <p><strong>{{ $root.localizedStrings[\"lily-admin-contact-flow-revert-to-published-message-2\"] }}</strong></p>\n" +
    "                    <p>{{ $root.localizedStrings[\"lily-admin-contact-flow-revert-to-published-message-3\"] }}</p>\n" +
    "                </div>\n" +
    "                <br/>\n" +
    "           </span>\n" +
    "           <span dom-region=\"footer\">\n" +
    "                <div>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-revert\"] }}' variant=\"primary\" class=\"awsui-util-f-r\" click=\"revertToOlderVersion(true)\"></awsui-button>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-cancel\"] }}' variant=\"link\" class=\"awsui-util-f-r\" click=\"revertPublishedModalCancel()\"></awsui-button>\n" +
    "                </div>\n" +
    "           </span>\n" +
    "        </awsui-modal>\n" +
    "         <awsui-modal header='{{ $root.localizedStrings[\"lily-admin-revert-save\"] }}' id=\"contactflowRevertSavedModal\" visible=\"revertSavedModalVisible\" dismiss-fn=\"revertSavedModalDismiss\">\n" +
    "            <span dom-region=\"content\">\n" +
    "                <p><strong>{{ $root.localizedStrings[\"lily-admin-contact-flow-revert-to-saved-message-1\"] }}</strong></p>\n" +
    "                <br/>\n" +
    "                <div class=\"awsui-alert-inside awsui-alert-type-warning awsui-alert\">\n" +
    "                    <p><strong>{{ $root.localizedStrings[\"lily-admin-contact-flow-revert-to-saved-message-2\"] }}</strong></p>\n" +
    "                    <p>{{ $root.localizedStrings[\"lily-admin-contact-flow-revert-to-saved-message-3\"] }}</p>\n" +
    "                </div>\n" +
    "                <br/>\n" +
    "            </span>\n" +
    "            <span dom-region=\"footer\">\n" +
    "                <div>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-revert\"] }}' variant=\"primary\" class=\"awsui-util-f-r\" click=\"revertToOlderVersion(false)\"></awsui-button>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-cancel\"] }}' variant=\"link\" class=\"awsui-util-f-r\" click=\"revertSavedModalCancel()\"></awsui-button>\n" +
    "                </div>\n" +
    "            </span>\n" +
    "        </awsui-modal>\n" +
    "        <awsui-modal header='{{ $root.localizedStrings[\"lily-admin-contact-flow-publish\"] }} {{contactFlow.name}}' id=\"contactflowPublishModal\" visible=\"publishModalVisible\" dismiss-fn=\"publishModalDismiss\">\n" +
    "            <span dom-region=\"content\">\n" +
    "                <span class=\"pull-left cf-publish-warning\">\n" +
    "                </span>\n" +
    "                <div id=\"awsui\">\n" +
    "                    <p class=\"cf-publish-alert-1\">{{ $root.localizedStrings[\"lily-admin-contact-flow-publish-message-1\"] }}</p>\n" +
    "                    <p class=\"cf-publish-alert-2\">{{ $root.localizedStrings[\"lily-admin-contact-flow-publish-message-2\"] }} <a rel=\"noopener\" href=\"https://docs.aws.amazon.com/console/connect/contact-flows/versioning\" target=\"_blank\" class=\"lily-quick-start-guide-link\">{{ $root.localizedStrings[\"lily-admin-contact-flow-learn-more\"] }}</a></p>\n" +
    "                </div>\n" +
    "            </span>\n" +
    "            <span dom-region=\"footer\">\n" +
    "                <div>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-contact-flow-publish\"] }}' variant=\"primary\" class=\"awsui-util-f-r\" click=\"publishContactFlow($root.globals['canEditAfterCreate'])\"></awsui-button>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-cancel\"] }}' variant=\"link\" class=\"awsui-util-f-r\" click=\"publishModalCancel()\"></awsui-button>\n" +
    "                </div>\n" +
    "            </span>\n" +
    "        </awsui-modal>\n" +
    "        <awsui-modal header='{{ $root.localizedStrings[\"lily-admin-publish-save\"] }}' id=\"contactflowSavePublishModal\" visible=\"savePublishModalVisible\" dismiss-fn=\"savePublishModalDismiss\">\n" +
    "            <span dom-region=\"content\">\n" +
    "                <p><strong>{{ $root.localizedStrings[\"lily-admin-contact-flow-save-publish-message-1\"] }}</strong></p>\n" +
    "                <br/>\n" +
    "                <div class=\"awsui-alert-inside awsui-alert-type-warning awsui-alert\">\n" +
    "                    <p>{{ $root.localizedStrings[\"lily-admin-contact-flow-save-publish-message-2\"] }}{{contactFlow.name}}</p>\n" +
    "                </div>\n" +
    "                <br/>\n" +
    "            </span>\n" +
    "            <span dom-region=\"footer\">\n" +
    "                <div>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-publish-save\"] }}' variant=\"primary\" class=\"awsui-util-f-r\" click=\"updateContactFlow(true)\"></awsui-button>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-cancel\"] }}' variant=\"link\" class=\"awsui-util-f-r\" click=\"savePublishModalCancel()\"></awsui-button>\n" +
    "                </div>\n" +
    "            </span>\n" +
    "        </awsui-modal>\n" +
    "         <awsui-modal header='{{ $root.localizedStrings[\"lily-admin-save-header\"] }}' id=\"contactflowSaveModal\" visible=\"saveModalVisible && $root.globals['canViewHistoricalChanges']\" dismiss-fn=\"saveModalDismiss\">\n" +
    "            <span dom-region=\"content\">\n" +
    "                <p><strong>{{ $root.localizedStrings[\"lily-admin-contact-flow-save-message-1\"] }}</strong></p>\n" +
    "                <br/>\n" +
    "                <p>\n" +
    "                    <strong>{{ $root.localizedStrings[\"lily-admin-note\"] }}</strong>\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-save-message-2-general\"] }}\n" +
    "                </p>\n" +
    "            </span>\n" +
    "            <span dom-region=\"footer\">\n" +
    "                <div>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-save\"] }}' variant=\"primary\" class=\"awsui-util-f-r\" click=\"updateContactFlow(false)\"></awsui-button>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-cancel\"] }}' variant=\"link\" class=\"awsui-util-f-r\" click=\"saveModalCancel()\"></awsui-button>\n" +
    "                </div>\n" +
    "            </span>\n" +
    "        </awsui-modal>\n" +
    "         <awsui-modal header='{{ $root.localizedStrings[\"lily-admin-save-header\"] }}' id=\"contactflowSaveModal\" visible=\"saveModalVisible && !$root.globals['canViewHistoricalChanges']\" dismiss-fn=\"saveModalDismiss\">\n" +
    "            <span dom-region=\"content\">\n" +
    "                <p><strong>{{ $root.localizedStrings[\"lily-admin-contact-flow-save-message-1\"] }}</strong></p>\n" +
    "                <br/>\n" +
    "                <p>\n" +
    "                    <strong>{{ $root.localizedStrings[\"lily-admin-note\"] }}</strong>\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-contact-flow-save-message-2\"] }}\n" +
    "                </p>\n" +
    "            </span>\n" +
    "            <span dom-region=\"footer\">\n" +
    "                <div>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-save\"] }}' variant=\"primary\" class=\"awsui-util-f-r\" click=\"updateContactFlow(false)\"></awsui-button>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-cancel\"] }}' variant=\"link\" class=\"awsui-util-f-r\" click=\"saveModalCancel()\"></awsui-button>\n" +
    "                </div>\n" +
    "            </span>\n" +
    "        </awsui-modal>\n" +
    "         <awsui-modal header=\"{{ $root.localizedStrings['lily-admin-export-flow'] }}\" id=\"exportModal\" visible=\"exportModalVisible\" dismiss-fn=\"exportModalDismiss\">\n" +
    "            <span dom-region=\"content\">\n" +
    "                <p>\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-export-message\"] }}\n" +
    "                    <a rel=\"noopener\" href=\"https://docs.aws.amazon.com/connect/latest/userguide/contactflow.html#contact-flow-import-export\" target=\"_blank\">\n" +
    "                       {{ $root.localizedStrings[\"lily-admin-cf-import-export-link\"] }}\n" +
    "                    </a>\n" +
    "                </p>\n" +
    "                <p ng-if=\"oldFlow\">\n" +
    "                    <strong>{{ $root.localizedStrings[\"lily-admin-note\"] }}{{ $root.localizedStrings[\"lily-admin-republish-flow\"] }}</strong>\n" +
    "                </p>\n" +
    "                <br/>\n" +
    "                <p class=\"cf-field\">{{ $root.localizedStrings[\"lily-admin-export-file-name\"] }}</p>\n" +
    "                <p><input class=\"search-input-box modal-input-box\" ng-model=\"filename\"/></p>\n" +
    "            </span>\n" +
    "            <span dom-region=\"footer\">\n" +
    "                <div>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-export\"] }}' variant=\"primary\" class=\"awsui-util-f-r\" click=\"exportContactFlow(filename)\"></awsui-button>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-cancel\"] }}' variant=\"link\" class=\"awsui-util-f-r\" click=\"exportModalCancel()\"></awsui-button>\n" +
    "                </div>\n" +
    "            </span>\n" +
    "        </awsui-modal>\n" +
    "         <awsui-modal header=\"{{ $root.localizedStrings['lily-admin-import-flow'] }}\" id=\"importModal\" visible=\"importModalVisible\" dismiss-fn=\"importModalDismiss\">\n" +
    "            <span dom-region=\"content\">\n" +
    "                <p>{{ $root.localizedStrings[\"lily-admin-import-message\"] }}</p>\n" +
    "                <br/>\n" +
    "                <p class=\"cf-field\">{{ $root.localizedStrings[\"lily-admin-import-select-file\"] }}</p>\n" +
    "                <div id=\"cf-import-select-div\">\n" +
    "                    <p class=\"search-input-box modal-input-box\" id=\"cf-import-select\">{{selectedFile.name}}</p>\n" +
    "                    <input type=\"file\" id=\"import-cf-file\" class=\"upload-file\" filemodel=\"selectedFile\"/>\n" +
    "                    <label for=\"import-cf-file\" id=\"import-cf-file-button\" class=\"upload-file-button\">\n" +
    "                        {{ $root.localizedStrings[\"lily-admin-select\"] }}\n" +
    "                    </label>\n" +
    "                </div>\n" +
    "            </span>\n" +
    "            <span dom-region=\"footer\">\n" +
    "                <div>\n" +
    "                    <!-- disable button if no file selected -->\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-import\"] }}' disabled=\"!selectedFile\" variant=\"primary\" class=\"awsui-util-f-r\" click=\"importContactFlow(selectedFile)\"></awsui-button>\n" +
    "                    <awsui-button text='{{ $root.localizedStrings[\"lily-admin-cancel\"] }}' variant=\"link\" class=\"awsui-util-f-r\" click=\"importModalCancel()\"></awsui-button>\n" +
    "                </div>\n" +
    "            </span>\n" +
    "        </awsui-modal>\n" +
    "    </div>\n" +
    "</div>\n" +
    ""; 

window["GLOBAL_TEMPLATES"]["src/html/admin/contact-flows/search.html"] = "\n" +
    "<div id=\"angularContainer\" class=\"awsui\" style=\"display:none\" ng-controller=\"SearchController\">\n" +
    "    <h1 class=\"page-header\">{{ $root.localizedStrings[\"lily-admin-page-type-header-contact-flow-editor\"] }}</h1>\n" +
    "\n" +
    "    <script type=\"text/ng-template\" id=\"_paginationWidget.html\">\n" +
    "    \n" +
    "    \n" +
    "<div ng-show=\"entities.length > 0\" class=\"table-pagination-row\">\n" +
    "    <span class=\"pagination-item\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-rows-per-page\"] }}\n" +
    "    </span>\n" +
    "\n" +
    "    <span class=\"pagination-item\">\n" +
    "        <select ng-model=\"pagination.pageSize\" class=\"page-size-dropdown\" ng-options=\"size for size in pagination.pageSizes\">\n" +
    "        </select>\n" +
    "    </span>\n" +
    "\n" +
    "    <span class=\"pagination-item\">\n" +
    "        {{display.firstEntity}} - {{display.lastEntity}}\n" +
    "        {{ $root.localizedStrings[\"lily-admin-search-page-of\"] }} {{display.totalEntities}}\n" +
    "    </span>\n" +
    "        <button class=\"pagination-item\" ng-click=\"goToLastPage()\" ng-disabled=\"isFirstPage()\" aria-label=\"{{ $root.localizedStrings['lily-admin-previous-page-aria'] }}\">\n" +
    "			<span ng-if=\"isFirstPage()\">\n" +
    "				<i class=\"lily-icon lily-icon-arrow-left-gray\" ng-class=\"{'non-clickable': true}\"></i>\n" +
    "			</span>\n" +
    "            <span ng-if=\"!isFirstPage()\">\n" +
    "				<i class=\"lily-icon lily-icon-arrow-left\" ng-class=\"{'non-clickable': false}\"></i>\n" +
    "			</span>\n" +
    "        </button>\n" +
    "\n" +
    "        <button class=\"pagination-item\" ng-click=\"goToNextPage()\" ng-disabled=\"isLastPage()\" aria-label=\"{{ $root.localizedStrings['lily-admin-next-page-aria'] }}\">\n" +
    "			<span ng-if=\"isLastPage()\">\n" +
    "				<i class=\"lily-icon lily-icon-arrow-right-gray\" ng-class=\"{'non-clickable': true}\"></i>\n" +
    "			</span>\n" +
    "            <span ng-if=\"!isLastPage()\">\n" +
    "				<i class=\"lily-icon lily-icon-arrow-right\" ng-class=\"{'non-clickable': false}\"></i>\n" +
    "			</span>\n" +
    "        </button>\n" +
    "\n" +
    "</div>\n" +
    "</script>\n" +
    "    <div ng-if=\"isExceptionReturned\" class=\"alert alert-warning\">\n" +
    "    <span ng-if=\"exceptionWarningMessageId === 'lily-admin-feature-come-soon-warning'\">{{ $root.localizedStrings[\"lily-admin-feature-come-soon-warning\"] }}</span>\n" +
    "    <span ng-if=\"exceptionWarningMessageId === 'lily-admin-resource-not-found-error'\">{{ $root.localizedStrings[\"lily-admin-resource-not-found-error\"] }}</span>\n" +
    "    <span ng-if=\"exceptionWarningMessageId === 'lily-admin-ajax-consistent-error'\">{{ $root.localizedStrings[\"lily-admin-ajax-consistent-error\"] }}</span>\n" +
    "    <span ng-if=\"exceptionWarningMessageId === 'lily-admin-agent-security-profile-search-error'\">{{ $root.localizedStrings[\"lily-admin-agent-security-profile-search-error\"] }}</span>\n" +
    "</div>\n" +
    "<div ng-if=\"error && errorCount < 3\" class=\"alert alert-error\">\n" +
    "    {{ $root.localizedStrings[\"lily-admin-ajax-error\"] }}\n" +
    "</div>\n" +
    "<div ng-if=\"error && errorCount >= 3\" class=\"alert alert-error\">\n" +
    "    {{ $root.localizedStrings[\"lily-admin-ajax-consistent-error\"] }}\n" +
    "    <button ng-click=\"retrySearch()\" class=\"button btn\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-click-to-try-again\"] }}\n" +
    "    </button>\n" +
    "</div>\n" +
    "     <div class=\"table-top-bar contact-flow-top-container\">\n" +
    "        <span class=\"filter-icon pull-left\"></span>\n" +
    "        <input id=\"contact-flow-search-input\" class=\"search-input-box lily-top-container-name-input filter-icon-text\" placeholder=\"{{ $root.localizedStrings['lily-admin-contact-flow-search-by-name'] }}\" ng-model=\"filter.name\" />\n" +
    "         <span class=\"lily-spinner-small contact-flow-spinner-small-right\" ng-show=\"ongoingSearch\"></span>\n" +
    "        <div ng-if=\"$root.globals['canCreate']\" class=\"cf-dropdown-btn dropdown awsui lily-top-container-buttons\" id=\"cf-create-dropdown\">\n" +
    "            <button type=\"button\" class=\"btn btn-primary sub-left\" onclick=\"location.href='contact-flows/create?type=contactFlow'\">\n" +
    "                    {{ $root.localizedStrings[\"lily-admin-add-new-contact-flow\"] }}\n" +
    "            </button>\n" +
    "            <div class=\"sub-right dropdown-toggle\" data-toggle=\"dropdown\">\n" +
    "                <div class=\"icon-wrapper\"><span class=\"awsui-icon awsui-icon-light caret-down\"/></div>\n" +
    "            </div>\n" +
    "            <ul class=\"dropdown-menu save-menu\" id=\"cf-create-dropdown-list\">\n" +
    "                <li><a href=\"contact-flows/create?type=customerQueue\">{{ $root.localizedStrings[\"lily-admin-add-new-customer-queue-flow\"] }}</a></li>\n" +
    "                <li><a href=\"contact-flows/create?type=customerHold\">{{ $root.localizedStrings[\"lily-admin-add-new-customer-hold-flow\"] }}</a></li>\n" +
    "                <li><a href=\"contact-flows/create?type=customerWhisper\">{{ $root.localizedStrings[\"lily-admin-add-new-customer-whisper-flow\"] }}</a></li>\n" +
    "                <li><a href=\"contact-flows/create?type=outboundWhisper\">{{ $root.localizedStrings[\"lily-admin-add-new-outbound-whisper-flow\"] }}</a></li>\n" +
    "                <li><a href=\"contact-flows/create?type=agentHold\">{{ $root.localizedStrings[\"lily-admin-add-new-agent-hold-flow\"] }}</a></li>\n" +
    "                <li><a href=\"contact-flows/create?type=agentWhisper\">{{ $root.localizedStrings[\"lily-admin-add-new-agent-whisper-flow\"] }}</a></li>\n" +
    "                <li><a href=\"contact-flows/create?type=agentTransfer\">{{ $root.localizedStrings[\"lily-admin-add-new-agent-transfer-flow\"] }}</a></li>\n" +
    "                <li><a href=\"contact-flows/create?type=queueTransfer\">{{ $root.localizedStrings[\"lily-admin-add-new-queue-transfer-flow\"] }}</a></li>\n" +
    "            </ul>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "     <div ng-show=\"entities.length === 0\">\n" +
    "        {{ $root.localizedStrings[\"lily-admin-search-no-results\"] }}\n" +
    "    </div>\n" +
    "     <div class=\"lily-card table-with-pagination\">\n" +
    "        <table id=\"contact-flow-search-table\" ng-show=\"entities.length > 0\" class=\"awsui-grid detail-table\">\n" +
    "            <thead class=\"awsui-container\">\n" +
    "                <tr class=\"awsui-row\">\n" +
    "                    <th class=\"c-m-2\">{{ $root.localizedStrings[\"lily-admin-contact-flow-name\"] }}</th>\n" +
    "                    <th class=\"c-m-2\">{{ $root.localizedStrings[\"lily-admin-contact-flow-type\"] }}</th>\n" +
    "                    <th class=\"c-m-4\">{{ $root.localizedStrings[\"lily-admin-contact-flow-description\"] }}</th>\n" +
    "                    <th class=\"c-m-2\">{{ $root.localizedStrings[\"lily-admin-contact-flow-status-header\"] }}</th>\n" +
    "                    <th class=\"c-m-2\"></th>\n" +
    "                </tr>\n" +
    "            </thead>\n" +
    "            <tbody class=\"awsui-container\">\n" +
    "                <tr class=\"awsui-row hover-row\" ng-repeat=\"contactflow in entities\">\n" +
    "                    <td class=\"c-m-2\">\n" +
    "                       <span class=\"lily-table-long-text-cell\" tooltip=\"{{contactflow.name}}\">\n" +
    "                            <a ng-href=\"contact-flows/{{$root.globals['canEdit'] ? 'edit' : 'view'}}?id={{contactflow.arn}}\">{{contactflow.name}}</a>\n" +
    "                       </span>\n" +
    "                    </td>\n" +
    "                    <td class=\"c-m-2 lily-table-cell\" ng-switch=\"contactflow.contactFlowType\">\n" +
    "                        <div ng-switch-when=\"customerQueue\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-customer-queue\"] }}\n" +
    "                        </div>\n" +
    "                        <div ng-switch-when=\"customerHold\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-customer-hold\"] }}\n" +
    "                        </div>\n" +
    "                        <div ng-switch-when=\"agentHold\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-agent-hold\"] }}\n" +
    "                        </div>\n" +
    "                        <div ng-switch-when=\"agentWhisper\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-agent-whisper\"] }}\n" +
    "                        </div>\n" +
    "                        <div ng-switch-when=\"customerWhisper\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-customer-whisper\"] }}\n" +
    "                        </div>\n" +
    "                        <div ng-switch-when=\"outboundWhisper\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-outbound-whisper\"] }}\n" +
    "                        </div>\n" +
    "                        <div ng-switch-when=\"agentTransfer\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-agent-transfer\"] }}\n" +
    "                        </div>\n" +
    "                        <div ng-switch-when=\"queueTransfer\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-queue-transfer\"] }}\n" +
    "                        </div>\n" +
    "                        <div ng-switch-default>\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-contact-flow\"] }}\n" +
    "                        </div>\n" +
    "                    </td>\n" +
    "                    <td class=\"c-m-4\">\n" +
    "                        <span class=\"lily-table-long-text-cell\" tooltip=\"{{contactflow.description}}\">{{contactflow.description}}</span>\n" +
    "                    </td>\n" +
    "                    <td class=\"c-m-2\" ng-switch=\"contactflow.contactFlowStatus === 'published'\">\n" +
    "                        <div ng-switch-when=\"true\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-published\"] }}\n" +
    "                        </div>\n" +
    "                        <div ng-switch-when=\"false\">\n" +
    "                            {{ $root.localizedStrings[\"lily-admin-contact-flow-not-published\"] }}\n" +
    "                        </div>\n" +
    "                    </td>\n" +
    "                    <td class=\"c-m-2\"></td>\n" +
    "                </tr>\n" +
    "            </tbody>\n" +
    "        </table>\n" +
    "        <div class=\"pull-right\">\n" +
    "            <pagination-widget></pagination-widget>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "    <div ng-if=\"globals['canViewHistoricalChanges']\" style=\"margin-top: 40px;\">\n" +
    "        <a ng-href=\"{{ $root.globals['requestPathPrefix'] }}/historical-changes/contactflow\">\n" +
    "            {{ $root.localizedStrings[\"lily-admin-historical-changes\"] }}\n" +
    "        </a>\n" +
    "    </div>\n" +
    "</div>\n" +
    ""; 

window["GLOBAL_TEMPLATES"]["src/error-pages/access-denied.html"] = "<div id=\"errorBodyContainer\">\n" +
    "  <div class=\"lily-card errorBody\">\n" +
    "    <div id=\"errorTitle\">\n" +
    "        <i class=\"lily-img-chatty-ind\" ></i>\n" +
    "        <h1 id=\"errorTitleHeader\">\n" +
    "            {{ $root.localizedStrings['lily-admin-access-denied-error-title'] }}\n" +
    "        </h1>\n" +
    "    </div>\n" +
    "    <div id=\"errorMessage\">\n" +
    "        {{ $root.localizedStrings['lily-admin-access-denied-error-message'] }}\n" +
    "    </div>\n" +
    "  </div>\n" +
    "</div>\n" +
    "\n" +
    ""; 

window["GLOBAL_TEMPLATES"]["src/error-pages/exception-resolver-error.html"] = "<p>An internal error occurred</p>\n" +
    ""; 

window["GLOBAL_TEMPLATES"]["src/error-pages/general-error.html"] = "\n" +
    "<div id=\"errorBodyContainer\">\n" +
    "    <div class=\"lily-card errorBody\">\n" +
    "        <div id=\"errorTitle\">\n" +
    "            {{ $root.localizedStrings['lily-admin-general-error'] }}\n" +
    "            <br>\n" +
    "            {{ getLocalizationStringWithVariable('lily-admin-exception-id-message', { 'exceptionId': data.exceptionId })}}\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</div>\n" +
    "  \n" +
    "  \n" +
    "  \n" +
    "  "; 

window["GLOBAL_TEMPLATES"]["src/error-pages/not-found-error.html"] = "<div id=\"errorBodyContainer\">\n" +
    "  <div class=\"lily-card errorBody\">\n" +
    "    <div id=\"errorTitle\">\n" +
    "        <i class=\"lily-img-chatty-ind\" ></i>\n" +
    "        <h1 id=\"errorTitleHeader\">\n" +
    "            {{ $root.localizedStrings['lily-admin-resource-not-found-error-title'] }}\n" +
    "        </h1>\n" +
    "    </div>\n" +
    "    <div id=\"errorMessage\">\n" +
    "        {{ $root.localizedStrings['lily-admin-resource-not-found-error'] }}\n" +
    "    </div>\n" +
    "  </div>\n" +
    "</div>"; 

window["GLOBAL_TEMPLATES"]["src/error-pages/throttling-error.html"] = "\n" +
    "<div id=\"errorBodyContainer\">\n" +
    "    <div class=\"lily-card errorBody\">\n" +
    "        <div id=\"errorTitle\">\n" +
    "            <i class=\"lily-img-chatty-ind\" ></i>\n" +
    "            <h1 id=\"errorTitleHeader\">\n" +
    "                {{ $root.localizedStrings['lily-admin-throttle-error'] }}\n" +
    "            </h1>\n" +
    "        </div>\n" +
    "    </div>\n" +
    "</div>"; 
// END 
window.USE_NEXT_GEN_ANGULAR = window.angular? false:true;
if(window.USE_NEXT_GEN_ANGULAR){

/*! jQuery v3.5.1 | (c) JS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(C,e){"use strict";var t=[],r=Object.getPrototypeOf,s=t.slice,g=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},u=t.push,i=t.indexOf,n={},o=n.toString,v=n.hasOwnProperty,a=v.toString,l=a.call(Object),y={},m=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},x=function(e){return null!=e&&e===e.window},E=C.document,c={type:!0,src:!0,nonce:!0,noModule:!0};function b(e,t,n){var r,i,o=(n=n||E).createElement("script");if(o.text=e,t)for(r in c)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[o.call(e)]||"object":typeof e}var f="3.5.1",S=function(e,t){return new S.fn.init(e,t)};function p(e){var t=!!e&&"length"in e&&e.length,n=w(e);return!m(e)&&!x(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}S.fn=S.prototype={jquery:f,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=S.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return S.each(this,e)},map:function(n){return this.pushStack(S.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(S.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:t.sort,splice:t.splice},S.extend=S.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||m(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(S.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||S.isPlainObject(n)?n:{},i=!1,a[t]=S.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},S.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==o.call(e))&&(!(t=r(e))||"function"==typeof(n=v.call(t,"constructor")&&t.constructor)&&a.call(n)===l)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){b(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(p(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(p(Object(e))?S.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:i.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(p(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:y}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=t[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var d=function(n){var e,d,b,o,i,h,f,g,w,u,l,T,C,a,E,v,s,c,y,S="sizzle"+1*new Date,p=n.document,k=0,r=0,m=ue(),x=ue(),A=ue(),N=ue(),D=function(e,t){return e===t&&(l=!0),0},j={}.hasOwnProperty,t=[],q=t.pop,L=t.push,H=t.push,O=t.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",W="\\["+M+"*("+I+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+M+"*\\]",F=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",B=new RegExp(M+"+","g"),$=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp(M+"|>"),X=new RegExp(F),V=new RegExp("^"+I+"$"),G={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){T()},ae=be(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{H.apply(t=O.call(p.childNodes),p.childNodes),t[p.childNodes.length].nodeType}catch(e){H={apply:t.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function se(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(T(e),e=e||C,E)){if(11!==p&&(u=Z.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(f&&(a=f.getElementById(i))&&y(e,a)&&a.id===i)return n.push(a),n}else{if(u[2])return H.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&d.getElementsByClassName&&e.getElementsByClassName)return H.apply(n,e.getElementsByClassName(i)),n}if(d.qsa&&!N[t+" "]&&(!v||!v.test(t))&&(1!==p||"object"!==e.nodeName.toLowerCase())){if(c=t,f=e,1===p&&(U.test(t)||z.test(t))){(f=ee.test(t)&&ye(e.parentNode)||e)===e&&d.scope||((s=e.getAttribute("id"))?s=s.replace(re,ie):e.setAttribute("id",s=S)),o=(l=h(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+xe(l[o]);c=l.join(",")}try{return H.apply(n,f.querySelectorAll(c)),n}catch(e){N(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return g(t.replace($,"$1"),e,n,r)}function ue(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function le(e){return e[S]=!0,e}function ce(e){var t=C.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){var n=e.split("|"),r=n.length;while(r--)b.attrHandle[n[r]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function de(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function he(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function ge(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ae(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function ve(a){return le(function(o){return o=+o,le(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function ye(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}for(e in d=se.support={},i=se.isXML=function(e){var t=e.namespaceURI,n=(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},T=se.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:p;return r!=C&&9===r.nodeType&&r.documentElement&&(a=(C=r).documentElement,E=!i(C),p!=C&&(n=C.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",oe,!1):n.attachEvent&&n.attachEvent("onunload",oe)),d.scope=ce(function(e){return a.appendChild(e).appendChild(C.createElement("div")),"undefined"!=typeof e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),d.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),d.getElementsByTagName=ce(function(e){return e.appendChild(C.createComment("")),!e.getElementsByTagName("*").length}),d.getElementsByClassName=K.test(C.getElementsByClassName),d.getById=ce(function(e){return a.appendChild(e).id=S,!C.getElementsByName||!C.getElementsByName(S).length}),d.getById?(b.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(te,ne);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=d.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):d.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},b.find.CLASS=d.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&E)return t.getElementsByClassName(e)},s=[],v=[],(d.qsa=K.test(C.querySelectorAll))&&(ce(function(e){var t;a.appendChild(e).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+S+"-]").length||v.push("~="),(t=C.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||v.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+S+"+*").length||v.push(".#.+[+~]"),e.querySelectorAll("\\\f"),v.push("[\\r\\n\\f]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=C.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),a.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(d.matchesSelector=K.test(c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ce(function(e){d.disconnectedMatch=c.call(e,"*"),c.call(e,"[s!='']:x"),s.push("!=",F)}),v=v.length&&new RegExp(v.join("|")),s=s.length&&new RegExp(s.join("|")),t=K.test(a.compareDocumentPosition),y=t||K.test(a.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},D=t?function(e,t){if(e===t)return l=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!d.sortDetached&&t.compareDocumentPosition(e)===n?e==C||e.ownerDocument==p&&y(p,e)?-1:t==C||t.ownerDocument==p&&y(p,t)?1:u?P(u,e)-P(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return l=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==C?-1:t==C?1:i?-1:o?1:u?P(u,e)-P(u,t):0;if(i===o)return pe(e,t);n=e;while(n=n.parentNode)a.unshift(n);n=t;while(n=n.parentNode)s.unshift(n);while(a[r]===s[r])r++;return r?pe(a[r],s[r]):a[r]==p?-1:s[r]==p?1:0}),C},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(T(e),d.matchesSelector&&E&&!N[t+" "]&&(!s||!s.test(t))&&(!v||!v.test(t)))try{var n=c.call(e,t);if(n||d.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){N(t,!0)}return 0<se(t,C,null,[e]).length},se.contains=function(e,t){return(e.ownerDocument||e)!=C&&T(e),y(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=C&&T(e);var n=b.attrHandle[t.toLowerCase()],r=n&&j.call(b.attrHandle,t.toLowerCase())?n(e,t,!E):void 0;return void 0!==r?r:d.attributes||!E?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},se.escape=function(e){return(e+"").replace(re,ie)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],r=0,i=0;if(l=!d.detectDuplicates,u=!d.sortStable&&e.slice(0),e.sort(D),l){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)e.splice(n[r],1)}return u=null,e},o=se.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else while(t=e[r++])n+=o(t);return n},(b=se.selectors={cacheLength:50,createPseudo:le,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=m[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&m(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=se.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(B," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(h,e,t,g,v){var y="nth"!==h.slice(0,3),m="last"!==h.slice(-4),x="of-type"===e;return 1===g&&0===v?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u,l=y!==m?"nextSibling":"previousSibling",c=e.parentNode,f=x&&e.nodeName.toLowerCase(),p=!n&&!x,d=!1;if(c){if(y){while(l){a=e;while(a=a[l])if(x?a.nodeName.toLowerCase()===f:1===a.nodeType)return!1;u=l="only"===h&&!u&&"nextSibling"}return!0}if(u=[m?c.firstChild:c.lastChild],m&&p){d=(s=(r=(i=(o=(a=c)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1])&&r[2],a=s&&c.childNodes[s];while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if(1===a.nodeType&&++d&&a===e){i[h]=[k,s,d];break}}else if(p&&(d=s=(r=(i=(o=(a=e)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1]),!1===d)while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if((x?a.nodeName.toLowerCase()===f:1===a.nodeType)&&++d&&(p&&((i=(o=a[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]=[k,d]),a===e))break;return(d-=v)===g||d%g==0&&0<=d/g}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?le(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=P(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:le(function(e){var r=[],i=[],s=f(e.replace($,"$1"));return s[S]?le(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:le(function(t){return function(e){return 0<se(t,e).length}}),contains:le(function(t){return t=t.replace(te,ne),function(e){return-1<(e.textContent||o(e)).indexOf(t)}}),lang:le(function(n){return V.test(n||"")||se.error("unsupported lang: "+n),n=n.replace(te,ne).toLowerCase(),function(e){var t;do{if(t=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===a},focus:function(e){return e===C.activeElement&&(!C.hasFocus||C.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ve(function(){return[0]}),last:ve(function(e,t){return[t-1]}),eq:ve(function(e,t,n){return[n<0?n+t:n]}),even:ve(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ve(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ve(function(e,t,n){for(var r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:ve(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=de(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=he(e);function me(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function be(s,e,t){var u=e.dir,l=e.next,c=l||u,f=t&&"parentNode"===c,p=r++;return e.first?function(e,t,n){while(e=e[u])if(1===e.nodeType||f)return s(e,t,n);return!1}:function(e,t,n){var r,i,o,a=[k,p];if(n){while(e=e[u])if((1===e.nodeType||f)&&s(e,t,n))return!0}else while(e=e[u])if(1===e.nodeType||f)if(i=(o=e[S]||(e[S]={}))[e.uniqueID]||(o[e.uniqueID]={}),l&&l===e.nodeName.toLowerCase())e=e[u]||e;else{if((r=i[c])&&r[0]===k&&r[1]===p)return a[2]=r[2];if((i[c]=a)[2]=s(e,t,n))return!0}return!1}}function we(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Te(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Ce(d,h,g,v,y,e){return v&&!v[S]&&(v=Ce(v)),y&&!y[S]&&(y=Ce(y,e)),le(function(e,t,n,r){var i,o,a,s=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:Te(c,s,d,n,r),p=g?y||(e?d:l||v)?[]:t:f;if(g&&g(f,p,n,r),v){i=Te(p,u),v(i,[],n,r),o=i.length;while(o--)(a=i[o])&&(p[u[o]]=!(f[u[o]]=a))}if(e){if(y||d){if(y){i=[],o=p.length;while(o--)(a=p[o])&&i.push(f[o]=a);y(null,p=[],i,r)}o=p.length;while(o--)(a=p[o])&&-1<(i=y?P(e,a):s[o])&&(e[i]=!(t[i]=a))}}else p=Te(p===t?p.splice(l,p.length):p),y?y(null,t,p,r):H.apply(t,p)})}function Ee(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=be(function(e){return e===i},a,!0),l=be(function(e){return-1<P(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!==w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[be(we(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return Ce(1<s&&we(c),1<s&&xe(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace($,"$1"),t,s<n&&Ee(e.slice(s,n)),n<r&&Ee(e=e.slice(n)),n<r&&xe(e))}c.push(t)}return we(c)}return me.prototype=b.filters=b.pseudos,b.setFilters=new me,h=se.tokenize=function(e,t){var n,r,i,o,a,s,u,l=x[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=_.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=z.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace($," ")}),a=a.slice(n.length)),b.filter)!(r=G[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?se.error(e):x(e,s).slice(0)},f=se.compile=function(e,t){var n,v,y,m,x,r,i=[],o=[],a=A[e+" "];if(!a){t||(t=h(e)),n=t.length;while(n--)(a=Ee(t[n]))[S]?i.push(a):o.push(a);(a=A(e,(v=o,m=0<(y=i).length,x=0<v.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=k+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==C||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==C||(T(o),n=!E);while(s=v[a++])if(s(o,t||C,n)){r.push(o);break}i&&(k=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=y[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=q.call(r));f=Te(f)}H.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&se.uniqueSort(r)}return i&&(k=h,w=p),c},m?le(r):r))).selector=e}return a},g=se.select=function(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&h(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&E&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(te,ne),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=G.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&(r=u(a.matches[0].replace(te,ne),ee.test(o[0].type)&&ye(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&xe(o)))return H.apply(n,r),n;break}}}return(l||f(e,c))(r,t,!E,n,!t||ee.test(e)&&ye(t.parentNode)||t),n},d.sortStable=S.split("").sort(D).join("")===S,d.detectDuplicates=!!l,T(),d.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(C.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),d.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||fe(R,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),se}(C);S.find=d,S.expr=d.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=d.uniqueSort,S.text=d.getText,S.isXMLDoc=d.isXML,S.contains=d.contains,S.escapeSelector=d.escape;var h=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&S(e).is(n))break;r.push(e)}return r},T=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},k=S.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function D(e,n,r){return m(n)?S.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?S.grep(e,function(e){return e===n!==r}):"string"!=typeof n?S.grep(e,function(e){return-1<i.call(n,e)!==r}):S.filter(n,e,r)}S.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?S.find.matchesSelector(r,e)?[r]:[]:S.find.matches(e,S.grep(t,function(e){return 1===e.nodeType}))},S.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(S(e).filter(function(){for(t=0;t<r;t++)if(S.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)S.find(e,i[t],n);return 1<r?S.uniqueSort(n):n},filter:function(e){return this.pushStack(D(this,e||[],!1))},not:function(e){return this.pushStack(D(this,e||[],!0))},is:function(e){return!!D(this,"string"==typeof e&&k.test(e)?S(e):e||[],!1).length}});var j,q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||j,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:q.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof S?t[0]:t,S.merge(this,S.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:E,!0)),N.test(r[1])&&S.isPlainObject(t))for(r in t)m(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=E.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):m(e)?void 0!==n.ready?n.ready(e):e(S):S.makeArray(e,this)}).prototype=S.fn,j=S(E);var L=/^(?:parents|prev(?:Until|All))/,H={children:!0,contents:!0,next:!0,prev:!0};function O(e,t){while((e=e[t])&&1!==e.nodeType);return e}S.fn.extend({has:function(e){var t=S(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(S.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&S(e);if(!k.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&S.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?S.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?i.call(S(e),this[0]):i.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),S.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return h(e,"parentNode")},parentsUntil:function(e,t,n){return h(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return h(e,"nextSibling")},prevAll:function(e){return h(e,"previousSibling")},nextUntil:function(e,t,n){return h(e,"nextSibling",n)},prevUntil:function(e,t,n){return h(e,"previousSibling",n)},siblings:function(e){return T((e.parentNode||{}).firstChild,e)},children:function(e){return T(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),S.merge([],e.childNodes))}},function(r,i){S.fn[r]=function(e,t){var n=S.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=S.filter(t,n)),1<this.length&&(H[r]||S.uniqueSort(n),L.test(r)&&n.reverse()),this.pushStack(n)}});var P=/[^\x20\t\r\n\f]+/g;function R(e){return e}function M(e){throw e}function I(e,t,n,r){var i;try{e&&m(i=e.promise)?i.call(e).done(t).fail(n):e&&m(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}S.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},S.each(e.match(P)||[],function(e,t){n[t]=!0}),n):S.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){S.each(e,function(e,t){m(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==w(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return S.each(arguments,function(e,t){var n;while(-1<(n=S.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<S.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},S.extend({Deferred:function(e){var o=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return S.Deferred(function(r){S.each(o,function(e,t){var n=m(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&m(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,m(t)?s?t.call(e,l(u,o,R,s),l(u,o,M,s)):(u++,t.call(e,l(u,o,R,s),l(u,o,M,s),l(u,o,R,o.notifyWith))):(a!==R&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(e,t.stackTrace),u<=i+1&&(a!==M&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(S.Deferred.getStackHook&&(t.stackTrace=S.Deferred.getStackHook()),C.setTimeout(t))}}return S.Deferred(function(e){o[0][3].add(l(0,e,m(r)?r:R,e.notifyWith)),o[1][3].add(l(0,e,m(t)?t:R)),o[2][3].add(l(0,e,m(n)?n:M))}).promise()},promise:function(e){return null!=e?S.extend(e,a):a}},s={};return S.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=s.call(arguments),o=S.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?s.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(I(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||m(i[t]&&i[t].then)))return o.then();while(t--)I(i[t],a(t),o.reject);return o.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(e,t){C.console&&C.console.warn&&e&&W.test(e.name)&&C.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},S.readyException=function(e){C.setTimeout(function(){throw e})};var F=S.Deferred();function B(){E.removeEventListener("DOMContentLoaded",B),C.removeEventListener("load",B),S.ready()}S.fn.ready=function(e){return F.then(e)["catch"](function(e){S.readyException(e)}),this},S.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--S.readyWait:S.isReady)||(S.isReady=!0)!==e&&0<--S.readyWait||F.resolveWith(E,[S])}}),S.ready.then=F.then,"complete"===E.readyState||"loading"!==E.readyState&&!E.documentElement.doScroll?C.setTimeout(S.ready):(E.addEventListener("DOMContentLoaded",B),C.addEventListener("load",B));var $=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===w(n))for(s in i=!0,n)$(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,m(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(S(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},_=/^-ms-/,z=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function X(e){return e.replace(_,"ms-").replace(z,U)}var V=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=S.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},V(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[X(t)]=n;else for(r in t)i[X(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(P)||[]).length;while(n--)delete r[t[n]]}(void 0===t||S.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!S.isEmptyObject(t)}};var Y=new G,Q=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:J.test(i)?JSON.parse(i):i)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}S.extend({hasData:function(e){return Q.hasData(e)||Y.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return Y.access(e,t,n)},_removeData:function(e,t){Y.remove(e,t)}}),S.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=Q.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=X(r.slice(5)),Z(o,r,i[r]));Y.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){Q.set(this,n)}):$(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=Q.get(o,n))?t:void 0!==(t=Z(o,n))?t:void 0;this.each(function(){Q.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),S.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y.get(e,t),n&&(!r||Array.isArray(n)?r=Y.access(e,t,S.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=S.queue(e,t),r=n.length,i=n.shift(),o=S._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){S.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y.get(e,n)||Y.access(e,n,{empty:S.Callbacks("once memory").add(function(){Y.remove(e,[t+"queue",n])})})}}),S.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?S.queue(this[0],t):void 0===n?this:this.each(function(){var e=S.queue(this,t,n);S._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&S.dequeue(this,t)})},dequeue:function(e){return this.each(function(){S.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=S.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=Y.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],re=E.documentElement,ie=function(e){return S.contains(e.ownerDocument,e)},oe={composed:!0};re.getRootNode&&(ie=function(e){return S.contains(e.ownerDocument,e)||e.getRootNode(oe)===e.ownerDocument});var ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ie(e)&&"none"===S.css(e,"display")};function se(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return S.css(e,t,"")},u=s(),l=n&&n[3]||(S.cssNumber[t]?"":"px"),c=e.nodeType&&(S.cssNumber[t]||"px"!==l&&+u)&&te.exec(S.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)S.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,S.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ue={};function le(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=Y.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ae(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ue[s])||(o=a.body.appendChild(a.createElement(s)),u=S.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ue[s]=u)))):"none"!==n&&(l[c]="none",Y.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}S.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?S(this).show():S(this).hide()})}});var ce,fe,pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,he=/^$|^module$|\/(?:java|ecma)script/i;ce=E.createDocumentFragment().appendChild(E.createElement("div")),(fe=E.createElement("input")).setAttribute("type","radio"),fe.setAttribute("checked","checked"),fe.setAttribute("name","t"),ce.appendChild(fe),y.checkClone=ce.cloneNode(!0).cloneNode(!0).lastChild.checked,ce.innerHTML="<textarea>x</textarea>",y.noCloneChecked=!!ce.cloneNode(!0).lastChild.defaultValue,ce.innerHTML="<option></option>",y.option=!!ce.lastChild;var ge={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ve(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?S.merge([e],n):n}function ye(e,t){for(var n=0,r=e.length;n<r;n++)Y.set(e[n],"globalEval",!t||Y.get(t[n],"globalEval"))}ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,y.option||(ge.optgroup=ge.option=[1,"<select multiple='multiple'>","</select>"]);var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===w(o))S.merge(p,o.nodeType?[o]:o);else if(me.test(o)){a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+S.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;S.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<S.inArray(o,r))i&&i.push(o);else if(l=ie(o),a=ve(f.appendChild(o),"script"),l&&ye(a),n){c=0;while(o=a[c++])he.test(o.type||"")&&n.push(o)}return f}var be=/^key/,we=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Te=/^([^.]*)(?:\.(.+)|)/;function Ce(){return!0}function Ee(){return!1}function Se(e,t){return e===function(){try{return E.activeElement}catch(e){}}()==("focus"===t)}function ke(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)ke(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Ee;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return S().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=S.guid++)),e.each(function(){S.event.add(this,t,i,r,n)})}function Ae(e,i,o){o?(Y.set(e,i,!1),S.event.add(e,i,{namespace:!1,handler:function(e){var t,n,r=Y.get(this,i);if(1&e.isTrigger&&this[i]){if(r.length)(S.event.special[i]||{}).delegateType&&e.stopPropagation();else if(r=s.call(arguments),Y.set(this,i,r),t=o(this,i),this[i](),r!==(n=Y.get(this,i))||t?Y.set(this,i,!1):n={},r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n.value}else r.length&&(Y.set(this,i,{value:S.event.trigger(S.extend(r[0],S.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Y.get(e,i)&&S.event.add(e,i,Ce)}S.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.get(t);if(V(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&S.find.matchesSelector(re,i),n.guid||(n.guid=S.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(P)||[""]).length;while(l--)d=g=(s=Te.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=S.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=S.event.special[d]||{},c=S.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&S.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),S.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.hasData(e)&&Y.get(e);if(v&&(u=v.events)){l=(t=(t||"").match(P)||[""]).length;while(l--)if(d=g=(s=Te.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){f=S.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||S.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)S.event.remove(e,d+t[l],n,r,!0);S.isEmptyObject(u)&&Y.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=S.event.fix(e),l=(Y.get(this,"events")||Object.create(null))[u.type]||[],c=S.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=S.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((S.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<S(i,this).index(l):S.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:m(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Ae(t,"click",Ce),!1},trigger:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Ae(t,"click"),!0},_default:function(e){var t=e.target;return pe.test(t.type)&&t.click&&A(t,"input")&&Y.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},S.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},S.Event=function(e,t){if(!(this instanceof S.Event))return new S.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ce:Ee,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&S.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:Ee,isPropagationStopped:Ee,isImmediatePropagationStopped:Ee,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ce,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ce,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ce,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&be.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&we.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},function(e,t){S.event.special[e]={setup:function(){return Ae(this,e,Se),!1},trigger:function(){return Ae(this,e),!0},delegateType:t}}),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){S.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||S.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),S.fn.extend({on:function(e,t,n,r){return ke(this,e,t,n,r)},one:function(e,t,n,r){return ke(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,S(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Ee),this.each(function(){S.event.remove(this,e,n,t)})}});var Ne=/<script|<style|<link/i,De=/checked\s*(?:[^=]|=\s*.checked.)/i,je=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function qe(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&S(e).children("tbody")[0]||e}function Le(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function He(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Oe(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(Y.hasData(e)&&(s=Y.get(e).events))for(i in Y.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)S.event.add(t,i,s[i][n]);Q.hasData(e)&&(o=Q.access(e),a=S.extend({},o),Q.set(t,a))}}function Pe(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=m(d);if(h||1<f&&"string"==typeof d&&!y.checkClone&&De.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),Pe(t,r,i,o)});if(f&&(t=(e=xe(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=S.map(ve(e,"script"),Le)).length;c<f;c++)u=e,c!==p&&(u=S.clone(u,!0,!0),s&&S.merge(a,ve(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,S.map(a,He),c=0;c<s;c++)u=a[c],he.test(u.type||"")&&!Y.access(u,"globalEval")&&S.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?S._evalUrl&&!u.noModule&&S._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):b(u.textContent.replace(je,""),u,l))}return n}function Re(e,t,n){for(var r,i=t?S.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||S.cleanData(ve(r)),r.parentNode&&(n&&ie(r)&&ye(ve(r,"script")),r.parentNode.removeChild(r));return e}S.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=ie(e);if(!(y.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||S.isXMLDoc(e)))for(a=ve(c),r=0,i=(o=ve(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&pe.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||ve(e),a=a||ve(c),r=0,i=o.length;r<i;r++)Oe(o[r],a[r]);else Oe(e,c);return 0<(a=ve(c,"script")).length&&ye(a,!f&&ve(e,"script")),c},cleanData:function(e){for(var t,n,r,i=S.event.special,o=0;void 0!==(n=e[o]);o++)if(V(n)){if(t=n[Y.expando]){if(t.events)for(r in t.events)i[r]?S.event.remove(n,r):S.removeEvent(n,r,t.handle);n[Y.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),S.fn.extend({detach:function(e){return Re(this,e,!0)},remove:function(e){return Re(this,e)},text:function(e){return $(this,function(e){return void 0===e?S.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return Pe(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||qe(this,e).appendChild(e)})},prepend:function(){return Pe(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=qe(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Pe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Pe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(S.cleanData(ve(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return S.clone(this,e,t)})},html:function(e){return $(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ne.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(S.cleanData(ve(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return Pe(this,arguments,function(e){var t=this.parentNode;S.inArray(this,n)<0&&(S.cleanData(ve(this)),t&&t.replaceChild(e,this))},n)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){S.fn[e]=function(e){for(var t,n=[],r=S(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),S(r[o])[a](t),u.apply(n,t.get());return this.pushStack(n)}});var Me=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Ie=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=C),t.getComputedStyle(e)},We=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Fe=new RegExp(ne.join("|"),"i");function Be(e,t,n){var r,i,o,a,s=e.style;return(n=n||Ie(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||ie(e)||(a=S.style(e,t)),!y.pixelBoxStyles()&&Me.test(a)&&Fe.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function $e(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(u).appendChild(l);var e=C.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),re.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=E.createElement("div"),l=E.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",y.clearCloneStyle="content-box"===l.style.backgroundClip,S.extend(y,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=E.createElement("table"),t=E.createElement("tr"),n=E.createElement("div"),e.style.cssText="position:absolute;left:-11111px",t.style.height="1px",n.style.height="9px",re.appendChild(e).appendChild(t).appendChild(n),r=C.getComputedStyle(t),a=3<parseInt(r.height),re.removeChild(e)),a}}))}();var _e=["Webkit","Moz","ms"],ze=E.createElement("div").style,Ue={};function Xe(e){var t=S.cssProps[e]||Ue[e];return t||(e in ze?e:Ue[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=_e.length;while(n--)if((e=_e[n]+t)in ze)return e}(e)||e)}var Ve=/^(none|table(?!-c[ea]).+)/,Ge=/^--/,Ye={position:"absolute",visibility:"hidden",display:"block"},Qe={letterSpacing:"0",fontWeight:"400"};function Je(e,t,n){var r=te.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Ke(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=S.css(e,n+ne[a],!0,i)),r?("content"===n&&(u-=S.css(e,"padding"+ne[a],!0,i)),"margin"!==n&&(u-=S.css(e,"border"+ne[a]+"Width",!0,i))):(u+=S.css(e,"padding"+ne[a],!0,i),"padding"!==n?u+=S.css(e,"border"+ne[a]+"Width",!0,i):s+=S.css(e,"border"+ne[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u}function Ze(e,t,n){var r=Ie(e),i=(!y.boxSizingReliable()||n)&&"border-box"===S.css(e,"boxSizing",!1,r),o=i,a=Be(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Me.test(a)){if(!n)return a;a="auto"}return(!y.boxSizingReliable()&&i||!y.reliableTrDimensions()&&A(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===S.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===S.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+Ke(e,t,n||(i?"border":"content"),o,r,a)+"px"}function et(e,t,n,r,i){return new et.prototype.init(e,t,n,r,i)}S.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Be(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=X(t),u=Ge.test(t),l=e.style;if(u||(t=Xe(s)),a=S.cssHooks[t]||S.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=te.exec(n))&&i[1]&&(n=se(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(S.cssNumber[s]?"":"px")),y.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=X(t);return Ge.test(t)||(t=Xe(s)),(a=S.cssHooks[t]||S.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Be(e,t,r)),"normal"===i&&t in Qe&&(i=Qe[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),S.each(["height","width"],function(e,u){S.cssHooks[u]={get:function(e,t,n){if(t)return!Ve.test(S.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Ze(e,u,n):We(e,Ye,function(){return Ze(e,u,n)})},set:function(e,t,n){var r,i=Ie(e),o=!y.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===S.css(e,"boxSizing",!1,i),s=n?Ke(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-Ke(e,u,"border",!1,i)-.5)),s&&(r=te.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=S.css(e,u)),Je(0,t,s)}}}),S.cssHooks.marginLeft=$e(y.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Be(e,"marginLeft"))||e.getBoundingClientRect().left-We(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),S.each({margin:"",padding:"",border:"Width"},function(i,o){S.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+ne[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(S.cssHooks[i+o].set=Je)}),S.fn.extend({css:function(e,t){return $(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Ie(e),i=t.length;a<i;a++)o[t[a]]=S.css(e,t[a],!1,r);return o}return void 0!==n?S.style(e,t,n):S.css(e,t)},e,t,1<arguments.length)}}),((S.Tween=et).prototype={constructor:et,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||S.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(S.cssNumber[n]?"":"px")},cur:function(){var e=et.propHooks[this.prop];return e&&e.get?e.get(this):et.propHooks._default.get(this)},run:function(e){var t,n=et.propHooks[this.prop];return this.options.duration?this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):et.propHooks._default.set(this),this}}).init.prototype=et.prototype,(et.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=S.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){S.fx.step[e.prop]?S.fx.step[e.prop](e):1!==e.elem.nodeType||!S.cssHooks[e.prop]&&null==e.elem.style[Xe(e.prop)]?e.elem[e.prop]=e.now:S.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=et.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},S.fx=et.prototype.init,S.fx.step={};var tt,nt,rt,it,ot=/^(?:toggle|show|hide)$/,at=/queueHooks$/;function st(){nt&&(!1===E.hidden&&C.requestAnimationFrame?C.requestAnimationFrame(st):C.setTimeout(st,S.fx.interval),S.fx.tick())}function ut(){return C.setTimeout(function(){tt=void 0}),tt=Date.now()}function lt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ne[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ct(e,t,n){for(var r,i=(ft.tweeners[t]||[]).concat(ft.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function ft(o,e,t){var n,a,r=0,i=ft.prefilters.length,s=S.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=tt||ut(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},t),originalProperties:e,originalOptions:t,startTime:tt||ut(),duration:t.duration,tweens:[],createTween:function(e,t){var n=S.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=X(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=S.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=ft.prefilters[r].call(l,o,c,l.opts))return m(n.stop)&&(S._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return S.map(c,ct,l),m(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),S.fx.timer(S.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}S.Animation=S.extend(ft,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return se(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){m(e)?(t=e,e=["*"]):e=e.match(P);for(var n,r=0,i=e.length;r<i;r++)n=e[r],ft.tweeners[n]=ft.tweeners[n]||[],ft.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),v=Y.get(e,"fxshow");for(r in n.queue||(null==(a=S._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,S.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],ot.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||S.style(e,r)}if((u=!S.isEmptyObject(t))||!S.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=Y.get(e,"display")),"none"===(c=S.css(e,"display"))&&(l?c=l:(le([e],!0),l=e.style.display||l,c=S.css(e,"display"),le([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===S.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=Y.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&le([e],!0),p.done(function(){for(r in g||le([e]),Y.remove(e,"fxshow"),d)S.style(e,r,d[r])})),u=ct(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?ft.prefilters.unshift(e):ft.prefilters.push(e)}}),S.speed=function(e,t,n){var r=e&&"object"==typeof e?S.extend({},e):{complete:n||!n&&t||m(e)&&e,duration:e,easing:n&&t||t&&!m(t)&&t};return S.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in S.fx.speeds?r.duration=S.fx.speeds[r.duration]:r.duration=S.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){m(r.old)&&r.old.call(this),r.queue&&S.dequeue(this,r.queue)},r},S.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=S.isEmptyObject(t),o=S.speed(e,n,r),a=function(){var e=ft(this,S.extend({},t),o);(i||Y.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=S.timers,r=Y.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&at.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||S.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=Y.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=S.timers,o=n?n.length:0;for(t.finish=!0,S.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),S.each(["toggle","show","hide"],function(e,r){var i=S.fn[r];S.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(lt(r,!0),e,t,n)}}),S.each({slideDown:lt("show"),slideUp:lt("hide"),slideToggle:lt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){S.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),S.timers=[],S.fx.tick=function(){var e,t=0,n=S.timers;for(tt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||S.fx.stop(),tt=void 0},S.fx.timer=function(e){S.timers.push(e),S.fx.start()},S.fx.interval=13,S.fx.start=function(){nt||(nt=!0,st())},S.fx.stop=function(){nt=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(r,e){return r=S.fx&&S.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=C.setTimeout(e,r);t.stop=function(){C.clearTimeout(n)}})},rt=E.createElement("input"),it=E.createElement("select").appendChild(E.createElement("option")),rt.type="checkbox",y.checkOn=""!==rt.value,y.optSelected=it.selected,(rt=E.createElement("input")).value="t",rt.type="radio",y.radioValue="t"===rt.value;var pt,dt=S.expr.attrHandle;S.fn.extend({attr:function(e,t){return $(this,S.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){S.removeAttr(this,e)})}}),S.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?S.prop(e,t,n):(1===o&&S.isXMLDoc(e)||(i=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?pt:void 0)),void 0!==n?null===n?void S.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=S.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!y.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(P);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),pt={set:function(e,t,n){return!1===t?S.removeAttr(e,n):e.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),function(e,t){var a=dt[t]||S.find.attr;dt[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=dt[o],dt[o]=r,r=null!=a(e,t,n)?o:null,dt[o]=i),r}});var ht=/^(?:input|select|textarea|button)$/i,gt=/^(?:a|area)$/i;function vt(e){return(e.match(P)||[]).join(" ")}function yt(e){return e.getAttribute&&e.getAttribute("class")||""}function mt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(P)||[]}S.fn.extend({prop:function(e,t){return $(this,S.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[S.propFix[e]||e]})}}),S.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(e)||(t=S.propFix[t]||t,i=S.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");return t?parseInt(t,10):ht.test(e.nodeName)||gt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),y.optSelected||(S.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this}),S.fn.extend({addClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).addClass(t.call(this,e,yt(this)))});if((e=mt(t)).length)while(n=this[u++])if(i=yt(n),r=1===n.nodeType&&" "+vt(i)+" "){a=0;while(o=e[a++])r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=vt(r))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).removeClass(t.call(this,e,yt(this)))});if(!arguments.length)return this.attr("class","");if((e=mt(t)).length)while(n=this[u++])if(i=yt(n),r=1===n.nodeType&&" "+vt(i)+" "){a=0;while(o=e[a++])while(-1<r.indexOf(" "+o+" "))r=r.replace(" "+o+" "," ");i!==(s=vt(r))&&n.setAttribute("class",s)}return this},toggleClass:function(i,t){var o=typeof i,a="string"===o||Array.isArray(i);return"boolean"==typeof t&&a?t?this.addClass(i):this.removeClass(i):m(i)?this.each(function(e){S(this).toggleClass(i.call(this,e,yt(this),t),t)}):this.each(function(){var e,t,n,r;if(a){t=0,n=S(this),r=mt(i);while(e=r[t++])n.hasClass(e)?n.removeClass(e):n.addClass(e)}else void 0!==i&&"boolean"!==o||((e=yt(this))&&Y.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===i?"":Y.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+vt(yt(n))+" ").indexOf(t))return!0;return!1}});var xt=/\r/g;S.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=m(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,S(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=S.map(t,function(e){return null==e?"":e+""})),(r=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=S.valHooks[t.type]||S.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(xt,""):null==e?"":e:void 0}}),S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return null!=t?t:vt(S.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=S(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=S.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<S.inArray(S.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<S.inArray(S(e).val(),t)}},y.checkOn||(S.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),y.focusin="onfocusin"in C;var bt=/^(?:focusinfocus|focusoutblur)$/,wt=function(e){e.stopPropagation()};S.extend(S.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||E],d=v.call(e,"type")?e.type:e,h=v.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||E,3!==n.nodeType&&8!==n.nodeType&&!bt.test(d+S.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[S.expando]?e:new S.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:S.makeArray(t,[e]),c=S.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!x(n)){for(s=c.delegateType||d,bt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||E)&&p.push(a.defaultView||a.parentWindow||C)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(Y.get(o,"events")||Object.create(null))[e.type]&&Y.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&V(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!V(n)||u&&m(n[d])&&!x(n)&&((a=n[u])&&(n[u]=null),S.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,wt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,wt),S.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=S.extend(new S.Event,n,{type:e,isSimulated:!0});S.event.trigger(r,null,t)}}),S.fn.extend({trigger:function(e,t){return this.each(function(){S.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return S.event.trigger(e,t,n,!0)}}),y.focusin||S.each({focus:"focusin",blur:"focusout"},function(n,r){var i=function(e){S.event.simulate(r,e.target,S.event.fix(e))};S.event.special[r]={setup:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r);t||e.addEventListener(n,i,!0),Y.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r)-1;t?Y.access(e,r,t):(e.removeEventListener(n,i,!0),Y.remove(e,r))}}});var Tt=C.location,Ct={guid:Date.now()},Et=/\?/;S.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new C.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||S.error("Invalid XML: "+e),t};var St=/\[\]$/,kt=/\r?\n/g,At=/^(?:submit|button|image|reset|file)$/i,Nt=/^(?:input|select|textarea|keygen)/i;function Dt(n,e,r,i){var t;if(Array.isArray(e))S.each(e,function(e,t){r||St.test(n)?i(n,t):Dt(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==w(e))i(n,e);else for(t in e)Dt(n+"["+t+"]",e[t],r,i)}S.param=function(e,t){var n,r=[],i=function(e,t){var n=m(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!S.isPlainObject(e))S.each(e,function(){i(this.name,this.value)});else for(n in e)Dt(n,e[n],t,i);return r.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&Nt.test(this.nodeName)&&!At.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,function(e){return{name:t.name,value:e.replace(kt,"\r\n")}}):{name:t.name,value:n.replace(kt,"\r\n")}}).get()}});var jt=/%20/g,qt=/#.*$/,Lt=/([?&])_=[^&]*/,Ht=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ot=/^(?:GET|HEAD)$/,Pt=/^\/\//,Rt={},Mt={},It="*/".concat("*"),Wt=E.createElement("a");function Ft(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(P)||[];if(m(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Bt(t,i,o,a){var s={},u=t===Mt;function l(e){var r;return s[e]=!0,S.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function $t(e,t){var n,r,i=S.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&S.extend(!0,e,r),e}Wt.href=Tt.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Tt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Tt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":It,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?$t($t(e,S.ajaxSettings),t):$t(S.ajaxSettings,e)},ajaxPrefilter:Ft(Rt),ajaxTransport:Ft(Mt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,v=S.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?S(y):S.event,x=S.Deferred(),b=S.Callbacks("once memory"),w=v.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=Ht.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(v.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),v.url=((e||v.url||Tt.href)+"").replace(Pt,Tt.protocol+"//"),v.type=t.method||t.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(P)||[""],null==v.crossDomain){r=E.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Wt.protocol+"//"+Wt.host!=r.protocol+"//"+r.host}catch(e){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=S.param(v.data,v.traditional)),Bt(Rt,v,t,T),h)return T;for(i in(g=S.event&&v.global)&&0==S.active++&&S.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Ot.test(v.type),f=v.url.replace(qt,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&(v.data=v.data.replace(jt,"+")):(o=v.url.slice(f.length),v.data&&(v.processData||"string"==typeof v.data)&&(f+=(Et.test(f)?"&":"?")+v.data,delete v.data),!1===v.cache&&(f=f.replace(Lt,"$1"),o=(Et.test(f)?"&":"?")+"_="+Ct.guid+++o),v.url=f+o),v.ifModified&&(S.lastModified[f]&&T.setRequestHeader("If-Modified-Since",S.lastModified[f]),S.etag[f]&&T.setRequestHeader("If-None-Match",S.etag[f])),(v.data&&v.hasContent&&!1!==v.contentType||t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),T.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+It+"; q=0.01":""):v.accepts["*"]),v.headers)T.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(y,T,v)||h))return T.abort();if(u="abort",b.add(v.complete),T.done(v.success),T.fail(v.error),c=Bt(Mt,v,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,v]),h)return T;v.async&&0<v.timeout&&(d=C.setTimeout(function(){T.abort("timeout")},v.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&C.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,T,n)),!i&&-1<S.inArray("script",v.dataTypes)&&(v.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(v,s,T,i),i?(v.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(S.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(S.etag[f]=u)),204===e||"HEAD"===v.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(y,[o,l,T]):x.rejectWith(y,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,v,i?o:a]),b.fireWith(y,[T,l]),g&&(m.trigger("ajaxComplete",[T,v]),--S.active||S.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return S.get(e,t,n,"json")},getScript:function(e,t){return S.get(e,void 0,t,"script")}}),S.each(["get","post"],function(e,i){S[i]=function(e,t,n,r){return m(t)&&(r=r||n,n=t,t=void 0),S.ajax(S.extend({url:e,type:i,dataType:r,data:t,success:n},S.isPlainObject(e)&&e))}}),S.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),S._evalUrl=function(e,t,n){return S.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){S.globalEval(e,t,n)}})},S.fn.extend({wrapAll:function(e){var t;return this[0]&&(m(e)&&(e=e.call(this[0])),t=S(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return m(n)?this.each(function(e){S(this).wrapInner(n.call(this,e))}):this.each(function(){var e=S(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=m(t);return this.each(function(e){S(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){S(this).replaceWith(this.childNodes)}),this}}),S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)},S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new C.XMLHttpRequest}catch(e){}};var _t={0:200,1223:204},zt=S.ajaxSettings.xhr();y.cors=!!zt&&"withCredentials"in zt,y.ajax=zt=!!zt,S.ajaxTransport(function(i){var o,a;if(y.cors||zt&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(_t[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&C.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),S.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return S.globalEval(e),e}}}),S.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),S.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=S("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),E.head.appendChild(r[0])},abort:function(){i&&i()}}});var Ut,Xt=[],Vt=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Xt.pop()||S.expando+"_"+Ct.guid++;return this[e]=!0,e}}),S.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Vt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Vt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=m(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Vt,"$1"+r):!1!==e.jsonp&&(e.url+=(Et.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||S.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=C[r],C[r]=function(){o=arguments},n.always(function(){void 0===i?S(C).removeProp(r):C[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Xt.push(r)),o&&m(i)&&i(o[0]),o=i=void 0}),"script"}),y.createHTMLDocument=((Ut=E.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ut.childNodes.length),S.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(y.createHTMLDocument?((r=(t=E.implementation.createHTMLDocument("")).createElement("base")).href=E.location.href,t.head.appendChild(r)):t=E),o=!n&&[],(i=N.exec(e))?[t.createElement(i[1])]:(i=xe([e],t,o),o&&o.length&&S(o).remove(),S.merge([],i.childNodes)));var r,i,o},S.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=vt(e.slice(s)),e=e.slice(0,s)),m(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&S.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?S("<div>").append(S.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},S.expr.pseudos.animated=function(t){return S.grep(S.timers,function(e){return t===e.elem}).length},S.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=S.css(e,"position"),c=S(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=S.css(e,"top"),u=S.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),m(t)&&(t=t.call(e,n,S.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):("number"==typeof f.top&&(f.top+="px"),"number"==typeof f.left&&(f.left+="px"),c.css(f))}},S.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){S.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===S.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===S.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=S(e).offset()).top+=S.css(e,"borderTopWidth",!0),i.left+=S.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-S.css(r,"marginTop",!0),left:t.left-i.left-S.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===S.css(e,"position"))e=e.offsetParent;return e||re})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;S.fn[t]=function(e){return $(this,function(e,t,n){var r;if(x(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),S.each(["top","left"],function(e,n){S.cssHooks[n]=$e(y.pixelPosition,function(e,t){if(t)return t=Be(e,n),Me.test(t)?S(e).position()[n]+"px":t})}),S.each({Height:"height",Width:"width"},function(a,s){S.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){S.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return $(this,function(e,t,n){var r;return x(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?S.css(e,t,i):S.style(e,t,n,i)},s,n?e:void 0,n)}})}),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){S.fn[t]=function(e){return this.on(t,e)}}),S.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){S.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var Gt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),m(e))return r=s.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(s.call(arguments)))}).guid=e.guid=e.guid||S.guid++,i},S.holdReady=function(e){e?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=A,S.isFunction=m,S.isWindow=x,S.camelCase=X,S.type=w,S.now=Date.now,S.isNumeric=function(e){var t=S.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},S.trim=function(e){return null==e?"":(e+"").replace(Gt,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return S});var Yt=C.jQuery,Qt=C.$;return S.noConflict=function(e){return C.$===S&&(C.$=Qt),e&&C.jQuery===S&&(C.jQuery=Yt),S},"undefined"==typeof e&&(C.jQuery=C.$=S),S});
/*!
* Bootstrap.js by @fat & @mdo
* Copyright 2013 Twitter, Inc.
* http://www.apache.org/licenses/LICENSE-2.0.txt
*/
!function(e){"use strict";e(function(){e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed").remove()}var n=e(this),r=n.attr("data-target"),i;r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),i=e(r),t&&t.preventDefault(),i.length||(i=n.hasClass("alert")?n:n.parent()),i.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,s):s()};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.alert.data-api",t,n.prototype.close)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},getActiveIndex:function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},to:function(t){var n=this.getActiveIndex(),r=this;if(t>this.$items.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){r.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",e(this.$items[t]))},pause:function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".item.active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this,f;this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u](),f=e.Event("slide",{relatedTarget:i[0],direction:o});if(i.hasClass("active"))return;this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var t=e(a.$indicators.children()[a.getActiveIndex()]);t&&t.addClass("active")}));if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger("slid")},0)})}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.pause().cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=e.extend({},i.data(),n.data()),o;i.carousel(s),(o=n.attr("data-slide-to"))&&i.data("carousel").pause().to(o).cycle(),t.preventDefault()})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning||this.$element.hasClass("in"))return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),e.support.transition&&this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning||!this.$element.hasClass("in"))return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=e.extend({},e.fn.collapse.defaults,r.data(),typeof n=="object"&&n);i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();n[e(i).hasClass("in")?"addClass":"removeClass"]("collapsed"),e(i).collapse(s)})}(window.jQuery),!function(e){"use strict";function r(){e(".dropdown-backdrop").remove(),e(t).each(function(){i(e(this)).removeClass("open")})}function i(t){var n=t.attr("data-target"),r;n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),r=n&&e(n);if(!r||!r.length)r=t.parent();return r}var t="[data-toggle=dropdown]",n=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),s,o;if(n.is(".disabled, :disabled"))return;return s=i(n),o=s.hasClass("open"),r(),o||("ontouchstart"in document.documentElement&&e('<div class="dropdown-backdrop"/>').insertBefore(e(this)).on("click",r),s.toggleClass("open")),n.focus(),!1},keydown:function(n){var r,s,o,u,a,f;if(!/(38|40|27)/.test(n.keyCode))return;r=e(this),n.preventDefault(),n.stopPropagation();if(r.is(".disabled, :disabled"))return;u=i(r),a=u.hasClass("open");if(!a||a&&n.keyCode==27)return n.which==27&&u.find(t).focus(),r.click();s=e("[role=menu] li:not(.divider):visible a",u);if(!s.length)return;f=s.index(s.filter(":focus")),n.keyCode==38&&f>0&&f--,n.keyCode==40&&f<s.length-1&&f++,~f||(f=0),s.eq(f).focus()}};var s=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data("dropdown");i||r.data("dropdown",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.dropdown.Constructor=n,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on("click.dropdown.data-api",r).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api",t,n.prototype.toggle).on("keydown.dropdown.data-api",t+", [role=menu]",n.prototype.keydown)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t):t()):t&&t()}};var n=e.fn.modal;e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s).one("hide",function(){n.focus()})})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s,o,u,a;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,o=this.options.trigger.split(" ");for(a=o.length;a--;)u=o[a],u=="click"?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):u!="manual"&&(i=u=="hover"?"mouseenter":"focus",s=u=="hover"?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this)));this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e.fn[this.type].defaults,r={},i;this._options&&e.each(this._options,function(e,t){n[e]!=t&&(r[e]=t)},this),i=e(t.currentTarget)[this.type](r).data(this.type);if(!i.options.delay||!i.options.delay.show)return i.show();clearTimeout(this.timeout),i.hoverState="in",this.timeout=setTimeout(function(){i.hoverState=="in"&&i.show()},i.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var t,n,r,i,s,o,u=e.Event("show");if(this.hasContent()&&this.enabled){this.$element.trigger(u);if(u.isDefaultPrevented())return;t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:"block"}),this.options.container?t.appendTo(this.options.container):t.insertAfter(this.$element),n=this.getPosition(),r=t[0].offsetWidth,i=t[0].offsetHeight;switch(s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}this.applyPlacement(o,s),this.$element.trigger("shown")}},applyPlacement:function(e,t){var n=this.tip(),r=n[0].offsetWidth,i=n[0].offsetHeight,s,o,u,a;n.offset(e).addClass(t).addClass("in"),s=n[0].offsetWidth,o=n[0].offsetHeight,t=="top"&&o!=i&&(e.top=e.top+i-o,a=!0),t=="bottom"||t=="top"?(u=0,e.left<0&&(u=e.left*-2,e.left=0,n.offset(e),s=n[0].offsetWidth,o=n[0].offsetHeight),this.replaceArrow(u-r+s,s,"left")):this.replaceArrow(o-i,o,"top"),a&&n.offset(e)},replaceArrow:function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function i(){var t=setTimeout(function(){n.off(e.support.transition.end).detach()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.detach()})}var t=this,n=this.tip(),r=e.Event("hide");this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i():n.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=t?e(t.currentTarget)[this.type](this._options).data(this.type):this;n.tip().hasClass("in")?n.hide():n.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=(typeof n.content=="function"?n.content.call(t[0]):n.content)||t.attr("data-content"),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(window.jQuery),!function(e){"use strict";function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll-spy.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var n=e(this),r=n.data("target")||n.attr("href"),i=/^#\w/.test(r)&&e(r);return i&&i.length&&[[i.position().top+(!e.isWindow(t.$scrollElement.get(0))&&t.$scrollElement.scrollTop()),r]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(r).parent("li").addClass("active"),n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}};var n=e.fn.scrollspy;e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active:last a")[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var i=n.find("> .active"),s=r&&e.support.transition&&i.hasClass("fade");s?i.one(e.support.transition.end,o):o(),i.removeClass("in")}};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=e(this.options.menu),this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=e.grep(t,function(e){return n.matcher(e)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr("data-value",r),t.find("a").html(n.highlighter(r)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this))},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t=typeof this.$element[e]=="function"),t},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(e){this.focused=!0},blur:function(e){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var n=e.fn.typeahead;e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=n,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;n.typeahead(n.data())})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=e.extend({},e.fn.affix.defaults,n),this.$window=e(window).on("scroll.affix.data-api",e.proxy(this.checkPosition,this)).on("click.affix.data-api",e.proxy(function(){setTimeout(e.proxy(this.checkPosition,this),1)},this)),this.$element=e(t),this.checkPosition()};t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var t=e(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),i=this.options.offset,s=i.bottom,o=i.top,u="affix affix-top affix-bottom",a;typeof i!="object"&&(s=o=i),typeof o=="function"&&(o=i.top()),typeof s=="function"&&(s=i.bottom()),a=this.unpin!=null&&n+this.unpin<=r.top?!1:s!=null&&r.top+this.$element.height()>=t-s?"bottom":o!=null&&n<=o?"top":!1;if(this.affixed===a)return;this.affixed=a,this.unpin=a=="bottom"?r.top-n:null,this.$element.removeClass(u).addClass("affix"+(a?"-"+a:""))};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("affix"),s=typeof n=="object"&&n;i||r.data("affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.defaults={offset:0},e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery);
/*
Copyright 2012 Igor Vaynberg

Version: 3.4.5 Timestamp: Mon Nov  4 08:22:42 PST 2013

This software is licensed under the Apache License, Version 2.0 (the "Apache License") or the GNU
General Public License version 2 (the "GPL License"). You may choose either license to govern your
use of this software only upon the condition that you accept all of the terms of either the Apache
License or the GPL License.

You may obtain a copy of the Apache License and the GPL License at:

http://www.apache.org/licenses/LICENSE-2.0
http://www.gnu.org/licenses/gpl-2.0.html

Unless required by applicable law or agreed to in writing, software distributed under the Apache License
or the GPL Licesnse is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
either express or implied. See the Apache License and the GPL License for the specific language governing
permissions and limitations under the Apache License and the GPL License.
*/
!function(a){"undefined"==typeof a.fn.each2&&a.extend(a.fn,{each2:function(b){for(var c=a([0]),d=-1,e=this.length;++d<e&&(c.context=c[0]=this[d])&&b.call(c[0],d,c)!==!1;);return this}})}(jQuery),function(a,b){"use strict";function n(a){var b,c,d,e;if(!a||a.length<1)return a;for(b="",c=0,d=a.length;d>c;c++)e=a.charAt(c),b+=m[e]||e;return b}function o(a,b){for(var c=0,d=b.length;d>c;c+=1)if(q(a,b[c]))return c;return-1}function p(){var b=a(l);b.appendTo("body");var c={width:b.width()-b[0].clientWidth,height:b.height()-b[0].clientHeight};return b.remove(),c}function q(a,c){return a===c?!0:a===b||c===b?!1:null===a||null===c?!1:a.constructor===String?a+""==c+"":c.constructor===String?c+""==a+"":!1}function r(b,c){var d,e,f;if(null===b||b.length<1)return[];for(d=b.split(c),e=0,f=d.length;f>e;e+=1)d[e]=a.trim(d[e]);return d}function s(a){return a.outerWidth(!1)-a.width()}function t(c){var d="keyup-change-value";c.on("keydown",function(){a.data(c,d)===b&&a.data(c,d,c.val())}),c.on("keyup",function(){var e=a.data(c,d);e!==b&&c.val()!==e&&(a.removeData(c,d),c.trigger("keyup-change"))})}function u(c){c.on("mousemove",function(c){var d=i;(d===b||d.x!==c.pageX||d.y!==c.pageY)&&a(c.target).trigger("mousemove-filtered",c)})}function v(a,c,d){d=d||b;var e;return function(){var b=arguments;window.clearTimeout(e),e=window.setTimeout(function(){c.apply(d,b)},a)}}function w(a){var c,b=!1;return function(){return b===!1&&(c=a(),b=!0),c}}function x(a,b){var c=v(a,function(a){b.trigger("scroll-debounced",a)});b.on("scroll",function(a){o(a.target,b.get())>=0&&c(a)})}function y(a){a[0]!==document.activeElement&&window.setTimeout(function(){var d,b=a[0],c=a.val().length;a.focus(),a.is(":visible")&&b===document.activeElement&&(b.setSelectionRange?b.setSelectionRange(c,c):b.createTextRange&&(d=b.createTextRange(),d.collapse(!1),d.select()))},0)}function z(b){b=a(b)[0];var c=0,d=0;if("selectionStart"in b)c=b.selectionStart,d=b.selectionEnd-c;else if("selection"in document){b.focus();var e=document.selection.createRange();d=document.selection.createRange().text.length,e.moveStart("character",-b.value.length),c=e.text.length-d}return{offset:c,length:d}}function A(a){a.preventDefault(),a.stopPropagation()}function B(a){a.preventDefault(),a.stopImmediatePropagation()}function C(b){if(!h){var c=b[0].currentStyle||window.getComputedStyle(b[0],null);h=a(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:c.fontSize,fontFamily:c.fontFamily,fontStyle:c.fontStyle,fontWeight:c.fontWeight,letterSpacing:c.letterSpacing,textTransform:c.textTransform,whiteSpace:"nowrap"}),h.attr("class","select2-sizer"),a("body").append(h)}return h.text(b.val()),h.width()}function D(b,c,d){var e,g,f=[];e=b.attr("class"),e&&(e=""+e,a(e.split(" ")).each2(function(){0===this.indexOf("select2-")&&f.push(this)})),e=c.attr("class"),e&&(e=""+e,a(e.split(" ")).each2(function(){0!==this.indexOf("select2-")&&(g=d(this),g&&f.push(g))})),b.attr("class",f.join(" "))}function E(a,b,c,d){var e=n(a.toUpperCase()).indexOf(n(b.toUpperCase())),f=b.length;return 0>e?(c.push(d(a)),void 0):(c.push(d(a.substring(0,e))),c.push("<span class='select2-match'>"),c.push(d(a.substring(e,e+f))),c.push("</span>"),c.push(d(a.substring(e+f,a.length))),void 0)}function F(a){var b={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(a).replace(/[&<>"'\/\\]/g,function(a){return b[a]})}function G(c){var d,e=null,f=c.quietMillis||100,g=c.url,h=this;return function(i){window.clearTimeout(d),d=window.setTimeout(function(){var d=c.data,f=g,j=c.transport||a.fn.select2.ajaxDefaults.transport,k={type:c.type||"GET",cache:c.cache||!1,jsonpCallback:c.jsonpCallback||b,dataType:c.dataType||"json"},l=a.extend({},a.fn.select2.ajaxDefaults.params,k);d=d?d.call(h,i.term,i.page,i.context):null,f="function"==typeof f?f.call(h,i.term,i.page,i.context):f,e&&e.abort(),c.params&&(a.isFunction(c.params)?a.extend(l,c.params.call(h)):a.extend(l,c.params)),a.extend(l,{url:f,dataType:c.dataType,data:d,success:function(a){var b=c.results(a,i.page);i.callback(b)}}),e=j.call(h,l)},f)}}function H(b){var d,e,c=b,f=function(a){return""+a.text};a.isArray(c)&&(e=c,c={results:e}),a.isFunction(c)===!1&&(e=c,c=function(){return e});var g=c();return g.text&&(f=g.text,a.isFunction(f)||(d=g.text,f=function(a){return a[d]})),function(b){var g,d=b.term,e={results:[]};return""===d?(b.callback(c()),void 0):(g=function(c,e){var h,i;if(c=c[0],c.children){h={};for(i in c)c.hasOwnProperty(i)&&(h[i]=c[i]);h.children=[],a(c.children).each2(function(a,b){g(b,h.children)}),(h.children.length||b.matcher(d,f(h),c))&&e.push(h)}else b.matcher(d,f(c),c)&&e.push(c)},a(c().results).each2(function(a,b){g(b,e.results)}),b.callback(e),void 0)}}function I(c){var d=a.isFunction(c);return function(e){var f=e.term,g={results:[]};a(d?c():c).each(function(){var a=this.text!==b,c=a?this.text:this;(""===f||e.matcher(f,c))&&g.results.push(a?this:{id:this,text:this})}),e.callback(g)}}function J(b,c){if(a.isFunction(b))return!0;if(!b)return!1;throw new Error(c+" must be a function or a falsy value")}function K(b){return a.isFunction(b)?b():b}function L(b){var c=0;return a.each(b,function(a,b){b.children?c+=L(b.children):c++}),c}function M(a,c,d,e){var h,i,j,k,l,f=a,g=!1;if(!e.createSearchChoice||!e.tokenSeparators||e.tokenSeparators.length<1)return b;for(;;){for(i=-1,j=0,k=e.tokenSeparators.length;k>j&&(l=e.tokenSeparators[j],i=a.indexOf(l),!(i>=0));j++);if(0>i)break;if(h=a.substring(0,i),a=a.substring(i+l.length),h.length>0&&(h=e.createSearchChoice.call(this,h,c),h!==b&&null!==h&&e.id(h)!==b&&null!==e.id(h))){for(g=!1,j=0,k=c.length;k>j;j++)if(q(e.id(h),e.id(c[j]))){g=!0;break}g||d(h)}}return f!==a?a:void 0}function N(b,c){var d=function(){};return d.prototype=new b,d.prototype.constructor=d,d.prototype.parent=b.prototype,d.prototype=a.extend(d.prototype,c),d}if(window.Select2===b){var c,d,e,f,g,h,j,k,i={x:0,y:0},c={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(a){switch(a=a.which?a.which:a){case c.LEFT:case c.RIGHT:case c.UP:case c.DOWN:return!0}return!1},isControl:function(a){var b=a.which;switch(b){case c.SHIFT:case c.CTRL:case c.ALT:return!0}return a.metaKey?!0:!1},isFunctionKey:function(a){return a=a.which?a.which:a,a>=112&&123>=a}},l="<div class='select2-measure-scrollbar'></div>",m={"\u24b6":"A","\uff21":"A","\xc0":"A","\xc1":"A","\xc2":"A","\u1ea6":"A","\u1ea4":"A","\u1eaa":"A","\u1ea8":"A","\xc3":"A","\u0100":"A","\u0102":"A","\u1eb0":"A","\u1eae":"A","\u1eb4":"A","\u1eb2":"A","\u0226":"A","\u01e0":"A","\xc4":"A","\u01de":"A","\u1ea2":"A","\xc5":"A","\u01fa":"A","\u01cd":"A","\u0200":"A","\u0202":"A","\u1ea0":"A","\u1eac":"A","\u1eb6":"A","\u1e00":"A","\u0104":"A","\u023a":"A","\u2c6f":"A","\ua732":"AA","\xc6":"AE","\u01fc":"AE","\u01e2":"AE","\ua734":"AO","\ua736":"AU","\ua738":"AV","\ua73a":"AV","\ua73c":"AY","\u24b7":"B","\uff22":"B","\u1e02":"B","\u1e04":"B","\u1e06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24b8":"C","\uff23":"C","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\xc7":"C","\u1e08":"C","\u0187":"C","\u023b":"C","\ua73e":"C","\u24b9":"D","\uff24":"D","\u1e0a":"D","\u010e":"D","\u1e0c":"D","\u1e10":"D","\u1e12":"D","\u1e0e":"D","\u0110":"D","\u018b":"D","\u018a":"D","\u0189":"D","\ua779":"D","\u01f1":"DZ","\u01c4":"DZ","\u01f2":"Dz","\u01c5":"Dz","\u24ba":"E","\uff25":"E","\xc8":"E","\xc9":"E","\xca":"E","\u1ec0":"E","\u1ebe":"E","\u1ec4":"E","\u1ec2":"E","\u1ebc":"E","\u0112":"E","\u1e14":"E","\u1e16":"E","\u0114":"E","\u0116":"E","\xcb":"E","\u1eba":"E","\u011a":"E","\u0204":"E","\u0206":"E","\u1eb8":"E","\u1ec6":"E","\u0228":"E","\u1e1c":"E","\u0118":"E","\u1e18":"E","\u1e1a":"E","\u0190":"E","\u018e":"E","\u24bb":"F","\uff26":"F","\u1e1e":"F","\u0191":"F","\ua77b":"F","\u24bc":"G","\uff27":"G","\u01f4":"G","\u011c":"G","\u1e20":"G","\u011e":"G","\u0120":"G","\u01e6":"G","\u0122":"G","\u01e4":"G","\u0193":"G","\ua7a0":"G","\ua77d":"G","\ua77e":"G","\u24bd":"H","\uff28":"H","\u0124":"H","\u1e22":"H","\u1e26":"H","\u021e":"H","\u1e24":"H","\u1e28":"H","\u1e2a":"H","\u0126":"H","\u2c67":"H","\u2c75":"H","\ua78d":"H","\u24be":"I","\uff29":"I","\xcc":"I","\xcd":"I","\xce":"I","\u0128":"I","\u012a":"I","\u012c":"I","\u0130":"I","\xcf":"I","\u1e2e":"I","\u1ec8":"I","\u01cf":"I","\u0208":"I","\u020a":"I","\u1eca":"I","\u012e":"I","\u1e2c":"I","\u0197":"I","\u24bf":"J","\uff2a":"J","\u0134":"J","\u0248":"J","\u24c0":"K","\uff2b":"K","\u1e30":"K","\u01e8":"K","\u1e32":"K","\u0136":"K","\u1e34":"K","\u0198":"K","\u2c69":"K","\ua740":"K","\ua742":"K","\ua744":"K","\ua7a2":"K","\u24c1":"L","\uff2c":"L","\u013f":"L","\u0139":"L","\u013d":"L","\u1e36":"L","\u1e38":"L","\u013b":"L","\u1e3c":"L","\u1e3a":"L","\u0141":"L","\u023d":"L","\u2c62":"L","\u2c60":"L","\ua748":"L","\ua746":"L","\ua780":"L","\u01c7":"LJ","\u01c8":"Lj","\u24c2":"M","\uff2d":"M","\u1e3e":"M","\u1e40":"M","\u1e42":"M","\u2c6e":"M","\u019c":"M","\u24c3":"N","\uff2e":"N","\u01f8":"N","\u0143":"N","\xd1":"N","\u1e44":"N","\u0147":"N","\u1e46":"N","\u0145":"N","\u1e4a":"N","\u1e48":"N","\u0220":"N","\u019d":"N","\ua790":"N","\ua7a4":"N","\u01ca":"NJ","\u01cb":"Nj","\u24c4":"O","\uff2f":"O","\xd2":"O","\xd3":"O","\xd4":"O","\u1ed2":"O","\u1ed0":"O","\u1ed6":"O","\u1ed4":"O","\xd5":"O","\u1e4c":"O","\u022c":"O","\u1e4e":"O","\u014c":"O","\u1e50":"O","\u1e52":"O","\u014e":"O","\u022e":"O","\u0230":"O","\xd6":"O","\u022a":"O","\u1ece":"O","\u0150":"O","\u01d1":"O","\u020c":"O","\u020e":"O","\u01a0":"O","\u1edc":"O","\u1eda":"O","\u1ee0":"O","\u1ede":"O","\u1ee2":"O","\u1ecc":"O","\u1ed8":"O","\u01ea":"O","\u01ec":"O","\xd8":"O","\u01fe":"O","\u0186":"O","\u019f":"O","\ua74a":"O","\ua74c":"O","\u01a2":"OI","\ua74e":"OO","\u0222":"OU","\u24c5":"P","\uff30":"P","\u1e54":"P","\u1e56":"P","\u01a4":"P","\u2c63":"P","\ua750":"P","\ua752":"P","\ua754":"P","\u24c6":"Q","\uff31":"Q","\ua756":"Q","\ua758":"Q","\u024a":"Q","\u24c7":"R","\uff32":"R","\u0154":"R","\u1e58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1e5a":"R","\u1e5c":"R","\u0156":"R","\u1e5e":"R","\u024c":"R","\u2c64":"R","\ua75a":"R","\ua7a6":"R","\ua782":"R","\u24c8":"S","\uff33":"S","\u1e9e":"S","\u015a":"S","\u1e64":"S","\u015c":"S","\u1e60":"S","\u0160":"S","\u1e66":"S","\u1e62":"S","\u1e68":"S","\u0218":"S","\u015e":"S","\u2c7e":"S","\ua7a8":"S","\ua784":"S","\u24c9":"T","\uff34":"T","\u1e6a":"T","\u0164":"T","\u1e6c":"T","\u021a":"T","\u0162":"T","\u1e70":"T","\u1e6e":"T","\u0166":"T","\u01ac":"T","\u01ae":"T","\u023e":"T","\ua786":"T","\ua728":"TZ","\u24ca":"U","\uff35":"U","\xd9":"U","\xda":"U","\xdb":"U","\u0168":"U","\u1e78":"U","\u016a":"U","\u1e7a":"U","\u016c":"U","\xdc":"U","\u01db":"U","\u01d7":"U","\u01d5":"U","\u01d9":"U","\u1ee6":"U","\u016e":"U","\u0170":"U","\u01d3":"U","\u0214":"U","\u0216":"U","\u01af":"U","\u1eea":"U","\u1ee8":"U","\u1eee":"U","\u1eec":"U","\u1ef0":"U","\u1ee4":"U","\u1e72":"U","\u0172":"U","\u1e76":"U","\u1e74":"U","\u0244":"U","\u24cb":"V","\uff36":"V","\u1e7c":"V","\u1e7e":"V","\u01b2":"V","\ua75e":"V","\u0245":"V","\ua760":"VY","\u24cc":"W","\uff37":"W","\u1e80":"W","\u1e82":"W","\u0174":"W","\u1e86":"W","\u1e84":"W","\u1e88":"W","\u2c72":"W","\u24cd":"X","\uff38":"X","\u1e8a":"X","\u1e8c":"X","\u24ce":"Y","\uff39":"Y","\u1ef2":"Y","\xdd":"Y","\u0176":"Y","\u1ef8":"Y","\u0232":"Y","\u1e8e":"Y","\u0178":"Y","\u1ef6":"Y","\u1ef4":"Y","\u01b3":"Y","\u024e":"Y","\u1efe":"Y","\u24cf":"Z","\uff3a":"Z","\u0179":"Z","\u1e90":"Z","\u017b":"Z","\u017d":"Z","\u1e92":"Z","\u1e94":"Z","\u01b5":"Z","\u0224":"Z","\u2c7f":"Z","\u2c6b":"Z","\ua762":"Z","\u24d0":"a","\uff41":"a","\u1e9a":"a","\xe0":"a","\xe1":"a","\xe2":"a","\u1ea7":"a","\u1ea5":"a","\u1eab":"a","\u1ea9":"a","\xe3":"a","\u0101":"a","\u0103":"a","\u1eb1":"a","\u1eaf":"a","\u1eb5":"a","\u1eb3":"a","\u0227":"a","\u01e1":"a","\xe4":"a","\u01df":"a","\u1ea3":"a","\xe5":"a","\u01fb":"a","\u01ce":"a","\u0201":"a","\u0203":"a","\u1ea1":"a","\u1ead":"a","\u1eb7":"a","\u1e01":"a","\u0105":"a","\u2c65":"a","\u0250":"a","\ua733":"aa","\xe6":"ae","\u01fd":"ae","\u01e3":"ae","\ua735":"ao","\ua737":"au","\ua739":"av","\ua73b":"av","\ua73d":"ay","\u24d1":"b","\uff42":"b","\u1e03":"b","\u1e05":"b","\u1e07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24d2":"c","\uff43":"c","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\xe7":"c","\u1e09":"c","\u0188":"c","\u023c":"c","\ua73f":"c","\u2184":"c","\u24d3":"d","\uff44":"d","\u1e0b":"d","\u010f":"d","\u1e0d":"d","\u1e11":"d","\u1e13":"d","\u1e0f":"d","\u0111":"d","\u018c":"d","\u0256":"d","\u0257":"d","\ua77a":"d","\u01f3":"dz","\u01c6":"dz","\u24d4":"e","\uff45":"e","\xe8":"e","\xe9":"e","\xea":"e","\u1ec1":"e","\u1ebf":"e","\u1ec5":"e","\u1ec3":"e","\u1ebd":"e","\u0113":"e","\u1e15":"e","\u1e17":"e","\u0115":"e","\u0117":"e","\xeb":"e","\u1ebb":"e","\u011b":"e","\u0205":"e","\u0207":"e","\u1eb9":"e","\u1ec7":"e","\u0229":"e","\u1e1d":"e","\u0119":"e","\u1e19":"e","\u1e1b":"e","\u0247":"e","\u025b":"e","\u01dd":"e","\u24d5":"f","\uff46":"f","\u1e1f":"f","\u0192":"f","\ua77c":"f","\u24d6":"g","\uff47":"g","\u01f5":"g","\u011d":"g","\u1e21":"g","\u011f":"g","\u0121":"g","\u01e7":"g","\u0123":"g","\u01e5":"g","\u0260":"g","\ua7a1":"g","\u1d79":"g","\ua77f":"g","\u24d7":"h","\uff48":"h","\u0125":"h","\u1e23":"h","\u1e27":"h","\u021f":"h","\u1e25":"h","\u1e29":"h","\u1e2b":"h","\u1e96":"h","\u0127":"h","\u2c68":"h","\u2c76":"h","\u0265":"h","\u0195":"hv","\u24d8":"i","\uff49":"i","\xec":"i","\xed":"i","\xee":"i","\u0129":"i","\u012b":"i","\u012d":"i","\xef":"i","\u1e2f":"i","\u1ec9":"i","\u01d0":"i","\u0209":"i","\u020b":"i","\u1ecb":"i","\u012f":"i","\u1e2d":"i","\u0268":"i","\u0131":"i","\u24d9":"j","\uff4a":"j","\u0135":"j","\u01f0":"j","\u0249":"j","\u24da":"k","\uff4b":"k","\u1e31":"k","\u01e9":"k","\u1e33":"k","\u0137":"k","\u1e35":"k","\u0199":"k","\u2c6a":"k","\ua741":"k","\ua743":"k","\ua745":"k","\ua7a3":"k","\u24db":"l","\uff4c":"l","\u0140":"l","\u013a":"l","\u013e":"l","\u1e37":"l","\u1e39":"l","\u013c":"l","\u1e3d":"l","\u1e3b":"l","\u017f":"l","\u0142":"l","\u019a":"l","\u026b":"l","\u2c61":"l","\ua749":"l","\ua781":"l","\ua747":"l","\u01c9":"lj","\u24dc":"m","\uff4d":"m","\u1e3f":"m","\u1e41":"m","\u1e43":"m","\u0271":"m","\u026f":"m","\u24dd":"n","\uff4e":"n","\u01f9":"n","\u0144":"n","\xf1":"n","\u1e45":"n","\u0148":"n","\u1e47":"n","\u0146":"n","\u1e4b":"n","\u1e49":"n","\u019e":"n","\u0272":"n","\u0149":"n","\ua791":"n","\ua7a5":"n","\u01cc":"nj","\u24de":"o","\uff4f":"o","\xf2":"o","\xf3":"o","\xf4":"o","\u1ed3":"o","\u1ed1":"o","\u1ed7":"o","\u1ed5":"o","\xf5":"o","\u1e4d":"o","\u022d":"o","\u1e4f":"o","\u014d":"o","\u1e51":"o","\u1e53":"o","\u014f":"o","\u022f":"o","\u0231":"o","\xf6":"o","\u022b":"o","\u1ecf":"o","\u0151":"o","\u01d2":"o","\u020d":"o","\u020f":"o","\u01a1":"o","\u1edd":"o","\u1edb":"o","\u1ee1":"o","\u1edf":"o","\u1ee3":"o","\u1ecd":"o","\u1ed9":"o","\u01eb":"o","\u01ed":"o","\xf8":"o","\u01ff":"o","\u0254":"o","\ua74b":"o","\ua74d":"o","\u0275":"o","\u01a3":"oi","\u0223":"ou","\ua74f":"oo","\u24df":"p","\uff50":"p","\u1e55":"p","\u1e57":"p","\u01a5":"p","\u1d7d":"p","\ua751":"p","\ua753":"p","\ua755":"p","\u24e0":"q","\uff51":"q","\u024b":"q","\ua757":"q","\ua759":"q","\u24e1":"r","\uff52":"r","\u0155":"r","\u1e59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1e5b":"r","\u1e5d":"r","\u0157":"r","\u1e5f":"r","\u024d":"r","\u027d":"r","\ua75b":"r","\ua7a7":"r","\ua783":"r","\u24e2":"s","\uff53":"s","\xdf":"s","\u015b":"s","\u1e65":"s","\u015d":"s","\u1e61":"s","\u0161":"s","\u1e67":"s","\u1e63":"s","\u1e69":"s","\u0219":"s","\u015f":"s","\u023f":"s","\ua7a9":"s","\ua785":"s","\u1e9b":"s","\u24e3":"t","\uff54":"t","\u1e6b":"t","\u1e97":"t","\u0165":"t","\u1e6d":"t","\u021b":"t","\u0163":"t","\u1e71":"t","\u1e6f":"t","\u0167":"t","\u01ad":"t","\u0288":"t","\u2c66":"t","\ua787":"t","\ua729":"tz","\u24e4":"u","\uff55":"u","\xf9":"u","\xfa":"u","\xfb":"u","\u0169":"u","\u1e79":"u","\u016b":"u","\u1e7b":"u","\u016d":"u","\xfc":"u","\u01dc":"u","\u01d8":"u","\u01d6":"u","\u01da":"u","\u1ee7":"u","\u016f":"u","\u0171":"u","\u01d4":"u","\u0215":"u","\u0217":"u","\u01b0":"u","\u1eeb":"u","\u1ee9":"u","\u1eef":"u","\u1eed":"u","\u1ef1":"u","\u1ee5":"u","\u1e73":"u","\u0173":"u","\u1e77":"u","\u1e75":"u","\u0289":"u","\u24e5":"v","\uff56":"v","\u1e7d":"v","\u1e7f":"v","\u028b":"v","\ua75f":"v","\u028c":"v","\ua761":"vy","\u24e6":"w","\uff57":"w","\u1e81":"w","\u1e83":"w","\u0175":"w","\u1e87":"w","\u1e85":"w","\u1e98":"w","\u1e89":"w","\u2c73":"w","\u24e7":"x","\uff58":"x","\u1e8b":"x","\u1e8d":"x","\u24e8":"y","\uff59":"y","\u1ef3":"y","\xfd":"y","\u0177":"y","\u1ef9":"y","\u0233":"y","\u1e8f":"y","\xff":"y","\u1ef7":"y","\u1e99":"y","\u1ef5":"y","\u01b4":"y","\u024f":"y","\u1eff":"y","\u24e9":"z","\uff5a":"z","\u017a":"z","\u1e91":"z","\u017c":"z","\u017e":"z","\u1e93":"z","\u1e95":"z","\u01b6":"z","\u0225":"z","\u0240":"z","\u2c6c":"z","\ua763":"z"};j=a(document),g=function(){var a=1;return function(){return a++}}(),j.on("mousemove",function(a){i.x=a.pageX,i.y=a.pageY}),d=N(Object,{bind:function(a){var b=this;return function(){a.apply(b,arguments)}},init:function(c){var d,e,f=".select2-results";this.opts=c=this.prepareOpts(c),this.id=c.id,c.element.data("select2")!==b&&null!==c.element.data("select2")&&c.element.data("select2").destroy(),this.container=this.createContainer(),this.containerId="s2id_"+(c.element.attr("id")||"autogen"+g()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=w(function(){return c.element.closest("body")}),D(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",c.element.attr("style")),this.container.css(K(c.containerCss)),this.container.addClass(K(c.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",A),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),D(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(K(c.dropdownCssClass)),this.dropdown.data("select2",this),this.dropdown.on("click",A),this.results=d=this.container.find(f),this.search=e=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",A),u(this.results),this.dropdown.on("mousemove-filtered touchstart touchmove touchend",f,this.bind(this.highlightUnderEvent)),x(80,this.results),this.dropdown.on("scroll-debounced",f,this.bind(this.loadMoreIfNeeded)),a(this.container).on("change",".select2-input",function(a){a.stopPropagation()}),a(this.dropdown).on("change",".select2-input",function(a){a.stopPropagation()}),a.fn.mousewheel&&d.mousewheel(function(a,b,c,e){var f=d.scrollTop();e>0&&0>=f-e?(d.scrollTop(0),A(a)):0>e&&d.get(0).scrollHeight-d.scrollTop()+e<=d.height()&&(d.scrollTop(d.get(0).scrollHeight-d.height()),A(a))}),t(e),e.on("keyup-change input paste",this.bind(this.updateResults)),e.on("focus",function(){e.addClass("select2-focused")}),e.on("blur",function(){e.removeClass("select2-focused")}),this.dropdown.on("mouseup",f,this.bind(function(b){a(b.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(b),this.selectHighlighted(b))})),this.dropdown.on("click mouseup mousedown",function(a){a.stopPropagation()}),a.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==c.maximumInputLength&&this.search.attr("maxlength",c.maximumInputLength);var h=c.element.prop("disabled");h===b&&(h=!1),this.enable(!h);var i=c.element.prop("readonly");i===b&&(i=!1),this.readonly(i),k=k||p(),this.autofocus=c.element.prop("autofocus"),c.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.nextSearchTerm=b},destroy:function(){var a=this.opts.element,c=a.data("select2");this.close(),this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),c!==b&&(c.container.remove(),c.dropdown.remove(),a.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?a.attr({tabindex:this.elementTabIndex}):a.removeAttr("tabindex"),a.show())},optionToData:function(a){return a.is("option")?{id:a.prop("value"),text:a.text(),element:a.get(),css:a.attr("class"),disabled:a.prop("disabled"),locked:q(a.attr("locked"),"locked")||q(a.data("locked"),!0)}:a.is("optgroup")?{text:a.attr("label"),children:[],element:a.get(),css:a.attr("class")}:void 0},prepareOpts:function(c){var d,e,f,g,h=this;if(d=c.element,"select"===d.get(0).tagName.toLowerCase()&&(this.select=e=c.element),e&&a.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in c)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),c=a.extend({},{populateResults:function(d,e,f){var g,i=this.opts.id;g=function(d,e,j){var k,l,m,n,o,p,q,r,s,t;for(d=c.sortResults(d,e,f),k=0,l=d.length;l>k;k+=1)m=d[k],o=m.disabled===!0,n=!o&&i(m)!==b,p=m.children&&m.children.length>0,q=a("<li></li>"),q.addClass("select2-results-dept-"+j),q.addClass("select2-result"),q.addClass(n?"select2-result-selectable":"select2-result-unselectable"),o&&q.addClass("select2-disabled"),p&&q.addClass("select2-result-with-children"),q.addClass(h.opts.formatResultCssClass(m)),r=a(document.createElement("div")),r.addClass("select2-result-label"),t=c.formatResult(m,r,f,h.opts.escapeMarkup),t!==b&&r.html(t),q.append(r),p&&(s=a("<ul></ul>"),s.addClass("select2-result-sub"),g(m.children,s,j+1),q.append(s)),q.data("select2-data",m),e.append(q)},g(e,d,0)}},a.fn.select2.defaults,c),"function"!=typeof c.id&&(f=c.id,c.id=function(a){return a[f]}),a.isArray(c.element.data("select2Tags"))){if("tags"in c)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+c.element.attr("id");c.tags=c.element.data("select2Tags")}if(e?(c.query=this.bind(function(a){var f,g,i,c={results:[],more:!1},e=a.term;i=function(b,c){var d;b.is("option")?a.matcher(e,b.text(),b)&&c.push(h.optionToData(b)):b.is("optgroup")&&(d=h.optionToData(b),b.children().each2(function(a,b){i(b,d.children)}),d.children.length>0&&c.push(d))},f=d.children(),this.getPlaceholder()!==b&&f.length>0&&(g=this.getPlaceholderOption(),g&&(f=f.not(g))),f.each2(function(a,b){i(b,c.results)}),a.callback(c)}),c.id=function(a){return a.id},c.formatResultCssClass=function(a){return a.css}):"query"in c||("ajax"in c?(g=c.element.data("ajax-url"),g&&g.length>0&&(c.ajax.url=g),c.query=G.call(c.element,c.ajax)):"data"in c?c.query=H(c.data):"tags"in c&&(c.query=I(c.tags),c.createSearchChoice===b&&(c.createSearchChoice=function(b){return{id:a.trim(b),text:a.trim(b)}}),c.initSelection===b&&(c.initSelection=function(b,d){var e=[];a(r(b.val(),c.separator)).each(function(){var b={id:this,text:this},d=c.tags;a.isFunction(d)&&(d=d()),a(d).each(function(){return q(this.id,b.id)?(b=this,!1):void 0}),e.push(b)}),d(e)}))),"function"!=typeof c.query)throw"query function not defined for Select2 "+c.element.attr("id");return c},monitorSource:function(){var c,d,a=this.opts.element;a.on("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),c=this.bind(function(){var c=a.prop("disabled");c===b&&(c=!1),this.enable(!c);var d=a.prop("readonly");d===b&&(d=!1),this.readonly(d),D(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(K(this.opts.containerCssClass)),D(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(K(this.opts.dropdownCssClass))}),a.on("propertychange.select2",c),this.mutationCallback===b&&(this.mutationCallback=function(a){a.forEach(c)}),d=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,d!==b&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new d(this.mutationCallback),this.propertyObserver.observe(a.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(b){var c=a.Event("select2-selecting",{val:this.id(b),object:b});return this.opts.element.trigger(c),!c.isDefaultPrevented()},triggerChange:function(b){b=b||{},b=a.extend({},b,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(b),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var a=this._enabled&&!this._readonly,b=!a;return a===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",b),this.close(),this.enabledInterface=a,!0)},enable:function(a){a===b&&(a=!0),this._enabled!==a&&(this._enabled=a,this.opts.element.prop("disabled",!a),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(a){return a===b&&(a=!1),this._readonly===a?!1:(this._readonly=a,this.opts.element.prop("readonly",a),this.enableInterface(),!0)},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,u,v,w,x,b=this.dropdown,c=this.container.offset(),d=this.container.outerHeight(!1),e=this.container.outerWidth(!1),f=b.outerHeight(!1),g=a(window),h=g.width(),i=g.height(),j=g.scrollLeft()+h,l=g.scrollTop()+i,m=c.top+d,n=c.left,o=l>=m+f,p=c.top-f>=this.body().scrollTop(),q=b.outerWidth(!1),r=j>=n+q,s=b.hasClass("select2-drop-above");s?(u=!0,!p&&o&&(v=!0,u=!1)):(u=!1,!o&&p&&(v=!0,u=!0)),v&&(b.hide(),c=this.container.offset(),d=this.container.outerHeight(!1),e=this.container.outerWidth(!1),f=b.outerHeight(!1),j=g.scrollLeft()+h,l=g.scrollTop()+i,m=c.top+d,n=c.left,q=b.outerWidth(!1),r=j>=n+q,b.show()),this.opts.dropdownAutoWidth?(x=a(".select2-results",b)[0],b.addClass("select2-drop-auto-width"),b.css("width",""),q=b.outerWidth(!1)+(x.scrollHeight===x.clientHeight?0:k.width),q>e?e=q:q=e,r=j>=n+q):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body().css("position")&&(t=this.body().offset(),m-=t.top,n-=t.left),r||(n=c.left+e-q),w={left:n,width:e},u?(w.bottom=i-c.top,w.top="auto",this.container.addClass("select2-drop-above"),b.addClass("select2-drop-above")):(w.top=m,w.bottom="auto",this.container.removeClass("select2-drop-above"),b.removeClass("select2-drop-above")),w=a.extend(w,K(this.opts.dropdownCss)),b.css(w)},shouldOpen:function(){var b;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(b=a.Event("select2-opening"),this.opts.element.trigger(b),!b.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),!0):!1},opening:function(){var f,b=this.containerId,c="scroll."+b,d="resize."+b,e="orientationchange."+b;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),f=a("#select2-drop-mask"),0==f.length&&(f=a(document.createElement("div")),f.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),f.hide(),f.appendTo(this.body()),f.on("mousedown touchstart click",function(b){var d,c=a("#select2-drop");c.length>0&&(d=c.data("select2"),d.opts.selectOnBlur&&d.selectHighlighted({noFocus:!0}),d.close({focus:!0}),b.preventDefault(),b.stopPropagation())})),this.dropdown.prev()[0]!==f[0]&&this.dropdown.before(f),a("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),f.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var g=this;this.container.parents().add(window).each(function(){a(this).on(d+" "+c+" "+e,function(){g.positionDropdown()})})},close:function(){if(this.opened()){var b=this.containerId,c="scroll."+b,d="resize."+b,e="orientationchange."+b;this.container.parents().add(window).each(function(){a(this).off(c).off(d).off(e)}),this.clearDropdownAlignmentPreference(),a("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(a.Event("select2-close"))}},externalSearch:function(a){this.open(),this.search.val(a),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return K(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var c,d,e,f,g,h,i,b=this.results;if(d=this.highlight(),!(0>d)){if(0==d)return b.scrollTop(0),void 0;c=this.findHighlightableChoices().find(".select2-result-label"),e=a(c[d]),f=e.offset().top+e.outerHeight(!0),d===c.length-1&&(i=b.find("li.select2-more-results"),i.length>0&&(f=i.offset().top+i.outerHeight(!0))),g=b.offset().top+b.outerHeight(!0),f>g&&b.scrollTop(b.scrollTop()+(f-g)),h=e.offset().top-b.offset().top,0>h&&"none"!=e.css("display")&&b.scrollTop(b.scrollTop()+h)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled, .select2-selected)")},moveHighlight:function(b){for(var c=this.findHighlightableChoices(),d=this.highlight();d>-1&&d<c.length;){d+=b;var e=a(c[d]);if(e.hasClass("select2-result-selectable")&&!e.hasClass("select2-disabled")&&!e.hasClass("select2-selected")){this.highlight(d);break}}},highlight:function(b){var d,e,c=this.findHighlightableChoices();return 0===arguments.length?o(c.filter(".select2-highlighted")[0],c.get()):(b>=c.length&&(b=c.length-1),0>b&&(b=0),this.removeHighlight(),d=a(c[b]),d.addClass("select2-highlighted"),this.ensureHighlightVisible(),e=d.data("select2-data"),e&&this.opts.element.trigger({type:"select2-highlight",val:this.id(e),choice:e}),void 0)},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(b){var c=a(b.target).closest(".select2-result-selectable");if(c.length>0&&!c.is(".select2-highlighted")){var d=this.findHighlightableChoices();this.highlight(d.index(c))}else 0==c.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var c,a=this.results,b=a.find("li.select2-more-results"),d=this.resultsPage+1,e=this,f=this.search.val(),g=this.context;0!==b.length&&(c=b.offset().top-a.offset().top-a.height(),c<=this.opts.loadMorePadding&&(b.addClass("select2-active"),this.opts.query({element:this.opts.element,term:f,page:d,context:g,matcher:this.opts.matcher,callback:this.bind(function(c){e.opened()&&(e.opts.populateResults.call(this,a,c.results,{term:f,page:d,context:g}),e.postprocessResults(c,!1,!1),c.more===!0?(b.detach().appendTo(a).text(e.opts.formatLoadMore(d+1)),window.setTimeout(function(){e.loadMoreIfNeeded()},10)):b.remove(),e.positionDropdown(),e.resultsPage=d,e.context=c.context,this.opts.element.trigger({type:"select2-loaded",items:c}))})})))},tokenize:function(){},updateResults:function(c){function m(){d.removeClass("select2-active"),h.positionDropdown()}function n(a){e.html(a),m()}var g,i,l,d=this.search,e=this.results,f=this.opts,h=this,j=d.val(),k=a.data(this.container,"select2-last-term");if((c===!0||!k||!q(j,k))&&(a.data(this.container,"select2-last-term",j),c===!0||this.showSearchInput!==!1&&this.opened())){l=++this.queryCount;var o=this.getMaximumSelectionSize();if(o>=1&&(g=this.data(),a.isArray(g)&&g.length>=o&&J(f.formatSelectionTooBig,"formatSelectionTooBig")))return n("<li class='select2-selection-limit'>"+f.formatSelectionTooBig(o)+"</li>"),void 0;if(d.val().length<f.minimumInputLength)return J(f.formatInputTooShort,"formatInputTooShort")?n("<li class='select2-no-results'>"+f.formatInputTooShort(d.val(),f.minimumInputLength)+"</li>"):n(""),c&&this.showSearch&&this.showSearch(!0),void 0;
if(f.maximumInputLength&&d.val().length>f.maximumInputLength)return J(f.formatInputTooLong,"formatInputTooLong")?n("<li class='select2-no-results'>"+f.formatInputTooLong(d.val(),f.maximumInputLength)+"</li>"):n(""),void 0;f.formatSearching&&0===this.findHighlightableChoices().length&&n("<li class='select2-searching'>"+f.formatSearching()+"</li>"),d.addClass("select2-active"),this.removeHighlight(),i=this.tokenize(),i!=b&&null!=i&&d.val(i),this.resultsPage=1,f.query({element:f.element,term:d.val(),page:this.resultsPage,context:null,matcher:f.matcher,callback:this.bind(function(g){var i;if(l==this.queryCount){if(!this.opened())return this.search.removeClass("select2-active"),void 0;if(this.context=g.context===b?null:g.context,this.opts.createSearchChoice&&""!==d.val()&&(i=this.opts.createSearchChoice.call(h,d.val(),g.results),i!==b&&null!==i&&h.id(i)!==b&&null!==h.id(i)&&0===a(g.results).filter(function(){return q(h.id(this),h.id(i))}).length&&g.results.unshift(i)),0===g.results.length&&J(f.formatNoMatches,"formatNoMatches"))return n("<li class='select2-no-results'>"+f.formatNoMatches(d.val())+"</li>"),void 0;e.empty(),h.opts.populateResults.call(this,e,g.results,{term:d.val(),page:this.resultsPage,context:null}),g.more===!0&&J(f.formatLoadMore,"formatLoadMore")&&(e.append("<li class='select2-more-results'>"+h.opts.escapeMarkup(f.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){h.loadMoreIfNeeded()},10)),this.postprocessResults(g,c),m(),this.opts.element.trigger({type:"select2-loaded",items:g})}})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){y(this.search)},selectHighlighted:function(a){var b=this.highlight(),c=this.results.find(".select2-highlighted"),d=c.closest(".select2-result").data("select2-data");d?(this.highlight(b),this.onSelect(d,a)):a&&a.noFocus&&this.close()},getPlaceholder:function(){var a;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((a=this.getPlaceholderOption())!==b?a.text():b)},getPlaceholderOption:function(){if(this.select){var a=this.select.children("option").first();if(this.opts.placeholderOption!==b)return"first"===this.opts.placeholderOption&&a||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===a.text()&&""===a.val())return a}},initContainerWidth:function(){function c(){var c,d,e,f,g,h;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(c=this.opts.element.attr("style"),c!==b)for(d=c.split(";"),f=0,g=d.length;g>f;f+=1)if(h=d[f].replace(/\s/g,""),e=h.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==e&&e.length>=1)return e[1];return"resolve"===this.opts.width?(c=this.opts.element.css("width"),c.indexOf("%")>0?c:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return a.isFunction(this.opts.width)?this.opts.width():this.opts.width}var d=c.call(this);null!==d&&this.container.css("width",d)}}),e=N(d,{createContainer:function(){var b=a(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow'><b></b></span>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return b},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var c,d,e;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.search.focus(),c=this.search.get(0),c.createTextRange?(d=c.createTextRange(),d.collapse(!1),d.select()):c.setSelectionRange&&(e=this.search.val().length,c.setSelectionRange(e,e)),""===this.search.val()&&this.nextSearchTerm!=b&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(a.Event("select2-open"))},close:function(a){this.opened()&&(this.parent.close.apply(this,arguments),a=a||{focus:!0},this.focusser.removeAttr("disabled"),a.focus&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},destroy:function(){a("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var b,d=this.container,e=this.dropdown;this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=b=d.find(".select2-choice"),this.focusser=d.find(".select2-focusser"),this.focusser.attr("id","s2id_autogen"+g()),a("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id")),this.focusser.attr("tabindex",this.elementTabIndex),this.search.on("keydown",this.bind(function(a){if(this.isInterfaceEnabled()){if(a.which===c.PAGE_UP||a.which===c.PAGE_DOWN)return A(a),void 0;switch(a.which){case c.UP:case c.DOWN:return this.moveHighlight(a.which===c.UP?-1:1),A(a),void 0;case c.ENTER:return this.selectHighlighted(),A(a),void 0;case c.TAB:return this.selectHighlighted({noFocus:!0}),void 0;case c.ESC:return this.cancel(a),A(a),void 0}}})),this.search.on("blur",this.bind(function(){document.activeElement===this.body().get(0)&&window.setTimeout(this.bind(function(){this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(a){if(this.isInterfaceEnabled()&&a.which!==c.TAB&&!c.isControl(a)&&!c.isFunctionKey(a)&&a.which!==c.ESC){if(this.opts.openOnEnter===!1&&a.which===c.ENTER)return A(a),void 0;if(a.which==c.DOWN||a.which==c.UP||a.which==c.ENTER&&this.opts.openOnEnter){if(a.altKey||a.ctrlKey||a.shiftKey||a.metaKey)return;return this.open(),A(a),void 0}return a.which==c.DELETE||a.which==c.BACKSPACE?(this.opts.allowClear&&this.clear(),A(a),void 0):void 0}})),t(this.focusser),this.focusser.on("keyup-change input",this.bind(function(a){if(this.opts.minimumResultsForSearch>=0){if(a.stopPropagation(),this.opened())return;this.open()}})),b.on("mousedown","abbr",this.bind(function(a){this.isInterfaceEnabled()&&(this.clear(),B(a),this.close(),this.selection.focus())})),b.on("mousedown",this.bind(function(b){this.container.hasClass("select2-container-active")||this.opts.element.trigger(a.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),A(b)})),e.on("mousedown",this.bind(function(){this.search.focus()})),b.on("focus",this.bind(function(a){A(a)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(a.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(a.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(a.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(b){var c=this.selection.data("select2-data");if(c){var d=a.Event("select2-clearing");if(this.opts.element.trigger(d),d.isDefaultPrevented())return;var e=this.getPlaceholderOption();this.opts.element.val(e?e.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),b!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(c),choice:c}),this.triggerChange({removed:c}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var c=this;this.opts.initSelection.call(null,this.opts.element,function(a){a!==b&&null!==a&&(c.updateSelection(a),c.close(),c.setPlaceholder())})}},isPlaceholderOptionSelected:function(){var a;return this.getPlaceholder()?(a=this.getPlaceholderOption())!==b&&a.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===b||null===this.opts.element.val():!1},prepareOpts:function(){var b=this.parent.prepareOpts.apply(this,arguments),c=this;return"select"===b.element.get(0).tagName.toLowerCase()?b.initSelection=function(a,b){var d=a.find("option").filter(function(){return this.selected});b(c.optionToData(d))}:"data"in b&&(b.initSelection=b.initSelection||function(c,d){var e=c.val(),f=null;b.query({matcher:function(a,c,d){var g=q(e,b.id(d));return g&&(f=d),g},callback:a.isFunction(d)?function(){d(f)}:a.noop})}),b},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===b?b:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var a=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&a!==b){if(this.select&&this.getPlaceholderOption()===b)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(a)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(a,b,c){var d=0,e=this;if(this.findHighlightableChoices().each2(function(a,b){return q(e.id(b.data("select2-data")),e.opts.element.val())?(d=a,!1):void 0}),c!==!1&&(b===!0&&d>=0?this.highlight(d):this.highlight(0)),b===!0){var g=this.opts.minimumResultsForSearch;g>=0&&this.showSearch(L(a.results)>=g)}},showSearch:function(b){this.showSearchInput!==b&&(this.showSearchInput=b,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!b),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!b),a(this.dropdown,this.container).toggleClass("select2-with-searchbox",b))},onSelect:function(a,b){if(this.triggerSelect(a)){var c=this.opts.element.val(),d=this.data();this.opts.element.val(this.id(a)),this.updateSelection(a),this.opts.element.trigger({type:"select2-selected",val:this.id(a),choice:a}),this.nextSearchTerm=this.opts.nextSearchTerm(a,this.search.val()),this.close(),b&&b.noFocus||this.focusser.focus(),q(c,this.id(a))||this.triggerChange({added:a,removed:d})}},updateSelection:function(a){var d,e,c=this.selection.find(".select2-chosen");this.selection.data("select2-data",a),c.empty(),null!==a&&(d=this.opts.formatSelection(a,c,this.opts.escapeMarkup)),d!==b&&c.append(d),e=this.opts.formatSelectionCssClass(a,c),e!==b&&c.addClass(e),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==b&&this.container.addClass("select2-allowclear")},val:function(){var a,c=!1,d=null,e=this,f=this.data();if(0===arguments.length)return this.opts.element.val();if(a=arguments[0],arguments.length>1&&(c=arguments[1]),this.select)this.select.val(a).find("option").filter(function(){return this.selected}).each2(function(a,b){return d=e.optionToData(b),!1}),this.updateSelection(d),this.setPlaceholder(),c&&this.triggerChange({added:d,removed:f});else{if(!a&&0!==a)return this.clear(c),void 0;if(this.opts.initSelection===b)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(a),this.opts.initSelection(this.opts.element,function(a){e.opts.element.val(a?e.id(a):""),e.updateSelection(a),e.setPlaceholder(),c&&e.triggerChange({added:a,removed:f})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(a){var c,d=!1;return 0===arguments.length?(c=this.selection.data("select2-data"),c==b&&(c=null),c):(arguments.length>1&&(d=arguments[1]),a?(c=this.data(),this.opts.element.val(a?this.id(a):""),this.updateSelection(a),d&&this.triggerChange({added:a,removed:c})):this.clear(d),void 0)}}),f=N(d,{createContainer:function(){var b=a(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return b},prepareOpts:function(){var b=this.parent.prepareOpts.apply(this,arguments),c=this;return"select"===b.element.get(0).tagName.toLowerCase()?b.initSelection=function(a,b){var d=[];a.find("option").filter(function(){return this.selected}).each2(function(a,b){d.push(c.optionToData(b))}),b(d)}:"data"in b&&(b.initSelection=b.initSelection||function(c,d){var e=r(c.val(),b.separator),f=[];b.query({matcher:function(c,d,g){var h=a.grep(e,function(a){return q(a,b.id(g))}).length;return h&&f.push(g),h},callback:a.isFunction(d)?function(){for(var a=[],c=0;c<e.length;c++)for(var g=e[c],h=0;h<f.length;h++){var i=f[h];if(q(g,b.id(i))){a.push(i),f.splice(h,1);break}}d(a)}:a.noop})}),b},selectChoice:function(a){var b=this.container.find(".select2-search-choice-focus");b.length&&a&&a[0]==b[0]||(b.length&&this.opts.element.trigger("choice-deselected",b),b.removeClass("select2-search-choice-focus"),a&&a.length&&(this.close(),a.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",a)))},destroy:function(){a("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var d,b=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=d=this.container.find(b);var e=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",function(){e.search[0].focus(),e.selectChoice(a(this))}),this.search.attr("id","s2id_autogen"+g()),a("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id")),this.search.on("input paste",this.bind(function(){this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(a){if(this.isInterfaceEnabled()){++this.keydowns;var b=d.find(".select2-search-choice-focus"),e=b.prev(".select2-search-choice:not(.select2-locked)"),f=b.next(".select2-search-choice:not(.select2-locked)"),g=z(this.search);if(b.length&&(a.which==c.LEFT||a.which==c.RIGHT||a.which==c.BACKSPACE||a.which==c.DELETE||a.which==c.ENTER)){var h=b;return a.which==c.LEFT&&e.length?h=e:a.which==c.RIGHT?h=f.length?f:null:a.which===c.BACKSPACE?(this.unselect(b.first()),this.search.width(10),h=e.length?e:f):a.which==c.DELETE?(this.unselect(b.first()),this.search.width(10),h=f.length?f:null):a.which==c.ENTER&&(h=null),this.selectChoice(h),A(a),h&&h.length||this.open(),void 0}if((a.which===c.BACKSPACE&&1==this.keydowns||a.which==c.LEFT)&&0==g.offset&&!g.length)return this.selectChoice(d.find(".select2-search-choice:not(.select2-locked)").last()),A(a),void 0;if(this.selectChoice(null),this.opened())switch(a.which){case c.UP:case c.DOWN:return this.moveHighlight(a.which===c.UP?-1:1),A(a),void 0;case c.ENTER:return this.selectHighlighted(),A(a),void 0;case c.TAB:return this.selectHighlighted({noFocus:!0}),this.close(),void 0;case c.ESC:return this.cancel(a),A(a),void 0}if(a.which!==c.TAB&&!c.isControl(a)&&!c.isFunctionKey(a)&&a.which!==c.BACKSPACE&&a.which!==c.ESC){if(a.which===c.ENTER){if(this.opts.openOnEnter===!1)return;if(a.altKey||a.ctrlKey||a.shiftKey||a.metaKey)return}this.open(),(a.which===c.PAGE_UP||a.which===c.PAGE_DOWN)&&A(a),a.which===c.ENTER&&A(a)}}})),this.search.on("keyup",this.bind(function(){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(b){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),b.stopImmediatePropagation(),this.opts.element.trigger(a.Event("select2-blur"))})),this.container.on("click",b,this.bind(function(b){this.isInterfaceEnabled()&&(a(b.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(a.Event("select2-focus")),this.open(),this.focusSearch(),b.preventDefault()))})),this.container.on("focus",b,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(a.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var c=this;this.opts.initSelection.call(null,this.opts.element,function(a){a!==b&&null!==a&&(c.updateSelection(a),c.close(),c.clearSearch())})}},clearSearch:function(){var a=this.getPlaceholder(),c=this.getMaxSearchWidth();a!==b&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(a).addClass("select2-default"),this.search.width(c>0?c:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.updateResults(!0),this.search.focus(),this.opts.element.trigger(a.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(b){var c=[],d=[],e=this;a(b).each(function(){o(e.id(this),c)<0&&(c.push(e.id(this)),d.push(this))}),b=d,this.selection.find(".select2-search-choice").remove(),a(b).each(function(){e.addSelectedChoice(this)}),e.postprocessResults()},tokenize:function(){var a=this.search.val();a=this.opts.tokenizer.call(this,a,this.data(),this.bind(this.onSelect),this.opts),null!=a&&a!=b&&(this.search.val(a),a.length>0&&this.open())},onSelect:function(a,b){this.triggerSelect(a)&&(this.addSelectedChoice(a),this.opts.element.trigger({type:"selected",val:this.id(a),choice:a}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(a,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:a}),b&&b.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(c){var j,k,d=!c.locked,e=a("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),f=a("<li class='select2-search-choice select2-locked'><div></div></li>"),g=d?e:f,h=this.id(c),i=this.getVal();j=this.opts.formatSelection(c,g.find("div"),this.opts.escapeMarkup),j!=b&&g.find("div").replaceWith("<div>"+j+"</div>"),k=this.opts.formatSelectionCssClass(c,g.find("div")),k!=b&&g.addClass(k),d&&g.find(".select2-search-choice-close").on("mousedown",A).on("click dblclick",this.bind(function(b){this.isInterfaceEnabled()&&(a(b.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(a(b.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),A(b))})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),g.data("select2-data",c),g.insertBefore(this.searchContainer),i.push(h),this.setVal(i)},unselect:function(b){var d,e,c=this.getVal();if(b=b.closest(".select2-search-choice"),0===b.length)throw"Invalid argument: "+b+". Must be .select2-search-choice";if(d=b.data("select2-data")){for(;(e=o(this.id(d),c))>=0;)c.splice(e,1),this.setVal(c),this.select&&this.postprocessResults();var f=a.Event("select2-removing");f.val=this.id(d),f.choice=d,this.opts.element.trigger(f),f.isDefaultPrevented()||(b.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(d),choice:d}),this.triggerChange({removed:d}))}},postprocessResults:function(a,b,c){var d=this.getVal(),e=this.results.find(".select2-result"),f=this.results.find(".select2-result-with-children"),g=this;e.each2(function(a,b){var c=g.id(b.data("select2-data"));o(c,d)>=0&&(b.addClass("select2-selected"),b.find(".select2-result-selectable").addClass("select2-selected"))}),f.each2(function(a,b){b.is(".select2-result-selectable")||0!==b.find(".select2-result-selectable:not(.select2-selected)").length||b.addClass("select2-selected")}),-1==this.highlight()&&c!==!1&&g.highlight(0),!this.opts.createSearchChoice&&!e.filter(".select2-result:not(.select2-selected)").length>0&&(!a||a&&!a.more&&0===this.results.find(".select2-no-results").length)&&J(g.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+g.opts.formatNoMatches(g.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-s(this.search)},resizeSearch:function(){var a,b,c,d,e,f=s(this.search);a=C(this.search)+10,b=this.search.offset().left,c=this.selection.width(),d=this.selection.offset().left,e=c-(b-d)-f,a>e&&(e=c-f),40>e&&(e=c-f),0>=e&&(e=a),this.search.width(Math.floor(e))},getVal:function(){var a;return this.select?(a=this.select.val(),null===a?[]:a):(a=this.opts.element.val(),r(a,this.opts.separator))},setVal:function(b){var c;this.select?this.select.val(b):(c=[],a(b).each(function(){o(this,c)<0&&c.push(this)}),this.opts.element.val(0===c.length?"":c.join(this.opts.separator)))},buildChangeDetails:function(a,b){for(var b=b.slice(0),a=a.slice(0),c=0;c<b.length;c++)for(var d=0;d<a.length;d++)q(this.opts.id(b[c]),this.opts.id(a[d]))&&(b.splice(c,1),c>0&&c--,a.splice(d,1),d--);return{added:b,removed:a}},val:function(c,d){var e,f=this;if(0===arguments.length)return this.getVal();if(e=this.data(),e.length||(e=[]),!c&&0!==c)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),d&&this.triggerChange({added:this.data(),removed:e}),void 0;if(this.setVal(c),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),d&&this.triggerChange(this.buildChangeDetails(e,this.data()));else{if(this.opts.initSelection===b)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(b){var c=a.map(b,f.id);f.setVal(c),f.updateSelection(b),f.clearSearch(),d&&f.triggerChange(f.buildChangeDetails(e,f.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var b=[],c=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){b.push(c.opts.id(a(this).data("select2-data")))}),this.setVal(b),this.triggerChange()},data:function(b,c){var e,f,d=this;return 0===arguments.length?this.selection.find(".select2-search-choice").map(function(){return a(this).data("select2-data")}).get():(f=this.data(),b||(b=[]),e=a.map(b,function(a){return d.opts.id(a)}),this.setVal(e),this.updateSelection(b),this.clearSearch(),c&&this.triggerChange(this.buildChangeDetails(f,this.data())),void 0)}}),a.fn.select2=function(){var d,g,h,i,j,c=Array.prototype.slice.call(arguments,0),k=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],l=["opened","isFocused","container","dropdown"],m=["val","data"],n={search:"externalSearch"};return this.each(function(){if(0===c.length||"object"==typeof c[0])d=0===c.length?{}:a.extend({},c[0]),d.element=a(this),"select"===d.element.get(0).tagName.toLowerCase()?j=d.element.prop("multiple"):(j=d.multiple||!1,"tags"in d&&(d.multiple=j=!0)),g=j?new f:new e,g.init(d);else{if("string"!=typeof c[0])throw"Invalid arguments to select2 plugin: "+c;if(o(c[0],k)<0)throw"Unknown method: "+c[0];if(i=b,g=a(this).data("select2"),g===b)return;if(h=c[0],"container"===h?i=g.container:"dropdown"===h?i=g.dropdown:(n[h]&&(h=n[h]),i=g[h].apply(g,c.slice(1))),o(c[0],l)>=0||o(c[0],m)&&1==c.length)return!1}}),i===b?this:i},a.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(a,b,c,d){var e=[];return E(a.text,c.term,e,d),e.join("")},formatSelection:function(a,c,d){return a?d(a.text):b},sortResults:function(a){return a},formatResultCssClass:function(){return b},formatSelectionCssClass:function(){return b},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(a,b){var c=b-a.length;return"Please enter "+c+" more character"+(1==c?"":"s")},formatInputTooLong:function(a,b){var c=a.length-b;return"Please delete "+c+" character"+(1==c?"":"s")},formatSelectionTooBig:function(a){return"You can only select "+a+" item"+(1==a?"":"s")},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(a){return a.id},matcher:function(a,b){return n(""+b).toUpperCase().indexOf(n(""+a).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:M,escapeMarkup:F,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(a){return a},adaptDropdownCssClass:function(){return null},nextSearchTerm:function(){return b}},a.fn.select2.ajaxDefaults={transport:a.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:G,local:H,tags:I},util:{debounce:v,markMatch:E,escapeMarkup:F,stripDiacritics:n},"class":{"abstract":d,single:e,multi:f}}}}(jQuery);
//     Underscore.js 1.8.3
//     http://underscorejs.org
//     (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.
(function(){function n(n){function t(t,r,e,u,i,o){for(;i>=0&&o>i;i+=n){var a=u?u[i]:i;e=r(e,t[a],a,t)}return e}return function(r,e,u,i){e=b(e,i,4);var o=!k(r)&&m.keys(r),a=(o||r).length,c=n>0?0:a-1;return arguments.length<3&&(u=r[o?o[c]:c],c+=n),t(r,e,u,o,c,a)}}function t(n){return function(t,r,e){r=x(r,e);for(var u=O(t),i=n>0?0:u-1;i>=0&&u>i;i+=n)if(r(t[i],i,t))return i;return-1}}function r(n,t,r){return function(e,u,i){var o=0,a=O(e);if("number"==typeof i)n>0?o=i>=0?i:Math.max(i+a,o):a=i>=0?Math.min(i+1,a):i+a+1;else if(r&&i&&a)return i=r(e,u),e[i]===u?i:-1;if(u!==u)return i=t(l.call(e,o,a),m.isNaN),i>=0?i+o:-1;for(i=n>0?o:a-1;i>=0&&a>i;i+=n)if(e[i]===u)return i;return-1}}function e(n,t){var r=I.length,e=n.constructor,u=m.isFunction(e)&&e.prototype||a,i="constructor";for(m.has(n,i)&&!m.contains(t,i)&&t.push(i);r--;)i=I[r],i in n&&n[i]!==u[i]&&!m.contains(t,i)&&t.push(i)}var u=this,i=u._,o=Array.prototype,a=Object.prototype,c=Function.prototype,f=o.push,l=o.slice,s=a.toString,p=a.hasOwnProperty,h=Array.isArray,v=Object.keys,g=c.bind,y=Object.create,d=function(){},m=function(n){return n instanceof m?n:this instanceof m?void(this._wrapped=n):new m(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=m),exports._=m):u._=m,m.VERSION="1.8.3";var b=function(n,t,r){if(t===void 0)return n;switch(null==r?3:r){case 1:return function(r){return n.call(t,r)};case 2:return function(r,e){return n.call(t,r,e)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)}}return function(){return n.apply(t,arguments)}},x=function(n,t,r){return null==n?m.identity:m.isFunction(n)?b(n,t,r):m.isObject(n)?m.matcher(n):m.property(n)};m.iteratee=function(n,t){return x(n,t,1/0)};var _=function(n,t){return function(r){var e=arguments.length;if(2>e||null==r)return r;for(var u=1;e>u;u++)for(var i=arguments[u],o=n(i),a=o.length,c=0;a>c;c++){var f=o[c];t&&r[f]!==void 0||(r[f]=i[f])}return r}},j=function(n){if(!m.isObject(n))return{};if(y)return y(n);d.prototype=n;var t=new d;return d.prototype=null,t},w=function(n){return function(t){return null==t?void 0:t[n]}},A=Math.pow(2,53)-1,O=w("length"),k=function(n){var t=O(n);return"number"==typeof t&&t>=0&&A>=t};m.each=m.forEach=function(n,t,r){t=b(t,r);var e,u;if(k(n))for(e=0,u=n.length;u>e;e++)t(n[e],e,n);else{var i=m.keys(n);for(e=0,u=i.length;u>e;e++)t(n[i[e]],i[e],n)}return n},m.map=m.collect=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=Array(u),o=0;u>o;o++){var a=e?e[o]:o;i[o]=t(n[a],a,n)}return i},m.reduce=m.foldl=m.inject=n(1),m.reduceRight=m.foldr=n(-1),m.find=m.detect=function(n,t,r){var e;return e=k(n)?m.findIndex(n,t,r):m.findKey(n,t,r),e!==void 0&&e!==-1?n[e]:void 0},m.filter=m.select=function(n,t,r){var e=[];return t=x(t,r),m.each(n,function(n,r,u){t(n,r,u)&&e.push(n)}),e},m.reject=function(n,t,r){return m.filter(n,m.negate(x(t)),r)},m.every=m.all=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=0;u>i;i++){var o=e?e[i]:i;if(!t(n[o],o,n))return!1}return!0},m.some=m.any=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=0;u>i;i++){var o=e?e[i]:i;if(t(n[o],o,n))return!0}return!1},m.contains=m.includes=m.include=function(n,t,r,e){return k(n)||(n=m.values(n)),("number"!=typeof r||e)&&(r=0),m.indexOf(n,t,r)>=0},m.invoke=function(n,t){var r=l.call(arguments,2),e=m.isFunction(t);return m.map(n,function(n){var u=e?t:n[t];return null==u?u:u.apply(n,r)})},m.pluck=function(n,t){return m.map(n,m.property(t))},m.where=function(n,t){return m.filter(n,m.matcher(t))},m.findWhere=function(n,t){return m.find(n,m.matcher(t))},m.max=function(n,t,r){var e,u,i=-1/0,o=-1/0;if(null==t&&null!=n){n=k(n)?n:m.values(n);for(var a=0,c=n.length;c>a;a++)e=n[a],e>i&&(i=e)}else t=x(t,r),m.each(n,function(n,r,e){u=t(n,r,e),(u>o||u===-1/0&&i===-1/0)&&(i=n,o=u)});return i},m.min=function(n,t,r){var e,u,i=1/0,o=1/0;if(null==t&&null!=n){n=k(n)?n:m.values(n);for(var a=0,c=n.length;c>a;a++)e=n[a],i>e&&(i=e)}else t=x(t,r),m.each(n,function(n,r,e){u=t(n,r,e),(o>u||1/0===u&&1/0===i)&&(i=n,o=u)});return i},m.shuffle=function(n){for(var t,r=k(n)?n:m.values(n),e=r.length,u=Array(e),i=0;e>i;i++)t=m.random(0,i),t!==i&&(u[i]=u[t]),u[t]=r[i];return u},m.sample=function(n,t,r){return null==t||r?(k(n)||(n=m.values(n)),n[m.random(n.length-1)]):m.shuffle(n).slice(0,Math.max(0,t))},m.sortBy=function(n,t,r){return t=x(t,r),m.pluck(m.map(n,function(n,r,e){return{value:n,index:r,criteria:t(n,r,e)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index-t.index}),"value")};var F=function(n){return function(t,r,e){var u={};return r=x(r,e),m.each(t,function(e,i){var o=r(e,i,t);n(u,e,o)}),u}};m.groupBy=F(function(n,t,r){m.has(n,r)?n[r].push(t):n[r]=[t]}),m.indexBy=F(function(n,t,r){n[r]=t}),m.countBy=F(function(n,t,r){m.has(n,r)?n[r]++:n[r]=1}),m.toArray=function(n){return n?m.isArray(n)?l.call(n):k(n)?m.map(n,m.identity):m.values(n):[]},m.size=function(n){return null==n?0:k(n)?n.length:m.keys(n).length},m.partition=function(n,t,r){t=x(t,r);var e=[],u=[];return m.each(n,function(n,r,i){(t(n,r,i)?e:u).push(n)}),[e,u]},m.first=m.head=m.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:m.initial(n,n.length-t)},m.initial=function(n,t,r){return l.call(n,0,Math.max(0,n.length-(null==t||r?1:t)))},m.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:m.rest(n,Math.max(0,n.length-t))},m.rest=m.tail=m.drop=function(n,t,r){return l.call(n,null==t||r?1:t)},m.compact=function(n){return m.filter(n,m.identity)};var S=function(n,t,r,e){for(var u=[],i=0,o=e||0,a=O(n);a>o;o++){var c=n[o];if(k(c)&&(m.isArray(c)||m.isArguments(c))){t||(c=S(c,t,r));var f=0,l=c.length;for(u.length+=l;l>f;)u[i++]=c[f++]}else r||(u[i++]=c)}return u};m.flatten=function(n,t){return S(n,t,!1)},m.without=function(n){return m.difference(n,l.call(arguments,1))},m.uniq=m.unique=function(n,t,r,e){m.isBoolean(t)||(e=r,r=t,t=!1),null!=r&&(r=x(r,e));for(var u=[],i=[],o=0,a=O(n);a>o;o++){var c=n[o],f=r?r(c,o,n):c;t?(o&&i===f||u.push(c),i=f):r?m.contains(i,f)||(i.push(f),u.push(c)):m.contains(u,c)||u.push(c)}return u},m.union=function(){return m.uniq(S(arguments,!0,!0))},m.intersection=function(n){for(var t=[],r=arguments.length,e=0,u=O(n);u>e;e++){var i=n[e];if(!m.contains(t,i)){for(var o=1;r>o&&m.contains(arguments[o],i);o++);o===r&&t.push(i)}}return t},m.difference=function(n){var t=S(arguments,!0,!0,1);return m.filter(n,function(n){return!m.contains(t,n)})},m.zip=function(){return m.unzip(arguments)},m.unzip=function(n){for(var t=n&&m.max(n,O).length||0,r=Array(t),e=0;t>e;e++)r[e]=m.pluck(n,e);return r},m.object=function(n,t){for(var r={},e=0,u=O(n);u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},m.findIndex=t(1),m.findLastIndex=t(-1),m.sortedIndex=function(n,t,r,e){r=x(r,e,1);for(var u=r(t),i=0,o=O(n);o>i;){var a=Math.floor((i+o)/2);r(n[a])<u?i=a+1:o=a}return i},m.indexOf=r(1,m.findIndex,m.sortedIndex),m.lastIndexOf=r(-1,m.findLastIndex),m.range=function(n,t,r){null==t&&(t=n||0,n=0),r=r||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=Array(e),i=0;e>i;i++,n+=r)u[i]=n;return u};var E=function(n,t,r,e,u){if(!(e instanceof t))return n.apply(r,u);var i=j(n.prototype),o=n.apply(i,u);return m.isObject(o)?o:i};m.bind=function(n,t){if(g&&n.bind===g)return g.apply(n,l.call(arguments,1));if(!m.isFunction(n))throw new TypeError("Bind must be called on a function");var r=l.call(arguments,2),e=function(){return E(n,e,t,this,r.concat(l.call(arguments)))};return e},m.partial=function(n){var t=l.call(arguments,1),r=function(){for(var e=0,u=t.length,i=Array(u),o=0;u>o;o++)i[o]=t[o]===m?arguments[e++]:t[o];for(;e<arguments.length;)i.push(arguments[e++]);return E(n,r,this,this,i)};return r},m.bindAll=function(n){var t,r,e=arguments.length;if(1>=e)throw new Error("bindAll must be passed function names");for(t=1;e>t;t++)r=arguments[t],n[r]=m.bind(n[r],n);return n},m.memoize=function(n,t){var r=function(e){var u=r.cache,i=""+(t?t.apply(this,arguments):e);return m.has(u,i)||(u[i]=n.apply(this,arguments)),u[i]};return r.cache={},r},m.delay=function(n,t){var r=l.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},m.defer=m.partial(m.delay,m,1),m.throttle=function(n,t,r){var e,u,i,o=null,a=0;r||(r={});var c=function(){a=r.leading===!1?0:m.now(),o=null,i=n.apply(e,u),o||(e=u=null)};return function(){var f=m.now();a||r.leading!==!1||(a=f);var l=t-(f-a);return e=this,u=arguments,0>=l||l>t?(o&&(clearTimeout(o),o=null),a=f,i=n.apply(e,u),o||(e=u=null)):o||r.trailing===!1||(o=setTimeout(c,l)),i}},m.debounce=function(n,t,r){var e,u,i,o,a,c=function(){var f=m.now()-o;t>f&&f>=0?e=setTimeout(c,t-f):(e=null,r||(a=n.apply(i,u),e||(i=u=null)))};return function(){i=this,u=arguments,o=m.now();var f=r&&!e;return e||(e=setTimeout(c,t)),f&&(a=n.apply(i,u),i=u=null),a}},m.wrap=function(n,t){return m.partial(t,n)},m.negate=function(n){return function(){return!n.apply(this,arguments)}},m.compose=function(){var n=arguments,t=n.length-1;return function(){for(var r=t,e=n[t].apply(this,arguments);r--;)e=n[r].call(this,e);return e}},m.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},m.before=function(n,t){var r;return function(){return--n>0&&(r=t.apply(this,arguments)),1>=n&&(t=null),r}},m.once=m.partial(m.before,2);var M=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];m.keys=function(n){if(!m.isObject(n))return[];if(v)return v(n);var t=[];for(var r in n)m.has(n,r)&&t.push(r);return M&&e(n,t),t},m.allKeys=function(n){if(!m.isObject(n))return[];var t=[];for(var r in n)t.push(r);return M&&e(n,t),t},m.values=function(n){for(var t=m.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},m.mapObject=function(n,t,r){t=x(t,r);for(var e,u=m.keys(n),i=u.length,o={},a=0;i>a;a++)e=u[a],o[e]=t(n[e],e,n);return o},m.pairs=function(n){for(var t=m.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},m.invert=function(n){for(var t={},r=m.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},m.functions=m.methods=function(n){var t=[];for(var r in n)m.isFunction(n[r])&&t.push(r);return t.sort()},m.extend=_(m.allKeys),m.extendOwn=m.assign=_(m.keys),m.findKey=function(n,t,r){t=x(t,r);for(var e,u=m.keys(n),i=0,o=u.length;o>i;i++)if(e=u[i],t(n[e],e,n))return e},m.pick=function(n,t,r){var e,u,i={},o=n;if(null==o)return i;m.isFunction(t)?(u=m.allKeys(o),e=b(t,r)):(u=S(arguments,!1,!1,1),e=function(n,t,r){return t in r},o=Object(o));for(var a=0,c=u.length;c>a;a++){var f=u[a],l=o[f];e(l,f,o)&&(i[f]=l)}return i},m.omit=function(n,t,r){if(m.isFunction(t))t=m.negate(t);else{var e=m.map(S(arguments,!1,!1,1),String);t=function(n,t){return!m.contains(e,t)}}return m.pick(n,t,r)},m.defaults=_(m.allKeys,!0),m.create=function(n,t){var r=j(n);return t&&m.extendOwn(r,t),r},m.clone=function(n){return m.isObject(n)?m.isArray(n)?n.slice():m.extend({},n):n},m.tap=function(n,t){return t(n),n},m.isMatch=function(n,t){var r=m.keys(t),e=r.length;if(null==n)return!e;for(var u=Object(n),i=0;e>i;i++){var o=r[i];if(t[o]!==u[o]||!(o in u))return!1}return!0};var N=function(n,t,r,e){if(n===t)return 0!==n||1/n===1/t;if(null==n||null==t)return n===t;n instanceof m&&(n=n._wrapped),t instanceof m&&(t=t._wrapped);var u=s.call(n);if(u!==s.call(t))return!1;switch(u){case"[object RegExp]":case"[object String]":return""+n==""+t;case"[object Number]":return+n!==+n?+t!==+t:0===+n?1/+n===1/t:+n===+t;case"[object Date]":case"[object Boolean]":return+n===+t}var i="[object Array]"===u;if(!i){if("object"!=typeof n||"object"!=typeof t)return!1;var o=n.constructor,a=t.constructor;if(o!==a&&!(m.isFunction(o)&&o instanceof o&&m.isFunction(a)&&a instanceof a)&&"constructor"in n&&"constructor"in t)return!1}r=r||[],e=e||[];for(var c=r.length;c--;)if(r[c]===n)return e[c]===t;if(r.push(n),e.push(t),i){if(c=n.length,c!==t.length)return!1;for(;c--;)if(!N(n[c],t[c],r,e))return!1}else{var f,l=m.keys(n);if(c=l.length,m.keys(t).length!==c)return!1;for(;c--;)if(f=l[c],!m.has(t,f)||!N(n[f],t[f],r,e))return!1}return r.pop(),e.pop(),!0};m.isEqual=function(n,t){return N(n,t)},m.isEmpty=function(n){return null==n?!0:k(n)&&(m.isArray(n)||m.isString(n)||m.isArguments(n))?0===n.length:0===m.keys(n).length},m.isElement=function(n){return!(!n||1!==n.nodeType)},m.isArray=h||function(n){return"[object Array]"===s.call(n)},m.isObject=function(n){var t=typeof n;return"function"===t||"object"===t&&!!n},m.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(n){m["is"+n]=function(t){return s.call(t)==="[object "+n+"]"}}),m.isArguments(arguments)||(m.isArguments=function(n){return m.has(n,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(m.isFunction=function(n){return"function"==typeof n||!1}),m.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},m.isNaN=function(n){return m.isNumber(n)&&n!==+n},m.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"===s.call(n)},m.isNull=function(n){return null===n},m.isUndefined=function(n){return n===void 0},m.has=function(n,t){return null!=n&&p.call(n,t)},m.noConflict=function(){return u._=i,this},m.identity=function(n){return n},m.constant=function(n){return function(){return n}},m.noop=function(){},m.property=w,m.propertyOf=function(n){return null==n?function(){}:function(t){return n[t]}},m.matcher=m.matches=function(n){return n=m.extendOwn({},n),function(t){return m.isMatch(t,n)}},m.times=function(n,t,r){var e=Array(Math.max(0,n));t=b(t,r,1);for(var u=0;n>u;u++)e[u]=t(u);return e},m.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},m.now=Date.now||function(){return(new Date).getTime()};var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},T=m.invert(B),R=function(n){var t=function(t){return n[t]},r="(?:"+m.keys(n).join("|")+")",e=RegExp(r),u=RegExp(r,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,t):n}};m.escape=R(B),m.unescape=R(T),m.result=function(n,t,r){var e=null==n?void 0:n[t];return e===void 0&&(e=r),m.isFunction(e)?e.call(n):e};var q=0;m.uniqueId=function(n){var t=++q+"";return n?n+t:t},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var K=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\u2028|\u2029/g,L=function(n){return"\\"+z[n]};m.template=function(n,t,r){!t&&r&&(t=r),t=m.defaults({},t,m.templateSettings);var e=RegExp([(t.escape||K).source,(t.interpolate||K).source,(t.evaluate||K).source].join("|")+"|$","g"),u=0,i="__p+='";n.replace(e,function(t,r,e,o,a){return i+=n.slice(u,a).replace(D,L),u=a+t.length,r?i+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":e?i+="'+\n((__t=("+e+"))==null?'':__t)+\n'":o&&(i+="';\n"+o+"\n__p+='"),t}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var o=new Function(t.variable||"obj","_",i)}catch(a){throw a.source=i,a}var c=function(n){return o.call(this,n,m)},f=t.variable||"obj";return c.source="function("+f+"){\n"+i+"}",c},m.chain=function(n){var t=m(n);return t._chain=!0,t};var P=function(n,t){return n._chain?m(t).chain():t};m.mixin=function(n){m.each(m.functions(n),function(t){var r=m[t]=n[t];m.prototype[t]=function(){var n=[this._wrapped];return f.apply(n,arguments),P(this,r.apply(m,n))}})},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=o[n];m.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==n&&"splice"!==n||0!==r.length||delete r[0],P(this,r)}}),m.each(["concat","join","slice"],function(n){var t=o[n];m.prototype[n]=function(){return P(this,t.apply(this._wrapped,arguments))}}),m.prototype.value=function(){return this._wrapped},m.prototype.valueOf=m.prototype.toJSON=m.prototype.value,m.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return m})}).call(this);
//# sourceMappingURL=underscore-min.map
(function(t){var e=typeof self=="object"&&self.self==self&&self||typeof global=="object"&&global.global==global&&global;if(typeof define==="function"&&define.amd){define(["underscore","jquery","exports"],function(i,r,n){e.Backbone=t(e,n,i,r)})}else if(typeof exports!=="undefined"){var i=require("underscore"),r;try{r=require("jquery")}catch(n){}t(e,exports,i,r)}else{e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}})(function(t,e,i,r){var n=t.Backbone;var s=Array.prototype.slice;e.VERSION="1.2.3";e.$=r;e.noConflict=function(){t.Backbone=n;return this};e.emulateHTTP=false;e.emulateJSON=false;var a=function(t,e,r){switch(t){case 1:return function(){return i[e](this[r])};case 2:return function(t){return i[e](this[r],t)};case 3:return function(t,n){return i[e](this[r],h(t,this),n)};case 4:return function(t,n,s){return i[e](this[r],h(t,this),n,s)};default:return function(){var t=s.call(arguments);t.unshift(this[r]);return i[e].apply(i,t)}}};var o=function(t,e,r){i.each(e,function(e,n){if(i[n])t.prototype[n]=a(e,n,r)})};var h=function(t,e){if(i.isFunction(t))return t;if(i.isObject(t)&&!e._isModel(t))return u(t);if(i.isString(t))return function(e){return e.get(t)};return t};var u=function(t){var e=i.matches(t);return function(t){return e(t.attributes)}};var l=e.Events={};var c=/\s+/;var f=function(t,e,r,n,s){var a=0,o;if(r&&typeof r==="object"){if(n!==void 0&&"context"in s&&s.context===void 0)s.context=n;for(o=i.keys(r);a<o.length;a++){e=f(t,e,o[a],r[o[a]],s)}}else if(r&&c.test(r)){for(o=r.split(c);a<o.length;a++){e=t(e,o[a],n,s)}}else{e=t(e,r,n,s)}return e};l.on=function(t,e,i){return d(this,t,e,i)};var d=function(t,e,i,r,n){t._events=f(v,t._events||{},e,i,{context:r,ctx:t,listening:n});if(n){var s=t._listeners||(t._listeners={});s[n.id]=n}return t};l.listenTo=function(t,e,r){if(!t)return this;var n=t._listenId||(t._listenId=i.uniqueId("l"));var s=this._listeningTo||(this._listeningTo={});var a=s[n];if(!a){var o=this._listenId||(this._listenId=i.uniqueId("l"));a=s[n]={obj:t,objId:n,id:o,listeningTo:s,count:0}}d(t,e,r,this,a);return this};var v=function(t,e,i,r){if(i){var n=t[e]||(t[e]=[]);var s=r.context,a=r.ctx,o=r.listening;if(o)o.count++;n.push({callback:i,context:s,ctx:s||a,listening:o})}return t};l.off=function(t,e,i){if(!this._events)return this;this._events=f(g,this._events,t,e,{context:i,listeners:this._listeners});return this};l.stopListening=function(t,e,r){var n=this._listeningTo;if(!n)return this;var s=t?[t._listenId]:i.keys(n);for(var a=0;a<s.length;a++){var o=n[s[a]];if(!o)break;o.obj.off(e,r,this)}if(i.isEmpty(n))this._listeningTo=void 0;return this};var g=function(t,e,r,n){if(!t)return;var s=0,a;var o=n.context,h=n.listeners;if(!e&&!r&&!o){var u=i.keys(h);for(;s<u.length;s++){a=h[u[s]];delete h[a.id];delete a.listeningTo[a.objId]}return}var l=e?[e]:i.keys(t);for(;s<l.length;s++){e=l[s];var c=t[e];if(!c)break;var f=[];for(var d=0;d<c.length;d++){var v=c[d];if(r&&r!==v.callback&&r!==v.callback._callback||o&&o!==v.context){f.push(v)}else{a=v.listening;if(a&&--a.count===0){delete h[a.id];delete a.listeningTo[a.objId]}}}if(f.length){t[e]=f}else{delete t[e]}}if(i.size(t))return t};l.once=function(t,e,r){var n=f(p,{},t,e,i.bind(this.off,this));return this.on(n,void 0,r)};l.listenToOnce=function(t,e,r){var n=f(p,{},e,r,i.bind(this.stopListening,this,t));return this.listenTo(t,n)};var p=function(t,e,r,n){if(r){var s=t[e]=i.once(function(){n(e,s);r.apply(this,arguments)});s._callback=r}return t};l.trigger=function(t){if(!this._events)return this;var e=Math.max(0,arguments.length-1);var i=Array(e);for(var r=0;r<e;r++)i[r]=arguments[r+1];f(m,this._events,t,void 0,i);return this};var m=function(t,e,i,r){if(t){var n=t[e];var s=t.all;if(n&&s)s=s.slice();if(n)_(n,r);if(s)_(s,[e].concat(r))}return t};var _=function(t,e){var i,r=-1,n=t.length,s=e[0],a=e[1],o=e[2];switch(e.length){case 0:while(++r<n)(i=t[r]).callback.call(i.ctx);return;case 1:while(++r<n)(i=t[r]).callback.call(i.ctx,s);return;case 2:while(++r<n)(i=t[r]).callback.call(i.ctx,s,a);return;case 3:while(++r<n)(i=t[r]).callback.call(i.ctx,s,a,o);return;default:while(++r<n)(i=t[r]).callback.apply(i.ctx,e);return}};l.bind=l.on;l.unbind=l.off;i.extend(e,l);var y=e.Model=function(t,e){var r=t||{};e||(e={});this.cid=i.uniqueId(this.cidPrefix);this.attributes={};if(e.collection)this.collection=e.collection;if(e.parse)r=this.parse(r,e)||{};r=i.defaults({},r,i.result(this,"defaults"));this.set(r,e);this.changed={};this.initialize.apply(this,arguments)};i.extend(y.prototype,l,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(t){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return this.get(t)!=null},matches:function(t){return!!i.iteratee(t,this)(this.attributes)},set:function(t,e,r){if(t==null)return this;var n;if(typeof t==="object"){n=t;r=e}else{(n={})[t]=e}r||(r={});if(!this._validate(n,r))return false;var s=r.unset;var a=r.silent;var o=[];var h=this._changing;this._changing=true;if(!h){this._previousAttributes=i.clone(this.attributes);this.changed={}}var u=this.attributes;var l=this.changed;var c=this._previousAttributes;for(var f in n){e=n[f];if(!i.isEqual(u[f],e))o.push(f);if(!i.isEqual(c[f],e)){l[f]=e}else{delete l[f]}s?delete u[f]:u[f]=e}this.id=this.get(this.idAttribute);if(!a){if(o.length)this._pending=r;for(var d=0;d<o.length;d++){this.trigger("change:"+o[d],this,u[o[d]],r)}}if(h)return this;if(!a){while(this._pending){r=this._pending;this._pending=false;this.trigger("change",this,r)}}this._pending=false;this._changing=false;return this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:true}))},clear:function(t){var e={};for(var r in this.attributes)e[r]=void 0;return this.set(e,i.extend({},t,{unset:true}))},hasChanged:function(t){if(t==null)return!i.isEmpty(this.changed);return i.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?i.clone(this.changed):false;var e=this._changing?this._previousAttributes:this.attributes;var r={};for(var n in t){var s=t[n];if(i.isEqual(e[n],s))continue;r[n]=s}return i.size(r)?r:false},previous:function(t){if(t==null||!this._previousAttributes)return null;return this._previousAttributes[t]},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=i.extend({parse:true},t);var e=this;var r=t.success;t.success=function(i){var n=t.parse?e.parse(i,t):i;if(!e.set(n,t))return false;if(r)r.call(t.context,e,i,t);e.trigger("sync",e,i,t)};z(this,t);return this.sync("read",this,t)},save:function(t,e,r){var n;if(t==null||typeof t==="object"){n=t;r=e}else{(n={})[t]=e}r=i.extend({validate:true,parse:true},r);var s=r.wait;if(n&&!s){if(!this.set(n,r))return false}else{if(!this._validate(n,r))return false}var a=this;var o=r.success;var h=this.attributes;r.success=function(t){a.attributes=h;var e=r.parse?a.parse(t,r):t;if(s)e=i.extend({},n,e);if(e&&!a.set(e,r))return false;if(o)o.call(r.context,a,t,r);a.trigger("sync",a,t,r)};z(this,r);if(n&&s)this.attributes=i.extend({},h,n);var u=this.isNew()?"create":r.patch?"patch":"update";if(u==="patch"&&!r.attrs)r.attrs=n;var l=this.sync(u,this,r);this.attributes=h;return l},destroy:function(t){t=t?i.clone(t):{};var e=this;var r=t.success;var n=t.wait;var s=function(){e.stopListening();e.trigger("destroy",e,e.collection,t)};t.success=function(i){if(n)s();if(r)r.call(t.context,e,i,t);if(!e.isNew())e.trigger("sync",e,i,t)};var a=false;if(this.isNew()){i.defer(t.success)}else{z(this,t);a=this.sync("delete",this,t)}if(!n)s();return a},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||F();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.defaults({validate:true},t))},_validate:function(t,e){if(!e.validate||!this.validate)return true;t=i.extend({},this.attributes,t);var r=this.validationError=this.validate(t,e)||null;if(!r)return true;this.trigger("invalid",this,r,i.extend(e,{validationError:r}));return false}});var b={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};o(y,b,"attributes");var x=e.Collection=function(t,e){e||(e={});if(e.model)this.model=e.model;if(e.comparator!==void 0)this.comparator=e.comparator;this._reset();this.initialize.apply(this,arguments);if(t)this.reset(t,i.extend({silent:true},e))};var w={add:true,remove:true,merge:true};var E={add:true,remove:false};var k=function(t,e,i){i=Math.min(Math.max(i,0),t.length);var r=Array(t.length-i);var n=e.length;for(var s=0;s<r.length;s++)r[s]=t[s+i];for(s=0;s<n;s++)t[s+i]=e[s];for(s=0;s<r.length;s++)t[s+n+i]=r[s]};i.extend(x.prototype,l,{model:y,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:false},e,E))},remove:function(t,e){e=i.extend({},e);var r=!i.isArray(t);t=r?[t]:i.clone(t);var n=this._removeModels(t,e);if(!e.silent&&n)this.trigger("update",this,e);return r?n[0]:n},set:function(t,e){if(t==null)return;e=i.defaults({},e,w);if(e.parse&&!this._isModel(t))t=this.parse(t,e);var r=!i.isArray(t);t=r?[t]:t.slice();var n=e.at;if(n!=null)n=+n;if(n<0)n+=this.length+1;var s=[];var a=[];var o=[];var h={};var u=e.add;var l=e.merge;var c=e.remove;var f=false;var d=this.comparator&&n==null&&e.sort!==false;var v=i.isString(this.comparator)?this.comparator:null;var g;for(var p=0;p<t.length;p++){g=t[p];var m=this.get(g);if(m){if(l&&g!==m){var _=this._isModel(g)?g.attributes:g;if(e.parse)_=m.parse(_,e);m.set(_,e);if(d&&!f)f=m.hasChanged(v)}if(!h[m.cid]){h[m.cid]=true;s.push(m)}t[p]=m}else if(u){g=t[p]=this._prepareModel(g,e);if(g){a.push(g);this._addReference(g,e);h[g.cid]=true;s.push(g)}}}if(c){for(p=0;p<this.length;p++){g=this.models[p];if(!h[g.cid])o.push(g)}if(o.length)this._removeModels(o,e)}var y=false;var b=!d&&u&&c;if(s.length&&b){y=this.length!=s.length||i.some(this.models,function(t,e){return t!==s[e]});this.models.length=0;k(this.models,s,0);this.length=this.models.length}else if(a.length){if(d)f=true;k(this.models,a,n==null?this.length:n);this.length=this.models.length}if(f)this.sort({silent:true});if(!e.silent){for(p=0;p<a.length;p++){if(n!=null)e.index=n+p;g=a[p];g.trigger("add",g,this,e)}if(f||y)this.trigger("sort",this,e);if(a.length||o.length)this.trigger("update",this,e)}return r?t[0]:t},reset:function(t,e){e=e?i.clone(e):{};for(var r=0;r<this.models.length;r++){this._removeReference(this.models[r],e)}e.previousModels=this.models;this._reset();t=this.add(t,i.extend({silent:true},e));if(!e.silent)this.trigger("reset",this,e);return t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return s.apply(this.models,arguments)},get:function(t){if(t==null)return void 0;var e=this.modelId(this._isModel(t)?t.attributes:t);return this._byId[t]||this._byId[e]||this._byId[t.cid]},at:function(t){if(t<0)t+=this.length;return this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,true)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var r=e.length;if(i.isFunction(e))e=i.bind(e,this);if(r===1||i.isString(e)){this.models=this.sortBy(e)}else{this.models.sort(e)}if(!t.silent)this.trigger("sort",this,t);return this},pluck:function(t){return i.invoke(this.models,"get",t)},fetch:function(t){t=i.extend({parse:true},t);var e=t.success;var r=this;t.success=function(i){var n=t.reset?"reset":"set";r[n](i,t);if(e)e.call(t.context,r,i,t);r.trigger("sync",r,i,t)};z(this,t);return this.sync("read",this,t)},create:function(t,e){e=e?i.clone(e):{};var r=e.wait;t=this._prepareModel(t,e);if(!t)return false;if(!r)this.add(t,e);var n=this;var s=e.success;e.success=function(t,e,i){if(r)n.add(t,i);if(s)s.call(i.context,t,e,i)};t.save(null,e);return t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(t,e){if(this._isModel(t)){if(!t.collection)t.collection=this;return t}e=e?i.clone(e):{};e.collection=this;var r=new this.model(t,e);if(!r.validationError)return r;this.trigger("invalid",this,r.validationError,e);return false},_removeModels:function(t,e){var i=[];for(var r=0;r<t.length;r++){var n=this.get(t[r]);if(!n)continue;var s=this.indexOf(n);this.models.splice(s,1);this.length--;if(!e.silent){e.index=s;n.trigger("remove",n,this,e)}i.push(n);this._removeReference(n,e)}return i.length?i:false},_isModel:function(t){return t instanceof y},_addReference:function(t,e){this._byId[t.cid]=t;var i=this.modelId(t.attributes);if(i!=null)this._byId[i]=t;t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var i=this.modelId(t.attributes);if(i!=null)delete this._byId[i];if(this===t.collection)delete t.collection;t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,r){if((t==="add"||t==="remove")&&i!==this)return;if(t==="destroy")this.remove(e,r);if(t==="change"){var n=this.modelId(e.previousAttributes());var s=this.modelId(e.attributes);if(n!==s){if(n!=null)delete this._byId[n];if(s!=null)this._byId[s]=e}}this.trigger.apply(this,arguments)}});var S={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3};o(x,S,"models");var I=e.View=function(t){this.cid=i.uniqueId("view");i.extend(this,i.pick(t,P));this._ensureElement();this.initialize.apply(this,arguments)};var T=/^(\S+)\s*(.*)$/;var P=["model","collection","el","id","attributes","className","tagName","events"];i.extend(I.prototype,l,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){this._removeElement();this.stopListening();return this},_removeElement:function(){this.$el.remove()},setElement:function(t){this.undelegateEvents();this._setElement(t);this.delegateEvents();return this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t);this.el=this.$el[0]},delegateEvents:function(t){t||(t=i.result(this,"events"));if(!t)return this;this.undelegateEvents();for(var e in t){var r=t[e];if(!i.isFunction(r))r=this[r];if(!r)continue;var n=e.match(T);this.delegate(n[1],n[2],i.bind(r,this))}return this},delegate:function(t,e,i){this.$el.on(t+".delegateEvents"+this.cid,e,i);return this},undelegateEvents:function(){if(this.$el)this.$el.off(".delegateEvents"+this.cid);return this},undelegate:function(t,e,i){this.$el.off(t+".delegateEvents"+this.cid,e,i);return this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(!this.el){var t=i.extend({},i.result(this,"attributes"));if(this.id)t.id=i.result(this,"id");if(this.className)t["class"]=i.result(this,"className");this.setElement(this._createElement(i.result(this,"tagName")));this._setAttributes(t)}else{this.setElement(i.result(this,"el"))}},_setAttributes:function(t){this.$el.attr(t)}});e.sync=function(t,r,n){var s=H[t];i.defaults(n||(n={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:s,dataType:"json"};if(!n.url){a.url=i.result(r,"url")||F()}if(n.data==null&&r&&(t==="create"||t==="update"||t==="patch")){a.contentType="application/json";a.data=JSON.stringify(n.attrs||r.toJSON(n))}if(n.emulateJSON){a.contentType="application/x-www-form-urlencoded";a.data=a.data?{model:a.data}:{}}if(n.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){a.type="POST";if(n.emulateJSON)a.data._method=s;var o=n.beforeSend;n.beforeSend=function(t){t.setRequestHeader("X-HTTP-Method-Override",s);if(o)return o.apply(this,arguments)}}if(a.type!=="GET"&&!n.emulateJSON){a.processData=false}var h=n.error;n.error=function(t,e,i){n.textStatus=e;n.errorThrown=i;if(h)h.call(n.context,t,e,i)};var u=n.xhr=e.ajax(i.extend(a,n));r.trigger("request",r,u,n);return u};var H={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var $=e.Router=function(t){t||(t={});if(t.routes)this.routes=t.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var A=/\((.*?)\)/g;var C=/(\(\?)?:\w+/g;var R=/\*\w+/g;var j=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend($.prototype,l,{initialize:function(){},route:function(t,r,n){if(!i.isRegExp(t))t=this._routeToRegExp(t);if(i.isFunction(r)){n=r;r=""}if(!n)n=this[r];var s=this;e.history.route(t,function(i){var a=s._extractParameters(t,i);if(s.execute(n,a,r)!==false){s.trigger.apply(s,["route:"+r].concat(a));s.trigger("route",r,a);e.history.trigger("route",s,r,a)}});return this},execute:function(t,e,i){if(t)t.apply(this,e)},navigate:function(t,i){e.history.navigate(t,i);return this},_bindRoutes:function(){if(!this.routes)return;this.routes=i.result(this,"routes");var t,e=i.keys(this.routes);while((t=e.pop())!=null){this.route(t,this.routes[t])}},_routeToRegExp:function(t){t=t.replace(j,"\\$&").replace(A,"(?:$1)?").replace(C,function(t,e){return e?t:"([^/?]+)"}).replace(R,"([^?]*?)");return new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var r=t.exec(e).slice(1);return i.map(r,function(t,e){if(e===r.length-1)return t||null;return t?decodeURIComponent(t):null})}});var M=e.History=function(){this.handlers=[];this.checkUrl=i.bind(this.checkUrl,this);if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var N=/^[#\/]|\s+$/g;var O=/^\/+|\/+$/g;var U=/#.*$/;M.started=false;i.extend(M.prototype,l,{interval:50,atRoot:function(){var t=this.location.pathname.replace(/[^\/]$/,"$&/");return t===this.root&&!this.getSearch()},matchRoot:function(){var t=this.decodeFragment(this.location.pathname);var e=t.slice(0,this.root.length-1)+"/";return e===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return t.charAt(0)==="/"?t.slice(1):t},getFragment:function(t){if(t==null){if(this._usePushState||!this._wantsHashChange){t=this.getPath()}else{t=this.getHash()}}return t.replace(N,"")},start:function(t){if(M.started)throw new Error("Backbone.history has already been started");M.started=true;this.options=i.extend({root:"/"},this.options,t);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._hasHashChange="onhashchange"in window&&(document.documentMode===void 0||document.documentMode>7);this._useHashChange=this._wantsHashChange&&this._hasHashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.history&&this.history.pushState);this._usePushState=this._wantsPushState&&this._hasPushState;this.fragment=this.getFragment();this.root=("/"+this.root+"/").replace(O,"/");if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";this.location.replace(e+"#"+this.getPath());return true}else if(this._hasPushState&&this.atRoot()){this.navigate(this.getHash(),{replace:true})}}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe");this.iframe.src="javascript:0";this.iframe.style.display="none";this.iframe.tabIndex=-1;var r=document.body;var n=r.insertBefore(this.iframe,r.firstChild).contentWindow;n.document.open();n.document.close();n.location.hash="#"+this.fragment}var s=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState){s("popstate",this.checkUrl,false)}else if(this._useHashChange&&!this.iframe){s("hashchange",this.checkUrl,false)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}if(!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};if(this._usePushState){t("popstate",this.checkUrl,false)}else if(this._useHashChange&&!this.iframe){t("hashchange",this.checkUrl,false)}if(this.iframe){document.body.removeChild(this.iframe);this.iframe=null}if(this._checkUrlInterval)clearInterval(this._checkUrlInterval);M.started=false},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe){e=this.getHash(this.iframe.contentWindow)}if(e===this.fragment)return false;if(this.iframe)this.navigate(e);this.loadUrl()},loadUrl:function(t){if(!this.matchRoot())return false;t=this.fragment=this.getFragment(t);return i.some(this.handlers,function(e){if(e.route.test(t)){e.callback(t);return true}})},navigate:function(t,e){if(!M.started)return false;if(!e||e===true)e={trigger:!!e};t=this.getFragment(t||"");var i=this.root;if(t===""||t.charAt(0)==="?"){i=i.slice(0,-1)||"/"}var r=i+t;t=this.decodeFragment(t.replace(U,""));if(this.fragment===t)return;this.fragment=t;if(this._usePushState){this.history[e.replace?"replaceState":"pushState"]({},document.title,r)}else if(this._wantsHashChange){this._updateHash(this.location,t,e.replace);if(this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var n=this.iframe.contentWindow;if(!e.replace){n.document.open();n.document.close()}this._updateHash(n.location,t,e.replace)}}else{return this.location.assign(r)}if(e.trigger)return this.loadUrl(t)},_updateHash:function(t,e,i){if(i){var r=t.href.replace(/(javascript:|#).*$/,"");t.replace(r+"#"+e)}else{t.hash="#"+e}}});e.history=new M;var q=function(t,e){var r=this;var n;if(t&&i.has(t,"constructor")){n=t.constructor}else{n=function(){return r.apply(this,arguments)}}i.extend(n,r,e);var s=function(){this.constructor=n};s.prototype=r.prototype;n.prototype=new s;if(t)i.extend(n.prototype,t);n.__super__=r.prototype;return n};y.extend=x.extend=$.extend=I.extend=M.extend=q;var F=function(){throw new Error('A "url" property or function must be specified')};var z=function(t,e){var i=e.error;e.error=function(r){if(i)i.call(e.context,t,r,e);t.trigger("error",t,r,e)}};return e});
//# sourceMappingURL=backbone-min.map
tap = {};
tap.userLogin = "${adminLayout_userLogin}";
tap.userOwner = "${adminLayout_userOwnerName}";
window.localizedStrings = {};
$(document).ready(function () {
    $("#logout").click(function () {
        var landat = window.location.href.replace(window.location.origin, "");
        if (landat && landat.startsWith("/") && !landat.startsWith("//")) {
            sessionStorage.setItem("landat", landat);
        }
    });
});


(function($){

    TapAttributeEditor = function(options) {
        util.validateExists(options, ['strings', 'dataSelector', 'tableSelector']);

        var _strings = $.extend({}, options.strings);
        // Root node containing the serialized data
        var _dataContainer = $(options.dataSelector);
        // The table nodes
        var _table = $(options.tableSelector);
        var _tbody = _table.find('tbody');
        if (!_tbody) {
            _tbody = $('<tbody>');
            _table.append(_tbody);
        }
        // A mapping of attribute key to value
        var _attributes;

        var _onEditStart = options.onEditStart || function(){};
        var _onEditEnded = options.onEditEnded || function(){};

        // Deserialize attribute data from the data container,
        // which contains elements with id's of the pattern:
        //     attributesX.key and attributesX.value
        // where X is a zero-based index.
        var _deserialize = function() {
            _attributes = {};
            var attributeIndex = 0;
            var endOfData = false;
            var keyInput;
            var key;
            var valueInput;
            var value;

            while (!endOfData) {
                keyInput = _dataContainer.find('#attributes' + attributeIndex + '\\.key')[0];
                valueInput = _dataContainer.find('#attributes' + attributeIndex + '\\.value')[0];

                if (keyInput && valueInput) {
                    key = $.trim(keyInput.value);
                    value = $.trim(valueInput.value);
                    _attributes[key] = {'key': key, 'value': value};
                } else if (keyInput || valueInput) {
                    throw new Error('Missing key or value for index ' + attributeIndex);
                } else {
                    endOfData = true;
                }
                attributeIndex++;
            }
            console.log('deserialized attributes: ', _attributes);
        };

        // Replaces any nodes with id starting with attributes
        // with hidden inputs named in the format needed by
        // the Spring MVC WebDataBinder to build a attribute
        // collection in Java.
        var _serialize = function() {
            _dataContainer.find('[id^=attributes]').remove();
            var index = 0;

            $.each(_attributes, function(key, attribute) {
                var keyInput = $('<input>', {
                    'type': 'hidden',
                    'id': 'attributes' + index + '.key',
                    'name': 'attributes[' + index + '].key',
                    'value': attribute.key
                });
                var valueInput = $('<input>', {
                    'type': 'hidden',
                    'id': 'attributes' + index + '.value',
                    'name': 'attributes[' + index + '].value',
                    'value': attribute.value
                });
                _dataContainer.append(keyInput, valueInput);
                index++;
            });
        };

        var _createEditActions = function(rowContext) {
            var editAction = $('<a>', {'class': 'initiateAttrAction btn btn-small'});
            editAction.text(_strings.edit);
            editAction.click({context: rowContext}, _startEdit);

            var deleteAction = $('<a>', {'class': 'initiateAttrAction btn btn-small'});
            deleteAction.html('<i class="icon-trash"></i> ');
            deleteAction.click({context: rowContext}, _deleteRow);

            return [editAction, ' ', deleteAction];
        };

        var _saveEdit = function(evt) {
            var rowContext = evt.data.context;
            var keyCell = rowContext.key;
            var valueCell = rowContext.value;
            var actionsCell = rowContext.actions;
            var attribute = rowContext.attribute;

            // Validate names are not  duplicated.
            // It's only valid to exist in the map if it's
            // the row being edited.
            var keyInput = $(keyCell).find('input');
            var key = $.trim(keyInput.val());
            var errors = "";
            if (_attributes[key] && (attribute.key !== key)) {
                keyInput.focus();
                keyInput.select();
                errors += ' ' + _strings.unique_attribute_name;
            }else if (!key){
                keyInput.focus();
                keyInput.select();
                errors += ' ' +  _strings.empty_attribute_key;
            }else if(! key.match(/^[\w|\-]+$/)){
                keyInput.focus();
                keyInput.select();
                errors += ' ' +  _strings.invalid_attribute_key;
            }

            var valueInput = $(valueCell).find('input');
            var value = $.trim(valueInput.val());
            if(!value){
                valueInput.focus();
                valueInput.select();
                errors += ' ' +  _strings.empty_attribute_value;
            }
            if(errors){
                $("#attributeInlineError").text(errors);
                return;
            }
            if (attribute.key) {
                if(attribute.key !== key){
                    _attributes[attribute.key] = {key: key, value: value};
                    _attributes[key] = _attributes[attribute.key];
                    delete _attributes[attribute.key];

                }else{
                    _attributes[key] = {key: key, value: value};
                }
            }else{
                _attributes[key] = {key: key, value: value};
            }
            render();
            _onEditEnded();
        };

        var _cancelEdit = function(evt) {
            _onEditEnded();
            render();
        };

        var _deleteRow = function(evt) {
            var rowContext = evt.data.context;
            var attribute = rowContext.attribute;
            delete _attributes[attribute.key];
            console.log('Attributes after delete ', _attributes);
            render();
        };

        var _startEdit = function(evt) {
            // Prevent other rows from being edited
            _tbody.find('a.initiateAttrAction').hide();

            var rowContext = evt.data.context;
            var key = rowContext.key;
            var value = rowContext.value;
            var actions = rowContext.actions;
            var attribute = rowContext.attribute;
            var keyText = attribute.key;
            var valueText = attribute.value;

            key.empty();
            value.empty();
            actions.empty();

            var keyInput = $('<input>', {'type': 'text'});
            keyInput.val(keyText);
            key.append(keyInput);
            var valueInput = $('<input>', {'type': 'text'});
            valueInput.val(valueText);
            value.append(valueInput);

            var saveAction = $('<a>', {'class': 'btn btn-small'});
            saveAction.text(_strings.done);
            saveAction.click({context: rowContext}, _saveEdit);

            var cancelAction = $('<a>', {'class': 'btn btn-small'});
            cancelAction.text(_strings.cancel);
            cancelAction.click({context: rowContext}, _cancelEdit);

            var inlineError = $('<span>', {'id': 'attributeInlineError','class': 'inlineError'});

            actions.append(saveAction, ' ', cancelAction, ' ', inlineError);
            keyInput.focus();
            keyInput.select();
            _onEditStart();
        };

        var _startCreate = function(evt) {
            // Prevent other rows from being edited
            _tbody.find('a.initiateAttrAction').hide();

            var row = $('<tr>');
            var keyCell = $('<td>');
            var keyInput = $('<input>', {'type': 'text'});
            keyCell.append(keyInput);
            row.append(keyCell);

            var valueCell = $('<td>');
            var valueInput = $('<input>', {'type': 'text'});
            valueCell.append(valueInput);
            row.append(valueCell);

            var actionsCell = $('<td>');

            var rowContext  = {
                key: keyCell,
                value: valueCell,
                actions: actionsCell,
                attribute: {}
            };

            var saveAction = $('<a>', {'class': 'btn btn-small'});
            saveAction.text(_strings.done);
            saveAction.click({context: rowContext}, _saveEdit);

            var cancelAction = $('<a>', {'class': 'btn btn-small'});
            cancelAction.text(_strings.cancel);
            cancelAction.click({context: rowContext}, _cancelEdit);

            var inlineError = $('<span>', {'id': 'attributeInlineError','class': 'inlineError'});
            actionsCell.append(saveAction, ' ', cancelAction, ' ', inlineError);

            row.append(actionsCell);
            _tbody.find('tr:last').remove();
            _tbody.append(row);
            keyInput.focus();
            _onEditStart();
        };

        var render = function() {
            var rows = _tbody.find('tr');
            rows.remove();

            $.each(_attributes, function(attributeName, attribute) {
                var row = $('<tr>');
                var keyCell = $('<td>');
                var valueCell = $('<td>');
                keyCell.text(attribute.key);
                valueCell.text(attribute.value);
                if (attribute.value.length === 0) {
                    row.addClass("alert").addClass("alert-error").css("background-image", "none");
                }
                row.append(keyCell);
                row.append(valueCell);

                var actionsCell = $('<td>', {'class': 'actionCell'});
                var rowContext = {
                    key: keyCell,
                    value: valueCell,
                    actions: actionsCell,
                    attribute: attribute
                };
                _.each(_createEditActions(rowContext), function(action) {
                    actionsCell.append(action);
                });
                row.append(actionsCell);
                if (attribute.value.length === 0) {
                    row.append($('<div>').text(_strings.emptyAttributeWarning));
                }
                _tbody.append(row);
            });

            var addAction = $('<a>', {'class': 'initiateAttrAction btn btn-small'});
            addAction.html('<i class="icon-plus"></i> ');
            addAction.append(document.createTextNode(_strings.add));
            addAction.click(_startCreate);
            var addRow = $('<tr>');
            var spacer = $('<td>', {'colspan': '2'});
            var addCell = $('<td>');
            addCell.append(addAction);
            addRow.append(spacer, addCell);
            _tbody.append(addRow);
        };

        // Public API
        this.render = render;

        // Saves the current committed table state to the DOM.
        this.save = function() {
            _cancelEdit({});
            render();
            _serialize();
        };

        // Resets the editor state to reflect the DOM.
        this.reset = function() {
            _deserialize();
            render();
        };
    };

})(jQuery);

(function($){
    adminPageAuditRecords = {
        init: function(args) {
            util.validateExists(args, ["entityType", "entityId"]);
            var entityType = args.entityType;
            var entityId = args.entityId;
            var dataDiv = $("#auditDataDiv");
            var errorDiv = $("#auditErrorDiv");
            var loadAuditButton = $('#loadAuditButton');
            var refreshAuditButton = $('#refreshAuditButton');
            var spinner = $('#loadingSpinner');
            var refreshDataDiv = function(evt) {
                errorDiv.hide();
                dataDiv.empty();
                loadAuditButton.hide();
                refreshAuditButton.show();
                spinner.show();
                $.ajax({
                    type: "GET",
                    url: document.requestPathPrefix + "/get-change-audit",
                    data: {
                        entityType: entityType,
                        entityId: entityId
                    },
                    success: function(data) {
                        dataDiv.html(data);
                    },
                    error: function() {
                        errorDiv.show();
                    },
                    complete: function() {
                        spinner.hide();
                    }
                });
            };
            loadAuditButton.click(refreshDataDiv);
            refreshAuditButton.click(refreshDataDiv);
        }
    };
})(jQuery);
tapConstants = {
    URL_BASE: document.requestPathPrefix
};

(function($){
    dataTablesEntitySearch = {
            /**
             * Initializes a table to enable pagination using DataTables
             * @param table The table to be initialized.
             * @param strings Localized strings
             * @param ajaxSource URL of the AJAX controller that will provide data to DataTables
             * @param fnParser Callback function that returns JSON-stringified filter options
             * @param fnPageSize Callback function that returns current selected page size
             */
            init: function(options) {
                var table = options.table;
                var strings = options.strings;
                var ajaxSource = options.ajaxSource;
                var fnParser = options.fnParser;
                var fnPageSize = options.fnPageSize;
                var errorDiv = options.errorDiv;
                var data, pageSize;
                var refreshMs = 500; // half second refresh
                var currentlyRetrying = false;
                function fnError() {
                    if (currentlyRetrying) {
                        return;
                    }
                    if (errorDiv !== undefined) {
                        errorDiv.show();
                    }
                    currentlyRetrying = true;
                    _.delay(function() {
                        if (errorDiv !== undefined) {
                            errorDiv.hide();
                        }
                        currentlyRetrying = false;
                        table.fnDraw(table.fnSettings());
                    }, 2000);
                }
                // Set up Previous / Next buttons to have Bootstrap classes
                $.fn.dataTableExt.oStdClasses.sPageNextDisabled = "btn disabled dataTablesNext";
                $.fn.dataTableExt.oStdClasses.sPagePrevDisabled = "btn disabled dataTablesPrev";
                $.fn.dataTableExt.oStdClasses.sPageNextEnabled = "btn dataTablesNext";
                $.fn.dataTableExt.oStdClasses.sPagePrevEnabled = "btn dataTablesPrev";
                table.dataTable({
                    "bProcessing": "true",
                    "bServerSide": "true",
                    "bSort": false,
                    "bLengthChange": false,
                    "iDeferLoading": true,
                    "sAjaxSource": ajaxSource,
                    "oLanguage": {
                        "sInfo": strings.sInfo,
                        "sInfoEmpty": strings.sInfoEmpty,
                        "oPaginate": {
                            "sPrevious": strings.sPrevious,
                            "sNext": strings.sNext
                        },
                        "sInfoFiltered": strings.sInfoFiltered,
                        "sSearch": strings.sSearch,
                        "sZeroRecords": strings.sZeroRecords,
                        "sLengthMenu": strings.sLengthMenu
                    },
                    // Top to bottom: Pagination, Table, Information, pRocessing blurb
                    "sDom": 'ptir',
                    "fnServerData": function ( sSource, aoData, fnCallback, oSettings ) {
                        oSettings.jqXHR = $.ajax( {
                          "dataType": 'json',
                          "type": "GET",
                          "url": sSource,
                          "data": aoData,
                          "success": function(data) {
                              table.show();
                              $('.dataTables_info').show();
                              fnCallback(data);
                          },
                          "error": fnError
                        } );
                    },
                    "fnDrawCallback": function() {
                        window.dataTableRefreshed();
                    }
                });
                table.hide();
                $('.dataTables_info').hide();
                // We are using multiple search boxes, hide the default search box
                $('.dataTables_filter').hide();
                // Check filter boxes, update table if needed
                function checkFields() {
                    // If no parser function was passed in, don't try calling it repeatedly
                    if (fnParser === undefined) {
                        return;
                    }
                    try {
                        var newData = fnParser();
                        if (data !== newData) {
                            data = newData;
                            var oFeatures = table.fnSettings();
                            table.fnFilter(data);
                        }
                    } catch (error) {
                        console.log(error);
                    }
                    _.delay(checkFields, refreshMs);
                }
                function checkPageSize() {
                    // If no page size function was passed in, don't try calling it repeatedly
                    if (fnPageSize === undefined) {
                        return;
                    }
                    var newPageSize = fnPageSize();
                    if (newPageSize !== pageSize) {
                        pageSize = newPageSize;
                        table.fnSettings()._iDisplayLength = pageSize;
                        table.fnDraw(table.fnSettings());
                    }
                    _.delay(checkPageSize, refreshMs);
                }
                checkFields();
                checkPageSize();
            }
    };

    window.dataTableRefreshed = function() {
    };
})(jQuery);
// Thanks to http://stackoverflow.com/questions/1219860
// A method to escape a string in HTML style
window.escapeHtml = function(string) {
    return string
        .replace(/&/g, "&amp;")
        .replace(/'/g, "&apos;")
        .replace(/"/g, "&quot;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;");
};

window.safeParser = function(jsonString) {
    try {
        return JSON.parse(jsonString);
    } catch (e) {
        return jsonString;
    }
};
/**
  * https://gist.github.com/cjcliffe/1185173
  */

window.enums = window.enums || {};
window.enums.keyboard = {
      BACKSPACE: 8,
      TAB: 9,
      ENTER: 13,
      SHIFT: 16,
      CTRL: 17,
      ALT: 18,
      PAUSE: 19,
      CAPS_LOCK: 20,
      ESCAPE: 27,
      SPACE: 32,
      PAGE_UP: 33,
      PAGE_DOWN: 34,
      END: 35,
      HOME: 36,
      LEFT_ARROW: 37,
      UP_ARROW: 38,
      RIGHT_ARROW: 39,
      DOWN_ARROW: 40,
      INSERT: 45,
      DELETE: 46,
      KEY_0: 48,
      KEY_1: 49,
      KEY_2: 50,
      KEY_3: 51,
      KEY_4: 52,
      KEY_5: 53,
      KEY_6: 54,
      KEY_7: 55,
      KEY_8: 56,
      KEY_9: 57,
      KEY_A: 65,
      KEY_B: 66,
      KEY_C: 67,
      KEY_D: 68,
      KEY_E: 69,
      KEY_F: 70,
      KEY_G: 71,
      KEY_H: 72,
      KEY_I: 73,
      KEY_J: 74,
      KEY_K: 75,
      KEY_L: 76,
      KEY_M: 77,
      KEY_N: 78,
      KEY_O: 79,
      KEY_P: 80,
      KEY_Q: 81,
      KEY_R: 82,
      KEY_S: 83,
      KEY_T: 84,
      KEY_U: 85,
      KEY_V: 86,
      KEY_W: 87,
      KEY_X: 88,
      KEY_Y: 89,
      KEY_Z: 90,
      LEFT_META: 91,
      RIGHT_META: 92,
      SELECT: 93,
      NUMPAD_0: 96,
      NUMPAD_1: 97,
      NUMPAD_2: 98,
      NUMPAD_3: 99,
      NUMPAD_4: 100,
      NUMPAD_5: 101,
      NUMPAD_6: 102,
      NUMPAD_7: 103,
      NUMPAD_8: 104,
      NUMPAD_9: 105,
      MULTIPLY: 106,
      ADD: 107,
      SUBTRACT: 109,
      DECIMAL: 110,
      DIVIDE: 111,
      F1: 112,
      F2: 113,
      F3: 114,
      F4: 115,
      F5: 116,
      F6: 117,
      F7: 118,
      F8: 119,
      F9: 120,
      F10: 121,
      F11: 122,
      F12: 123,
      NUM_LOCK: 144,
      SCROLL_LOCK: 145,
      SEMICOLON: 186,
      EQUALS: 187,
      COMMA: 188,
      DASH: 189,
      PERIOD: 190,
      FORWARD_SLASH: 191,
      GRAVE_ACCENT: 192,
      OPEN_BRACKET: 219,
      BACK_SLASH: 220,
      CLOSE_BRACKET: 221,
      SINGLE_QUOTE: 222
    };
/*
Selectors for various entity types.
Built on top of select2.
*/

(function($){
    var BASE_SEARCH_URL = '/selector-search';

    // Note that until we can update Select2, this will double escape ampersands
    function escapeData(data) {
        data.results.forEach(function(item, index) {
            item.id = window.escapeHtml(item.id);
            item.text = window.escapeHtml(item.text);
        });
    }

    function initSelection(element, callback, urlSuffix){
        if($(element).val() === ""){
            if($(element).attr('multiple')){
                $(element).parent().find('.select2-search-choice').remove();
            }
            return;
        }

        $.ajax(document.requestPathPrefix + BASE_SEARCH_URL + urlSuffix, {
            dataType: 'json',
            data: {
                name: "",
                page: 0,
                ids:  $(element).val()
            }
        }).done(function(data) {
            var selectData;
            if ($(element).attr('multiple')) {
                selectData = data.results;
            } else if($(element).data('init-text')){
                var text = $(element).data('init-text');
                data.results.forEach(function(option){
                    if(option.text === text){
                        selectData = option;
                    }
                });
            } else {
                selectData = data.results.length > 0 ? data.results[0] : null;
            }
            callback(selectData);
        });
    }

    function initSelectionForCTI(element, callback, urlSuffix, ticketCategory, ticketType){
        if($(element).val() === ""){
            return;
        }

        $.ajax(document.requestPathPrefix + BASE_SEARCH_URL + urlSuffix, {
            dataType: 'json',
            data: {
                name: "",
                page: 0,
                ids:  $(element).val(),
                category:  ticketCategory,
                type:  ticketType
            }
        }).done(function(data) {
            var selectData = data.results.length > 0 ? data.results[0] : null;
            callback(selectData);
        });
    }

    function select2Options(urlSuffix, options) {
        options = $.extend({
            minimumInputLength: 0,
            closeOnSelect: true
        }, options);

        return {
            minimumInputLength: options.minimumInputLength,
            initSelection: options.initSelection ? options.initSelection : function(element, callback){
                initSelection(element, callback, urlSuffix);
            },
            allowClear: options.allowClear,
            placeholder: options.placeholder,
            multiple: options.multiple,
            closeOnSelect: options.closeOnSelect,
            ajax: $.extend({
                url: document.requestPathPrefix + BASE_SEARCH_URL + urlSuffix,
                dataType: 'json',
                quietMillis: 300,
                data: function(term, page) {
                    return $.extend({name: term, page: page - 1}, options.ajaxData);
                },
                results: function(data, page) {
                    escapeData(data);
                    return data;
                }
            }, options.ajax)
        };
    }

    $.fn.extend({

        callCenterSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'Global'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/callCenters', options));
            });
        },

        cdrMetricNameSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'CTR Metric Name'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/cdr-metric-names', options));
            });
        },
        /*
         * Select call flows. Names are returned instead of call flow IDs
         */
        callFlowNameSelect: function(options) {
            options = $.extend({
                allowClear: true,
                minimumInputLength: 0, // Loads first page without any input
                placeholder: 'Select a call flow'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/callFlowNames', options));
            });
        },

        callflowTemplateSelect: function(options) {
              options = $.extend({
                  allowClear: true,
                  placeholder: 'Select a template'
              }, options);

              return this.each(function(){
                  $(this).select2(select2Options('/callflowTemplates', options));
              });
         },

        c2CallTemplateSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'Select a template'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/c2c-templates/Voice', options));
            });
        },

        c2ChatTemplateSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'Select a template'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/c2c-templates/Chat', options));
            });
        },

        c2EmailTemplateSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'Select a template'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/c2c-templates/Email', options));
            });
        },

        c2WorkItemTemplateSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'Select a template'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/c2c-templates/WorkItem', options));
            });
        },

        emailDomainSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder : 'Select Domain'
            }, options);

            return this.each(function() {
                $(this).select2(select2Options('/email-queue-domains', options));
            });
        },

        emailQueueDepartmentsSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder : 'Select Department'
            }, options);

            return this.each(function() {
                $(this).select2(select2Options('/email-queue-departments', options));
            });
        },

        ctiCategorySelect: function(options) {
            if (options.ajaxData) {
                var ticketCategory = options.ajaxData.category ? options.ajaxData.category : "";
                var ticketType = options.ajaxData.type ? options.ajaxData.type : "";
            }
            options = $.extend({
                allowClear: true,
                placeholder : 'Select Category',
                initSelection : function(element, callback) {
                    initSelectionForCTI(element, callback, '/cti-category-search', ticketCategory, ticketType);
                    }
            }, options);

            return this.each(function() {
                $(this).select2(select2Options('/cti-category-search', options));
            });
          },

        ctiTypeSelect: function(options) {
            if (options.ajaxData) {
                var ticketCategory = options.ajaxData.category ? options.ajaxData.category : "";
                var ticketType = options.ajaxData.type ? options.ajaxData.type : "";
            }
            options = $.extend({
                  allowClear: true,
                  placeholder : 'Select Type',
                  initSelection : function(element, callback) {
                      initSelectionForCTI(element, callback, '/cti-type-search', ticketCategory, ticketType);
                      }
            }, options);

            return this.each(function() {
                $(this).select2(select2Options('/cti-type-search', options));
            });
        },

        ctiItemSelect: function(options) {
            if (options.ajaxData) {
                var ticketCategory = options.ajaxData.category ? options.ajaxData.category : "";
                var ticketType = options.ajaxData.type ? options.ajaxData.type : "";
            }
            options = $.extend({
                allowClear: true,
                placeholder : 'Select Item',
                initSelection : function(element, callback) {
                    initSelectionForCTI(element, callback, '/cti-item-search', ticketCategory, ticketType);
                    }
            }, options);

                return this.each(function() {
                $(this).select2(select2Options('/cti-item-search', options));
            });
        },

        marketplaceSelect : function(options) {
            options = $.extend({
                allowClear: true,
                placeholder : 'Select Marketplace'
            }, options);

            return this.each(function() {
                $(this).select2(select2Options('/marketplaces', options));
            });
        },
        marketplaceNameSelect : function(options) {
            options = $.extend({
                allowClear: false,
                placeholder : 'Select Marketplace'
            }, options);

            return this.each(function() {
                $(this).select2(select2Options('/marketplaceName', options));
            });
        },
        workCategorySelect : function(options) {
            options = $.extend({
                allowClear: false,
                placeholder : 'Select Work Category'
            }, options);

            return this.each(function() {
                $(this).select2(select2Options('/workCategoryName', options));
            });
        },

        entryPointSelect: function(options){
            options = $.extend({
                allowClear: true,
                placeholder: 'Entry Point'
            }, options);
            if(options.byAddress){
                options.data =  function(term, page){
                    return {
                        address: term,
                        byAddress: true,
                        page: page - 1
                    };
                };
                options.initSelection = function(element, callback){
                    $.ajax(document.requestPathPrefix + BASE_SEARCH_URL + '/entry-points', {
                        dataType: 'json',
                        data: $.extend({
                            address: $(element).val(),
                            page: 0
                        }, options.ajax ? options.ajax.data() : {})
                    }).done(function(data) {
                        callback(data.results[0]);
                    });
                };
            }

            return this.each(function(){
                $(this).select2(select2Options('/entry-points', options));
            });
        },

        entryPointAddressSelect: function(options) {
            options = $.extend({
                allowClear: false,
                placeholder: 'Search for a number'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/entryPointsByAddress', options));
            });
        },

        entityTypeSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'Any Entity'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/entity-types-selector', options));
            });
        },

        messageSelect: function(options) {
            options = $.extend({
                allowClear: false,
                placeholder: "Search for a Message"
            }, options);

            return this.each(function() {
                $(this).select2(select2Options('/messages', options));
            });
        },

        ownerSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: tap.ownerPref
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/owners', options));
            });
        },

        profileSelect: function(options) {
            options = $.extend({
                allowClear: false,
                placeholder: 'Search for a Profile'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/profiles', options));
            });
        },

        promptSelect: function(options) {
            options = $.extend({
                allowClear: false,
                placeholder: 'Search for a Prompt'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/prompts', options));
            });
        },

        skillSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'Search for a Skill'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/skills', options));
            });
        },

        sipDomainSelect: function(options) {
            options = $.extend({
                allowClear: false,
                placeholder: 'Search for SIP domains'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/sip-domains', options));
            });
        },

        subMediaTypeSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'Search for a SubMediaType'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/subMediaTypes', options));
            });
        },

        teamSelect: function(options){
            options = $.extend({
                allowClear: true,
                placeholder: 'Search for a Team'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/teams', options));
            });
        },

        timezoneSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'Select a Timezone'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/timezones', options));
            });
        },

        hoopSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'Select Hours of Operation'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/hoops', options));
            });
        }
    });

})(jQuery);

/*
Selectors for various entity types.
Built on top of select2.
*/

(function($){

    var BASE_SEARCH_URL = '/metrics-selector-search';

    function initSelection(element, callback, urlSuffix){
        if($(element).val() === ""){
            if($(element).attr('multiple')){
                $(element).parent().find('.select2-search-choice').remove();
            }
            return;
        }

        $.ajax(document.requestPathPrefix + BASE_SEARCH_URL + urlSuffix, {
            dataType: 'json',
            data: {
                name: "",
                page: 0,
                ids:  $(element).val()
            }
        }).done(function(data) {
            var selectData;
            if ($(element).attr('multiple')) {
                selectData = data.results;
            } else if($(element).data('init-text')){
                var text = $(element).data('init-text');
                data.results.forEach(function(option){
                    if(option.text === text){
                        selectData = option;
                    }
                });
            } else {
                selectData = data.results.length > 0 ? data.results[0] : null;
            }
            callback(selectData);
        });
    }

    function select2Options(urlSuffix, options) {
        options = $.extend({
            closeOnSelect: true,
            minimumInputLength: 0
        }, options);

        return {
            minimumInputLength: options.minimumInputLength,
            initSelection: options.initSelection ? options.initSelection : function(element, callback){
                initSelection(element, callback, urlSuffix);
            },
            allowClear: options.allowClear,
            placeholder: options.placeholder,
            multiple: options.multiple,
            closeOnSelect: options.closeOnSelect,
            ajax: $.extend({
                url: document.requestPathPrefix + BASE_SEARCH_URL + urlSuffix,
                dataType: 'json',
                quietMillis: 300,
                data: function(term, page) {
                    return $.extend({name: term, page: page - 1}, options.ajaxData);
                },
                results: function(data, page) {
                    return data;
                }
            }, options.ajax)
        };
    }

    $.fn.extend({

        metricsOwnerSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'Search for an Owner'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/owners', options));
            });
        },

        metricsCallCenterSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'Search for a Call Center'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/callCenters', options));
            });
        },

        metricsSkillSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'Search for a Skill'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/skills', options));
            });
        },

        metricsProfileSelect: function(options) {
            options = $.extend({
                allowClear: false,
                placeholder: 'Search for a Profile'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/profiles', options));
            });
        },

        metricsEntryPointSelect: function(options) {
            options = $.extend({
                allowClear: false,
                placeholder: 'Search for an Entry Point'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/entryPoints', options));
            });
        },

        metricsTeamSelect: function(options){
            options = $.extend({
                allowClear: true,
                placeholder: 'Search for a Team'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/teams', options));
            });
        },

        metricsTimezoneSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'Select a Timezone'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/timezones', options));
            });
        },

        cdrMetricNameSelect: function(options) {
            options = $.extend({
                allowClear: true,
                placeholder: 'CTR Metric Name'
            }, options);

            return this.each(function(){
                $(this).select2(select2Options('/cdr-metric-names', options));
            });
        }

    });

})(jQuery);

(function($){
    tapSituationalMessageAdmin = {
        initSituationalMessagePage: function(args) {
            var token = args.token;

            $('.selectAllCheck').change(function(){
                var columnIndex = $(this).closest('td').index();
                if(this.checked){
                    $('tbody tr').each(function(i){
                        var checkboxes = $(this).children('td').eq(columnIndex).children('input:checkbox');
                        if (!checkboxes.attr('checked')) {
                            checkboxes.click();
                        }
                    });
                }
            });

            $('.columnCheck').change(function(){
                var columnIndex = $(this).closest('td').index();
                if(this.checked){
                    $('tbody tr').each(function(){
                        var checkboxes = $(this).children('td').eq(columnIndex).children('input:checkbox');
                        if (!checkboxes.attr('checked')) {
                            checkboxes.click();
                        }
                    });
                } else {
                    $('tbody tr').each(function(){
                        var checkboxes = $(this).children('td').eq(columnIndex).children('input:checkbox');
                        if (checkboxes.attr('checked')) {
                            checkboxes.click();
                        }
                    });
                }
            });

            $('.rowCheck').change(function(){
                if(this.checked) {
                    $(this).parent().siblings().children('input:checkbox').each(function() {
                        if ($(this).attr('checked')) {
                            $(this).click();
                        }
                    });
                }
                if ($(this).find('input[type=checkbox]:checked').length === 0) {
                    $(this).attr('checked', true);
                }
            });

            $('.individualCheck').change(function(){
                var columnIndex = $(this).closest('td').index();
                var parentSiblings = $(this).parent().siblings();
                if (this.checked) {
                    parentSiblings.children('.rowCheck').attr('checked', false);
                    $('table tr').children('td').children('.selectAllCheck').attr('checked', false);
                } else {
                    $('table tr').children('td').eq(columnIndex).children('.columnCheck').attr('checked', false);
                    if (parentSiblings.find('input[type=checkbox]:checked').length === 0) {
                        parentSiblings.children('.rowCheck').attr('checked', true);
                    }
                }
            });

            $('table tr').each(function(i) {
                if (i > 1) {
                    if ($(this).find('input[type=checkbox]:checked').length === 0) {
                        $(this).children('td').children('.rowCheck').attr('checked', true);
                    }
                }
            });

            $('.submitButton').click(function() {
                var results = [];
                $('.situational-message-row').each(function(index, container) {
                    results.push($(container).children().find('.individualCheck').map(function(innerIndex, innerContainer) {
                        var jqContainer = $(innerContainer);
                        if (jqContainer.prop('checked')) {
                            return innerContainer.id;
                        }
                    }).get());
                });
                var entityIds = $(".entityIdHolder").map(function(index,container) {
                    return $(container).val();
                }).get();
                $("#successDiv").hide();
                $("#errorDiv").hide();

                $.ajax({
                    url: args.baseUrl + "/" + entityIds.join(",") + "/emergency",
                    type: "POST",
                    data: {
                        selectedMessagesJson: JSON.stringify(results),
                        token: token
                    },
                    success: function(response) {
                        $("#successDiv").show();
                    },
                    statusCode: {
                        500: function() {
                            $("#errorDiv").show();
                        }
                    },
                    error: function(response) {
                        $("#errorDiv").show();
                    }
                });
            });

        },
        initViewPageWidget: function(args) {
            var emCheck = '.emergencyCheckbox';
            var nonEmCheck = '.noEmergencyCheckbox';
            // Uncheck 'No problems' if a problem is checked
            $(emCheck).click(function() {
                if ($(this).is(':checked')) {
                    $(nonEmCheck).prop('checked', false);
                } else if ($(emCheck + ":checked").length === 0){
                    // Check 'No problems' if the last problem was unchecked
                    $(nonEmCheck).prop('checked', true);
                }
            });
            // Uncheck all problems if the 'no problems' is checked
            $(nonEmCheck).click(function() {
                if ($(this).is(':checked')) {
                    $(emCheck).prop('checked', false);
                } else if (!$(emCheck).prop('checked')){
                    // Don't allow uncheck of 'No problems' box - only allow implicit unchecking via checking problems
                    $(nonEmCheck).prop('checked', true);
                }
            });
            if ($(emCheck + ":checked").length === 0) {
                $(nonEmCheck).prop('checked', true);
            }
            $('#updateStatusButton').click(function(evt) {
                var checkedEmergencies = [];
                $(emCheck + ':checked').each(function(index, value) {
                    checkedEmergencies.push(value.id);
                });
                $.ajax({
                    url: args.postUrl,
                    type: "POST",
                    data: {
                        situations: checkedEmergencies,
                        token: args.token
                    },
                    success: function(evt) {
                        location.reload();
                    },
                    error: function(evt) {
                        showStatusError();
                    }
                });
            });
            var showStatusError = function() {
                $('#statusError').show();
                _.delay(function() {
                    $('#statusError').fadeOut();
                }, 5000);
            };
        }
    };
})(jQuery);
// This sets up basic elements of the page not associated with specific tabs


(function($){

    var OWNER_ID_COOKIE = 'cs-taw-admin-owner-id';

    var $ownerSelect, $ownerName;

    // Setup the owner selector when page loads
    $(document).ready(selectorInit);

    function selectorInit() {
        $ownerSelect = $('#cs-tap-admin-owner-select');
        $ownerName = $('#cs-tap-admin-user-owner-name');

        if (tap.ownerList != null && tap.ownerList.length > 1) {
            $ownerName.click(onOwnerNameClicked);
            $ownerSelect.change(onSelectChanged);
        }
    }

    // Show selector
    function onOwnerNameClicked() {
        $ownerName.hide();
        $ownerSelect.show().focus();
        $ownerSelect.select2({query: getOwners});
    }

    // Save choice as cookie and reload page
    function onSelectChanged() {
        var userName = $('#cs-tap-user-name').text();
        document.cookie = OWNER_ID_COOKIE + "=" + $(this).val() + ":" + userName + ";path=/call-center-manager/";
        document.cookie = OWNER_ID_COOKIE + "=" + $(this).val() + ":" + userName + ";path=/taw/";
        window.location.reload();
    }

    function getOwners(query){
        var data = {results: []};
        for (var i = 0 ; i < tap.ownerList.length ; ++i) {
            var owner = tap.ownerList[i];
            if (!query.term || owner.name.toLowerCase().indexOf(query.term.toLowerCase()) !== -1) {
                data.results.push({id: owner.id, text: owner.name});
            }
        }
        query.callback(data);
    }

})(jQuery);

(function($){

    TICKET_DATA_URL = document.requestPathPrefix + "/tickets";

    $.fn.extend({
        tickets: function(params, strings){
            var self = this;
            strings = $.extend({
                working: "We are currently working on these high severity issues."
            }, strings);
            $.ajax({
                url: TICKET_DATA_URL,
                data: params,
                type: "GET",
                dataType: "json",
                success: function(tickets){
                    if(tickets.length === 0){
                        self.hide();
                    }
                    var div = $('<div>').append($('<h3>').append(strings.working));
                    $(self).empty();
                    $.each(tickets, function(i){
                        div.append(
                            $('<div>').addClass('alert alert-danger').append(
                                $('<a>', { href: "https://tt.amazon.com/" + this.id }).append(
                                    this.description
                                )
                            )
                        );
                    });
                    self.append(div);
                }
            });
        }
    });
})(jQuery);

(function(){

    util = {

        // Return the name of the missing attribute in allAttributes, if any.
        // All attributes names described in requiredKeys must be present.
        findMissingAttributeName: function(allAttributes, requiredKeys) {
            var len = requiredKeys.length;
            var i;
            for(i=0; i<len; i++) {
                var key = requiredKeys[i];
                if (! (key in allAttributes) || allAttributes[key] === null) {
                    return key;
                }
            }
            return null;
        },

        validateExists: function(object, keys) {
            var missingAttr = util.findMissingAttributeName(object, keys);
            if (missingAttr) {
                throw new Error("Missing required attribute: " + missingAttr);
            }
        },

        // Animated scroll to a given element
        scrollTo: function(elem, animationMs, minus) {
            var offset = $(elem).offset();
            if (!offset) { return; }
            var top = offset.top;
            if (!top) { return; }

            // Subtract 'minus' to give a little breathing room up top
            var scrollTo = Math.max( top - minus, 0 );

            $('html, body').animate({ scrollTop: scrollTo }, animationMs || 0);
        },

        hideMessages: function() {
            $('div.messages > .alert').hide();
        },

        // Create a <td> element with the given text
        newTextCell: function(text) {
            var cell = $("<td>");
            cell.text(text);
            return cell;
        },

        // Create a <tr> element with the given text
        newTextHeaderCell: function(text) {
            var cell = $("<th>");
            cell.text(text);
            return cell;
        },

        // Update the rows of a table in such a way
        // that does not jerk around the scrolling on the page.
        resetTableBody: function(table, newTBody) {
            if (!newTBody) {
                newTBody = document.createElement('tbody');
            }
            var newTBodyFragment = document.createDocumentFragment();
            newTBodyFragment.appendChild(newTBody);
            var oldTbody = table.tBodies[0];
            if (oldTbody) {
                table.replaceChild(newTBodyFragment, oldTbody);
            }
            else {
                table.appendChild(newTBodyFragment);
            }
        },

        // Enhancement to _.once: added context param
        once: function(context, func) {
            return _.once(function() {
                func.apply(context, arguments);
            });
        },

        // validate the current field is not null
        validateNotNull: function(id, errorMessage){
            var value = $("#" + id).val();
            if(value === ''){
                this.errorMsg(id, errorMessage);
                return false;
            }else{
                $("#" + id + "InlineError").remove();
                return true;
            }
        },

        //validate the current field using regulation expression provided
        validateField: function(id, regex, errorMessage){
            var value = $("#" + id).val();
            if(! value.match(regex)){
                this.errorMsg(id, errorMessage);
                return false;
            }else{
                $("#" + id + "InlineError").remove();
                return true;
            }
        },

        //generate error message
        errorMsg: function (id, errorMessage){
            var errorFieldId = id + "InlineError";
            $("#" + id).focus();
            if($("#" + errorFieldId).length === 0){
                var errorSpan = $('<span>', {'id' : errorFieldId, 'class' : 'inlineError'});
                errorSpan.text(errorMessage);
                $("#" + id).after(errorSpan);
            }
        },

        removeSpan: function(spanId) {
            $('#' + spanId).remove();
        },

        isFunction: function(obj) {
           return !!(obj && obj.constructor && obj.call && obj.apply);
        },

        hitch: function() {
           var args = Array.prototype.slice.call(arguments);
           var scope = args.shift();
           var method = args.shift();

           if (! scope) {
              throw new Error("hitch(): scope is required!");
           }

           if (! method) {
              throw new Error("hitch(): method is required!");
           }

           if (! util.isFunction(method)) {
              throw new Error("hitch(): method is not a function!");
           }

           return function() {
              var closureArgs = Array.prototype.slice.call(arguments);
              return method.apply(scope, args.concat(closureArgs));
           };
        }
    };

})();

/* Extensions to Backbone.js for Telephony Agent Website */

(function(){

    TapBackbone = {};

    TapBackbone.Collection = Backbone.Collection.extend({

        // Pre-pend url with TAW url base
        // and add to the end of the path, depending on the method.
        sync: function(method, model, options) {
            var urlProperty = getValue(this, 'url') || urlError();
            if (method === 'read') {
                if( options.load ) {
                    options.url = tapConstants.URL_BASE + urlProperty + '/load';
                }
                else {
                    options.url = tapConstants.URL_BASE + urlProperty + '/list';
                }
            }
            else if (method === 'update') {
                options.url = tapConstants.URL_BASE + urlProperty + '/save';
            }
            else {
                options.url = tapConstants.URL_BASE + urlProperty;
            }
            Backbone.sync.apply(this, arguments);
        },

        // Customized fetch() that throws an event when it starts.
        // Useful for views to know that we started to get some data
        // and that it should expect a 'reset' event soon
        fetch: function(){
            this.trigger('fetch');
            return Backbone.Collection.prototype.fetch.apply(this, arguments);
        },

        // Overrides reset function to allow a custom function
        // to be run after the function method finishes
        reset: function(models, options){
            Backbone.Collection.prototype.reset.apply(this, arguments);
            if(options && options.nextFunc && typeof(options.nextFunc) === "function"){
                options.nextFunc();
            }
        },

        // Like Backbone.Model.save() function, but for bulk-updating a collection
        saveAll: function(options) {
            var collection = this;
            var success = options.success;
            options.success = function(resp, status, xhr) {
                if (success) {
                    success(this, resp);
                } else {
                    this.trigger('syncAll', this, resp, options);
                }
            };
            options.success = _.bind(options.success, this);
            options.error = Backbone.wrapError(options.error, this, options);
            var xhr = (this.sync || Backbone.sync).call(this, 'update', this, options);
            return xhr;
        }

    });

    TapBackbone.Model = Backbone.Model.extend({

        // Pre-pend URL with taw URL base
        sync: function(method, model, options) {
            var urlProperty = getValue(this, 'url') || urlError();
            if (method === 'update' || method === 'create') {
                options.url = tapConstants.URL_BASE + urlProperty + '/save';
            }
            else if (method === 'delete') {
                options.url = tapConstants.URL_BASE + urlProperty + '/delete' +
                    '?' + $.param(options.data);
            }
            else {
                options.url = tapConstants.URL_BASE + urlProperty;
            }
            Backbone.sync.apply(this, arguments);
        },

        // First check to make sure all required attributes are there
        validateRequired: function() {
            if (this.requiredAttributes) {
                var missingAttribute = util.findMissingAttributeName(this.attributes, this.requiredAttributes);
                if (missingAttribute) {
                    return "Missing required attribute: " + missingAttribute;
                }
            }
        }

    });

    // Helper function to get a value from a Backbone object as a property
    // or as a function.
    // (copied from backbone.js)
    function getValue(object, prop) {
        if (!(object && object[prop])){ return null; }
        return _.isFunction(object[prop]) ? object[prop]() : object[prop];
    }

    // Throw an error when a URL is needed, and none is supplied.
    // (copied from backbone.js)
    function urlError() {
        throw new Error('A "url" property or function must be specified');
    }


})();

/**
 * bootbox.js v4.0.0
 *
 * http://bootboxjs.com/license.txt
 */
// @see https://github.com/makeusabrew/bootbox/issues/71
/*jslint browser: true*/
window.bootbox = window.bootbox || (function init($, undefined) {
  "use strict";

  // the base DOM structure needed to create a modal
  var templates = {
    dialog:
      "<div class='bootbox modal' tabindex='-1' role='dialog'>" +
        "<div class='modal-dialog'>" +
          "<div class='modal-content'>" +
            "<div class='modal-body'><div class='bootbox-body'></div></div>" +
          "</div>" +
        "</div>" +
      "</div>",
    header:
      "<div class='modal-header'>" +
        "<h4 class='modal-title'></h4>" +
      "</div>",
    footer:
      "<div class='modal-footer'></div>",
    closeButton:
      "<button type='button' class='bootbox-close-button close'>&times;</button>",
    form:
      "<form class='bootbox-form'></form>",
    inputs: {
      text:
        "<input class='bootbox-input form-control' autocomplete=off type=text />"
    }
  };

  // cache a reference to the jQueryfied body element
  var appendTo = $("body");

  var defaults = {
    // default language
    locale: "en",
    // show backdrop or not
    backdrop: true,
    // animate the modal in/out
    animate: true,
    // additional class string applied to the top level dialog
    className: null,
    // whether or not to include a close button
    closeButton: true,
    // show the dialog immediately by default
    show: true
  };

  // our public object; augmented after our private API
  var exports = {};

  /**
   * @private
   */
  function _t(key) {
    var locale = locales[defaults.locale];
    return locale ? locale[key] : locales.en[key];
  }

  function processCallback(e, dialog, callback) {
    e.preventDefault();

    // by default we assume a callback will get rid of the dialog,
    // although it is given the opportunity to override this

    // so, if the callback can be invoked and it *explicitly returns false*
    // then we'll set a flag to keep the dialog active...
    var preserveDialog = $.isFunction(callback) && callback(e) === false;

    // ... otherwise we'll bin it
    if (!preserveDialog) {
      dialog.modal("hide");
    }
  }

  function getKeyLength(obj) {
    // @TODO defer to Object.keys(x).length if available?
    var k, t = 0;
    for (k in obj) {
      t ++;
    }
    return t;
  }

  function each(collection, iterator) {
    var index = 0;
    $.each(collection, function(key, value) {
      iterator(key, value, index++);
    });
  }

  function sanitize(options) {
    var buttons;
    var total;


    if (typeof options !== "object") {
      throw new Error("Please supply an object of options");
    }

    if (!options.message) {
      throw new Error("Please specify a message");
    }

    // make sure any supplied options take precedence over defaults
    options = $.extend({}, defaults, options);

    if (!options.buttons) {
      options.buttons = {};
    }

    // we only support Bootstrap's "static" and false backdrop args
    // supporting true would mean you could dismiss the dialog without
    // explicitly interacting with it
    options.backdrop = options.backdrop ? "static" : false;

    buttons = options.buttons;

    total = getKeyLength(buttons);

    each(buttons, function(key, button, index) {

      if ($.isFunction(button)) {
        // short form, assume value is our callback. Since button
        // isn't an object it isn't a reference either so re-assign it
        button = buttons[key] = {
          callback: button
        };
      }

      // before any further checks make sure by now button is the correct type
      if ($.type(button) !== "object") {
        throw new Error("button with key " + key + " must be an object");
      }

      if (!button.label) {
        // the lack of an explicit label means we'll assume the key is good enough
        button.label = key;
      }

      if (!button.className) {
        if (total <= 2 && index === total-1) {
          // always add a primary to the main option in a two-button dialog
          button.className = "btn-primary";
        } else {
          button.className = "btn-default";
        }
      }
    });

    return options;
  }

  function mapArguments(args, properties) {
    var argn = args.length;
    var options = {};

    if (argn < 1 || argn > 2) {
      throw new Error("Invalid argument length");
    }

    if (argn === 2 || typeof args[0] === "string") {
      options[properties[0]] = args[0];
      options[properties[1]] = args[1];
    } else {
      options = args[0];
    }

    return options;
  }

  function mergeArguments(defaults, args, properties) {
    return $.extend(true, {}, defaults, mapArguments(args, properties));
  }

  function mergeButtons(labels, args, properties) {
    return validateButtons(
      mergeArguments(createButtons.apply(null, labels), args, properties),
      labels
    );
  }

  function createLabels() {
    var buttons = {};

    for (var i = 0, j = arguments.length; i < j; i++) {
      var argument = arguments[i];
      var key = argument.toLowerCase();
      var value = argument.toUpperCase();

      buttons[key] = {
        label: _t(value)
      };
    }

    return buttons;
  }

  function createButtons() {
    return {
      buttons: createLabels.apply(null, arguments)
    };
  }

  function validateButtons(options, buttons) {
    var allowedButtons = {};
    each(buttons, function(key, value) {
      allowedButtons[value] = true;
    });

    each(options.buttons, function(key) {
      if (allowedButtons[key] === undefined) {
        throw new Error("button key " + key + " is not allowed (options are " + buttons.join("\n") + ")");
      }
    });

    return options;
  }

  exports.alert = function() {
    var options;

    options = mergeButtons(["ok"], arguments, ["message", "callback"]);

    if (options.callback && !$.isFunction(options.callback)) {
      throw new Error("alert requires callback property to be a function when provided");
    }

    /**
     * overrides
     */
    options.buttons.ok.callback = options.onEscape = function() {
      if ($.isFunction(options.callback)) {
        return options.callback();
      }
      return true;
    };

    return exports.dialog(options);
  };

  exports.confirm = function() {
    var options;

    options = mergeButtons(["cancel", "confirm"], arguments, ["message", "callback"]);

    /**
     * overrides; undo anything the user tried to set they shouldn't have
     */
    options.buttons.cancel.callback = options.onEscape = function() {
      return options.callback(false);
    };

    options.buttons.confirm.callback = function() {
      return options.callback(true);
    };

    // confirm specific validation
    if (!$.isFunction(options.callback)) {
      throw new Error("confirm requires a callback");
    }

    return exports.dialog(options);
  };

  exports.prompt = function() {
    var options;
    var defaults;
    var dialog;
    var form;
    var input;
    var shouldShow;

    // we have to create our form first otherwise
    // its value is undefined when gearing up our options
    // @TODO this could be solved by allowing message to
    // be a function instead...
    form = $(templates.form);

    defaults = {
      buttons: createLabels("cancel", "confirm"),
      value: ""
    };

    options = validateButtons(
      mergeArguments(defaults, arguments, ["title", "callback"]),
      ["cancel", "confirm"]
    );

    // capture the user's show value; we always set this to false before
    // spawning the dialog to give us a chance to attach some handlers to
    // it, but we need to make sure we respect a preference not to show it
    shouldShow = (options.show === undefined) ? true : options.show;

    /**
     * overrides; undo anything the user tried to set they shouldn't have
     */
    options.message = form;

    options.buttons.cancel.callback = options.onEscape = function() {
      return options.callback(null);
    };

    options.buttons.confirm.callback = function() {
      return options.callback(input.val());
    };

    options.show = false;

    // prompt specific validation
    if (!options.title) {
      throw new Error("prompt requires a title");
    }

    if (!$.isFunction(options.callback)) {
      throw new Error("prompt requires a callback");
    }

    // create the input
    input = $(templates.inputs.text);
    input.val(options.value);

    // now place it in our form
    form.append(input);

    form.on("submit", function(e) {
      e.preventDefault();
      // @TODO can we actually click *the* button object instead?
      // e.g. buttons.confirm.click() or similar
      dialog.find(".btn-primary").click();
    });

    dialog = exports.dialog(options);

    // clear the existing handler focusing the submit button...
    dialog.off("shown.bs.modal");

    // ...and replace it with one focusing our input, if possible
    dialog.on("shown.bs.modal", function() {
      input.focus();
    });

    if (shouldShow === true) {
      dialog.modal("show");
    }

    return dialog;
  };

  exports.dialog = function(options) {
    options = sanitize(options);

    var dialog = $(templates.dialog);
    var body = dialog.find(".modal-body");
    var buttons = options.buttons;
    var buttonStr = "";
    var callbacks = {
      onEscape: options.onEscape
    };

    each(buttons, function(key, button) {

      // @TODO I don't like this string appending to itself; bit dirty. Needs reworking
      // can we just build up button elements instead? slower but neater. Then button
      // can just become a template too
      buttonStr += "<button data-bb-handler='" + key + "' type='button' class='btn " + button.className + "'>" + button.label + "</button>";
      callbacks[key] = button.callback;
    });

    body.find(".bootbox-body").html(options.message);

    if (options.animate === true) {
      dialog.addClass("fade");
    }

    if (options.className) {
      dialog.addClass(options.className);
    }

    if (options.title) {
      body.before(templates.header);
    }

    if (options.closeButton) {
      var closeButton = $(templates.closeButton);

      if (options.title) {
        dialog.find(".modal-header").prepend(closeButton);
      } else {
        closeButton.css("margin-top", "-10px").prependTo(body);
      }
    }

    if (options.title) {
      dialog.find(".modal-title").html(options.title);
    }

    if (buttonStr.length) {
      body.after(templates.footer);
      dialog.find(".modal-footer").html(buttonStr);
    }


    /**
     * Bootstrap event listeners; used handle extra
     * setup & teardown required after the underlying
     * modal has performed certain actions
     */

    dialog.on("hidden.bs.modal", function(e) {
      // ensure we don't accidentally intercept hidden events triggered
      // by children of the current dialog. We shouldn't anymore now BS
      // namespaces its events; but still worth doing
      if (e.target === this) {
        dialog.remove();
      }
    });

    /*
    dialog.on("show.bs.modal", function() {
      // sadly this doesn't work; show is called *just* before
      // the backdrop is added so we'd need a setTimeout hack or
      // otherwise... leaving in as would be nice
      if (options.backdrop) {
        dialog.next(".modal-backdrop").addClass("bootbox-backdrop");
      }
    });
    */

    dialog.on("shown.bs.modal", function() {
      dialog.find(".btn-primary:first").focus();
    });

    /**
     * Bootbox event listeners; experimental and may not last
     * just an attempt to decouple some behaviours from their
     * respective triggers
     */

    dialog.on("escape.close.bb", function(e) {
      if (callbacks.onEscape) {
        processCallback(e, dialog, callbacks.onEscape);
      }
    });

    /**
     * Standard jQuery event listeners; used to handle user
     * interaction with our dialog
     */

    dialog.on("click", ".modal-footer button", function(e) {
      var callbackKey = $(this).data("bb-handler");

      processCallback(e, dialog, callbacks[callbackKey]);

    });

    dialog.on("click", ".bootbox-close-button", function(e) {
      // onEscape might be falsy but that's fine; the fact is
      // if the user has managed to click the close button we
      // have to close the dialog, callback or not
      processCallback(e, dialog, callbacks.onEscape);
    });

    dialog.on("keyup", function(e) {
      if (e.which === 27) {
        dialog.trigger("escape.close.bb");
      }
    });

    // the remainder of this method simply deals with adding our
    // dialogent to the DOM, augmenting it with Bootstrap's modal
    // functionality and then giving the resulting object back
    // to our caller

    appendTo.append(dialog);

    dialog.modal({
      backdrop: options.backdrop,
      keyboard: false,
      show: false
    });

    if (options.show) {
      dialog.modal("show");
    }

    // @TODO should we return the raw element here or should
    // we wrap it in an object on which we can expose some neater
    // methods, e.g. var d = bootbox.alert(); d.hide(); instead
    // of d.modal("hide");

   /*
    function BBDialog(elem) {
      this.elem = elem;
    }

    BBDialog.prototype = {
      hide: function() {
        return this.elem.modal("hide");
      },
      show: function() {
        return this.elem.modal("show");
      }
    };
    */

    return dialog;

  };

  exports.setDefaults = function(values) {
    $.extend(defaults, values);
  };

  exports.hideAll = function() {
    $(".bootbox").modal("hide");
  };


  /**
   * standard locales. Please add more according to ISO 639-1 standard. Multiple language variants are
   * unlikely to be required. If this gets too large it can be split out into separate JS files.
   */
  var locales = {
    br : {
      OK      : "OK",
      CANCEL  : "Cancelar",
      CONFIRM : "Sim"
    },
    da : {
      OK      : "OK",
      CANCEL  : "Annuller",
      CONFIRM : "Accepter"
    },
    de : {
      OK      : "OK",
      CANCEL  : "Abbrechen",
      CONFIRM : "Akzeptieren"
    },
    en : {
      OK      : "OK",
      CANCEL  : "Cancel",
      CONFIRM : "OK"
    },
    es : {
      OK      : "OK",
      CANCEL  : "Cancelar",
      CONFIRM : "Aceptar"
    },
    fi : {
      OK      : "OK",
      CANCEL  : "Peruuta",
      CONFIRM : "OK"
    },
    fr : {
      OK      : "OK",
      CANCEL  : "Annuler",
      CONFIRM : "D'accord"
    },
    it : {
      OK      : "OK",
      CANCEL  : "Annulla",
      CONFIRM : "Conferma"
    },
    nl : {
      OK      : "OK",
      CANCEL  : "Annuleren",
      CONFIRM : "Accepteren"
    },
    pl : {
      OK      : "OK",
      CANCEL  : "Anuluj",
      CONFIRM : "Potwierdź"
    },
    ru : {
      OK      : "OK",
      CANCEL  : "Отмена",
      CONFIRM : "Применить"
    },
    zh_CN : {
      OK      : "OK",
      CANCEL  : "取消",
      CONFIRM : "确认"
    },
    zh_TW : {
      OK      : "OK",
      CANCEL  : "取消",
      CONFIRM : "確認"
    }
  };

  exports.init = function(_$) {
    window.bootbox = init(_$ || $);
  };

  return exports;

}(window.jQuery));

window.localizedStrings=window.localizedStrings||{};window.localizedStrings["selectors-js"]={"lily-admin-selector-search-for-timezone":"Search for time zone","lily-admin-selector-search":"search...","lily-admin-selector-search-for-team":"Search for team","lily-admin-selector-search-for-owner":"Search for owner","lily-admin-selector-search-for-phone-number":"Search for number","lily-admin-selector-load-more-data":"Load more data...","lily-admin-selector-search-for-prompts":"Search for prompt","lily-admin-selector-search-and-select":"Search and select","lily-admin-selector-search-for-agents":"Search for agent","lily-admin-selector-search-for-hours-of-operation":"Search for hours of operation","lily-admin-selector-search-for-security-profile":"Search for security profile","lily-admin-selector-search-for-quick-connects":"Search for quick connects","lily-admin-selector-search-for-skill":"Search for queue","lily-admin-selector-search-for-site":"Search for site","lily-admin-selector-search-for-groups":"Search for group","lily-admin-selector-search-for-hoop":"Search for hours of operation","lily-admin-selector-analytics-language":"Select analytics language","lily-admin-selector-search-for-call-flow":"Search for contact flow","lily-admin-selector-search-for-profile":"Search for routing policy","lily-admin-selector-search-for-claimed-phone-numbers":"Search for phone number","lily-admin-selector-lex-bots":"Select an existing Lex bot"};
/*
 AngularJS v1.8.0
 (c) 2010-2020 Google, Inc. http://angularjs.org
 License: MIT
*/

(function(z){'use strict';function ve(a){if(D(a))w(a.objectMaxDepth)&&(Xb.objectMaxDepth=Yb(a.objectMaxDepth)?a.objectMaxDepth:NaN),w(a.urlErrorParamsEnabled)&&Ga(a.urlErrorParamsEnabled)&&(Xb.urlErrorParamsEnabled=a.urlErrorParamsEnabled);else return Xb}function Yb(a){return X(a)&&0<a}function F(a,b){b=b||Error;return function(){var d=arguments[0],c;c="["+(a?a+":":"")+d+"] http://errors.angularjs.org/1.8.0/"+(a?a+"/":"")+d;for(d=1;d<arguments.length;d++){c=c+(1==d?"?":"&")+"p"+(d-1)+"=";var e=encodeURIComponent,
    f;f=arguments[d];f="function"==typeof f?f.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof f?"undefined":"string"!=typeof f?JSON.stringify(f):f;c+=e(f)}return new b(c)}}function za(a){if(null==a||$a(a))return!1;if(H(a)||C(a)||x&&a instanceof x)return!0;var b="length"in Object(a)&&a.length;return X(b)&&(0<=b&&b-1 in a||"function"===typeof a.item)}function r(a,b,d){var c,e;if(a)if(B(a))for(c in a)"prototype"!==c&&"length"!==c&&"name"!==c&&a.hasOwnProperty(c)&&b.call(d,a[c],c,a);else if(H(a)||
    za(a)){var f="object"!==typeof a;c=0;for(e=a.length;c<e;c++)(f||c in a)&&b.call(d,a[c],c,a)}else if(a.forEach&&a.forEach!==r)a.forEach(b,d,a);else if(Pc(a))for(c in a)b.call(d,a[c],c,a);else if("function"===typeof a.hasOwnProperty)for(c in a)a.hasOwnProperty(c)&&b.call(d,a[c],c,a);else for(c in a)ta.call(a,c)&&b.call(d,a[c],c,a);return a}function Qc(a,b,d){for(var c=Object.keys(a).sort(),e=0;e<c.length;e++)b.call(d,a[c[e]],c[e]);return c}function Zb(a){return function(b,d){a(d,b)}}function we(){return++qb}
    function $b(a,b,d){for(var c=a.$$hashKey,e=0,f=b.length;e<f;++e){var g=b[e];if(D(g)||B(g))for(var k=Object.keys(g),h=0,l=k.length;h<l;h++){var m=k[h],p=g[m];d&&D(p)?ha(p)?a[m]=new Date(p.valueOf()):ab(p)?a[m]=new RegExp(p):p.nodeName?a[m]=p.cloneNode(!0):ac(p)?a[m]=p.clone():"__proto__"!==m&&(D(a[m])||(a[m]=H(p)?[]:{}),$b(a[m],[p],!0)):a[m]=p}}c?a.$$hashKey=c:delete a.$$hashKey;return a}function S(a){return $b(a,Ha.call(arguments,1),!1)}function xe(a){return $b(a,Ha.call(arguments,1),!0)}function fa(a){return parseInt(a,
        10)}function bc(a,b){return S(Object.create(a),b)}function E(){}function Ta(a){return a}function ia(a){return function(){return a}}function cc(a){return B(a.toString)&&a.toString!==la}function A(a){return"undefined"===typeof a}function w(a){return"undefined"!==typeof a}function D(a){return null!==a&&"object"===typeof a}function Pc(a){return null!==a&&"object"===typeof a&&!Rc(a)}function C(a){return"string"===typeof a}function X(a){return"number"===typeof a}function ha(a){return"[object Date]"===la.call(a)}
    function H(a){return Array.isArray(a)||a instanceof Array}function dc(a){switch(la.call(a)){case "[object Error]":return!0;case "[object Exception]":return!0;case "[object DOMException]":return!0;default:return a instanceof Error}}function B(a){return"function"===typeof a}function ab(a){return"[object RegExp]"===la.call(a)}function $a(a){return a&&a.window===a}function bb(a){return a&&a.$evalAsync&&a.$watch}function Ga(a){return"boolean"===typeof a}function ye(a){return a&&X(a.length)&&ze.test(la.call(a))}
    function ac(a){return!(!a||!(a.nodeName||a.prop&&a.attr&&a.find))}function Ae(a){var b={};a=a.split(",");var d;for(d=0;d<a.length;d++)b[a[d]]=!0;return b}function ua(a){return K(a.nodeName||a[0]&&a[0].nodeName)}function cb(a,b){var d=a.indexOf(b);0<=d&&a.splice(d,1);return d}function Ia(a,b,d){function c(a,b,c){c--;if(0>c)return"...";var d=b.$$hashKey,f;if(H(a)){f=0;for(var g=a.length;f<g;f++)b.push(e(a[f],c))}else if(Pc(a))for(f in a)b[f]=e(a[f],c);else if(a&&"function"===typeof a.hasOwnProperty)for(f in a)a.hasOwnProperty(f)&&
    (b[f]=e(a[f],c));else for(f in a)ta.call(a,f)&&(b[f]=e(a[f],c));d?b.$$hashKey=d:delete b.$$hashKey;return b}function e(a,b){if(!D(a))return a;var d=g.indexOf(a);if(-1!==d)return k[d];if($a(a)||bb(a))throw oa("cpws");var d=!1,e=f(a);void 0===e&&(e=H(a)?[]:Object.create(Rc(a)),d=!0);g.push(a);k.push(e);return d?c(a,e,b):e}function f(a){switch(la.call(a)){case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Float32Array]":case "[object Float64Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return new a.constructor(e(a.buffer),
        a.byteOffset,a.length);case "[object ArrayBuffer]":if(!a.slice){var b=new ArrayBuffer(a.byteLength);(new Uint8Array(b)).set(new Uint8Array(a));return b}return a.slice(0);case "[object Boolean]":case "[object Number]":case "[object String]":case "[object Date]":return new a.constructor(a.valueOf());case "[object RegExp]":return b=new RegExp(a.source,a.toString().match(/[^/]*$/)[0]),b.lastIndex=a.lastIndex,b;case "[object Blob]":return new a.constructor([a],{type:a.type})}if(B(a.cloneNode))return a.cloneNode(!0)}
        var g=[],k=[];d=Yb(d)?d:NaN;if(b){if(ye(b)||"[object ArrayBuffer]"===la.call(b))throw oa("cpta");if(a===b)throw oa("cpi");H(b)?b.length=0:r(b,function(a,c){"$$hashKey"!==c&&delete b[c]});g.push(a);k.push(b);return c(a,b,d)}return e(a,d)}function ec(a,b){return a===b||a!==a&&b!==b}function va(a,b){if(a===b)return!0;if(null===a||null===b)return!1;if(a!==a&&b!==b)return!0;var d=typeof a,c;if(d===typeof b&&"object"===d)if(H(a)){if(!H(b))return!1;if((d=a.length)===b.length){for(c=0;c<d;c++)if(!va(a[c],
        b[c]))return!1;return!0}}else{if(ha(a))return ha(b)?ec(a.getTime(),b.getTime()):!1;if(ab(a))return ab(b)?a.toString()===b.toString():!1;if(bb(a)||bb(b)||$a(a)||$a(b)||H(b)||ha(b)||ab(b))return!1;d=T();for(c in a)if("$"!==c.charAt(0)&&!B(a[c])){if(!va(a[c],b[c]))return!1;d[c]=!0}for(c in b)if(!(c in d)&&"$"!==c.charAt(0)&&w(b[c])&&!B(b[c]))return!1;return!0}return!1}function db(a,b,d){return a.concat(Ha.call(b,d))}function Va(a,b){var d=2<arguments.length?Ha.call(arguments,2):[];return!B(b)||b instanceof
    RegExp?b:d.length?function(){return arguments.length?b.apply(a,db(d,arguments,0)):b.apply(a,d)}:function(){return arguments.length?b.apply(a,arguments):b.call(a)}}function Sc(a,b){var d=b;"string"===typeof a&&"$"===a.charAt(0)&&"$"===a.charAt(1)?d=void 0:$a(b)?d="$WINDOW":b&&z.document===b?d="$DOCUMENT":bb(b)&&(d="$SCOPE");return d}function eb(a,b){if(!A(a))return X(b)||(b=b?2:null),JSON.stringify(a,Sc,b)}function Tc(a){return C(a)?JSON.parse(a):a}function fc(a,b){a=a.replace(Be,"");var d=Date.parse("Jan 01, 1970 00:00:00 "+
        a)/6E4;return Y(d)?b:d}function Uc(a,b){a=new Date(a.getTime());a.setMinutes(a.getMinutes()+b);return a}function gc(a,b,d){d=d?-1:1;var c=a.getTimezoneOffset();b=fc(b,c);return Uc(a,d*(b-c))}function Aa(a){a=x(a).clone().empty();var b=x("<div></div>").append(a).html();try{return a[0].nodeType===Pa?K(b):b.match(/^(<[^>]+>)/)[1].replace(/^<([\w-]+)/,function(a,b){return"<"+K(b)})}catch(d){return K(b)}}function Vc(a){try{return decodeURIComponent(a)}catch(b){}}function hc(a){var b={};r((a||"").split("&"),
        function(a){var c,e,f;a&&(e=a=a.replace(/\+/g,"%20"),c=a.indexOf("="),-1!==c&&(e=a.substring(0,c),f=a.substring(c+1)),e=Vc(e),w(e)&&(f=w(f)?Vc(f):!0,ta.call(b,e)?H(b[e])?b[e].push(f):b[e]=[b[e],f]:b[e]=f))});return b}function Ce(a){var b=[];r(a,function(a,c){H(a)?r(a,function(a){b.push(ba(c,!0)+(!0===a?"":"="+ba(a,!0)))}):b.push(ba(c,!0)+(!0===a?"":"="+ba(a,!0)))});return b.length?b.join("&"):""}function ic(a){return ba(a,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function ba(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 b){return encodeURIComponent(a).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,b?"%20":"+")}function De(a,b){var d,c,e=Qa.length;for(c=0;c<e;++c)if(d=Qa[c]+b,C(d=a.getAttribute(d)))return d;return null}function Ee(a,b){var d,c,e={};r(Qa,function(b){b+="app";!d&&a.hasAttribute&&a.hasAttribute(b)&&(d=a,c=a.getAttribute(b))});r(Qa,function(b){b+="app";var e;!d&&(e=a.querySelector("["+b.replace(":","\\:")+"]"))&&(d=e,c=e.getAttribute(b))});
        d&&(Fe?(e.strictDi=null!==De(d,"strict-di"),b(d,c?[c]:[],e)):z.console.error("AngularJS: disabling automatic bootstrap. <script> protocol indicates an extension, document.location.href does not match."))}function Wc(a,b,d){D(d)||(d={});d=S({strictDi:!1},d);var c=function(){a=x(a);if(a.injector()){var c=a[0]===z.document?"document":Aa(a);throw oa("btstrpd",c.replace(/</,"&lt;").replace(/>/,"&gt;"));}b=b||[];b.unshift(["$provide",function(b){b.value("$rootElement",a)}]);d.debugInfoEnabled&&b.push(["$compileProvider",
        function(a){a.debugInfoEnabled(!0)}]);b.unshift("ng");c=fb(b,d.strictDi);c.invoke(["$rootScope","$rootElement","$compile","$injector",function(a,b,c,d){a.$apply(function(){b.data("$injector",d);c(b)(a)})}]);return c},e=/^NG_ENABLE_DEBUG_INFO!/,f=/^NG_DEFER_BOOTSTRAP!/;z&&e.test(z.name)&&(d.debugInfoEnabled=!0,z.name=z.name.replace(e,""));if(z&&!f.test(z.name))return c();z.name=z.name.replace(f,"");ca.resumeBootstrap=function(a){r(a,function(a){b.push(a)});return c()};B(ca.resumeDeferredBootstrap)&&
    ca.resumeDeferredBootstrap()}function Ge(){z.name="NG_ENABLE_DEBUG_INFO!"+z.name;z.location.reload()}function He(a){a=ca.element(a).injector();if(!a)throw oa("test");return a.get("$$testability")}function Xc(a,b){b=b||"_";return a.replace(Ie,function(a,c){return(c?b:"")+a.toLowerCase()})}function Je(){var a;if(!Yc){var b=rb();(sb=A(b)?z.jQuery:b?z[b]:void 0)&&sb.fn.on?(x=sb,S(sb.fn,{scope:Wa.scope,isolateScope:Wa.isolateScope,controller:Wa.controller,injector:Wa.injector,inheritedData:Wa.inheritedData})):
        x=U;a=x.cleanData;x.cleanData=function(b){for(var c,e=0,f;null!=(f=b[e]);e++)(c=(x._data(f)||{}).events)&&c.$destroy&&x(f).triggerHandler("$destroy");a(b)};ca.element=x;Yc=!0}}function Ke(){U.legacyXHTMLReplacement=!0}function gb(a,b,d){if(!a)throw oa("areq",b||"?",d||"required");return a}function tb(a,b,d){d&&H(a)&&(a=a[a.length-1]);gb(B(a),b,"not a function, got "+(a&&"object"===typeof a?a.constructor.name||"Object":typeof a));return a}function Ja(a,b){if("hasOwnProperty"===a)throw oa("badname",
        b);}function Le(a,b,d){if(!b)return a;b=b.split(".");for(var c,e=a,f=b.length,g=0;g<f;g++)c=b[g],a&&(a=(e=a)[c]);return!d&&B(a)?Va(e,a):a}function ub(a){for(var b=a[0],d=a[a.length-1],c,e=1;b!==d&&(b=b.nextSibling);e++)if(c||a[e]!==b)c||(c=x(Ha.call(a,0,e))),c.push(b);return c||a}function T(){return Object.create(null)}function jc(a){if(null==a)return"";switch(typeof a){case "string":break;case "number":a=""+a;break;default:a=!cc(a)||H(a)||ha(a)?eb(a):a.toString()}return a}function Me(a){function b(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                b,c){return a[b]||(a[b]=c())}var d=F("$injector"),c=F("ng");a=b(a,"angular",Object);a.$$minErr=a.$$minErr||F;return b(a,"module",function(){var a={};return function(f,g,k){var h={};if("hasOwnProperty"===f)throw c("badname","module");g&&a.hasOwnProperty(f)&&(a[f]=null);return b(a,f,function(){function a(b,c,d,f){f||(f=e);return function(){f[d||"push"]([b,c,arguments]);return t}}function b(a,c,d){d||(d=e);return function(b,e){e&&B(e)&&(e.$$moduleName=f);d.push([a,c,arguments]);return t}}if(!g)throw d("nomod",
        f);var e=[],n=[],s=[],G=a("$injector","invoke","push",n),t={_invokeQueue:e,_configBlocks:n,_runBlocks:s,info:function(a){if(w(a)){if(!D(a))throw c("aobj","value");h=a;return this}return h},requires:g,name:f,provider:b("$provide","provider"),factory:b("$provide","factory"),service:b("$provide","service"),value:a("$provide","value"),constant:a("$provide","constant","unshift"),decorator:b("$provide","decorator",n),animation:b("$animateProvider","register"),filter:b("$filterProvider","register"),controller:b("$controllerProvider",
            "register"),directive:b("$compileProvider","directive"),component:b("$compileProvider","component"),config:G,run:function(a){s.push(a);return this}};k&&G(k);return t})}})}function ja(a,b){if(H(a)){b=b||[];for(var d=0,c=a.length;d<c;d++)b[d]=a[d]}else if(D(a))for(d in b=b||{},a)if("$"!==d.charAt(0)||"$"!==d.charAt(1))b[d]=a[d];return b||a}function Ne(a,b){var d=[];Yb(b)&&(a=ca.copy(a,null,b));return JSON.stringify(a,function(a,b){b=Sc(a,b);if(D(b)){if(0<=d.indexOf(b))return"...";d.push(b)}return b})}
    function Oe(a){S(a,{errorHandlingConfig:ve,bootstrap:Wc,copy:Ia,extend:S,merge:xe,equals:va,element:x,forEach:r,injector:fb,noop:E,bind:Va,toJson:eb,fromJson:Tc,identity:Ta,isUndefined:A,isDefined:w,isString:C,isFunction:B,isObject:D,isNumber:X,isElement:ac,isArray:H,version:Pe,isDate:ha,callbacks:{$$counter:0},getTestability:He,reloadWithDebugInfo:Ge,UNSAFE_restoreLegacyJqLiteXHTMLReplacement:Ke,$$minErr:F,$$csp:Ba,$$encodeUriSegment:ic,$$encodeUriQuery:ba,$$lowercase:K,$$stringify:jc,$$uppercase:vb});
        lc=Me(z);lc("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:Qe});a.provider("$compile",Zc).directive({a:Re,input:$c,textarea:$c,form:Se,script:Te,select:Ue,option:Ve,ngBind:We,ngBindHtml:Xe,ngBindTemplate:Ye,ngClass:Ze,ngClassEven:$e,ngClassOdd:af,ngCloak:bf,ngController:cf,ngForm:df,ngHide:ef,ngIf:ff,ngInclude:gf,ngInit:hf,ngNonBindable:jf,ngPluralize:kf,ngRef:lf,ngRepeat:mf,ngShow:nf,ngStyle:of,ngSwitch:pf,ngSwitchWhen:qf,ngSwitchDefault:rf,ngOptions:sf,ngTransclude:tf,ngModel:uf,
            ngList:vf,ngChange:wf,pattern:ad,ngPattern:ad,required:bd,ngRequired:bd,minlength:cd,ngMinlength:cd,maxlength:dd,ngMaxlength:dd,ngValue:xf,ngModelOptions:yf}).directive({ngInclude:zf,input:Af}).directive(wb).directive(ed);a.provider({$anchorScroll:Bf,$animate:Cf,$animateCss:Df,$$animateJs:Ef,$$animateQueue:Ff,$$AnimateRunner:Gf,$$animateAsyncRun:Hf,$browser:If,$cacheFactory:Jf,$controller:Kf,$document:Lf,$$isDocumentHidden:Mf,$exceptionHandler:Nf,$filter:fd,$$forceReflow:Of,$interpolate:Pf,$interval:Qf,
            $$intervalFactory:Rf,$http:Sf,$httpParamSerializer:Tf,$httpParamSerializerJQLike:Uf,$httpBackend:Vf,$xhrFactory:Wf,$jsonpCallbacks:Xf,$location:Yf,$log:Zf,$parse:$f,$rootScope:ag,$q:bg,$$q:cg,$sce:dg,$sceDelegate:eg,$sniffer:fg,$$taskTrackerFactory:gg,$templateCache:hg,$templateRequest:ig,$$testability:jg,$timeout:kg,$window:lg,$$rAF:mg,$$jqLite:ng,$$Map:og,$$cookieReader:pg})}]).info({angularVersion:"1.8.0"})}function xb(a,b){return b.toUpperCase()}function yb(a){return a.replace(qg,xb)}function mc(a){a=
        a.nodeType;return 1===a||!a||9===a}function gd(a,b){var d,c,e,f=b.createDocumentFragment(),g=[],k;if(nc.test(a)){d=f.appendChild(b.createElement("div"));c=(rg.exec(a)||["",""])[1].toLowerCase();e=U.legacyXHTMLReplacement?a.replace(sg,"<$1></$2>"):a;if(10>wa)for(c=hb[c]||hb._default,d.innerHTML=c[1]+e+c[2],k=c[0];k--;)d=d.firstChild;else{c=qa[c]||[];for(k=c.length;-1<--k;)d.appendChild(z.document.createElement(c[k])),d=d.firstChild;d.innerHTML=e}g=db(g,d.childNodes);d=f.firstChild;d.textContent=""}else g.push(b.createTextNode(a));
        f.textContent="";f.innerHTML="";r(g,function(a){f.appendChild(a)});return f}function U(a){if(a instanceof U)return a;var b;C(a)&&(a=V(a),b=!0);if(!(this instanceof U)){if(b&&"<"!==a.charAt(0))throw oc("nosel");return new U(a)}if(b){b=z.document;var d;a=(d=tg.exec(a))?[b.createElement(d[1])]:(d=gd(a,b))?d.childNodes:[];pc(this,a)}else B(a)?hd(a):pc(this,a)}function qc(a){return a.cloneNode(!0)}function zb(a,b){!b&&mc(a)&&x.cleanData([a]);a.querySelectorAll&&x.cleanData(a.querySelectorAll("*"))}function id(a){for(var b in a)return!1;
        return!0}function jd(a){var b=a.ng339,d=b&&Ka[b],c=d&&d.events,d=d&&d.data;d&&!id(d)||c&&!id(c)||(delete Ka[b],a.ng339=void 0)}function kd(a,b,d,c){if(w(c))throw oc("offargs");var e=(c=Ab(a))&&c.events,f=c&&c.handle;if(f){if(b){var g=function(b){var c=e[b];w(d)&&cb(c||[],d);w(d)&&c&&0<c.length||(a.removeEventListener(b,f),delete e[b])};r(b.split(" "),function(a){g(a);Bb[a]&&g(Bb[a])})}else for(b in e)"$destroy"!==b&&a.removeEventListener(b,f),delete e[b];jd(a)}}function rc(a,b){var d=a.ng339;if(d=
        d&&Ka[d])b?delete d.data[b]:d.data={},jd(a)}function Ab(a,b){var d=a.ng339,d=d&&Ka[d];b&&!d&&(a.ng339=d=++ug,d=Ka[d]={events:{},data:{},handle:void 0});return d}function sc(a,b,d){if(mc(a)){var c,e=w(d),f=!e&&b&&!D(b),g=!b;a=(a=Ab(a,!f))&&a.data;if(e)a[yb(b)]=d;else{if(g)return a;if(f)return a&&a[yb(b)];for(c in b)a[yb(c)]=b[c]}}}function Cb(a,b){return a.getAttribute?-1<(" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+b+" "):!1}function Db(a,b){if(b&&a.setAttribute){var d=
        (" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," "),c=d;r(b.split(" "),function(a){a=V(a);c=c.replace(" "+a+" "," ")});c!==d&&a.setAttribute("class",V(c))}}function Eb(a,b){if(b&&a.setAttribute){var d=(" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," "),c=d;r(b.split(" "),function(a){a=V(a);-1===c.indexOf(" "+a+" ")&&(c+=a+" ")});c!==d&&a.setAttribute("class",V(c))}}function pc(a,b){if(b)if(b.nodeType)a[a.length++]=b;else{var d=b.length;if("number"===typeof d&&b.window!==b){if(d)for(var c=
        0;c<d;c++)a[a.length++]=b[c]}else a[a.length++]=b}}function ld(a,b){return Fb(a,"$"+(b||"ngController")+"Controller")}function Fb(a,b,d){9===a.nodeType&&(a=a.documentElement);for(b=H(b)?b:[b];a;){for(var c=0,e=b.length;c<e;c++)if(w(d=x.data(a,b[c])))return d;a=a.parentNode||11===a.nodeType&&a.host}}function md(a){for(zb(a,!0);a.firstChild;)a.removeChild(a.firstChild)}function Gb(a,b){b||zb(a);var d=a.parentNode;d&&d.removeChild(a)}function vg(a,b){b=b||z;if("complete"===b.document.readyState)b.setTimeout(a);
    else x(b).on("load",a)}function hd(a){function b(){z.document.removeEventListener("DOMContentLoaded",b);z.removeEventListener("load",b);a()}"complete"===z.document.readyState?z.setTimeout(a):(z.document.addEventListener("DOMContentLoaded",b),z.addEventListener("load",b))}function nd(a,b){var d=Hb[b.toLowerCase()];return d&&od[ua(a)]&&d}function wg(a,b){var d=function(c,d){c.isDefaultPrevented=function(){return c.defaultPrevented};var f=b[d||c.type],g=f?f.length:0;if(g){if(A(c.immediatePropagationStopped)){var k=
        c.stopImmediatePropagation;c.stopImmediatePropagation=function(){c.immediatePropagationStopped=!0;c.stopPropagation&&c.stopPropagation();k&&k.call(c)}}c.isImmediatePropagationStopped=function(){return!0===c.immediatePropagationStopped};var h=f.specialHandlerWrapper||xg;1<g&&(f=ja(f));for(var l=0;l<g;l++)c.isImmediatePropagationStopped()||h(a,c,f[l])}};d.elem=a;return d}function xg(a,b,d){d.call(a,b)}function yg(a,b,d){var c=b.relatedTarget;c&&(c===a||zg.call(a,c))||d.call(a,b)}function ng(){this.$get=
        function(){return S(U,{hasClass:function(a,b){a.attr&&(a=a[0]);return Cb(a,b)},addClass:function(a,b){a.attr&&(a=a[0]);return Eb(a,b)},removeClass:function(a,b){a.attr&&(a=a[0]);return Db(a,b)}})}}function La(a,b){var d=a&&a.$$hashKey;if(d)return"function"===typeof d&&(d=a.$$hashKey()),d;d=typeof a;return d="function"===d||"object"===d&&null!==a?a.$$hashKey=d+":"+(b||we)():d+":"+a}function pd(){this._keys=[];this._values=[];this._lastKey=NaN;this._lastIndex=-1}function qd(a){a=Function.prototype.toString.call(a).replace(Ag,
        "");return a.match(Bg)||a.match(Cg)}function Dg(a){return(a=qd(a))?"function("+(a[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function fb(a,b){function d(a){return function(b,c){if(D(b))r(b,Zb(a));else return a(b,c)}}function c(a,b){Ja(a,"service");if(B(b)||H(b))b=n.instantiate(b);if(!b.$get)throw Ca("pget",a);return p[a+"Provider"]=b}function e(a,b){return function(){var c=t.invoke(b,this);if(A(c))throw Ca("undef",a);return c}}function f(a,b,d){return c(a,{$get:!1!==d?e(a,b):b})}function g(a){gb(A(a)||
        H(a),"modulesToLoad","not an array");var b=[],c;r(a,function(a){function d(a){var b,c;b=0;for(c=a.length;b<c;b++){var e=a[b],f=n.get(e[0]);f[e[1]].apply(f,e[2])}}if(!m.get(a)){m.set(a,!0);try{C(a)?(c=lc(a),t.modules[a]=c,b=b.concat(g(c.requires)).concat(c._runBlocks),d(c._invokeQueue),d(c._configBlocks)):B(a)?b.push(n.invoke(a)):H(a)?b.push(n.invoke(a)):tb(a,"module")}catch(e){throw H(a)&&(a=a[a.length-1]),e.message&&e.stack&&-1===e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),Ca("modulerr",
        a,e.stack||e.message||e);}}});return b}function k(a,c){function d(b,e){if(a.hasOwnProperty(b)){if(a[b]===h)throw Ca("cdep",b+" <- "+l.join(" <- "));return a[b]}try{return l.unshift(b),a[b]=h,a[b]=c(b,e),a[b]}catch(f){throw a[b]===h&&delete a[b],f;}finally{l.shift()}}function e(a,c,f){var g=[];a=fb.$$annotate(a,b,f);for(var h=0,k=a.length;h<k;h++){var l=a[h];if("string"!==typeof l)throw Ca("itkn",l);g.push(c&&c.hasOwnProperty(l)?c[l]:d(l,f))}return g}return{invoke:function(a,b,c,d){"string"===typeof c&&
        (d=c,c=null);c=e(a,c,d);H(a)&&(a=a[a.length-1]);d=a;if(wa||"function"!==typeof d)d=!1;else{var f=d.$$ngIsClass;Ga(f)||(f=d.$$ngIsClass=/^class\b/.test(Function.prototype.toString.call(d)));d=f}return d?(c.unshift(null),new (Function.prototype.bind.apply(a,c))):a.apply(b,c)},instantiate:function(a,b,c){var d=H(a)?a[a.length-1]:a;a=e(a,b,c);a.unshift(null);return new (Function.prototype.bind.apply(d,a))},get:d,annotate:fb.$$annotate,has:function(b){return p.hasOwnProperty(b+"Provider")||a.hasOwnProperty(b)}}}
        b=!0===b;var h={},l=[],m=new Ib,p={$provide:{provider:d(c),factory:d(f),service:d(function(a,b){return f(a,["$injector",function(a){return a.instantiate(b)}])}),value:d(function(a,b){return f(a,ia(b),!1)}),constant:d(function(a,b){Ja(a,"constant");p[a]=b;s[a]=b}),decorator:function(a,b){var c=n.get(a+"Provider"),d=c.$get;c.$get=function(){var a=t.invoke(d,c);return t.invoke(b,null,{$delegate:a})}}}},n=p.$injector=k(p,function(a,b){ca.isString(b)&&l.push(b);throw Ca("unpr",l.join(" <- "));}),s={},
            G=k(s,function(a,b){var c=n.get(a+"Provider",b);return t.invoke(c.$get,c,void 0,a)}),t=G;p.$injectorProvider={$get:ia(G)};t.modules=n.modules=T();var N=g(a),t=G.get("$injector");t.strictDi=b;r(N,function(a){a&&t.invoke(a)});t.loadNewModules=function(a){r(g(a),function(a){a&&t.invoke(a)})};return t}function Bf(){var a=!0;this.disableAutoScrolling=function(){a=!1};this.$get=["$window","$location","$rootScope",function(b,d,c){function e(a){var b=null;Array.prototype.some.call(a,function(a){if("a"===
        ua(a))return b=a,!0});return b}function f(a){if(a){a.scrollIntoView();var c;c=g.yOffset;B(c)?c=c():ac(c)?(c=c[0],c="fixed"!==b.getComputedStyle(c).position?0:c.getBoundingClientRect().bottom):X(c)||(c=0);c&&(a=a.getBoundingClientRect().top,b.scrollBy(0,a-c))}else b.scrollTo(0,0)}function g(a){a=C(a)?a:X(a)?a.toString():d.hash();var b;a?(b=k.getElementById(a))?f(b):(b=e(k.getElementsByName(a)))?f(b):"top"===a&&f(null):f(null)}var k=b.document;a&&c.$watch(function(){return d.hash()},function(a,b){a===
    b&&""===a||vg(function(){c.$evalAsync(g)})});return g}]}function ib(a,b){if(!a&&!b)return"";if(!a)return b;if(!b)return a;H(a)&&(a=a.join(" "));H(b)&&(b=b.join(" "));return a+" "+b}function Eg(a){C(a)&&(a=a.split(" "));var b=T();r(a,function(a){a.length&&(b[a]=!0)});return b}function ra(a){return D(a)?a:{}}function Fg(a,b,d,c,e){function f(){pa=null;k()}function g(){t=y();t=A(t)?null:t;va(t,P)&&(t=P);N=P=t}function k(){var a=N;g();if(v!==h.url()||a!==t)v=h.url(),N=t,r(J,function(a){a(h.url(),t)})}
        var h=this,l=a.location,m=a.history,p=a.setTimeout,n=a.clearTimeout,s={},G=e(d);h.isMock=!1;h.$$completeOutstandingRequest=G.completeTask;h.$$incOutstandingRequestCount=G.incTaskCount;h.notifyWhenNoOutstandingRequests=G.notifyWhenNoPendingTasks;var t,N,v=l.href,kc=b.find("base"),pa=null,y=c.history?function(){try{return m.state}catch(a){}}:E;g();h.url=function(b,d,e){A(e)&&(e=null);l!==a.location&&(l=a.location);m!==a.history&&(m=a.history);if(b){var f=N===e;b=ga(b).href;if(v===b&&(!c.history||f))return h;
            var k=v&&Da(v)===Da(b);v=b;N=e;!c.history||k&&f?(k||(pa=b),d?l.replace(b):k?(d=l,e=b,f=e.indexOf("#"),e=-1===f?"":e.substr(f),d.hash=e):l.href=b,l.href!==b&&(pa=b)):(m[d?"replaceState":"pushState"](e,"",b),g());pa&&(pa=b);return h}return(pa||l.href).replace(/#$/,"")};h.state=function(){return t};var J=[],I=!1,P=null;h.onUrlChange=function(b){if(!I){if(c.history)x(a).on("popstate",f);x(a).on("hashchange",f);I=!0}J.push(b);return b};h.$$applicationDestroyed=function(){x(a).off("hashchange popstate",
            f)};h.$$checkUrlChange=k;h.baseHref=function(){var a=kc.attr("href");return a?a.replace(/^(https?:)?\/\/[^/]*/,""):""};h.defer=function(a,b,c){var d;b=b||0;c=c||G.DEFAULT_TASK_TYPE;G.incTaskCount(c);d=p(function(){delete s[d];G.completeTask(a,c)},b);s[d]=c;return d};h.defer.cancel=function(a){if(s.hasOwnProperty(a)){var b=s[a];delete s[a];n(a);G.completeTask(E,b);return!0}return!1}}function If(){this.$get=["$window","$log","$sniffer","$document","$$taskTrackerFactory",function(a,b,d,c,e){return new Fg(a,
        c,b,d,e)}]}function Jf(){this.$get=function(){function a(a,c){function e(a){a!==p&&(n?n===a&&(n=a.n):n=a,f(a.n,a.p),f(a,p),p=a,p.n=null)}function f(a,b){a!==b&&(a&&(a.p=b),b&&(b.n=a))}if(a in b)throw F("$cacheFactory")("iid",a);var g=0,k=S({},c,{id:a}),h=T(),l=c&&c.capacity||Number.MAX_VALUE,m=T(),p=null,n=null;return b[a]={put:function(a,b){if(!A(b)){if(l<Number.MAX_VALUE){var c=m[a]||(m[a]={key:a});e(c)}a in h||g++;h[a]=b;g>l&&this.remove(n.key);return b}},get:function(a){if(l<Number.MAX_VALUE){var b=
            m[a];if(!b)return;e(b)}return h[a]},remove:function(a){if(l<Number.MAX_VALUE){var b=m[a];if(!b)return;b===p&&(p=b.p);b===n&&(n=b.n);f(b.n,b.p);delete m[a]}a in h&&(delete h[a],g--)},removeAll:function(){h=T();g=0;m=T();p=n=null},destroy:function(){m=k=h=null;delete b[a]},info:function(){return S({},k,{size:g})}}}var b={};a.info=function(){var a={};r(b,function(b,e){a[e]=b.info()});return a};a.get=function(a){return b[a]};return a}}function hg(){this.$get=["$cacheFactory",function(a){return a("templates")}]}
    function Zc(a,b){function d(a,b,c){var d=/^([@&]|[=<](\*?))(\??)\s*([\w$]*)$/,e=T();r(a,function(a,f){a=a.trim();if(a in p)e[f]=p[a];else{var g=a.match(d);if(!g)throw $("iscp",b,f,a,c?"controller bindings definition":"isolate scope definition");e[f]={mode:g[1][0],collection:"*"===g[2],optional:"?"===g[3],attrName:g[4]||f};g[4]&&(p[a]=e[f])}});return e}function c(a){var b=a.charAt(0);if(!b||b!==K(b))throw $("baddir",a);if(a!==a.trim())throw $("baddir",a);}function e(a){var b=a.require||a.controller&&
        a.name;!H(b)&&D(b)&&r(b,function(a,c){var d=a.match(l);a.substring(d[0].length)||(b[c]=d[0]+c)});return b}var f={},g=/^\s*directive:\s*([\w-]+)\s+(.*)$/,k=/(([\w-]+)(?::([^;]+))?;?)/,h=Ae("ngSrc,ngSrcset,src,srcset"),l=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,m=/^(on[a-z]+|formaction)$/,p=T();this.directive=function pa(b,d){gb(b,"name");Ja(b,"directive");C(b)?(c(b),gb(d,"directiveFactory"),f.hasOwnProperty(b)||(f[b]=[],a.factory(b+"Directive",["$injector","$exceptionHandler",function(a,c){var d=[];r(f[b],function(f,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    g){try{var h=a.invoke(f);B(h)?h={compile:ia(h)}:!h.compile&&h.link&&(h.compile=ia(h.link));h.priority=h.priority||0;h.index=g;h.name=h.name||b;h.require=e(h);var k=h,l=h.restrict;if(l&&(!C(l)||!/[EACM]/.test(l)))throw $("badrestrict",l,b);k.restrict=l||"EA";h.$$moduleName=f.$$moduleName;d.push(h)}catch(m){c(m)}});return d}])),f[b].push(d)):r(b,Zb(pa));return this};this.component=function y(a,b){function c(a){function e(b){return B(b)||H(b)?function(c,d){return a.invoke(b,this,{$element:c,$attrs:d})}:
        b}var f=b.template||b.templateUrl?b.template:"",g={controller:d,controllerAs:Gg(b.controller)||b.controllerAs||"$ctrl",template:e(f),templateUrl:e(b.templateUrl),transclude:b.transclude,scope:{},bindToController:b.bindings||{},restrict:"E",require:b.require};r(b,function(a,b){"$"===b.charAt(0)&&(g[b]=a)});return g}if(!C(a))return r(a,Zb(Va(this,y))),this;var d=b.controller||function(){};r(b,function(a,b){"$"===b.charAt(0)&&(c[b]=a,B(d)&&(d[b]=a))});c.$inject=["$injector"];return this.directive(a,
        c)};this.aHrefSanitizationWhitelist=function(a){return w(a)?(b.aHrefSanitizationWhitelist(a),this):b.aHrefSanitizationWhitelist()};this.imgSrcSanitizationWhitelist=function(a){return w(a)?(b.imgSrcSanitizationWhitelist(a),this):b.imgSrcSanitizationWhitelist()};var n=!0;this.debugInfoEnabled=function(a){return w(a)?(n=a,this):n};var s=!1;this.strictComponentBindingsEnabled=function(a){return w(a)?(s=a,this):s};var G=10;this.onChangesTtl=function(a){return arguments.length?(G=a,this):G};var t=!0;this.commentDirectivesEnabled=
        function(a){return arguments.length?(t=a,this):t};var N=!0;this.cssClassDirectivesEnabled=function(a){return arguments.length?(N=a,this):N};var v=T();this.addPropertySecurityContext=function(a,b,c){var d=a.toLowerCase()+"|"+b.toLowerCase();if(d in v&&v[d]!==c)throw $("ctxoverride",a,b,v[d],c);v[d]=c;return this};(function(){function a(b,c){r(c,function(a){v[a.toLowerCase()]=b})}a(W.HTML,["iframe|srcdoc","*|innerHTML","*|outerHTML"]);a(W.CSS,["*|style"]);a(W.URL,"area|href area|ping a|href a|ping blockquote|cite body|background del|cite input|src ins|cite q|cite".split(" "));
        a(W.MEDIA_URL,"audio|src img|src img|srcset source|src source|srcset track|src video|src video|poster".split(" "));a(W.RESOURCE_URL,"*|formAction applet|code applet|codebase base|href embed|src frame|src form|action head|profile html|manifest iframe|src link|href media|src object|codebase object|data script|src".split(" "))})();this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate",function(a,b,c,e,p,M,L,u,R){function q(){try{if(!--Ja)throw Ua=
        void 0,$("infchng",G);L.$apply(function(){for(var a=0,b=Ua.length;a<b;++a)try{Ua[a]()}catch(d){c(d)}Ua=void 0})}finally{Ja++}}function ma(a,b){if(!a)return a;if(!C(a))throw $("srcset",b,a.toString());for(var c="",d=V(a),e=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,e=/\s/.test(d)?e:/(,)/,d=d.split(e),e=Math.floor(d.length/2),f=0;f<e;f++)var g=2*f,c=c+u.getTrustedMediaUrl(V(d[g])),c=c+(" "+V(d[g+1]));d=V(d[2*f]).split(/\s/);c+=u.getTrustedMediaUrl(V(d[0]));2===d.length&&(c+=" "+V(d[1]));return c}function w(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 b){if(b){var c=Object.keys(b),d,e,f;d=0;for(e=c.length;d<e;d++)f=c[d],this[f]=b[f]}else this.$attr={};this.$$element=a}function O(a,b,c){Fa.innerHTML="<span "+b+">";b=Fa.firstChild.attributes;var d=b[0];b.removeNamedItem(d.name);d.value=c;a.attributes.setNamedItem(d)}function sa(a,b){try{a.addClass(b)}catch(c){}}function da(a,b,c,d,e){a instanceof x||(a=x(a));var f=Xa(a,b,a,c,d,e);da.$$addScopeClass(a);var g=null;return function(b,c,d){if(!a)throw $("multilink");gb(b,"scope");e&&e.needsNewScope&&
    (b=b.$parent.$new());d=d||{};var h=d.parentBoundTranscludeFn,k=d.transcludeControllers;d=d.futureParentElement;h&&h.$$boundTransclude&&(h=h.$$boundTransclude);g||(g=(d=d&&d[0])?"foreignobject"!==ua(d)&&la.call(d).match(/SVG/)?"svg":"html":"html");d="html"!==g?x(ja(g,x("<div></div>").append(a).html())):c?Wa.clone.call(a):a;if(k)for(var l in k)d.data("$"+l+"Controller",k[l].instance);da.$$addScopeInfo(d,b);c&&c(d,b);f&&f(b,d,d,h);c||(a=f=null);return d}}function Xa(a,b,c,d,e,f){function g(a,c,d,e){var f,
        k,l,m,p,I,t;if(n)for(t=Array(c.length),m=0;m<h.length;m+=3)f=h[m],t[f]=c[f];else t=c;m=0;for(p=h.length;m<p;)k=t[h[m++]],c=h[m++],f=h[m++],c?(c.scope?(l=a.$new(),da.$$addScopeInfo(x(k),l)):l=a,I=c.transcludeOnThisElement?ka(a,c.transclude,e):!c.templateOnThisElement&&e?e:!e&&b?ka(a,b):null,c(f,l,k,d,I)):f&&f(a,k.childNodes,void 0,e)}for(var h=[],k=H(a)||a instanceof x,l,m,p,I,n,t=0;t<a.length;t++){l=new w;11===wa&&jb(a,t,k);m=tc(a[t],[],l,0===t?d:void 0,e);(f=m.length?aa(m,a[t],l,b,c,null,[],[],f):
        null)&&f.scope&&da.$$addScopeClass(l.$$element);l=f&&f.terminal||!(p=a[t].childNodes)||!p.length?null:Xa(p,f?(f.transcludeOnThisElement||!f.templateOnThisElement)&&f.transclude:b);if(f||l)h.push(t,f,l),I=!0,n=n||f;f=null}return I?g:null}function jb(a,b,c){var d=a[b],e=d.parentNode,f;if(d.nodeType===Pa)for(;;){f=e?d.nextSibling:a[b+1];if(!f||f.nodeType!==Pa)break;d.nodeValue+=f.nodeValue;f.parentNode&&f.parentNode.removeChild(f);c&&f===a[b+1]&&a.splice(b+1,1)}}function ka(a,b,c){function d(e,f,g,h,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      k){e||(e=a.$new(!1,k),e.$$transcluded=!0);return b(e,f,{parentBoundTranscludeFn:c,transcludeControllers:g,futureParentElement:h})}var e=d.$$slots=T(),f;for(f in b.$$slots)e[f]=b.$$slots[f]?ka(a,b.$$slots[f],c):null;return d}function tc(a,b,d,e,f){var g=d.$attr,h;switch(a.nodeType){case 1:h=ua(a);Y(b,xa(h),"E",e,f);for(var l,m,n,t,J,s=a.attributes,v=0,G=s&&s.length;v<G;v++){var P=!1,N=!1,r=!1,y=!1,u=!1,M;l=s[v];m=l.name;t=l.value;n=xa(m.toLowerCase());(J=n.match(Ra))?(r="Attr"===J[1],y="Prop"===J[1],
        u="On"===J[1],m=m.replace(rd,"").toLowerCase().substr(4+J[1].length).replace(/_(.)/g,function(a,b){return b.toUpperCase()})):(M=n.match(Sa))&&ca(M[1])&&(P=m,N=m.substr(0,m.length-5)+"end",m=m.substr(0,m.length-6));if(y||u)d[n]=t,g[n]=l.name,y?Ea(a,b,n,m):b.push(sd(p,L,c,n,m,!1));else{n=xa(m.toLowerCase());g[n]=m;if(r||!d.hasOwnProperty(n))d[n]=t,nd(a,n)&&(d[n]=!0);Ia(a,b,t,n,r);Y(b,n,"A",e,f,P,N)}}"input"===h&&"hidden"===a.getAttribute("type")&&a.setAttribute("autocomplete","off");if(!Qa)break;g=
        a.className;D(g)&&(g=g.animVal);if(C(g)&&""!==g)for(;a=k.exec(g);)n=xa(a[2]),Y(b,n,"C",e,f)&&(d[n]=V(a[3])),g=g.substr(a.index+a[0].length);break;case Pa:na(b,a.nodeValue);break;case 8:if(!Oa)break;F(a,b,d,e,f)}b.sort(ia);return b}function F(a,b,c,d,e){try{var f=g.exec(a.nodeValue);if(f){var h=xa(f[1]);Y(b,h,"M",d,e)&&(c[h]=V(f[2]))}}catch(k){}}function U(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b)){do{if(!a)throw $("uterdir",b,c);1===a.nodeType&&(a.hasAttribute(b)&&e++,a.hasAttribute(c)&&
    e--);d.push(a);a=a.nextSibling}while(0<e)}else d.push(a);return x(d)}function W(a,b,c){return function(d,e,f,g,h){e=U(e[0],b,c);return a(d,e,f,g,h)}}function Z(a,b,c,d,e,f){var g;return a?da(b,c,d,e,f):function(){g||(g=da(b,c,d,e,f),b=c=f=null);return g.apply(this,arguments)}}function aa(a,b,d,e,f,g,h,k,l){function m(a,b,c,d){if(a){c&&(a=W(a,c,d));a.require=u.require;a.directiveName=Q;if(s===u||u.$$isolateScope)a=Ba(a,{isolateScope:!0});h.push(a)}if(b){c&&(b=W(b,c,d));b.require=u.require;b.directiveName=
        Q;if(s===u||u.$$isolateScope)b=Ba(b,{isolateScope:!0});k.push(b)}}function p(a,e,f,g,l){function m(a,b,c,d){var e;bb(a)||(d=c,c=b,b=a,a=void 0);N&&(e=P);c||(c=N?Q.parent():Q);if(d){var f=l.$$slots[d];if(f)return f(a,b,e,c,R);if(A(f))throw $("noslot",d,Aa(Q));}else return l(a,b,e,c,R)}var n,u,L,y,G,P,M,Q;b===f?(g=d,Q=d.$$element):(Q=x(f),g=new w(Q,d));G=e;s?y=e.$new(!0):t&&(G=e.$parent);l&&(M=m,M.$$boundTransclude=l,M.isSlotFilled=function(a){return!!l.$$slots[a]});J&&(P=ea(Q,g,M,J,y,e,s));s&&(da.$$addScopeInfo(Q,
        y,!0,!(v&&(v===s||v===s.$$originalDirective))),da.$$addScopeClass(Q,!0),y.$$isolateBindings=s.$$isolateBindings,u=Da(e,g,y,y.$$isolateBindings,s),u.removeWatches&&y.$on("$destroy",u.removeWatches));for(n in P){u=J[n];L=P[n];var Hg=u.$$bindings.bindToController;L.instance=L();Q.data("$"+u.name+"Controller",L.instance);L.bindingInfo=Da(G,g,L.instance,Hg,u)}r(J,function(a,b){var c=a.require;a.bindToController&&!H(c)&&D(c)&&S(P[b].instance,X(b,c,Q,P))});r(P,function(a){var b=a.instance;if(B(b.$onChanges))try{b.$onChanges(a.bindingInfo.initialChanges)}catch(d){c(d)}if(B(b.$onInit))try{b.$onInit()}catch(e){c(e)}B(b.$doCheck)&&
    (G.$watch(function(){b.$doCheck()}),b.$doCheck());B(b.$onDestroy)&&G.$on("$destroy",function(){b.$onDestroy()})});n=0;for(u=h.length;n<u;n++)L=h[n],Ca(L,L.isolateScope?y:e,Q,g,L.require&&X(L.directiveName,L.require,Q,P),M);var R=e;s&&(s.template||null===s.templateUrl)&&(R=y);a&&a(R,f.childNodes,void 0,l);for(n=k.length-1;0<=n;n--)L=k[n],Ca(L,L.isolateScope?y:e,Q,g,L.require&&X(L.directiveName,L.require,Q,P),M);r(P,function(a){a=a.instance;B(a.$postLink)&&a.$postLink()})}l=l||{};for(var n=-Number.MAX_VALUE,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               t=l.newScopeDirective,J=l.controllerDirectives,s=l.newIsolateScopeDirective,v=l.templateDirective,L=l.nonTlbTranscludeDirective,G=!1,P=!1,N=l.hasElementTranscludeDirective,y=d.$$element=x(b),u,Q,M,R=e,q,ma=!1,Jb=!1,O,sa=0,C=a.length;sa<C;sa++){u=a[sa];var E=u.$$start,jb=u.$$end;E&&(y=U(b,E,jb));M=void 0;if(n>u.priority)break;if(O=u.scope)u.templateUrl||(D(O)?(ba("new/isolated scope",s||t,u,y),s=u):ba("new/isolated scope",s,u,y)),t=t||u;Q=u.name;if(!ma&&(u.replace&&(u.templateUrl||u.template)||u.transclude&&
        !u.$$tlb)){for(O=sa+1;ma=a[O++];)if(ma.transclude&&!ma.$$tlb||ma.replace&&(ma.templateUrl||ma.template)){Jb=!0;break}ma=!0}!u.templateUrl&&u.controller&&(J=J||T(),ba("'"+Q+"' controller",J[Q],u,y),J[Q]=u);if(O=u.transclude)if(G=!0,u.$$tlb||(ba("transclusion",L,u,y),L=u),"element"===O)N=!0,n=u.priority,M=y,y=d.$$element=x(da.$$createComment(Q,d[Q])),b=y[0],oa(f,Ha.call(M,0),b),R=Z(Jb,M,e,n,g&&g.name,{nonTlbTranscludeDirective:L});else{var ka=T();if(D(O)){M=z.document.createDocumentFragment();var Xa=
        T(),F=T();r(O,function(a,b){var c="?"===a.charAt(0);a=c?a.substring(1):a;Xa[a]=b;ka[b]=null;F[b]=c});r(y.contents(),function(a){var b=Xa[xa(ua(a))];b?(F[b]=!0,ka[b]=ka[b]||z.document.createDocumentFragment(),ka[b].appendChild(a)):M.appendChild(a)});r(F,function(a,b){if(!a)throw $("reqslot",b);});for(var K in ka)ka[K]&&(R=x(ka[K].childNodes),ka[K]=Z(Jb,R,e));M=x(M.childNodes)}else M=x(qc(b)).contents();y.empty();R=Z(Jb,M,e,void 0,void 0,{needsNewScope:u.$$isolateScope||u.$$newScope});R.$$slots=ka}if(u.template)if(P=
        !0,ba("template",v,u,y),v=u,O=B(u.template)?u.template(y,d):u.template,O=Na(O),u.replace){g=u;M=nc.test(O)?td(ja(u.templateNamespace,V(O))):[];b=M[0];if(1!==M.length||1!==b.nodeType)throw $("tplrt",Q,"");oa(f,y,b);C={$attr:{}};O=tc(b,[],C);var Ig=a.splice(sa+1,a.length-(sa+1));(s||t)&&fa(O,s,t);a=a.concat(O).concat(Ig);ga(d,C);C=a.length}else y.html(O);if(u.templateUrl)P=!0,ba("template",v,u,y),v=u,u.replace&&(g=u),p=ha(a.splice(sa,a.length-sa),y,d,f,G&&R,h,k,{controllerDirectives:J,newScopeDirective:t!==
            u&&t,newIsolateScopeDirective:s,templateDirective:v,nonTlbTranscludeDirective:L}),C=a.length;else if(u.compile)try{q=u.compile(y,d,R);var Y=u.$$originalDirective||u;B(q)?m(null,Va(Y,q),E,jb):q&&m(Va(Y,q.pre),Va(Y,q.post),E,jb)}catch(ca){c(ca,Aa(y))}u.terminal&&(p.terminal=!0,n=Math.max(n,u.priority))}p.scope=t&&!0===t.scope;p.transcludeOnThisElement=G;p.templateOnThisElement=P;p.transclude=R;l.hasElementTranscludeDirective=N;return p}function X(a,b,c,d){var e;if(C(b)){var f=b.match(l);b=b.substring(f[0].length);
        var g=f[1]||f[3],f="?"===f[2];"^^"===g?c=c.parent():e=(e=d&&d[b])&&e.instance;if(!e){var h="$"+b+"Controller";e="^^"===g&&c[0]&&9===c[0].nodeType?null:g?c.inheritedData(h):c.data(h)}if(!e&&!f)throw $("ctreq",b,a);}else if(H(b))for(e=[],g=0,f=b.length;g<f;g++)e[g]=X(a,b[g],c,d);else D(b)&&(e={},r(b,function(b,f){e[f]=X(a,b,c,d)}));return e||null}function ea(a,b,c,d,e,f,g){var h=T(),k;for(k in d){var l=d[k],m={$scope:l===g||l.$$isolateScope?e:f,$element:a,$attrs:b,$transclude:c},p=l.controller;"@"===
    p&&(p=b[l.name]);m=M(p,m,!0,l.controllerAs);h[l.name]=m;a.data("$"+l.name+"Controller",m.instance)}return h}function fa(a,b,c){for(var d=0,e=a.length;d<e;d++)a[d]=bc(a[d],{$$isolateScope:b,$$newScope:c})}function Y(b,c,e,g,h,k,l){if(c===h)return null;var m=null;if(f.hasOwnProperty(c)){h=a.get(c+"Directive");for(var p=0,n=h.length;p<n;p++)if(c=h[p],(A(g)||g>c.priority)&&-1!==c.restrict.indexOf(e)){k&&(c=bc(c,{$$start:k,$$end:l}));if(!c.$$bindings){var I=m=c,t=c.name,u={isolateScope:null,bindToController:null};
        D(I.scope)&&(!0===I.bindToController?(u.bindToController=d(I.scope,t,!0),u.isolateScope={}):u.isolateScope=d(I.scope,t,!1));D(I.bindToController)&&(u.bindToController=d(I.bindToController,t,!0));if(u.bindToController&&!I.controller)throw $("noctrl",t);m=m.$$bindings=u;D(m.isolateScope)&&(c.$$isolateBindings=m.isolateScope)}b.push(c);m=c}}return m}function ca(b){if(f.hasOwnProperty(b))for(var c=a.get(b+"Directive"),d=0,e=c.length;d<e;d++)if(b=c[d],b.multiElement)return!0;return!1}function ga(a,b){var c=
        b.$attr,d=a.$attr;r(a,function(d,e){"$"!==e.charAt(0)&&(b[e]&&b[e]!==d&&(d=d.length?d+(("style"===e?";":" ")+b[e]):b[e]),a.$set(e,d,!0,c[e]))});r(b,function(b,e){a.hasOwnProperty(e)||"$"===e.charAt(0)||(a[e]=b,"class"!==e&&"style"!==e&&(d[e]=c[e]))})}function ha(a,b,d,f,g,h,k,l){var m=[],p,n,t=b[0],u=a.shift(),J=bc(u,{templateUrl:null,transclude:null,replace:null,$$originalDirective:u}),s=B(u.templateUrl)?u.templateUrl(b,d):u.templateUrl,L=u.templateNamespace;b.empty();e(s).then(function(c){var e,
        I;c=Na(c);if(u.replace){c=nc.test(c)?td(ja(L,V(c))):[];e=c[0];if(1!==c.length||1!==e.nodeType)throw $("tplrt",u.name,s);c={$attr:{}};oa(f,b,e);var v=tc(e,[],c);D(u.scope)&&fa(v,!0);a=v.concat(a);ga(d,c)}else e=t,b.html(c);a.unshift(J);p=aa(a,e,d,g,b,u,h,k,l);r(f,function(a,c){a===e&&(f[c]=b[0])});for(n=Xa(b[0].childNodes,g);m.length;){c=m.shift();I=m.shift();var y=m.shift(),P=m.shift(),v=b[0];if(!c.$$destroyed){if(I!==t){var G=I.className;l.hasElementTranscludeDirective&&u.replace||(v=qc(e));oa(y,
        x(I),v);sa(x(v),G)}I=p.transcludeOnThisElement?ka(c,p.transclude,P):P;p(n,c,v,f,I)}}m=null}).catch(function(a){dc(a)&&c(a)});return function(a,b,c,d,e){a=e;b.$$destroyed||(m?m.push(b,c,d,a):(p.transcludeOnThisElement&&(a=ka(b,p.transclude,e)),p(n,b,c,d,a)))}}function ia(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function ba(a,b,c,d){function e(a){return a?" (module: "+a+")":""}if(b)throw $("multidir",b.name,e(b.$$moduleName),c.name,e(c.$$moduleName),
        a,Aa(d));}function na(a,c){var d=b(c,!0);d&&a.push({priority:0,compile:function(a){a=a.parent();var b=!!a.length;b&&da.$$addBindingClass(a);return function(a,c){var e=c.parent();b||da.$$addBindingClass(e);da.$$addBindingInfo(e,d.expressions);a.$watch(d,function(a){c[0].nodeValue=a})}}})}function ja(a,b){a=K(a||"html");switch(a){case "svg":case "math":var c=z.document.createElement("div");c.innerHTML="<"+a+">"+b+"</"+a+">";return c.childNodes[0].childNodes;default:return b}}function qa(a,b){if("srcdoc"===
        b)return u.HTML;if("src"===b||"ngSrc"===b)return-1===["img","video","audio","source","track"].indexOf(a)?u.RESOURCE_URL:u.MEDIA_URL;if("xlinkHref"===b)return"image"===a?u.MEDIA_URL:"a"===a?u.URL:u.RESOURCE_URL;if("form"===a&&"action"===b||"base"===a&&"href"===b||"link"===a&&"href"===b)return u.RESOURCE_URL;if("a"===a&&("href"===b||"ngHref"===b))return u.URL}function ya(a,b){var c=b.toLowerCase();return v[a+"|"+c]||v["*|"+c]}function za(a){return ma(u.valueOf(a),"ng-prop-srcset")}function Ea(a,b,c,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        d){if(m.test(d))throw $("nodomevents");a=ua(a);var e=ya(a,d),f=Ta;"srcset"!==d||"img"!==a&&"source"!==a?e&&(f=u.getTrusted.bind(u,e)):f=za;b.push({priority:100,compile:function(a,b){var e=p(b[c]),g=p(b[c],function(a){return u.valueOf(a)});return{pre:function(a,b){function c(){var g=e(a);b[0][d]=f(g)}c();a.$watch(g,c)}}}})}function Ia(a,c,d,e,f){var g=ua(a),k=qa(g,e),l=h[e]||f,p=b(d,!f,k,l);if(p){if("multiple"===e&&"select"===g)throw $("selmulti",Aa(a));if(m.test(e))throw $("nodomevents");c.push({priority:100,
        compile:function(){return{pre:function(a,c,f){c=f.$$observers||(f.$$observers=T());var g=f[e];g!==d&&(p=g&&b(g,!0,k,l),d=g);p&&(f[e]=p(a),(c[e]||(c[e]=[])).$$inter=!0,(f.$$observers&&f.$$observers[e].$$scope||a).$watch(p,function(a,b){"class"===e&&a!==b?f.$updateClass(a,b):f.$set(e,a)}))}}}})}}function oa(a,b,c){var d=b[0],e=b.length,f=d.parentNode,g,h;if(a)for(g=0,h=a.length;g<h;g++)if(a[g]===d){a[g++]=c;h=g+e-1;for(var k=a.length;g<k;g++,h++)h<k?a[g]=a[h]:delete a[g];a.length-=e-1;a.context===d&&
    (a.context=c);break}f&&f.replaceChild(c,d);a=z.document.createDocumentFragment();for(g=0;g<e;g++)a.appendChild(b[g]);x.hasData(d)&&(x.data(c,x.data(d)),x(d).off("$destroy"));x.cleanData(a.querySelectorAll("*"));for(g=1;g<e;g++)delete b[g];b[0]=c;b.length=1}function Ba(a,b){return S(function(){return a.apply(null,arguments)},a,b)}function Ca(a,b,d,e,f,g){try{a(b,d,e,f,g)}catch(h){c(h,Aa(d))}}function ra(a,b){if(s)throw $("missingattr",a,b);}function Da(a,c,d,e,f){function g(b,c,e){B(d.$onChanges)&&
    !ec(c,e)&&(Ua||(a.$$postDigest(q),Ua=[]),m||(m={},Ua.push(h)),m[b]&&(e=m[b].previousValue),m[b]=new Kb(e,c))}function h(){d.$onChanges(m);m=void 0}var k=[],l={},m;r(e,function(e,h){var m=e.attrName,n=e.optional,I,t,u,s;switch(e.mode){case "@":n||ta.call(c,m)||(ra(m,f.name),d[h]=c[m]=void 0);n=c.$observe(m,function(a){if(C(a)||Ga(a))g(h,a,d[h]),d[h]=a});c.$$observers[m].$$scope=a;I=c[m];C(I)?d[h]=b(I)(a):Ga(I)&&(d[h]=I);l[h]=new Kb(uc,d[h]);k.push(n);break;case "=":if(!ta.call(c,m)){if(n)break;ra(m,
        f.name);c[m]=void 0}if(n&&!c[m])break;t=p(c[m]);s=t.literal?va:ec;u=t.assign||function(){I=d[h]=t(a);throw $("nonassign",c[m],m,f.name);};I=d[h]=t(a);n=function(b){s(b,d[h])||(s(b,I)?u(a,b=d[h]):d[h]=b);return I=b};n.$stateful=!0;n=e.collection?a.$watchCollection(c[m],n):a.$watch(p(c[m],n),null,t.literal);k.push(n);break;case "<":if(!ta.call(c,m)){if(n)break;ra(m,f.name);c[m]=void 0}if(n&&!c[m])break;t=p(c[m]);var v=t.literal,L=d[h]=t(a);l[h]=new Kb(uc,d[h]);n=a[e.collection?"$watchCollection":"$watch"](t,
        function(a,b){if(b===a){if(b===L||v&&va(b,L))return;b=L}g(h,a,b);d[h]=a});k.push(n);break;case "&":n||ta.call(c,m)||ra(m,f.name);t=c.hasOwnProperty(m)?p(c[m]):E;if(t===E&&n)break;d[h]=function(b){return t(a,b)}}});return{initialChanges:l,removeWatches:k.length&&function(){for(var a=0,b=k.length;a<b;++a)k[a]()}}}var Ma=/^\w/,Fa=z.document.createElement("div"),Oa=t,Qa=N,Ja=G,Ua;w.prototype={$normalize:xa,$addClass:function(a){a&&0<a.length&&R.addClass(this.$$element,a)},$removeClass:function(a){a&&
        0<a.length&&R.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=ud(a,b);c&&c.length&&R.addClass(this.$$element,c);(c=ud(b,a))&&c.length&&R.removeClass(this.$$element,c)},$set:function(a,b,d,e){var f=nd(this.$$element[0],a),g=vd[a],h=a;f?(this.$$element.prop(a,b),e=f):g&&(this[g]=b,h=g);this[a]=b;e?this.$attr[a]=e:(e=this.$attr[a])||(this.$attr[a]=e=Xc(a,"-"));"img"===ua(this.$$element)&&"srcset"===a&&(this[a]=b=ma(b,"$set('srcset', value)"));!1!==d&&(null===b||A(b)?this.$$element.removeAttr(e):
            Ma.test(e)?f&&!1===b?this.$$element.removeAttr(e):this.$$element.attr(e,b):O(this.$$element[0],e,b));(a=this.$$observers)&&r(a[h],function(a){try{a(b)}catch(d){c(d)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers=T()),e=d[a]||(d[a]=[]);e.push(b);L.$evalAsync(function(){e.$$inter||!c.hasOwnProperty(a)||A(c[a])||b(c[a])});return function(){cb(e,b)}}};var Ka=b.startSymbol(),La=b.endSymbol(),Na="{{"===Ka&&"}}"===La?Ta:function(a){return a.replace(/\{\{/g,Ka).replace(/}}/g,La)},Ra=
        /^ng(Attr|Prop|On)([A-Z].*)$/,Sa=/^(.+)Start$/;da.$$addBindingInfo=n?function(a,b){var c=a.data("$binding")||[];H(b)?c=c.concat(b):c.push(b);a.data("$binding",c)}:E;da.$$addBindingClass=n?function(a){sa(a,"ng-binding")}:E;da.$$addScopeInfo=n?function(a,b,c,d){a.data(c?d?"$isolateScopeNoTemplate":"$isolateScope":"$scope",b)}:E;da.$$addScopeClass=n?function(a,b){sa(a,b?"ng-isolate-scope":"ng-scope")}:E;da.$$createComment=function(a,b){var c="";n&&(c=" "+(a||"")+": ",b&&(c+=b+" "));return z.document.createComment(c)};
        return da}]}function Kb(a,b){this.previousValue=a;this.currentValue=b}function xa(a){return a.replace(rd,"").replace(Jg,function(a,d,c){return c?d.toUpperCase():d})}function ud(a,b){var d="",c=a.split(/\s+/),e=b.split(/\s+/),f=0;a:for(;f<c.length;f++){for(var g=c[f],k=0;k<e.length;k++)if(g===e[k])continue a;d+=(0<d.length?" ":"")+g}return d}function td(a){a=x(a);var b=a.length;if(1>=b)return a;for(;b--;){var d=a[b];(8===d.nodeType||d.nodeType===Pa&&""===d.nodeValue.trim())&&Kg.call(a,b,1)}return a}
    function Gg(a,b){if(b&&C(b))return b;if(C(a)){var d=wd.exec(a);if(d)return d[3]}}function Kf(){var a={};this.has=function(b){return a.hasOwnProperty(b)};this.register=function(b,d){Ja(b,"controller");D(b)?S(a,b):a[b]=d};this.$get=["$injector",function(b){function d(a,b,d,g){if(!a||!D(a.$scope))throw F("$controller")("noscp",g,b);a.$scope[b]=d}return function(c,e,f,g){var k,h,l;f=!0===f;g&&C(g)&&(l=g);if(C(c)){g=c.match(wd);if(!g)throw xd("ctrlfmt",c);h=g[1];l=l||g[3];c=a.hasOwnProperty(h)?a[h]:Le(e.$scope,
        h,!0);if(!c)throw xd("ctrlreg",h);tb(c,h,!0)}if(f)return f=(H(c)?c[c.length-1]:c).prototype,k=Object.create(f||null),l&&d(e,l,k,h||c.name),S(function(){var a=b.invoke(c,k,e,h);a!==k&&(D(a)||B(a))&&(k=a,l&&d(e,l,k,h||c.name));return k},{instance:k,identifier:l});k=b.instantiate(c,e,h);l&&d(e,l,k,h||c.name);return k}}]}function Lf(){this.$get=["$window",function(a){return x(a.document)}]}function Mf(){this.$get=["$document","$rootScope",function(a,b){function d(){e=c.hidden}var c=a[0],e=c&&c.hidden;
        a.on("visibilitychange",d);b.$on("$destroy",function(){a.off("visibilitychange",d)});return function(){return e}}]}function Nf(){this.$get=["$log",function(a){return function(b,d){a.error.apply(a,arguments)}}]}function vc(a){return D(a)?ha(a)?a.toISOString():eb(a):a}function Tf(){this.$get=function(){return function(a){if(!a)return"";var b=[];Qc(a,function(a,c){null===a||A(a)||B(a)||(H(a)?r(a,function(a){b.push(ba(c)+"="+ba(vc(a)))}):b.push(ba(c)+"="+ba(vc(a))))});return b.join("&")}}}function Uf(){this.$get=
        function(){return function(a){function b(a,e,f){H(a)?r(a,function(a,c){b(a,e+"["+(D(a)?c:"")+"]")}):D(a)&&!ha(a)?Qc(a,function(a,c){b(a,e+(f?"":"[")+c+(f?"":"]"))}):(B(a)&&(a=a()),d.push(ba(e)+"="+(null==a?"":ba(vc(a)))))}if(!a)return"";var d=[];b(a,"",!0);return d.join("&")}}}function wc(a,b){if(C(a)){var d=a.replace(Lg,"").trim();if(d){var c=b("Content-Type"),c=c&&0===c.indexOf(yd),e;(e=c)||(e=(e=d.match(Mg))&&Ng[e[0]].test(d));if(e)try{a=Tc(d)}catch(f){if(!c)return a;throw Lb("baddata",a,f);}}}return a}
    function zd(a){var b=T(),d;C(a)?r(a.split("\n"),function(a){d=a.indexOf(":");var e=K(V(a.substr(0,d)));a=V(a.substr(d+1));e&&(b[e]=b[e]?b[e]+", "+a:a)}):D(a)&&r(a,function(a,d){var f=K(d),g=V(a);f&&(b[f]=b[f]?b[f]+", "+g:g)});return b}function Ad(a){var b;return function(d){b||(b=zd(a));return d?(d=b[K(d)],void 0===d&&(d=null),d):b}}function Bd(a,b,d,c){if(B(c))return c(a,b,d);r(c,function(c){a=c(a,b,d)});return a}function Sf(){var a=this.defaults={transformResponse:[wc],transformRequest:[function(a){return D(a)&&
        "[object File]"!==la.call(a)&&"[object Blob]"!==la.call(a)&&"[object FormData]"!==la.call(a)?eb(a):a}],headers:{common:{Accept:"application/json, text/plain, */*"},post:ja(xc),put:ja(xc),patch:ja(xc)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer",jsonpCallbackParam:"callback"},b=!1;this.useApplyAsync=function(a){return w(a)?(b=!!a,this):b};var d=this.interceptors=[],c=this.xsrfWhitelistedOrigins=[];this.$get=["$browser","$httpBackend","$$cookieReader",
        "$cacheFactory","$rootScope","$q","$injector","$sce",function(e,f,g,k,h,l,m,p){function n(b){function c(a,b){for(var d=0,e=b.length;d<e;){var f=b[d++],g=b[d++];a=a.then(f,g)}b.length=0;return a}function d(a,b){var c,e={};r(a,function(a,d){B(a)?(c=a(b),null!=c&&(e[d]=c)):e[d]=a});return e}function f(a){var b=S({},a);b.data=Bd(a.data,a.headers,a.status,g.transformResponse);a=a.status;return 200<=a&&300>a?b:l.reject(b)}if(!D(b))throw F("$http")("badreq",b);if(!C(p.valueOf(b.url)))throw F("$http")("badreq",
            b.url);var g=S({method:"get",transformRequest:a.transformRequest,transformResponse:a.transformResponse,paramSerializer:a.paramSerializer,jsonpCallbackParam:a.jsonpCallbackParam},b);g.headers=function(b){var c=a.headers,e=S({},b.headers),f,g,h,c=S({},c.common,c[K(b.method)]);a:for(f in c){g=K(f);for(h in e)if(K(h)===g)continue a;e[f]=c[f]}return d(e,ja(b))}(b);g.method=vb(g.method);g.paramSerializer=C(g.paramSerializer)?m.get(g.paramSerializer):g.paramSerializer;e.$$incOutstandingRequestCount("$http");
            var h=[],k=[];b=l.resolve(g);r(v,function(a){(a.request||a.requestError)&&h.unshift(a.request,a.requestError);(a.response||a.responseError)&&k.push(a.response,a.responseError)});b=c(b,h);b=b.then(function(b){var c=b.headers,d=Bd(b.data,Ad(c),void 0,b.transformRequest);A(d)&&r(c,function(a,b){"content-type"===K(b)&&delete c[b]});A(b.withCredentials)&&!A(a.withCredentials)&&(b.withCredentials=a.withCredentials);return s(b,d).then(f,f)});b=c(b,k);return b=b.finally(function(){e.$$completeOutstandingRequest(E,
                "$http")})}function s(c,d){function e(a){if(a){var c={};r(a,function(a,d){c[d]=function(c){function d(){a(c)}b?h.$applyAsync(d):h.$$phase?d():h.$apply(d)}});return c}}function k(a,c,d,e,f){function g(){m(c,a,d,e,f)}R&&(200<=a&&300>a?R.put(O,[a,c,zd(d),e,f]):R.remove(O));b?h.$applyAsync(g):(g(),h.$$phase||h.$apply())}function m(a,b,d,e,f){b=-1<=b?b:0;(200<=b&&300>b?L.resolve:L.reject)({data:a,status:b,headers:Ad(d),config:c,statusText:e,xhrStatus:f})}function s(a){m(a.data,a.status,ja(a.headers()),
            a.statusText,a.xhrStatus)}function v(){var a=n.pendingRequests.indexOf(c);-1!==a&&n.pendingRequests.splice(a,1)}var L=l.defer(),u=L.promise,R,q,ma=c.headers,x="jsonp"===K(c.method),O=c.url;x?O=p.getTrustedResourceUrl(O):C(O)||(O=p.valueOf(O));O=G(O,c.paramSerializer(c.params));x&&(O=t(O,c.jsonpCallbackParam));n.pendingRequests.push(c);u.then(v,v);!c.cache&&!a.cache||!1===c.cache||"GET"!==c.method&&"JSONP"!==c.method||(R=D(c.cache)?c.cache:D(a.cache)?a.cache:N);R&&(q=R.get(O),w(q)?q&&B(q.then)?q.then(s,
            s):H(q)?m(q[1],q[0],ja(q[2]),q[3],q[4]):m(q,200,{},"OK","complete"):R.put(O,u));A(q)&&((q=kc(c.url)?g()[c.xsrfCookieName||a.xsrfCookieName]:void 0)&&(ma[c.xsrfHeaderName||a.xsrfHeaderName]=q),f(c.method,O,d,k,ma,c.timeout,c.withCredentials,c.responseType,e(c.eventHandlers),e(c.uploadEventHandlers)));return u}function G(a,b){0<b.length&&(a+=(-1===a.indexOf("?")?"?":"&")+b);return a}function t(a,b){var c=a.split("?");if(2<c.length)throw Lb("badjsonp",a);c=hc(c[1]);r(c,function(c,d){if("JSON_CALLBACK"===
            c)throw Lb("badjsonp",a);if(d===b)throw Lb("badjsonp",b,a);});return a+=(-1===a.indexOf("?")?"?":"&")+b+"=JSON_CALLBACK"}var N=k("$http");a.paramSerializer=C(a.paramSerializer)?m.get(a.paramSerializer):a.paramSerializer;var v=[];r(d,function(a){v.unshift(C(a)?m.get(a):m.invoke(a))});var kc=Og(c);n.pendingRequests=[];(function(a){r(arguments,function(a){n[a]=function(b,c){return n(S({},c||{},{method:a,url:b}))}})})("get","delete","head","jsonp");(function(a){r(arguments,function(a){n[a]=function(b,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                c,d){return n(S({},d||{},{method:a,url:b,data:c}))}})})("post","put","patch");n.defaults=a;return n}]}function Wf(){this.$get=function(){return function(){return new z.XMLHttpRequest}}}function Vf(){this.$get=["$browser","$jsonpCallbacks","$document","$xhrFactory",function(a,b,d,c){return Pg(a,c,a.defer,b,d[0])}]}function Pg(a,b,d,c,e){function f(a,b,d){a=a.replace("JSON_CALLBACK",b);var f=e.createElement("script"),m=null;f.type="text/javascript";f.src=a;f.async=!0;m=function(a){f.removeEventListener("load",
        m);f.removeEventListener("error",m);e.body.removeChild(f);f=null;var g=-1,s="unknown";a&&("load"!==a.type||c.wasCalled(b)||(a={type:"error"}),s=a.type,g="error"===a.type?404:200);d&&d(g,s)};f.addEventListener("load",m);f.addEventListener("error",m);e.body.appendChild(f);return m}return function(e,k,h,l,m,p,n,s,G,t){function N(a){J="timeout"===a;pa&&pa();y&&y.abort()}function v(a,b,c,e,f,g){w(P)&&d.cancel(P);pa=y=null;a(b,c,e,f,g)}k=k||a.url();if("jsonp"===K(e))var q=c.createCallback(k),pa=f(k,q,function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     b){var d=200===a&&c.getResponse(q);v(l,a,d,"",b,"complete");c.removeCallback(q)});else{var y=b(e,k),J=!1;y.open(e,k,!0);r(m,function(a,b){w(a)&&y.setRequestHeader(b,a)});y.onload=function(){var a=y.statusText||"",b="response"in y?y.response:y.responseText,c=1223===y.status?204:y.status;0===c&&(c=b?200:"file"===ga(k).protocol?404:0);v(l,c,b,y.getAllResponseHeaders(),a,"complete")};y.onerror=function(){v(l,-1,null,null,"","error")};y.ontimeout=function(){v(l,-1,null,null,"","timeout")};y.onabort=function(){v(l,
        -1,null,null,"",J?"timeout":"abort")};r(G,function(a,b){y.addEventListener(b,a)});r(t,function(a,b){y.upload.addEventListener(b,a)});n&&(y.withCredentials=!0);if(s)try{y.responseType=s}catch(I){if("json"!==s)throw I;}y.send(A(h)?null:h)}if(0<p)var P=d(function(){N("timeout")},p);else p&&B(p.then)&&p.then(function(){N(w(p.$$timeoutId)?"timeout":"abort")})}}function Pf(){var a="{{",b="}}";this.startSymbol=function(b){return b?(a=b,this):a};this.endSymbol=function(a){return a?(b=a,this):b};this.$get=
        ["$parse","$exceptionHandler","$sce",function(d,c,e){function f(a){return"\\\\\\"+a}function g(c){return c.replace(p,a).replace(n,b)}function k(a,b,c,d){var e=a.$watch(function(a){e();return d(a)},b,c);return e}function h(f,h,n,p){function v(a){try{return a=n&&!r?e.getTrusted(n,a):e.valueOf(a),p&&!w(a)?a:jc(a)}catch(b){c(Ma.interr(f,b))}}var r=n===e.URL||n===e.MEDIA_URL;if(!f.length||-1===f.indexOf(a)){if(h)return;h=g(f);r&&(h=e.getTrusted(n,h));h=ia(h);h.exp=f;h.expressions=[];h.$$watchDelegate=
            k;return h}p=!!p;for(var q,y,J=0,I=[],P,Q=f.length,M=[],L=[],u;J<Q;)if(-1!==(q=f.indexOf(a,J))&&-1!==(y=f.indexOf(b,q+l)))J!==q&&M.push(g(f.substring(J,q))),J=f.substring(q+l,y),I.push(J),J=y+m,L.push(M.length),M.push("");else{J!==Q&&M.push(g(f.substring(J)));break}u=1===M.length&&1===L.length;var R=r&&u?void 0:v;P=I.map(function(a){return d(a,R)});if(!h||I.length){var x=function(a){for(var b=0,c=I.length;b<c;b++){if(p&&A(a[b]))return;M[L[b]]=a[b]}if(r)return e.getTrusted(n,u?M[0]:M.join(""));n&&
        1<M.length&&Ma.throwNoconcat(f);return M.join("")};return S(function(a){var b=0,d=I.length,e=Array(d);try{for(;b<d;b++)e[b]=P[b](a);return x(e)}catch(g){c(Ma.interr(f,g))}},{exp:f,expressions:I,$$watchDelegate:function(a,b){var c;return a.$watchGroup(P,function(d,e){var f=x(d);b.call(this,f,d!==e?c:f,a);c=f})}})}}var l=a.length,m=b.length,p=new RegExp(a.replace(/./g,f),"g"),n=new RegExp(b.replace(/./g,f),"g");h.startSymbol=function(){return a};h.endSymbol=function(){return b};return h}]}function Qf(){this.$get=
        ["$$intervalFactory","$window",function(a,b){var d={},c=function(a){b.clearInterval(a);delete d[a]},e=a(function(a,c,e){a=b.setInterval(a,c);d[a]=e;return a},c);e.cancel=function(a){if(!a)return!1;if(!a.hasOwnProperty("$$intervalId"))throw Qg("badprom");if(!d.hasOwnProperty(a.$$intervalId))return!1;a=a.$$intervalId;var b=d[a],e=b.promise;e.$$state&&(e.$$state.pur=!0);b.reject("canceled");c(a);return!0};return e}]}function Rf(){this.$get=["$browser","$q","$$q","$rootScope",function(a,b,d,c){return function(e,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       f){return function(g,k,h,l){function m(){p?g.apply(null,n):g(s)}var p=4<arguments.length,n=p?Ha.call(arguments,4):[],s=0,G=w(l)&&!l,t=(G?d:b).defer(),r=t.promise;h=w(h)?h:0;r.$$intervalId=e(function(){G?a.defer(m):c.$evalAsync(m);t.notify(s++);0<h&&s>=h&&(t.resolve(s),f(r.$$intervalId));G||c.$apply()},k,t,G);return r}}}]}function Cd(a,b){var d=ga(a);b.$$protocol=d.protocol;b.$$host=d.hostname;b.$$port=fa(d.port)||Rg[d.protocol]||null}function Dd(a,b,d){if(Sg.test(a))throw kb("badpath",a);var c="/"!==
        a.charAt(0);c&&(a="/"+a);a=ga(a);for(var c=(c&&"/"===a.pathname.charAt(0)?a.pathname.substring(1):a.pathname).split("/"),e=c.length;e--;)c[e]=decodeURIComponent(c[e]),d&&(c[e]=c[e].replace(/\//g,"%2F"));d=c.join("/");b.$$path=d;b.$$search=hc(a.search);b.$$hash=decodeURIComponent(a.hash);b.$$path&&"/"!==b.$$path.charAt(0)&&(b.$$path="/"+b.$$path)}function yc(a,b){return a.slice(0,b.length)===b}function ya(a,b){if(yc(b,a))return b.substr(a.length)}function Da(a){var b=a.indexOf("#");return-1===b?a:
        a.substr(0,b)}function zc(a,b,d){this.$$html5=!0;d=d||"";Cd(a,this);this.$$parse=function(a){var d=ya(b,a);if(!C(d))throw kb("ipthprfx",a,b);Dd(d,this,!0);this.$$path||(this.$$path="/");this.$$compose()};this.$$normalizeUrl=function(a){return b+a.substr(1)};this.$$parseLinkUrl=function(c,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;w(f=ya(a,c))?(g=f,g=d&&w(f=ya(d,f))?b+(ya("/",f)||f):a+g):w(f=ya(b,c))?g=b+f:b===c+"/"&&(g=b);g&&this.$$parse(g);return!!g}}function Ac(a,b,d){Cd(a,this);
        this.$$parse=function(c){var e=ya(a,c)||ya(b,c),f;A(e)||"#"!==e.charAt(0)?this.$$html5?f=e:(f="",A(e)&&(a=c,this.replace())):(f=ya(d,e),A(f)&&(f=e));Dd(f,this,!1);c=this.$$path;var e=a,g=/^\/[A-Z]:(\/.*)/;yc(f,e)&&(f=f.replace(e,""));g.exec(f)||(c=(f=g.exec(c))?f[1]:c);this.$$path=c;this.$$compose()};this.$$normalizeUrl=function(b){return a+(b?d+b:"")};this.$$parseLinkUrl=function(b,d){return Da(a)===Da(b)?(this.$$parse(b),!0):!1}}function Ed(a,b,d){this.$$html5=!0;Ac.apply(this,arguments);this.$$parseLinkUrl=
        function(c,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;a===Da(c)?f=c:(g=ya(b,c))?f=a+d+g:b===c+"/"&&(f=b);f&&this.$$parse(f);return!!f};this.$$normalizeUrl=function(b){return a+d+b}}function Mb(a){return function(){return this[a]}}function Fd(a,b){return function(d){if(A(d))return this[a];this[a]=b(d);this.$$compose();return this}}function Yf(){var a="!",b={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(b){return w(b)?(a=b,this):a};this.html5Mode=function(a){if(Ga(a))return b.enabled=
        a,this;if(D(a)){Ga(a.enabled)&&(b.enabled=a.enabled);Ga(a.requireBase)&&(b.requireBase=a.requireBase);if(Ga(a.rewriteLinks)||C(a.rewriteLinks))b.rewriteLinks=a.rewriteLinks;return this}return b};this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(d,c,e,f,g){function k(a,b){return a===b||ga(a).href===ga(b).href}function h(a,b,d){var e=m.url(),f=m.$$state;try{c.url(a,b,d),m.$$state=c.state()}catch(g){throw m.url(e),m.$$state=f,g;}}function l(a,b){d.$broadcast("$locationChangeSuccess",
        m.absUrl(),a,m.$$state,b)}var m,p;p=c.baseHref();var n=c.url(),s;if(b.enabled){if(!p&&b.requireBase)throw kb("nobase");s=n.substring(0,n.indexOf("/",n.indexOf("//")+2))+(p||"/");p=e.history?zc:Ed}else s=Da(n),p=Ac;var r=s.substr(0,Da(s).lastIndexOf("/")+1);m=new p(s,r,"#"+a);m.$$parseLinkUrl(n,n);m.$$state=c.state();var t=/^\s*(javascript|mailto):/i;f.on("click",function(a){var e=b.rewriteLinks;if(e&&!a.ctrlKey&&!a.metaKey&&!a.shiftKey&&2!==a.which&&2!==a.button){for(var g=x(a.target);"a"!==ua(g[0]);)if(g[0]===
        f[0]||!(g=g.parent())[0])return;if(!C(e)||!A(g.attr(e))){var e=g.prop("href"),h=g.attr("href")||g.attr("xlink:href");D(e)&&"[object SVGAnimatedString]"===e.toString()&&(e=ga(e.animVal).href);t.test(e)||!e||g.attr("target")||a.isDefaultPrevented()||!m.$$parseLinkUrl(e,h)||(a.preventDefault(),m.absUrl()!==c.url()&&d.$apply())}}});m.absUrl()!==n&&c.url(m.absUrl(),!0);var N=!0;c.onUrlChange(function(a,b){yc(a,r)?(d.$evalAsync(function(){var c=m.absUrl(),e=m.$$state,f;m.$$parse(a);m.$$state=b;f=d.$broadcast("$locationChangeStart",
        a,c,b,e).defaultPrevented;m.absUrl()===a&&(f?(m.$$parse(c),m.$$state=e,h(c,!1,e)):(N=!1,l(c,e)))}),d.$$phase||d.$digest()):g.location.href=a});d.$watch(function(){if(N||m.$$urlUpdatedByLocation){m.$$urlUpdatedByLocation=!1;var a=c.url(),b=m.absUrl(),f=c.state(),g=m.$$replace,n=!k(a,b)||m.$$html5&&e.history&&f!==m.$$state;if(N||n)N=!1,d.$evalAsync(function(){var b=m.absUrl(),c=d.$broadcast("$locationChangeStart",b,a,m.$$state,f).defaultPrevented;m.absUrl()===b&&(c?(m.$$parse(a),m.$$state=f):(n&&h(b,
        g,f===m.$$state?null:m.$$state),l(a,f)))})}m.$$replace=!1});return m}]}function Zf(){var a=!0,b=this;this.debugEnabled=function(b){return w(b)?(a=b,this):a};this.$get=["$window",function(d){function c(a){dc(a)&&(a.stack&&f?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line));return a}function e(a){var b=d.console||{},e=b[a]||b.log||E;return function(){var a=[];r(arguments,function(b){a.push(c(b))});return Function.prototype.apply.call(e,
        b,a)}}var f=wa||/\bEdge\//.test(d.navigator&&d.navigator.userAgent);return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){a&&c.apply(b,arguments)}}()}}]}function Tg(a){return a+""}function Ug(a,b){return"undefined"!==typeof a?a:b}function Gd(a,b){return"undefined"===typeof a?b:"undefined"===typeof b?a:a+b}function Vg(a,b){switch(a.type){case q.MemberExpression:if(a.computed)return!1;break;case q.UnaryExpression:return 1;case q.BinaryExpression:return"+"!==
    a.operator?1:!1;case q.CallExpression:return!1}return void 0===b?Hd:b}function Z(a,b,d){var c,e,f=a.isPure=Vg(a,d);switch(a.type){case q.Program:c=!0;r(a.body,function(a){Z(a.expression,b,f);c=c&&a.expression.constant});a.constant=c;break;case q.Literal:a.constant=!0;a.toWatch=[];break;case q.UnaryExpression:Z(a.argument,b,f);a.constant=a.argument.constant;a.toWatch=a.argument.toWatch;break;case q.BinaryExpression:Z(a.left,b,f);Z(a.right,b,f);a.constant=a.left.constant&&a.right.constant;a.toWatch=
        a.left.toWatch.concat(a.right.toWatch);break;case q.LogicalExpression:Z(a.left,b,f);Z(a.right,b,f);a.constant=a.left.constant&&a.right.constant;a.toWatch=a.constant?[]:[a];break;case q.ConditionalExpression:Z(a.test,b,f);Z(a.alternate,b,f);Z(a.consequent,b,f);a.constant=a.test.constant&&a.alternate.constant&&a.consequent.constant;a.toWatch=a.constant?[]:[a];break;case q.Identifier:a.constant=!1;a.toWatch=[a];break;case q.MemberExpression:Z(a.object,b,f);a.computed&&Z(a.property,b,f);a.constant=a.object.constant&&
        (!a.computed||a.property.constant);a.toWatch=a.constant?[]:[a];break;case q.CallExpression:c=d=a.filter?!b(a.callee.name).$stateful:!1;e=[];r(a.arguments,function(a){Z(a,b,f);c=c&&a.constant;e.push.apply(e,a.toWatch)});a.constant=c;a.toWatch=d?e:[a];break;case q.AssignmentExpression:Z(a.left,b,f);Z(a.right,b,f);a.constant=a.left.constant&&a.right.constant;a.toWatch=[a];break;case q.ArrayExpression:c=!0;e=[];r(a.elements,function(a){Z(a,b,f);c=c&&a.constant;e.push.apply(e,a.toWatch)});a.constant=c;
        a.toWatch=e;break;case q.ObjectExpression:c=!0;e=[];r(a.properties,function(a){Z(a.value,b,f);c=c&&a.value.constant;e.push.apply(e,a.value.toWatch);a.computed&&(Z(a.key,b,!1),c=c&&a.key.constant,e.push.apply(e,a.key.toWatch))});a.constant=c;a.toWatch=e;break;case q.ThisExpression:a.constant=!1;a.toWatch=[];break;case q.LocalsExpression:a.constant=!1,a.toWatch=[]}}function Id(a){if(1===a.length){a=a[0].expression;var b=a.toWatch;return 1!==b.length?b:b[0]!==a?b:void 0}}function Jd(a){return a.type===
        q.Identifier||a.type===q.MemberExpression}function Kd(a){if(1===a.body.length&&Jd(a.body[0].expression))return{type:q.AssignmentExpression,left:a.body[0].expression,right:{type:q.NGValueParameter},operator:"="}}function Ld(a){this.$filter=a}function Md(a){this.$filter=a}function Nb(a,b,d){this.ast=new q(a,d);this.astCompiler=d.csp?new Md(b):new Ld(b)}function Bc(a){return B(a.valueOf)?a.valueOf():Wg.call(a)}function $f(){var a=T(),b={"true":!0,"false":!1,"null":null,undefined:void 0},d,c;this.addLiteral=
        function(a,c){b[a]=c};this.setIdentifierFns=function(a,b){d=a;c=b;return this};this.$get=["$filter",function(e){function f(b,c){var d,f;switch(typeof b){case "string":return f=b=b.trim(),d=a[f],d||(d=new Ob(G),d=(new Nb(d,e,G)).parse(b),a[f]=p(d)),s(d,c);case "function":return s(b,c);default:return s(E,c)}}function g(a,b,c){return null==a||null==b?a===b:"object"!==typeof a||(a=Bc(a),"object"!==typeof a||c)?a===b||a!==a&&b!==b:!1}function k(a,b,c,d,e){var f=d.inputs,h;if(1===f.length){var k=g,f=f[0];
        return a.$watch(function(a){var b=f(a);g(b,k,f.isPure)||(h=d(a,void 0,void 0,[b]),k=b&&Bc(b));return h},b,c,e)}for(var l=[],m=[],n=0,p=f.length;n<p;n++)l[n]=g,m[n]=null;return a.$watch(function(a){for(var b=!1,c=0,e=f.length;c<e;c++){var k=f[c](a);if(b||(b=!g(k,l[c],f[c].isPure)))m[c]=k,l[c]=k&&Bc(k)}b&&(h=d(a,void 0,void 0,m));return h},b,c,e)}function h(a,b,c,d,e){function f(){h(m)&&k()}function g(a,b,c,d){m=u&&d?d[0]:n(a,b,c,d);h(m)&&a.$$postDigest(f);return s(m)}var h=d.literal?l:w,k,m,n=d.$$intercepted||
        d,s=d.$$interceptor||Ta,u=d.inputs&&!n.inputs;g.literal=d.literal;g.constant=d.constant;g.inputs=d.inputs;p(g);return k=a.$watch(g,b,c,e)}function l(a){var b=!0;r(a,function(a){w(a)||(b=!1)});return b}function m(a,b,c,d){var e=a.$watch(function(a){e();return d(a)},b,c);return e}function p(a){a.constant?a.$$watchDelegate=m:a.oneTime?a.$$watchDelegate=h:a.inputs&&(a.$$watchDelegate=k);return a}function n(a,b){function c(d){return b(a(d))}c.$stateful=a.$stateful||b.$stateful;c.$$pure=a.$$pure&&b.$$pure;
        return c}function s(a,b){if(!b)return a;a.$$interceptor&&(b=n(a.$$interceptor,b),a=a.$$intercepted);var c=!1,d=function(d,e,f,g){d=c&&g?g[0]:a(d,e,f,g);return b(d)};d.$$intercepted=a;d.$$interceptor=b;d.literal=a.literal;d.oneTime=a.oneTime;d.constant=a.constant;b.$stateful||(c=!a.inputs,d.inputs=a.inputs?a.inputs:[a],b.$$pure||(d.inputs=d.inputs.map(function(a){return a.isPure===Hd?function(b){return a(b)}:a})));return p(d)}var G={csp:Ba().noUnsafeEval,literals:Ia(b),isIdentifierStart:B(d)&&d,isIdentifierContinue:B(c)&&
            c};f.$$getAst=function(a){var b=new Ob(G);return(new Nb(b,e,G)).getAst(a).ast};return f}]}function bg(){var a=!0;this.$get=["$rootScope","$exceptionHandler",function(b,d){return Nd(function(a){b.$evalAsync(a)},d,a)}];this.errorOnUnhandledRejections=function(b){return w(b)?(a=b,this):a}}function cg(){var a=!0;this.$get=["$browser","$exceptionHandler",function(b,d){return Nd(function(a){b.defer(a)},d,a)}];this.errorOnUnhandledRejections=function(b){return w(b)?(a=b,this):a}}function Nd(a,b,d){function c(){return new e}
        function e(){var a=this.promise=new f;this.resolve=function(b){h(a,b)};this.reject=function(b){m(a,b)};this.notify=function(b){n(a,b)}}function f(){this.$$state={status:0}}function g(){for(;!w&&x.length;){var a=x.shift();if(!a.pur){a.pur=!0;var c=a.value,c="Possibly unhandled rejection: "+("function"===typeof c?c.toString().replace(/ \{[\s\S]*$/,""):A(c)?"undefined":"string"!==typeof c?Ne(c,void 0):c);dc(a.value)?b(a.value,c):b(c)}}}function k(c){!d||c.pending||2!==c.status||c.pur||(0===w&&0===x.length&&
        a(g),x.push(c));!c.processScheduled&&c.pending&&(c.processScheduled=!0,++w,a(function(){var e,f,k;k=c.pending;c.processScheduled=!1;c.pending=void 0;try{for(var l=0,n=k.length;l<n;++l){c.pur=!0;f=k[l][0];e=k[l][c.status];try{B(e)?h(f,e(c.value)):1===c.status?h(f,c.value):m(f,c.value)}catch(p){m(f,p),p&&!0===p.$$passToExceptionHandler&&b(p)}}}finally{--w,d&&0===w&&a(g)}}))}function h(a,b){a.$$state.status||(b===a?p(a,v("qcycle",b)):l(a,b))}function l(a,b){function c(b){g||(g=!0,l(a,b))}function d(b){g||
        (g=!0,p(a,b))}function e(b){n(a,b)}var f,g=!1;try{if(D(b)||B(b))f=b.then;B(f)?(a.$$state.status=-1,f.call(b,c,d,e)):(a.$$state.value=b,a.$$state.status=1,k(a.$$state))}catch(h){d(h)}}function m(a,b){a.$$state.status||p(a,b)}function p(a,b){a.$$state.value=b;a.$$state.status=2;k(a.$$state)}function n(c,d){var e=c.$$state.pending;0>=c.$$state.status&&e&&e.length&&a(function(){for(var a,c,f=0,g=e.length;f<g;f++){c=e[f][0];a=e[f][3];try{n(c,B(a)?a(d):d)}catch(h){b(h)}}})}function s(a){var b=new f;m(b,
            a);return b}function G(a,b,c){var d=null;try{B(c)&&(d=c())}catch(e){return s(e)}return d&&B(d.then)?d.then(function(){return b(a)},s):b(a)}function t(a,b,c,d){var e=new f;h(e,a);return e.then(b,c,d)}function q(a){if(!B(a))throw v("norslvr",a);var b=new f;a(function(a){h(b,a)},function(a){m(b,a)});return b}var v=F("$q",TypeError),w=0,x=[];S(f.prototype,{then:function(a,b,c){if(A(a)&&A(b)&&A(c))return this;var d=new f;this.$$state.pending=this.$$state.pending||[];this.$$state.pending.push([d,a,b,c]);
                0<this.$$state.status&&k(this.$$state);return d},"catch":function(a){return this.then(null,a)},"finally":function(a,b){return this.then(function(b){return G(b,y,a)},function(b){return G(b,s,a)},b)}});var y=t;q.prototype=f.prototype;q.defer=c;q.reject=s;q.when=t;q.resolve=y;q.all=function(a){var b=new f,c=0,d=H(a)?[]:{};r(a,function(a,e){c++;t(a).then(function(a){d[e]=a;--c||h(b,d)},function(a){m(b,a)})});0===c&&h(b,d);return b};q.race=function(a){var b=c();r(a,function(a){t(a).then(b.resolve,b.reject)});
            return b.promise};return q}function mg(){this.$get=["$window","$timeout",function(a,b){var d=a.requestAnimationFrame||a.webkitRequestAnimationFrame,c=a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.webkitCancelRequestAnimationFrame,e=!!d,f=e?function(a){var b=d(a);return function(){c(b)}}:function(a){var c=b(a,16.66,!1);return function(){b.cancel(c)}};f.supported=e;return f}]}function ag(){function a(a){function b(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null;
        this.$$listeners={};this.$$listenerCount={};this.$$watchersCount=0;this.$id=++qb;this.$$ChildScope=null;this.$$suspended=!1}b.prototype=a;return b}var b=10,d=F("$rootScope"),c=null,e=null;this.digestTtl=function(a){arguments.length&&(b=a);return b};this.$get=["$exceptionHandler","$parse","$browser",function(f,g,k){function h(a){a.currentScope.$$destroyed=!0}function l(a){9===wa&&(a.$$childHead&&l(a.$$childHead),a.$$nextSibling&&l(a.$$nextSibling));a.$parent=a.$$nextSibling=a.$$prevSibling=a.$$childHead=
        a.$$childTail=a.$root=a.$$watchers=null}function m(){this.$id=++qb;this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null;this.$root=this;this.$$suspended=this.$$destroyed=!1;this.$$listeners={};this.$$listenerCount={};this.$$watchersCount=0;this.$$isolateBindings=null}function p(a){if(v.$$phase)throw d("inprog",v.$$phase);v.$$phase=a}function n(a,b){do a.$$watchersCount+=b;while(a=a.$parent)}function s(a,b,c){do a.$$listenerCount[c]-=
        b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c];while(a=a.$parent)}function G(){}function t(){for(;y.length;)try{y.shift()()}catch(a){f(a)}e=null}function q(){null===e&&(e=k.defer(function(){v.$apply(t)},null,"$applyAsync"))}m.prototype={constructor:m,$new:function(b,c){var d;c=c||this;b?(d=new m,d.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=a(this)),d=new this.$$ChildScope);d.$parent=c;d.$$prevSibling=c.$$childTail;c.$$childHead?(c.$$childTail.$$nextSibling=d,c.$$childTail=d):
            c.$$childHead=c.$$childTail=d;(b||c!==this)&&d.$on("$destroy",h);return d},$watch:function(a,b,d,e){var f=g(a);b=B(b)?b:E;if(f.$$watchDelegate)return f.$$watchDelegate(this,b,d,f,a);var h=this,k=h.$$watchers,l={fn:b,last:G,get:f,exp:e||a,eq:!!d};c=null;k||(k=h.$$watchers=[],k.$$digestWatchIndex=-1);k.unshift(l);k.$$digestWatchIndex++;n(this,1);return function(){var a=cb(k,l);0<=a&&(n(h,-1),a<k.$$digestWatchIndex&&k.$$digestWatchIndex--);c=null}},$watchGroup:function(a,b){function c(){h=!1;try{k?(k=
            !1,b(e,e,g)):b(e,d,g)}finally{for(var f=0;f<a.length;f++)d[f]=e[f]}}var d=Array(a.length),e=Array(a.length),f=[],g=this,h=!1,k=!0;if(!a.length){var l=!0;g.$evalAsync(function(){l&&b(e,e,g)});return function(){l=!1}}if(1===a.length)return this.$watch(a[0],function(a,c,f){e[0]=a;d[0]=c;b(e,a===c?e:d,f)});r(a,function(a,b){var d=g.$watch(a,function(a){e[b]=a;h||(h=!0,g.$evalAsync(c))});f.push(d)});return function(){for(;f.length;)f.shift()()}},$watchCollection:function(a,b){function c(a){e=a;var b,d,
            g,h;if(!A(e)){if(D(e))if(za(e))for(f!==n&&(f=n,t=f.length=0,l++),a=e.length,t!==a&&(l++,f.length=t=a),b=0;b<a;b++)h=f[b],g=e[b],d=h!==h&&g!==g,d||h===g||(l++,f[b]=g);else{f!==p&&(f=p={},t=0,l++);a=0;for(b in e)ta.call(e,b)&&(a++,g=e[b],h=f[b],b in f?(d=h!==h&&g!==g,d||h===g||(l++,f[b]=g)):(t++,f[b]=g,l++));if(t>a)for(b in l++,f)ta.call(e,b)||(t--,delete f[b])}else f!==e&&(f=e,l++);return l}}c.$$pure=g(a).literal;c.$stateful=!c.$$pure;var d=this,e,f,h,k=1<b.length,l=0,m=g(a,c),n=[],p={},s=!0,t=0;return this.$watch(m,
            function(){s?(s=!1,b(e,e,d)):b(e,h,d);if(k)if(D(e))if(za(e)){h=Array(e.length);for(var a=0;a<e.length;a++)h[a]=e[a]}else for(a in h={},e)ta.call(e,a)&&(h[a]=e[a]);else h=e})},$digest:function(){var a,g,h,l,m,n,s,r=b,q,y=w.length?v:this,N=[],A,z;p("$digest");k.$$checkUrlChange();this===v&&null!==e&&(k.defer.cancel(e),t());c=null;do{s=!1;q=y;for(n=0;n<w.length;n++){try{z=w[n],l=z.fn,l(z.scope,z.locals)}catch(C){f(C)}c=null}w.length=0;a:do{if(n=!q.$$suspended&&q.$$watchers)for(n.$$digestWatchIndex=n.length;n.$$digestWatchIndex--;)try{if(a=
            n[n.$$digestWatchIndex])if(m=a.get,(g=m(q))!==(h=a.last)&&!(a.eq?va(g,h):Y(g)&&Y(h)))s=!0,c=a,a.last=a.eq?Ia(g,null):g,l=a.fn,l(g,h===G?g:h,q),5>r&&(A=4-r,N[A]||(N[A]=[]),N[A].push({msg:B(a.exp)?"fn: "+(a.exp.name||a.exp.toString()):a.exp,newVal:g,oldVal:h}));else if(a===c){s=!1;break a}}catch(E){f(E)}if(!(n=!q.$$suspended&&q.$$watchersCount&&q.$$childHead||q!==y&&q.$$nextSibling))for(;q!==y&&!(n=q.$$nextSibling);)q=q.$parent}while(q=n);if((s||w.length)&&!r--)throw v.$$phase=null,d("infdig",b,N);
        }while(s||w.length);for(v.$$phase=null;J<x.length;)try{x[J++]()}catch(D){f(D)}x.length=J=0;k.$$checkUrlChange()},$suspend:function(){this.$$suspended=!0},$isSuspended:function(){return this.$$suspended},$resume:function(){this.$$suspended=!1},$destroy:function(){if(!this.$$destroyed){var a=this.$parent;this.$broadcast("$destroy");this.$$destroyed=!0;this===v&&k.$$applicationDestroyed();n(this,-this.$$watchersCount);for(var b in this.$$listenerCount)s(this,this.$$listenerCount[b],b);a&&a.$$childHead===
        this&&(a.$$childHead=this.$$nextSibling);a&&a.$$childTail===this&&(a.$$childTail=this.$$prevSibling);this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling);this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling);this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=E;this.$on=this.$watch=this.$watchGroup=function(){return E};this.$$listeners={};this.$$nextSibling=null;l(this)}},$eval:function(a,b){return g(a)(this,b)},$evalAsync:function(a,b){v.$$phase||
        w.length||k.defer(function(){w.length&&v.$digest()},null,"$evalAsync");w.push({scope:this,fn:g(a),locals:b})},$$postDigest:function(a){x.push(a)},$apply:function(a){try{p("$apply");try{return this.$eval(a)}finally{v.$$phase=null}}catch(b){f(b)}finally{try{v.$digest()}catch(c){throw f(c),c;}}},$applyAsync:function(a){function b(){c.$eval(a)}var c=this;a&&y.push(b);a=g(a);q()},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]);c.push(b);var d=this;do d.$$listenerCount[a]||(d.$$listenerCount[a]=
            0),d.$$listenerCount[a]++;while(d=d.$parent);var e=this;return function(){var d=c.indexOf(b);-1!==d&&(delete c[d],s(e,1,a))}},$emit:function(a,b){var c=[],d,e=this,g=!1,h={name:a,targetScope:e,stopPropagation:function(){g=!0},preventDefault:function(){h.defaultPrevented=!0},defaultPrevented:!1},k=db([h],arguments,1),l,m;do{d=e.$$listeners[a]||c;h.currentScope=e;l=0;for(m=d.length;l<m;l++)if(d[l])try{d[l].apply(null,k)}catch(n){f(n)}else d.splice(l,1),l--,m--;if(g)break;e=e.$parent}while(e);h.currentScope=
            null;return h},$broadcast:function(a,b){var c=this,d=this,e={name:a,targetScope:this,preventDefault:function(){e.defaultPrevented=!0},defaultPrevented:!1};if(!this.$$listenerCount[a])return e;for(var g=db([e],arguments,1),h,k;c=d;){e.currentScope=c;d=c.$$listeners[a]||[];h=0;for(k=d.length;h<k;h++)if(d[h])try{d[h].apply(null,g)}catch(l){f(l)}else d.splice(h,1),h--,k--;if(!(d=c.$$listenerCount[a]&&c.$$childHead||c!==this&&c.$$nextSibling))for(;c!==this&&!(d=c.$$nextSibling);)c=c.$parent}e.currentScope=
            null;return e}};var v=new m,w=v.$$asyncQueue=[],x=v.$$postDigestQueue=[],y=v.$$applyAsyncQueue=[],J=0;return v}]}function Qe(){var a=/^\s*(https?|s?ftp|mailto|tel|file):/,b=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(b){return w(b)?(a=b,this):a};this.imgSrcSanitizationWhitelist=function(a){return w(a)?(b=a,this):b};this.$get=function(){return function(d,c){var e=c?b:a,f=ga(d&&d.trim()).href;return""===f||f.match(e)?d:"unsafe:"+f}}}function Xg(a){if("self"===
        a)return a;if(C(a)){if(-1<a.indexOf("***"))throw Ea("iwcard",a);a=Od(a).replace(/\\\*\\\*/g,".*").replace(/\\\*/g,"[^:/.?&;]*");return new RegExp("^"+a+"$")}if(ab(a))return new RegExp("^"+a.source+"$");throw Ea("imatcher");}function Pd(a){var b=[];w(a)&&r(a,function(a){b.push(Xg(a))});return b}function eg(){this.SCE_CONTEXTS=W;var a=["self"],b=[];this.resourceUrlWhitelist=function(b){arguments.length&&(a=Pd(b));return a};this.resourceUrlBlacklist=function(a){arguments.length&&(b=Pd(a));return b};
        this.$get=["$injector","$$sanitizeUri",function(d,c){function e(a,b){var c;"self"===a?(c=Cc(b,Qd))||(z.document.baseURI?c=z.document.baseURI:(Na||(Na=z.document.createElement("a"),Na.href=".",Na=Na.cloneNode(!1)),c=Na.href),c=Cc(b,c)):c=!!a.exec(b.href);return c}function f(a){var b=function(a){this.$$unwrapTrustedValue=function(){return a}};a&&(b.prototype=new a);b.prototype.valueOf=function(){return this.$$unwrapTrustedValue()};b.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()};
            return b}var g=function(a){throw Ea("unsafe");};d.has("$sanitize")&&(g=d.get("$sanitize"));var k=f(),h={};h[W.HTML]=f(k);h[W.CSS]=f(k);h[W.MEDIA_URL]=f(k);h[W.URL]=f(h[W.MEDIA_URL]);h[W.JS]=f(k);h[W.RESOURCE_URL]=f(h[W.URL]);return{trustAs:function(a,b){var c=h.hasOwnProperty(a)?h[a]:null;if(!c)throw Ea("icontext",a,b);if(null===b||A(b)||""===b)return b;if("string"!==typeof b)throw Ea("itype",a);return new c(b)},getTrusted:function(d,f){if(null===f||A(f)||""===f)return f;var k=h.hasOwnProperty(d)?
                h[d]:null;if(k&&f instanceof k)return f.$$unwrapTrustedValue();B(f.$$unwrapTrustedValue)&&(f=f.$$unwrapTrustedValue());if(d===W.MEDIA_URL||d===W.URL)return c(f.toString(),d===W.MEDIA_URL);if(d===W.RESOURCE_URL){var k=ga(f.toString()),n,s,r=!1;n=0;for(s=a.length;n<s;n++)if(e(a[n],k)){r=!0;break}if(r)for(n=0,s=b.length;n<s;n++)if(e(b[n],k)){r=!1;break}if(r)return f;throw Ea("insecurl",f.toString());}if(d===W.HTML)return g(f);throw Ea("unsafe");},valueOf:function(a){return a instanceof k?a.$$unwrapTrustedValue():
                a}}}]}function dg(){var a=!0;this.enabled=function(b){arguments.length&&(a=!!b);return a};this.$get=["$parse","$sceDelegate",function(b,d){if(a&&8>wa)throw Ea("iequirks");var c=ja(W);c.isEnabled=function(){return a};c.trustAs=d.trustAs;c.getTrusted=d.getTrusted;c.valueOf=d.valueOf;a||(c.trustAs=c.getTrusted=function(a,b){return b},c.valueOf=Ta);c.parseAs=function(a,d){var e=b(d);return e.literal&&e.constant?e:b(d,function(b){return c.getTrusted(a,b)})};var e=c.parseAs,f=c.getTrusted,g=c.trustAs;r(W,
        function(a,b){var d=K(b);c[("parse_as_"+d).replace(Dc,xb)]=function(b){return e(a,b)};c[("get_trusted_"+d).replace(Dc,xb)]=function(b){return f(a,b)};c[("trust_as_"+d).replace(Dc,xb)]=function(b){return g(a,b)}});return c}]}function fg(){this.$get=["$window","$document",function(a,b){var d={},c=!((!a.nw||!a.nw.process)&&a.chrome&&(a.chrome.app&&a.chrome.app.runtime||!a.chrome.app&&a.chrome.runtime&&a.chrome.runtime.id))&&a.history&&a.history.pushState,e=fa((/android (\d+)/.exec(K((a.navigator||{}).userAgent))||
        [])[1]),f=/Boxee/i.test((a.navigator||{}).userAgent),g=b[0]||{},k=g.body&&g.body.style,h=!1,l=!1;k&&(h=!!("transition"in k||"webkitTransition"in k),l=!!("animation"in k||"webkitAnimation"in k));return{history:!(!c||4>e||f),hasEvent:function(a){if("input"===a&&wa)return!1;if(A(d[a])){var b=g.createElement("div");d[a]="on"+a in b}return d[a]},csp:Ba(),transitions:h,animations:l,android:e}}]}function gg(){this.$get=ia(function(a){return new Yg(a)})}function Yg(a){function b(){var a=e.pop();return a&&
        a.cb}function d(a){for(var b=e.length-1;0<=b;--b){var c=e[b];if(c.type===a)return e.splice(b,1),c.cb}}var c={},e=[],f=this.ALL_TASKS_TYPE="$$all$$",g=this.DEFAULT_TASK_TYPE="$$default$$";this.completeTask=function(e,h){h=h||g;try{e()}finally{var l;l=h||g;c[l]&&(c[l]--,c[f]--);l=c[h];var m=c[f];if(!m||!l)for(l=m?d:b;m=l(h);)try{m()}catch(p){a.error(p)}}};this.incTaskCount=function(a){a=a||g;c[a]=(c[a]||0)+1;c[f]=(c[f]||0)+1};this.notifyWhenNoPendingTasks=function(a,b){b=b||f;c[b]?e.push({type:b,cb:a}):
        a()}}function ig(){var a;this.httpOptions=function(b){return b?(a=b,this):a};this.$get=["$exceptionHandler","$templateCache","$http","$q","$sce",function(b,d,c,e,f){function g(k,h){g.totalPendingRequests++;if(!C(k)||A(d.get(k)))k=f.getTrustedResourceUrl(k);var l=c.defaults&&c.defaults.transformResponse;H(l)?l=l.filter(function(a){return a!==wc}):l===wc&&(l=null);return c.get(k,S({cache:d,transformResponse:l},a)).finally(function(){g.totalPendingRequests--}).then(function(a){return d.put(k,a.data)},
        function(a){h||(a=Zg("tpload",k,a.status,a.statusText),b(a));return e.reject(a)})}g.totalPendingRequests=0;return g}]}function jg(){this.$get=["$rootScope","$browser","$location",function(a,b,d){return{findBindings:function(a,b,d){a=a.getElementsByClassName("ng-binding");var g=[];r(a,function(a){var c=ca.element(a).data("$binding");c&&r(c,function(c){d?(new RegExp("(^|\\s)"+Od(b)+"(\\s|\\||$)")).test(c)&&g.push(a):-1!==c.indexOf(b)&&g.push(a)})});return g},findModels:function(a,b,d){for(var g=["ng-",
            "data-ng-","ng\\:"],k=0;k<g.length;++k){var h=a.querySelectorAll("["+g[k]+"model"+(d?"=":"*=")+'"'+b+'"]');if(h.length)return h}},getLocation:function(){return d.url()},setLocation:function(b){b!==d.url()&&(d.url(b),a.$digest())},whenStable:function(a){b.notifyWhenNoOutstandingRequests(a)}}}]}function kg(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(a,b,d,c,e){function f(f,h,l){B(f)||(l=h,h=f,f=E);var m=Ha.call(arguments,3),p=w(l)&&!l,n=(p?c:d).defer(),s=n.promise,r;
        r=b.defer(function(){try{n.resolve(f.apply(null,m))}catch(b){n.reject(b),e(b)}finally{delete g[s.$$timeoutId]}p||a.$apply()},h,"$timeout");s.$$timeoutId=r;g[r]=n;return s}var g={};f.cancel=function(a){if(!a)return!1;if(!a.hasOwnProperty("$$timeoutId"))throw $g("badprom");if(!g.hasOwnProperty(a.$$timeoutId))return!1;a=a.$$timeoutId;var c=g[a],d=c.promise;d.$$state&&(d.$$state.pur=!0);c.reject("canceled");delete g[a];return b.defer.cancel(a)};return f}]}function ga(a){if(!C(a))return a;wa&&(aa.setAttribute("href",
        a),a=aa.href);aa.setAttribute("href",a);a=aa.hostname;!ah&&-1<a.indexOf(":")&&(a="["+a+"]");return{href:aa.href,protocol:aa.protocol?aa.protocol.replace(/:$/,""):"",host:aa.host,search:aa.search?aa.search.replace(/^\?/,""):"",hash:aa.hash?aa.hash.replace(/^#/,""):"",hostname:a,port:aa.port,pathname:"/"===aa.pathname.charAt(0)?aa.pathname:"/"+aa.pathname}}function Og(a){var b=[Qd].concat(a.map(ga));return function(a){a=ga(a);return b.some(Cc.bind(null,a))}}function Cc(a,b){a=ga(a);b=ga(b);return a.protocol===
        b.protocol&&a.host===b.host}function lg(){this.$get=ia(z)}function Rd(a){function b(a){try{return decodeURIComponent(a)}catch(b){return a}}var d=a[0]||{},c={},e="";return function(){var a,g,k,h,l;try{a=d.cookie||""}catch(m){a=""}if(a!==e)for(e=a,a=e.split("; "),c={},k=0;k<a.length;k++)g=a[k],h=g.indexOf("="),0<h&&(l=b(g.substring(0,h)),A(c[l])&&(c[l]=b(g.substring(h+1))));return c}}function pg(){this.$get=Rd}function fd(a){function b(d,c){if(D(d)){var e={};r(d,function(a,c){e[c]=b(c,a)});return e}return a.factory(d+
        "Filter",c)}this.register=b;this.$get=["$injector",function(a){return function(b){return a.get(b+"Filter")}}];b("currency",Sd);b("date",Td);b("filter",bh);b("json",ch);b("limitTo",dh);b("lowercase",eh);b("number",Ud);b("orderBy",Vd);b("uppercase",fh)}function bh(){return function(a,b,d,c){if(!za(a)){if(null==a)return a;throw F("filter")("notarray",a);}c=c||"$";var e;switch(Ec(b)){case "function":break;case "boolean":case "null":case "number":case "string":e=!0;case "object":b=gh(b,d,c,e);break;default:return a}return Array.prototype.filter.call(a,
        b)}}function gh(a,b,d,c){var e=D(a)&&d in a;!0===b?b=va:B(b)||(b=function(a,b){if(A(a))return!1;if(null===a||null===b)return a===b;if(D(b)||D(a)&&!cc(a))return!1;a=K(""+a);b=K(""+b);return-1!==a.indexOf(b)});return function(f){return e&&!D(f)?Fa(f,a[d],b,d,!1):Fa(f,a,b,d,c)}}function Fa(a,b,d,c,e,f){var g=Ec(a),k=Ec(b);if("string"===k&&"!"===b.charAt(0))return!Fa(a,b.substring(1),d,c,e);if(H(a))return a.some(function(a){return Fa(a,b,d,c,e)});switch(g){case "object":var h;if(e){for(h in a)if(h.charAt&&
        "$"!==h.charAt(0)&&Fa(a[h],b,d,c,!0))return!0;return f?!1:Fa(a,b,d,c,!1)}if("object"===k){for(h in b)if(f=b[h],!B(f)&&!A(f)&&(g=h===c,!Fa(g?a:a[h],f,d,c,g,g)))return!1;return!0}return d(a,b);case "function":return!1;default:return d(a,b)}}function Ec(a){return null===a?"null":typeof a}function Sd(a){var b=a.NUMBER_FORMATS;return function(a,c,e){A(c)&&(c=b.CURRENCY_SYM);A(e)&&(e=b.PATTERNS[1].maxFrac);var f=c?/\u00A4/g:/\s*\u00A4\s*/g;return null==a?a:Wd(a,b.PATTERNS[1],b.GROUP_SEP,b.DECIMAL_SEP,e).replace(f,
        c)}}function Ud(a){var b=a.NUMBER_FORMATS;return function(a,c){return null==a?a:Wd(a,b.PATTERNS[0],b.GROUP_SEP,b.DECIMAL_SEP,c)}}function hh(a){var b=0,d,c,e,f,g;-1<(c=a.indexOf(Xd))&&(a=a.replace(Xd,""));0<(e=a.search(/e/i))?(0>c&&(c=e),c+=+a.slice(e+1),a=a.substring(0,e)):0>c&&(c=a.length);for(e=0;a.charAt(e)===Fc;e++);if(e===(g=a.length))d=[0],c=1;else{for(g--;a.charAt(g)===Fc;)g--;c-=e;d=[];for(f=0;e<=g;e++,f++)d[f]=+a.charAt(e)}c>Yd&&(d=d.splice(0,Yd-1),b=c-1,c=1);return{d:d,e:b,i:c}}function ih(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  b,d,c){var e=a.d,f=e.length-a.i;b=A(b)?Math.min(Math.max(d,f),c):+b;d=b+a.i;c=e[d];if(0<d){e.splice(Math.max(a.i,d));for(var g=d;g<e.length;g++)e[g]=0}else for(f=Math.max(0,f),a.i=1,e.length=Math.max(1,d=b+1),e[0]=0,g=1;g<d;g++)e[g]=0;if(5<=c)if(0>d-1){for(c=0;c>d;c--)e.unshift(0),a.i++;e.unshift(1);a.i++}else e[d-1]++;for(;f<Math.max(0,b);f++)e.push(0);if(b=e.reduceRight(function(a,b,c,d){b+=a;d[c]=b%10;return Math.floor(b/10)},0))e.unshift(b),a.i++}function Wd(a,b,d,c,e){if(!C(a)&&!X(a)||isNaN(a))return"";
        var f=!isFinite(a),g=!1,k=Math.abs(a)+"",h="";if(f)h="\u221e";else{g=hh(k);ih(g,e,b.minFrac,b.maxFrac);h=g.d;k=g.i;e=g.e;f=[];for(g=h.reduce(function(a,b){return a&&!b},!0);0>k;)h.unshift(0),k++;0<k?f=h.splice(k,h.length):(f=h,h=[0]);k=[];for(h.length>=b.lgSize&&k.unshift(h.splice(-b.lgSize,h.length).join(""));h.length>b.gSize;)k.unshift(h.splice(-b.gSize,h.length).join(""));h.length&&k.unshift(h.join(""));h=k.join(d);f.length&&(h+=c+f.join(""));e&&(h+="e+"+e)}return 0>a&&!g?b.negPre+h+b.negSuf:b.posPre+
            h+b.posSuf}function Pb(a,b,d,c){var e="";if(0>a||c&&0>=a)c?a=-a+1:(a=-a,e="-");for(a=""+a;a.length<b;)a=Fc+a;d&&(a=a.substr(a.length-b));return e+a}function ea(a,b,d,c,e){d=d||0;return function(f){f=f["get"+a]();if(0<d||f>-d)f+=d;0===f&&-12===d&&(f=12);return Pb(f,b,c,e)}}function lb(a,b,d){return function(c,e){var f=c["get"+a](),g=vb((d?"STANDALONE":"")+(b?"SHORT":"")+a);return e[g][f]}}function Zd(a){var b=(new Date(a,0,1)).getDay();return new Date(a,0,(4>=b?5:12)-b)}function $d(a){return function(b){var d=
        Zd(b.getFullYear());b=+new Date(b.getFullYear(),b.getMonth(),b.getDate()+(4-b.getDay()))-+d;b=1+Math.round(b/6048E5);return Pb(b,a)}}function Gc(a,b){return 0>=a.getFullYear()?b.ERAS[0]:b.ERAS[1]}function Td(a){function b(a){var b;if(b=a.match(d)){a=new Date(0);var f=0,g=0,k=b[8]?a.setUTCFullYear:a.setFullYear,h=b[8]?a.setUTCHours:a.setHours;b[9]&&(f=fa(b[9]+b[10]),g=fa(b[9]+b[11]));k.call(a,fa(b[1]),fa(b[2])-1,fa(b[3]));f=fa(b[4]||0)-f;g=fa(b[5]||0)-g;k=fa(b[6]||0);b=Math.round(1E3*parseFloat("0."+
        (b[7]||0)));h.call(a,f,g,k,b)}return a}var d=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(c,d,f){var g="",k=[],h,l;d=d||"mediumDate";d=a.DATETIME_FORMATS[d]||d;C(c)&&(c=jh.test(c)?fa(c):b(c));X(c)&&(c=new Date(c));if(!ha(c)||!isFinite(c.getTime()))return c;for(;d;)(l=kh.exec(d))?(k=db(k,l,1),d=k.pop()):(k.push(d),d=null);var m=c.getTimezoneOffset();f&&(m=fc(f,m),c=gc(c,f,!0));r(k,function(b){h=lh[b];g+=h?h(c,a.DATETIME_FORMATS,
        m):"''"===b?"'":b.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return g}}function ch(){return function(a,b){A(b)&&(b=2);return eb(a,b)}}function dh(){return function(a,b,d){b=Infinity===Math.abs(Number(b))?Number(b):fa(b);if(Y(b))return a;X(a)&&(a=a.toString());if(!za(a))return a;d=!d||isNaN(d)?0:fa(d);d=0>d?Math.max(0,a.length+d):d;return 0<=b?Hc(a,d,d+b):0===d?Hc(a,b,a.length):Hc(a,Math.max(0,d+b),d)}}function Hc(a,b,d){return C(a)?a.slice(b,d):Ha.call(a,b,d)}function Vd(a){function b(b){return b.map(function(b){var c=
        1,d=Ta;if(B(b))d=b;else if(C(b)){if("+"===b.charAt(0)||"-"===b.charAt(0))c="-"===b.charAt(0)?-1:1,b=b.substring(1);if(""!==b&&(d=a(b),d.constant))var e=d(),d=function(a){return a[e]}}return{get:d,descending:c}})}function d(a){switch(typeof a){case "number":case "boolean":case "string":return!0;default:return!1}}function c(a,b){var c=0,d=a.type,h=b.type;if(d===h){var h=a.value,l=b.value;"string"===d?(h=h.toLowerCase(),l=l.toLowerCase()):"object"===d&&(D(h)&&(h=a.index),D(l)&&(l=b.index));h!==l&&(c=
        h<l?-1:1)}else c="undefined"===d?1:"undefined"===h?-1:"null"===d?1:"null"===h?-1:d<h?-1:1;return c}return function(a,f,g,k){if(null==a)return a;if(!za(a))throw F("orderBy")("notarray",a);H(f)||(f=[f]);0===f.length&&(f=["+"]);var h=b(f),l=g?-1:1,m=B(k)?k:c;a=Array.prototype.map.call(a,function(a,b){return{value:a,tieBreaker:{value:b,type:"number",index:b},predicateValues:h.map(function(c){var e=c.get(a);c=typeof e;if(null===e)c="null";else if("object"===c)a:{if(B(e.valueOf)&&(e=e.valueOf(),d(e)))break a;
            cc(e)&&(e=e.toString(),d(e))}return{value:e,type:c,index:b}})}});a.sort(function(a,b){for(var d=0,e=h.length;d<e;d++){var f=m(a.predicateValues[d],b.predicateValues[d]);if(f)return f*h[d].descending*l}return(m(a.tieBreaker,b.tieBreaker)||c(a.tieBreaker,b.tieBreaker))*l});return a=a.map(function(a){return a.value})}}function Ra(a){B(a)&&(a={link:a});a.restrict=a.restrict||"AC";return ia(a)}function Qb(a,b,d,c,e){this.$$controls=[];this.$error={};this.$$success={};this.$pending=void 0;this.$name=e(b.name||
        b.ngForm||"")(d);this.$dirty=!1;this.$valid=this.$pristine=!0;this.$submitted=this.$invalid=!1;this.$$parentForm=mb;this.$$element=a;this.$$animate=c;ae(this)}function ae(a){a.$$classCache={};a.$$classCache[be]=!(a.$$classCache[nb]=a.$$element.hasClass(nb))}function ce(a){function b(a,b,c){c&&!a.$$classCache[b]?(a.$$animate.addClass(a.$$element,b),a.$$classCache[b]=!0):!c&&a.$$classCache[b]&&(a.$$animate.removeClass(a.$$element,b),a.$$classCache[b]=!1)}function d(a,c,d){c=c?"-"+Xc(c,"-"):"";b(a,nb+
        c,!0===d);b(a,be+c,!1===d)}var c=a.set,e=a.unset;a.clazz.prototype.$setValidity=function(a,g,k){A(g)?(this.$pending||(this.$pending={}),c(this.$pending,a,k)):(this.$pending&&e(this.$pending,a,k),de(this.$pending)&&(this.$pending=void 0));Ga(g)?g?(e(this.$error,a,k),c(this.$$success,a,k)):(c(this.$error,a,k),e(this.$$success,a,k)):(e(this.$error,a,k),e(this.$$success,a,k));this.$pending?(b(this,"ng-pending",!0),this.$valid=this.$invalid=void 0,d(this,"",null)):(b(this,"ng-pending",!1),this.$valid=
        de(this.$error),this.$invalid=!this.$valid,d(this,"",this.$valid));g=this.$pending&&this.$pending[a]?void 0:this.$error[a]?!1:this.$$success[a]?!0:null;d(this,a,g);this.$$parentForm.$setValidity(a,g,this)}}function de(a){if(a)for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function Ic(a){a.$formatters.push(function(b){return a.$isEmpty(b)?b:b.toString()})}function Sa(a,b,d,c,e,f){var g=K(b[0].type);if(!e.android){var k=!1;b.on("compositionstart",function(){k=!0});b.on("compositionupdate",
        function(a){if(A(a.data)||""===a.data)k=!1});b.on("compositionend",function(){k=!1;l()})}var h,l=function(a){h&&(f.defer.cancel(h),h=null);if(!k){var e=b.val();a=a&&a.type;"password"===g||d.ngTrim&&"false"===d.ngTrim||(e=V(e));(c.$viewValue!==e||""===e&&c.$$hasNativeValidators)&&c.$setViewValue(e,a)}};if(e.hasEvent("input"))b.on("input",l);else{var m=function(a,b,c){h||(h=f.defer(function(){h=null;b&&b.value===c||l(a)}))};b.on("keydown",function(a){var b=a.keyCode;91===b||15<b&&19>b||37<=b&&40>=b||
    m(a,this,this.value)});if(e.hasEvent("paste"))b.on("paste cut drop",m)}b.on("change",l);if(ee[g]&&c.$$hasNativeValidators&&g===d.type)b.on("keydown wheel mousedown",function(a){if(!h){var b=this.validity,c=b.badInput,d=b.typeMismatch;h=f.defer(function(){h=null;b.badInput===c&&b.typeMismatch===d||l(a)})}});c.$render=function(){var a=c.$isEmpty(c.$viewValue)?"":c.$viewValue;b.val()!==a&&b.val(a)}}function Rb(a,b){return function(d,c){var e,f;if(ha(d))return d;if(C(d)){'"'===d.charAt(0)&&'"'===d.charAt(d.length-
        1)&&(d=d.substring(1,d.length-1));if(mh.test(d))return new Date(d);a.lastIndex=0;if(e=a.exec(d))return e.shift(),f=c?{yyyy:c.getFullYear(),MM:c.getMonth()+1,dd:c.getDate(),HH:c.getHours(),mm:c.getMinutes(),ss:c.getSeconds(),sss:c.getMilliseconds()/1E3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},r(e,function(a,c){c<b.length&&(f[b[c]]=+a)}),e=new Date(f.yyyy,f.MM-1,f.dd,f.HH,f.mm,f.ss||0,1E3*f.sss||0),100>f.yyyy&&e.setFullYear(f.yyyy),e}return NaN}}function ob(a,b,d,c){return function(e,f,g,k,h,l,m,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                p){function n(a){return a&&!(a.getTime&&a.getTime()!==a.getTime())}function s(a){return w(a)&&!ha(a)?r(a)||void 0:a}function r(a,b){var c=k.$options.getOption("timezone");v&&v!==c&&(b=Uc(b,fc(v)));var e=d(a,b);!isNaN(e)&&c&&(e=gc(e,c));return e}Jc(e,f,g,k,a);Sa(e,f,g,k,h,l);var t="time"===a||"datetimelocal"===a,q,v;k.$parsers.push(function(c){if(k.$isEmpty(c))return null;if(b.test(c))return r(c,q);k.$$parserName=a});k.$formatters.push(function(a){if(a&&!ha(a))throw pb("datefmt",a);if(n(a)){q=a;var b=
        k.$options.getOption("timezone");b&&(v=b,q=gc(q,b,!0));var d=c;t&&C(k.$options.getOption("timeSecondsFormat"))&&(d=c.replace("ss.sss",k.$options.getOption("timeSecondsFormat")).replace(/:$/,""));a=m("date")(a,d,b);t&&k.$options.getOption("timeStripZeroSeconds")&&(a=a.replace(/(?::00)?(?:\.000)?$/,""));return a}v=q=null;return""});if(w(g.min)||g.ngMin){var x=g.min||p(g.ngMin)(e),z=s(x);k.$validators.min=function(a){return!n(a)||A(z)||d(a)>=z};g.$observe("min",function(a){a!==x&&(z=s(a),x=a,k.$validate())})}if(w(g.max)||
        g.ngMax){var y=g.max||p(g.ngMax)(e),J=s(y);k.$validators.max=function(a){return!n(a)||A(J)||d(a)<=J};g.$observe("max",function(a){a!==y&&(J=s(a),y=a,k.$validate())})}}}function Jc(a,b,d,c,e){(c.$$hasNativeValidators=D(b[0].validity))&&c.$parsers.push(function(a){var d=b.prop("validity")||{};if(d.badInput||d.typeMismatch)c.$$parserName=e;else return a})}function fe(a){a.$parsers.push(function(b){if(a.$isEmpty(b))return null;if(nh.test(b))return parseFloat(b);a.$$parserName="number"});a.$formatters.push(function(b){if(!a.$isEmpty(b)){if(!X(b))throw pb("numfmt",
        b);b=b.toString()}return b})}function na(a){w(a)&&!X(a)&&(a=parseFloat(a));return Y(a)?void 0:a}function Kc(a){var b=a.toString(),d=b.indexOf(".");return-1===d?-1<a&&1>a&&(a=/e-(\d+)$/.exec(b))?Number(a[1]):0:b.length-d-1}function ge(a,b,d){a=Number(a);var c=(a|0)!==a,e=(b|0)!==b,f=(d|0)!==d;if(c||e||f){var g=c?Kc(a):0,k=e?Kc(b):0,h=f?Kc(d):0,g=Math.max(g,k,h),g=Math.pow(10,g);a*=g;b*=g;d*=g;c&&(a=Math.round(a));e&&(b=Math.round(b));f&&(d=Math.round(d))}return 0===(a-b)%d}function he(a,b,d,c,e){if(w(c)){a=
        a(c);if(!a.constant)throw pb("constexpr",d,c);return a(b)}return e}function Lc(a,b){function d(a,b){if(!a||!a.length)return[];if(!b||!b.length)return a;var c=[],d=0;a:for(;d<a.length;d++){for(var e=a[d],m=0;m<b.length;m++)if(e===b[m])continue a;c.push(e)}return c}function c(a){if(!a)return a;var b=a;H(a)?b=a.map(c).join(" "):D(a)?b=Object.keys(a).filter(function(b){return a[b]}).join(" "):C(a)||(b=a+"");return b}a="ngClass"+a;var e;return["$parse",function(f){return{restrict:"AC",link:function(g,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           k,h){function l(a,b){var c=[];r(a,function(a){if(0<b||p[a])p[a]=(p[a]||0)+b,p[a]===+(0<b)&&c.push(a)});return c.join(" ")}function m(a){if(a===b){var c=s,c=l(c&&c.split(" "),1);h.$addClass(c)}else c=s,c=l(c&&c.split(" "),-1),h.$removeClass(c);n=a}var p=k.data("$classCounts"),n=!0,s;p||(p=T(),k.data("$classCounts",p));"ngClass"!==a&&(e||(e=f("$index",function(a){return a&1})),g.$watch(e,m));g.$watch(f(h[a],c),function(a){if(n===b){var c=s&&s.split(" "),e=a&&a.split(" "),f=d(c,e),c=d(e,c),f=l(f,-1),
            c=l(c,1);h.$addClass(c);h.$removeClass(f)}s=a})}}}]}function sd(a,b,d,c,e,f){return{restrict:"A",compile:function(g,k){var h=a(k[c]);return function(a,c){c.on(e,function(c){var e=function(){h(a,{$event:c})};if(b.$$phase)if(f)a.$evalAsync(e);else try{e()}catch(g){d(g)}else a.$apply(e)})}}}}function Sb(a,b,d,c,e,f,g,k,h){this.$modelValue=this.$viewValue=Number.NaN;this.$$rawModelValue=void 0;this.$validators={};this.$asyncValidators={};this.$parsers=[];this.$formatters=[];this.$viewChangeListeners=
        [];this.$untouched=!0;this.$touched=!1;this.$pristine=!0;this.$dirty=!1;this.$valid=!0;this.$invalid=!1;this.$error={};this.$$success={};this.$pending=void 0;this.$name=h(d.name||"",!1)(a);this.$$parentForm=mb;this.$options=Tb;this.$$updateEvents="";this.$$updateEventHandler=this.$$updateEventHandler.bind(this);this.$$parsedNgModel=e(d.ngModel);this.$$parsedNgModelAssign=this.$$parsedNgModel.assign;this.$$ngModelGet=this.$$parsedNgModel;this.$$ngModelSet=this.$$parsedNgModelAssign;this.$$pendingDebounce=
        null;this.$$parserValid=void 0;this.$$parserName="parse";this.$$currentValidationRunId=0;this.$$scope=a;this.$$rootScope=a.$root;this.$$attr=d;this.$$element=c;this.$$animate=f;this.$$timeout=g;this.$$parse=e;this.$$q=k;this.$$exceptionHandler=b;ae(this);oh(this)}function oh(a){a.$$scope.$watch(function(b){b=a.$$ngModelGet(b);b===a.$modelValue||a.$modelValue!==a.$modelValue&&b!==b||a.$$setModelValue(b);return b})}function Mc(a){this.$$options=a}function ie(a,b){r(b,function(b,c){w(a[c])||(a[c]=b)})}
    function Oa(a,b){a.prop("selected",b);a.attr("selected",b)}function je(a,b,d){if(a){C(a)&&(a=new RegExp("^"+a+"$"));if(!a.test)throw F("ngPattern")("noregexp",b,a,Aa(d));return a}}function Ub(a){a=fa(a);return Y(a)?-1:a}var Xb={objectMaxDepth:5,urlErrorParamsEnabled:!0},ke=/^\/(.+)\/([a-z]*)$/,ta=Object.prototype.hasOwnProperty,K=function(a){return C(a)?a.toLowerCase():a},vb=function(a){return C(a)?a.toUpperCase():a},wa,x,sb,Ha=[].slice,Kg=[].splice,ph=[].push,la=Object.prototype.toString,Rc=Object.getPrototypeOf,
        oa=F("ng"),ca=z.angular||(z.angular={}),lc,qb=0;wa=z.document.documentMode;var Y=Number.isNaN||function(a){return a!==a};E.$inject=[];Ta.$inject=[];var ze=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array]$/,V=function(a){return C(a)?a.trim():a},Od=function(a){return a.replace(/([-()[\]{}+?*.$^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},Ba=function(){if(!w(Ba.rules)){var a=z.document.querySelector("[ng-csp]")||z.document.querySelector("[data-ng-csp]");if(a){var b=
        a.getAttribute("ng-csp")||a.getAttribute("data-ng-csp");Ba.rules={noUnsafeEval:!b||-1!==b.indexOf("no-unsafe-eval"),noInlineStyle:!b||-1!==b.indexOf("no-inline-style")}}else{a=Ba;try{new Function(""),b=!1}catch(d){b=!0}a.rules={noUnsafeEval:b,noInlineStyle:!1}}}return Ba.rules},rb=function(){if(w(rb.name_))return rb.name_;var a,b,d=Qa.length,c,e;for(b=0;b<d;++b)if(c=Qa[b],a=z.document.querySelector("["+c.replace(":","\\:")+"jq]")){e=a.getAttribute(c+"jq");break}return rb.name_=e},Be=/:/g,Qa=["ng-",
            "data-ng-","ng:","x-ng-"],Fe=function(a){var b=a.currentScript;if(!b)return!0;if(!(b instanceof z.HTMLScriptElement||b instanceof z.SVGScriptElement))return!1;b=b.attributes;return[b.getNamedItem("src"),b.getNamedItem("href"),b.getNamedItem("xlink:href")].every(function(b){if(!b)return!0;if(!b.value)return!1;var c=a.createElement("a");c.href=b.value;if(a.location.origin===c.origin)return!0;switch(c.protocol){case "http:":case "https:":case "ftp:":case "blob:":case "file:":case "data:":return!0;default:return!1}})}(z.document),
        Ie=/[A-Z]/g,Yc=!1,Pa=3,Pe={full:"1.8.0",major:1,minor:8,dot:0,codeName:"nested-vaccination"};U.expando="ng339";var Ka=U.cache={},ug=1;U._data=function(a){return this.cache[a[this.expando]]||{}};var qg=/-([a-z])/g,qh=/^-ms-/,Bb={mouseleave:"mouseout",mouseenter:"mouseover"},oc=F("jqLite"),tg=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,nc=/<|&#?\w+;/,rg=/<([\w:-]+)/,sg=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,qa={thead:["table"],col:["colgroup","table"],tr:["tbody","table"],td:["tr",
            "tbody","table"]};qa.tbody=qa.tfoot=qa.colgroup=qa.caption=qa.thead;qa.th=qa.td;var hb={option:[1,'<select multiple="multiple">',"</select>"],_default:[0,"",""]},Nc;for(Nc in qa){var le=qa[Nc],me=le.slice().reverse();hb[Nc]=[me.length,"<"+me.join("><")+">","</"+le.join("></")+">"]}hb.optgroup=hb.option;var zg=z.Node.prototype.contains||function(a){return!!(this.compareDocumentPosition(a)&16)},Wa=U.prototype={ready:hd,toString:function(){var a=[];r(this,function(b){a.push(""+b)});return"["+a.join(", ")+
            "]"},eq:function(a){return 0<=a?x(this[a]):x(this[this.length+a])},length:0,push:ph,sort:[].sort,splice:[].splice},Hb={};r("multiple selected checked disabled readOnly required open".split(" "),function(a){Hb[K(a)]=a});var od={};r("input select option textarea button form details".split(" "),function(a){od[a]=!0});var vd={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern",ngStep:"step"};r({data:sc,removeData:rc,hasData:function(a){for(var b in Ka[a.ng339])return!0;
            return!1},cleanData:function(a){for(var b=0,d=a.length;b<d;b++)rc(a[b]),kd(a[b])}},function(a,b){U[b]=a});r({data:sc,inheritedData:Fb,scope:function(a){return x.data(a,"$scope")||Fb(a.parentNode||a,["$isolateScope","$scope"])},isolateScope:function(a){return x.data(a,"$isolateScope")||x.data(a,"$isolateScopeNoTemplate")},controller:ld,injector:function(a){return Fb(a,"$injector")},removeAttr:function(a,b){a.removeAttribute(b)},hasClass:Cb,css:function(a,b,d){b=yb(b.replace(qh,"ms-"));if(w(d))a.style[b]=
            d;else return a.style[b]},attr:function(a,b,d){var c=a.nodeType;if(c!==Pa&&2!==c&&8!==c&&a.getAttribute){var c=K(b),e=Hb[c];if(w(d))null===d||!1===d&&e?a.removeAttribute(b):a.setAttribute(b,e?c:d);else return a=a.getAttribute(b),e&&null!==a&&(a=c),null===a?void 0:a}},prop:function(a,b,d){if(w(d))a[b]=d;else return a[b]},text:function(){function a(a,d){if(A(d)){var c=a.nodeType;return 1===c||c===Pa?a.textContent:""}a.textContent=d}a.$dv="";return a}(),val:function(a,b){if(A(b)){if(a.multiple&&"select"===
            ua(a)){var d=[];r(a.options,function(a){a.selected&&d.push(a.value||a.text)});return d}return a.value}a.value=b},html:function(a,b){if(A(b))return a.innerHTML;zb(a,!0);a.innerHTML=b},empty:md},function(a,b){U.prototype[b]=function(b,c){var e,f,g=this.length;if(a!==md&&A(2===a.length&&a!==Cb&&a!==ld?b:c)){if(D(b)){for(e=0;e<g;e++)if(a===sc)a(this[e],b);else for(f in b)a(this[e],f,b[f]);return this}e=a.$dv;g=A(e)?Math.min(g,1):g;for(f=0;f<g;f++){var k=a(this[f],b,c);e=e?e+k:k}return e}for(e=0;e<g;e++)a(this[e],
        b,c);return this}});r({removeData:rc,on:function(a,b,d,c){if(w(c))throw oc("onargs");if(mc(a)){c=Ab(a,!0);var e=c.events,f=c.handle;f||(f=c.handle=wg(a,e));c=0<=b.indexOf(" ")?b.split(" "):[b];for(var g=c.length,k=function(b,c,g){var k=e[b];k||(k=e[b]=[],k.specialHandlerWrapper=c,"$destroy"===b||g||a.addEventListener(b,f));k.push(d)};g--;)b=c[g],Bb[b]?(k(Bb[b],yg),k(b,void 0,!0)):k(b)}},off:kd,one:function(a,b,d){a=x(a);a.on(b,function e(){a.off(b,d);a.off(b,e)});a.on(b,d)},replaceWith:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            b){var d,c=a.parentNode;zb(a);r(new U(b),function(b){d?c.insertBefore(b,d.nextSibling):c.replaceChild(b,a);d=b})},children:function(a){var b=[];r(a.childNodes,function(a){1===a.nodeType&&b.push(a)});return b},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,b){var d=a.nodeType;if(1===d||11===d){b=new U(b);for(var d=0,c=b.length;d<c;d++)a.appendChild(b[d])}},prepend:function(a,b){if(1===a.nodeType){var d=a.firstChild;r(new U(b),function(b){a.insertBefore(b,d)})}},
        wrap:function(a,b){var d=x(b).eq(0).clone()[0],c=a.parentNode;c&&c.replaceChild(d,a);d.appendChild(a)},remove:Gb,detach:function(a){Gb(a,!0)},after:function(a,b){var d=a,c=a.parentNode;if(c){b=new U(b);for(var e=0,f=b.length;e<f;e++){var g=b[e];c.insertBefore(g,d.nextSibling);d=g}}},addClass:Eb,removeClass:Db,toggleClass:function(a,b,d){b&&r(b.split(" "),function(b){var e=d;A(e)&&(e=!Cb(a,b));(e?Eb:Db)(a,b)})},parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},next:function(a){return a.nextElementSibling},
        find:function(a,b){return a.getElementsByTagName?a.getElementsByTagName(b):[]},clone:qc,triggerHandler:function(a,b,d){var c,e,f=b.type||b,g=Ab(a);if(g=(g=g&&g.events)&&g[f])c={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===this.immediatePropagationStopped},stopPropagation:E,type:f,target:a},b.type&&(c=S(c,
            b)),b=ja(g),e=d?[c].concat(d):[c],r(b,function(b){c.isImmediatePropagationStopped()||b.apply(a,e)})}},function(a,b){U.prototype[b]=function(b,c,e){for(var f,g=0,k=this.length;g<k;g++)A(f)?(f=a(this[g],b,c,e),w(f)&&(f=x(f))):pc(f,a(this[g],b,c,e));return w(f)?f:this}});U.prototype.bind=U.prototype.on;U.prototype.unbind=U.prototype.off;var rh=Object.create(null);pd.prototype={_idx:function(a){a!==this._lastKey&&(this._lastKey=a,this._lastIndex=this._keys.indexOf(a));return this._lastIndex},_transformKey:function(a){return Y(a)?
            rh:a},get:function(a){a=this._transformKey(a);a=this._idx(a);if(-1!==a)return this._values[a]},has:function(a){a=this._transformKey(a);return-1!==this._idx(a)},set:function(a,b){a=this._transformKey(a);var d=this._idx(a);-1===d&&(d=this._lastIndex=this._keys.length);this._keys[d]=a;this._values[d]=b},delete:function(a){a=this._transformKey(a);a=this._idx(a);if(-1===a)return!1;this._keys.splice(a,1);this._values.splice(a,1);this._lastKey=NaN;this._lastIndex=-1;return!0}};var Ib=pd,og=[function(){this.$get=
        [function(){return Ib}]}],Bg=/^([^(]+?)=>/,Cg=/^[^(]*\(\s*([^)]*)\)/m,sh=/,/,th=/^\s*(_?)(\S+?)\1\s*$/,Ag=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,Ca=F("$injector");fb.$$annotate=function(a,b,d){var c;if("function"===typeof a){if(!(c=a.$inject)){c=[];if(a.length){if(b)throw C(d)&&d||(d=a.name||Dg(a)),Ca("strictdi",d);b=qd(a);r(b[1].split(sh),function(a){a.replace(th,function(a,b,d){c.push(d)})})}a.$inject=c}}else H(a)?(b=a.length-1,tb(a[b],"fn"),c=a.slice(0,b)):tb(a,"fn",!0);return c};var ne=F("$animate"),
        Ef=function(){this.$get=E},Ff=function(){var a=new Ib,b=[];this.$get=["$$AnimateRunner","$rootScope",function(d,c){function e(a,b,c){var d=!1;b&&(b=C(b)?b.split(" "):H(b)?b:[],r(b,function(b){b&&(d=!0,a[b]=c)}));return d}function f(){r(b,function(b){var c=a.get(b);if(c){var d=Eg(b.attr("class")),e="",f="";r(c,function(a,b){a!==!!d[b]&&(a?e+=(e.length?" ":"")+b:f+=(f.length?" ":"")+b)});r(b,function(a){e&&Eb(a,e);f&&Db(a,f)});a.delete(b)}});b.length=0}return{enabled:E,on:E,off:E,pin:E,push:function(g,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               k,h,l){l&&l();h=h||{};h.from&&g.css(h.from);h.to&&g.css(h.to);if(h.addClass||h.removeClass)if(k=h.addClass,l=h.removeClass,h=a.get(g)||{},k=e(h,k,!0),l=e(h,l,!1),k||l)a.set(g,h),b.push(g),1===b.length&&c.$$postDigest(f);g=new d;g.complete();return g}}}]},Cf=["$provide",function(a){var b=this,d=null,c=null;this.$$registeredAnimations=Object.create(null);this.register=function(c,d){if(c&&"."!==c.charAt(0))throw ne("notcsel",c);var g=c+"-animation";b.$$registeredAnimations[c.substr(1)]=g;a.factory(g,
            d)};this.customFilter=function(a){1===arguments.length&&(c=B(a)?a:null);return c};this.classNameFilter=function(a){if(1===arguments.length&&(d=a instanceof RegExp?a:null)&&/[(\s|\/)]ng-animate[(\s|\/)]/.test(d.toString()))throw d=null,ne("nongcls","ng-animate");return d};this.$get=["$$animateQueue",function(a){function b(a,c,d){if(d){var e;a:{for(e=0;e<d.length;e++){var f=d[e];if(1===f.nodeType){e=f;break a}}e=void 0}!e||e.parentNode||e.previousElementSibling||(d=null)}d?d.after(a):c.prepend(a)}return{on:a.on,
            off:a.off,pin:a.pin,enabled:a.enabled,cancel:function(a){a.cancel&&a.cancel()},enter:function(c,d,h,l){d=d&&x(d);h=h&&x(h);d=d||h.parent();b(c,d,h);return a.push(c,"enter",ra(l))},move:function(c,d,h,l){d=d&&x(d);h=h&&x(h);d=d||h.parent();b(c,d,h);return a.push(c,"move",ra(l))},leave:function(b,c){return a.push(b,"leave",ra(c),function(){b.remove()})},addClass:function(b,c,d){d=ra(d);d.addClass=ib(d.addclass,c);return a.push(b,"addClass",d)},removeClass:function(b,c,d){d=ra(d);d.removeClass=ib(d.removeClass,
                c);return a.push(b,"removeClass",d)},setClass:function(b,c,d,f){f=ra(f);f.addClass=ib(f.addClass,c);f.removeClass=ib(f.removeClass,d);return a.push(b,"setClass",f)},animate:function(b,c,d,f,m){m=ra(m);m.from=m.from?S(m.from,c):c;m.to=m.to?S(m.to,d):d;m.tempClasses=ib(m.tempClasses,f||"ng-inline-animate");return a.push(b,"animate",m)}}}]}],Hf=function(){this.$get=["$$rAF",function(a){function b(b){d.push(b);1<d.length||a(function(){for(var a=0;a<d.length;a++)d[a]();d=[]})}var d=[];return function(){var a=
            !1;b(function(){a=!0});return function(d){a?d():b(d)}}}]},Gf=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$$isDocumentHidden","$timeout",function(a,b,d,c,e){function f(a){this.setHost(a);var b=d();this._doneCallbacks=[];this._tick=function(a){c()?e(a,0,!1):b(a)};this._state=0}f.chain=function(a,b){function c(){if(d===a.length)b(!0);else a[d](function(a){!1===a?b(!1):(d++,c())})}var d=0;c()};f.all=function(a,b){function c(f){e=e&&f;++d===a.length&&b(e)}var d=0,e=!0;r(a,function(a){a.done(c)})};
            f.prototype={setHost:function(a){this.host=a||{}},done:function(a){2===this._state?a():this._doneCallbacks.push(a)},progress:E,getPromise:function(){if(!this.promise){var b=this;this.promise=a(function(a,c){b.done(function(b){!1===b?c():a()})})}return this.promise},then:function(a,b){return this.getPromise().then(a,b)},"catch":function(a){return this.getPromise()["catch"](a)},"finally":function(a){return this.getPromise()["finally"](a)},pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&
                this.host.resume()},end:function(){this.host.end&&this.host.end();this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel();this._resolve(!1)},complete:function(a){var b=this;0===b._state&&(b._state=1,b._tick(function(){b._resolve(a)}))},_resolve:function(a){2!==this._state&&(r(this._doneCallbacks,function(b){b(a)}),this._doneCallbacks.length=0,this._state=2)}};return f}]},Df=function(){this.$get=["$$rAF","$q","$$AnimateRunner",function(a,b,d){return function(b,e){function f(){a(function(){g.addClass&&
        (b.addClass(g.addClass),g.addClass=null);g.removeClass&&(b.removeClass(g.removeClass),g.removeClass=null);g.to&&(b.css(g.to),g.to=null);k||h.complete();k=!0});return h}var g=e||{};g.$$prepared||(g=Ia(g));g.cleanupStyles&&(g.from=g.to=null);g.from&&(b.css(g.from),g.from=null);var k,h=new d;return{start:f,end:f}}}]},$=F("$compile"),uc=new function(){};Zc.$inject=["$provide","$$sanitizeUriProvider"];Kb.prototype.isFirstChange=function(){return this.previousValue===uc};var rd=/^((?:x|data)[:\-_])/i,Jg=
        /[:\-_]+(.)/g,xd=F("$controller"),wd=/^(\S+)(\s+as\s+([\w$]+))?$/,Of=function(){this.$get=["$document",function(a){return function(b){b?!b.nodeType&&b instanceof x&&(b=b[0]):b=a[0].body;return b.offsetWidth+1}}]},yd="application/json",xc={"Content-Type":yd+";charset=utf-8"},Mg=/^\[|^\{(?!\{)/,Ng={"[":/]$/,"{":/}$/},Lg=/^\)]\}',?\n/,Lb=F("$http"),Ma=ca.$interpolateMinErr=F("$interpolate");Ma.throwNoconcat=function(a){throw Ma("noconcat",a);};Ma.interr=function(a,b){return Ma("interr",a,b.toString())};
    var Qg=F("$interval"),Xf=function(){this.$get=function(){function a(a){var b=function(a){b.data=a;b.called=!0};b.id=a;return b}var b=ca.callbacks,d={};return{createCallback:function(c){c="_"+(b.$$counter++).toString(36);var e="angular.callbacks."+c,f=a(c);d[e]=b[c]=f;return e},wasCalled:function(a){return d[a].called},getResponse:function(a){return d[a].data},removeCallback:function(a){delete b[d[a].id];delete d[a]}}}},uh=/^([^?#]*)(\?([^#]*))?(#(.*))?$/,Rg={http:80,https:443,ftp:21},kb=F("$location"),
        Sg=/^\s*[\\/]{2,}/,vh={$$absUrl:"",$$html5:!1,$$replace:!1,$$compose:function(){for(var a=this.$$path,b=this.$$hash,d=Ce(this.$$search),b=b?"#"+ic(b):"",a=a.split("/"),c=a.length;c--;)a[c]=ic(a[c].replace(/%2F/g,"/"));this.$$url=a.join("/")+(d?"?"+d:"")+b;this.$$absUrl=this.$$normalizeUrl(this.$$url);this.$$urlUpdatedByLocation=!0},absUrl:Mb("$$absUrl"),url:function(a){if(A(a))return this.$$url;var b=uh.exec(a);(b[1]||""===a)&&this.path(decodeURIComponent(b[1]));(b[2]||b[1]||""===a)&&this.search(b[3]||
            "");this.hash(b[5]||"");return this},protocol:Mb("$$protocol"),host:Mb("$$host"),port:Mb("$$port"),path:Fd("$$path",function(a){a=null!==a?a.toString():"";return"/"===a.charAt(0)?a:"/"+a}),search:function(a,b){switch(arguments.length){case 0:return this.$$search;case 1:if(C(a)||X(a))a=a.toString(),this.$$search=hc(a);else if(D(a))a=Ia(a,{}),r(a,function(b,c){null==b&&delete a[c]}),this.$$search=a;else throw kb("isrcharg");break;default:A(b)||null===b?delete this.$$search[a]:this.$$search[a]=b}this.$$compose();
                return this},hash:Fd("$$hash",function(a){return null!==a?a.toString():""}),replace:function(){this.$$replace=!0;return this}};r([Ed,Ac,zc],function(a){a.prototype=Object.create(vh);a.prototype.state=function(b){if(!arguments.length)return this.$$state;if(a!==zc||!this.$$html5)throw kb("nostate");this.$$state=A(b)?null:b;this.$$urlUpdatedByLocation=!0;return this}});var Ya=F("$parse"),Wg={}.constructor.prototype.valueOf,Vb=T();r("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(a){Vb[a]=
        !0});var wh={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},Ob=function(a){this.options=a};Ob.prototype={constructor:Ob,lex:function(a){this.text=a;this.index=0;for(this.tokens=[];this.index<this.text.length;)if(a=this.text.charAt(this.index),'"'===a||"'"===a)this.readString(a);else if(this.isNumber(a)||"."===a&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(a,"(){}[].,;:?"))this.tokens.push({index:this.index,
            text:a}),this.index++;else if(this.isWhitespace(a))this.index++;else{var b=a+this.peek(),d=b+this.peek(2),c=Vb[b],e=Vb[d];Vb[a]||c||e?(a=e?d:c?b:a,this.tokens.push({index:this.index,text:a,operator:!0}),this.index+=a.length):this.throwError("Unexpected next character ",this.index,this.index+1)}return this.tokens},is:function(a,b){return-1!==b.indexOf(a)},peek:function(a){a=a||1;return this.index+a<this.text.length?this.text.charAt(this.index+a):!1},isNumber:function(a){return"0"<=a&&"9">=a&&"string"===
            typeof a},isWhitespace:function(a){return" "===a||"\r"===a||"\t"===a||"\n"===a||"\v"===a||"\u00a0"===a},isIdentifierStart:function(a){return this.options.isIdentifierStart?this.options.isIdentifierStart(a,this.codePointAt(a)):this.isValidIdentifierStart(a)},isValidIdentifierStart:function(a){return"a"<=a&&"z">=a||"A"<=a&&"Z">=a||"_"===a||"$"===a},isIdentifierContinue:function(a){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(a,this.codePointAt(a)):this.isValidIdentifierContinue(a)},
        isValidIdentifierContinue:function(a,b){return this.isValidIdentifierStart(a,b)||this.isNumber(a)},codePointAt:function(a){return 1===a.length?a.charCodeAt(0):(a.charCodeAt(0)<<10)+a.charCodeAt(1)-56613888},peekMultichar:function(){var a=this.text.charAt(this.index),b=this.peek();if(!b)return a;var d=a.charCodeAt(0),c=b.charCodeAt(0);return 55296<=d&&56319>=d&&56320<=c&&57343>=c?a+b:a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,b,d){d=d||this.index;b=
            w(b)?"s "+b+"-"+this.index+" ["+this.text.substring(b,d)+"]":" "+d;throw Ya("lexerr",a,b,this.text);},readNumber:function(){for(var a="",b=this.index;this.index<this.text.length;){var d=K(this.text.charAt(this.index));if("."===d||this.isNumber(d))a+=d;else{var c=this.peek();if("e"===d&&this.isExpOperator(c))a+=d;else if(this.isExpOperator(d)&&c&&this.isNumber(c)&&"e"===a.charAt(a.length-1))a+=d;else if(!this.isExpOperator(d)||c&&this.isNumber(c)||"e"!==a.charAt(a.length-1))break;else this.throwError("Invalid exponent")}this.index++}this.tokens.push({index:b,
            text:a,constant:!0,value:Number(a)})},readIdent:function(){var a=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var b=this.peekMultichar();if(!this.isIdentifierContinue(b))break;this.index+=b.length}this.tokens.push({index:a,text:this.text.slice(a,this.index),identifier:!0})},readString:function(a){var b=this.index;this.index++;for(var d="",c=a,e=!1;this.index<this.text.length;){var f=this.text.charAt(this.index),c=c+f;if(e)"u"===f?(e=this.text.substring(this.index+
            1,this.index+5),e.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+e+"]"),this.index+=4,d+=String.fromCharCode(parseInt(e,16))):d+=wh[f]||f,e=!1;else if("\\"===f)e=!0;else{if(f===a){this.index++;this.tokens.push({index:b,text:c,constant:!0,value:d});return}d+=f}this.index++}this.throwError("Unterminated quote",b)}};var q=function(a,b){this.lexer=a;this.options=b};q.Program="Program";q.ExpressionStatement="ExpressionStatement";q.AssignmentExpression="AssignmentExpression";q.ConditionalExpression=
        "ConditionalExpression";q.LogicalExpression="LogicalExpression";q.BinaryExpression="BinaryExpression";q.UnaryExpression="UnaryExpression";q.CallExpression="CallExpression";q.MemberExpression="MemberExpression";q.Identifier="Identifier";q.Literal="Literal";q.ArrayExpression="ArrayExpression";q.Property="Property";q.ObjectExpression="ObjectExpression";q.ThisExpression="ThisExpression";q.LocalsExpression="LocalsExpression";q.NGValueParameter="NGValueParameter";q.prototype={ast:function(a){this.text=
            a;this.tokens=this.lexer.lex(a);a=this.program();0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]);return a},program:function(){for(var a=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&a.push(this.expressionStatement()),!this.expect(";"))return{type:q.Program,body:a}},expressionStatement:function(){return{type:q.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var a=this.expression();this.expect("|");)a=this.filter(a);return a},
        expression:function(){return this.assignment()},assignment:function(){var a=this.ternary();if(this.expect("=")){if(!Jd(a))throw Ya("lval");a={type:q.AssignmentExpression,left:a,right:this.assignment(),operator:"="}}return a},ternary:function(){var a=this.logicalOR(),b,d;return this.expect("?")&&(b=this.expression(),this.consume(":"))?(d=this.expression(),{type:q.ConditionalExpression,test:a,alternate:b,consequent:d}):a},logicalOR:function(){for(var a=this.logicalAND();this.expect("||");)a={type:q.LogicalExpression,
            operator:"||",left:a,right:this.logicalAND()};return a},logicalAND:function(){for(var a=this.equality();this.expect("&&");)a={type:q.LogicalExpression,operator:"&&",left:a,right:this.equality()};return a},equality:function(){for(var a=this.relational(),b;b=this.expect("==","!=","===","!==");)a={type:q.BinaryExpression,operator:b.text,left:a,right:this.relational()};return a},relational:function(){for(var a=this.additive(),b;b=this.expect("<",">","<=",">=");)a={type:q.BinaryExpression,operator:b.text,
            left:a,right:this.additive()};return a},additive:function(){for(var a=this.multiplicative(),b;b=this.expect("+","-");)a={type:q.BinaryExpression,operator:b.text,left:a,right:this.multiplicative()};return a},multiplicative:function(){for(var a=this.unary(),b;b=this.expect("*","/","%");)a={type:q.BinaryExpression,operator:b.text,left:a,right:this.unary()};return a},unary:function(){var a;return(a=this.expect("+","-","!"))?{type:q.UnaryExpression,operator:a.text,prefix:!0,argument:this.unary()}:this.primary()},
        primary:function(){var a;this.expect("(")?(a=this.filterChain(),this.consume(")")):this.expect("[")?a=this.arrayDeclaration():this.expect("{")?a=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?a=Ia(this.selfReferential[this.consume().text]):this.options.literals.hasOwnProperty(this.peek().text)?a={type:q.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?a=this.identifier():this.peek().constant?a=this.constant():this.throwError("not a primary expression",
            this.peek());for(var b;b=this.expect("(","[",".");)"("===b.text?(a={type:q.CallExpression,callee:a,arguments:this.parseArguments()},this.consume(")")):"["===b.text?(a={type:q.MemberExpression,object:a,property:this.expression(),computed:!0},this.consume("]")):"."===b.text?a={type:q.MemberExpression,object:a,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return a},filter:function(a){a=[a];for(var b={type:q.CallExpression,callee:this.identifier(),arguments:a,filter:!0};this.expect(":");)a.push(this.expression());
            return b},parseArguments:function(){var a=[];if(")"!==this.peekToken().text){do a.push(this.filterChain());while(this.expect(","))}return a},identifier:function(){var a=this.consume();a.identifier||this.throwError("is not a valid identifier",a);return{type:q.Identifier,name:a.text}},constant:function(){return{type:q.Literal,value:this.consume().value}},arrayDeclaration:function(){var a=[];if("]"!==this.peekToken().text){do{if(this.peek("]"))break;a.push(this.expression())}while(this.expect(","))}this.consume("]");
            return{type:q.ArrayExpression,elements:a}},object:function(){var a=[],b;if("}"!==this.peekToken().text){do{if(this.peek("}"))break;b={type:q.Property,kind:"init"};this.peek().constant?(b.key=this.constant(),b.computed=!1,this.consume(":"),b.value=this.expression()):this.peek().identifier?(b.key=this.identifier(),b.computed=!1,this.peek(":")?(this.consume(":"),b.value=this.expression()):b.value=b.key):this.peek("[")?(this.consume("["),b.key=this.expression(),this.consume("]"),b.computed=!0,this.consume(":"),
            b.value=this.expression()):this.throwError("invalid key",this.peek());a.push(b)}while(this.expect(","))}this.consume("}");return{type:q.ObjectExpression,properties:a}},throwError:function(a,b){throw Ya("syntax",b.text,a,b.index+1,this.text,this.text.substring(b.index));},consume:function(a){if(0===this.tokens.length)throw Ya("ueoe",this.text);var b=this.expect(a);b||this.throwError("is unexpected, expecting ["+a+"]",this.peek());return b},peekToken:function(){if(0===this.tokens.length)throw Ya("ueoe",
            this.text);return this.tokens[0]},peek:function(a,b,d,c){return this.peekAhead(0,a,b,d,c)},peekAhead:function(a,b,d,c,e){if(this.tokens.length>a){a=this.tokens[a];var f=a.text;if(f===b||f===d||f===c||f===e||!(b||d||c||e))return a}return!1},expect:function(a,b,d,c){return(a=this.peek(a,b,d,c))?(this.tokens.shift(),a):!1},selfReferential:{"this":{type:q.ThisExpression},$locals:{type:q.LocalsExpression}}};var Hd=2;Ld.prototype={compile:function(a){var b=this;this.state={nextId:0,filters:{},fn:{vars:[],
                body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]};Z(a,b.$filter);var d="",c;this.stage="assign";if(c=Kd(a))this.state.computing="assign",d=this.nextId(),this.recurse(c,d),this.return_(d),d="fn.assign="+this.generateFunction("assign","s,v,l");c=Id(a.body);b.stage="inputs";r(c,function(a,c){var d="fn"+c;b.state[d]={vars:[],body:[],own:{}};b.state.computing=d;var k=b.nextId();b.recurse(a,k);b.return_(k);b.state.inputs.push({name:d,isPure:a.isPure});a.watchId=c});this.state.computing="fn";this.stage=
            "main";this.recurse(a);a='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+d+this.watchFns()+"return fn;";a=(new Function("$filter","getStringValue","ifDefined","plus",a))(this.$filter,Tg,Ug,Gd);this.state=this.stage=void 0;return a},USE:"use",STRICT:"strict",watchFns:function(){var a=[],b=this.state.inputs,d=this;r(b,function(b){a.push("var "+b.name+"="+d.generateFunction(b.name,"s"));b.isPure&&a.push(b.name,".isPure="+JSON.stringify(b.isPure)+
            ";")});b.length&&a.push("fn.inputs=["+b.map(function(a){return a.name}).join(",")+"];");return a.join("")},generateFunction:function(a,b){return"function("+b+"){"+this.varsPrefix(a)+this.body(a)+"};"},filterPrefix:function(){var a=[],b=this;r(this.state.filters,function(d,c){a.push(d+"=$filter("+b.escape(c)+")")});return a.length?"var "+a.join(",")+";":""},varsPrefix:function(a){return this.state[a].vars.length?"var "+this.state[a].vars.join(",")+";":""},body:function(a){return this.state[a].body.join("")},
        recurse:function(a,b,d,c,e,f){var g,k,h=this,l,m,p;c=c||E;if(!f&&w(a.watchId))b=b||this.nextId(),this.if_("i",this.lazyAssign(b,this.computedMember("i",a.watchId)),this.lazyRecurse(a,b,d,c,e,!0));else switch(a.type){case q.Program:r(a.body,function(b,c){h.recurse(b.expression,void 0,void 0,function(a){k=a});c!==a.body.length-1?h.current().body.push(k,";"):h.return_(k)});break;case q.Literal:m=this.escape(a.value);this.assign(b,m);c(b||m);break;case q.UnaryExpression:this.recurse(a.argument,void 0,
            void 0,function(a){k=a});m=a.operator+"("+this.ifDefined(k,0)+")";this.assign(b,m);c(m);break;case q.BinaryExpression:this.recurse(a.left,void 0,void 0,function(a){g=a});this.recurse(a.right,void 0,void 0,function(a){k=a});m="+"===a.operator?this.plus(g,k):"-"===a.operator?this.ifDefined(g,0)+a.operator+this.ifDefined(k,0):"("+g+")"+a.operator+"("+k+")";this.assign(b,m);c(m);break;case q.LogicalExpression:b=b||this.nextId();h.recurse(a.left,b);h.if_("&&"===a.operator?b:h.not(b),h.lazyRecurse(a.right,
            b));c(b);break;case q.ConditionalExpression:b=b||this.nextId();h.recurse(a.test,b);h.if_(b,h.lazyRecurse(a.alternate,b),h.lazyRecurse(a.consequent,b));c(b);break;case q.Identifier:b=b||this.nextId();d&&(d.context="inputs"===h.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",a.name)+"?l:s"),d.computed=!1,d.name=a.name);h.if_("inputs"===h.stage||h.not(h.getHasOwnProperty("l",a.name)),function(){h.if_("inputs"===h.stage||"s",function(){e&&1!==e&&h.if_(h.isNull(h.nonComputedMember("s",a.name)),
            h.lazyAssign(h.nonComputedMember("s",a.name),"{}"));h.assign(b,h.nonComputedMember("s",a.name))})},b&&h.lazyAssign(b,h.nonComputedMember("l",a.name)));c(b);break;case q.MemberExpression:g=d&&(d.context=this.nextId())||this.nextId();b=b||this.nextId();h.recurse(a.object,g,void 0,function(){h.if_(h.notNull(g),function(){a.computed?(k=h.nextId(),h.recurse(a.property,k),h.getStringValue(k),e&&1!==e&&h.if_(h.not(h.computedMember(g,k)),h.lazyAssign(h.computedMember(g,k),"{}")),m=h.computedMember(g,k),h.assign(b,
            m),d&&(d.computed=!0,d.name=k)):(e&&1!==e&&h.if_(h.isNull(h.nonComputedMember(g,a.property.name)),h.lazyAssign(h.nonComputedMember(g,a.property.name),"{}")),m=h.nonComputedMember(g,a.property.name),h.assign(b,m),d&&(d.computed=!1,d.name=a.property.name))},function(){h.assign(b,"undefined")});c(b)},!!e);break;case q.CallExpression:b=b||this.nextId();a.filter?(k=h.filter(a.callee.name),l=[],r(a.arguments,function(a){var b=h.nextId();h.recurse(a,b);l.push(b)}),m=k+"("+l.join(",")+")",h.assign(b,m),c(b)):
            (k=h.nextId(),g={},l=[],h.recurse(a.callee,k,g,function(){h.if_(h.notNull(k),function(){r(a.arguments,function(b){h.recurse(b,a.constant?void 0:h.nextId(),void 0,function(a){l.push(a)})});m=g.name?h.member(g.context,g.name,g.computed)+"("+l.join(",")+")":k+"("+l.join(",")+")";h.assign(b,m)},function(){h.assign(b,"undefined")});c(b)}));break;case q.AssignmentExpression:k=this.nextId();g={};this.recurse(a.left,void 0,g,function(){h.if_(h.notNull(g.context),function(){h.recurse(a.right,k);m=h.member(g.context,
            g.name,g.computed)+a.operator+k;h.assign(b,m);c(b||m)})},1);break;case q.ArrayExpression:l=[];r(a.elements,function(b){h.recurse(b,a.constant?void 0:h.nextId(),void 0,function(a){l.push(a)})});m="["+l.join(",")+"]";this.assign(b,m);c(b||m);break;case q.ObjectExpression:l=[];p=!1;r(a.properties,function(a){a.computed&&(p=!0)});p?(b=b||this.nextId(),this.assign(b,"{}"),r(a.properties,function(a){a.computed?(g=h.nextId(),h.recurse(a.key,g)):g=a.key.type===q.Identifier?a.key.name:""+a.key.value;k=h.nextId();
            h.recurse(a.value,k);h.assign(h.member(b,g,a.computed),k)})):(r(a.properties,function(b){h.recurse(b.value,a.constant?void 0:h.nextId(),void 0,function(a){l.push(h.escape(b.key.type===q.Identifier?b.key.name:""+b.key.value)+":"+a)})}),m="{"+l.join(",")+"}",this.assign(b,m));c(b||m);break;case q.ThisExpression:this.assign(b,"s");c(b||"s");break;case q.LocalsExpression:this.assign(b,"l");c(b||"l");break;case q.NGValueParameter:this.assign(b,"v"),c(b||"v")}},getHasOwnProperty:function(a,b){var d=a+"."+
            b,c=this.current().own;c.hasOwnProperty(d)||(c[d]=this.nextId(!1,a+"&&("+this.escape(b)+" in "+a+")"));return c[d]},assign:function(a,b){if(a)return this.current().body.push(a,"=",b,";"),a},filter:function(a){this.state.filters.hasOwnProperty(a)||(this.state.filters[a]=this.nextId(!0));return this.state.filters[a]},ifDefined:function(a,b){return"ifDefined("+a+","+this.escape(b)+")"},plus:function(a,b){return"plus("+a+","+b+")"},return_:function(a){this.current().body.push("return ",a,";")},if_:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        b,d){if(!0===a)b();else{var c=this.current().body;c.push("if(",a,"){");b();c.push("}");d&&(c.push("else{"),d(),c.push("}"))}},not:function(a){return"!("+a+")"},isNull:function(a){return a+"==null"},notNull:function(a){return a+"!=null"},nonComputedMember:function(a,b){var d=/[^$_a-zA-Z0-9]/g;return/^[$_a-zA-Z][$_a-zA-Z0-9]*$/.test(b)?a+"."+b:a+'["'+b.replace(d,this.stringEscapeFn)+'"]'},computedMember:function(a,b){return a+"["+b+"]"},member:function(a,b,d){return d?this.computedMember(a,b):this.nonComputedMember(a,
            b)},getStringValue:function(a){this.assign(a,"getStringValue("+a+")")},lazyRecurse:function(a,b,d,c,e,f){var g=this;return function(){g.recurse(a,b,d,c,e,f)}},lazyAssign:function(a,b){var d=this;return function(){d.assign(a,b)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)},escape:function(a){if(C(a))return"'"+a.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(X(a))return a.toString();if(!0===a)return"true";if(!1===
            a)return"false";if(null===a)return"null";if("undefined"===typeof a)return"undefined";throw Ya("esc");},nextId:function(a,b){var d="v"+this.state.nextId++;a||this.current().vars.push(d+(b?"="+b:""));return d},current:function(){return this.state[this.state.computing]}};Md.prototype={compile:function(a){var b=this;Z(a,b.$filter);var d,c;if(d=Kd(a))c=this.recurse(d);d=Id(a.body);var e;d&&(e=[],r(d,function(a,c){var d=b.recurse(a);d.isPure=a.isPure;a.input=d;e.push(d);a.watchId=c}));var f=[];r(a.body,
            function(a){f.push(b.recurse(a.expression))});a=0===a.body.length?E:1===a.body.length?f[0]:function(a,b){var c;r(f,function(d){c=d(a,b)});return c};c&&(a.assign=function(a,b,d){return c(a,d,b)});e&&(a.inputs=e);return a},recurse:function(a,b,d){var c,e,f=this,g;if(a.input)return this.inputs(a.input,a.watchId);switch(a.type){case q.Literal:return this.value(a.value,b);case q.UnaryExpression:return e=this.recurse(a.argument),this["unary"+a.operator](e,b);case q.BinaryExpression:return c=this.recurse(a.left),
            e=this.recurse(a.right),this["binary"+a.operator](c,e,b);case q.LogicalExpression:return c=this.recurse(a.left),e=this.recurse(a.right),this["binary"+a.operator](c,e,b);case q.ConditionalExpression:return this["ternary?:"](this.recurse(a.test),this.recurse(a.alternate),this.recurse(a.consequent),b);case q.Identifier:return f.identifier(a.name,b,d);case q.MemberExpression:return c=this.recurse(a.object,!1,!!d),a.computed||(e=a.property.name),a.computed&&(e=this.recurse(a.property)),a.computed?this.computedMember(c,
            e,b,d):this.nonComputedMember(c,e,b,d);case q.CallExpression:return g=[],r(a.arguments,function(a){g.push(f.recurse(a))}),a.filter&&(e=this.$filter(a.callee.name)),a.filter||(e=this.recurse(a.callee,!0)),a.filter?function(a,c,d,f){for(var p=[],n=0;n<g.length;++n)p.push(g[n](a,c,d,f));a=e.apply(void 0,p,f);return b?{context:void 0,name:void 0,value:a}:a}:function(a,c,d,f){var p=e(a,c,d,f),n;if(null!=p.value){n=[];for(var s=0;s<g.length;++s)n.push(g[s](a,c,d,f));n=p.value.apply(p.context,n)}return b?
            {value:n}:n};case q.AssignmentExpression:return c=this.recurse(a.left,!0,1),e=this.recurse(a.right),function(a,d,f,g){var p=c(a,d,f,g);a=e(a,d,f,g);p.context[p.name]=a;return b?{value:a}:a};case q.ArrayExpression:return g=[],r(a.elements,function(a){g.push(f.recurse(a))}),function(a,c,d,e){for(var f=[],n=0;n<g.length;++n)f.push(g[n](a,c,d,e));return b?{value:f}:f};case q.ObjectExpression:return g=[],r(a.properties,function(a){a.computed?g.push({key:f.recurse(a.key),computed:!0,value:f.recurse(a.value)}):
            g.push({key:a.key.type===q.Identifier?a.key.name:""+a.key.value,computed:!1,value:f.recurse(a.value)})}),function(a,c,d,e){for(var f={},n=0;n<g.length;++n)g[n].computed?f[g[n].key(a,c,d,e)]=g[n].value(a,c,d,e):f[g[n].key]=g[n].value(a,c,d,e);return b?{value:f}:f};case q.ThisExpression:return function(a){return b?{value:a}:a};case q.LocalsExpression:return function(a,c){return b?{value:c}:c};case q.NGValueParameter:return function(a,c,d){return b?{value:d}:d}}},"unary+":function(a,b){return function(d,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    c,e,f){d=a(d,c,e,f);d=w(d)?+d:0;return b?{value:d}:d}},"unary-":function(a,b){return function(d,c,e,f){d=a(d,c,e,f);d=w(d)?-d:-0;return b?{value:d}:d}},"unary!":function(a,b){return function(d,c,e,f){d=!a(d,c,e,f);return b?{value:d}:d}},"binary+":function(a,b,d){return function(c,e,f,g){var k=a(c,e,f,g);c=b(c,e,f,g);k=Gd(k,c);return d?{value:k}:k}},"binary-":function(a,b,d){return function(c,e,f,g){var k=a(c,e,f,g);c=b(c,e,f,g);k=(w(k)?k:0)-(w(c)?c:0);return d?{value:k}:k}},"binary*":function(a,b,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      d){return function(c,e,f,g){c=a(c,e,f,g)*b(c,e,f,g);return d?{value:c}:c}},"binary/":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)/b(c,e,f,g);return d?{value:c}:c}},"binary%":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)%b(c,e,f,g);return d?{value:c}:c}},"binary===":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)===b(c,e,f,g);return d?{value:c}:c}},"binary!==":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)!==b(c,e,f,g);return d?{value:c}:c}},"binary==":function(a,b,d){return function(c,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            e,f,g){c=a(c,e,f,g)==b(c,e,f,g);return d?{value:c}:c}},"binary!=":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)!=b(c,e,f,g);return d?{value:c}:c}},"binary<":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)<b(c,e,f,g);return d?{value:c}:c}},"binary>":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)>b(c,e,f,g);return d?{value:c}:c}},"binary<=":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)<=b(c,e,f,g);return d?{value:c}:c}},"binary>=":function(a,b,d){return function(c,e,f,g){c=
            a(c,e,f,g)>=b(c,e,f,g);return d?{value:c}:c}},"binary&&":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)&&b(c,e,f,g);return d?{value:c}:c}},"binary||":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)||b(c,e,f,g);return d?{value:c}:c}},"ternary?:":function(a,b,d,c){return function(e,f,g,k){e=a(e,f,g,k)?b(e,f,g,k):d(e,f,g,k);return c?{value:e}:e}},value:function(a,b){return function(){return b?{context:void 0,name:void 0,value:a}:a}},identifier:function(a,b,d){return function(c,e,f,g){c=
            e&&a in e?e:c;d&&1!==d&&c&&null==c[a]&&(c[a]={});e=c?c[a]:void 0;return b?{context:c,name:a,value:e}:e}},computedMember:function(a,b,d,c){return function(e,f,g,k){var h=a(e,f,g,k),l,m;null!=h&&(l=b(e,f,g,k),l+="",c&&1!==c&&h&&!h[l]&&(h[l]={}),m=h[l]);return d?{context:h,name:l,value:m}:m}},nonComputedMember:function(a,b,d,c){return function(e,f,g,k){e=a(e,f,g,k);c&&1!==c&&e&&null==e[b]&&(e[b]={});f=null!=e?e[b]:void 0;return d?{context:e,name:b,value:f}:f}},inputs:function(a,b){return function(d,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               c,e,f){return f?f[b]:a(d,c,e)}}};Nb.prototype={constructor:Nb,parse:function(a){a=this.getAst(a);var b=this.astCompiler.compile(a.ast),d=a.ast;b.literal=0===d.body.length||1===d.body.length&&(d.body[0].expression.type===q.Literal||d.body[0].expression.type===q.ArrayExpression||d.body[0].expression.type===q.ObjectExpression);b.constant=a.ast.constant;b.oneTime=a.oneTime;return b},getAst:function(a){var b=!1;a=a.trim();":"===a.charAt(0)&&":"===a.charAt(1)&&(b=!0,a=a.substring(2));return{ast:this.ast.ast(a),
            oneTime:b}}};var Ea=F("$sce"),W={HTML:"html",CSS:"css",MEDIA_URL:"mediaUrl",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},Dc=/_([a-z])/g,Zg=F("$templateRequest"),$g=F("$timeout"),aa=z.document.createElement("a"),Qd=ga(z.location.href),Na;aa.href="http://[::1]";var ah="[::1]"===aa.hostname;Rd.$inject=["$document"];fd.$inject=["$provide"];var Yd=22,Xd=".",Fc="0";Sd.$inject=["$locale"];Ud.$inject=["$locale"];var lh={yyyy:ea("FullYear",4,0,!1,!0),yy:ea("FullYear",2,0,!0,!0),y:ea("FullYear",1,0,!1,!0),
        MMMM:lb("Month"),MMM:lb("Month",!0),MM:ea("Month",2,1),M:ea("Month",1,1),LLLL:lb("Month",!1,!0),dd:ea("Date",2),d:ea("Date",1),HH:ea("Hours",2),H:ea("Hours",1),hh:ea("Hours",2,-12),h:ea("Hours",1,-12),mm:ea("Minutes",2),m:ea("Minutes",1),ss:ea("Seconds",2),s:ea("Seconds",1),sss:ea("Milliseconds",3),EEEE:lb("Day"),EEE:lb("Day",!0),a:function(a,b){return 12>a.getHours()?b.AMPMS[0]:b.AMPMS[1]},Z:function(a,b,d){a=-1*d;return a=(0<=a?"+":"")+(Pb(Math[0<a?"floor":"ceil"](a/60),2)+Pb(Math.abs(a%60),2))},
        ww:$d(2),w:$d(1),G:Gc,GG:Gc,GGG:Gc,GGGG:function(a,b){return 0>=a.getFullYear()?b.ERANAMES[0]:b.ERANAMES[1]}},kh=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))([\s\S]*)/,jh=/^-?\d+$/;Td.$inject=["$locale"];var eh=ia(K),fh=ia(vb);Vd.$inject=["$parse"];var Re=ia({restrict:"E",compile:function(a,b){if(!b.href&&!b.xlinkHref)return function(a,b){if("a"===b[0].nodeName.toLowerCase()){var e="[object SVGAnimatedString]"===la.call(b.prop("href"))?"xlink:href":"href";
            b.on("click",function(a){b.attr(e)||a.preventDefault()})}}}}),wb={};r(Hb,function(a,b){function d(a,d,e){a.$watch(e[c],function(a){e.$set(b,!!a)})}if("multiple"!==a){var c=xa("ng-"+b),e=d;"checked"===a&&(e=function(a,b,e){e.ngModel!==e[c]&&d(a,b,e)});wb[c]=function(){return{restrict:"A",priority:100,link:e}}}});r(vd,function(a,b){wb[b]=function(){return{priority:100,link:function(a,c,e){if("ngPattern"===b&&"/"===e.ngPattern.charAt(0)&&(c=e.ngPattern.match(ke))){e.$set("ngPattern",new RegExp(c[1],
            c[2]));return}a.$watch(e[b],function(a){e.$set(b,a)})}}}});r(["src","srcset","href"],function(a){var b=xa("ng-"+a);wb[b]=["$sce",function(d){return{priority:99,link:function(c,e,f){var g=a,k=a;"href"===a&&"[object SVGAnimatedString]"===la.call(e.prop("href"))&&(k="xlinkHref",f.$attr[k]="xlink:href",g=null);f.$set(b,d.getTrustedMediaUrl(f[b]));f.$observe(b,function(b){b?(f.$set(k,b),wa&&g&&e.prop(g,f[k])):"href"===a&&f.$set(k,null)})}}}]});var mb={$addControl:E,$getControls:ia([]),$$renameControl:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          b){a.$name=b},$removeControl:E,$setValidity:E,$setDirty:E,$setPristine:E,$setSubmitted:E,$$setSubmitted:E};Qb.$inject=["$element","$attrs","$scope","$animate","$interpolate"];Qb.prototype={$rollbackViewValue:function(){r(this.$$controls,function(a){a.$rollbackViewValue()})},$commitViewValue:function(){r(this.$$controls,function(a){a.$commitViewValue()})},$addControl:function(a){Ja(a.$name,"input");this.$$controls.push(a);a.$name&&(this[a.$name]=a);a.$$parentForm=this},$getControls:function(){return ja(this.$$controls)},
        $$renameControl:function(a,b){var d=a.$name;this[d]===a&&delete this[d];this[b]=a;a.$name=b},$removeControl:function(a){a.$name&&this[a.$name]===a&&delete this[a.$name];r(this.$pending,function(b,d){this.$setValidity(d,null,a)},this);r(this.$error,function(b,d){this.$setValidity(d,null,a)},this);r(this.$$success,function(b,d){this.$setValidity(d,null,a)},this);cb(this.$$controls,a);a.$$parentForm=mb},$setDirty:function(){this.$$animate.removeClass(this.$$element,Za);this.$$animate.addClass(this.$$element,
            Wb);this.$dirty=!0;this.$pristine=!1;this.$$parentForm.$setDirty()},$setPristine:function(){this.$$animate.setClass(this.$$element,Za,Wb+" ng-submitted");this.$dirty=!1;this.$pristine=!0;this.$submitted=!1;r(this.$$controls,function(a){a.$setPristine()})},$setUntouched:function(){r(this.$$controls,function(a){a.$setUntouched()})},$setSubmitted:function(){for(var a=this;a.$$parentForm&&a.$$parentForm!==mb;)a=a.$$parentForm;a.$$setSubmitted()},$$setSubmitted:function(){this.$$animate.addClass(this.$$element,
            "ng-submitted");this.$submitted=!0;r(this.$$controls,function(a){a.$$setSubmitted&&a.$$setSubmitted()})}};ce({clazz:Qb,set:function(a,b,d){var c=a[b];c?-1===c.indexOf(d)&&c.push(d):a[b]=[d]},unset:function(a,b,d){var c=a[b];c&&(cb(c,d),0===c.length&&delete a[b])}});var oe=function(a){return["$timeout","$parse",function(b,d){function c(a){return""===a?d('this[""]').assign:d(a).assign||E}return{name:"form",restrict:a?"EAC":"E",require:["form","^^?form"],controller:Qb,compile:function(d,f){d.addClass(Za).addClass(nb);
                var g=f.name?"name":a&&f.ngForm?"ngForm":!1;return{pre:function(a,d,e,f){var p=f[0];if(!("action"in e)){var n=function(b){a.$apply(function(){p.$commitViewValue();p.$setSubmitted()});b.preventDefault()};d[0].addEventListener("submit",n);d.on("$destroy",function(){b(function(){d[0].removeEventListener("submit",n)},0,!1)})}(f[1]||p.$$parentForm).$addControl(p);var s=g?c(p.$name):E;g&&(s(a,p),e.$observe(g,function(b){p.$name!==b&&(s(a,void 0),p.$$parentForm.$$renameControl(p,b),s=c(p.$name),s(a,p))}));
                        d.on("$destroy",function(){p.$$parentForm.$removeControl(p);s(a,void 0);S(p,mb)})}}}}}]},Se=oe(),df=oe(!0),mh=/^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,xh=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,yh=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,
        nh=/^\s*(-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,pe=/^(\d{4,})-(\d{2})-(\d{2})$/,qe=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Oc=/^(\d{4,})-W(\d\d)$/,re=/^(\d{4,})-(\d\d)$/,se=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,ee=T();r(["date","datetime-local","month","time","week"],function(a){ee[a]=!0});var te={text:function(a,b,d,c,e,f){Sa(a,b,d,c,e,f);Ic(c)},date:ob("date",pe,Rb(pe,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":ob("datetimelocal",qe,Rb(qe,"yyyy MM dd HH mm ss sss".split(" ")),
            "yyyy-MM-ddTHH:mm:ss.sss"),time:ob("time",se,Rb(se,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:ob("week",Oc,function(a,b){if(ha(a))return a;if(C(a)){Oc.lastIndex=0;var d=Oc.exec(a);if(d){var c=+d[1],e=+d[2],f=d=0,g=0,k=0,h=Zd(c),e=7*(e-1);b&&(d=b.getHours(),f=b.getMinutes(),g=b.getSeconds(),k=b.getMilliseconds());return new Date(c,0,h.getDate()+e,d,f,g,k)}}return NaN},"yyyy-Www"),month:ob("month",re,Rb(re,["yyyy","MM"]),"yyyy-MM"),number:function(a,b,d,c,e,f,g,k){Jc(a,b,d,c,"number");fe(c);Sa(a,
            b,d,c,e,f);var h;if(w(d.min)||d.ngMin){var l=d.min||k(d.ngMin)(a);h=na(l);c.$validators.min=function(a,b){return c.$isEmpty(b)||A(h)||b>=h};d.$observe("min",function(a){a!==l&&(h=na(a),l=a,c.$validate())})}if(w(d.max)||d.ngMax){var m=d.max||k(d.ngMax)(a),p=na(m);c.$validators.max=function(a,b){return c.$isEmpty(b)||A(p)||b<=p};d.$observe("max",function(a){a!==m&&(p=na(a),m=a,c.$validate())})}if(w(d.step)||d.ngStep){var n=d.step||k(d.ngStep)(a),s=na(n);c.$validators.step=function(a,b){return c.$isEmpty(b)||
            A(s)||ge(b,h||0,s)};d.$observe("step",function(a){a!==n&&(s=na(a),n=a,c.$validate())})}},url:function(a,b,d,c,e,f){Sa(a,b,d,c,e,f);Ic(c);c.$validators.url=function(a,b){var d=a||b;return c.$isEmpty(d)||xh.test(d)}},email:function(a,b,d,c,e,f){Sa(a,b,d,c,e,f);Ic(c);c.$validators.email=function(a,b){var d=a||b;return c.$isEmpty(d)||yh.test(d)}},radio:function(a,b,d,c){var e=!d.ngTrim||"false"!==V(d.ngTrim);A(d.name)&&b.attr("name",++qb);b.on("change",function(a){var g;b[0].checked&&(g=d.value,e&&(g=
                V(g)),c.$setViewValue(g,a&&a.type))});c.$render=function(){var a=d.value;e&&(a=V(a));b[0].checked=a===c.$viewValue};d.$observe("value",c.$render)},range:function(a,b,d,c,e,f){function g(a,c){b.attr(a,d[a]);var e=d[a];d.$observe(a,function(a){a!==e&&(e=a,c(a))})}function k(a){p=na(a);Y(c.$modelValue)||(m?(a=b.val(),p>a&&(a=p,b.val(a)),c.$setViewValue(a)):c.$validate())}function h(a){n=na(a);Y(c.$modelValue)||(m?(a=b.val(),n<a&&(b.val(n),a=n<p?p:n),c.$setViewValue(a)):c.$validate())}function l(a){s=
                na(a);Y(c.$modelValue)||(m?c.$viewValue!==b.val()&&c.$setViewValue(b.val()):c.$validate())}Jc(a,b,d,c,"range");fe(c);Sa(a,b,d,c,e,f);var m=c.$$hasNativeValidators&&"range"===b[0].type,p=m?0:void 0,n=m?100:void 0,s=m?1:void 0,r=b[0].validity;a=w(d.min);e=w(d.max);f=w(d.step);var q=c.$render;c.$render=m&&w(r.rangeUnderflow)&&w(r.rangeOverflow)?function(){q();c.$setViewValue(b.val())}:q;a&&(p=na(d.min),c.$validators.min=m?function(){return!0}:function(a,b){return c.$isEmpty(b)||A(p)||b>=p},g("min",k));
                e&&(n=na(d.max),c.$validators.max=m?function(){return!0}:function(a,b){return c.$isEmpty(b)||A(n)||b<=n},g("max",h));f&&(s=na(d.step),c.$validators.step=m?function(){return!r.stepMismatch}:function(a,b){return c.$isEmpty(b)||A(s)||ge(b,p||0,s)},g("step",l))},checkbox:function(a,b,d,c,e,f,g,k){var h=he(k,a,"ngTrueValue",d.ngTrueValue,!0),l=he(k,a,"ngFalseValue",d.ngFalseValue,!1);b.on("change",function(a){c.$setViewValue(b[0].checked,a&&a.type)});c.$render=function(){b[0].checked=c.$viewValue};c.$isEmpty=
                function(a){return!1===a};c.$formatters.push(function(a){return va(a,h)});c.$parsers.push(function(a){return a?h:l})},hidden:E,button:E,submit:E,reset:E,file:E},$c=["$browser","$sniffer","$filter","$parse",function(a,b,d,c){return{restrict:"E",require:["?ngModel"],link:{pre:function(e,f,g,k){k[0]&&(te[K(g.type)]||te.text)(e,f,g,k[0],b,a,d,c)}}}}],Af=function(){var a={configurable:!0,enumerable:!1,get:function(){return this.getAttribute("value")||""},set:function(a){this.setAttribute("value",a)}};
            return{restrict:"E",priority:200,compile:function(b,d){if("hidden"===K(d.type))return{pre:function(b,d,f,g){b=d[0];b.parentNode&&b.parentNode.insertBefore(b,b.nextSibling);Object.defineProperty&&Object.defineProperty(b,"value",a)}}}}},zh=/^(true|false|\d+)$/,xf=function(){function a(a,d,c){var e=w(c)?c:9===wa?"":null;a.prop("value",e);d.$set("value",c)}return{restrict:"A",priority:100,compile:function(b,d){return zh.test(d.ngValue)?function(b,d,f){b=b.$eval(f.ngValue);a(d,f,b)}:function(b,d,f){b.$watch(f.ngValue,
            function(b){a(d,f,b)})}}}},We=["$compile",function(a){return{restrict:"AC",compile:function(b){a.$$addBindingClass(b);return function(b,c,e){a.$$addBindingInfo(c,e.ngBind);c=c[0];b.$watch(e.ngBind,function(a){c.textContent=jc(a)})}}}}],Ye=["$interpolate","$compile",function(a,b){return{compile:function(d){b.$$addBindingClass(d);return function(c,d,f){c=a(d.attr(f.$attr.ngBindTemplate));b.$$addBindingInfo(d,c.expressions);d=d[0];f.$observe("ngBindTemplate",function(a){d.textContent=A(a)?"":a})}}}}],
        Xe=["$sce","$parse","$compile",function(a,b,d){return{restrict:"A",compile:function(c,e){var f=b(e.ngBindHtml),g=b(e.ngBindHtml,function(b){return a.valueOf(b)});d.$$addBindingClass(c);return function(b,c,e){d.$$addBindingInfo(c,e.ngBindHtml);b.$watch(g,function(){var d=f(b);c.html(a.getTrustedHtml(d)||"")})}}}}],wf=ia({restrict:"A",require:"ngModel",link:function(a,b,d,c){c.$viewChangeListeners.push(function(){a.$eval(d.ngChange)})}}),Ze=Lc("",!0),af=Lc("Odd",0),$e=Lc("Even",1),bf=Ra({compile:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    b){b.$set("ngCloak",void 0);a.removeClass("ng-cloak")}}),cf=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],ed={},Ah={blur:!0,focus:!0};r("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(a){var b=xa("ng-"+a);ed[b]=["$parse","$rootScope","$exceptionHandler",function(d,c,e){return sd(d,c,e,b,a,Ah[a])}]});var ff=["$animate","$compile",function(a,b){return{multiElement:!0,
        transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(d,c,e,f,g){var k,h,l;d.$watch(e.ngIf,function(d){d?h||g(function(d,f){h=f;d[d.length++]=b.$$createComment("end ngIf",e.ngIf);k={clone:d};a.enter(d,c.parent(),c)}):(l&&(l.remove(),l=null),h&&(h.$destroy(),h=null),k&&(l=ub(k.clone),a.leave(l).done(function(a){!1!==a&&(l=null)}),k=null))})}}}],gf=["$templateRequest","$anchorScroll","$animate",function(a,b,d){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",
        controller:ca.noop,compile:function(c,e){var f=e.ngInclude||e.src,g=e.onload||"",k=e.autoscroll;return function(c,e,m,p,n){var r=0,q,t,x,v=function(){t&&(t.remove(),t=null);q&&(q.$destroy(),q=null);x&&(d.leave(x).done(function(a){!1!==a&&(t=null)}),t=x,x=null)};c.$watch(f,function(f){var m=function(a){!1===a||!w(k)||k&&!c.$eval(k)||b()},t=++r;f?(a(f,!0).then(function(a){if(!c.$$destroyed&&t===r){var b=c.$new();p.template=a;a=n(b,function(a){v();d.enter(a,null,e).done(m)});q=b;x=a;q.$emit("$includeContentLoaded",
            f);c.$eval(g)}},function(){c.$$destroyed||t!==r||(v(),c.$emit("$includeContentError",f))}),c.$emit("$includeContentRequested",f)):(v(),p.template=null)})}}}}],zf=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(b,d,c,e){la.call(d[0]).match(/SVG/)?(d.empty(),a(gd(e.template,z.document).childNodes)(b,function(a){d.append(a)},{futureParentElement:d})):(d.html(e.template),a(d.contents())(b))}}}],hf=Ra({priority:450,compile:function(){return{pre:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               b,d){a.$eval(d.ngInit)}}}}),vf=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(a,b,d,c){var e=d.ngList||", ",f="false"!==d.ngTrim,g=f?V(e):e;c.$parsers.push(function(a){if(!A(a)){var b=[];a&&r(a.split(g),function(a){a&&b.push(f?V(a):a)});return b}});c.$formatters.push(function(a){if(H(a))return a.join(e)});c.$isEmpty=function(a){return!a||!a.length}}}},nb="ng-valid",be="ng-invalid",Za="ng-pristine",Wb="ng-dirty",pb=F("ngModel");Sb.$inject="$scope $exceptionHandler $attrs $element $parse $animate $timeout $q $interpolate".split(" ");
    Sb.prototype={$$initGetterSetters:function(){if(this.$options.getOption("getterSetter")){var a=this.$$parse(this.$$attr.ngModel+"()"),b=this.$$parse(this.$$attr.ngModel+"($$$p)");this.$$ngModelGet=function(b){var c=this.$$parsedNgModel(b);B(c)&&(c=a(b));return c};this.$$ngModelSet=function(a,c){B(this.$$parsedNgModel(a))?b(a,{$$$p:c}):this.$$parsedNgModelAssign(a,c)}}else if(!this.$$parsedNgModel.assign)throw pb("nonassign",this.$$attr.ngModel,Aa(this.$$element));},$render:E,$isEmpty:function(a){return A(a)||
            ""===a||null===a||a!==a},$$updateEmptyClasses:function(a){this.$isEmpty(a)?(this.$$animate.removeClass(this.$$element,"ng-not-empty"),this.$$animate.addClass(this.$$element,"ng-empty")):(this.$$animate.removeClass(this.$$element,"ng-empty"),this.$$animate.addClass(this.$$element,"ng-not-empty"))},$setPristine:function(){this.$dirty=!1;this.$pristine=!0;this.$$animate.removeClass(this.$$element,Wb);this.$$animate.addClass(this.$$element,Za)},$setDirty:function(){this.$dirty=!0;this.$pristine=!1;this.$$animate.removeClass(this.$$element,
            Za);this.$$animate.addClass(this.$$element,Wb);this.$$parentForm.$setDirty()},$setUntouched:function(){this.$touched=!1;this.$untouched=!0;this.$$animate.setClass(this.$$element,"ng-untouched","ng-touched")},$setTouched:function(){this.$touched=!0;this.$untouched=!1;this.$$animate.setClass(this.$$element,"ng-touched","ng-untouched")},$rollbackViewValue:function(){this.$$timeout.cancel(this.$$pendingDebounce);this.$viewValue=this.$$lastCommittedViewValue;this.$render()},$validate:function(){if(!Y(this.$modelValue)){var a=
            this.$$lastCommittedViewValue,b=this.$$rawModelValue,d=this.$valid,c=this.$modelValue,e=this.$options.getOption("allowInvalid"),f=this;this.$$runValidators(b,a,function(a){e||d===a||(f.$modelValue=a?b:void 0,f.$modelValue!==c&&f.$$writeModelToScope())})}},$$runValidators:function(a,b,d){function c(){var c=!0;r(h.$validators,function(d,e){var g=Boolean(d(a,b));c=c&&g;f(e,g)});return c?!0:(r(h.$asyncValidators,function(a,b){f(b,null)}),!1)}function e(){var c=[],d=!0;r(h.$asyncValidators,function(e,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               g){var h=e(a,b);if(!h||!B(h.then))throw pb("nopromise",h);f(g,void 0);c.push(h.then(function(){f(g,!0)},function(){d=!1;f(g,!1)}))});c.length?h.$$q.all(c).then(function(){g(d)},E):g(!0)}function f(a,b){k===h.$$currentValidationRunId&&h.$setValidity(a,b)}function g(a){k===h.$$currentValidationRunId&&d(a)}this.$$currentValidationRunId++;var k=this.$$currentValidationRunId,h=this;(function(){var a=h.$$parserName;if(A(h.$$parserValid))f(a,null);else return h.$$parserValid||(r(h.$validators,function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   b){f(b,null)}),r(h.$asyncValidators,function(a,b){f(b,null)})),f(a,h.$$parserValid),h.$$parserValid;return!0})()?c()?e():g(!1):g(!1)},$commitViewValue:function(){var a=this.$viewValue;this.$$timeout.cancel(this.$$pendingDebounce);if(this.$$lastCommittedViewValue!==a||""===a&&this.$$hasNativeValidators)this.$$updateEmptyClasses(a),this.$$lastCommittedViewValue=a,this.$pristine&&this.$setDirty(),this.$$parseAndValidate()},$$parseAndValidate:function(){var a=this.$$lastCommittedViewValue,b=this;this.$$parserValid=
            A(a)?void 0:!0;this.$setValidity(this.$$parserName,null);this.$$parserName="parse";if(this.$$parserValid)for(var d=0;d<this.$parsers.length;d++)if(a=this.$parsers[d](a),A(a)){this.$$parserValid=!1;break}Y(this.$modelValue)&&(this.$modelValue=this.$$ngModelGet(this.$$scope));var c=this.$modelValue,e=this.$options.getOption("allowInvalid");this.$$rawModelValue=a;e&&(this.$modelValue=a,b.$modelValue!==c&&b.$$writeModelToScope());this.$$runValidators(a,this.$$lastCommittedViewValue,function(d){e||(b.$modelValue=
            d?a:void 0,b.$modelValue!==c&&b.$$writeModelToScope())})},$$writeModelToScope:function(){this.$$ngModelSet(this.$$scope,this.$modelValue);r(this.$viewChangeListeners,function(a){try{a()}catch(b){this.$$exceptionHandler(b)}},this)},$setViewValue:function(a,b){this.$viewValue=a;this.$options.getOption("updateOnDefault")&&this.$$debounceViewValueCommit(b)},$$debounceViewValueCommit:function(a){var b=this.$options.getOption("debounce");X(b[a])?b=b[a]:X(b["default"])&&-1===this.$options.getOption("updateOn").indexOf(a)?
            b=b["default"]:X(b["*"])&&(b=b["*"]);this.$$timeout.cancel(this.$$pendingDebounce);var d=this;0<b?this.$$pendingDebounce=this.$$timeout(function(){d.$commitViewValue()},b):this.$$rootScope.$$phase?this.$commitViewValue():this.$$scope.$apply(function(){d.$commitViewValue()})},$overrideModelOptions:function(a){this.$options=this.$options.createChild(a);this.$$setUpdateOnEvents()},$processModelValue:function(){var a=this.$$format();this.$viewValue!==a&&(this.$$updateEmptyClasses(a),this.$viewValue=this.$$lastCommittedViewValue=
            a,this.$render(),this.$$runValidators(this.$modelValue,this.$viewValue,E))},$$format:function(){for(var a=this.$formatters,b=a.length,d=this.$modelValue;b--;)d=a[b](d);return d},$$setModelValue:function(a){this.$modelValue=this.$$rawModelValue=a;this.$$parserValid=void 0;this.$processModelValue()},$$setUpdateOnEvents:function(){this.$$updateEvents&&this.$$element.off(this.$$updateEvents,this.$$updateEventHandler);if(this.$$updateEvents=this.$options.getOption("updateOn"))this.$$element.on(this.$$updateEvents,
            this.$$updateEventHandler)},$$updateEventHandler:function(a){this.$$debounceViewValueCommit(a&&a.type)}};ce({clazz:Sb,set:function(a,b){a[b]=!0},unset:function(a,b){delete a[b]}});var uf=["$rootScope",function(a){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:Sb,priority:1,compile:function(b){b.addClass(Za).addClass("ng-untouched").addClass(nb);return{pre:function(a,b,e,f){var g=f[0];b=f[1]||g.$$parentForm;if(f=f[2])g.$options=f.$options;g.$$initGetterSetters();b.$addControl(g);
                e.$observe("name",function(a){g.$name!==a&&g.$$parentForm.$$renameControl(g,a)});a.$on("$destroy",function(){g.$$parentForm.$removeControl(g)})},post:function(b,c,e,f){function g(){k.$setTouched()}var k=f[0];k.$$setUpdateOnEvents();c.on("blur",function(){k.$touched||(a.$$phase?b.$evalAsync(g):b.$apply(g))})}}}}}],Tb,Bh=/(\s+|^)default(\s+|$)/;Mc.prototype={getOption:function(a){return this.$$options[a]},createChild:function(a){var b=!1;a=S({},a);r(a,function(d,c){"$inherit"===d?"*"===c?b=!0:(a[c]=
            this.$$options[c],"updateOn"===c&&(a.updateOnDefault=this.$$options.updateOnDefault)):"updateOn"===c&&(a.updateOnDefault=!1,a[c]=V(d.replace(Bh,function(){a.updateOnDefault=!0;return" "})))},this);b&&(delete a["*"],ie(a,this.$$options));ie(a,Tb.$$options);return new Mc(a)}};Tb=new Mc({updateOn:"",updateOnDefault:!0,debounce:0,getterSetter:!1,allowInvalid:!1,timezone:null});var yf=function(){function a(a,d){this.$$attrs=a;this.$$scope=d}a.$inject=["$attrs","$scope"];a.prototype={$onInit:function(){var a=
                this.parentCtrl?this.parentCtrl.$options:Tb,d=this.$$scope.$eval(this.$$attrs.ngModelOptions);this.$options=a.createChild(d)}};return{restrict:"A",priority:10,require:{parentCtrl:"?^^ngModelOptions"},bindToController:!0,controller:a}},jf=Ra({terminal:!0,priority:1E3}),Ch=F("ngOptions"),Dh=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([$\w][$\w]*)|(?:\(\s*([$\w][$\w]*)\s*,\s*([$\w][$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,
        sf=["$compile","$document","$parse",function(a,b,d){function c(a,b,c){function e(a,b,c,d,f){this.selectValue=a;this.viewValue=b;this.label=c;this.group=d;this.disabled=f}function f(a){var b;if(!r&&za(a))b=a;else{b=[];for(var c in a)a.hasOwnProperty(c)&&"$"!==c.charAt(0)&&b.push(c)}return b}var p=a.match(Dh);if(!p)throw Ch("iexp",a,Aa(b));var n=p[5]||p[7],r=p[6];a=/ as /.test(p[0])&&p[1];var q=p[9];b=d(p[2]?p[1]:n);var t=a&&d(a)||b,w=q&&d(q),v=q?function(a,b){return w(c,b)}:function(a){return La(a)},
            x=function(a,b){return v(a,B(a,b))},A=d(p[2]||p[1]),y=d(p[3]||""),J=d(p[4]||""),I=d(p[8]),z={},B=r?function(a,b){z[r]=b;z[n]=a;return z}:function(a){z[n]=a;return z};return{trackBy:q,getTrackByValue:x,getWatchables:d(I,function(a){var b=[];a=a||[];for(var d=f(a),e=d.length,g=0;g<e;g++){var k=a===d?g:d[g],l=a[k],k=B(l,k),l=v(l,k);b.push(l);if(p[2]||p[1])l=A(c,k),b.push(l);p[4]&&(k=J(c,k),b.push(k))}return b}),getOptions:function(){for(var a=[],b={},d=I(c)||[],g=f(d),k=g.length,n=0;n<k;n++){var p=d===
            g?n:g[n],r=B(d[p],p),s=t(c,r),p=v(s,r),w=A(c,r),z=y(c,r),r=J(c,r),s=new e(p,s,w,z,r);a.push(s);b[p]=s}return{items:a,selectValueMap:b,getOptionFromViewValue:function(a){return b[x(a)]},getViewValueFromOption:function(a){return q?Ia(a.viewValue):a.viewValue}}}}}var e=z.document.createElement("option"),f=z.document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(a,b,c,d){d[0].registerOption=E},post:function(d,k,h,l){function m(a){var b=(a=v.getOptionFromViewValue(a))&&
                    a.element;b&&!b.selected&&(b.selected=!0);return a}function p(a,b){a.element=b;b.disabled=a.disabled;a.label!==b.label&&(b.label=a.label,b.textContent=a.label);b.value=a.selectValue}var n=l[0],q=l[1],A=h.multiple;l=0;for(var t=k.children(),z=t.length;l<z;l++)if(""===t[l].value){n.hasEmptyOption=!0;n.emptyOption=t.eq(l);break}k.empty();l=!!n.emptyOption;x(e.cloneNode(!1)).val("?");var v,B=c(h.ngOptions,k,d),C=b[0].createDocumentFragment();n.generateUnknownOptionValue=function(a){return"?"};A?(n.writeValue=
                    function(a){if(v){var b=a&&a.map(m)||[];v.items.forEach(function(a){a.element.selected&&-1===Array.prototype.indexOf.call(b,a)&&(a.element.selected=!1)})}},n.readValue=function(){var a=k.val()||[],b=[];r(a,function(a){(a=v.selectValueMap[a])&&!a.disabled&&b.push(v.getViewValueFromOption(a))});return b},B.trackBy&&d.$watchCollection(function(){if(H(q.$viewValue))return q.$viewValue.map(function(a){return B.getTrackByValue(a)})},function(){q.$render()})):(n.writeValue=function(a){if(v){var b=k[0].options[k[0].selectedIndex],
                    c=v.getOptionFromViewValue(a);b&&b.removeAttribute("selected");c?(k[0].value!==c.selectValue&&(n.removeUnknownOption(),k[0].value=c.selectValue,c.element.selected=!0),c.element.setAttribute("selected","selected")):n.selectUnknownOrEmptyOption(a)}},n.readValue=function(){var a=v.selectValueMap[k.val()];return a&&!a.disabled?(n.unselectEmptyOption(),n.removeUnknownOption(),v.getViewValueFromOption(a)):null},B.trackBy&&d.$watch(function(){return B.getTrackByValue(q.$viewValue)},function(){q.$render()}));
                    l&&(a(n.emptyOption)(d),k.prepend(n.emptyOption),8===n.emptyOption[0].nodeType?(n.hasEmptyOption=!1,n.registerOption=function(a,b){""===b.val()&&(n.hasEmptyOption=!0,n.emptyOption=b,n.emptyOption.removeClass("ng-scope"),q.$render(),b.on("$destroy",function(){var a=n.$isEmptyOptionSelected();n.hasEmptyOption=!1;n.emptyOption=void 0;a&&q.$render()}))}):n.emptyOption.removeClass("ng-scope"));d.$watchCollection(B.getWatchables,function(){var a=v&&n.readValue();if(v)for(var b=v.items.length-1;0<=b;b--){var c=
                        v.items[b];w(c.group)?Gb(c.element.parentNode):Gb(c.element)}v=B.getOptions();var d={};v.items.forEach(function(a){var b;if(w(a.group)){b=d[a.group];b||(b=f.cloneNode(!1),C.appendChild(b),b.label=null===a.group?"null":a.group,d[a.group]=b);var c=e.cloneNode(!1);b.appendChild(c);p(a,c)}else b=e.cloneNode(!1),C.appendChild(b),p(a,b)});k[0].appendChild(C);q.$render();q.$isEmpty(a)||(b=n.readValue(),(B.trackBy||A?va(a,b):a===b)||(q.$setViewValue(b),q.$render()))})}}}}],kf=["$locale","$interpolate","$log",
            function(a,b,d){var c=/{}/g,e=/^when(Minus)?(.+)$/;return{link:function(f,g,k){function h(a){g.text(a||"")}var l=k.count,m=k.$attr.when&&g.attr(k.$attr.when),p=k.offset||0,n=f.$eval(m)||{},q={},w=b.startSymbol(),t=b.endSymbol(),x=w+l+"-"+p+t,v=ca.noop,z;r(k,function(a,b){var c=e.exec(b);c&&(c=(c[1]?"-":"")+K(c[2]),n[c]=g.attr(k.$attr[b]))});r(n,function(a,d){q[d]=b(a.replace(c,x))});f.$watch(l,function(b){var c=parseFloat(b),e=Y(c);e||c in n||(c=a.pluralCat(c-p));c===z||e&&Y(z)||(v(),e=q[c],A(e)?
                    (null!=b&&d.debug("ngPluralize: no rule defined for '"+c+"' in "+m),v=E,h()):v=f.$watch(e,h),z=c)})}}}],ue=F("ngRef"),lf=["$parse",function(a){return{priority:-1,restrict:"A",compile:function(b,d){var c=xa(ua(b)),e=a(d.ngRef),f=e.assign||function(){throw ue("nonassign",d.ngRef);};return function(a,b,h){var l;if(h.hasOwnProperty("ngRefRead"))if("$element"===h.ngRefRead)l=b;else{if(l=b.data("$"+h.ngRefRead+"Controller"),!l)throw ue("noctrl",h.ngRefRead,d.ngRef);}else l=b.data("$"+c+"Controller");l=
                l||b;f(a,l);b.on("$destroy",function(){e(a)===l&&f(a,null)})}}}}],mf=["$parse","$animate","$compile",function(a,b,d){var c=F("ngRepeat"),e=function(a,b,c,d,e,f,g){a[c]=d;e&&(a[e]=f);a.$index=b;a.$first=0===b;a.$last=b===g-1;a.$middle=!(a.$first||a.$last);a.$odd=!(a.$even=0===(b&1))},f=function(a,b,c){return La(c)},g=function(a,b){return b};return{restrict:"A",multiElement:!0,transclude:"element",priority:1E3,terminal:!0,$$tlb:!0,compile:function(k,h){var l=h.ngRepeat,m=d.$$createComment("end ngRepeat",
                l),p=l.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!p)throw c("iexp",l);var n=p[1],q=p[2],w=p[3],t=p[4],p=n.match(/^(?:(\s*[$\w]+)|\(\s*([$\w]+)\s*,\s*([$\w]+)\s*\))$/);if(!p)throw c("iidexp",n);var x=p[3]||p[1],v=p[2];if(w&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(w)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(w)))throw c("badident",w);var A;if(t){var z={$id:La},y=a(t);A=function(a,b,c,d){v&&
            (z[v]=b);z[x]=c;z.$index=d;return y(a,z)}}return function(a,d,h,k,n){var p=T();a.$watchCollection(q,function(h){var k,q,t=d[0],s,y=T(),B,C,E,D,H,F,K;w&&(a[w]=h);if(za(h))H=h,q=A||f;else for(K in q=A||g,H=[],h)ta.call(h,K)&&"$"!==K.charAt(0)&&H.push(K);B=H.length;K=Array(B);for(k=0;k<B;k++)if(C=h===H?k:H[k],E=h[C],D=q(a,C,E,k),p[D])F=p[D],delete p[D],y[D]=F,K[k]=F;else{if(y[D])throw r(K,function(a){a&&a.scope&&(p[a.id]=a)}),c("dupes",l,D,E);K[k]={id:D,scope:void 0,clone:void 0};y[D]=!0}z&&(z[x]=void 0);
                for(s in p){F=p[s];D=ub(F.clone);b.leave(D);if(D[0].parentNode)for(k=0,q=D.length;k<q;k++)D[k].$$NG_REMOVED=!0;F.scope.$destroy()}for(k=0;k<B;k++)if(C=h===H?k:H[k],E=h[C],F=K[k],F.scope){s=t;do s=s.nextSibling;while(s&&s.$$NG_REMOVED);F.clone[0]!==s&&b.move(ub(F.clone),null,t);t=F.clone[F.clone.length-1];e(F.scope,k,x,E,v,C,B)}else n(function(a,c){F.scope=c;var d=m.cloneNode(!1);a[a.length++]=d;b.enter(a,null,t);t=d;F.clone=a;y[F.id]=F;e(F.scope,k,x,E,v,C,B)});p=y})}}}}],nf=["$animate",function(a){return{restrict:"A",
            multiElement:!0,link:function(b,d,c){b.$watch(c.ngShow,function(b){a[b?"removeClass":"addClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],ef=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(b,d,c){b.$watch(c.ngHide,function(b){a[b?"addClass":"removeClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],of=Ra(function(a,b,d){a.$watchCollection(d.ngStyle,function(a,d){d&&a!==d&&r(d,function(a,c){b.css(c,"")});a&&b.css(a)})}),pf=["$animate","$compile",function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 b){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(d,c,e,f){var g=[],k=[],h=[],l=[],m=function(a,b){return function(c){!1!==c&&a.splice(b,1)}};d.$watch(e.ngSwitch||e.on,function(c){for(var d,e;h.length;)a.cancel(h.pop());d=0;for(e=l.length;d<e;++d){var q=ub(k[d].clone);l[d].$destroy();(h[d]=a.leave(q)).done(m(h,d))}k.length=0;l.length=0;(g=f.cases["!"+c]||f.cases["?"])&&r(g,function(c){c.transclude(function(d,e){l.push(e);var f=c.element;d[d.length++]=b.$$createComment("end ngSwitchWhen");
                k.push({clone:d});a.enter(d,f.parent(),f)})})})}}}],qf=Ra({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,b,d,c,e){a=d.ngSwitchWhen.split(d.ngSwitchWhenSeparator).sort().filter(function(a,b,c){return c[b-1]!==a});r(a,function(a){c.cases["!"+a]=c.cases["!"+a]||[];c.cases["!"+a].push({transclude:e,element:b})})}}),rf=Ra({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,b,d,c,e){c.cases["?"]=c.cases["?"]||[];c.cases["?"].push({transclude:e,
                element:b})}}),Eh=F("ngTransclude"),tf=["$compile",function(a){return{restrict:"EAC",compile:function(b){var d=a(b.contents());b.empty();return function(a,b,f,g,k){function h(){d(a,function(a){b.append(a)})}if(!k)throw Eh("orphan",Aa(b));f.ngTransclude===f.$attr.ngTransclude&&(f.ngTransclude="");f=f.ngTransclude||f.ngTranscludeSlot;k(function(a,c){var d;if(d=a.length)a:{d=0;for(var f=a.length;d<f;d++){var g=a[d];if(g.nodeType!==Pa||g.nodeValue.trim()){d=!0;break a}}d=void 0}d?b.append(a):(h(),c.$destroy())},
                null,f);f&&!k.isSlotFilled(f)&&h()}}}}],Te=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(b,d){"text/ng-template"===d.type&&a.put(d.id,b[0].text)}}}],Fh={$setViewValue:E,$render:E},Gh=["$element","$scope",function(a,b){function d(){g||(g=!0,b.$$postDigest(function(){g=!1;e.ngModelCtrl.$render()}))}function c(a){k||(k=!0,b.$$postDigest(function(){b.$$destroyed||(k=!1,e.ngModelCtrl.$setViewValue(e.readValue()),a&&e.ngModelCtrl.$render())}))}var e=this,f=new Ib;e.selectValueMap=
            {};e.ngModelCtrl=Fh;e.multiple=!1;e.unknownOption=x(z.document.createElement("option"));e.hasEmptyOption=!1;e.emptyOption=void 0;e.renderUnknownOption=function(b){b=e.generateUnknownOptionValue(b);e.unknownOption.val(b);a.prepend(e.unknownOption);Oa(e.unknownOption,!0);a.val(b)};e.updateUnknownOption=function(b){b=e.generateUnknownOptionValue(b);e.unknownOption.val(b);Oa(e.unknownOption,!0);a.val(b)};e.generateUnknownOptionValue=function(a){return"? "+La(a)+" ?"};e.removeUnknownOption=function(){e.unknownOption.parent()&&
        e.unknownOption.remove()};e.selectEmptyOption=function(){e.emptyOption&&(a.val(""),Oa(e.emptyOption,!0))};e.unselectEmptyOption=function(){e.hasEmptyOption&&Oa(e.emptyOption,!1)};b.$on("$destroy",function(){e.renderUnknownOption=E});e.readValue=function(){var b=a.val(),b=b in e.selectValueMap?e.selectValueMap[b]:b;return e.hasOption(b)?b:null};e.writeValue=function(b){var c=a[0].options[a[0].selectedIndex];c&&Oa(x(c),!1);e.hasOption(b)?(e.removeUnknownOption(),c=La(b),a.val(c in e.selectValueMap?
            c:b),Oa(x(a[0].options[a[0].selectedIndex]),!0)):e.selectUnknownOrEmptyOption(b)};e.addOption=function(a,b){if(8!==b[0].nodeType){Ja(a,'"option value"');""===a&&(e.hasEmptyOption=!0,e.emptyOption=b);var c=f.get(a)||0;f.set(a,c+1);d()}};e.removeOption=function(a){var b=f.get(a);b&&(1===b?(f.delete(a),""===a&&(e.hasEmptyOption=!1,e.emptyOption=void 0)):f.set(a,b-1))};e.hasOption=function(a){return!!f.get(a)};e.$hasEmptyOption=function(){return e.hasEmptyOption};e.$isUnknownOptionSelected=function(){return a[0].options[0]===
            e.unknownOption[0]};e.$isEmptyOptionSelected=function(){return e.hasEmptyOption&&a[0].options[a[0].selectedIndex]===e.emptyOption[0]};e.selectUnknownOrEmptyOption=function(a){null==a&&e.emptyOption?(e.removeUnknownOption(),e.selectEmptyOption()):e.unknownOption.parent().length?e.updateUnknownOption(a):e.renderUnknownOption(a)};var g=!1,k=!1;e.registerOption=function(a,b,f,g,k){if(f.$attr.ngValue){var q,r;f.$observe("value",function(a){var d,f=b.prop("selected");w(r)&&(e.removeOption(q),delete e.selectValueMap[r],
            d=!0);r=La(a);q=a;e.selectValueMap[r]=a;e.addOption(a,b);b.attr("value",r);d&&f&&c()})}else g?f.$observe("value",function(a){e.readValue();var d,f=b.prop("selected");w(q)&&(e.removeOption(q),d=!0);q=a;e.addOption(a,b);d&&f&&c()}):k?a.$watch(k,function(a,d){f.$set("value",a);var g=b.prop("selected");d!==a&&e.removeOption(d);e.addOption(a,b);d&&g&&c()}):e.addOption(f.value,b);f.$observe("disabled",function(a){if("true"===a||a&&b.prop("selected"))e.multiple?c(!0):(e.ngModelCtrl.$setViewValue(null),e.ngModelCtrl.$render())});
            b.on("$destroy",function(){var a=e.readValue(),b=f.value;e.removeOption(b);d();(e.multiple&&a&&-1!==a.indexOf(b)||a===b)&&c(!0)})}}],Ue=function(){return{restrict:"E",require:["select","?ngModel"],controller:Gh,priority:1,link:{pre:function(a,b,d,c){var e=c[0],f=c[1];if(f){if(e.ngModelCtrl=f,b.on("change",function(){e.removeUnknownOption();a.$apply(function(){f.$setViewValue(e.readValue())})}),d.multiple){e.multiple=!0;e.readValue=function(){var a=[];r(b.find("option"),function(b){b.selected&&!b.disabled&&
                (b=b.value,a.push(b in e.selectValueMap?e.selectValueMap[b]:b))});return a};e.writeValue=function(a){r(b.find("option"),function(b){var c=!!a&&(-1!==Array.prototype.indexOf.call(a,b.value)||-1!==Array.prototype.indexOf.call(a,e.selectValueMap[b.value]));c!==b.selected&&Oa(x(b),c)})};var g,k=NaN;a.$watch(function(){k!==f.$viewValue||va(g,f.$viewValue)||(g=ja(f.$viewValue),f.$render());k=f.$viewValue});f.$isEmpty=function(a){return!a||0===a.length}}}else e.registerOption=E},post:function(a,b,d,c){var e=
                    c[1];if(e){var f=c[0];e.$render=function(){f.writeValue(e.$viewValue)}}}}}},Ve=["$interpolate",function(a){return{restrict:"E",priority:100,compile:function(b,d){var c,e;w(d.ngValue)||(w(d.value)?c=a(d.value,!0):(e=a(b.text(),!0))||d.$set("value",b.text()));return function(a,b,d){var h=b.parent();(h=h.data("$selectController")||h.parent().data("$selectController"))&&h.registerOption(a,b,d,c,e)}}}}],bd=["$parse",function(a){return{restrict:"A",require:"?ngModel",link:function(b,d,c,e){if(e){var f=
                c.hasOwnProperty("required")||a(c.ngRequired)(b);c.ngRequired||(c.required=!0);e.$validators.required=function(a,b){return!f||!e.$isEmpty(b)};c.$observe("required",function(a){f!==a&&(f=a,e.$validate())})}}}}],ad=["$parse",function(a){return{restrict:"A",require:"?ngModel",compile:function(b,d){var c,e;d.ngPattern&&(c=d.ngPattern,e="/"===d.ngPattern.charAt(0)&&ke.test(d.ngPattern)?function(){return d.ngPattern}:a(d.ngPattern));return function(a,b,d,h){if(h){var l=d.pattern;d.ngPattern?l=e(a):c=d.pattern;
                var m=je(l,c,b);d.$observe("pattern",function(a){var d=m;m=je(a,c,b);(d&&d.toString())!==(m&&m.toString())&&h.$validate()});h.$validators.pattern=function(a,b){return h.$isEmpty(b)||A(m)||m.test(b)}}}}}}],dd=["$parse",function(a){return{restrict:"A",require:"?ngModel",link:function(b,d,c,e){if(e){var f=c.maxlength||a(c.ngMaxlength)(b),g=Ub(f);c.$observe("maxlength",function(a){f!==a&&(g=Ub(a),f=a,e.$validate())});e.$validators.maxlength=function(a,b){return 0>g||e.$isEmpty(b)||b.length<=g}}}}}],cd=
            ["$parse",function(a){return{restrict:"A",require:"?ngModel",link:function(b,d,c,e){if(e){var f=c.minlength||a(c.ngMinlength)(b),g=Ub(f)||-1;c.$observe("minlength",function(a){f!==a&&(g=Ub(a)||-1,f=a,e.$validate())});e.$validators.minlength=function(a,b){return e.$isEmpty(b)||b.length>=g}}}}}];z.angular.bootstrap?z.console&&console.log("WARNING: Tried to load AngularJS more than once."):(Je(),Oe(ca),ca.module("ngLocale",[],["$provide",function(a){function b(a){a+="";var b=a.indexOf(".");return-1==
    b?0:a.length-b-1}a.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:"January February March April May June July August September October November December".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),STANDALONEMONTH:"January February March April May June July August September October November December".split(" "),
            WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-\u00a4",negSuf:"",posPre:"\u00a4",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               c){var e=a|0,f=c;void 0===f&&(f=Math.min(b(a),3));Math.pow(10,f);return 1==e&&0==f?"one":"other"}})}]),x(function(){Ee(z.document,Wc)}))})(window);!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend(window.angular.element("<style>").text('@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}'));
/**
# sourceMappingURL=angular.min.js.map
**/
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){/*! Portions adapted from tether v1.1.0 | MIT License | github.com/HubSpot/tether */
"use strict";function d(a,b){if("undefined"!=typeof a.classList)b.split(" ").forEach(function(b){b.trim()&&a.classList.add(b)});else if(!f(a,b)){var c=a.className+(" "+b);g(a,c)}}function e(a,b){if("undefined"!=typeof a.classList)b.split(" ").forEach(function(b){b.trim()&&a.classList.remove(b)});else{var c=new RegExp("(^| )"+b.split(" ").join("|")+"( |$)","gi"),d=a.className.replace(c," ");g(a,d)}}function f(a,b){return"undefined"!=typeof a.classList?a.classList.contains(b):new RegExp("(^| )"+b+"( |$)","gi").test(a.className)}function g(a,b){a.setAttribute("class",b)}c.addClass=d,c.removeClass=e,c.hasClass=f},{}],2:[function(a,b,c){"use strict";function d(a,b){if(!a||""===a.trim()||!b)throw new Error("Expect a component name and custom element definition");if(k[a])throw new Error("A component with the name "+a+" is already registered (AWS-init)");var d=h.createComponentPrototype(a,b);k[a]=d,c.__componentDefinitions[a]=b}function e(a){if(!g.isNodeOrCollection(a))throw new Error("Expect an array of Nodes or a single Node");a instanceof Node&&(a=[a]);for(var b=0,c=a;b<c.length;b++){var d=c[b],e=k[d.nodeName.toLowerCase()];d.component=Object.create(e),d.component.node=d,d.component.hasBeenCreated()}}function f(a){if(void 0===a||""===a.trim())throw new Error("No name given");if(!k[a])throw new Error("There is no component with the name "+a);this.__internalCreate=!0;var b=document.createElement(a);return this.__internalCreate=!1,e(b),b}var g=a("./utils"),h=a("./BasePrototype"),i=a("./Metrics"),j=a("./AwsUi.DomUtils"),k={};c.__componentDefinitions={},c.__addComponent=d,c.activate=e,c.createComponent=f,c.__Metrics=i.publicAPI,c.__DomUtils=j},{"./AwsUi.DomUtils":1,"./BasePrototype":3,"./Metrics":13,"./utils":15}],3:[function(a,b,c){"use strict";function d(){for(var a={},b=0,c=m;b<c.length;b++){var d=c[b];d.prototypeAdditions&&f.mixin(a,d.prototypeAdditions)}return a}function e(a,b){var c=Object.create(n);c.__componentName=a;for(var d=0,e=m;d<e.length;d++){var f=e[d];f.extendComponent&&f.extendComponent(c,b)}return c}var f=a("./utils"),g=a("./BasePrototype/PropertyHandling"),h=a("./BasePrototype/EventHandling"),i=a("./BasePrototype/FunctionHandling"),j=a("./BasePrototype/LifecycleHandling"),k=a("./BasePrototype/RegionHandling"),l=a("./BasePrototype/RenderHandling"),m=[i,j,h,k,g,l],n=d();c.createComponentPrototype=e},{"./BasePrototype/EventHandling":4,"./BasePrototype/FunctionHandling":5,"./BasePrototype/LifecycleHandling":6,"./BasePrototype/PropertyHandling":7,"./BasePrototype/RegionHandling":9,"./BasePrototype/RenderHandling":10,"./utils":15}],4:[function(a,b,c){"use strict";function d(a,b){a.__events=b.events||{}}var e,f=a("../utils");!function(a){function b(a,b){void 0===b&&(b={});var c=this.__events[a];if(!c)throw new Error("No such event defined: "+a);return e(this,a,b,c.bubbles,c.cancelable)}function c(a){var b=g(a),c={newValue:this[a]};e(this,b,c,!0,!1)}function d(a,b){var c=g(a);this.node.addEventListener("awsui:"+c,function(a){return b(a.detail.newValue,a.target)})}function e(a,b,c,d,e){var g="awsui:",h=f.createCustomEvent(g+b,c,d,e);return a.node.dispatchEvent(h),h}var g=function(a){return"__"+a.toLowerCase()+"change"};a.__fireEvent=b,a.__firePropertyChangeEvent=c,a.__listenToPropertyChanges=d}(e=c.prototypeAdditions||(c.prototypeAdditions={})),c.extendComponent=d},{"../utils":15}],5:[function(a,b,c){"use strict";function d(a,b){var c=b.functions||{};e.mixin(a,c)}var e=a("../utils");c.extendComponent=d},{"../utils":15}],6:[function(a,b,c){"use strict";function d(a,b){var c=["initialized","attached","detached"],d=b.callbacks||{};for(var e in d)if(c.indexOf(e)===-1)throw new Error("Undefined callback "+e+" for component");a.__callbacks=d}var e,f=a("../Metrics"),g=function(a){var b=a.__propertiesDefinition;for(var c in b)b[c].announceValue&&a.__firePropertyChangeEvent(c)};!function(a){function b(){this.__created=!1,this.__defineRegions(),this.__defineProperties(),this.__created=!0,this.__callbacks.initialized&&this.__callbacks.initialized.apply(this),this.__update()}function c(){if("detached"===this.__componentState)throw new Error("Detach called while component is already detached");this.__componentState="detached",this.__callbacks.detached&&this.__callbacks.detached.apply(this)}function d(){if("attached"===this.__componentState)throw new Error("Attach called while component is already attached");if(!document.body.contains(this.node))throw new Error("Node should be part of DOM when calling attached!");g(this),this.__componentState="attached",this.node.setAttribute("initialized",!0),this.__callbacks.attached&&this.__callbacks.attached.apply(this),f.__logComponentUsed(this.node.tagName)}a.hasBeenCreated=b,a.hasBeenDetached=c,a.hasBeenAttached=d}(e=c.prototypeAdditions||(c.prototypeAdditions={})),c.extendComponent=d},{"../Metrics":13}],7:[function(a,b,c){"use strict";function d(a,b){var c=b.properties||{};a.__propertiesDefinition=c;var d=b.regions?Object.keys(b.regions):[];d.forEach(function(a){c[a]={type:"region",onChange:function(b,c){this.__setRegion(a,c)}}});var e=function(b,c){var d=a.__propertiesDefinition[b];return function(){var a=this;if(!d.__readable)throw new Error('Tried to access write-only property "'+b+'"');return c.call(this,function(){return a.__properties[b]})}},g=function(b,c){var d=a.__propertiesDefinition[b];return function(a){var e=this;if(!d.__writable)throw new Error('Tried to modify read-only property "'+b+'"');var g=f[d.type];g.validate(a,b,d);var h;d.__readable&&(h=this[b],!g.complexType&&h===a)||(c.call(this,a,function(a){e.__properties[b]=a}),this.__created&&("function"==typeof d.onChange&&d.onChange.call(this,h,a),this.__update(),d.announceValue===!0&&this.__firePropertyChangeEvent(b)))}},h=function(a){return function(){return this.__properties[a]}},i=function(a){return function(b){this.__properties[a]=b}};for(var j in a.__propertiesDefinition){var k=a.__propertiesDefinition[j],l={};k.type=k.type||"string";var m=f[k.type];if(!m)throw new Error('No such type "'+k.type+'" for property '+j);var n=k.setter,o=k.getter;n||o||(n=i(j),o=h(j)),k.__writable=Boolean(n),k.__readable=Boolean(o),l.get=e(j,o),l.set=g(j,n),Object.defineProperty(a,j,l)}}var e,f=a("./PropertyTypes");!function(a){function b(){this.__properties={};for(var a in this.__propertiesDefinition){var b=this.__propertiesDefinition[a],c=f[b.type],d=c.getDefaultValue(b);b.__writable&&(this[a]=d)}}function c(a,b){var c=this.__propertiesDefinition[a],d=f[c.type];if(d.fromAttribute){var e;e=null===b?d.getDefaultValue(c):d.fromAttribute(b,a),this[a]!==e&&(this[a]=e)}}a.__defineProperties=b,a.__setFromString=c}(e=c.prototypeAdditions||(c.prototypeAdditions={})),c.extendComponent=d},{"./PropertyTypes":8}],8:[function(a,b,c){"use strict";var d;!function(a){function b(a){return a}function c(a,b,c){if(void 0===a||null===a){if(c.nullable!==!1)return;throw new Error("Property "+b+" cannot be null or undefined")}if("string"!=typeof a)throw new Error('Property "'+b+'" must be a string, got "'+a+'" ('+typeof a+") instead");if(c.valid&&c.valid.indexOf(a)===-1)throw new TypeError(b+" can only have the following values: "+c.valid.join(", ")+' (was "'+a+'")')}function d(a){return a.defaultValue}a.fromAttribute=b,a.validate=c,a.getDefaultValue=d}(d||(d={}));var e;!function(a){function b(a,b){if("true"===a)return!0;if("false"===a)return!1;throw new Error('Attribute "'+b+'" must be "true" or "false", got "'+a+'" ('+typeof a+") instead")}function c(a,b){if("boolean"!=typeof a)throw new Error('Property "'+b+'" must be true or false, got "'+a+'" ('+typeof a+") instead")}function d(a){return Boolean(a.defaultValue)}a.fromAttribute=b,a.validate=c,a.getDefaultValue=d}(e||(e={}));var f;!function(a){function b(a){if(isNaN(a))return!1;var b=a.match(/^[0-9\.-]+$/);return!!b}function c(a,c){if(null===a)return null;if(!b(a))throw new Error('Attribute "'+c+'" does not specify a valid number, was "'+a+'"');return parseFloat(a)}function d(a,b){if(null===a||void 0===a)return null;if("number"!=typeof a)throw new Error('Property "'+b+'" must be a number, was "'+a+'" ('+typeof a+")");if(!isFinite(a))throw new Error('Property "'+b+'" only allows for finite numbers, got "'+a+'" instead')}function e(a){return a.defaultValue}a.fromAttribute=c,a.validate=d,a.getDefaultValue=e}(f||(f={}));var g;!function(a){function b(a){return a}function c(a){}function d(a){return a.defaultValue}a.fromAttribute=b,a.validate=c,a.getDefaultValue=d}(g||(g={}));var h;!function(a){function b(a,b){throw new Error('Attribute "'+b+"\" can't be set as string.")}function c(a){}function d(a){}a.complexType=!0,a.fromAttribute=b,a.validate=c,a.getDefaultValue=d}(h||(h={}));var i;!function(a){function b(a,b){throw new Error('Attribute "'+b+"\" can't be set as string.")}function c(a,b){if(!Array.isArray(a))throw new Error('Property "'+b+'" must be an array'+(", was "+a+" ("+typeof a+")"))}function d(a){return[]}a.complexType=!0,a.fromAttribute=b,a.validate=c,a.getDefaultValue=d}(i||(i={})),c.string=d,c.boolean=e,c.region=g,c.object=h,c.array=i,c.integer=f,c.float=f},{}],9:[function(a,b,c){"use strict";function d(a,b){var c=b.regions||{};a.__regionDefinition=c}var e;!function(a){function b(){this.__regions={};for(var a in this.__regionDefinition){var b=this.__regionDefinition[a];b.isDefault&&(this.__defaultRegionName=a),this.__regions[a]={isDefault:b.isDefault}}return this.__regions}function c(a,b){return h(this,a),"string"==typeof b&&(b=document.createTextNode(b)),b?(this.__regions[a].innerContent=b,this.__update()):this.__removeRegion(a),this.__regions[a].innerContent}function d(a,b){if(0===Object.keys(this.__regions).length)throw new Error('Trying to set a region "'+a+'" on the component '+('"'+this.__componentName+'" but it does not have regions'));h(this,a),this[a]=b}function e(a){if(!this.__defaultRegionName)throw new Error("Trying to set a default region on the component "+('"'+this.__componentName+'" but it does not have a default region'));this.setRegion(this.__defaultRegionName,a)}function f(a){this.__regions[a]&&(this.__regions[a].innerContent=void 0,this.__update())}function g(a){var b=this;b[a]=void 0}function h(a,b){if(!a.__regions[b])throw new TypeError("The component has no region called: "+b)}function i(a,b){return h(this,a),this[a]}a.__defineRegions=b,a.__setRegion=c,a.setRegion=d,a.setDefaultRegion=e,a.__removeRegion=f,a.removeRegion=g,a.getRegion=i}(e=c.prototypeAdditions||(c.prototypeAdditions={})),c.extendComponent=d},{}],10:[function(a,b,c){"use strict";function d(a,b){a.__render=b.render}function e(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];return g(a,b,c)}var f,g=a("mithril"),h=a("../MithrilHelpers");!function(a){function b(){var a=new h.default(this);g.render(this.node,this.__render(g,a))}a.__update=b}(f=c.prototypeAdditions||(c.prototypeAdditions={})),c.extendComponent=d,c.__createElement=e},{"../MithrilHelpers":14,mithril:16}],11:[function(a,b,c){"use strict";function d(){c.isIE=Boolean(navigator.userAgent.match(/MSIE|Trident/)),c.inputEvent=!c.isIE}c.detect=d,d()},{}],12:[function(a,b,c){"use strict";var d=function(){function a(a){this.classNameSet={},this.component=a}return a.prototype.addClass=function(a,b){var c;return c=arguments.length<2||!!b,a&&c&&(this.classNameSet[a]=!0),this},a.prototype.addPropertyValueClass=function(a,b){var c=this.component,d=c[a];if(d){var e=c.__componentName+"-"+a+"-"+d;arguments.length<2?this.addClass(e):this.addClass(e,b)}return this},a.prototype.toClassName=function(){var a=Object.keys(this.classNameSet);return a.sort(),a.join(" ")},a}();c.ClassBuilder=d},{}],13:[function(a,b,c){"use strict";function d(a,b,c){if("object"==typeof window.AWSC&&"object"==typeof window.AWSC.Clog&&"function"==typeof window.AWSC.Clog.log){if(window.AwsUi.debug&&!/^[a-zA-Z0-9_-]{1,32}$/.test(a))throw new Error("Invalid metric name: "+a);window.AWSC.Clog.log(a,b,c)}}function e(a,b,c){g[a]||(d(a,b,c),g[a]=!0)}function f(a){c.publicAPI.sendMetricOnce(a.toLowerCase()+"-used",1)}c.sendMetric=d;var g={};c.sendMetricOnce=e,c.__logComponentUsed=f,c.publicAPI={sendMetric:d,sendMetricOnce:e}},{}],14:[function(a,b,c){"use strict";function d(a,b){b&&Object.keys(b).forEach(function(c){return a[c]=b[c]})}function e(a,b){b&&Object.keys(b).forEach(function(c){return a.setRegion(c,b[c])})}function f(a,b){b&&Object.keys(b).forEach(function(c){return a.node.addEventListener(c,b[c])})}function g(a,b){d(a,b.properties),e(a,b.regions)}function h(a,b){AwsUi.activate(a),g(a.component,b),f(a.component,b.events),a.component.hasBeenAttached()}var i=a("mithril"),j=a("./ClassBuilder"),k=a("./BrowserCapabilities"),l=function(){function a(a){this.browserCapabilities=k,this.ClassBuilder=j.ClassBuilder,this.component=a}return a.prototype.createComponent=function(a,b,c){var d={config:function(a,c,d){return c||"true"===a.getAttribute("initialized")?void g(a.component,b):(h(a,b),void(d.onunload=function(){return a.component.hasBeenDetached()}))}};return i(a,d,c)},a.prototype.region=function(a,b,c){void 0===b&&(b="div"),void 0===c&&(c={});var d=this.component.getRegion(a);if(d)return c["region-container"]=a,"string"==typeof d?i(b,c,d):(c.config=function(a,b,c){a.childNodes[0]!==d&&(a.innerHTML="",a.appendChild(d))},i(b,c))},a.prototype.copyDefined=function(a,b){function c(b,c){var d=a[c];return"undefined"!=typeof d&&(b[c]=d),b}return void 0===b&&(b=Object.keys(a)),b.reduce(c,{})},a.prototype.newEventHandler=function(a,b){var c=this;return function(d){if(!b||b.call(c.component,d)!==!1){var e=c.component.__fireEvent(a);e.defaultPrevented&&d.preventDefault()}}},a.prototype.newDeferredEventHandler=function(a,b){var c=this.newEventHandler(a,b);return function(a){setTimeout(function(){return c(a)},0)}},a}();Object.defineProperty(c,"__esModule",{value:!0}),c.default=l},{"./BrowserCapabilities":11,"./ClassBuilder":12,mithril:16}],15:[function(a,b,c){"use strict";function d(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}function e(a,b,c,d){if(void 0===c&&(c=!0),void 0===d&&(d=!0),"function"==typeof CustomEvent)return new CustomEvent(a,{detail:b,bubbles:c,cancelable:d});var e=document.createEvent("CustomEvent");e.initCustomEvent(a,c,d,b);var f=e.preventDefault;return e.preventDefault=function(){if(e.cancelable){f.call(e);try{Object.defineProperty(e,"defaultPrevented",{get:function(){return!0}})}catch(a){}}},e}function f(a){return a instanceof Node||a instanceof NodeList||Array.isArray(a)||a instanceof HTMLCollection}c.mixin=d,c.createCustomEvent=e,c.isNodeOrCollection=f},{}],16:[function(a,b,c){/*! mithril.js v0.1.34 | MIT License | github.com/lhorie/mithril.js */
var d=function a(b,c){
// self invoking function needed because of the way mocks work
function d(a){C=a.document,D=a.location,F=a.cancelAnimationFrame||a.clearTimeout,E=a.requestAnimationFrame||a.setTimeout}/**
	 * @typedef {String} Tag
	 * A string that looks like -> div.classname#id[param=one][param2=two]
	 * Which describes a DOM node
	 */
/**
	 *
	 * @param {Tag} The DOM node tag
	 * @param {Object=[]} optional key-value pairs to be mapped to DOM attrs
	 * @param {...mNode=[]} Zero or more Mithril child nodes. Can be an array, or splat (optional)
	 *
	 */
function e(){var a,b=[].slice.call(arguments),c=!(null==b[1]||K.call(b[1])!==G||"tag"in b[1]||"subtree"in b[1]),d=c?b[1]:{},e="class"in d?"class":"className",f={tag:"div",attrs:{}},g=[];if(K.call(b[0])!=I)throw new Error("selector in m(selector, attrs, children) should be a string");for(;a=L.exec(b[0]);)if(""===a[1]&&a[2])f.tag=a[2];else if("#"===a[1])f.attrs.id=a[2];else if("."===a[1])g.push(a[2]);else if("["===a[3][0]){var h=M.exec(a[3]);f.attrs[h[1]]=h[3]||!h[2]||""}g.length>0&&(f.attrs[e]=g.join(" "));var i=c?b.slice(2):b.slice(1);1===i.length&&K.call(i[0])===H?f.children=i[0]:f.children=i;for(var j in d)if(j===e){var k=f.attrs[j];f.attrs[j]=(k&&d[j]?k+" ":k||"")+d[j]}else f.attrs[j]=d[j];return f}function f(a,b,d,j,l,m,n,o,p,q,r){
//`build` is a recursive function that manages creation/diffing/removal of DOM elements based on comparison between `data` and `cached`
//the diff algorithm can be summarized as this:
//1 - compare `data` and `cached`
//2 - if they are different, copy `data` to `cached` and update the DOM based on what the difference is
//3 - recursively apply this algorithm for every array and for the children of every virtual element
//the `cached` data structure is essentially the same as the previous redraw's `data` data structure, with a few additions:
//- `cached` always has a property called `nodes`, which is a list of DOM elements that correspond to the data represented by the respective virtual element
//- in order to support attaching `nodes` as a property of `cached`, `cached` is *always* a non-primitive object, i.e. if the data was a string, then cached is a String instance. If data was `null` or `undefined`, cached is `new String("")`
//- `cached also has a `configContext` property, which is the state storage object exposed by config(element, isInitialized, context)
//- when `cached` is an Object, it represents a virtual element; when it's an Array, it represents a list of elements; when it's a String, Number or Boolean, it represents a text node
//`parentElement` is a DOM element used for W3C DOM API calls
//`parentTag` is only used for handling a corner case for textarea values
//`parentCache` is used to remove nodes in some multi-node cases
//`parentIndex` and `index` are used to figure out the offset of nodes. They're artifacts from before arrays started being flattened and are likely refactorable
//`data` and `cached` are, respectively, the new and old nodes being diffed
//`shouldReattach` is a flag indicating whether a parent node was recreated (if so, and if this node is reused, then this node must reattach itself to the new parent)
//`editable` is a flag that indicates whether an ancestor is contenteditable
//`namespace` indicates the closest HTML namespace as it cascades down from an ancestor
//`configs` is a list of config functions to run after the topmost `build` call finishes running
//there's logic that relies on the assumption that null and undefined data are equivalent to empty strings
//- this prevents lifecycle surprises from procedural helpers that mix implicit and explicit return statements (e.g. function foo() {if (cond) return m("div")}
//- it simplifies diffing code
//data.toString() is null if data is the return value of Console.log in Firefox
try{null!=l&&null!=l.toString()||(l="")}catch(a){l=""}if("retain"===l.subtree)return m;var s=K.call(m),t=K.call(l);if(null==m||s!==t){if(null!=m)if(d&&d.nodes){var u=o-j,v=u+(t===H?l:m.nodes).length;i(d.nodes.slice(u,v),d.slice(u,v))}else m.nodes&&i(m.nodes,m);m=new l.constructor,m.tag&&(m={}),//if constructor creates a virtual dom element, use a blank object as the base cached node instead of copying the virtual el (#277)
m.nodes=[]}if(t===H){
//recursively flatten array
for(var w=0,x=l.length;w<x;w++)K.call(l[w])===H&&(l=l.concat.apply([],l),w--,//check current index again and flatten until there are no more nested arrays at that index
x=l.length);for(var y=[],z=m.length===l.length,A=0,B=1,D=2,E=3,F={},L=!1,w=0;w<m.length;w++)m[w]&&m[w].attrs&&null!=m[w].attrs.key&&(L=!0,F[m[w].attrs.key]={action:B,index:w});for(var M=0,w=0,x=l.length;w<x;w++)if(l[w]&&l[w].attrs&&null!=l[w].attrs.key){for(var O=0,x=l.length;O<x;O++)l[O]&&l[O].attrs&&null==l[O].attrs.key&&(l[O].attrs.key="__mithril__"+M++);break}if(L){var P=!1;if(l.length!=m.length)P=!0;else for(var Q,R,w=0;Q=m[w],R=l[w];w++)if(Q.attrs&&R.attrs&&Q.attrs.key!=R.attrs.key){P=!0;break}if(P){for(var w=0,x=l.length;w<x;w++)if(l[w]&&l[w].attrs&&null!=l[w].attrs.key){var S=l[w].attrs.key;F[S]?F[S]={action:E,index:w,from:F[S].index,element:m.nodes[F[S].index]||C.createElement("div")}:F[S]={action:D,index:w}}var T=[];for(var U in F)T.push(F[U]);var V=T.sort(g),W=new Array(m.length);W.nodes=m.nodes.slice();for(var X,w=0;X=V[w];w++){if(X.action===B&&(i(m[X.index].nodes,m[X.index]),W.splice(X.index,1)),X.action===D){var Y=C.createElement("div");Y.key=l[X.index].attrs.key,a.insertBefore(Y,a.childNodes[X.index]||null),W.splice(X.index,0,{attrs:{key:l[X.index].attrs.key},nodes:[Y]}),W.nodes[X.index]=Y}X.action===E&&(a.childNodes[X.index]!==X.element&&null!==X.element&&a.insertBefore(X.element,a.childNodes[X.index]||null),W[X.index]=m[X.from],W.nodes[X.index]=X.element)}m=W}}
//end key algorithm
for(var w=0,Z=0,x=l.length;w<x;w++){
//diff each item in the array
var $=f(a,b,m,o,l[w],m[Z],n,o+A||A,p,q,r);$!==c&&($.nodes.intact||(z=!1),
//fix offset of next element if item was a trusted string w/ more than one html element
//the first clause in the regexp matches elements
//the second clause (after the pipe) matches text nodes
A+=$.$trusted?($.match(/<[^\/]|\>\s*[^<]/g)||[0]).length:K.call($)===H?$.length:1,m[Z++]=$)}if(!z){
//diff the array itself
//update the list of DOM nodes by collecting the nodes from each item
for(var w=0,x=l.length;w<x;w++)null!=m[w]&&y.push.apply(y,m[w].nodes);
//remove items from the end of the array if the new array is shorter than the old one
//if errors ever happen here, the issue is most likely a bug in the construction of the `cached` data structure somewhere earlier in the program
for(var _,w=0;_=m.nodes[w];w++)null!=_.parentNode&&y.indexOf(_)<0&&i([_],[m[w]]);l.length<m.length&&(m.length=l.length),m.nodes=y}}else if(null!=l&&t===G){l.attrs||(l.attrs={}),m.attrs||(m.attrs={});var aa=Object.keys(l.attrs),ba=aa.length>("key"in l.attrs?1:0);if(
//if an element is different enough from the one in cache, recreate it
(l.tag!=m.tag||aa.join()!=Object.keys(m.attrs).join()||l.attrs.id!=m.attrs.id||"all"==e.redraw.strategy()&&m.configContext&&m.configContext.retain!==!0||"diff"==e.redraw.strategy()&&m.configContext&&m.configContext.retain===!1)&&(m.nodes.length&&i(m.nodes),m.configContext&&typeof m.configContext.onunload===J&&m.configContext.onunload()),K.call(l.tag)!=I)return;var _,ca=0===m.nodes.length;
//schedule configs to be called. They are called after `build` finishes running
if(l.attrs.xmlns?q=l.attrs.xmlns:"svg"===l.tag?q="http://www.w3.org/2000/svg":"math"===l.tag&&(q="http://www.w3.org/1998/Math/MathML"),ca?(_=l.attrs.is?q===c?C.createElement(l.tag,l.attrs.is):C.createElementNS(q,l.tag,l.attrs.is):q===c?C.createElement(l.tag):C.createElementNS(q,l.tag),m={tag:l.tag,
//set attributes first, then create children
attrs:ba?h(_,l.tag,l.attrs,{},q):l.attrs,children:null!=l.children&&l.children.length>0?f(_,l.tag,c,c,l.children,m.children,!0,0,l.attrs.contenteditable?_:p,q,r):l.children,nodes:[_]},m.children&&!m.children.nodes&&(m.children.nodes=[]),
//edge case: setting value on <select> doesn't work before children exist, so set it again after children have been created
"select"===l.tag&&l.attrs.value&&h(_,l.tag,{value:l.attrs.value},{},q),a.insertBefore(_,a.childNodes[o]||null)):(_=m.nodes[0],ba&&h(_,l.tag,l.attrs,m.attrs,q),m.children=f(_,l.tag,c,c,l.children,m.children,!1,0,l.attrs.contenteditable?_:p,q,r),m.nodes.intact=!0,n===!0&&null!=_&&a.insertBefore(_,a.childNodes[o]||null)),typeof l.attrs.config===J){var da=m.configContext=m.configContext||{retain:"diff"==e.redraw.strategy()||c},ea=function(a,b){return function(){return a.attrs.config.apply(a,b)}};r.push(ea(l,[_,!ca,da,m]))}}else if(typeof l!=J){
//handle text nodes
var y;0===m.nodes.length?(l.$trusted?y=k(a,o,l):(y=[C.createTextNode(l)],a.nodeName.match(N)||a.insertBefore(y[0],a.childNodes[o]||null)),m="string number boolean".indexOf(typeof l)>-1?new l.constructor(l):l,m.nodes=y):m.valueOf()!==l.valueOf()||n===!0?(y=m.nodes,p&&p===C.activeElement||(l.$trusted?(i(y,m),y=k(a,o,l)):
//corner case: replacing the nodeValue of a text node that is a child of a textarea/contenteditable doesn't work
//we need to update the value property of the parent textarea or the innerHTML of the contenteditable element instead
"textarea"===b?a.value=l:p?p.innerHTML=l:((1===y[0].nodeType||y.length>1)&&(//was a trusted string
i(m.nodes,m),y=[C.createTextNode(l)]),a.insertBefore(y[0],a.childNodes[o]||null),y[0].nodeValue=l)),m=new l.constructor(l),m.nodes=y):m.nodes.intact=!0}return m}function g(a,b){return a.action-b.action||a.index-b.index}function h(a,b,c,d,e){for(var f in c){var g=c[f],h=d[f];if(f in d&&h===g)"value"===f&&"input"===b&&a.value!=g&&(a.value=g);else{d[f]=g;try{
//`config` isn't a real attributes, so ignore it
if("config"===f||"key"==f)continue;if(typeof g===J&&0===f.indexOf("on"))a[f]=l(g,a);else if("style"===f&&null!=g&&K.call(g)===G){for(var i in g)null!=h&&h[i]===g[i]||(a.style[i]=g[i]);for(var i in h)i in g||(a.style[i]="")}else null!=e?"href"===f?a.setAttributeNS("http://www.w3.org/1999/xlink","href",g):"className"===f?a.setAttribute("class",g):a.setAttribute(f,g):f in a&&"list"!==f&&"style"!==f&&"form"!==f&&"type"!==f&&"width"!==f&&"height"!==f?
//#348 don't set the value if not needed otherwise cursor placement breaks in Chrome
"input"===b&&a[f]===g||(a[f]=g):a.setAttribute(f,g)}catch(a){
//swallow IE's invalid argument errors to mimic HTML's fallback-to-doing-nothing-on-invalid-attributes behavior
if(a.message.indexOf("Invalid argument")<0)throw a}}}return d}function i(a,b){for(var c=a.length-1;c>-1;c--)if(a[c]&&a[c].parentNode){try{a[c].parentNode.removeChild(a[c])}catch(a){}//ignore if this fails due to order of events (see http://stackoverflow.com/questions/21926083/failed-to-execute-removechild-on-node)
b=[].concat(b),b[c]&&j(b[c])}0!=a.length&&(a.length=0)}function j(a){if(a.configContext&&typeof a.configContext.onunload===J&&(a.configContext.onunload(),a.configContext.onunload=null),a.children)if(K.call(a.children)===H)for(var b,c=0;b=a.children[c];c++)j(b);else a.children.tag&&j(a.children)}function k(a,b,c){var d=a.childNodes[b];if(d){var e=1!=d.nodeType,f=C.createElement("span");e?(a.insertBefore(f,d||null),f.insertAdjacentHTML("beforebegin",c),a.removeChild(f)):d.insertAdjacentHTML("beforebegin",c)}else a.insertAdjacentHTML("beforeend",c);for(var g=[];a.childNodes[b]!==d;)g.push(a.childNodes[b]),b++;return g}function l(a,b){return function(c){c=c||event,e.redraw.strategy("diff"),e.startComputation();try{return a.call(b,c)}finally{aa()}}}function m(a){var b=Q.indexOf(a);return b<0?Q.push(a)-1:b}function n(a){var b=function(){return arguments.length&&(a=arguments[0]),a};return b.toJSON=function(){return a},b}function o(){for(var a,b=0;a=T[b];b++)V[b]&&e.render(a,U[b].view?U[b].view(V[b]):$());
//after rendering within a routed context, we need to scroll back to the top, and fetch the document title for history.pushState
Y&&(Y(),Y=null),W=null,X=new Date,e.redraw.strategy("diff")}function p(a){return a.slice(da[e.route.mode].length)}function q(a,b,c){ba={};var d=c.indexOf("?");d!==-1&&(ba=u(c.substr(d+1,c.length)),c=c.substr(0,d));
// Get all routes and check if there's
// an exact match for the current path
var f=Object.keys(b),g=f.indexOf(c);if(g!==-1)return e.module(a,b[f[g]]),!0;for(var h in b){if(h===c)return e.module(a,b[h]),!0;var i=new RegExp("^"+h.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(i.test(c))return c.replace(i,function(){for(var c=h.match(/:[^\/]+/g)||[],d=[].slice.call(arguments,1,-2),f=0,g=c.length;f<g;f++)ba[c[f].replace(/:|\./g,"")]=decodeURIComponent(d[f]);e.module(a,b[h])}),!0}}function r(a){if(a=a||event,!a.ctrlKey&&!a.metaKey&&2!==a.which){a.preventDefault?a.preventDefault():a.returnValue=!1;for(var b=a.currentTarget||a.srcElement,c="pathname"===e.route.mode&&b.search?u(b.search.slice(1)):{};b&&"A"!=b.nodeName.toUpperCase();)b=b.parentNode;e.route(b[e.route.mode].slice(da[e.route.mode].length),c)}}function s(){"hash"!=e.route.mode&&D.hash?D.hash=D.hash:b.scrollTo(0,0)}function t(a,b){var d={},e=[];for(var f in a){var g=b?b+"["+f+"]":f,h=a[f],i=K.call(h),j=null===h?encodeURIComponent(g):i===G?t(h,g):i===H?h.reduce(function(a,b){return d[g]||(d[g]={}),d[g][b]?a:(d[g][b]=!0,a.concat(encodeURIComponent(g)+"="+encodeURIComponent(b)))},[]).join("&"):encodeURIComponent(g)+"="+encodeURIComponent(h);h!==c&&e.push(j)}return e.join("&")}function u(a){for(var b=a.split("&"),c={},d=0,e=b.length;d<e;d++){var f=b[d].split("="),g=decodeURIComponent(f[0]),h=2==f.length?decodeURIComponent(f[1]):null;null!=c[g]?(K.call(c[g])!==H&&(c[g]=[c[g]]),c[g].push(h)):c[g]=h}return c}function v(a){var b=m(a);i(a.childNodes,R[b]),R[b]=c}function w(a,b){var c=e.prop(b);return a.then(c),c.then=function(c,d){return w(a.then(c,d),b)},c}
//Promiz.mithril.js | Zolmeister | MIT
//a modified version of Promiz.js, which does not conform to Promises/A+ for two reasons:
//1) `then` callbacks are called synchronously (because setTimeout is too slow, and the setImmediate polyfill is too big
//2) throwing subclasses of Error cause the error to be bubbled up instead of triggering rejection (because the spec does not account for the important use case of default browser error handling, i.e. message w/ line number)
function x(a,b){function c(a){l=a||j,n.map(function(a){l===i&&a.resolve(m)||a.reject(m)})}function d(a,b,c,d){if((null!=m&&K.call(m)===G||typeof m===J)&&typeof a===J)try{
// count protects against abuse calls from spec checker
var f=0;a.call(m,function(a){f++||(m=a,b())},function(a){f++||(m=a,c())})}catch(a){e.deferred.onerror(a),m=a,c()}else d()}function f(){
// check if it's a thenable
var j;try{j=m&&m.then}catch(a){return e.deferred.onerror(a),m=a,l=h,f()}d(j,function(){l=g,f()},function(){l=h,f()},function(){try{l===g&&typeof a===J?m=a(m):l===h&&"function"==typeof b&&(m=b(m),l=g)}catch(a){return e.deferred.onerror(a),m=a,c()}m===k?(m=TypeError(),c()):d(j,function(){c(i)},c,function(){c(l===g&&i)})})}var g=1,h=2,i=3,j=4,k=this,l=0,m=0,n=[];k.promise={},k.resolve=function(a){return l||(m=a,l=g,f()),this},k.reject=function(a){return l||(m=a,l=h,f()),this},k.promise.then=function(a,b){var c=new x(a,b);return l===i?c.resolve(m):l===j?c.reject(m):n.push(c),c.promise}}function y(a){return a}function z(a){if(!a.dataType||"jsonp"!==a.dataType.toLowerCase()){var d=new b.XMLHttpRequest;if(d.open(a.method,a.url,!0,a.user,a.password),d.onreadystatechange=function(){4===d.readyState&&(d.status>=200&&d.status<300?a.onload({type:"load",target:d}):a.onerror({type:"error",target:d}))},a.serialize===JSON.stringify&&a.data&&"GET"!==a.method&&d.setRequestHeader("Content-Type","application/json; charset=utf-8"),a.deserialize===JSON.parse&&d.setRequestHeader("Accept","application/json, text/*"),typeof a.config===J){var e=a.config(d,a);null!=e&&(d=e)}var f="GET"!==a.method&&a.data?a.data:"";if(f&&K.call(f)!=I&&f.constructor!=b.FormData)throw"Request data should be either be a string or FormData. Check the `serialize` option in `m.request`";return d.send(f),d}var g="mithril_callback_"+(new Date).getTime()+"_"+Math.round(1e16*Math.random()).toString(36),h=C.createElement("script");b[g]=function(d){h.parentNode.removeChild(h),a.onload({type:"load",target:{responseText:d}}),b[g]=c},h.onerror=function(d){return h.parentNode.removeChild(h),a.onerror({type:"error",target:{status:500,responseText:JSON.stringify({error:"Error making jsonp request"})}}),b[g]=c,!1},h.onload=function(a){return!1},h.src=a.url+(a.url.indexOf("?")>0?"&":"?")+(a.callbackKey?a.callbackKey:"callback")+"="+g+"&"+t(a.data||{}),C.body.appendChild(h)}function A(a,b,c){if("GET"===a.method&&"jsonp"!=a.dataType){var d=a.url.indexOf("?")<0?"?":"&",e=t(b);a.url=a.url+(e?d+e:"")}else a.data=c(b);return a}function B(a,b){var c=a.match(/:[a-z]\w+/gi);if(c&&b)for(var d=0;d<c.length;d++){var e=c[d].slice(1);a=a.replace(c[d],b[e]),delete b[e]}return a}var C,D,E,F,G="[object Object]",H="[object Array]",I="[object String]",J="function",K={}.toString,L=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,M=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/,N=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/;d(b);var O,P={appendChild:function(a){O===c&&(O=C.createElement("html")),C.documentElement&&C.documentElement!==a?C.replaceChild(a,C.documentElement):C.appendChild(a),this.childNodes=C.childNodes},insertBefore:function(a){this.appendChild(a)},childNodes:[]},Q=[],R={};e.render=function(a,b,d){var e=[];if(!a)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var g=m(a),h=a===C,j=h||a===C.documentElement?P:a;h&&"html"!=b.tag&&(b={tag:"html",attrs:{},children:b}),R[g]===c&&i(j.childNodes),d===!0&&v(a),R[g]=f(j,null,c,c,b,R[g],!1,0,null,c,e);for(var k=0,l=e.length;k<l;k++)e[k]()},e.trust=function(a){return a=new String(a),a.$trusted=!0,a},e.prop=function(a){
//note: using non-strict equality check here because we're checking if store is null OR undefined
//note: using non-strict equality check here because we're checking if store is null OR undefined
return(null!=a&&K.call(a)===G||typeof a===J)&&typeof a.then===J?w(a):n(a)};var S,T=[],U=[],V=[],W=null,X=0,Y=null,Z=16;//60 frames per second = 1 call per 16 ms
e.module=function(a,b){if(!a)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var c=T.indexOf(a);c<0&&(c=T.length);var d=!1;if(V[c]&&typeof V[c].onunload===J){var f={preventDefault:function(){d=!0}};V[c].onunload(f)}if(!d){e.redraw.strategy("all"),e.startComputation(),T[c]=a;var g=S=b=b||{},h=new(b.controller||function(){});
//controllers may call m.module recursively (via m.route redirects, for example)
//this conditional ensures only the last recursive m.module call is applied
return g===S&&(V[c]=h,U[c]=b),aa(),V[c]}},e.redraw=function(a){
//lastRedrawId is a positive number if a second redraw is requested before the next animation frame
//lastRedrawID is null if it's the first redraw and not an event handler
W&&a!==!0?
//when setTimeout: only reschedule redraw if time between now and previous redraw is bigger than a frame, otherwise keep currently scheduled timeout
//when rAF: always reschedule redraw
(new Date-X>Z||E===b.requestAnimationFrame)&&(W>0&&F(W),W=E(o,Z)):(o(),W=E(function(){W=null},Z))},e.redraw.strategy=e.prop();var $=function(){return""},_=0;e.startComputation=function(){_++},e.endComputation=function(){_=Math.max(_-1,0),0===_&&e.redraw()};var aa=function(){"none"==e.redraw.strategy()?(_--,e.redraw.strategy("diff")):e.endComputation()};e.withAttr=function(a,b){return function(c){c=c||event;var d=c.currentTarget||this;b(a in d?d[a]:d.getAttribute(a))}};
//routing
var ba,ca,da={pathname:"",hash:"#",search:"?"},ea=function(){};
//testing API
//for internal testing only, do not use `m.deps.factory`
return e.route=function(){
//m.route()
if(0===arguments.length)return ca;if(3===arguments.length&&K.call(arguments[1])===I){var a=arguments[0],c=arguments[1],d=arguments[2];ea=function(b){var f=ca=p(b);q(a,d,f)||e.route(c,!0)};var f="hash"===e.route.mode?"onhashchange":"onpopstate";b[f]=function(){var a=D[e.route.mode];"pathname"===e.route.mode&&(a+=D.search),ca!=p(a)&&ea(a)},Y=s,b[f]()}else if(arguments[0].addEventListener||arguments[0].attachEvent){var g=arguments[0];arguments[1],arguments[2];g.href=("pathname"!==e.route.mode?D.pathname:"")+da[e.route.mode]+this.attrs.href,g.addEventListener?(g.removeEventListener("click",r),g.addEventListener("click",r)):(g.detachEvent("onclick",r),g.attachEvent("onclick",r))}else if(K.call(arguments[0])===I){var h=ca;ca=arguments[0];var i=arguments[1]||{},j=ca.indexOf("?"),k=j>-1?u(ca.slice(j+1)):{};for(var l in i)k[l]=i[l];var m=t(k),n=j>-1?ca.slice(0,j):ca;m&&(ca=n+(n.indexOf("?")===-1?"?":"&")+m);var o=(3===arguments.length?arguments[2]:arguments[1])===!0||h===arguments[0];b.history.pushState?(Y=function(){b.history[o?"replaceState":"pushState"](null,C.title,da[e.route.mode]+ca),s()},ea(da[e.route.mode]+ca)):(D[e.route.mode]=ca,ea(da[e.route.mode]+ca))}},e.route.param=function(a){if(!ba)throw new Error("You must call m.route(element, defaultRoute, routes) before calling m.route.param()");return ba[a]},e.route.mode="search",e.route.buildQueryString=t,e.route.parseQueryString=u,e.deferred=function(){var a=new x;return a.promise=w(a.promise),a},e.deferred.onerror=function(a){if("[object Error]"===K.call(a)&&!a.constructor.toString().match(/ Error/))throw a},e.sync=function(a){function b(a,b){return function(e){return g[a]=e,b||(c="reject"),0===--f&&(d.promise(g),d[c](g)),e}}var c="resolve",d=e.deferred(),f=a.length,g=new Array(f);if(a.length>0)for(var h=0;h<a.length;h++)a[h].then(b(h,!0),b(h,!1));else d.resolve([]);return d.promise},e.request=function(a){a.background!==!0&&e.startComputation();var b=new x,c=a.dataType&&"jsonp"===a.dataType.toLowerCase(),d=a.serialize=c?y:a.serialize||JSON.stringify,f=a.deserialize=c?y:a.deserialize||JSON.parse,g=a.extract||function(a){return 0===a.responseText.length&&f===JSON.parse?null:a.responseText};return a.url=B(a.url,a.data),a=A(a,a.data,d),a.onload=a.onerror=function(c){try{c=c||event;var d=("load"===c.type?a.unwrapSuccess:a.unwrapError)||y,h=d(f(g(c.target,a)),c.target);if("load"===c.type)if(K.call(h)===H&&a.type)for(var i=0;i<h.length;i++)h[i]=new a.type(h[i]);else a.type&&(h=new a.type(h));b["load"===c.type?"resolve":"reject"](h)}catch(a){e.deferred.onerror(a),b.reject(a)}a.background!==!0&&e.endComputation()},z(a),b.promise=w(b.promise,a.initialValue),b.promise},e.deps=function(a){return d(b=a||b),b},e.deps.factory=a,e}("undefined"!=typeof window?window:{});"undefined"!=typeof b&&null!==b&&b.exports?b.exports=d:"function"==typeof define&&define.amd&&define(function(){return d})},{}],17:[function(a,b,c){"use strict";var d=a("./AwsUi");window.AwsUi=d,d.__Metrics.sendMetricOnce("awsui-runtime-loaded",1),d.__Metrics.sendMetricOnce("awsui-viewport-width",window.innerWidth||0),d.__Metrics.sendMetricOnce("awsui-viewport-height",window.innerHeight||0);var e=a("./BasePrototype/RenderHandling");window._AwsUiJsxHelpers={createElement:e.__createElement}},{"./AwsUi":2,"./BasePrototype/RenderHandling":10}]},{},[17]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d=350,e=function(){function a(a){this.component=a}return a.prototype.updateState=function(a,b){this.component.__animationState[a]=b,this.component.__animationState=this.component.__animationState},a.prototype.animate=function(a){var b=this,c=this.component.node.querySelector(".awsui-accordion-section-content-container"),e="1px";if(c){this.component.__animationState={isAnimating:!1};var f=c.scrollHeight+"px";this.updateState("height",a?e:f),setTimeout(function(){b.updateState("isAnimating",!0),setTimeout(function(){return b.updateState("height",a?f:e)})}),setTimeout(function(){return b.component.__animationState=void 0},d)}},a}();Object.defineProperty(c,"__esModule",{value:!0}),c.default=e},{}],2:[function(a,b,c){"use strict";function d(a){return a.component&&"awsui-accordion-section"===a.component.__componentName}function e(a,b,c){for(var d=0,e=b;d<e.length;d++){var f=e[d];if(f.component.sectionId===c)return f}}function f(a){if(!a.__expandedSection||a.__expandedSection.sectionId!==a.expandedSectionId){var b,c=a.node.querySelectorAll("awsui-accordion-section");b=a.expandedSectionId?e(a,c,a.expandedSectionId):c[0],b&&g(a,b.component)}}function g(a,b,c){void 0===c&&(c=!1),a.__expandedSection=b;for(var d=a.node.querySelectorAll("awsui-accordion-section"),e=0,f=d;e<f.length;e++){var g=f[e];g.component&&g.component.__toggle(g.component===a.__expandedSection,c)}}var h=a("./AccordionAnimator");AwsUi.__addComponent("awsui-accordion-section",{releaseStatus:"preview",events:{expand:{bubbles:!0,cancelable:!1},collapse:{bubbles:!0,cancelable:!1},__expand:{bubbles:!0,cancelable:!0}},properties:{header:{type:"string"},sectionId:{type:"string",announceValue:!0},__expanded:{type:"boolean"},__animationState:{type:"object"}},functions:{expand:function(){this.__expanded||this.__fireEvent("__expand")},__toggle:function(a,b){a!==this.__expanded&&(this.__expanded=a,b&&(this.__animator||(this.__animator=new h.default(this)),this.__animator.animate(a)))}},regions:{content:{isDefault:!0}},render:function(a,b){var c=this,d=function(){var d=new b.ClassBuilder(c);return d.addClass("awsui-accordion-section-header"),d.addClass("awsui-accordion-section-header-expandable",!c.__expanded),d.addClass("awsui-icon"),d.addClass("caret-down",c.__expanded),d.addClass("caret-up",!c.__expanded),a("h3",{className:d.toClassName(),onclick:function(){c.__expanded||(c.__fireEvent("__expand",{fromUser:!0}),c.__fireEvent("expand"))}},c.header)},e=function(){var d=new b.ClassBuilder(c);d.addClass("awsui-accordion-section-content-container"),d.addClass("awsui-accordion-section-animating",c.__animationState&&c.__animationState.isAnimating),d.addClass("awsui-accordion-section-expanded",c.__expanded||c.__animationState);var e={};c.__animationState&&c.__animationState.height&&(e.height=c.__animationState.height);var f={className:d.toClassName(),style:e};return a("div",f,b.region("content","div",{className:"awsui-accordion-section-content"}))};return[d(),e()]}}),AwsUi.__addComponent("awsui-accordion-group",{releaseStatus:"preview",callbacks:{initialized:function(){var a=this;this.__listenToPropertyChanges("sectionId",function(b,c){d(c)&&(a.expandedSectionId||a.__expandedSection?a.expandedSectionId&&(c.component.__expanded=c.component.sectionId===a.expandedSectionId):g(a,c.component))}),this.node.addEventListener("awsui:__expand",function(b){d(b.target)&&(a.__expandedSection&&b.detail.fromUser&&a.__expandedSection.__fireEvent("collapse"),g(a,b.target.component,b.detail.fromUser),a.expandedSectionId=b.target.component.sectionId,a.__fireEvent("change"))})}},properties:{expandedSectionId:{type:"string",onChange:function(){f(this)}}},events:{change:{bubbles:!0,cancelable:!1}},regions:{content:{isDefault:!0}},render:function(a,b){return b.region("content","div",{className:"awsui-accordion-group-container"})},wrapperSupport:{ngModel:{value:"expandedSectionId",event:"change"}}})},{"./AccordionAnimator":1}]},{},[2]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){AwsUi.__addComponent("awsui-alert",{releaseStatus:"stable",events:{dismiss:{cancelable:!0},show:{cancelable:!1},hide:{cancelable:!1}},properties:{type:{nullable:!1,valid:["success","error","warning","info"],defaultValue:"info"},visible:{type:"boolean",defaultValue:!0,onChange:function(a,b){var c="awsui-alert-hidden";b?(this.node.removeAttribute(c),this.__fireEvent("show")):(this.node.setAttribute(c,c),this.__fireEvent("hide"))}},dismissible:{type:"boolean"}},regions:{header:{},content:{isDefault:!0}},functions:{dismiss:function(){var a=this.__fireEvent("dismiss");a.defaultPrevented||(this.visible=!1)}},render:function(a,b){function c(){var a=new b.ClassBuilder(f);return a.addClass("awsui-alert-inside").addClass("awsui-alert-type-"+f.type).addClass("awsui-alert-has-dismiss",f.dismissible).addClass("awsui-alert-has-header",f.getRegion("header")),a.toClassName()}function d(){if(f.dismissible){var c=new b.ClassBuilder(f);return c.addClass("awsui-button-as-link").addClass("awsui-icon").addClass("awsui-alert-times-"+f.type).addClass("awsui-alert-dismiss-control"),a("button",{className:c.toClassName(),"aria-label":"close",type:"button",onclick:function(){return f.dismiss()}})}}function e(){if(f.getRegion("header")){var c={success:"alert-check-circle",warning:"alert-exclamation-triangle",info:"alert-info-circle",error:"alert-exclamation-circle"},d=new b.ClassBuilder(f);d.addClass("awsui-alert-icon").addClass("awsui-icon").addClass("awsui-icon-big").addClass(c[f.type]);var e=a("span",{className:d.toClassName()});return[e,b.region("header","div",{className:"awsui-alert-header awsui-text-big"})]}}var f=this;return a("div",{className:c(),"aria-hidden":!this.visible,role:"alert"},[e(),b.region("content"),d()])}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){AwsUi.__addComponent("awsui-breadcrumb-item",{releaseStatus:"preview",properties:{text:{type:"string"},href:{type:"string"}},events:{click:{bubbles:!0,cancelable:!0},follow:{bubbles:!0,cancelable:!0}},render:function(a,b){var c=this,d=b.copyDefined({class:"awsui-breadcrumb-link",href:c.href||"#",onclick:b.newEventHandler("click",function(a){if(!(0!==a.button||a.ctrlKey||a.altKey||a.shiftKey||a.metaKey)){var b=this.__fireEvent("follow");b.defaultPrevented&&a.preventDefault()}})}),e=a("a",d,c.text);return e}}),AwsUi.__addComponent("awsui-breadcrumb-group",{releaseStatus:"preview",regions:{content:{isDefault:!0}},render:function(a,b){return b.region("content","nav",{class:"awsui-breadcrumb-list",role:"list"})}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){return"download"in document.createElement("a")||!e()}function e(){return"undefined"!=typeof window.navigator.msSaveBlob}function f(a){if(a.download&&a.href){var b=g(a.href)?i:h;b(a.download,a.href)}}function g(a){return"data:"===a.substr(0,5)}function h(a,b){var c=new XMLHttpRequest,d=function(){window.navigator.msSaveBlob(this.response,a)};c.addEventListener("load",d,!1),c.open("get",b,!0),c.responseType="blob",c.send()}function i(a,b){window.navigator.msSaveBlob(j(b),a)}function j(a){for(var b=atob(a.split(",")[1]),c=new ArrayBuffer(b.length),d=new Uint8Array(c),e=0;e<b.length;e++)d[e]=255&b.charCodeAt(e);return new Blob([c],{type:"application/octet-stream"})}c.supportsDownloadAttribute=d,c.forceDownload=f},{}],2:[function(a,b,c){"use strict";var d=a("./polyfills/download");AwsUi.__addComponent("awsui-button",{releaseStatus:"stable",properties:{disabled:{type:"boolean"},loading:{type:"boolean"},icon:{type:"string",valid:["angle-double-left","angle-double-right","angle-down","angle-left","angle-right","angle-up","area-chart","arrow-down","arrow-up","arrows-alt","bell-o","bolt","calendar","caret-down","caret-left","caret-right","caret-up","check-circle","caret-square-o-down","check","circle","clipboard","clock-o","cog","compress","download","ellipsis-v","envelope","exchange","exclamation-circle","exclamation-triangle","expand","external-link","files-o","filter","folder-open","font","hashtag","info-circle","line-chart","list","minus","pause-circle-o","pencil","play-circle-o","plus-circle","plus","print","question-circle","refresh","search","search-minus","search-plus","star-o","star","tag","th-large","times-circle","times","trash","upload","view-full","view-horizontal","view-vertical"]},iconAlign:{type:"string",nullable:!1,defaultValue:"left",valid:["left","right"]},formAction:{type:"string",nullable:!1,defaultValue:"submit",valid:["submit","none"]},label:{type:"string"},href:{type:"string"},download:{type:"string"},target:{type:"string"},size:{nullable:!1,type:"string",valid:["normal","small"],defaultValue:"normal"},variant:{nullable:!1,type:"string",valid:["normal","primary","danger","link","standalone-icon"],defaultValue:"normal"}},functions:{click:function(){this.__isDisabled()||this.__fireEvent("click"),this.__useCustomDownload()&&d.forceDownload(this)},__isDisabled:function(){return this.loading||this.disabled},__useCustomDownload:function(){return!d.supportsDownloadAttribute()&&this.download}},events:{click:{}},regions:{text:{isDefault:!0}},render:function(a,b){function c(){var a=new b.ClassBuilder(j);return a.addClass("awsui-spinner").addClass("awsui-spinner-disabled",!p).addClass("awsui-spinner-light",p).addClass("awsui-button-icon").addClass("awsui-button-icon-left"),a.toClassName()}function d(){var a=!p&&j.__isDisabled(),c=m&&!a,d="link"===j.variant&&!a,e=new b.ClassBuilder(j);return e.addClass(n).addClass("awsui-icon").addClass("awsui-icon-disabled",a).addClass("awsui-icon-has-hover",c).addClass("awsui-icon-light",p).addClass("awsui-icon-link",d).addClass("awsui-button-icon").addClass("awsui-button-icon-"+o),e.toClassName()}function e(){var a=new b.ClassBuilder(j);return a.addClass("awsui-button").addPropertyValueClass("size").addPropertyValueClass("variant").addClass("awsui-hover-child-icons").addClass("awsui-button-no-text",!i()).addClass("awsui-button-disabled",j.__isDisabled()).addClass("awsui-button-as-link",m),a.toClassName()}function f(a){return k&&j.__isDisabled()?a.preventDefault():(j.__useCustomDownload()&&a.preventDefault(),void j.click())}function g(){return j.loading?a("span",{className:c()}):n&&"left"===o?a("span",{className:d()}):void 0}function h(){if(n&&"right"===o)return a("span",{className:d()})}function i(){return b.region("text","span")||""}var j=this,k=Boolean(j.href),l=k?"a":"button",m="standalone-icon"===j.variant,n=j.icon,o=m?"left":j.iconAlign,p="primary"===j.variant||"danger"===j.variant,q=[g(),i(),h()],r="none"===j.formAction?"button":"submit",s=a(l,b.copyDefined({className:e(),"aria-label":j.label,onclick:f,href:j.href,download:j.href?j.download:void 0,role:k?"button":void 0,type:k?void 0:r,target:j.href&&j.target?j.target:void 0,disabled:!(!j.__isDisabled()||k)||void 0,"aria-disabled":!(!j.__isDisabled()||!k)||void 0}),q);return s}}),AwsUi.__addComponent("awsui-button-group",{releaseStatus:"stable",regions:{content:{isDefault:!0}},render:function(a,b){return b.region("content","div",{className:"awsui-button-group-content"})}});var e="awsui-button-dropdown",f=27,g=40,h=38;AwsUi.__addComponent("awsui-button-dropdown",{releaseStatus:"experimental",callbacks:{initialized:function(){var a=this;this.__keydownHandler=function(b){if(a.__expanded)switch(b.keyCode){case f:b.preventDefault(),a.__toggleDropdown();break;case g:b.preventDefault(),a.__switchItem(1);break;case h:b.preventDefault(),a.__switchItem(-1)}},this.__globalCloseClickHandler=function(b){a.__expanded&&!a.node.contains(b.target)&&(a.__expanded=!1)}},attached:function(){document.addEventListener("mouseup",this.__globalCloseClickHandler),document.addEventListener("keydown",this.__keydownHandler)},detached:function(){document.removeEventListener("mouseup",this.__globalCloseClickHandler),document.removeEventListener("keydown",this.__keydownHandler)}},properties:{items:{type:"array",itemType:"Item"},disabled:{type:"boolean"},loading:{type:"boolean"},__expanded:{type:"boolean"},__focusedItem:{type:"object",itemType:"Item"}},regions:{text:{isDefault:!0}},functions:{__toggleDropdown:function(){this.__expanded=!this.__expanded,this._expanded||(this.__focusedItem=null)},__isDisabled:function(){return this.loading||this.disabled},__focusItem:function(a){if(a!=this.__focusedItem){this.__focusedItem=a;var b=this.node.querySelector("."+e+"-item-focus");b&&b.focus()}},__findAllEnabledItems:function(){var a=[];return this.items?(this.items.forEach(function(b){if(!b.disabled)return b.items?void(a=a.concat(b.items.filter(function(a){return!a.disabled}))):void a.push(b)}),a):a},__switchItem:function(a){var b=this.__findAllEnabledItems(),c=b.indexOf(this.__focusedItem),d=c===-1?0:c+a;d>b.length-1&&(d=0),d<0&&(d=b.length-1),this.__focusItem(b[d])}},events:{itemClick:{bubbles:!0,cancelable:!1,detailTypeName:"ItemClick"}},render:function(a,b){function c(){function c(){var a=new b.ClassBuilder(f);return a.addClass("awsui-button").addClass("awsui-button-size-normal").addClass("awsui-button-variant-normal").addClass("awsui-button-disabled",g),a.toClassName()}function d(a){f.__isDisabled()||f.__toggleDropdown(),a.preventDefault()}function e(){var c=new b.ClassBuilder(f);return c.addClass("awsui-icon").addClass("awsui-button-icon").addClass("awsui-button-icon-right").addClass(f.loading?"awsui-spinner":"angle-down").addClass(f.loading?"awsui-spinner-disabled":"awsui-icon-disabled",g),a("span",{className:c.toClassName()})}function h(){return b.region("text","span")||""}return a("button",b.copyDefined({className:c(),onclick:d,type:"button",role:"button",disabled:g||void 0,"aria-disabled":g||void 0}),[h(),e()])}function d(){function c(){function c(c,g){void 0===g&&(g=!1);var h=g||c.disabled,i=new b.ClassBuilder(f);i.addClass(e+"-item").addClass(e+"-item-separator-bottom","bottom"===c.separator).addClass(e+"-item-disabled",h);var j=i.toClassName();return a("li",{className:j},d(c,h))}function d(c,d){var g=new b.ClassBuilder(f);if(g.addClass(e+"-item-content"),d){var h={className:g.toClassName(),"aria-disabled":!0};return a("span",h,c.text)}g.addClass(e+"-item-focus",c===f.__focusedItem);var i={href:"#",className:g.toClassName(),onmouseover:function(a){f.__focusItem(c)},onfocus:function(a){f.__focusItem(c)},onclick:function(a){a.preventDefault(),f.__fireEvent("itemClick",{id:c.id}),f.__toggleDropdown()}};return a("a",i,c.text)}function g(d){var g=d.items.map(function(a){return c(a,d.disabled)}),h=a("ul",{className:e+"-content"},g),i=new b.ClassBuilder(f);return i.addClass(e+"-category-heading").addClass(e+"-item-disabled",d.disabled),a("li",{className:e+"-category"},[a("p",{className:i.toClassName()},d.text),h])}function h(a){return a.items?g(a):c(a)}var i=f.items.map(h);return a("ul",{className:e+"-content"},i)}if(f.items&&0!==f.items.length&&!f.__isDisabled()&&f.__expanded)return a("div",{className:e},c())}var f=this,g=f.__isDisabled();return a("div",[c(),d()])}})},{"./polyfills/download":1}]},{},[2]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){return"awsui-checkbox-"+f++}var e=function(a){return a.node.querySelector("input")},f=0;AwsUi.__addComponent("awsui-checkbox",{releaseStatus:"stable",callbacks:{initialized:function(){this.controlId||(this.controlId=d())}},properties:{checked:{type:"boolean"},disabled:{type:"boolean"},controlId:{type:"string"}},events:{focus:{bubbles:!0,cancelable:!1},blur:{bubbles:!0,cancelable:!1},check:{bubbles:!0,cancelable:!0},uncheck:{bubbles:!0,cancelable:!0},change:{bubbles:!0,cancelable:!0}},render:function(a,b){function c(){if(e.label){var c=b.region("label","label",{for:e.controlId});return a("span",{className:"awsui-checkbox-label"},c)}}var d=this,e=this,f=["checked","disabled"],g=b.copyDefined(this,f),h=new b.ClassBuilder(this);h.addClass("awsui-checkbox-styled-box").addClass("awsui-checkbox-styled-box-disabled",this.disabled).addClass("awsui-checkbox-styled-box-checked",this.checked),g.id=this.controlId,g.className="awsui-native-internal-checkbox",g.type="checkbox",g.onchange=a.withAttr("checked",function(a){d.checked=a,d.__fireEvent("change"),d.__fireEvent(d.checked?"check":"uncheck")}),g.onfocus=b.newEventHandler("focus"),g.onblur=b.newEventHandler("blur");var i={className:"awsui-checkbox-wrapper-label"},j=a("div",{className:h.toClassName()});return[a("label",i,a("input",g),j),c()]},functions:{focus:function(){e(this).focus()},blur:function(){e(this).blur()}},regions:{label:{isDefault:!0}},wrapperSupport:{ngModel:{value:"checked",event:"change"}}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";AwsUi.__addComponent("awsui-control-group",{releaseStatus:"stable",callbacks:{initialized:function(){var a=this;this.__listenToPropertyChanges("controlId",function(b){return a.__discoveredControlId=b})}},functions:{__isValid:function(){return!this.validationMessage}},render:function(a,b){var c=this,d=new b.ClassBuilder(c).addClass("awsui-control-group-inside").addClass("awsui-control-group-invalid",!c.__isValid()).addPropertyValueClass("layoutVariant"),e=function(){return a("div",{className:"awsui-control-group-label-with-tooltip"},[g(),k()])},f=function(){return g()},g=function(){var b=c.controlId||c.__discoveredControlId,d={className:"awsui-control-group-label"};return b&&(d.for=b),a("label",d,c.label)},h=function(){return a("div",{className:"awsui-control-group-controls"},[j(),k(),n(),o()])},i=function(){return a("div",{className:"awsui-control-group-controls"},[j(),n(),o()])},j=function(){return b.region("control","div",{className:"awsui-control-group-control"})},k=function(){if(c.detail)return a("div",{className:"awsui-control-group-tooltip"},a("div",{className:"awsui-control-group-tooltip-inner"},[l(),m()]))},l=function(){return a("span",{className:"awsui-control-group-tooltip-icon awsui-icon info-circle awsui-icon-has-hover"})},m=function(){return b.region("detail","span",{className:"awsui-control-group-tooltip-text"})},n=function(){if(c.instructional)return b.region("instructional","div",{className:"awsui-control-group-instructional-message"})},o=function(){if(!c.__isValid())return b.region("validationMessage","div",{className:"awsui-control-group-validation-message"})},p="stacked"===c.layoutVariant?[e(),i()]:[f(),h()];return a("div",{className:d.toClassName()},p)},properties:{label:{},controlId:{type:"string"},layoutVariant:{type:"string",valid:["default","stacked"],defaultValue:"default"},__discoveredControlId:{type:"string"}},regions:{control:{isDefault:!0},detail:{},instructional:{},validationMessage:{}}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){return"awsui-expandable-section-"+e++}var e=0;AwsUi.__addComponent("awsui-expandable-section",{releaseStatus:"stable",callbacks:{initialized:function(){this.controlId=d()}},properties:{header:{type:"string"},expanded:{type:"boolean"}},regions:{content:{isDefault:!0}},events:{expand:{bubbles:!0,cancelable:!1},collapse:{bubbles:!0,cancelable:!1}},render:function(a,b){function c(){var c=new b.ClassBuilder(e);c.addClass("awsui-expandable-section-header").addClass("awsui-icon").addClass(e.expanded?"caret-down":"caret-right");var d={class:c.toClassName(),"aria-controls":e.controlId,onclick:function(){e.expanded=!e.expanded,e.__fireEvent(e.expanded?"expand":"collapse")}};return a("h3",d,e.header)}function d(){var a=new b.ClassBuilder(e);a.addClass("awsui-expandable-section-content").addClass("awsui-expandable-section-expanded",e.expanded);var c={class:a.toClassName(),role:"region",id:e.controlId,"aria-expanded":e.expanded};return b.region("content","div",c)}var e=this;return[c(),d()]}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){AwsUi.__addComponent("awsui-label",{releaseStatus:"stable",properties:{type:{type:"string",nullable:!1,valid:["success","error","warning","info","disabled"],defaultValue:"info"},label:{type:"string"}},render:function(a,b){var c=new b.ClassBuilder(this);return c.addPropertyValueClass("type"),c.addClass("awsui-label-content"),_AwsUiJsxHelpers.createElement("span",{className:c.toClassName()},this.label)}}),AwsUi.__addComponent("awsui-badge",{releaseStatus:"stable",properties:{type:{type:"string",nullable:!1,valid:["success","error","warning","info","disabled"],defaultValue:"info"},value:{type:"integer",nullable:!1,defaultValue:0}},render:function(a,b){var c=new b.ClassBuilder(this);return c.addPropertyValueClass("type"),c.addClass("awsui-badge-content"),_AwsUiJsxHelpers.createElement("span",{className:c.toClassName()},this.value)}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){f(),k.addClass(document.body,l)}function e(){k.removeClass(document.body,l),h()}function f(){if(j()){m=document.body.style.paddingRight;var a=g(),b=i(),c=a+b;document.body.style.paddingRight=c+"px"}}function g(){return parseInt(window.getComputedStyle(document.body).paddingRight,10)}function h(){m?document.body.style.paddingRight=m:document.body.style.removeProperty("padding-right"),m=null}function i(){var a=document.createElement("div");a.className="awsui-modal-scrollbar-measure",document.body.appendChild(a);var b=a.offsetWidth-a.clientWidth;return document.body.removeChild(a),b}function j(){return document.body.clientWidth<window.innerWidth}var k=AwsUi.__DomUtils,l="awsui-modal-open",m=null;c.disableBodyScrolling=d,c.enableBodyScrolling=e},{}],2:[function(a,b,c){"use strict";function d(a,b){a.__state=b?"fadeIn":"fadeOut",b?g(a):h(a)}function e(a,b){function c(a,b){d.__timeoutID&&clearTimeout(d.__timeoutID),d.__timeoutID=setTimeout(function(){d.__state===a&&(d.__state=b),d.__timeoutID=void 0},j)}var d=this;"fadeOut"===b?c("fadeOut","hidden"):"fadeIn"===b&&c("fadeIn","showing"),f(this)}function f(a){var b="attached"===a.__componentState,c=b&&"hidden"!==a.__state;c?i.disableBodyScrolling():i.enableBodyScrolling()}function g(a){var b=a.node.querySelector(".awsui-modal-dialog");b&&b.focus?(a.__initiallyFocusedElement=document.activeElement,b.focus()):a.__initiallyFocusedElement=void 0}function h(a){a.__initiallyFocusedElement&&a.__initiallyFocusedElement.focus&&a.__initiallyFocusedElement.focus(),a.__initiallyFocusedElement=void 0}var i=a("./BodyScroll"),j=450,k=27;AwsUi.__addComponent("awsui-modal",{releaseStatus:"stable",callbacks:{attached:function(){this.visible&&(this.__state="hidden",d(this,!0))},detached:function(){i.enableBodyScrolling(),this.__initiallyFocusedElement=void 0}},properties:{header:{type:"string"},size:{type:"string",valid:["small","medium","large","max"],defaultValue:"medium"},visible:{type:"boolean",onChange:function(a,b){d(this,b)}},__state:{type:"string",defaultValue:"hidden",valid:["hidden","fadeIn","showing","fadeOut"],onChange:e}},events:{dismiss:{bubbles:!0,cancelable:!0}},functions:{dismiss:function(){this.visible=!1},__UIDismiss:function(){var a=this.__fireEvent("dismiss");a.defaultPrevented||this.dismiss()}},regions:{content:{isDefault:!0},footer:{}},render:function(a,b){function c(a){a.keyCode===k&&e.__UIDismiss()}function d(a){a.target===this&&e.__UIDismiss()}var e=this,f=new b.ClassBuilder(e).addClass("awsui-modal-dialog").addPropertyValueClass("size").toClassName(),h=new b.ClassBuilder(e).addClass("awsui-modal-container").addPropertyValueClass("__state").toClassName(),i=new b.ClassBuilder(e).addClass("awsui-modal-overlay").addPropertyValueClass("__state").toClassName(),j=_AwsUiJsxHelpers.createElement("div",{className:"awsui-modal-tabtrap",tabindex:e.visible?"0":"-1",onfocus:function(){g(e)}}),l=_AwsUiJsxHelpers.createElement("div",{className:h,onclick:d},_AwsUiJsxHelpers.createElement("div",{className:f,onkeydown:c,tabindex:"-1"},_AwsUiJsxHelpers.createElement("div",{className:"awsui-modal-content"},_AwsUiJsxHelpers.createElement("div",{className:"awsui-modal-header"},_AwsUiJsxHelpers.createElement("button",{className:"awsui-modal-dismiss-control awsui-button-as-link awsui-icon times",onclick:d}),e.header),_AwsUiJsxHelpers.createElement("div",{className:"awsui-modal-body"},b.region("content")),_AwsUiJsxHelpers.createElement("div",{className:"awsui-modal-footer"},b.region("footer"))))),m=_AwsUiJsxHelpers.createElement("div",{className:i});return[j,l,m,j]}})},{"./BodyScroll":1}]},{},[2]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d=0,e=function(){return"awsui-radio-button-"+d++},f=function(){return"awsui-radio-group-"+d++},g=function(a){return a.node.querySelector("input")};AwsUi.__addComponent("awsui-radio-button",{releaseStatus:"stable",callbacks:{attached:function(){this.controlId=this.controlId||e()}},events:{__selected:{bubbles:!0,cancelable:!0},focus:{bubbles:!0,
cancelable:!0},blur:{bubbles:!0,cancelable:!0}},properties:{value:{type:"string",announceValue:!0},disabled:{type:"boolean"},controlId:{type:"string"},__checked:{type:"boolean"},__name:{type:"string"}},functions:{focus:function(){g(this).focus()},blur:function(){g(this).blur()},click:function(){g(this).click()}},regions:{label:{isDefault:!0}},render:function(a,b){function c(){var c=new b.ClassBuilder(d);return c.addClass("awsui-radio-button-label"),c.addClass("awsui-radio-button-checked",d.__checked),a("label",{for:d.controlId||null,className:c.toClassName()},b.region("label"))}var d=this,e=new b.ClassBuilder(this);e.addClass("awsui-radio-button-wrapper-label"),e.addClass("awsui-radio-button-disabled",d.disabled);var f=["disabled","value"],g=b.copyDefined(this,f);this.controlId&&(g.id=this.controlId),this.__name&&(g.name=this.__name),g.checked=this.__checked,g.type="radio",g.className="awsui-radio-button-input",g.onblur=b.newEventHandler("blur"),g.onfocus=b.newEventHandler("focus"),g.onchange=function(){d.__checked=!0,d.__fireEvent("__selected")};var h=a("input",g),i=a("div",{className:"awsui-radio-button-styled-button"}),j=a("label",{className:e.toClassName()},h,i);return[j,c()]}}),AwsUi.__addComponent("awsui-radio-group",{releaseStatus:"stable",callbacks:{initialized:function(){function a(a){return a.component&&"awsui-radio-button"===a.component.__componentName}var b=this;this.name=f(),this.__listenToPropertyChanges("value",function(c,d){a(d)&&(d.component.__name=b.name,d.component.__checked=d.component.value===b.value)}),this.node.addEventListener("awsui:__selected",function(c){a(c.target)&&(b.value=c.target.component.value,b.__fireEvent("change"))})}},functions:{__updateSelectedButton:function(){for(var a=this.node.querySelectorAll("awsui-radio-button"),b=0,c=a;b<c.length;b++){var d=c[b];d.component.__checked=d.component.value===this.value}}},properties:{value:{type:"string",onChange:function(){this.__updateSelectedButton()}}},events:{change:{bubbles:!0,cancelable:!0}},regions:{content:{isDefault:!0}},render:function(a,b){return b.region("content")},wrapperSupport:{ngModel:{value:"value",event:"change"}}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){/*! select v1.1.0 | MIT License | github.com/HubSpot/select */
"use strict";function d(a){return Array.prototype.reduce.call(a,function(a,b){return a===b&&b})}var e=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},f=a("tether"),g=f.Utils,h=g.extend,i=g.addClass,j=g.removeClass,k=g.hasClass,l=g.getBounds,m=13,n=27,o=32,p=38,q=40,r=9,s="awsui-select-target-focused",t=function(a){function b(c,d){var e=this;a.call(this,c),this.clearWidth=function(){return e.setWidth("auto")},this.setDefaultWidth=function(){return e.setWidth("100%")},this.options=h({},b.defaults,c),this.items=d||[],this.setupTarget(),this.setupDrop(),this.bindClick(),this.bindKeys(),this.value=void 0,this.searchText="",this.attached&&this.update()}return e(b,a),b.prototype.setupTarget=function(){var a=this;this.target=document.createElement("span"),this.addClass(this.target,"target"),this.valueContainer=document.createElement("span"),this.addClass(this.valueContainer,"value"),this.target.appendChild(this.valueContainer);var b=0;this.target.setAttribute("tabindex",b),this.target.setAttribute("role","combobox"),this.target.setAttribute("aria-autocomplete","list"),this.options.className&&i(this.target,this.options.className),this.target.selectInstance=this,this.target.addEventListener("mousedown",function(){a.isOpen()?a.target.blur():a.target.focus()}),this.target.addEventListener("focus",function(){i(a.target,s)}),this.target.addEventListener("blur",function(b){b.relatedTarget;j(a.target,s)})},b.prototype.prefixedClassname=function(a){return this.options.classPrefix+"-"+a},b.prototype.find=function(a,b){return a.querySelector("."+this.prefixedClassname(b))},b.prototype.findAll=function(a,b){return a.querySelectorAll("."+this.prefixedClassname(b))},b.prototype.addClass=function(a,b){i(a,this.prefixedClassname(b))},b.prototype.removeClass=function(a,b){j(a,this.prefixedClassname(b))},b.prototype.hasClass=function(a,b){return k(a,this.prefixedClassname(b))},b.prototype.setupDrop=function(){var a=this;this.drop=document.createElement("div"),this.addClass(this.drop,"dropdown"),i(this.drop,"awsui"),this.options.className&&i(this.drop,this.options.className),this.drop.addEventListener("click",function(b){a.hasClass(b.target,"option")&&a.pickOption(b.target),b.stopPropagation()}),this.drop.addEventListener("mousemove",function(b){a.hasClass(b.target,"option")&&a.highlightOption(b.target)}),this.content=document.createElement("div"),this.addClass(this.content,"content"),this.drop.appendChild(this.content)},b.prototype.open=function(){var a=this;if(!this.options.disabled){this.addClass(this.target,"open"),this.addClass(this.drop,"open");var b=this.find(this.drop,"option-selected");if(b){this.highlightOption(b),this.scrollDropContentToOption(b);var c=function(){if(a.hasClass(a.drop,"abutted-left")||a.hasClass(a.drop,"abutted-bottom")){var c=l(a.drop),d=l(b),e=c.top-(d.top+d.height);a.drop.style.top=(parseFloat(a.drop.style.top)||0)+e+"px"}},d=this.options.alignToHighlighted,e=this.content,f=e.scrollHeight,g=e.clientHeight;("always"===d||"auto"===d&&f<=g)&&setTimeout(function(){c()}),this.trigger("open")}}},b.prototype.close=function(){this.isOpen()&&(this.removeHighlight(),this.removeClass(this.target,"open"),this.removeClass(this.drop,"open"),this.trigger("close"))},b.prototype.toggle=function(){this.isOpen()?this.close():this.open()},b.prototype.focus=function(){this.target.focus()},b.prototype.blur=function(){this.target.blur()},b.prototype.isOpen=function(){return this.hasClass(this.drop,"open")},b.prototype.attach=function(){this.attached=!0,document.addEventListener("mousedown",this.globalClickListener)},b.prototype.detach=function(){this.attached=!1,this.close(),document.removeEventListener("mousedown",this.globalClickListener)},b.prototype.bindClick=function(){var a=this;this.target.addEventListener("mousedown",function(b){b.preventDefault(),a.toggle()}),this.globalClickListener=function(b){a.isOpen()&&(b.target===a.drop||a.drop.contains(b.target)||b.target===a.target||a.target.contains(b.target)||a.close())}},b.prototype.getSelectedItem=function(){if(void 0!==this.value)for(var a=0,b=this.items;a<b.length;a++){var c=b[a];if(c.items){var d=c,e=this.getSelectedItemFromOptionsGroup(d);if(e)return e}else if(c.value===this.value)return c}},b.prototype.getSelectedItemFromOptionsGroup=function(a){for(var b=0,c=a.items;b<c.length;b++){var d=c[b];if(d.value===this.value)return d}return null},b.prototype.renderTarget=function(){var a=this.getSelectedItem();a?(this.valueContainer.textContent=this.getSelectedItem().text,this.removeClass(this.valueContainer,"placeholder")):this.options.placeholder?(this.valueContainer.textContent=this.options.placeholder,this.addClass(this.valueContainer,"placeholder")):(this.valueContainer.textContent=" ",this.removeClass(this.valueContainer,"placeholder")),this.options.adjustWidth?this.adjustAllWidths():this.setDefaultWidth()},b.prototype.adjustAllWidths=function(){this.clearWidth();var a=45,b=this.getTargetWidth(),c=this.getDropWidth(),d=Math.max(b,c)+a;this.drop.setAttribute("style","width: "+d+"px;"),this.target.setAttribute("style","width: "+d+"px;")},b.prototype.setWidth=function(a){this.drop.setAttribute("style","width: "+a+";"),this.target.setAttribute("style","width: "+a+";")},b.prototype.getTargetWidth=function(){var a=10,b=this.valueContainer.offsetWidth-a;if(this.value){var c=document.createElement("span");c.textContent=this.options.placeholder,this.target.appendChild(c),b=c.offsetWidth,this.target.removeChild(c)}return b},b.prototype.getDropWidth=function(){this.addClass(this.drop,"hidden");var a=30,b=this.drop.offsetWidth-a;return this.removeClass(this.drop,"hidden"),b},b.prototype.renderDrop=function(){var a=document.createElement("ul");this.addClass(a,"options");for(var b=0,c=this.items;b<c.length;b++){var d=c[b],e=void 0;e=d.items?this.createDropdownOptionsGroup(d):this.createDropdownOption(d),a.appendChild(e)}this.content.innerHTML="",this.content.appendChild(a)},b.prototype.createDropdownOptionsGroup=function(a){var b=document.createElement("li");this.addClass(b,"options-group"),this.isOptionsGroupDisabled(a)&&this.addClass(b,"options-group-disabled");var c=document.createElement("p");this.addClass(c,"options-group-header"),c.textContent=a.text,b.appendChild(c);var d=document.createElement("ul");this.addClass(d,"options");for(var e=0,f=a.items;e<f.length;e++){var g=f[e];d.appendChild(this.createDropdownOption(g,a.disabled))}return b.appendChild(d),b},b.prototype.isOptionsGroupDisabled=function(a){if(a.disabled)return a.disabled;if(0===a.items.length)return!1;for(var b=0,c=a.items;b<c.length;b++){var d=c[b];if(!d.disabled)return!1}return!0},b.prototype.createDropdownOption=function(a,b){void 0===b&&(b=!1);var c=document.createElement("li");return this.addClass(c,"option"),c.setAttribute("data-value",a.value),c.setAttribute("title",a.text),c.textContent=a.text,this.value===a.value&&this.addClass(c,"option-selected"),(b||a.disabled)&&this.addClass(c,"option-disabled"),a.separator&&this.addClass(c,"option-separator"),c},b.prototype.update=function(){this.renderDrop(),this.renderTarget()},b.prototype.findOptionsByPrefix=function(a){var b=this.findAll(this.drop,"option");return a=a.toLowerCase(),Array.prototype.filter.call(b,function(b){return b.innerHTML.toLowerCase().substr(0,a.length)===a})},b.prototype.getChosen=function(){return this.isOpen()?this.find(this.drop,"option-highlight"):this.find(this.drop,"option-selected")},b.prototype.selectOption=function(a){this.isOpen()?(this.highlightOption(a),this.scrollDropContentToOption(a)):this.pickOption(a,!1)},b.prototype.setDisabled=function(a){this.options.disabled=a,a?(this.close(),this.addClass(this.target,"disabled"),this.target.removeAttribute("tabindex")):(this.target.setAttribute("tabindex",0),this.removeClass(this.target,"disabled"))},b.prototype.resetSelection=function(){this.selectOption(this.find(this.drop,"option"))},b.prototype.highlightOption=function(a){this.removeHighlight(),this.hasClass(a,"option-disabled")||(this.addClass(a,"option-highlight"),this.trigger("highlight",{option:a}))},b.prototype.removeHighlight=function(){var a=this.find(this.drop,"option-highlight");a&&this.removeClass(a,"option-highlight")},b.prototype.moveHighlight=function(a){var b=this,c=this.find(this.drop,"option-highlight");if(!c)return void this.highlightOption(this.find(this.drop,"option"));var d=this.findAll(this.drop,"option"),e=Array.prototype.filter.call(d,function(a){return!b.hasClass(a,"option-disabled")}),f=e.indexOf(c);if(!(f<0)){var g=f+(a===p?-1:1),h=e[g];h&&(this.highlightOption(h),this.scrollDropContentToOption(h))}},b.prototype.scrollDropContentToOption=function(a){var b=this.content,c=b.scrollHeight,d=b.clientHeight,e=b.scrollTop;if(c>d){var f=l(this.content),g=l(a);this.content.scrollTop=g.top-(f.top-e)}},b.prototype.selectHighlightedOption=function(){var a=this.find(this.drop,"option-highlight");a?this.pickOption(a):this.closeWithDelay()},b.prototype.closeWithDelay=function(){var a=this;setTimeout(function(){a.close(),a.target.focus()})},b.prototype.pickOption=function(a,b){void 0===b&&(b=!0),this.hasClass(a,"option-disabled")||(this.setAttr("value",a.getAttribute("data-value")),this.trigger("change",{value:this.value}),b&&this.closeWithDelay())},b.prototype.setAttr=function(a,b){this[a]=b,this.update()},b.prototype.setOption=function(a,b){this.options[a]=b,this.update()},b.prototype.bindKeys=function(){var a=this;a.target.addEventListener("keypress",function(b){if(0!==b.charCode){b.keyCode===o&&b.preventDefault(),clearTimeout(a.searchTextTimeout),a.searchTextTimeout=setTimeout(function(){a.searchText=""},500),a.searchText+=String.fromCharCode(b.charCode);var c=a.findOptionsByPrefix(a.searchText);if(1===c.length&&a.selectOption(c[0]),a.searchText.length>1&&d(a.searchText)){var e=a.findOptionsByPrefix(a.searchText[0]);if(e.length){var f=e.indexOf(a.getChosen());return f+=1,f%=e.length,void a.selectOption(e[f])}}return c.length?void a.selectOption(c[0]):void 0}}),a.target.addEventListener("keydown",function(b){if(b.keyCode===r&&setTimeout(function(){document.activeElement!==a.target&&a.close()}),[p,q,n].indexOf(b.keyCode)>=0&&b.preventDefault(),a.isOpen())switch(b.keyCode){case p:case q:a.moveHighlight(b.keyCode);break;case m:case o:a.selectHighlightedOption();break;case n:a.close(),a.target.focus()}else[p,q,o].indexOf(b.keyCode)>=0&&a.open()})},b}(f.Utils.Evented);Object.defineProperty(c,"__esModule",{value:!0}),c.default=t,t.defaults={alignToHighlighed:"auto",className:"select-theme-default",classPrefix:"select"}},{tether:2}],2:[function(a,b,c){/*! tether v1.1.0 | MIT License | github.com/HubSpot/tether */
!function(d,e){"function"==typeof define&&define.amd?define(e):"object"==typeof c?b.exports=e(a,c,b):d.Tether=e()}(this,function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a){var b=void 0;a===document?(b=document,a=document.documentElement):b=a.ownerDocument;var c=b.documentElement,d={},e=a.getBoundingClientRect();for(var f in e)d[f]=e[f];var g=n(b);return d.top-=g.top,d.left-=g.left,"undefined"==typeof d.width&&(d.width=document.body.scrollWidth-d.left-d.right),"undefined"==typeof d.height&&(d.height=document.body.scrollHeight-d.top-d.bottom),d.top=d.top-c.clientTop,d.left=d.left-c.clientLeft,d.right=b.body.clientWidth-d.width-d.left,d.bottom=b.body.clientHeight-d.height-d.top,d}function f(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],b=[];return Array.prototype.push.apply(b,arguments),b.slice(1).forEach(function(b){if(b)for(var c in b)({}).hasOwnProperty.call(b,c)&&(a[c]=b[c])}),a}var g=window.AwsUi.__DomUtils,h=g.removeClass,i=g.addClass,j=g.hasClass,k=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),l=function(){var a=0;return function(){return++a}}(),m={},n=function(a){
// getBoundingClientRect is unfortunately too accurate.  It introduces a pixel or two of
// jitter as the user scrolls that messes with our ability to detect if two positions
// are equivilant or not.  We place an element at the top left of the page that will
// get the same jitter, so we can cancel the two out.
var b=a._tetherZeroElement;"undefined"==typeof b&&(b=a.createElement("div"),b.setAttribute("data-tether-id",l()),f(b.style,{top:0,left:0,position:"absolute"}),a.body.appendChild(b),a._tetherZeroElement=b);var c=b.getAttribute("data-tether-id");if("undefined"==typeof m[c]){m[c]={};var d=b.getBoundingClientRect();for(var e in d)
// Can't use extend, as on IE9, elements don't resolve to be hasOwnProperty
m[c][e]=d[e];
// Clear the cache when this position call is done
p(function(){delete m[c]})}return m[c]},o=[],p=function(a){o.push(a)},q=function(){function a(){d(this,a)}return k(a,[{key:"on",value:function(a,b,c){var d=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];"undefined"==typeof this.bindings&&(this.bindings={}),"undefined"==typeof this.bindings[a]&&(this.bindings[a]=[]),this.bindings[a].push({handler:b,ctx:c,once:d})}},{key:"once",value:function(a,b,c){this.on(a,b,c,!0)}},{key:"off",value:function(a,b){if("undefined"==typeof this.bindings||"undefined"==typeof this.bindings[a])if("undefined"==typeof b)delete this.bindings[a];else for(var c=0;c<this.bindings[a].length;)this.bindings[a][c].handler===b?this.bindings[a].splice(c,1):++c}},{key:"trigger",value:function(a){if("undefined"!=typeof this.bindings&&this.bindings[a])for(var b=0;b<this.bindings[a].length;){var c=this.bindings[a][b],d=c.handler,e=c.ctx,f=c.once,g=e;"undefined"==typeof g&&(g=this);for(var h=arguments.length,i=Array(h>1?h-1:0),j=1;j<h;j++)i[j-1]=arguments[j];d.apply(g,i),f?this.bindings[a].splice(b,1):++b}}}]),a}(),r={};return r.Utils={getBounds:e,extend:f,addClass:i,removeClass:h,hasClass:j,Evented:q},r})},{}],3:[function(a,b,c){"use strict";function d(a){return function(){this.__select.setOption(a,this[a])}}function e(a,b){return void 0===b&&(b=void 0),function(){var c=this[a];void 0!==b&&(c=this[a]||b),this.__select.setAttr(a,c)}}var f=a("./select");AwsUi.__addComponent("awsui-select",{releaseStatus:"preview",callbacks:{initialized:function(){var a=this;this.__select=new f.default({className:"",classPrefix:"awsui-select"},[]),this.__select.on("change",function(b){a.value=b.value,a.__fireEvent("change")}),this.__handleFocus=function(){return a.__fireEvent("focus")},this.__handleBlur=function(){return a.__fireEvent("blur")}},attached:function(){this.__select.attach(),this.__select.target.addEventListener("focus",this.__handleFocus),this.__select.target.addEventListener("blur",this.__handleBlur)},detached:function(){this.__select.detach(),this.__select.target.removeEventListener("focus",this.__handleFocus),this.__select.target.removeEventListener("blur",this.__handleBlur)}},properties:{items:{type:"array",itemType:"Option",onChange:e("items",[])},placeholder:{type:"string",onChange:d("placeholder")},value:{type:"string",onChange:e("value")},disabled:{type:"boolean",onChange:function(){this.__select.setDisabled(this.disabled)}},adjustWidth:{type:"boolean",onChange:d("adjustWidth")}},events:{change:{bubbles:!0,cancelable:!1},focus:{bubbles:!1,cancelable:!1},blur:{bubbles:!1,cancelable:!1}},functions:{focus:function(){this.__select.focus()},blur:function(){this.node.contains(document.activeElement)&&this.__select.blur()}},render:function(a,b){var c=this;return a("span",{config:function(a,b){b||(a.appendChild(c.__select.target),a.appendChild(c.__select.drop))}})},wrapperSupport:{ngModel:{value:"value",event:"change"}}})},{"./select":1}]},{},[3]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){AwsUi.__addComponent("awsui-tabs",{releaseStatus:"preview",properties:{tabs:{type:"array",itemType:"Tab"},activeTabId:{type:"string"},variant:{type:"string",valid:["borderless","bordered"],defaultValue:"bordered",nullable:!1}},regions:{content:{isDefault:!0}},events:{change:{bubbles:!0,cancelable:!1}},render:function(a,b){var c=this,d=function(d){var e=new b.ClassBuilder(c);e.addClass("awsui-tabs-tab-link"),e.addClass("awsui-tabs-tab-active",c.activeTabId===d.id),e.addClass("awsui-tabs-tab-disabled",d.disabled);var f={className:e.toClassName(),onclick:function(a){a.preventDefault(),d.disabled||d.id!==c.activeTabId&&(c.activeTabId=d.id,c.__fireEvent("change"))}};d.disabled?f["aria-disabled"]=!0:f.href="#";var g=a("a",f,d.label);return a("li",{className:"awsui-tabs-tab"},g)},e=a("ul",{className:"awsui-tabs-container"},(this.tabs||[]).map(d)),f=a("div",{className:"awsui-tabs-panel"},b.region("content","div",{className:"awsui-tabs-content-container"})),g=new b.ClassBuilder(this);return g.addPropertyValueClass("variant"),a("div",{className:g.toClassName()},e,f)},wrapperSupport:{ngModel:{value:"activeTabId",event:"change"}}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){return"awsui-textarea-"+f++}var e=function(a){return a.node.firstChild},f=0;AwsUi.__addComponent("awsui-textarea",{releaseStatus:"stable",callbacks:{initialized:function(){this.controlId||(this.controlId=d())}},events:{blur:{bubbles:!0,cancelable:!1},change:{bubbles:!0,cancelable:!0},focus:{bubbles:!0,cancelable:!1},input:{bubbles:!0,cancelable:!0},keydown:{bubbles:!0,cancelable:!0,detailTypeName:"KeyEvent"},keyup:{bubbles:!0,cancelable:!0,detailTypeName:"KeyEvent"}},render:function(a,b){var c=this,d=this,e=b.browserCapabilities.inputEvent,f=["placeholder","disabled","rows"],g=b.copyDefined(d,f),h=function(a){return a.target.value!==c.value},i=a.withAttr("value",function(a){return c.value=a}),j=b.newEventHandler("input",i);g.config=function(a){a.value!==d.value&&(a.value=d.value||"")},d.controlId&&(g.id=d.controlId),g.className="awsui-textarea",g.onblur=b.newEventHandler("blur"),g.onfocus=b.newEventHandler("focus");var k=function(a){return d.__fireEvent("keydown",{keyCode:a.keyCode,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey})};if(g.onkeydown=k,g.onkeyup=function(a){return d.__fireEvent("keyup",{keyCode:a.keyCode,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey})},e)g.oninput=j,g.onchange=b.newEventHandler("change",i);else{var l=function(a){return!!h(a)&&void(c.value=a.target.value)},m=b.newDeferredEventHandler("input",l);g.onkeydown=function(a){k(a),m(a)},g.oncut=m,g.onpaste=m,g.onchange=function(a){return function(b){a(b)!==!1&&d.__fireEvent("change")}}(b.newEventHandler("input",l))}return a("textarea",g)},functions:{focus:function(){e(this).focus()},blur:function(){e(this).blur()}},properties:{value:{type:"string"},placeholder:{type:"string"},disabled:{type:"boolean"},controlId:{type:"string",announceValue:!0},rows:{type:"integer",defaultValue:3}},wrapperSupport:{ngModel:{value:"value",event:"input"}}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){return"awsui-textfield-"+f++}var e=function(a){return a.node.querySelector("input")},f=0;AwsUi.__addComponent("awsui-textfield",{releaseStatus:"stable",callbacks:{initialized:function(){this.controlId||(this.controlId=d())}},events:{blur:{bubbles:!0,cancelable:!1},change:{bubbles:!0,cancelable:!0},focus:{bubbles:!0,cancelable:!1},input:{bubbles:!0,cancelable:!0},keydown:{bubbles:!0,cancelable:!0,detailTypeName:"KeyEvent"},keyup:{bubbles:!0,cancelable:!0,detailTypeName:"KeyEvent"}},render:function(a,b){function c(){if("search"===e.type)return a("span",{className:"awsui-textfield-icon awsui-icon search awsui-icon-subtle"})}var d=this,e=this,f=b.browserCapabilities.inputEvent,g=["placeholder","disabled","type"],h=b.copyDefined(e,g),i=function(a){return a.target.value!==d.value},j=a.withAttr("value",function(a){return d.value=a}),k=b.newEventHandler("input",j);h.value=this.value||"",h.autocomplete=this.autocomplete?"on":"off",h.autofocus=this.autofocus,e.controlId&&(h.id=e.controlId);var l=new b.ClassBuilder(this);l.addClass("awsui-textfield"),l.addPropertyValueClass("type"),h.className=l.toClassName(),h.onblur=b.newEventHandler("blur"),h.onfocus=b.newEventHandler("focus");var m=function(a){return{keyCode:a.keyCode,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey}},n=function(a){return e.__fireEvent("keydown",m(a))};if(h.onkeydown=n,h.onkeyup=function(a){return e.__fireEvent("keyup",m(a))},f)h.oninput=k,h.onchange=b.newEventHandler("change",j);else{var o=function(a){return!!i(a)&&void(d.value=a.target.value)},p=b.newDeferredEventHandler("input",o);h.onkeydown=function(a){n(a),p(a)},h.oncut=p,h.onpaste=p,h.onchange=function(a){return function(b){a(b)!==!1&&e.__fireEvent("change")}}(b.newEventHandler("input",o))}return[c(),a("input",h)]},functions:{focus:function(){e(this).focus()},blur:function(){e(this).blur()}},properties:{value:{type:"string"},type:{type:"string",defaultValue:"text",valid:["text","password","search"]},placeholder:{type:"string"},disabled:{type:"boolean"},autocomplete:{type:"boolean",defaultValue:!0},autofocus:{type:"boolean"},controlId:{type:"string",announceValue:!0}},wrapperSupport:{ngModel:{value:"value",event:"input"}}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";AwsUi.__addComponent("awsui-tooltip",{releaseStatus:"experimental",properties:{text:{type:"string"},position:{type:"string",nullable:!0,valid:["top","right","bottom","left"]},size:{type:"string",defaultValue:"auto",nullable:!1,valid:["auto","small","medium","large"]}},regions:{trigger:{isDefault:!0}},render:function(a,b){var c={"aria-label":this.text};if(!this.position||!this.text)return b.region("trigger","span",c);var d=new b.ClassBuilder(this);return d.addClass("awsui-tooltip").addClass("awsui-tooltip-rounded").addClass("awsui-tooltip-no-slide").addClass("awsui-tooltip-wrap","auto"!==this.size).addClass("awsui-tooltip-"+this.position).addPropertyValueClass("size"),c["data-awsui-tooltip-text"]=this.text,c.className=d.toClassName(),b.region("trigger","span",c)}})},{}]},{},[1]);(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
var component = require("./directives/component");
var domRegion = require("./directives/dom-region");
angular.module('AWS-UI-Components', [domRegion.name, component.name]);
function registerComponent(componentName) {
    var componentDef = AwsUi.__componentDefinitions[componentName];
    component.defineComponent(componentName, componentDef);
}
exports.registerComponent = registerComponent;
function registerAllComponents() {
    for (var componentName in AwsUi.__componentDefinitions) {
        registerComponent(componentName);
    }
}
exports.registerAllComponents = registerAllComponents;

},{"./directives/component":2,"./directives/dom-region":3}],2:[function(require,module,exports){
"use strict";
var utils = require("../utils");
exports.name = 'components';
var module = angular.module(exports.name, []);
function toPropValue(component, propertyName, value) {
    var propertyDefinition = component.__propertiesDefinition[propertyName];
    return convertValueToPropertyType(value, propertyDefinition.type);
}
function convertValueToPropertyType(value, targetType) {
    switch (targetType) {
        case 'string':
            return (typeof value === 'undefined' || value === null) ? value : '' + value;
        case 'boolean':
            return Boolean(value);
    }
    return value;
}
function handleProperties(component, properties, attributes, scope) {
    utils.objectKeys(properties).forEach(function (attr) {
        if (!(attr in attributes))
            return;
        function setDefault() {
            component.__setFromString(attr, null);
        }
        function templateHandler(newVal) {
            if (newVal === '') {
                setDefault();
            }
            else {
                component[attr] = newVal;
            }
        }
        function handler(newVal) {
            var propValue = toPropValue(component, attr, newVal);
            if (angular.isDefined(propValue)) {
                component[attr] = propValue;
            }
            else {
                setDefault();
            }
        }
        var type = properties[attr].type || 'string';
        if (type === 'string' || type === 'region') {
            attributes.$observe(attr, templateHandler);
        }
        else {
            scope.$watch(attributes[attr], handler, ['object', 'array'].indexOf(type) >= 0);
        }
    });
}
function handleEvents(component, events, attributes, scope, element) {
    utils.objectKeys(events).forEach(function (eventName) {
        if (eventName in attributes) {
            element.on("awsui:" + eventName, function (event) {
                if (event.target === this) {
                    scope.$apply(function () {
                        scope.$eval(attributes[eventName], {
                            '$event': event,
                            'event': event,
                        });
                    });
                }
            });
        }
    });
}
function handleFunctions(component, functions, attributes, scope, $parse) {
    utils.objectKeys(functions).forEach(function (functionName) {
        var attribute = attributes[functionName + "Fn"];
        if (!attribute) {
            return;
        }
        var parsedFn = $parse(attributes[functionName + "Fn"]);
        if (parsedFn.assign) {
            var fn = function () { return component[functionName].apply(component, arguments); };
            parsedFn.assign(scope, fn);
        }
    });
}
function handleRegionsAsElements(transcludeFn, scope, component) {
    transcludeFn(scope, function (childNodes, childScope) {
        var looseNodes = [];
        var regionsDefined = false;
        for (var i = 0; i < childNodes.length; i++) {
            var node = childNodes[i];
            if (node.nodeType == Node.TEXT_NODE && node.textContent.match(/^\s*$/)) {
                continue;
            }
            if (node.getAttribute && node.getAttribute('dom-region')) {
                regionsDefined = true;
                continue;
            }
            looseNodes.push(node);
        }
        if (looseNodes.length === 0) {
            return;
        }
        if (regionsDefined) {
            for (var _i = 0, looseNodes_1 = looseNodes; _i < looseNodes_1.length; _i++) {
                var node_1 = looseNodes_1[_i];
                if (node_1.nodeType !== Node.COMMENT_NODE) {
                    throw new Error("Nodes outside a dom-region are not allowed when a dom-region has been explicitly defined");
                }
            }
            return;
        }
        var defaultRegion = angular.element('<span>');
        defaultRegion.append(looseNodes);
        component.setDefaultRegion(defaultRegion[0]);
    });
}
function addNgModelSupport(ngModelSupport, component, element, ngModelController, scope) {
    var propertyName = ngModelSupport.value;
    element.on('awsui:' + ngModelSupport.event, function (event) {
        if (event.target !== element[0]) {
            return;
        }
        scope.$apply(function () {
            return ngModelController.$setViewValue(component[propertyName], event);
        });
    });
    ngModelController.$render = function () {
        return component[ngModelSupport.value] = toPropValue(component, propertyName, ngModelController.$viewValue);
    };
    element.on('awsui:blur', function () {
        scope.$evalAsync(function () {
            ngModelController.$setTouched();
        });
    });
}
function defineComponent(componentName, def) {
    module.directive(utils.toCamelCase(componentName), ['$parse', function ($parse) {
            var ngModelSupport = def.wrapperSupport && def.wrapperSupport.ngModel;
            return {
                restrict: 'E',
                transclude: true,
                require: ngModelSupport ? '?ngModel' : undefined,
                link: function (scope, $element, iAttrs, ngModelController, transcludeFn) {
                    $element.html('');
                    AwsUi.activate($element[0]);
                    var component = $element[0].component;
                    var childScope = scope.$new();
                    childScope.component = component;
                    handleProperties(component, def.properties, iAttrs, scope);
                    handleRegionsAsElements(transcludeFn, childScope, component);
                    handleFunctions(component, def.functions, iAttrs, scope, $parse);
                    if (ngModelSupport && ngModelController) {
                        addNgModelSupport(ngModelSupport, component, $element, ngModelController, scope);
                    }
                    $element.removeAttr('disabled');
                    handleEvents(component, def.events, iAttrs, scope, $element);
                    if (document.body.contains($element[0])) {
                        component.hasBeenAttached();
                    }
                    else {
                        console.error('Element was not in DOM when linked, cannot call hasBeenAttached() properly:', $element[0]);
                    }
                    $element.on('$destroy', function () {
                        component.hasBeenDetached();
                    });
                }
            };
        }]);
}
exports.defineComponent = defineComponent;

},{"../utils":4}],3:[function(require,module,exports){
"use strict";
exports.name = 'domRegion';
var module = angular.module(exports.name, []);
module.directive('domRegion', function () {
    return {
        restrict: 'A',
        link: {
            pre: function ($scope, $element, $attrs) {
                var component = $scope.component;
                component.setRegion($attrs.domRegion, $element[0]);
                $element.on('$destroy', function () {
                    component.removeRegion($attrs.domRegion);
                });
            }
        }
    };
});

},{}],4:[function(require,module,exports){
"use strict";
var SPECIAL_CHARS_REGEXP = /([\:\-\_]+(.))/g;
function toCamelCase(string) {
    return string.replace(SPECIAL_CHARS_REGEXP, function (_, separator, letter, offset) {
        return offset ? letter.toUpperCase() : letter;
    });
}
exports.toCamelCase = toCamelCase;
function objectKeys(object) {
    return Object.keys(object || {});
}
exports.objectKeys = objectKeys;

},{}],5:[function(require,module,exports){
"use strict";
var angularComponents = require("./angular-components");
angularComponents.registerAllComponents();
AwsUi.__angular = angularComponents;

},{"./angular-components":1}]},{},[5]);

(function(){
  'use strict';

  angular
    .module("lily.utils", []) // [] param needed because this is the FIRST lily.utils file listed in catalogue
    .factory("asyncUtils", asyncUtils);

  asyncUtils.$inject = ['$q', '$timeout'];

  function asyncUtils($q, $timeout){

    function rateLimit(items, limit, action) {
        var interval = 1000 / limit;
        var startedActions = [];
        var startTime = Date.now();

        function startFrom(index) {
            if (index < items.length) {
                // keep track of started actions, but don't wait for them to finish yet
                startedActions.push(action(items[index]));
                // just wait for interval, then start the next action
                return $timeout(function () {
                    return startFrom(index + 1);
                }, interval);
            }
            else {
                return $q.when(); // we're done
            }
        }

        // start from 0, wait for all actions to be started, then wait for them all to finish
        return startFrom(0).then(function () {
            return $q.all(startedActions);
        });
    }

    return{
      rateLimit: rateLimit
    };
  }
})();(function(){
  'use strict';

  /**
   * @desc selectionUtils provides the useful function for selecting the html element text
   */
  angular
    .module("lily.utils")
    .factory("selectionUtils", selectionUtils);

  selectionUtils.$inject = ['$document'];

  function selectionUtils($document){
    var documentRef = $document.get(0);
    return{
      isCopyToClipboardSupported: function(){
        try{
          return documentRef.queryCommandSupported("copy") && typeof documentRef.execCommand === "function" ;
        }catch(err){
          //To handle all the security exceptions 
          return false;
        }
      },
      copyToClipboard: function(value){
        if(this.isCopyToClipboardSupported()){
          // TODO add support for element query 
          var isCopied, input = documentRef.createElement("input");
          input.value = value;
          input.className = "lily-hidden-input";
          documentRef.body.appendChild(input);
          input.select();

          try {
            // using the DOM API  - 'execCommand' to copy the selected content.
            // Refer - https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand#Specifications
            isCopied = documentRef.execCommand("copy");
          } catch (err) {
            isCopied = false;
          }
          documentRef.body.removeChild(input);
          return isCopied;
        }
      }
    };
  }

})();(function(){
  'use strict';

  angular
    .module("lily.utils")
    .factory("lilyLocalization", lilyLocalization);

  lilyLocalization.$inject = [];

  function lilyLocalization(name){    

    var localizedStrings = window.localizedStrings;

    function get(name, module){
      var result = "";
      if(module === undefined){
        for(var key in localizedStrings){
          if(localizedStrings[key][name]){
            
            return localizedStrings[key][name];
          }
        }
      }else{
        var moduleStrings = localizedStrings[module];
        result =  moduleStrings ? moduleStrings[name] : "";
      } 
      return result;
    }
    return{
      getString: get
    };
  }
})();window.LilyUtils = window.LilyUtils || {};
window.LilyUtils.toBoolean = function(value) {

    if (_.isBoolean(value)) {
        return value;
    } else if (value === "true") {
        return true;
    } else {
        return false;
    }
};

/*
 AngularJS v1.8.0
 (c) 2010-2020 Google, Inc. http://angularjs.org
 License: MIT
*/
  (function (Y, z) {
  'use strict'; function Fa(a, b, c) { if (!a) throw Pa("areq", b || "?", c || "required"); return a } function Ga(a, b) { if (!a && !b) return ""; if (!a) return b; if (!b) return a; Z(a) && (a = a.join(" ")); Z(b) && (b = b.join(" ")); return a + " " + b } function Qa(a) { var b = {}; a && (a.to || a.from) && (b.to = a.to, b.from = a.from); return b } function $(a, b, c) { var d = ""; a = Z(a) ? a : a && G(a) && a.length ? a.split(/\s+/) : []; s(a, function (a, k) { a && 0 < a.length && (d += 0 < k ? " " : "", d += c ? b + a : a + b) }); return d } function Ha(a) {
    if (a instanceof A) switch (a.length) {
      case 0: return a;
      case 1: if (1 === a[0].nodeType) return a; break; default: return A(va(a))
    }if (1 === a.nodeType) return A(a)
  } function va(a) { if (!a[0]) return a; for (var b = 0; b < a.length; b++) { var c = a[b]; if (1 === c.nodeType) return c } } function Ra(a, b, c) { s(b, function (b) { a.addClass(b, c) }) } function Sa(a, b, c) { s(b, function (b) { a.removeClass(b, c) }) } function aa(a) { return function (b, c) { c.addClass && (Ra(a, b, c.addClass), c.addClass = null); c.removeClass && (Sa(a, b, c.removeClass), c.removeClass = null) } } function pa(a) {
    a = a || {}; if (!a.$$prepared) {
      var b = a.domOperation ||
        N; a.domOperation = function () { a.$$domOperationFired = !0; b(); b = N }; a.$$prepared = !0
    } return a
  } function ha(a, b) { Ia(a, b); Ja(a, b) } function Ia(a, b) { b.from && (a.css(b.from), b.from = null) } function Ja(a, b) { b.to && (a.css(b.to), b.to = null) } function T(a, b, c) {
    var d = b.options || {}; c = c.options || {}; var f = (d.addClass || "") + " " + (c.addClass || ""), k = (d.removeClass || "") + " " + (c.removeClass || ""); a = Ta(a.attr("class"), f, k); c.preparationClasses && (d.preparationClasses = ba(c.preparationClasses, d.preparationClasses), delete c.preparationClasses);
    f = d.domOperation !== N ? d.domOperation : null; wa(d, c); f && (d.domOperation = f); d.addClass = a.addClass ? a.addClass : null; d.removeClass = a.removeClass ? a.removeClass : null; b.addClass = d.addClass; b.removeClass = d.removeClass; return d
  } function Ta(a, b, c) {
    function d(a) { G(a) && (a = a.split(" ")); var c = {}; s(a, function (a) { a.length && (c[a] = !0) }); return c } var f = {}; a = d(a); b = d(b); s(b, function (a, c) { f[c] = 1 }); c = d(c); s(c, function (a, c) { f[c] = 1 === f[c] ? null : -1 }); var k = { addClass: "", removeClass: "" }; s(f, function (c, b) {
      var d, f; 1 === c ? (d = "addClass",
        f = !a[b] || a[b + "-remove"]) : -1 === c && (d = "removeClass", f = a[b] || a[b + "-add"]); f && (k[d].length && (k[d] += " "), k[d] += b)
    }); return k
  } function K(a) { return a instanceof A ? a[0] : a } function Ua(a, b, c, d) { a = ""; c && (a = $(c, "ng-", !0)); d.addClass && (a = ba(a, $(d.addClass, "-add"))); d.removeClass && (a = ba(a, $(d.removeClass, "-remove"))); a.length && (d.preparationClasses = a, b.addClass(a)) } function xa(a, b) { var c = b ? "paused" : "", d = ca + "PlayState"; ma(a, [d, c]); return [d, c] } function ma(a, b) { a.style[b[0]] = b[1] } function ba(a, b) {
    return a ? b ? a + " " +
      b : a : b
  } function Ka(a, b, c) { var d = Object.create(null), f = a.getComputedStyle(b) || {}; s(c, function (a, c) { var b = f[a]; if (b) { var L = b.charAt(0); if ("-" === L || "+" === L || 0 <= L) b = Va(b); 0 === b && (b = null); d[c] = b } }); return d } function Va(a) { var b = 0; a = a.split(/\s*,\s*/); s(a, function (a) { "s" === a.charAt(a.length - 1) && (a = a.substring(0, a.length - 1)); a = parseFloat(a) || 0; b = b ? Math.max(a, b) : a }); return b } function ya(a) { return 0 === a || null != a } function La(a, b) { var c = M, d = a + "s"; b ? c += "Duration" : d += " linear all"; return [c, d] } function Ma(a, b, c) {
    s(c,
      function (c) { a[c] = za(a[c]) ? a[c] : b.style.getPropertyValue(c) })
  } var M, Aa, ca, Ba; void 0 === Y.ontransitionend && void 0 !== Y.onwebkittransitionend ? (M = "WebkitTransition", Aa = "webkitTransitionEnd transitionend") : (M = "transition", Aa = "transitionend"); void 0 === Y.onanimationend && void 0 !== Y.onwebkitanimationend ? (ca = "WebkitAnimation", Ba = "webkitAnimationEnd animationend") : (ca = "animation", Ba = "animationend"); var qa = ca + "Delay", Ca = ca + "Duration", na = M + "Delay", Na = M + "Duration", Pa = z.$$minErr("ng"), ra = {
    blockTransitions: function (a,
      b) { var c = b ? "-" + b + "s" : ""; ma(a, [na, c]); return [na, c] }
  }, Wa = { transitionDuration: Na, transitionDelay: na, transitionProperty: M + "Property", animationDuration: Ca, animationDelay: qa, animationIterationCount: ca + "IterationCount" }, Xa = { transitionDuration: Na, transitionDelay: na, animationDuration: Ca, animationDelay: qa }, Da, wa, s, Z, za, sa, Ea, ta, G, R, A, N; z.module("ngAnimate", [], function () {
    N = z.noop; Da = z.copy; wa = z.extend; A = z.element; s = z.forEach; Z = z.isArray; G = z.isString; ta = z.isObject; R = z.isUndefined; za = z.isDefined; Ea = z.isFunction;
    sa = z.isElement
  }).info({ angularVersion: "1.8.0" }).directive("ngAnimateSwap", ["$animate", function (a) { return { restrict: "A", transclude: "element", terminal: !0, priority: 550, link: function (b, c, d, f, k) { var e, Q; b.$watchCollection(d.ngAnimateSwap || d["for"], function (b) { e && a.leave(e); Q && (Q.$destroy(), Q = null); (b || 0 === b) && k(function (b, d) { e = b; Q = d; a.enter(b, null, c) }) }) } } }]).directive("ngAnimateChildren", ["$interpolate", function (a) {
    return {
      link: function (b, c, d) {
        function f(a) {
          c.data("$$ngAnimateChildren", "on" === a || "true" ===
            a)
        } var k = d.ngAnimateChildren; G(k) && 0 === k.length ? c.data("$$ngAnimateChildren", !0) : (f(a(k)(b)), d.$observe("ngAnimateChildren", f))
      }
    }
  }]).factory("$$rAFScheduler", ["$$rAF", function (a) { function b(a) { d = d.concat(a); c() } function c() { if (d.length) { for (var b = d.shift(), e = 0; e < b.length; e++)b[e](); f || a(function () { f || c() }) } } var d, f; d = b.queue = []; b.waitUntilQuiet = function (b) { f && f(); f = a(function () { f = null; b(); c() }) }; return b }]).provider("$$animateQueue", ["$animateProvider", function (a) {
    function b(a) {
      return {
        addClass: a.addClass,
        removeClass: a.removeClass, from: a.from, to: a.to
      }
    } function c(a) { if (!a) return null; a = a.split(" "); var b = Object.create(null); s(a, function (a) { b[a] = !0 }); return b } function d(a, b) { if (a && b) { var d = c(b); return a.split(" ").some(function (a) { return d[a] }) } } function f(a, b, c) { return e[a].some(function (a) { return a(b, c) }) } function k(a, b) { var c = 0 < (a.addClass || "").length, d = 0 < (a.removeClass || "").length; return b ? c && d : c || d } var e = this.rules = { skip: [], cancel: [], join: [] }; e.join.push(function (a, b) { return !a.structural && k(a) });
    e.skip.push(function (a, b) { return !a.structural && !k(a) }); e.skip.push(function (a, b) { return "leave" === b.event && a.structural }); e.skip.push(function (a, b) { return b.structural && 2 === b.state && !a.structural }); e.cancel.push(function (a, b) { return b.structural && a.structural }); e.cancel.push(function (a, b) { return 2 === b.state && a.structural }); e.cancel.push(function (a, b) { if (b.structural) return !1; var c = a.addClass, f = a.removeClass, k = b.addClass, e = b.removeClass; return R(c) && R(f) || R(k) && R(e) ? !1 : d(c, e) || d(f, k) }); this.$get = ["$$rAF",
      "$rootScope", "$rootElement", "$document", "$$Map", "$$animation", "$$AnimateRunner", "$templateRequest", "$$jqLite", "$$forceReflow", "$$isDocumentHidden", function (c, d, e, C, U, oa, H, u, t, I, da) {
        function ia(a) { O.delete(a.target) } function v() { var a = !1; return function (b) { a ? b() : d.$$postDigest(function () { a = !0; b() }) } } function ua(a, b, c) { var g = [], l = m[c]; l && s(l, function (l) { Oa.call(l.node, b) ? g.push(l.callback) : "leave" === c && Oa.call(l.node, a) && g.push(l.callback) }); return g } function h(a, b, c) {
          var l = va(b); return a.filter(function (a) {
            return !(a.node ===
              l && (!c || a.callback === c))
          })
        } function q(a, J, w) {
          function e(a, b, l, g) { u(function () { var a = ua(ia, m, b); a.length ? c(function () { s(a, function (a) { a(h, l, g) }); "close" !== l || m.parentNode || D.off(m) }) : "close" !== l || m.parentNode || D.off(m) }); a.progress(b, l, g) } function I(a) { var b = h, c = n; c.preparationClasses && (b.removeClass(c.preparationClasses), c.preparationClasses = null); c.activeClasses && (b.removeClass(c.activeClasses), c.activeClasses = null); W(h, n); ha(h, n); n.domOperation(); q.complete(!a) } var n = Da(w), h = Ha(a), m = K(h), ia = m &&
            m.parentNode, n = pa(n), q = new H, u = v(); Z(n.addClass) && (n.addClass = n.addClass.join(" ")); n.addClass && !G(n.addClass) && (n.addClass = null); Z(n.removeClass) && (n.removeClass = n.removeClass.join(" ")); n.removeClass && !G(n.removeClass) && (n.removeClass = null); n.from && !ta(n.from) && (n.from = null); n.to && !ta(n.to) && (n.to = null); if (!(B && m && fa(m, J, w) && Ya(m, n))) return I(), q; var x = 0 <= ["enter", "move", "leave"].indexOf(J), r = da(), P = r || O.get(m); w = !P && y.get(m) || {}; var p = !!w.state; P || p && 1 === w.state || (P = !E(m, ia, J)); if (P) return r &&
              e(q, J, "start", b(n)), I(), r && e(q, J, "close", b(n)), q; x && F(m); r = { structural: x, element: h, event: J, addClass: n.addClass, removeClass: n.removeClass, close: I, options: n, runner: q }; if (p) { if (f("skip", r, w)) { if (2 === w.state) return I(), q; T(h, w, r); return w.runner } if (f("cancel", r, w)) if (2 === w.state) w.runner.end(); else if (w.structural) w.close(); else return T(h, w, r), w.runner; else if (f("join", r, w)) if (2 === w.state) T(h, r, {}); else return Ua(t, h, x ? J : null, n), J = r.event = w.event, n = T(h, w, r), w.runner } else T(h, r, {}); (p = r.structural) ||
                (p = "animate" === r.event && 0 < Object.keys(r.options.to || {}).length || k(r)); if (!p) return I(), g(m), q; var C = (w.counter || 0) + 1; r.counter = C; l(m, 1, r); d.$$postDigest(function () {
                  h = Ha(a); var c = y.get(m), d = !c, c = c || {}, t = 0 < (h.parent() || []).length && ("animate" === c.event || c.structural || k(c)); if (d || c.counter !== C || !t) { d && (W(h, n), ha(h, n)); if (d || x && c.event !== J) n.domOperation(), q.end(); t || g(m) } else J = !c.structural && k(c, !0) ? "setClass" : c.event, l(m, 2), c = oa(h, J, c.options), q.setHost(c), e(q, J, "start", b(n)), c.done(function (a) {
                    I(!a);
                    (a = y.get(m)) && a.counter === C && g(m); e(q, J, "close", b(n))
                  })
                }); return q
        } function F(a) { a = a.querySelectorAll("[data-ng-animate]"); s(a, function (a) { var b = parseInt(a.getAttribute("data-ng-animate"), 10), c = y.get(a); if (c) switch (b) { case 2: c.runner.end(); case 1: y.delete(a) } }) } function g(a) { a.removeAttribute("data-ng-animate"); y.delete(a) } function E(a, b, c) {
          c = C[0].body; var l = K(e), g = a === c || "HTML" === a.nodeName, d = a === l, t = !1, m = O.get(a), h; for ((a = A.data(a, "$ngAnimatePin")) && (b = K(a)); b;) {
            d || (d = b === l); if (1 !== b.nodeType) break;
            a = y.get(b) || {}; if (!t) { var f = O.get(b); if (!0 === f && !1 !== m) { m = !0; break } else !1 === f && (m = !1); t = a.structural } if (R(h) || !0 === h) a = A.data(b, "$$ngAnimateChildren"), za(a) && (h = a); if (t && !1 === h) break; g || (g = b === c); if (g && d) break; if (!d && (a = A.data(b, "$ngAnimatePin"))) { b = K(a); continue } b = b.parentNode
          } return (!t || h) && !0 !== m && d && g
        } function l(a, b, c) { c = c || {}; c.state = b; a.setAttribute("data-ng-animate", b); c = (b = y.get(a)) ? wa(b, c) : c; y.set(a, c) } var y = new U, O = new U, B = null, P = d.$watch(function () { return 0 === u.totalPendingRequests }, function (a) {
          a &&
          (P(), d.$$postDigest(function () { d.$$postDigest(function () { null === B && (B = !0) }) }))
        }), m = Object.create(null); U = a.customFilter(); var la = a.classNameFilter(); I = function () { return !0 }; var fa = U || I, Ya = la ? function (a, b) { var c = [a.getAttribute("class"), b.addClass, b.removeClass].join(" "); return la.test(c) } : I, W = aa(t), Oa = Y.Node.prototype.contains || function (a) { return this === a || !!(this.compareDocumentPosition(a) & 16) }, D = {
          on: function (a, b, c) {
            var l = va(b); m[a] = m[a] || []; m[a].push({ node: l, callback: c }); A(b).on("$destroy", function () {
              y.get(l) ||
              D.off(a, b, c)
            })
          }, off: function (a, b, c) { if (1 !== arguments.length || G(arguments[0])) { var l = m[a]; l && (m[a] = 1 === arguments.length ? null : h(l, b, c)) } else for (l in b = arguments[0], m) m[l] = h(m[l], b) }, pin: function (a, b) { Fa(sa(a), "element", "not an element"); Fa(sa(b), "parentElement", "not an element"); a.data("$ngAnimatePin", b) }, push: function (a, b, c, l) { c = c || {}; c.domOperation = l; return q(a, b, c) }, enabled: function (a, b) {
            var c = arguments.length; if (0 === c) b = !!B; else if (sa(a)) {
              var l = K(a); if (1 === c) b = !O.get(l); else {
                if (!O.has(l)) A(a).on("$destroy",
                  ia); O.set(l, !b)
              }
            } else b = B = !!a; return b
          }
        }; return D
      }]
  }]).provider("$$animateCache", function () {
    var a = 0, b = Object.create(null); this.$get = [function () {
      return {
        cacheKey: function (b, d, f, k) { var e = b.parentNode; b = [e.$$ngAnimateParentKey || (e.$$ngAnimateParentKey = ++a), d, b.getAttribute("class")]; f && b.push(f); k && b.push(k); return b.join(" ") }, containsCachedAnimationWithoutDuration: function (a) { return (a = b[a]) && !a.isValid || !1 }, flush: function () { b = Object.create(null) }, count: function (a) { return (a = b[a]) ? a.total : 0 }, get: function (a) {
          return (a =
            b[a]) && a.value
        }, put: function (a, d, f) { b[a] ? (b[a].total++, b[a].value = d) : b[a] = { total: 1, value: d, isValid: f } }
      }
    }]
  }).provider("$$animation", ["$animateProvider", function (a) {
    var b = this.drivers = []; this.$get = ["$$jqLite", "$rootScope", "$injector", "$$AnimateRunner", "$$Map", "$$rAFScheduler", "$$animateCache", function (a, d, f, k, e, Q, L) {
      function x(a) {
        function b(a) {
          if (a.processed) return a; a.processed = !0; var d = a.domNode, t = d.parentNode; f.set(d, a); for (var h; t;) { if (h = f.get(t)) { h.processed || (h = b(h)); break } t = t.parentNode } (h ||
            c).children.push(a); return a
        } var c = { children: [] }, d, f = new e; for (d = 0; d < a.length; d++) { var da = a[d]; f.set(da.domNode, a[d] = { domNode: da.domNode, element: da.element, fn: da.fn, children: [] }) } for (d = 0; d < a.length; d++)b(a[d]); return function (a) { var b = [], c = [], d; for (d = 0; d < a.children.length; d++)c.push(a.children[d]); a = c.length; var t = 0, f = []; for (d = 0; d < c.length; d++) { var g = c[d]; 0 >= a && (a = t, t = 0, b.push(f), f = []); f.push(g); g.children.forEach(function (a) { t++; c.push(a) }); a-- } f.length && b.push(f); return b }(c)
      } var C = [], U = aa(a); return function (e,
        H, u) {
          function t(a) { a = a.hasAttribute("ng-animate-ref") ? [a] : a.querySelectorAll("[ng-animate-ref]"); var b = []; s(a, function (a) { var c = a.getAttribute("ng-animate-ref"); c && c.length && b.push(a) }); return b } function I(a) {
            var b = [], c = {}; s(a, function (a, d) { var l = K(a.element), g = 0 <= ["enter", "move"].indexOf(a.event), l = a.structural ? t(l) : []; if (l.length) { var f = g ? "to" : "from"; s(l, function (a) { var b = a.getAttribute("ng-animate-ref"); c[b] = c[b] || {}; c[b][f] = { animationID: d, element: A(a) } }) } else b.push(a) }); var d = {}, g = {}; s(c, function (c,
              t) { var f = c.from, e = c.to; if (f && e) { var h = a[f.animationID], k = a[e.animationID], E = f.animationID.toString(); if (!g[E]) { var I = g[E] = { structural: !0, beforeStart: function () { h.beforeStart(); k.beforeStart() }, close: function () { h.close(); k.close() }, classes: da(h.classes, k.classes), from: h, to: k, anchors: [] }; I.classes.length ? b.push(I) : (b.push(h), b.push(k)) } g[E].anchors.push({ out: f.element, "in": e.element }) } else f = f ? f.animationID : e.animationID, e = f.toString(), d[e] || (d[e] = !0, b.push(a[f])) }); return b
          } function da(a, b) {
            a = a.split(" ");
            b = b.split(" "); for (var c = [], d = 0; d < a.length; d++) { var g = a[d]; if ("ng-" !== g.substring(0, 3)) for (var t = 0; t < b.length; t++)if (g === b[t]) { c.push(g); break } } return c.join(" ")
          } function ia(a) { for (var c = b.length - 1; 0 <= c; c--) { var d = f.get(b[c])(a); if (d) return d } } function v(a, b) { function c(a) { (a = a.data("$$animationRunner")) && a.setHost(b) } a.from && a.to ? (c(a.from.element), c(a.to.element)) : c(a.element) } function ua() { var a = e.data("$$animationRunner"); !a || "leave" === H && u.$$domOperationFired || a.end() } function h(b) {
            e.off("$destroy",
              ua); e.removeData("$$animationRunner"); U(e, u); ha(e, u); u.domOperation(); E && a.removeClass(e, E); F.complete(!b)
          } u = pa(u); var q = 0 <= ["enter", "move", "leave"].indexOf(H), F = new k({ end: function () { h() }, cancel: function () { h(!0) } }); if (!b.length) return h(), F; var g = Ga(e.attr("class"), Ga(u.addClass, u.removeClass)), E = u.tempClasses; E && (g += " " + E, u.tempClasses = null); q && e.data("$$animatePrepareClasses", "ng-" + H + "-prepare"); e.data("$$animationRunner", F); C.push({
            element: e, classes: g, event: H, structural: q, options: u, beforeStart: function () {
              E =
              (E ? E + " " : "") + "ng-animate"; a.addClass(e, E); var b = e.data("$$animatePrepareClasses"); b && a.removeClass(e, b)
            }, close: h
          }); e.on("$destroy", ua); if (1 < C.length) return F; d.$$postDigest(function () {
            var b = []; s(C, function (a) { a.element.data("$$animationRunner") ? b.push(a) : a.close() }); C.length = 0; var d = I(b), g = []; s(d, function (a) {
              var b = a.from ? a.from.element : a.element, c = u.addClass, d = L.cacheKey(b[0], a.event, (c ? c + " " : "") + "ng-animate", u.removeClass); g.push({
                element: b, domNode: K(b), fn: function () {
                  var b, c = a.close; if (L.containsCachedAnimationWithoutDuration(d)) c();
                  else { a.beforeStart(); if ((a.anchors ? a.from.element || a.to.element : a.element).data("$$animationRunner")) { var g = ia(a); g && (b = g.start) } b ? (b = b(), b.done(function (a) { c(!a) }), v(a, b)) : c() }
                }
              })
            }); for (var d = x(g), t = 0; t < d.length; t++)for (var f = d[t], e = 0; e < f.length; e++) { var h = f[e], k = h.element; d[t][e] = h.fn; 0 === t ? k.removeData("$$animatePrepareClasses") : (h = k.data("$$animatePrepareClasses")) && a.addClass(k, h) } Q(d)
          }); return F
      }
    }]
  }]).provider("$animateCss", ["$animateProvider", function (a) {
    this.$get = ["$window", "$$jqLite", "$$AnimateRunner",
      "$timeout", "$$animateCache", "$$forceReflow", "$sniffer", "$$rAFScheduler", "$$animateQueue", function (a, c, d, f, k, e, Q, L, x) {
        function C(d, f, e, x) { var v, s = "stagger-" + e; 0 < k.count(e) && (v = k.get(s), v || (f = $(f, "-stagger"), c.addClass(d, f), v = Ka(a, d, x), v.animationDuration = Math.max(v.animationDuration, 0), v.transitionDuration = Math.max(v.transitionDuration, 0), c.removeClass(d, f), k.put(s, v, !0))); return v || {} } function U(a) { u.push(a); L.waitUntilQuiet(function () { k.flush(); for (var a = e(), b = 0; b < u.length; b++)u[b](a); u.length = 0 }) }
        function z(c, d, f, e) { d = k.get(f); d || (d = Ka(a, c, Wa), "infinite" === d.animationIterationCount && (d.animationIterationCount = 1)); k.put(f, d, e || 0 < d.transitionDuration || 0 < d.animationDuration); c = d; f = c.animationDelay; e = c.transitionDelay; c.maxDelay = f && e ? Math.max(f, e) : f || e; c.maxDuration = Math.max(c.animationDuration * c.animationIterationCount, c.transitionDuration); return c } var H = aa(c), u = []; return function (a, b) {
          function e() { v() } function L() { v(!0) } function v(b) {
            if (!(P || la && m)) {
              P = !0; m = !1; V && !g.$$skipPreparationClasses &&
                c.removeClass(a, V); ba && c.removeClass(a, ba); xa(l, !1); ra.blockTransitions(l, !1); s(y, function (a) { l.style[a[0]] = "" }); H(a, g); ha(a, g); Object.keys(E).length && s(E, function (a, b) { a ? l.style.setProperty(b, a) : l.style.removeProperty(b) }); if (g.onDone) g.onDone(); w && w.length && a.off(w.join(" "), q); var d = a.data("$$animateCss"); d && (f.cancel(d[0].timer), a.removeData("$$animateCss")); fa && fa.complete(!b)
            }
          } function u(a) { p.blockTransition && ra.blockTransitions(l, a); p.blockKeyframeAnimation && xa(l, !!a) } function h() {
            fa = new d({
              end: e,
              cancel: L
            }); U(N); v(); return { $$willAnimate: !1, start: function () { return fa }, end: e }
          } function q(a) { a.stopPropagation(); var b = a.originalEvent || a; b.target === l && (a = b.$manualTimeStamp || Date.now(), b = parseFloat(b.elapsedTime.toFixed(3)), Math.max(a - J, 0) >= G && b >= D && (la = !0, v())) } function F() {
            function b() {
              if (!P) {
                u(!1); s(y, function (a) { l.style[a[0]] = a[1] }); H(a, g); c.addClass(a, ba); if (p.recalculateTimingStyles) {
                  T = l.getAttribute("class") + " " + V; ka = k.cacheKey(l, ja, g.addClass, g.removeClass); r = z(l, T, ka, !1); ga = r.maxDelay; W =
                    Math.max(ga, 0); D = r.maxDuration; if (0 === D) { v(); return } p.hasTransitions = 0 < r.transitionDuration; p.hasAnimations = 0 < r.animationDuration
                } p.applyAnimationDelay && (ga = "boolean" !== typeof g.delay && ya(g.delay) ? parseFloat(g.delay) : ga, W = Math.max(ga, 0), r.animationDelay = ga, ea = [qa, ga + "s"], y.push(ea), l.style[ea[0]] = ea[1]); G = 1E3 * W; R = 1E3 * D; if (g.easing) { var e, h = g.easing; p.hasTransitions && (e = M + "TimingFunction", y.push([e, h]), l.style[e] = h); p.hasAnimations && (e = ca + "TimingFunction", y.push([e, h]), l.style[e] = h) } r.transitionDuration &&
                  w.push(Aa); r.animationDuration && w.push(Ba); J = Date.now(); var m = G + 1.5 * R; e = J + m; var h = a.data("$$animateCss") || [], F = !0; if (h.length) { var n = h[0]; (F = e > n.expectedEndTime) ? f.cancel(n.timer) : h.push(v) } F && (m = f(d, m, !1), h[0] = { timer: m, expectedEndTime: e }, h.push(v), a.data("$$animateCss", h)); if (w.length) a.on(w.join(" "), q); g.to && (g.cleanupStyles && Ma(E, l, Object.keys(g.to)), Ja(a, g))
              }
            } function d() { var b = a.data("$$animateCss"); if (b) { for (var c = 1; c < b.length; c++)b[c](); a.removeData("$$animateCss") } } if (!P) if (l.parentNode) {
              var e =
                function (a) { if (la) m && a && (m = !1, v()); else if (m = !a, r.animationDuration) if (a = xa(l, m), m) y.push(a); else { var b = y, c = b.indexOf(a); 0 <= a && b.splice(c, 1) } }, h = 0 < aa && (r.transitionDuration && 0 === X.transitionDuration || r.animationDuration && 0 === X.animationDuration) && Math.max(X.animationDelay, X.transitionDelay); h ? f(b, Math.floor(h * aa * 1E3), !1) : b(); A.resume = function () { e(!0) }; A.pause = function () { e(!1) }
            } else v()
          } var g = b || {}; g.$$prepared || (g = pa(Da(g))); var E = {}, l = K(a); if (!l || !l.parentNode || !x.enabled()) return h(); var y = [], O =
            a.attr("class"), B = Qa(g), P, m, la, fa, A, W, G, D, R, J, w = []; if (0 === g.duration || !Q.animations && !Q.transitions) return h(); var ja = g.event && Z(g.event) ? g.event.join(" ") : g.event, Y = ja && g.structural, n = "", S = ""; Y ? n = $(ja, "ng-", !0) : ja && (n = ja); g.addClass && (S += $(g.addClass, "-add")); g.removeClass && (S.length && (S += " "), S += $(g.removeClass, "-remove")); g.applyClassesEarly && S.length && H(a, g); var V = [n, S].join(" ").trim(), T = O + " " + V, O = B.to && 0 < Object.keys(B.to).length; if (!(0 < (g.keyframeStyle || "").length || O || V)) return h(); var X, ka =
              k.cacheKey(l, ja, g.addClass, g.removeClass); if (k.containsCachedAnimationWithoutDuration(ka)) return V = null, h(); 0 < g.stagger ? (B = parseFloat(g.stagger), X = { transitionDelay: B, animationDelay: B, transitionDuration: 0, animationDuration: 0 }) : X = C(l, V, ka, Xa); g.$$skipPreparationClasses || c.addClass(a, V); g.transitionStyle && (B = [M, g.transitionStyle], ma(l, B), y.push(B)); 0 <= g.duration && (B = 0 < l.style[M].length, B = La(g.duration, B), ma(l, B), y.push(B)); g.keyframeStyle && (B = [ca, g.keyframeStyle], ma(l, B), y.push(B)); var aa = X ? 0 <= g.staggerIndex ?
                g.staggerIndex : k.count(ka) : 0; (n = 0 === aa) && !g.skipBlocking && ra.blockTransitions(l, 9999); var r = z(l, T, ka, !Y), ga = r.maxDelay; W = Math.max(ga, 0); D = r.maxDuration; var p = {}; p.hasTransitions = 0 < r.transitionDuration; p.hasAnimations = 0 < r.animationDuration; p.hasTransitionAll = p.hasTransitions && "all" === r.transitionProperty; p.applyTransitionDuration = O && (p.hasTransitions && !p.hasTransitionAll || p.hasAnimations && !p.hasTransitions); p.applyAnimationDuration = g.duration && p.hasAnimations; p.applyTransitionDelay = ya(g.delay) && (p.applyTransitionDuration ||
                  p.hasTransitions); p.applyAnimationDelay = ya(g.delay) && p.hasAnimations; p.recalculateTimingStyles = 0 < S.length; if (p.applyTransitionDuration || p.applyAnimationDuration) D = g.duration ? parseFloat(g.duration) : D, p.applyTransitionDuration && (p.hasTransitions = !0, r.transitionDuration = D, B = 0 < l.style[M + "Property"].length, y.push(La(D, B))), p.applyAnimationDuration && (p.hasAnimations = !0, r.animationDuration = D, y.push([Ca, D + "s"])); if (0 === D && !p.recalculateTimingStyles) return h(); var ba = $(V, "-active"); if (null != g.delay) {
                    var ea;
                    "boolean" !== typeof g.delay && (ea = parseFloat(g.delay), W = Math.max(ea, 0)); p.applyTransitionDelay && y.push([na, ea + "s"]); p.applyAnimationDelay && y.push([qa, ea + "s"])
                  } null == g.duration && 0 < r.transitionDuration && (p.recalculateTimingStyles = p.recalculateTimingStyles || n); G = 1E3 * W; R = 1E3 * D; g.skipBlocking || (p.blockTransition = 0 < r.transitionDuration, p.blockKeyframeAnimation = 0 < r.animationDuration && 0 < X.animationDelay && 0 === X.animationDuration); g.from && (g.cleanupStyles && Ma(E, l, Object.keys(g.from)), Ia(a, g)); p.blockTransition ||
                    p.blockKeyframeAnimation ? u(D) : g.skipBlocking || ra.blockTransitions(l, !1); return { $$willAnimate: !0, end: e, start: function () { if (!P) return A = { end: e, cancel: L, resume: null, pause: null }, fa = new d(A), U(F), fa } }
        }
      }]
  }]).provider("$$animateCssDriver", ["$$animationProvider", function (a) {
    a.drivers.push("$$animateCssDriver"); this.$get = ["$animateCss", "$rootScope", "$$AnimateRunner", "$rootElement", "$sniffer", "$$jqLite", "$document", function (a, c, d, f, k, e, Q) {
      function L(a) { return a.replace(/\bng-\S+\b/g, "") } function x(a, b) {
        G(a) &&
        (a = a.split(" ")); G(b) && (b = b.split(" ")); return a.filter(function (a) { return -1 === b.indexOf(a) }).join(" ")
      } function C(c, e, f) {
        function k(a) { var b = {}, c = K(a).getBoundingClientRect(); s(["width", "height", "top", "left"], function (a) { var d = c[a]; switch (a) { case "top": d += H.scrollTop; break; case "left": d += H.scrollLeft }b[a] = Math.floor(d) + "px" }); return b } function v() {
          var c = L(f.attr("class") || ""), d = x(c, q), c = x(q, c), d = a(h, { to: k(f), addClass: "ng-anchor-in " + d, removeClass: "ng-anchor-out " + c, delay: !0 }); return d.$$willAnimate ?
            d : null
        } function C() { h.remove(); e.removeClass("ng-animate-shim"); f.removeClass("ng-animate-shim") } var h = A(K(e).cloneNode(!0)), q = L(h.attr("class") || ""); e.addClass("ng-animate-shim"); f.addClass("ng-animate-shim"); h.addClass("ng-anchor"); u.append(h); var F; c = function () { var c = a(h, { addClass: "ng-anchor-out", delay: !0, from: k(e) }); return c.$$willAnimate ? c : null }(); if (!c && (F = v(), !F)) return C(); var g = c || F; return {
          start: function () {
            function a() { c && c.end() } var b, c = g.start(); c.done(function () {
              c = null; if (!F && (F = v())) return c =
                F.start(), c.done(function () { c = null; C(); b.complete() }), c; C(); b.complete()
            }); return b = new d({ end: a, cancel: a })
          }
        }
      } function z(a, b, c, e) { var f = oa(a, N), k = oa(b, N), h = []; s(e, function (a) { (a = C(c, a.out, a["in"])) && h.push(a) }); if (f || k || 0 !== h.length) return { start: function () { function a() { s(b, function (a) { a.end() }) } var b = []; f && b.push(f.start()); k && b.push(k.start()); s(h, function (a) { b.push(a.start()) }); var c = new d({ end: a, cancel: a }); d.all(b, function (a) { c.complete(a) }); return c } } } function oa(c) {
        var d = c.element, e = c.options ||
          {}; c.structural && (e.event = c.event, e.structural = !0, e.applyClassesEarly = !0, "leave" === c.event && (e.onDone = e.domOperation)); e.preparationClasses && (e.event = ba(e.event, e.preparationClasses)); c = a(d, e); return c.$$willAnimate ? c : null
      } if (!k.animations && !k.transitions) return N; var H = Q[0].body; c = K(f); var u = A(c.parentNode && 11 === c.parentNode.nodeType || H.contains(c) ? c : H); return function (a) { return a.from && a.to ? z(a.from, a.to, a.classes, a.anchors) : oa(a) }
    }]
  }]).provider("$$animateJs", ["$animateProvider", function (a) {
    this.$get =
    ["$injector", "$$AnimateRunner", "$$jqLite", function (b, c, d) {
      function f(c) { c = Z(c) ? c : c.split(" "); for (var d = [], f = {}, k = 0; k < c.length; k++) { var s = c[k], z = a.$$registeredAnimations[s]; z && !f[s] && (d.push(b.get(z)), f[s] = !0) } return d } var k = aa(d); return function (a, b, d, x) {
        function C() { x.domOperation(); k(a, x) } function z(a, b, d, f, e) {
          switch (d) { case "animate": b = [b, f.from, f.to, e]; break; case "setClass": b = [b, t, I, e]; break; case "addClass": b = [b, t, e]; break; case "removeClass": b = [b, I, e]; break; default: b = [b, e] }b.push(f); if (a = a.apply(a,
            b)) if (Ea(a.start) && (a = a.start()), a instanceof c) a.done(e); else if (Ea(a)) return a; return N
        } function A(a, b, d, e, f) { var h = []; s(e, function (e) { var l = e[f]; l && h.push(function () { var e, f, h = !1, k = function (a) { h || (h = !0, (f || N)(a), e.complete(!a)) }; e = new c({ end: function () { k() }, cancel: function () { k(!0) } }); f = z(l, a, b, d, function (a) { k(!1 === a) }); return e }) }); return h } function H(a, b, d, e, f) {
          var h = A(a, b, d, e, f); if (0 === h.length) {
            var k, q; "beforeSetClass" === f ? (k = A(a, "removeClass", d, e, "beforeRemoveClass"), q = A(a, "addClass", d, e, "beforeAddClass")) :
              "setClass" === f && (k = A(a, "removeClass", d, e, "removeClass"), q = A(a, "addClass", d, e, "addClass")); k && (h = h.concat(k)); q && (h = h.concat(q))
          } if (0 !== h.length) return function (a) { var b = []; h.length && s(h, function (a) { b.push(a()) }); b.length ? c.all(b, a) : a(); return function (a) { s(b, function (b) { a ? b.cancel() : b.end() }) } }
        } var u = !1; 3 === arguments.length && ta(d) && (x = d, d = null); x = pa(x); d || (d = a.attr("class") || "", x.addClass && (d += " " + x.addClass), x.removeClass && (d += " " + x.removeClass)); var t = x.addClass, I = x.removeClass, G = f(d), K, v; if (G.length) {
          var M,
          h; "leave" === b ? (h = "leave", M = "afterLeave") : (h = "before" + b.charAt(0).toUpperCase() + b.substr(1), M = b); "enter" !== b && "move" !== b && (K = H(a, b, x, G, h)); v = H(a, b, x, G, M)
        } if (K || v) {
          var q; return {
            $$willAnimate: !0, end: function () { q ? q.end() : (u = !0, C(), ha(a, x), q = new c, q.complete(!0)); return q }, start: function () {
              function b(c) { u = !0; C(); ha(a, x); q.complete(c) } if (q) return q; q = new c; var d, f = []; K && f.push(function (a) { d = K(a) }); f.length ? f.push(function (a) { C(); a(!0) }) : C(); v && f.push(function (a) { d = v(a) }); q.setHost({
                end: function () {
                  u || ((d ||
                    N)(void 0), b(void 0))
                }, cancel: function () { u || ((d || N)(!0), b(!0)) }
              }); c.chain(f, b); return q
            }
          }
        }
      }
    }]
  }]).provider("$$animateJsDriver", ["$$animationProvider", function (a) {
    a.drivers.push("$$animateJsDriver"); this.$get = ["$$animateJs", "$$AnimateRunner", function (a, c) {
      function d(c) { return a(c.element, c.event, c.classes, c.options) } return function (a) {
        if (a.from && a.to) {
          var b = d(a.from), e = d(a.to); if (b || e) return {
            start: function () {
              function a() { return function () { s(d, function (a) { a.end() }) } } var d = []; b && d.push(b.start()); e &&
                d.push(e.start()); c.all(d, function (a) { f.complete(a) }); var f = new c({ end: a(), cancel: a() }); return f
            }
          }
        } else return d(a)
      }
    }]
  }])
})(window, window.angular);
/**
 * sourceMappingURL=angular-animate.min.js.map
 * **/
/*
 AngularJS v1.8.0
 (c) 2010-2020 Google, Inc. http://angularjs.org
 License: MIT
*/
    (function(T,a){'use strict';function M(m,f){f=f||{};a.forEach(f,function(a,d){delete f[d]});for(var d in m)!m.hasOwnProperty(d)||"$"===d.charAt(0)&&"$"===d.charAt(1)||(f[d]=m[d]);return f}var B=a.$$minErr("$resource"),H=/^(\.[a-zA-Z_$@][0-9a-zA-Z_$@]*)+$/;a.module("ngResource",["ng"]).info({angularVersion:"1.8.0"}).provider("$resource",function(){var m=/^https?:\/\/\[[^\]]*][^/]*/,f=this;this.defaults={stripTrailingSlashes:!0,cancellable:!1,actions:{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",
                isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}}};this.$get=["$http","$log","$q","$timeout",function(d,F,G,N){function C(a,d){this.template=a;this.defaults=n({},f.defaults,d);this.urlParams={}}var O=a.noop,r=a.forEach,n=a.extend,R=a.copy,P=a.isArray,D=a.isDefined,x=a.isFunction,I=a.isNumber,y=a.$$encodeUriQuery,S=a.$$encodeUriSegment;C.prototype={setUrlParams:function(a,d,f){var g=this,c=f||g.template,s,h,n="",b=g.urlParams=Object.create(null);r(c.split(/\W/),function(a){if("hasOwnProperty"===
            a)throw B("badname");!/^\d+$/.test(a)&&a&&(new RegExp("(^|[^\\\\]):"+a+"(\\W|$)")).test(c)&&(b[a]={isQueryParamValue:(new RegExp("\\?.*=:"+a+"(?:\\W|$)")).test(c)})});c=c.replace(/\\:/g,":");c=c.replace(m,function(b){n=b;return""});d=d||{};r(g.urlParams,function(b,a){s=d.hasOwnProperty(a)?d[a]:g.defaults[a];D(s)&&null!==s?(h=b.isQueryParamValue?y(s,!0):S(s),c=c.replace(new RegExp(":"+a+"(\\W|$)","g"),function(b,a){return h+a})):c=c.replace(new RegExp("(/?):"+a+"(\\W|$)","g"),function(b,a,e){return"/"===
        e.charAt(0)?e:a+e})});g.defaults.stripTrailingSlashes&&(c=c.replace(/\/+$/,"")||"/");c=c.replace(/\/\.(?=\w+($|\?))/,".");a.url=n+c.replace(/\/(\\|%5C)\./,"/.");r(d,function(b,c){g.urlParams[c]||(a.params=a.params||{},a.params[c]=b)})}};return function(m,y,z,g){function c(b,c){var d={};c=n({},y,c);r(c,function(c,f){x(c)&&(c=c(b));var e;if(c&&c.charAt&&"@"===c.charAt(0)){e=b;var k=c.substr(1);if(null==k||""===k||"hasOwnProperty"===k||!H.test("."+k))throw B("badmember",k);for(var k=k.split("."),h=0,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        n=k.length;h<n&&a.isDefined(e);h++){var g=k[h];e=null!==e?e[g]:void 0}}else e=c;d[f]=e});return d}function s(b){return b.resource}function h(b){M(b||{},this)}var Q=new C(m,g);z=n({},f.defaults.actions,z);h.prototype.toJSON=function(){var b=n({},this);delete b.$promise;delete b.$resolved;delete b.$cancelRequest;return b};r(z,function(b,a){var f=!0===b.hasBody||!1!==b.hasBody&&/^(POST|PUT|PATCH)$/i.test(b.method),g=b.timeout,m=D(b.cancellable)?b.cancellable:Q.defaults.cancellable;g&&!I(g)&&(F.debug("ngResource:\n  Only numeric values are allowed as `timeout`.\n  Promises are not supported in $resource, because the same value would be used for multiple requests. If you are looking for a way to cancel requests, you should use the `cancellable` option."),
        delete b.timeout,g=null);h[a]=function(e,k,J,y){function z(a){p.catch(O);null!==u&&u.resolve(a)}var K={},v,t,w;switch(arguments.length){case 4:w=y,t=J;case 3:case 2:if(x(k)){if(x(e)){t=e;w=k;break}t=k;w=J}else{K=e;v=k;t=J;break}case 1:x(e)?t=e:f?v=e:K=e;break;case 0:break;default:throw B("badargs",arguments.length);}var E=this instanceof h,l=E?v:b.isArray?[]:new h(v),q={},C=b.interceptor&&b.interceptor.request||void 0,D=b.interceptor&&b.interceptor.requestError||void 0,F=b.interceptor&&b.interceptor.response||
        s,H=b.interceptor&&b.interceptor.responseError||G.reject,I=t?function(a){t(a,A.headers,A.status,A.statusText)}:void 0;w=w||void 0;var u,L,A;r(b,function(a,b){switch(b){default:q[b]=R(a);case "params":case "isArray":case "interceptor":case "cancellable":}});!E&&m&&(u=G.defer(),q.timeout=u.promise,g&&(L=N(u.resolve,g)));f&&(q.data=v);Q.setUrlParams(q,n({},c(v,b.params||{}),K),b.url);var p=G.resolve(q).then(C).catch(D).then(d),p=p.then(function(c){var e=c.data;if(e){if(P(e)!==!!b.isArray)throw B("badcfg",
        a,b.isArray?"array":"object",P(e)?"array":"object",q.method,q.url);if(b.isArray)l.length=0,r(e,function(a){"object"===typeof a?l.push(new h(a)):l.push(a)});else{var d=l.$promise;M(e,l);l.$promise=d}}c.resource=l;A=c;return F(c)},function(a){a.resource=l;A=a;return H(a)}),p=p["finally"](function(){l.$resolved=!0;!E&&m&&(l.$cancelRequest=O,N.cancel(L),u=L=q.timeout=null)});p.then(I,w);return E?p:(l.$promise=p,l.$resolved=!1,m&&(l.$cancelRequest=z),l)};h.prototype["$"+a]=function(b,c,d){x(b)&&(d=c,c=
        b,b={});b=h[a].call(this,b,this,c,d);return b.$promise||b}});return h}}]})})(window,window.angular);
    /**
     # sourceMappingURL=angular-resource.min.js.map
    **/

/*! line-chart - v1.0.2 - 2013-10-22
* https://github.com/n3-charts/line-chart
* Copyright (c) 2013 n3-charts  Licensed ,  */
angular.module('n3-charts.linechart', ['n3charts.utils'])

.directive('linechart', ['n3utils', '$window', '$timeout', function(n3utils, $window, $timeout) {
  var link  = function(scope, element, attrs, ctrl) {
    var dim = n3utils.getDefaultMargins();

    scope.updateDimensions = function(dimensions) {
      var top = n3utils.getPixelCssProp(element[0].parentElement, 'padding-top');
      var bottom = n3utils.getPixelCssProp(element[0].parentElement, 'padding-bottom');
      var left = n3utils.getPixelCssProp(element[0].parentElement, 'padding-left');
      var right = n3utils.getPixelCssProp(element[0].parentElement, 'padding-right');
      dimensions.width = (element[0].parentElement.offsetWidth || 900) - left - right;
      dimensions.height = (element[0].parentElement.offsetHeight || 500) - top - bottom;
    };

    scope.update = function() {
      scope.updateDimensions(dim);
      scope.redraw(dim);
    };

    scope.redraw = function(dimensions) {
      var options = n3utils.sanitizeOptions(scope.options);
      var data = scope.data;
      var series = options.series;
      var dataPerSeries = n3utils.getDataPerSeries(data, options);
      var isThumbnail = (attrs.mode === 'thumbnail');

      n3utils.clean(element[0]);

      var svg = n3utils.bootstrap(element[0], dimensions);
      var axes = n3utils
        .createAxes(svg, dimensions, options.axes)
        .andAddThemIf(isThumbnail);

      if (dataPerSeries.length > 0) {
        n3utils.setScalesDomain(axes, data, options.series, svg, options.axes);
      }

      if (isThumbnail) {
        n3utils.adjustMarginsForThumbnail(dimensions, axes);
      } else {
        n3utils.adjustMargins(dimensions, options, data);
      }

      n3utils.createContent(svg);
      n3utils.createClippingPath(svg, dimensions);

      if (!isThumbnail) {
        n3utils.drawLegend(svg, series, dimensions);
      }

      var lineMode = options.lineMode;

      if (dataPerSeries.length > 0) {

        var columnWidth = n3utils.getBestColumnWidth(dimensions, dataPerSeries);

        n3utils
          .drawArea(svg, axes, dataPerSeries, lineMode)
          .drawColumns(svg, axes, dataPerSeries, columnWidth)
          .drawLines(svg, axes, dataPerSeries, lineMode)
          .drawDots(svg, axes, dataPerSeries)
        ;
      }

      if (!isThumbnail) {
        n3utils.addTooltips(svg, dimensions, options.axes);
      }
    };

    var timeoutPromise;
    var window_resize = function(e) {
      $timeout.cancel(timeoutPromise);
      timeoutPromise = $timeout(scope.update, 1);
    };

    $window.addEventListener('resize', window_resize);

    scope.$watch('data', scope.update);
    scope.$watch('options', scope.update, true);
  };

  return {
    replace: true,
    restrict: 'E',
    scope: {data: '=', options: '='},
    template: '<div></div>',
    link: link
  };
}]);

angular.module('n3charts.utils', [])

.factory('n3utils', ['$window', function($window) {
  return {

drawArea: function(svg, scales, data, interpolateMode){
  var drawers = {
    y: this.createLeftAreaDrawer(scales, interpolateMode),
    y2: this.createRightAreaDrawer(scales, interpolateMode)
  };

  svg.select('.content').selectAll('.areaGroup')
    .data(data.filter(function(series) { return series.type === 'area'; }))
    .enter().append('g')
      .style('fill', function(serie) { return serie.color; })
      .attr('class', function(s) {
        return 'areaGroup ' + 'series_' + s.index;
      })
      .append('path')
        .attr('class', 'area')
        .style('opacity', '0.3')
        .attr('d',  function(d) { return drawers[d.axis](d.values); });

  return this;
},

updateAreas: function(svg, scales, interpolateMode) {
  var drawers = {
    y: this.createLeftAreaDrawer(scales, interpolateMode),
    y2: this.createRightAreaDrawer(scales, interpolateMode)
  };

  svg.select('.content').selectAll('.areaGroup').selectAll('path')
    .attr('d', function(d) {return drawers[d.axis](d.values);});

  return this;
},

createLeftAreaDrawer: function(scales, interpolateMode) {
  return d3.svg.area()
    .x(function(d) { return scales.xScale(d.x); })
    .y0(function(d) { return scales.yScale(0); })
    .y1(function(d) { return scales.yScale(d.value); })
    .interpolate(interpolateMode);
},

createRightAreaDrawer: function(scales, interpolateMode) {
  return d3.svg.area()
    .x(function(d) { return scales.xScale(d.x); })
    .y0(function(d) { return scales.y2Scale(0); })
    .y1(function(d) { return scales.y2Scale(d.value); })
    .interpolate(interpolateMode);
},

getBestColumnWidth: function(dimensions, data) {
  if (!data || data.length === 0) {
    return 10;
  }

  var n = data[0].values.length + 2; // +2 because abscissas will be extended
                                     // to one more row at each end
  var seriesCount = data.length;
  var gap = 0; // space between two rows
  var avWidth = dimensions.width - dimensions.left - dimensions.right;

  return parseInt(Math.max((avWidth - (n - 1)*gap) / (n*seriesCount), 5));
},

drawColumns: function(svg, axes, data, columnWidth) {
  data = data.filter(function(s) {return s.type === 'column';});

  var x1 = d3.scale.ordinal()
    .domain(data.map(function(s) {return s.name;}))
    .rangeRoundBands([0, data.length * columnWidth], 0.05);

  var that = this;

  var colGroup = svg.select('.content').selectAll('.columnGroup')
    .data(data)
    .enter().append("g")
      .attr('class', function(s) {
        return 'columnGroup ' + 'series_' + s.index;
      })
      .style("fill", function(s) {return s.color;})
      .style("fill-opacity", 0.8)
      .attr("transform", function(series) {
        return "translate(" + (
          x1(series.name) - data.length*columnWidth/2
        ) + ",0)";
      })
      .on('mouseover', function(series) {
        var target = d3.select(d3.event.target);

        that.onMouseOver(svg, {
          series: series,
          x: target.attr('x'),
          y: axes[series.axis + 'Scale'](target.datum().value),
          datum: target.datum()
        });
      })
      .on('mouseout', function(d) {
        d3.select(d3.event.target).attr('r', 2);
        that.onMouseOut(svg);
      });

  colGroup.selectAll("rect")
    .data(function(d) {return d.values;})
    .enter().append("rect")
      .style("fill-opacity", function(d) {return d.value == 0 ? 0 : 1;})

      .attr({
        width: columnWidth,
        x: function(d) {return axes.xScale(d.x);},
        height: function(d) {
          if (d.value === 0) {
            return axes[d.axis + 'Scale'].range()[0];
          } else {
            return Math.abs(axes[d.axis + 'Scale'](d.value) - axes[d.axis + 'Scale'](0));
          }
        },
        y: function(d) {
          return d.value === 0 ? 0 : axes[d.axis + 'Scale'](Math.max(0, d.value));
        }
      });

  return this;
},

updateColumns: function(svg, scales, columnWidth) {
  svg.select('.content').selectAll('.columnGroup').selectAll('rect')
    .attr('width', columnWidth)
    .attr("x", function(d) {return scales.xScale(d.x);})
    .attr("y", function(d) {
      return scales[d.axis + 'Scale'](Math.max(0, d.value));
    })
    .attr("height", function(d) {
      return Math.abs(scales[d.axis + 'Scale'](d.value) -
        scales[d.axis + 'Scale'](0));
    });

  return this;
},

drawDots: function(svg, axes, data) {
  var that = this;

  svg.select('.content').selectAll('.dotGroup')
    .data(data.filter(function(s) { return s.type === 'line' || s.type === 'area'; }))
    .enter().append('g')
      .attr('class', function(s) {
        return 'dotGroup ' + 'series_' + s.index;
      })
      .attr('fill', function(s) {return s.color;})
      .on('mouseover', function(series) {
        var target = d3.select(d3.event.target);
        target.attr('r', 4);

        that.onMouseOver(svg, {
          series: series,
          x: target.attr('cx'),
          y: target.attr('cy'),
          datum: target.datum()
        });
      })
      .on('mouseout', function(d) {
        d3.select(d3.event.target).attr('r', 2);
        that.onMouseOut(svg);
      })
      .selectAll('.dot').data(function(d) {return d.values;})
        .enter().append('circle')
        .attr({
          'class': 'dot',
          'r': 2,
          'cx': function(d) { return axes.xScale(d.x); },
          'cy': function(d) { return axes[d.axis + 'Scale'](d.value); }
        })
        .style({
          'stroke': 'white',
          'stroke-width': '2px'
        });

  return this;
},

updateDots: function(svg, scales) {
  svg.select('.content').selectAll('.dotGroup').selectAll('.dot')
    .attr({
      'cx': function(d) { return scales.xScale(d.x); },
      'cy': function(d) { return scales[d.axis + 'Scale'](d.value); }
    });

    return this;
},

drawLegend: function(svg, series, dimensions) {
  var layout = [0];

  for (var i = 1; i < series.length; i++) {
    var l = series[i - 1].label || series[i - 1].y;
    layout.push(this.getTextWidth(l) + layout[i - 1] + 30);
  }

  var that = this;
  var legend = svg.append('g').attr('class', 'legend');

  var item = legend.selectAll('.legendItem')
    .data(series)
    .enter().append('g')
      .attr({
        'class': 'legendItem',
        'transform': function(s, i) {
          return 'translate(' + layout[i] + ',' + (dimensions.height - 35) + ')';
        }
      });

  item.append('circle')
    .attr({
      'fill': function(s) {return s.color;},
      'r': 4,
      'stroke': function(s) {return s.color;},
      'stroke-width': '2px'
    })
    .on('click', function(s, i) {
      d3.select(this).attr('fill-opacity', that.toggleSeries(svg, i) ? '1' : '0.2');
    })
    ;

  item.append('text')
    .attr({
      'font-family': 'monospace',
      'font-size': 10,
      'transform': 'translate(10, 3)',
      'text-rendering': 'geometric-precision'
    })
    .text(function(s) {return s.label || s.y;});

  return this;
},

toggleSeries: function(svg, index) {
  var isVisible = false;

  svg.select('.content').selectAll('.series_' + index)
    .attr('opacity', function(s) {
      if (d3.select(this).attr('opacity') === '0') {
        isVisible = true;
        return '1';
      }

      isVisible = false;
      return '0';
    });

  return isVisible;
},

drawLines: function(svg, scales, data, interpolateMode) {
  var drawers = {
    y: this.createLeftLineDrawer(scales, interpolateMode),
    y2: this.createRightLineDrawer(scales, interpolateMode)
  };

  svg.select('.content').selectAll('.lineGroup')
    .data(data.filter(function(s) { return s.type === 'line'  || s.type === 'area'; }))
    .enter().append('g')
      .style('stroke', function(serie) {return serie.color;})
      .attr('class', function(s) {
        return 'lineGroup ' + 'series_' + s.index;
      })
      .append('path')
        .attr('class', 'line')
        .attr('d', function(d) {return drawers[d.axis](d.values);})
        .style({
          'fill': 'none',
          'stroke-width': '1px'
        });

  return this;
},

updateLines: function(svg, scales, interpolateMode) {
  var drawers = {
    y: this.createLeftLineDrawer(scales, interpolateMode),
    y2: this.createRightLineDrawer(scales, interpolateMode)
  };

  svg.select('.content').selectAll('.lineGroup').selectAll('path')
    .attr('d', function(d) {return drawers[d.axis](d.values);});

  return this;
},

createLeftLineDrawer: function(scales, interpolateMode) {
  return d3.svg.line()
    .x(function(d) {return scales.xScale(d.x);})
    .y(function(d) {return scales.yScale(d.value);})
    .interpolate(interpolateMode);
},

createRightLineDrawer: function(scales, interpolateMode) {
  return d3.svg.line()
    .x(function(d) {return scales.xScale(d.x);})
    .y(function(d) {return scales.y2Scale(d.value);})
    .interpolate(interpolateMode);
},

getPixelCssProp: function(element, propertyName) {
  var string = $window.getComputedStyle(element, null).getPropertyValue(propertyName);
  return +string.replace(/px$/, '');
},

getDefaultMargins: function() {
  return {top: 20, right: 50, bottom: 60, left: 50};
},

clean: function(element) {
  d3.select(element)
    .on('keydown', null)
    .on('keyup', null)
    .select('svg')
      .remove();
},

bootstrap: function(element, dimensions) {
  d3.select(element).classed('chart', true);

  var width = dimensions.width;
  var height = dimensions.height;

  var svg = d3.select(element).append('svg')
    .attr('width', width)
    .attr('height', height)
    .append('g')
      .attr('transform', 'translate(' + dimensions.left +
        ',' + dimensions.top + ')'
      );

  return svg;
},

createContent: function(svg) {
  svg.append('g')
    .attr('class', 'content')
    .attr('clip-path', 'url(#clip)')
  ;
},

createClippingPath: function(svg, dimensions) {
  svg.append("svg:clipPath")
  .attr("id", "clip")
  .append("svg:rect")
    .attr("width", dimensions.width - dimensions.left - dimensions.right)
    .attr("height", dimensions.height - dimensions.top - dimensions.bottom);
},

getDataPerSeries: function(data, options) {
  var series = options.series;
  var axes = options.axes;

  if (!series || !series.length || !data || !data.length) {
    return [];
  }

  var straightenedData = [];

  series.forEach(function(s) {
    var seriesData = {
      xFormatter: axes.x.tooltipFormatter,
      index: straightenedData.length,
      name: s.y,
      values: [],
      color: s.color,
      axis: s.axis || 'y',
      type: s.type || 'line'
    };

    data.forEach(function(row) {
      seriesData.values.push({
        x: row[options.axes.x.key],
        value: row[s.y],
        axis: s.axis || 'y'
      });
    });

    straightenedData.push(seriesData);
  });

  return straightenedData;
},

resetMargins: function(dimensions) {
  var defaults = this.getDefaultMargins();

  dimensions.left = defaults.left;
  dimensions.right = defaults.right;
  dimensions.top = defaults.top;
  dimensions.bottom = defaults.bottom;
},

adjustMargins: function(dimensions, options, data) {
  this.resetMargins(dimensions);

  if (!data || data.length === 0) {
    return;
  }

  var series = options.series;

  var leftSeries = series.filter(function(s) { return s.axis !== 'y2'; });
  var leftWidest = this.getWidestOrdinate(data, leftSeries);
  dimensions.left = this.getTextWidth('' + leftWidest) + 20;

  var rightSeries = series.filter(function(s) { return s.axis === 'y2'; });
  if (rightSeries.length === 0) {
    return;
  }
  var rightWidest = this.getWidestOrdinate(data, rightSeries);
  dimensions.right = this.getTextWidth('' + rightWidest) + 20;
},

adjustMarginsForThumbnail: function(dimensions, axes) {
  dimensions.top = 10;
  dimensions.bottom = 30;
  dimensions.left = 5;
  dimensions.right = 5;
},

getTextWidth: function(text) {
  // return Math.max(25, text.length*6.7);
  return parseInt(text.length*5) + 10;
},

getWidestOrdinate: function(data, series) {
  var widest = '';

  data.forEach(function(row) {
    series.forEach(function(series) {
      if (('' + row[series.y]).length > ('' + widest).length) {
        widest = row[series.y];
      }
    });
  });

  return widest;
},

getDefaultOptions: function() {
  return {
    tooltipMode: 'default',
    lineMode: 'linear',
    axes: {
      x: {type: 'linear', key: 'x'},
      y: {type: 'linear'}
    },
    series: []
  };
},

sanitizeOptions: function(options) {
  if (options === null || options === undefined) {
    return this.getDefaultOptions();
  }

  options.series = this.sanitizeSeriesOptions(options.series);

  options.axes = this.sanitizeAxes(options.axes, this.haveSecondYAxis(options.series));

  options.lineMode = options.lineMode ? options.lineMode : 'linear';
  options.tooltipMode = options.tooltipMode ? options.tooltipMode : 'default';

  return options;
},

sanitizeSeriesOptions: function(options) {
  if (!options) {
    return [];
  }

  var colors = d3.scale.category10();
  options.forEach(function(s, i) {
    s.color = s.color ? s.color : colors(i)
  });

  return options;
},

sanitizeAxes: function(axesOptions, secondAxis) {
  if (!axesOptions) {
    axesOptions = {};
  }

  axesOptions.x = this.sanitizeAxisOptions(axesOptions.x);
  if (!axesOptions.x.key) {
    axesOptions.x.key = "x";
  }

  axesOptions.y = this.sanitizeAxisOptions(axesOptions.y);

  if (secondAxis) {
    axesOptions.y2 = this.sanitizeAxisOptions(axesOptions.y2);
  }

  return axesOptions;
},

sanitizeAxisOptions: function(options) {
  if (!options) {
    return {type: 'linear'};
  }

  if (!options.type) {
    options.type = 'linear';
  }

  return options;
},

createAxes: function(svg, dimensions, axesOptions) {
  var drawY2Axis = axesOptions.y2 !== undefined;

  var width = dimensions.width;
  var height = dimensions.height;

  width = width - dimensions.left - dimensions.right;
  height = height - dimensions.top - dimensions.bottom;

  var x = axesOptions.x.type === 'date' ?
    d3.time.scale().rangeRound([0, width]) :
    d3.scale.linear().rangeRound([0, width]);

  var y = axesOptions.y.type === 'log'
    ? d3.scale.log().clamp(true).rangeRound([height, 0])
    : d3.scale.linear().rangeRound([height, 0]);

  var y2 = (drawY2Axis && axesOptions.y2.type === 'log')
    ? d3.scale.log().clamp(true).rangeRound([height, 0])
    : d3.scale.linear().rangeRound([height, 0]);

  var xAxis = d3.svg.axis().scale(x).orient('bottom').tickFormat(axesOptions.x.labelFunction);
  var yAxis = d3.svg.axis().scale(y).orient('left');
  var y2Axis = d3.svg.axis().scale(y2).orient('right');

  var style = function(group) {
    group.style({
      'font': '10px monospace',
      'shape-rendering': 'crispEdges'
    });

    group.selectAll('path').style({
      'fill': 'none',
      'stroke': '#000'
    });
  };

  var that = this;

  return {
    xScale: x,
    yScale: y,
    y2Scale: y2,
    xAxis: xAxis,
    yAxis: yAxis,
    y2Axis: y2Axis,

    andAddThemIf: function(isThumbnail) {
      if (!isThumbnail) {
        style(svg.append('g')
          .attr('class', 'x axis')
          .attr('transform', 'translate(0,' + height + ')')
          .call(xAxis));

        style(svg.append('g')
          .attr('class', 'y axis')
          .call(yAxis));

        if (drawY2Axis) {
          style(svg.append('g')
            .attr('class', 'y2 axis')
            .attr('transform', 'translate(' + width + ', 0)')
            .call(y2Axis));
        }
      }

      return {
        xScale: x, yScale: y, y2Scale: y2,
        xAxis: xAxis, yAxis: yAxis, y2Axis: y2Axis
      };
    }
  };
},

setScalesDomain: function(scales, data, series, svg, axesOptions) {
  this.setXScale(scales.xScale, data, series, axesOptions);

  var ySeries = series.filter(function(s) { return s.axis !== 'y2'; });
  var y2Series = series.filter(function(s) { return s.axis === 'y2'; });

  var yDomain = this.yExtent(ySeries, data);
  if (axesOptions.y.type === 'log') {
    yDomain[0] = yDomain[0] === 0 ? 0.001 : yDomain[0];
  }

  var y2Domain = this.yExtent(y2Series, data);
  if (axesOptions.y2 && axesOptions.y2.type === 'log') {
    y2Domain[0] = y2Domain[0] === 0 ? 0.001 : y2Domain[0];
  }

  scales.yScale.domain(yDomain).nice();
  scales.y2Scale.domain(y2Domain).nice();

  svg.selectAll('.x.axis').call(scales.xAxis);
  svg.selectAll('.y.axis').call(scales.yAxis);
  svg.selectAll('.y2.axis').call(scales.y2Axis);
},

yExtent: function(series, data) {
  var minY = Number.POSITIVE_INFINITY;
  var maxY = Number.NEGATIVE_INFINITY;

  series.forEach(function(s) {
    minY = Math.min(minY, d3.min(data, function(d) { return d[s.y]; }));
    maxY = Math.max(maxY, d3.max(data, function(d) { return d[s.y]; }));
  });

  return [minY, maxY];
},

setXScale: function(xScale, data, series, axesOptions) {
  xScale.domain(d3.extent(data, function(d) { return d[axesOptions.x.key]; }));

  if (series.filter(function(s) { return s.type === 'column'; }).length) {
    this.adjustXScaleForColumns(xScale, data);
  }
},

adjustXScaleForColumns: function(xScale, data) {
  var step = this.getAverageStep(data, 'x');
  var d = xScale.domain();

  if (angular.isDate(d[0])) {
    xScale.domain([new Date(d[0].getTime() - step), new Date(d[1].getTime() + step)]);
  } else {
    xScale.domain([d[0] - step, d[1] + step]);
  }
},

getAverageStep: function(data, field) {
  var sum = 0;
  var n = data.length - 1;

  for (var i = 0; i<n; i++) {
    sum += data[i + 1][field] - data[i][field];
  }

  return sum/n;
},

haveSecondYAxis: function(series) {
  var doesHave = false;

  angular.forEach(series, function(s) {
    doesHave = doesHave || s.axis === 'y2';
  });

  return doesHave;
},

addTooltips: function (svg, dimensions, axesOptions) {
  var width = dimensions.width;
  var height = dimensions.height;

  width = width - dimensions.left - dimensions.right;
  height = height - dimensions.top - dimensions.bottom;

  var w = 24;
  var h = 18;
  var p = 5;

  var xTooltip = svg.append('g')
    .attr({
      'id': 'xTooltip',
      'opacity': 0
    });

  xTooltip.append('path')
    .attr({
      'transform': 'translate(0,' + (height + 1) + ')'
    });

  xTooltip.append('text')
    .style({
      'text-anchor': 'middle'
    })
    .attr({
      'width': w,
      'height': h,
      'font-family': 'monospace',
      'font-size': 10,
      'transform': 'translate(0,' + (height + 19) + ')',
      'fill': 'white',
      'text-rendering': 'geometric-precision'
    });

  var yTooltip = svg.append('g')
    .attr({
      'id': 'yTooltip',
      'opacity': 0
    });

  yTooltip.append('path');
  yTooltip.append('text')
    .attr({
      'width': h,
      'height': w,
      'font-family': 'monospace',
      'font-size': 10,
      'fill': 'white',
      'text-rendering': 'geometric-precision'
    });

  if (axesOptions.y2 !== undefined) {
    var y2Tooltip = svg.append('g')
      .attr({
        'id': 'y2Tooltip',
        'opacity': 0,
        'transform': 'translate(' + width + ',0)'
      });

    y2Tooltip.append('path');

    y2Tooltip.append('text')
      .attr({
        'width': h,
        'height': w,
        'font-family': 'monospace',
        'font-size': 10,
        'fill': 'white',
        'text-rendering': 'geometric-precision'
      });
  }
},

onMouseOver: function(svg, target) {
  this.updateXTooltip(svg, target);

  if (target.series.axis === 'y2') {
    this.updateY2Tooltip(svg, target);
  } else {
    this.updateYTooltip(svg, target);
  }
},

onMouseOut: function(svg) {
  this.hideTooltips(svg);
},

updateXTooltip: function(svg, target) {
  var xTooltip = svg.select("#xTooltip")
    .transition()
    .attr({
      'opacity': 1.0,
      'transform': 'translate(' + target.x + ',0)'
    });

  var textX;
  if (target.series.xFormatter) {
    textX = '' + target.series.xFormatter(target.datum.x);
  } else {
    textX = '' + target.datum.x;
  }

  xTooltip.select('text').text(textX);
  xTooltip.select('path')
    .attr('fill', target.series.color)
    .attr('d', this.getXTooltipPath(textX));
},

getXTooltipPath: function(text) {
  var w = this.getTextWidth(text);
  var h = 18;
  var p = 5; // Size of the 'arrow' that points towards the axis

  return 'm-' + w/2 + ' ' + p + ' ' +
    'l0 ' + h + ' ' +
    'l' + w + ' 0 ' +
    'l0 ' + '-' + h +
    'l-' + (w/2 - p) + ' 0 ' +
    'l-' + p + ' -' + h/4 + ' ' +
    'l-' + p + ' ' + h/4 + ' ' +
    'l-' + (w/2 - p) + ' 0z';
},

updateYTooltip: function(svg, target) {
  var yTooltip = svg.select("#yTooltip")
    .transition()
    .attr({
      'opacity': 1.0,
      'transform': 'translate(0, ' + target.y + ')'
    });

  var textY = '' + target.datum.value;
  var w = this.getTextWidth(textY);
  var yTooltipText = yTooltip.select('text').text(textY);

  yTooltipText.attr({
    'transform': 'translate(' + (- w - 2) + ',3)',
    'width': w
  });

  yTooltip.select('path')
    .attr('fill', target.series.color)
    .attr('d', this.getYTooltipPath(w));
},

getYTooltipPath: function(w) {
  var h = 18;
  var p = 5; // Size of the 'arrow' that points towards the axis

  return 'm0 0' +
    'l-' + p + ' -' + p + ' ' +
    'l0 -' + (h/2 - p) + ' ' +
    'l-' + w + ' 0 ' +
    'l0 ' + h + ' ' +
    'l' + w + ' 0 ' +
    'l0 -' + (h/2 - p) +
    'l-' + p + ' ' + p + 'z';
},

updateY2Tooltip: function(svg, target) {
  var y2Tooltip = svg.select("#y2Tooltip")
    .transition()
    .attr({
      'opacity': 1.0
    });

  var textY = '' + target.datum.value;
  var w = this.getTextWidth(textY);
  var y2TooltipText = y2Tooltip.select('text').text(textY);
  y2TooltipText.attr({
    'transform': 'translate(7, ' + (parseFloat(target.y) + 3) + ')',
    'w': w
  });

  y2Tooltip.select('path')
    .attr({
      'fill': target.series.color,
      'd': this.getY2TooltipPath(w),
      'transform': 'translate(0, ' + target.y + ')'
    });
},

getY2TooltipPath: function(w) {
  var h = 18;
  var p = 5; // Size of the 'arrow' that points towards the axis

  return 'm0 0' +
    'l' + p + ' ' + p + ' ' +
    'l0 ' + (h/2 - p) + ' ' +
    'l' + w + ' 0 ' +
    'l0 -' + h + ' ' +
    'l-' + w + ' 0 ' +
    'l0 ' + (h/2 - p) + ' ' +
    'l-' + p + ' ' + p + 'z';
},

hideTooltips: function(svg) {
  svg.select("#xTooltip")
    .transition()
    .attr({ 'opacity': 0 });

  svg.select("#yTooltip")
    .transition()
    .attr({'opacity': 0 });

  svg.select("#y2Tooltip")
    .transition()
    .attr({'opacity': 0 });
},

activateZoom: function(element, svg, axes, dimensions, columnWidth) {
  var y2Scale_old = axes.y2Scale;
  var y2Scale = y2Scale_old ? y2Scale_old.copy() : undefined;
  var that = this;

  var onZoom = function() {
    var b = behavior;

    if (y2Scale_old) {
      y2Scale.domain(y2Scale_old.range().map(function(y) { return (y - b.translate()[1]) / b.scale(); }).map(y2Scale_old.invert));
      svg.select('.y2.axis').call(axes.y2Axis.scale(y2Scale));
    }

    svg.select('.x.axis').call(axes.xAxis);
    svg.select('.y.axis').call(axes.yAxis);

    that
      .updateAreas(svg, {xScale: b.x(), yScale: b.y(), y2Scale: y2Scale})
      .updateColumns(svg, {xScale: b.x(), yScale: b.y(), y2Scale: y2Scale}, b.scale() * columnWidth)
      .updateLines(svg, {xScale: b.x(), yScale: b.y(), y2Scale: y2Scale})
      .updateDots(svg, {xScale: b.x(), yScale: b.y(), y2Scale: y2Scale})
    ;
  };

  var behavior = d3.behavior.zoom()
    .x(axes.xScale)
    .y(axes.yScale)
    .on("zoom", onZoom);

  d3.select(element)
    .attr('tabindex', '0')
    .style('outline', '0px solid transparent')
    // .on('mouseover', function() {
    //   d3.event.currentTarget.focus();
    // })
    // .on('mouseout', function() {
    //   d3.event.currentTarget.blur();
    // })
    .on('keydown', function() {
      if (d3.event.shiftKey) {
        svg.append("svg:rect")
          .attr({
            'id': 'zoomPane',
            "class": "pane",
            "width": dimensions.width,
            "height": dimensions.height
          })
          .call(behavior);
      }
    })
    .on('keyup', function() {
      svg.selectAll('#zoomPane').remove();
    });
}

  };
}])
/*
 * angular-ui-bootstrap
 * http://angular-ui.github.io/bootstrap/

 * Version: 0.12.1 - 2015-02-20
 * License: MIT
 */
angular.module("ui.bootstrap", ["ui.bootstrap.tpls", "ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]);
angular.module("ui.bootstrap.tpls", ["template/accordion/accordion-group.html","template/accordion/accordion.html","template/alert/alert.html","template/carousel/carousel.html","template/carousel/slide.html","template/datepicker/datepicker.html","template/datepicker/day.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html","template/modal/backdrop.html","template/modal/window.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/popover/popover.html","template/progressbar/bar.html","template/progressbar/progress.html","template/progressbar/progressbar.html","template/rating/rating.html","template/tabs/tab.html","template/tabs/tabset.html","template/timepicker/timepicker.html","template/typeahead/typeahead-match.html","template/typeahead/typeahead-popup.html"]);
angular.module('ui.bootstrap.transition', [])

/**
 * $transition service provides a consistent interface to trigger CSS 3 transitions and to be informed when they complete.
 * @param  {DOMElement} element  The DOMElement that will be animated.
 * @param  {string|object|function} trigger  The thing that will cause the transition to start:
 *   - As a string, it represents the css class to be added to the element.
 *   - As an object, it represents a hash of style attributes to be applied to the element.
 *   - As a function, it represents a function to be called that will cause the transition to occur.
 * @return {Promise}  A promise that is resolved when the transition finishes.
 */
.factory('$transition', ['$q', '$timeout', '$rootScope', function($q, $timeout, $rootScope) {

  var $transition = function(element, trigger, options) {
    options = options || {};
    var deferred = $q.defer();
    var endEventName = $transition[options.animation ? 'animationEndEventName' : 'transitionEndEventName'];

    var transitionEndHandler = function(event) {
      $rootScope.$apply(function() {
        element.unbind(endEventName, transitionEndHandler);
        deferred.resolve(element);
      });
    };

    if (endEventName) {
      element.bind(endEventName, transitionEndHandler);
    }

    // Wrap in a timeout to allow the browser time to update the DOM before the transition is to occur
    $timeout(function() {
      if ( angular.isString(trigger) ) {
        element.addClass(trigger);
      } else if ( angular.isFunction(trigger) ) {
        trigger(element);
      } else if ( angular.isObject(trigger) ) {
        element.css(trigger);
      }
      //If browser does not support transitions, instantly resolve
      if ( !endEventName ) {
        deferred.resolve(element);
      }
    });

    // Add our custom cancel function to the promise that is returned
    // We can call this if we are about to run a new transition, which we know will prevent this transition from ending,
    // i.e. it will therefore never raise a transitionEnd event for that transition
    deferred.promise.cancel = function() {
      if ( endEventName ) {
        element.unbind(endEventName, transitionEndHandler);
      }
      deferred.reject('Transition cancelled');
    };

    return deferred.promise;
  };

  // Work out the name of the transitionEnd event
  var transElement = document.createElement('trans');
  var transitionEndEventNames = {
    'WebkitTransition': 'webkitTransitionEnd',
    'MozTransition': 'transitionend',
    'OTransition': 'oTransitionEnd',
    'transition': 'transitionend'
  };
  var animationEndEventNames = {
    'WebkitTransition': 'webkitAnimationEnd',
    'MozTransition': 'animationend',
    'OTransition': 'oAnimationEnd',
    'transition': 'animationend'
  };
  function findEndEventName(endEventNames) {
    for (var name in endEventNames){
      if (transElement.style[name] !== undefined) {
        return endEventNames[name];
      }
    }
  }
  $transition.transitionEndEventName = findEndEventName(transitionEndEventNames);
  $transition.animationEndEventName = findEndEventName(animationEndEventNames);
  return $transition;
}]);

angular.module('ui.bootstrap.collapse', ['ui.bootstrap.transition'])

  .directive('collapse', ['$transition', function ($transition) {

    return {
      link: function (scope, element, attrs) {

        var initialAnimSkip = true;
        var currentTransition;

        function doTransition(change) {
          var newTransition = $transition(element, change);
          if (currentTransition) {
            currentTransition.cancel();
          }
          currentTransition = newTransition;
          newTransition.then(newTransitionDone, newTransitionDone);
          return newTransition;

          function newTransitionDone() {
            // Make sure it's this transition, otherwise, leave it alone.
            if (currentTransition === newTransition) {
              currentTransition = undefined;
            }
          }
        }

        function expand() {
          if (initialAnimSkip) {
            initialAnimSkip = false;
            expandDone();
          } else {
            element.removeClass('collapse').addClass('collapsing');
            doTransition({ height: element[0].scrollHeight + 'px' }).then(expandDone);
          }
        }

        function expandDone() {
          element.removeClass('collapsing');
          element.addClass('collapse in');
          element.css({height: 'auto'});
        }

        function collapse() {
          if (initialAnimSkip) {
            initialAnimSkip = false;
            collapseDone();
            element.css({height: 0});
          } else {
            // CSS transitions don't work with height: auto, so we have to manually change the height to a specific value
            element.css({ height: element[0].scrollHeight + 'px' });
            //trigger reflow so a browser realizes that height was updated from auto to a specific value
            var x = element[0].offsetWidth;

            element.removeClass('collapse in').addClass('collapsing');

            doTransition({ height: 0 }).then(collapseDone);
          }
        }

        function collapseDone() {
          element.removeClass('collapsing');
          element.addClass('collapse');
        }

        scope.$watch(attrs.collapse, function (shouldCollapse) {
          if (shouldCollapse) {
            collapse();
          } else {
            expand();
          }
        });
      }
    };
  }]);

angular.module('ui.bootstrap.accordion', ['ui.bootstrap.collapse'])

.constant('accordionConfig', {
  closeOthers: true
})

.controller('AccordionController', ['$scope', '$attrs', 'accordionConfig', function ($scope, $attrs, accordionConfig) {

  // This array keeps track of the accordion groups
  this.groups = [];

  // Ensure that all the groups in this accordion are closed, unless close-others explicitly says not to
  this.closeOthers = function(openGroup) {
    var closeOthers = angular.isDefined($attrs.closeOthers) ? $scope.$eval($attrs.closeOthers) : accordionConfig.closeOthers;
    if ( closeOthers ) {
      angular.forEach(this.groups, function (group) {
        if ( group !== openGroup ) {
          group.isOpen = false;
        }
      });
    }
  };

  // This is called from the accordion-group directive to add itself to the accordion
  this.addGroup = function(groupScope) {
    var that = this;
    this.groups.push(groupScope);

    groupScope.$on('$destroy', function (event) {
      that.removeGroup(groupScope);
    });
  };

  // This is called from the accordion-group directive when to remove itself
  this.removeGroup = function(group) {
    var index = this.groups.indexOf(group);
    if ( index !== -1 ) {
      this.groups.splice(index, 1);
    }
  };

}])

// The accordion directive simply sets up the directive controller
// and adds an accordion CSS class to itself element.
.directive('accordion', function () {
  return {
    restrict:'EA',
    controller:'AccordionController',
    transclude: true,
    replace: false,
    templateUrl: 'template/accordion/accordion.html'
  };
})

// The accordion-group directive indicates a block of html that will expand and collapse in an accordion
.directive('accordionGroup', function() {
  return {
    require:'^accordion',         // We need this directive to be inside an accordion
    restrict:'EA',
    transclude:true,              // It transcludes the contents of the directive into the template
    replace: true,                // The element containing the directive will be replaced with the template
    templateUrl:'template/accordion/accordion-group.html',
    scope: {
      heading: '@',               // Interpolate the heading attribute onto this scope
      isOpen: '=?',
      isDisabled: '=?'
    },
    controller: function() {
      this.setHeading = function(element) {
        this.heading = element;
      };
    },
    link: function(scope, element, attrs, accordionCtrl) {
      accordionCtrl.addGroup(scope);

      scope.$watch('isOpen', function(value) {
        if ( value ) {
          accordionCtrl.closeOthers(scope);
        }
      });

      scope.toggleOpen = function() {
        if ( !scope.isDisabled ) {
          scope.isOpen = !scope.isOpen;
        }
      };
    }
  };
})

// Use accordion-heading below an accordion-group to provide a heading containing HTML
// <accordion-group>
//   <accordion-heading>Heading containing HTML - <img src="..."></accordion-heading>
// </accordion-group>
.directive('accordionHeading', function() {
  return {
    restrict: 'EA',
    transclude: true,   // Grab the contents to be used as the heading
    template: '',       // In effect remove this element!
    replace: true,
    require: '^accordionGroup',
    link: function(scope, element, attr, accordionGroupCtrl, transclude) {
      // Pass the heading to the accordion-group controller
      // so that it can be transcluded into the right place in the template
      // [The second parameter to transclude causes the elements to be cloned so that they work in ng-repeat]
      accordionGroupCtrl.setHeading(transclude(scope, function() {}));
    }
  };
})

// Use in the accordion-group template to indicate where you want the heading to be transcluded
// You must provide the property on the accordion-group controller that will hold the transcluded element
// <div class="accordion-group">
//   <div class="accordion-heading" ><a ... accordion-transclude="heading">...</a></div>
//   ...
// </div>
.directive('accordionTransclude', function() {
  return {
    require: '^accordionGroup',
    link: function(scope, element, attr, controller) {
      scope.$watch(function() { return controller[attr.accordionTransclude]; }, function(heading) {
        if ( heading ) {
          element.html('');
          element.append(heading);
        }
      });
    }
  };
});

angular.module('ui.bootstrap.alert', [])

.controller('AlertController', ['$scope', '$attrs', function ($scope, $attrs) {
  $scope.closeable = 'close' in $attrs;
  this.close = $scope.close;
}])

.directive('alert', function () {
  return {
    restrict:'EA',
    controller:'AlertController',
    templateUrl:'template/alert/alert.html',
    transclude:true,
    replace:true,
    scope: {
      type: '@',
      close: '&'
    }
  };
})

.directive('dismissOnTimeout', ['$timeout', function($timeout) {
  return {
    require: 'alert',
    link: function(scope, element, attrs, alertCtrl) {
      $timeout(function(){
        alertCtrl.close();
      }, parseInt(attrs.dismissOnTimeout, 10));
    }
  };
}]);

angular.module('ui.bootstrap.bindHtml', [])

  .directive('bindHtmlUnsafe', function () {
    return function (scope, element, attr) {
      element.addClass('ng-binding').data('$binding', attr.bindHtmlUnsafe);
      scope.$watch(attr.bindHtmlUnsafe, function bindHtmlUnsafeWatchAction(value) {
        element.html(value || '');
      });
    };
  });
angular.module('ui.bootstrap.buttons', [])

.constant('buttonConfig', {
  activeClass: 'active',
  toggleEvent: 'click'
})

.controller('ButtonsController', ['buttonConfig', function(buttonConfig) {
  this.activeClass = buttonConfig.activeClass || 'active';
  this.toggleEvent = buttonConfig.toggleEvent || 'click';
}])

.directive('btnRadio', function () {
  return {
    require: ['btnRadio', 'ngModel'],
    controller: 'ButtonsController',
    link: function (scope, element, attrs, ctrls) {
      var buttonsCtrl = ctrls[0], ngModelCtrl = ctrls[1];

      //model -> UI
      ngModelCtrl.$render = function () {
        element.toggleClass(buttonsCtrl.activeClass, angular.equals(ngModelCtrl.$modelValue, scope.$eval(attrs.btnRadio)));
      };

      //ui->model
      element.bind(buttonsCtrl.toggleEvent, function () {
        var isActive = element.hasClass(buttonsCtrl.activeClass);

        if (!isActive || angular.isDefined(attrs.uncheckable)) {
          scope.$apply(function () {
            ngModelCtrl.$setViewValue(isActive ? null : scope.$eval(attrs.btnRadio));
            ngModelCtrl.$render();
          });
        }
      });
    }
  };
})

.directive('btnCheckbox', function () {
  return {
    require: ['btnCheckbox', 'ngModel'],
    controller: 'ButtonsController',
    link: function (scope, element, attrs, ctrls) {
      var buttonsCtrl = ctrls[0], ngModelCtrl = ctrls[1];

      function getTrueValue() {
        return getCheckboxValue(attrs.btnCheckboxTrue, true);
      }

      function getFalseValue() {
        return getCheckboxValue(attrs.btnCheckboxFalse, false);
      }

      function getCheckboxValue(attributeValue, defaultValue) {
        var val = scope.$eval(attributeValue);
        return angular.isDefined(val) ? val : defaultValue;
      }

      //model -> UI
      ngModelCtrl.$render = function () {
        element.toggleClass(buttonsCtrl.activeClass, angular.equals(ngModelCtrl.$modelValue, getTrueValue()));
      };

      //ui->model
      element.bind(buttonsCtrl.toggleEvent, function () {
        scope.$apply(function () {
          ngModelCtrl.$setViewValue(element.hasClass(buttonsCtrl.activeClass) ? getFalseValue() : getTrueValue());
          ngModelCtrl.$render();
        });
      });
    }
  };
});

/**
* @ngdoc overview
* @name ui.bootstrap.carousel
*
* @description
* AngularJS version of an image carousel.
*
*/
angular.module('ui.bootstrap.carousel', ['ui.bootstrap.transition'])
.controller('CarouselController', ['$scope', '$timeout', '$interval', '$transition', function ($scope, $timeout, $interval, $transition) {
  var self = this,
    slides = self.slides = $scope.slides = [],
    currentIndex = -1,
    currentInterval, isPlaying;
  self.currentSlide = null;

  var destroyed = false;
  /* direction: "prev" or "next" */
  self.select = $scope.select = function(nextSlide, direction) {
    var nextIndex = slides.indexOf(nextSlide);
    //Decide direction if it's not given
    if (direction === undefined) {
      direction = nextIndex > currentIndex ? 'next' : 'prev';
    }
    if (nextSlide && nextSlide !== self.currentSlide) {
      if ($scope.$currentTransition) {
        $scope.$currentTransition.cancel();
        //Timeout so ng-class in template has time to fix classes for finished slide
        $timeout(goNext);
      } else {
        goNext();
      }
    }
    function goNext() {
      // Scope has been destroyed, stop here.
      if (destroyed) { return; }
      //If we have a slide to transition from and we have a transition type and we're allowed, go
      if (self.currentSlide && angular.isString(direction) && !$scope.noTransition && nextSlide.$element) {
        //We shouldn't do class manip in here, but it's the same weird thing bootstrap does. need to fix sometime
        nextSlide.$element.addClass(direction);
        var reflow = nextSlide.$element[0].offsetWidth; //force reflow

        //Set all other slides to stop doing their stuff for the new transition
        angular.forEach(slides, function(slide) {
          angular.extend(slide, {direction: '', entering: false, leaving: false, active: false});
        });
        angular.extend(nextSlide, {direction: direction, active: true, entering: true});
        angular.extend(self.currentSlide||{}, {direction: direction, leaving: true});

        $scope.$currentTransition = $transition(nextSlide.$element, {});
        //We have to create new pointers inside a closure since next & current will change
        (function(next,current) {
          $scope.$currentTransition.then(
            function(){ transitionDone(next, current); },
            function(){ transitionDone(next, current); }
          );
        }(nextSlide, self.currentSlide));
      } else {
        transitionDone(nextSlide, self.currentSlide);
      }
      self.currentSlide = nextSlide;
      currentIndex = nextIndex;
      //every time you change slides, reset the timer
      restartTimer();
    }
    function transitionDone(next, current) {
      angular.extend(next, {direction: '', active: true, leaving: false, entering: false});
      angular.extend(current||{}, {direction: '', active: false, leaving: false, entering: false});
      $scope.$currentTransition = null;
    }
  };
  $scope.$on('$destroy', function () {
    destroyed = true;
  });

  /* Allow outside people to call indexOf on slides array */
  self.indexOfSlide = function(slide) {
    return slides.indexOf(slide);
  };

  $scope.next = function() {
    var newIndex = (currentIndex + 1) % slides.length;

    //Prevent this user-triggered transition from occurring if there is already one in progress
    if (!$scope.$currentTransition) {
      return self.select(slides[newIndex], 'next');
    }
  };

  $scope.prev = function() {
    var newIndex = currentIndex - 1 < 0 ? slides.length - 1 : currentIndex - 1;

    //Prevent this user-triggered transition from occurring if there is already one in progress
    if (!$scope.$currentTransition) {
      return self.select(slides[newIndex], 'prev');
    }
  };

  $scope.isActive = function(slide) {
     return self.currentSlide === slide;
  };

  $scope.$watch('interval', restartTimer);
  $scope.$on('$destroy', resetTimer);

  function restartTimer() {
    resetTimer();
    var interval = +$scope.interval;
    if (!isNaN(interval) && interval > 0) {
      currentInterval = $interval(timerFn, interval);
    }
  }

  function resetTimer() {
    if (currentInterval) {
      $interval.cancel(currentInterval);
      currentInterval = null;
    }
  }

  function timerFn() {
    var interval = +$scope.interval;
    if (isPlaying && !isNaN(interval) && interval > 0) {
      $scope.next();
    } else {
      $scope.pause();
    }
  }

  $scope.play = function() {
    if (!isPlaying) {
      isPlaying = true;
      restartTimer();
    }
  };
  $scope.pause = function() {
    if (!$scope.noPause) {
      isPlaying = false;
      resetTimer();
    }
  };

  self.addSlide = function(slide, element) {
    slide.$element = element;
    slides.push(slide);
    //if this is the first slide or the slide is set to active, select it
    if(slides.length === 1 || slide.active) {
      self.select(slides[slides.length-1]);
      if (slides.length == 1) {
        $scope.play();
      }
    } else {
      slide.active = false;
    }
  };

  self.removeSlide = function(slide) {
    //get the index of the slide inside the carousel
    var index = slides.indexOf(slide);
    slides.splice(index, 1);
    if (slides.length > 0 && slide.active) {
      if (index >= slides.length) {
        self.select(slides[index-1]);
      } else {
        self.select(slides[index]);
      }
    } else if (currentIndex > index) {
      currentIndex--;
    }
  };

}])

/**
 * @ngdoc directive
 * @name ui.bootstrap.carousel.directive:carousel
 * @restrict EA
 *
 * @description
 * Carousel is the outer container for a set of image 'slides' to showcase.
 *
 * @param {number=} interval The time, in milliseconds, that it will take the carousel to go to the next slide.
 * @param {boolean=} noTransition Whether to disable transitions on the carousel.
 * @param {boolean=} noPause Whether to disable pausing on the carousel (by default, the carousel interval pauses on hover).
 *
 * @example
<example module="ui.bootstrap">
  <file name="index.html">
    <carousel>
      <slide>
        <img src="http://placekitten.com/150/150" style="margin:auto;">
        <div class="carousel-caption">
          <p>Beautiful!</p>
        </div>
      </slide>
      <slide>
        <img src="http://placekitten.com/100/150" style="margin:auto;">
        <div class="carousel-caption">
          <p>D'aww!</p>
        </div>
      </slide>
    </carousel>
  </file>
  <file name="demo.css">
    .carousel-indicators {
      top: auto;
      bottom: 15px;
    }
  </file>
</example>
 */
.directive('carousel', [function() {
  return {
    restrict: 'EA',
    transclude: true,
    replace: true,
    controller: 'CarouselController',
    require: 'carousel',
    templateUrl: 'template/carousel/carousel.html',
    scope: {
      interval: '=',
      noTransition: '=',
      noPause: '='
    }
  };
}])

/**
 * @ngdoc directive
 * @name ui.bootstrap.carousel.directive:slide
 * @restrict EA
 *
 * @description
 * Creates a slide inside a {@link ui.bootstrap.carousel.directive:carousel carousel}.  Must be placed as a child of a carousel element.
 *
 * @param {boolean=} active Model binding, whether or not this slide is currently active.
 *
 * @example
<example module="ui.bootstrap">
  <file name="index.html">
<div ng-controller="CarouselDemoCtrl">
  <carousel>
    <slide ng-repeat="slide in slides" active="slide.active">
      <img ng-src="{{slide.image}}" style="margin:auto;">
      <div class="carousel-caption">
        <h4>Slide {{$index}}</h4>
        <p>{{slide.text}}</p>
      </div>
    </slide>
  </carousel>
  Interval, in milliseconds: <input type="number" ng-model="myInterval">
  <br />Enter a negative number to stop the interval.
</div>
  </file>
  <file name="script.js">
function CarouselDemoCtrl($scope) {
  $scope.myInterval = 5000;
}
  </file>
  <file name="demo.css">
    .carousel-indicators {
      top: auto;
      bottom: 15px;
    }
  </file>
</example>
*/

.directive('slide', function() {
  return {
    require: '^carousel',
    restrict: 'EA',
    transclude: true,
    replace: true,
    templateUrl: 'template/carousel/slide.html',
    scope: {
      active: '=?'
    },
    link: function (scope, element, attrs, carouselCtrl) {
      carouselCtrl.addSlide(scope, element);
      //when the scope is destroyed then remove the slide from the current slides array
      scope.$on('$destroy', function() {
        carouselCtrl.removeSlide(scope);
      });

      scope.$watch('active', function(active) {
        if (active) {
          carouselCtrl.select(scope);
        }
      });
    }
  };
});

angular.module('ui.bootstrap.dateparser', [])

.service('dateParser', ['$locale', 'orderByFilter', function($locale, orderByFilter) {

  this.parsers = {};

  var formatCodeToRegex = {
    'yyyy': {
      regex: '\\d{4}',
      apply: function(value) { this.year = +value; }
    },
    'yy': {
      regex: '\\d{2}',
      apply: function(value) { this.year = +value + 2000; }
    },
    'y': {
      regex: '\\d{1,4}',
      apply: function(value) { this.year = +value; }
    },
    'MMMM': {
      regex: $locale.DATETIME_FORMATS.MONTH.join('|'),
      apply: function(value) { this.month = $locale.DATETIME_FORMATS.MONTH.indexOf(value); }
    },
    'MMM': {
      regex: $locale.DATETIME_FORMATS.SHORTMONTH.join('|'),
      apply: function(value) { this.month = $locale.DATETIME_FORMATS.SHORTMONTH.indexOf(value); }
    },
    'MM': {
      regex: '0[1-9]|1[0-2]',
      apply: function(value) { this.month = value - 1; }
    },
    'M': {
      regex: '[1-9]|1[0-2]',
      apply: function(value) { this.month = value - 1; }
    },
    'dd': {
      regex: '[0-2][0-9]{1}|3[0-1]{1}',
      apply: function(value) { this.date = +value; }
    },
    'd': {
      regex: '[1-2]?[0-9]{1}|3[0-1]{1}',
      apply: function(value) { this.date = +value; }
    },
    'EEEE': {
      regex: $locale.DATETIME_FORMATS.DAY.join('|')
    },
    'EEE': {
      regex: $locale.DATETIME_FORMATS.SHORTDAY.join('|')
    }
  };

  function createParser(format) {
    var map = [], regex = format.split('');

    angular.forEach(formatCodeToRegex, function(data, code) {
      var index = format.indexOf(code);

      if (index > -1) {
        format = format.split('');

        regex[index] = '(' + data.regex + ')';
        format[index] = '$'; // Custom symbol to define consumed part of format
        for (var i = index + 1, n = index + code.length; i < n; i++) {
          regex[i] = '';
          format[i] = '$';
        }
        format = format.join('');

        map.push({ index: index, apply: data.apply });
      }
    });

    return {
      regex: new RegExp('^' + regex.join('') + '$'),
      map: orderByFilter(map, 'index')
    };
  }

  this.parse = function(input, format) {
    if ( !angular.isString(input) || !format ) {
      return input;
    }

    format = $locale.DATETIME_FORMATS[format] || format;

    if ( !this.parsers[format] ) {
      this.parsers[format] = createParser(format);
    }

    var parser = this.parsers[format],
        regex = parser.regex,
        map = parser.map,
        results = input.match(regex);

    if ( results && results.length ) {
      var fields = { year: 1900, month: 0, date: 1, hours: 0 }, dt;

      for( var i = 1, n = results.length; i < n; i++ ) {
        var mapper = map[i-1];
        if ( mapper.apply ) {
          mapper.apply.call(fields, results[i]);
        }
      }

      if ( isValid(fields.year, fields.month, fields.date) ) {
        dt = new Date( fields.year, fields.month, fields.date, fields.hours);
      }

      return dt;
    }
  };

  // Check if date is valid for specific month (and year for February).
  // Month: 0 = Jan, 1 = Feb, etc
  function isValid(year, month, date) {
    if ( month === 1 && date > 28) {
        return date === 29 && ((year % 4 === 0 && year % 100 !== 0) || year % 400 === 0);
    }

    if ( month === 3 || month === 5 || month === 8 || month === 10) {
        return date < 31;
    }

    return true;
  }
}]);

angular.module('ui.bootstrap.position', [])

/**
 * A set of utility methods that can be use to retrieve position of DOM elements.
 * It is meant to be used where we need to absolute-position DOM elements in
 * relation to other, existing elements (this is the case for tooltips, popovers,
 * typeahead suggestions etc.).
 */
  .factory('$position', ['$document', '$window', function ($document, $window) {

    function getStyle(el, cssprop) {
      if (el.currentStyle) { //IE
        return el.currentStyle[cssprop];
      } else if ($window.getComputedStyle) {
        return $window.getComputedStyle(el)[cssprop];
      }
      // finally try and get inline style
      return el.style[cssprop];
    }

    /**
     * Checks if a given element is statically positioned
     * @param element - raw DOM element
     */
    function isStaticPositioned(element) {
      return (getStyle(element, 'position') || 'static' ) === 'static';
    }

    /**
     * returns the closest, non-statically positioned parentOffset of a given element
     * @param element
     */
    var parentOffsetEl = function (element) {
      var docDomEl = $document[0];
      var offsetParent = element.offsetParent || docDomEl;
      while (offsetParent && offsetParent !== docDomEl && isStaticPositioned(offsetParent) ) {
        offsetParent = offsetParent.offsetParent;
      }
      return offsetParent || docDomEl;
    };

    return {
      /**
       * Provides read-only equivalent of jQuery's position function:
       * http://api.jquery.com/position/
       */
      position: function (element) {
        var elBCR = this.offset(element);
        var offsetParentBCR = { top: 0, left: 0 };
        var offsetParentEl = parentOffsetEl(element[0]);
        if (offsetParentEl != $document[0]) {
          offsetParentBCR = this.offset(angular.element(offsetParentEl));
          offsetParentBCR.top += offsetParentEl.clientTop - offsetParentEl.scrollTop;
          offsetParentBCR.left += offsetParentEl.clientLeft - offsetParentEl.scrollLeft;
        }

        var boundingClientRect = element[0].getBoundingClientRect();
        return {
          width: boundingClientRect.width || element.prop('offsetWidth'),
          height: boundingClientRect.height || element.prop('offsetHeight'),
          top: elBCR.top - offsetParentBCR.top,
          left: elBCR.left - offsetParentBCR.left
        };
      },

      /**
       * Provides read-only equivalent of jQuery's offset function:
       * http://api.jquery.com/offset/
       */
      offset: function (element) {
        var boundingClientRect = element[0].getBoundingClientRect();
        return {
          width: boundingClientRect.width || element.prop('offsetWidth'),
          height: boundingClientRect.height || element.prop('offsetHeight'),
          top: boundingClientRect.top + ($window.pageYOffset || $document[0].documentElement.scrollTop),
          left: boundingClientRect.left + ($window.pageXOffset || $document[0].documentElement.scrollLeft)
        };
      },

      /**
       * Provides coordinates for the targetEl in relation to hostEl
       */
      positionElements: function (hostEl, targetEl, positionStr, appendToBody) {

        var positionStrParts = positionStr.split('-');
        var pos0 = positionStrParts[0], pos1 = positionStrParts[1] || 'center';

        var hostElPos,
          targetElWidth,
          targetElHeight,
          targetElPos;

        hostElPos = appendToBody ? this.offset(hostEl) : this.position(hostEl);

        targetElWidth = targetEl.prop('offsetWidth');
        targetElHeight = targetEl.prop('offsetHeight');

        var shiftWidth = {
          center: function () {
            return hostElPos.left + hostElPos.width / 2 - targetElWidth / 2;
          },
          left: function () {
            return hostElPos.left;
          },
          right: function () {
            return hostElPos.left + hostElPos.width;
          }
        };

        var shiftHeight = {
          center: function () {
            return hostElPos.top + hostElPos.height / 2 - targetElHeight / 2;
          },
          top: function () {
            return hostElPos.top;
          },
          bottom: function () {
            return hostElPos.top + hostElPos.height;
          }
        };

        switch (pos0) {
          case 'right':
            targetElPos = {
              top: shiftHeight[pos1](),
              left: shiftWidth[pos0]()
            };
            break;
          case 'left':
            targetElPos = {
              top: shiftHeight[pos1](),
              left: hostElPos.left - targetElWidth
            };
            break;
          case 'bottom':
            targetElPos = {
              top: shiftHeight[pos0](),
              left: shiftWidth[pos1]()
            };
            break;
          default:
            targetElPos = {
              top: hostElPos.top - targetElHeight,
              left: shiftWidth[pos1]()
            };
            break;
        }

        return targetElPos;
      }
    };
  }]);

angular.module('ui.bootstrap.datepicker', ['ui.bootstrap.dateparser', 'ui.bootstrap.position'])

.constant('datepickerConfig', {
  formatDay: 'dd',
  formatMonth: 'MMMM',
  formatYear: 'yyyy',
  formatDayHeader: 'EEE',
  formatDayTitle: 'MMMM yyyy',
  formatMonthTitle: 'yyyy',
  datepickerMode: 'day',
  minMode: 'day',
  maxMode: 'year',
  showWeeks: true,
  startingDay: 0,
  yearRange: 20,
  minDate: null,
  maxDate: null
})

.controller('DatepickerController', ['$scope', '$attrs', '$parse', '$interpolate', '$timeout', '$log', 'dateFilter', 'datepickerConfig', function($scope, $attrs, $parse, $interpolate, $timeout, $log, dateFilter, datepickerConfig) {
  var self = this,
      ngModelCtrl = { $setViewValue: angular.noop }; // nullModelCtrl;

  // Modes chain
  this.modes = ['day', 'month', 'year'];

  // Configuration attributes
  angular.forEach(['formatDay', 'formatMonth', 'formatYear', 'formatDayHeader', 'formatDayTitle', 'formatMonthTitle',
                   'minMode', 'maxMode', 'showWeeks', 'startingDay', 'yearRange'], function( key, index ) {
    self[key] = angular.isDefined($attrs[key]) ? (index < 8 ? $interpolate($attrs[key])($scope.$parent) : $scope.$parent.$eval($attrs[key])) : datepickerConfig[key];
  });

  // Watchable date attributes
  angular.forEach(['minDate', 'maxDate'], function( key ) {
    if ( $attrs[key] ) {
      $scope.$parent.$watch($parse($attrs[key]), function(value) {
        self[key] = value ? new Date(value) : null;
        self.refreshView();
      });
    } else {
      self[key] = datepickerConfig[key] ? new Date(datepickerConfig[key]) : null;
    }
  });

  $scope.datepickerMode = $scope.datepickerMode || datepickerConfig.datepickerMode;
  $scope.uniqueId = 'datepicker-' + $scope.$id + '-' + Math.floor(Math.random() * 10000);
  this.activeDate = angular.isDefined($attrs.initDate) ? $scope.$parent.$eval($attrs.initDate) : new Date();

  $scope.isActive = function(dateObject) {
    if (self.compare(dateObject.date, self.activeDate) === 0) {
      $scope.activeDateId = dateObject.uid;
      return true;
    }
    return false;
  };

  this.init = function( ngModelCtrl_ ) {
    ngModelCtrl = ngModelCtrl_;

    ngModelCtrl.$render = function() {
      self.render();
    };
  };

  this.render = function() {
    if ( ngModelCtrl.$modelValue ) {
      var date = new Date( ngModelCtrl.$modelValue ),
          isValid = !isNaN(date);

      if ( isValid ) {
        this.activeDate = date;
      } else {
        $log.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.');
      }
      ngModelCtrl.$setValidity('date', isValid);
    }
    this.refreshView();
  };

  this.refreshView = function() {
    if ( this.element ) {
      this._refreshView();

      var date = ngModelCtrl.$modelValue ? new Date(ngModelCtrl.$modelValue) : null;
      ngModelCtrl.$setValidity('date-disabled', !date || (this.element && !this.isDisabled(date)));
    }
  };

  this.createDateObject = function(date, format) {
    var model = ngModelCtrl.$modelValue ? new Date(ngModelCtrl.$modelValue) : null;
    return {
      date: date,
      label: dateFilter(date, format),
      selected: model && this.compare(date, model) === 0,
      disabled: this.isDisabled(date),
      current: this.compare(date, new Date()) === 0
    };
  };

  this.isDisabled = function( date ) {
    return ((this.minDate && this.compare(date, this.minDate) < 0) || (this.maxDate && this.compare(date, this.maxDate) > 0) || ($attrs.dateDisabled && $scope.dateDisabled({date: date, mode: $scope.datepickerMode})));
  };

  // Split array into smaller arrays
  this.split = function(arr, size) {
    var arrays = [];
    while (arr.length > 0) {
      arrays.push(arr.splice(0, size));
    }
    return arrays;
  };

  $scope.select = function( date ) {
    if ( $scope.datepickerMode === self.minMode ) {
      var dt = ngModelCtrl.$modelValue ? new Date( ngModelCtrl.$modelValue ) : new Date(0, 0, 0, 0, 0, 0, 0);
      dt.setFullYear( date.getFullYear(), date.getMonth(), date.getDate() );
      ngModelCtrl.$setViewValue( dt );
      ngModelCtrl.$render();
    } else {
      self.activeDate = date;
      $scope.datepickerMode = self.modes[ self.modes.indexOf( $scope.datepickerMode ) - 1 ];
    }
  };

  $scope.move = function( direction ) {
    var year = self.activeDate.getFullYear() + direction * (self.step.years || 0),
        month = self.activeDate.getMonth() + direction * (self.step.months || 0);
    self.activeDate.setFullYear(year, month, 1);
    self.refreshView();
  };

  $scope.toggleMode = function( direction ) {
    direction = direction || 1;

    if (($scope.datepickerMode === self.maxMode && direction === 1) || ($scope.datepickerMode === self.minMode && direction === -1)) {
      return;
    }

    $scope.datepickerMode = self.modes[ self.modes.indexOf( $scope.datepickerMode ) + direction ];
  };

  // Key event mapper
  $scope.keys = { 13:'enter', 32:'space', 33:'pageup', 34:'pagedown', 35:'end', 36:'home', 37:'left', 38:'up', 39:'right', 40:'down' };

  var focusElement = function() {
    $timeout(function() {
      self.element[0].focus();
    }, 0 , false);
  };

  // Listen for focus requests from popup directive
  $scope.$on('datepicker.focus', focusElement);

  $scope.keydown = function( evt ) {
    var key = $scope.keys[evt.which];

    if ( !key || evt.shiftKey || evt.altKey ) {
      return;
    }

    evt.preventDefault();
    evt.stopPropagation();

    if (key === 'enter' || key === 'space') {
      if ( self.isDisabled(self.activeDate)) {
        return; // do nothing
      }
      $scope.select(self.activeDate);
      focusElement();
    } else if (evt.ctrlKey && (key === 'up' || key === 'down')) {
      $scope.toggleMode(key === 'up' ? 1 : -1);
      focusElement();
    } else {
      self.handleKeyDown(key, evt);
      self.refreshView();
    }
  };
}])

.directive( 'datepicker', function () {
  return {
    restrict: 'EA',
    replace: true,
    templateUrl: 'template/datepicker/datepicker.html',
    scope: {
      datepickerMode: '=?',
      dateDisabled: '&'
    },
    require: ['datepicker', '?^ngModel'],
    controller: 'DatepickerController',
    link: function(scope, element, attrs, ctrls) {
      var datepickerCtrl = ctrls[0], ngModelCtrl = ctrls[1];

      if ( ngModelCtrl ) {
        datepickerCtrl.init( ngModelCtrl );
      }
    }
  };
})

.directive('daypicker', ['dateFilter', function (dateFilter) {
  return {
    restrict: 'EA',
    replace: true,
    templateUrl: 'template/datepicker/day.html',
    require: '^datepicker',
    link: function(scope, element, attrs, ctrl) {
      scope.showWeeks = ctrl.showWeeks;

      ctrl.step = { months: 1 };
      ctrl.element = element;

      var DAYS_IN_MONTH = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
      function getDaysInMonth( year, month ) {
        return ((month === 1) && (year % 4 === 0) && ((year % 100 !== 0) || (year % 400 === 0))) ? 29 : DAYS_IN_MONTH[month];
      }

      function getDates(startDate, n) {
        var dates = new Array(n), current = new Date(startDate), i = 0;
        current.setHours(12); // Prevent repeated dates because of timezone bug
        while ( i < n ) {
          dates[i++] = new Date(current);
          current.setDate( current.getDate() + 1 );
        }
        return dates;
      }

      ctrl._refreshView = function() {
        var year = ctrl.activeDate.getFullYear(),
          month = ctrl.activeDate.getMonth(),
          firstDayOfMonth = new Date(year, month, 1),
          difference = ctrl.startingDay - firstDayOfMonth.getDay(),
          numDisplayedFromPreviousMonth = (difference > 0) ? 7 - difference : - difference,
          firstDate = new Date(firstDayOfMonth);

        if ( numDisplayedFromPreviousMonth > 0 ) {
          firstDate.setDate( - numDisplayedFromPreviousMonth + 1 );
        }

        // 42 is the number of days on a six-month calendar
        var days = getDates(firstDate, 42);
        for (var i = 0; i < 42; i ++) {
          days[i] = angular.extend(ctrl.createDateObject(days[i], ctrl.formatDay), {
            secondary: days[i].getMonth() !== month,
            uid: scope.uniqueId + '-' + i
          });
        }

        scope.labels = new Array(7);
        for (var j = 0; j < 7; j++) {
          scope.labels[j] = {
            abbr: dateFilter(days[j].date, ctrl.formatDayHeader),
            full: dateFilter(days[j].date, 'EEEE')
          };
        }

        scope.title = dateFilter(ctrl.activeDate, ctrl.formatDayTitle);
        scope.rows = ctrl.split(days, 7);

        if ( scope.showWeeks ) {
          scope.weekNumbers = [];
          var weekNumber = getISO8601WeekNumber( scope.rows[0][0].date ),
              numWeeks = scope.rows.length;
          while( scope.weekNumbers.push(weekNumber++) < numWeeks ) {}
        }
      };

      ctrl.compare = function(date1, date2) {
        return (new Date( date1.getFullYear(), date1.getMonth(), date1.getDate() ) - new Date( date2.getFullYear(), date2.getMonth(), date2.getDate() ) );
      };

      function getISO8601WeekNumber(date) {
        var checkDate = new Date(date);
        checkDate.setDate(checkDate.getDate() + 4 - (checkDate.getDay() || 7)); // Thursday
        var time = checkDate.getTime();
        checkDate.setMonth(0); // Compare with Jan 1
        checkDate.setDate(1);
        return Math.floor(Math.round((time - checkDate) / 86400000) / 7) + 1;
      }

      ctrl.handleKeyDown = function( key, evt ) {
        var date = ctrl.activeDate.getDate();

        if (key === 'left') {
          date = date - 1;   // up
        } else if (key === 'up') {
          date = date - 7;   // down
        } else if (key === 'right') {
          date = date + 1;   // down
        } else if (key === 'down') {
          date = date + 7;
        } else if (key === 'pageup' || key === 'pagedown') {
          var month = ctrl.activeDate.getMonth() + (key === 'pageup' ? - 1 : 1);
          ctrl.activeDate.setMonth(month, 1);
          date = Math.min(getDaysInMonth(ctrl.activeDate.getFullYear(), ctrl.activeDate.getMonth()), date);
        } else if (key === 'home') {
          date = 1;
        } else if (key === 'end') {
          date = getDaysInMonth(ctrl.activeDate.getFullYear(), ctrl.activeDate.getMonth());
        }
        ctrl.activeDate.setDate(date);
      };

      ctrl.refreshView();
    }
  };
}])

.directive('monthpicker', ['dateFilter', function (dateFilter) {
  return {
    restrict: 'EA',
    replace: true,
    templateUrl: 'template/datepicker/month.html',
    require: '^datepicker',
    link: function(scope, element, attrs, ctrl) {
      ctrl.step = { years: 1 };
      ctrl.element = element;

      ctrl._refreshView = function() {
        var months = new Array(12),
            year = ctrl.activeDate.getFullYear();

        for ( var i = 0; i < 12; i++ ) {
          months[i] = angular.extend(ctrl.createDateObject(new Date(year, i, 1), ctrl.formatMonth), {
            uid: scope.uniqueId + '-' + i
          });
        }

        scope.title = dateFilter(ctrl.activeDate, ctrl.formatMonthTitle);
        scope.rows = ctrl.split(months, 3);
      };

      ctrl.compare = function(date1, date2) {
        return new Date( date1.getFullYear(), date1.getMonth() ) - new Date( date2.getFullYear(), date2.getMonth() );
      };

      ctrl.handleKeyDown = function( key, evt ) {
        var date = ctrl.activeDate.getMonth();

        if (key === 'left') {
          date = date - 1;   // up
        } else if (key === 'up') {
          date = date - 3;   // down
        } else if (key === 'right') {
          date = date + 1;   // down
        } else if (key === 'down') {
          date = date + 3;
        } else if (key === 'pageup' || key === 'pagedown') {
          var year = ctrl.activeDate.getFullYear() + (key === 'pageup' ? - 1 : 1);
          ctrl.activeDate.setFullYear(year);
        } else if (key === 'home') {
          date = 0;
        } else if (key === 'end') {
          date = 11;
        }
        ctrl.activeDate.setMonth(date);
      };

      ctrl.refreshView();
    }
  };
}])

.directive('yearpicker', ['dateFilter', function (dateFilter) {
  return {
    restrict: 'EA',
    replace: true,
    templateUrl: 'template/datepicker/year.html',
    require: '^datepicker',
    link: function(scope, element, attrs, ctrl) {
      var range = ctrl.yearRange;

      ctrl.step = { years: range };
      ctrl.element = element;

      function getStartingYear( year ) {
        return parseInt((year - 1) / range, 10) * range + 1;
      }

      ctrl._refreshView = function() {
        var years = new Array(range);

        for ( var i = 0, start = getStartingYear(ctrl.activeDate.getFullYear()); i < range; i++ ) {
          years[i] = angular.extend(ctrl.createDateObject(new Date(start + i, 0, 1), ctrl.formatYear), {
            uid: scope.uniqueId + '-' + i
          });
        }

        scope.title = [years[0].label, years[range - 1].label].join(' - ');
        scope.rows = ctrl.split(years, 5);
      };

      ctrl.compare = function(date1, date2) {
        return date1.getFullYear() - date2.getFullYear();
      };

      ctrl.handleKeyDown = function( key, evt ) {
        var date = ctrl.activeDate.getFullYear();

        if (key === 'left') {
          date = date - 1;   // up
        } else if (key === 'up') {
          date = date - 5;   // down
        } else if (key === 'right') {
          date = date + 1;   // down
        } else if (key === 'down') {
          date = date + 5;
        } else if (key === 'pageup' || key === 'pagedown') {
          date += (key === 'pageup' ? - 1 : 1) * ctrl.step.years;
        } else if (key === 'home') {
          date = getStartingYear( ctrl.activeDate.getFullYear() );
        } else if (key === 'end') {
          date = getStartingYear( ctrl.activeDate.getFullYear() ) + range - 1;
        }
        ctrl.activeDate.setFullYear(date);
      };

      ctrl.refreshView();
    }
  };
}])

.constant('datepickerPopupConfig', {
  datepickerPopup: 'yyyy-MM-dd',
  currentText: 'Today',
  clearText: 'Clear',
  closeText: 'Done',
  closeOnDateSelection: true,
  appendToBody: false,
  showButtonBar: false
})

.directive('datepickerPopup', ['$compile', '$parse', '$document', '$position', 'dateFilter', 'dateParser', 'datepickerPopupConfig',
function ($compile, $parse, $document, $position, dateFilter, dateParser, datepickerPopupConfig) {
  return {
    restrict: 'EA',
    require: 'ngModel',
    scope: {
      isOpen: '=?',
      currentText: '@',
      clearText: '@',
      closeText: '@',
      dateDisabled: '&'
    },
    link: function(scope, element, attrs, ngModel) {
      var dateFormat,
          closeOnDateSelection = angular.isDefined(attrs.closeOnDateSelection) ? scope.$parent.$eval(attrs.closeOnDateSelection) : datepickerPopupConfig.closeOnDateSelection,
          appendToBody = angular.isDefined(attrs.datepickerAppendToBody) ? scope.$parent.$eval(attrs.datepickerAppendToBody) : datepickerPopupConfig.appendToBody;

      scope.showButtonBar = angular.isDefined(attrs.showButtonBar) ? scope.$parent.$eval(attrs.showButtonBar) : datepickerPopupConfig.showButtonBar;

      scope.getText = function( key ) {
        return scope[key + 'Text'] || datepickerPopupConfig[key + 'Text'];
      };

      attrs.$observe('datepickerPopup', function(value) {
          dateFormat = value || datepickerPopupConfig.datepickerPopup;
          ngModel.$render();
      });

      // popup element used to display calendar
      var popupEl = angular.element('<div datepicker-popup-wrap><div datepicker></div></div>');
      popupEl.attr({
        'ng-model': 'date',
        'ng-change': 'dateSelection()'
      });

      function cameltoDash( string ){
        return string.replace(/([A-Z])/g, function($1) { return '-' + $1.toLowerCase(); });
      }

      // datepicker element
      var datepickerEl = angular.element(popupEl.children()[0]);
      if ( attrs.datepickerOptions ) {
        angular.forEach(scope.$parent.$eval(attrs.datepickerOptions), function( value, option ) {
          datepickerEl.attr( cameltoDash(option), value );
        });
      }

      scope.watchData = {};
      angular.forEach(['minDate', 'maxDate', 'datepickerMode'], function( key ) {
        if ( attrs[key] ) {
          var getAttribute = $parse(attrs[key]);
          scope.$parent.$watch(getAttribute, function(value){
            scope.watchData[key] = value;
          });
          datepickerEl.attr(cameltoDash(key), 'watchData.' + key);

          // Propagate changes from datepicker to outside
          if ( key === 'datepickerMode' ) {
            var setAttribute = getAttribute.assign;
            scope.$watch('watchData.' + key, function(value, oldvalue) {
              if ( value !== oldvalue ) {
                setAttribute(scope.$parent, value);
              }
            });
          }
        }
      });
      if (attrs.dateDisabled) {
        datepickerEl.attr('date-disabled', 'dateDisabled({ date: date, mode: mode })');
      }

      function parseDate(viewValue) {
        if (!viewValue) {
          ngModel.$setValidity('date', true);
          return null;
        } else if (angular.isDate(viewValue) && !isNaN(viewValue)) {
          ngModel.$setValidity('date', true);
          return viewValue;
        } else if (angular.isString(viewValue)) {
          var date = dateParser.parse(viewValue, dateFormat) || new Date(viewValue);
          if (isNaN(date)) {
            ngModel.$setValidity('date', false);
            return undefined;
          } else {
            ngModel.$setValidity('date', true);
            return date;
          }
        } else {
          ngModel.$setValidity('date', false);
          return undefined;
        }
      }
      ngModel.$parsers.unshift(parseDate);

      // Inner change
      scope.dateSelection = function(dt) {
        if (angular.isDefined(dt)) {
          scope.date = dt;
        }
        ngModel.$setViewValue(scope.date);
        ngModel.$render();

        if ( closeOnDateSelection ) {
          scope.isOpen = false;
          element[0].focus();
        }
      };

      element.bind('input change keyup', function() {
        scope.$apply(function() {
          scope.date = ngModel.$modelValue;
        });
      });

      // Outter change
      ngModel.$render = function() {
        var date = ngModel.$viewValue ? dateFilter(ngModel.$viewValue, dateFormat) : '';
        element.val(date);
        scope.date = parseDate( ngModel.$modelValue );
      };

      var documentClickBind = function(event) {
        if (scope.isOpen && event.target !== element[0]) {
          scope.$apply(function() {
            scope.isOpen = false;
          });
        }
      };

      var keydown = function(evt, noApply) {
        scope.keydown(evt);
      };
      element.bind('keydown', keydown);

      scope.keydown = function(evt) {
        if (evt.which === 27) {
          evt.preventDefault();
          evt.stopPropagation();
          scope.close();
        } else if (evt.which === 40 && !scope.isOpen) {
          scope.isOpen = true;
        }
      };

      scope.$watch('isOpen', function(value) {
        if (value) {
          scope.$broadcast('datepicker.focus');
          scope.position = appendToBody ? $position.offset(element) : $position.position(element);
          scope.position.top = scope.position.top + element.prop('offsetHeight');

          $document.bind('click', documentClickBind);
        } else {
          $document.unbind('click', documentClickBind);
        }
      });

      scope.select = function( date ) {
        if (date === 'today') {
          var today = new Date();
          if (angular.isDate(ngModel.$modelValue)) {
            date = new Date(ngModel.$modelValue);
            date.setFullYear(today.getFullYear(), today.getMonth(), today.getDate());
          } else {
            date = new Date(today.setHours(0, 0, 0, 0));
          }
        }
        scope.dateSelection( date );
      };

      scope.close = function() {
        scope.isOpen = false;
        element[0].focus();
      };

      var $popup = $compile(popupEl)(scope);
      // Prevent jQuery cache memory leak (template is now redundant after linking)
      popupEl.remove();

      if ( appendToBody ) {
        $document.find('body').append($popup);
      } else {
        element.after($popup);
      }

      scope.$on('$destroy', function() {
        $popup.remove();
        element.unbind('keydown', keydown);
        $document.unbind('click', documentClickBind);
      });
    }
  };
}])

.directive('datepickerPopupWrap', function() {
  return {
    restrict:'EA',
    replace: true,
    transclude: true,
    templateUrl: 'template/datepicker/popup.html',
    link:function (scope, element, attrs) {
      element.bind('click', function(event) {
        event.preventDefault();
        event.stopPropagation();
      });
    }
  };
});

angular.module('ui.bootstrap.dropdown', [])

.constant('dropdownConfig', {
  openClass: 'open'
})

.service('dropdownService', ['$document', function($document) {
  var openScope = null;

  this.open = function( dropdownScope ) {
    if ( !openScope ) {
      $document.bind('click', closeDropdown);
      $document.bind('keydown', escapeKeyBind);
    }

    if ( openScope && openScope !== dropdownScope ) {
        openScope.isOpen = false;
    }

    openScope = dropdownScope;
  };

  this.close = function( dropdownScope ) {
    if ( openScope === dropdownScope ) {
      openScope = null;
      $document.unbind('click', closeDropdown);
      $document.unbind('keydown', escapeKeyBind);
    }
  };

  var closeDropdown = function( evt ) {
    // This method may still be called during the same mouse event that
    // unbound this event handler. So check openScope before proceeding.
    if (!openScope) { return; }

    var toggleElement = openScope.getToggleElement();
    if ( evt && toggleElement && toggleElement[0].contains(evt.target) ) {
        return;
    }

    openScope.$apply(function() {
      openScope.isOpen = false;
    });
  };

  var escapeKeyBind = function( evt ) {
    if ( evt.which === 27 ) {
      openScope.focusToggleElement();
      closeDropdown();
    }
  };
}])

.controller('DropdownController', ['$scope', '$attrs', '$parse', 'dropdownConfig', 'dropdownService', '$animate', function($scope, $attrs, $parse, dropdownConfig, dropdownService, $animate) {
  var self = this,
      scope = $scope.$new(), // create a child scope so we are not polluting original one
      openClass = dropdownConfig.openClass,
      getIsOpen,
      setIsOpen = angular.noop,
      toggleInvoker = $attrs.onToggle ? $parse($attrs.onToggle) : angular.noop;

  this.init = function( element ) {
    self.$element = element;

    if ( $attrs.isOpen ) {
      getIsOpen = $parse($attrs.isOpen);
      setIsOpen = getIsOpen.assign;

      $scope.$watch(getIsOpen, function(value) {
        scope.isOpen = !!value;
      });
    }
  };

  this.toggle = function( open ) {
    return scope.isOpen = arguments.length ? !!open : !scope.isOpen;
  };

  // Allow other directives to watch status
  this.isOpen = function() {
    return scope.isOpen;
  };

  scope.getToggleElement = function() {
    return self.toggleElement;
  };

  scope.focusToggleElement = function() {
    if ( self.toggleElement ) {
      self.toggleElement[0].focus();
    }
  };

  scope.$watch('isOpen', function( isOpen, wasOpen ) {
    $animate[isOpen ? 'addClass' : 'removeClass'](self.$element, openClass);

    if ( isOpen ) {
      scope.focusToggleElement();
      dropdownService.open( scope );
    } else {
      dropdownService.close( scope );
    }

    setIsOpen($scope, isOpen);
    if (angular.isDefined(isOpen) && isOpen !== wasOpen) {
      toggleInvoker($scope, { open: !!isOpen });
    }
  });

  $scope.$on('$locationChangeSuccess', function() {
    scope.isOpen = false;
  });

  $scope.$on('$destroy', function() {
    scope.$destroy();
  });
}])

.directive('dropdown', function() {
  return {
    controller: 'DropdownController',
    link: function(scope, element, attrs, dropdownCtrl) {
      dropdownCtrl.init( element );
    }
  };
})

.directive('dropdownToggle', function() {
  return {
    require: '?^dropdown',
    link: function(scope, element, attrs, dropdownCtrl) {
      if ( !dropdownCtrl ) {
        return;
      }

      dropdownCtrl.toggleElement = element;

      var toggleDropdown = function(event) {
        event.preventDefault();

        if ( !element.hasClass('disabled') && !attrs.disabled ) {
          scope.$apply(function() {
            dropdownCtrl.toggle();
          });
        }
      };

      element.bind('click', toggleDropdown);

      // WAI-ARIA
      element.attr({ 'aria-haspopup': true, 'aria-expanded': false });
      scope.$watch(dropdownCtrl.isOpen, function( isOpen ) {
        element.attr('aria-expanded', !!isOpen);
      });

      scope.$on('$destroy', function() {
        element.unbind('click', toggleDropdown);
      });
    }
  };
});

angular.module('ui.bootstrap.modal', ['ui.bootstrap.transition'])

/**
 * A helper, internal data structure that acts as a map but also allows getting / removing
 * elements in the LIFO order
 */
  .factory('$$stackedMap', function () {
    return {
      createNew: function () {
        var stack = [];

        return {
          add: function (key, value) {
            stack.push({
              key: key,
              value: value
            });
          },
          get: function (key) {
            for (var i = 0; i < stack.length; i++) {
              if (key == stack[i].key) {
                return stack[i];
              }
            }
          },
          keys: function() {
            var keys = [];
            for (var i = 0; i < stack.length; i++) {
              keys.push(stack[i].key);
            }
            return keys;
          },
          top: function () {
            return stack[stack.length - 1];
          },
          remove: function (key) {
            var idx = -1;
            for (var i = 0; i < stack.length; i++) {
              if (key == stack[i].key) {
                idx = i;
                break;
              }
            }
            return stack.splice(idx, 1)[0];
          },
          removeTop: function () {
            return stack.splice(stack.length - 1, 1)[0];
          },
          length: function () {
            return stack.length;
          }
        };
      }
    };
  })

/**
 * A helper directive for the $modal service. It creates a backdrop element.
 */
  .directive('modalBackdrop', ['$timeout', function ($timeout) {
    return {
      restrict: 'EA',
      replace: true,
      templateUrl: 'template/modal/backdrop.html',
      link: function (scope, element, attrs) {
        scope.backdropClass = attrs.backdropClass || '';

        scope.animate = false;

        //trigger CSS transitions
        $timeout(function () {
          scope.animate = true;
        });
      }
    };
  }])

  .directive('modalWindow', ['$modalStack', '$timeout', function ($modalStack, $timeout) {
    return {
      restrict: 'EA',
      scope: {
        index: '@',
        animate: '='
      },
      replace: true,
      transclude: true,
      templateUrl: function(tElement, tAttrs) {
        return tAttrs.templateUrl || 'template/modal/window.html';
      },
      link: function (scope, element, attrs) {
        element.addClass(attrs.windowClass || '');
        scope.size = attrs.size;

        $timeout(function () {
          // trigger CSS transitions
          scope.animate = true;

          /**
           * Auto-focusing of a freshly-opened modal element causes any child elements
           * with the autofocus attribute to lose focus. This is an issue on touch
           * based devices which will show and then hide the onscreen keyboard.
           * Attempts to refocus the autofocus element via JavaScript will not reopen
           * the onscreen keyboard. Fixed by updated the focusing logic to only autofocus
           * the modal element if the modal does not contain an autofocus element.
           */
          if (!element[0].querySelectorAll('[autofocus]').length) {
            element[0].focus();
          }
        });

        scope.close = function (evt) {
          var modal = $modalStack.getTop();
          if (modal && modal.value.backdrop && modal.value.backdrop != 'static' && (evt.target === evt.currentTarget)) {
            evt.preventDefault();
            evt.stopPropagation();
            $modalStack.dismiss(modal.key, 'backdrop click');
          }
        };
      }
    };
  }])

  .directive('modalTransclude', function () {
    return {
      link: function($scope, $element, $attrs, controller, $transclude) {
        $transclude($scope.$parent, function(clone) {
          $element.empty();
          $element.append(clone);
        });
      }
    };
  })

  .factory('$modalStack', ['$transition', '$timeout', '$document', '$compile', '$rootScope', '$$stackedMap',
    function ($transition, $timeout, $document, $compile, $rootScope, $$stackedMap) {

      var OPENED_MODAL_CLASS = 'modal-open';

      var backdropDomEl, backdropScope;
      var openedWindows = $$stackedMap.createNew();
      var $modalStack = {};

      function backdropIndex() {
        var topBackdropIndex = -1;
        var opened = openedWindows.keys();
        for (var i = 0; i < opened.length; i++) {
          if (openedWindows.get(opened[i]).value.backdrop) {
            topBackdropIndex = i;
          }
        }
        return topBackdropIndex;
      }

      $rootScope.$watch(backdropIndex, function(newBackdropIndex){
        if (backdropScope) {
          backdropScope.index = newBackdropIndex;
        }
      });

      function removeModalWindow(modalInstance) {

        var body = $document.find('body').eq(0);
        var modalWindow = openedWindows.get(modalInstance).value;

        //clean up the stack
        openedWindows.remove(modalInstance);

        //remove window DOM element
        removeAfterAnimate(modalWindow.modalDomEl, modalWindow.modalScope, 300, function() {
          modalWindow.modalScope.$destroy();
          body.toggleClass(OPENED_MODAL_CLASS, openedWindows.length() > 0);
          checkRemoveBackdrop();
        });
      }

      function checkRemoveBackdrop() {
          //remove backdrop if no longer needed
          if (backdropDomEl && backdropIndex() == -1) {
            var backdropScopeRef = backdropScope;
            removeAfterAnimate(backdropDomEl, backdropScope, 150, function () {
              backdropScopeRef.$destroy();
              backdropScopeRef = null;
            });
            backdropDomEl = undefined;
            backdropScope = undefined;
          }
      }

      function removeAfterAnimate(domEl, scope, emulateTime, done) {
        // Closing animation
        scope.animate = false;

        var transitionEndEventName = $transition.transitionEndEventName;
        if (transitionEndEventName) {
          // transition out
          var timeout = $timeout(afterAnimating, emulateTime);

          domEl.bind(transitionEndEventName, function () {
            $timeout.cancel(timeout);
            afterAnimating();
            scope.$apply();
          });
        } else {
          // Ensure this call is async
          $timeout(afterAnimating);
        }

        function afterAnimating() {
          if (afterAnimating.done) {
            return;
          }
          afterAnimating.done = true;

          domEl.remove();
          if (done) {
            done();
          }
        }
      }

      $document.bind('keydown', function (evt) {
        var modal;

        if (evt.which === 27) {
          modal = openedWindows.top();
          if (modal && modal.value.keyboard) {
            evt.preventDefault();
            $rootScope.$apply(function () {
              $modalStack.dismiss(modal.key, 'escape key press');
            });
          }
        }
      });

      $modalStack.open = function (modalInstance, modal) {

        openedWindows.add(modalInstance, {
          deferred: modal.deferred,
          modalScope: modal.scope,
          backdrop: modal.backdrop,
          keyboard: modal.keyboard
        });

        var body = $document.find('body').eq(0),
            currBackdropIndex = backdropIndex();

        if (currBackdropIndex >= 0 && !backdropDomEl) {
          backdropScope = $rootScope.$new(true);
          backdropScope.index = currBackdropIndex;
          var angularBackgroundDomEl = angular.element('<div modal-backdrop></div>');
          angularBackgroundDomEl.attr('backdrop-class', modal.backdropClass);
          backdropDomEl = $compile(angularBackgroundDomEl)(backdropScope);
          body.append(backdropDomEl);
        }

        var angularDomEl = angular.element('<div modal-window></div>');
        angularDomEl.attr({
          'template-url': modal.windowTemplateUrl,
          'window-class': modal.windowClass,
          'size': modal.size,
          'index': openedWindows.length() - 1,
          'animate': 'animate'
        }).html(modal.content);

        var modalDomEl = $compile(angularDomEl)(modal.scope);
        openedWindows.top().value.modalDomEl = modalDomEl;
        body.append(modalDomEl);
        body.addClass(OPENED_MODAL_CLASS);
      };

      $modalStack.close = function (modalInstance, result) {
        var modalWindow = openedWindows.get(modalInstance);
        if (modalWindow) {
          modalWindow.value.deferred.resolve(result);
          removeModalWindow(modalInstance);
        }
      };

      $modalStack.dismiss = function (modalInstance, reason) {
        var modalWindow = openedWindows.get(modalInstance);
        if (modalWindow) {
          modalWindow.value.deferred.reject(reason);
          removeModalWindow(modalInstance);
        }
      };

      $modalStack.dismissAll = function (reason) {
        var topModal = this.getTop();
        while (topModal) {
          this.dismiss(topModal.key, reason);
          topModal = this.getTop();
        }
      };

      $modalStack.getTop = function () {
        return openedWindows.top();
      };

      return $modalStack;
    }])

  .provider('$modal', function () {

    var $modalProvider = {
      options: {
        backdrop: true, //can be also false or 'static'
        keyboard: true
      },
      $get: ['$injector', '$rootScope', '$q', '$http', '$templateCache', '$controller', '$modalStack',
        function ($injector, $rootScope, $q, $http, $templateCache, $controller, $modalStack) {

          var $modal = {};

          function getTemplatePromise(options) {
            return options.template ? $q.when(options.template) :
              $http.get(angular.isFunction(options.templateUrl) ? (options.templateUrl)() : options.templateUrl,
                {cache: $templateCache}).then(function (result) {
                  return result.data;
              });
          }

          function getResolvePromises(resolves) {
            var promisesArr = [];
            angular.forEach(resolves, function (value) {
              if (angular.isFunction(value) || angular.isArray(value)) {
                promisesArr.push($q.when($injector.invoke(value)));
              }
            });
            return promisesArr;
          }

          $modal.open = function (modalOptions) {

            var modalResultDeferred = $q.defer();
            var modalOpenedDeferred = $q.defer();

            //prepare an instance of a modal to be injected into controllers and returned to a caller
            var modalInstance = {
              result: modalResultDeferred.promise,
              opened: modalOpenedDeferred.promise,
              close: function (result) {
                $modalStack.close(modalInstance, result);
              },
              dismiss: function (reason) {
                $modalStack.dismiss(modalInstance, reason);
              }
            };

            //merge and clean up options
            modalOptions = angular.extend({}, $modalProvider.options, modalOptions);
            modalOptions.resolve = modalOptions.resolve || {};

            //verify options
            if (!modalOptions.template && !modalOptions.templateUrl) {
              throw new Error('One of template or templateUrl options is required.');
            }

            var templateAndResolvePromise =
              $q.all([getTemplatePromise(modalOptions)].concat(getResolvePromises(modalOptions.resolve)));


            templateAndResolvePromise.then(function resolveSuccess(tplAndVars) {

              var modalScope = (modalOptions.scope || $rootScope).$new();
              modalScope.$close = modalInstance.close;
              modalScope.$dismiss = modalInstance.dismiss;

              var ctrlInstance, ctrlLocals = {};
              var resolveIter = 1;

              //controllers
              if (modalOptions.controller) {
                ctrlLocals.$scope = modalScope;
                ctrlLocals.$modalInstance = modalInstance;
                angular.forEach(modalOptions.resolve, function (value, key) {
                  ctrlLocals[key] = tplAndVars[resolveIter++];
                });

                ctrlInstance = $controller(modalOptions.controller, ctrlLocals);
                if (modalOptions.controllerAs) {
                  modalScope[modalOptions.controllerAs] = ctrlInstance;
                }
              }

              $modalStack.open(modalInstance, {
                scope: modalScope,
                deferred: modalResultDeferred,
                content: tplAndVars[0],
                backdrop: modalOptions.backdrop,
                keyboard: modalOptions.keyboard,
                backdropClass: modalOptions.backdropClass,
                windowClass: modalOptions.windowClass,
                windowTemplateUrl: modalOptions.windowTemplateUrl,
                size: modalOptions.size
              });

            }, function resolveError(reason) {
              modalResultDeferred.reject(reason);
            });

            templateAndResolvePromise.then(function () {
              modalOpenedDeferred.resolve(true);
            }, function () {
              modalOpenedDeferred.reject(false);
            });

            return modalInstance;
          };

          return $modal;
        }]
    };

    return $modalProvider;
  });

angular.module('ui.bootstrap.pagination', [])

.controller('PaginationController', ['$scope', '$attrs', '$parse', function ($scope, $attrs, $parse) {
  var self = this,
      ngModelCtrl = { $setViewValue: angular.noop }, // nullModelCtrl
      setNumPages = $attrs.numPages ? $parse($attrs.numPages).assign : angular.noop;

  this.init = function(ngModelCtrl_, config) {
    ngModelCtrl = ngModelCtrl_;
    this.config = config;

    ngModelCtrl.$render = function() {
      self.render();
    };

    if ($attrs.itemsPerPage) {
      $scope.$parent.$watch($parse($attrs.itemsPerPage), function(value) {
        self.itemsPerPage = parseInt(value, 10);
        $scope.totalPages = self.calculateTotalPages();
      });
    } else {
      this.itemsPerPage = config.itemsPerPage;
    }
  };

  this.calculateTotalPages = function() {
    var totalPages = this.itemsPerPage < 1 ? 1 : Math.ceil($scope.totalItems / this.itemsPerPage);
    return Math.max(totalPages || 0, 1);
  };

  this.render = function() {
    $scope.page = parseInt(ngModelCtrl.$viewValue, 10) || 1;
  };

  $scope.selectPage = function(page) {
    if ( $scope.page !== page && page > 0 && page <= $scope.totalPages) {
      ngModelCtrl.$setViewValue(page);
      ngModelCtrl.$render();
    }
  };

  $scope.getText = function( key ) {
    return $scope[key + 'Text'] || self.config[key + 'Text'];
  };
  $scope.noPrevious = function() {
    return $scope.page === 1;
  };
  $scope.noNext = function() {
    return $scope.page === $scope.totalPages;
  };

  $scope.$watch('totalItems', function() {
    $scope.totalPages = self.calculateTotalPages();
  });

  $scope.$watch('totalPages', function(value) {
    setNumPages($scope.$parent, value); // Readonly variable

    if ( $scope.page > value ) {
      $scope.selectPage(value);
    } else {
      ngModelCtrl.$render();
    }
  });
}])

.constant('paginationConfig', {
  itemsPerPage: 10,
  boundaryLinks: false,
  directionLinks: true,
  firstText: 'First',
  previousText: 'Previous',
  nextText: 'Next',
  lastText: 'Last',
  rotate: true
})

.directive('pagination', ['$parse', 'paginationConfig', function($parse, paginationConfig) {
  return {
    restrict: 'EA',
    scope: {
      totalItems: '=',
      firstText: '@',
      previousText: '@',
      nextText: '@',
      lastText: '@'
    },
    require: ['pagination', '?ngModel'],
    controller: 'PaginationController',
    templateUrl: 'template/pagination/pagination.html',
    replace: true,
    link: function(scope, element, attrs, ctrls) {
      var paginationCtrl = ctrls[0], ngModelCtrl = ctrls[1];

      if (!ngModelCtrl) {
         return; // do nothing if no ng-model
      }

      // Setup configuration parameters
      var maxSize = angular.isDefined(attrs.maxSize) ? scope.$parent.$eval(attrs.maxSize) : paginationConfig.maxSize,
          rotate = angular.isDefined(attrs.rotate) ? scope.$parent.$eval(attrs.rotate) : paginationConfig.rotate;
      scope.boundaryLinks = angular.isDefined(attrs.boundaryLinks) ? scope.$parent.$eval(attrs.boundaryLinks) : paginationConfig.boundaryLinks;
      scope.directionLinks = angular.isDefined(attrs.directionLinks) ? scope.$parent.$eval(attrs.directionLinks) : paginationConfig.directionLinks;

      paginationCtrl.init(ngModelCtrl, paginationConfig);

      if (attrs.maxSize) {
        scope.$parent.$watch($parse(attrs.maxSize), function(value) {
          maxSize = parseInt(value, 10);
          paginationCtrl.render();
        });
      }

      // Create page object used in template
      function makePage(number, text, isActive) {
        return {
          number: number,
          text: text,
          active: isActive
        };
      }

      function getPages(currentPage, totalPages) {
        var pages = [];

        // Default page limits
        var startPage = 1, endPage = totalPages;
        var isMaxSized = ( angular.isDefined(maxSize) && maxSize < totalPages );

        // recompute if maxSize
        if ( isMaxSized ) {
          if ( rotate ) {
            // Current page is displayed in the middle of the visible ones
            startPage = Math.max(currentPage - Math.floor(maxSize/2), 1);
            endPage   = startPage + maxSize - 1;

            // Adjust if limit is exceeded
            if (endPage > totalPages) {
              endPage   = totalPages;
              startPage = endPage - maxSize + 1;
            }
          } else {
            // Visible pages are paginated with maxSize
            startPage = ((Math.ceil(currentPage / maxSize) - 1) * maxSize) + 1;

            // Adjust last page if limit is exceeded
            endPage = Math.min(startPage + maxSize - 1, totalPages);
          }
        }

        // Add page number links
        for (var number = startPage; number <= endPage; number++) {
          var page = makePage(number, number, number === currentPage);
          pages.push(page);
        }

        // Add links to move between page sets
        if ( isMaxSized && ! rotate ) {
          if ( startPage > 1 ) {
            var previousPageSet = makePage(startPage - 1, '...', false);
            pages.unshift(previousPageSet);
          }

          if ( endPage < totalPages ) {
            var nextPageSet = makePage(endPage + 1, '...', false);
            pages.push(nextPageSet);
          }
        }

        return pages;
      }

      var originalRender = paginationCtrl.render;
      paginationCtrl.render = function() {
        originalRender();
        if (scope.page > 0 && scope.page <= scope.totalPages) {
          scope.pages = getPages(scope.page, scope.totalPages);
        }
      };
    }
  };
}])

.constant('pagerConfig', {
  itemsPerPage: 10,
  previousText: '« Previous',
  nextText: 'Next »',
  align: true
})

.directive('pager', ['pagerConfig', function(pagerConfig) {
  return {
    restrict: 'EA',
    scope: {
      totalItems: '=',
      previousText: '@',
      nextText: '@'
    },
    require: ['pager', '?ngModel'],
    controller: 'PaginationController',
    templateUrl: 'template/pagination/pager.html',
    replace: true,
    link: function(scope, element, attrs, ctrls) {
      var paginationCtrl = ctrls[0], ngModelCtrl = ctrls[1];

      if (!ngModelCtrl) {
         return; // do nothing if no ng-model
      }

      scope.align = angular.isDefined(attrs.align) ? scope.$parent.$eval(attrs.align) : pagerConfig.align;
      paginationCtrl.init(ngModelCtrl, pagerConfig);
    }
  };
}]);

/**
 * The following features are still outstanding: animation as a
 * function, placement as a function, inside, support for more triggers than
 * just mouse enter/leave, html tooltips, and selector delegation.
 */
angular.module( 'ui.bootstrap.tooltip', [ 'ui.bootstrap.position', 'ui.bootstrap.bindHtml' ] )

/**
 * The $tooltip service creates tooltip- and popover-like directives as well as
 * houses global options for them.
 */
.provider( '$tooltip', function () {
  // The default options tooltip and popover.
  var defaultOptions = {
    placement: 'top',
    animation: true,
    popupDelay: 0
  };

  // Default hide triggers for each show trigger
  var triggerMap = {
    'mouseenter': 'mouseleave',
    'click': 'click',
    'focus': 'blur'
  };

  // The options specified to the provider globally.
  var globalOptions = {};

  /**
   * `options({})` allows global configuration of all tooltips in the
   * application.
   *
   *   var app = angular.module( 'App', ['ui.bootstrap.tooltip'], function( $tooltipProvider ) {
   *     // place tooltips left instead of top by default
   *     $tooltipProvider.options( { placement: 'left' } );
   *   });
   */
    this.options = function( value ) {
        angular.extend( globalOptions, value );
    };

  /**
   * This allows you to extend the set of trigger mappings available. E.g.:
   *
   *   $tooltipProvider.setTriggers( 'openTrigger': 'closeTrigger' );
   */
  this.setTriggers = function setTriggers ( triggers ) {
    angular.extend( triggerMap, triggers );
  };

  /**
   * This is a helper function for translating camel-case to snake-case.
   */
  function snake_case(name){
    var regexp = /[A-Z]/g;
    var separator = '-';
    return name.replace(regexp, function(letter, pos) {
      return (pos ? separator : '') + letter.toLowerCase();
    });
  }

  /**
   * Returns the actual instance of the $tooltip service.
   * TODO support multiple triggers
   */
  this.$get = [ '$window', '$compile', '$timeout', '$document', '$position', '$interpolate', function ( $window, $compile, $timeout, $document, $position, $interpolate ) {
    return function $tooltip ( type, prefix, defaultTriggerShow ) {
      var options = angular.extend( {}, defaultOptions, globalOptions );

      /**
       * Returns an object of show and hide triggers.
       *
       * If a trigger is supplied,
       * it is used to show the tooltip; otherwise, it will use the `trigger`
       * option passed to the `$tooltipProvider.options` method; else it will
       * default to the trigger supplied to this directive factory.
       *
       * The hide trigger is based on the show trigger. If the `trigger` option
       * was passed to the `$tooltipProvider.options` method, it will use the
       * mapped trigger from `triggerMap` or the passed trigger if the map is
       * undefined; otherwise, it uses the `triggerMap` value of the show
       * trigger; else it will just use the show trigger.
       */
      function getTriggers ( trigger ) {
        var show = trigger || options.trigger || defaultTriggerShow;
        var hide = triggerMap[show] || show;
        return {
          show: show,
          hide: hide
        };
      }

      var directiveName = snake_case( type );

      var startSym = $interpolate.startSymbol();
      var endSym = $interpolate.endSymbol();
      var template =
        '<div '+ directiveName +'-popup '+
          'title="'+startSym+'title'+endSym+'" '+
          'content="'+startSym+'content'+endSym+'" '+
          'placement="'+startSym+'placement'+endSym+'" '+
          'animation="animation" '+
          'is-open="isOpen"'+
          '>'+
        '</div>';

      return {
        restrict: 'EA',
        compile: function (tElem, tAttrs) {
          var tooltipLinker = $compile( template );

          return function link ( scope, element, attrs ) {
            var tooltip;
            var tooltipLinkedScope;
            var transitionTimeout;
            var popupTimeout;
            var appendToBody = angular.isDefined( options.appendToBody ) ? options.appendToBody : false;
            var triggers = getTriggers( undefined );
            var hasEnableExp = angular.isDefined(attrs[prefix+'Enable']);
            var ttScope = scope.$new(true);

            var positionTooltip = function () {

              var ttPosition = $position.positionElements(element, tooltip, ttScope.placement, appendToBody);
              ttPosition.top += 'px';
              ttPosition.left += 'px';

              // Now set the calculated positioning.
              tooltip.css( ttPosition );
            };

            // By default, the tooltip is not open.
            // TODO add ability to start tooltip opened
            ttScope.isOpen = false;

            function toggleTooltipBind () {
              if ( ! ttScope.isOpen ) {
                showTooltipBind();
              } else {
                hideTooltipBind();
              }
            }

            // Show the tooltip with delay if specified, otherwise show it immediately
            function showTooltipBind() {
              if(hasEnableExp && !scope.$eval(attrs[prefix+'Enable'])) {
                return;
              }

              prepareTooltip();

              if ( ttScope.popupDelay ) {
                // Do nothing if the tooltip was already scheduled to pop-up.
                // This happens if show is triggered multiple times before any hide is triggered.
                if (!popupTimeout) {
                  popupTimeout = $timeout( show, ttScope.popupDelay, false );
                  popupTimeout.then(function(reposition){reposition();});
                }
              } else {
                show()();
              }
            }

            function hideTooltipBind () {
              scope.$apply(function () {
                hide();
              });
            }

            // Show the tooltip popup element.
            function show() {

              popupTimeout = null;

              // If there is a pending remove transition, we must cancel it, lest the
              // tooltip be mysteriously removed.
              if ( transitionTimeout ) {
                $timeout.cancel( transitionTimeout );
                transitionTimeout = null;
              }

              // Don't show empty tooltips.
              if ( ! ttScope.content ) {
                return angular.noop;
              }

              createTooltip();

              // Set the initial positioning.
              tooltip.css({ top: 0, left: 0, display: 'block' });
              ttScope.$digest();

              positionTooltip();

              // And show the tooltip.
              ttScope.isOpen = true;
              ttScope.$digest(); // digest required as $apply is not called

              // Return positioning function as promise callback for correct
              // positioning after draw.
              return positionTooltip;
            }

            // Hide the tooltip popup element.
            function hide() {
              // First things first: we don't show it anymore.
              ttScope.isOpen = false;

              //if tooltip is going to be shown after delay, we must cancel this
              $timeout.cancel( popupTimeout );
              popupTimeout = null;

              // And now we remove it from the DOM. However, if we have animation, we
              // need to wait for it to expire beforehand.
              // FIXME: this is a placeholder for a port of the transitions library.
              if ( ttScope.animation ) {
                if (!transitionTimeout) {
                  transitionTimeout = $timeout(removeTooltip, 500);
                }
              } else {
                removeTooltip();
              }
            }

            function createTooltip() {
              // There can only be one tooltip element per directive shown at once.
              if (tooltip) {
                removeTooltip();
              }
              tooltipLinkedScope = ttScope.$new();
              tooltip = tooltipLinker(tooltipLinkedScope, function (tooltip) {
                if ( appendToBody ) {
                  $document.find( 'body' ).append( tooltip );
                } else {
                  element.after( tooltip );
                }
              });
            }

            function removeTooltip() {
              transitionTimeout = null;
              if (tooltip) {
                tooltip.remove();
                tooltip = null;
              }
              if (tooltipLinkedScope) {
                tooltipLinkedScope.$destroy();
                tooltipLinkedScope = null;
              }
            }

            function prepareTooltip() {
              prepPlacement();
              prepPopupDelay();
            }

            /**
             * Observe the relevant attributes.
             */
            attrs.$observe( type, function ( val ) {
              ttScope.content = val;

              if (!val && ttScope.isOpen ) {
                hide();
              }
            });

            attrs.$observe( prefix+'Title', function ( val ) {
              ttScope.title = val;
            });

            function prepPlacement() {
              var val = attrs[ prefix + 'Placement' ];
              ttScope.placement = angular.isDefined( val ) ? val : options.placement;
            }

            function prepPopupDelay() {
              var val = attrs[ prefix + 'PopupDelay' ];
              var delay = parseInt( val, 10 );
              ttScope.popupDelay = ! isNaN(delay) ? delay : options.popupDelay;
            }

            var unregisterTriggers = function () {
              element.unbind(triggers.show, showTooltipBind);
              element.unbind(triggers.hide, hideTooltipBind);
            };

            function prepTriggers() {
              var val = attrs[ prefix + 'Trigger' ];
              unregisterTriggers();

              triggers = getTriggers( val );

              if ( triggers.show === triggers.hide ) {
                element.bind( triggers.show, toggleTooltipBind );
              } else {
                element.bind( triggers.show, showTooltipBind );
                element.bind( triggers.hide, hideTooltipBind );
              }
            }
            prepTriggers();

            var animation = scope.$eval(attrs[prefix + 'Animation']);
            ttScope.animation = angular.isDefined(animation) ? !!animation : options.animation;

            var appendToBodyVal = scope.$eval(attrs[prefix + 'AppendToBody']);
            appendToBody = angular.isDefined(appendToBodyVal) ? appendToBodyVal : appendToBody;

            // if a tooltip is attached to <body> we need to remove it on
            // location change as its parent scope will probably not be destroyed
            // by the change.
            if ( appendToBody ) {
              scope.$on('$locationChangeSuccess', function closeTooltipOnLocationChangeSuccess () {
              if ( ttScope.isOpen ) {
                hide();
              }
            });
            }

            // Make sure tooltip is destroyed and removed.
            scope.$on('$destroy', function onDestroyTooltip() {
              $timeout.cancel( transitionTimeout );
              $timeout.cancel( popupTimeout );
              unregisterTriggers();
              removeTooltip();
              ttScope = null;
            });
          };
        }
      };
    };
  }];
})

.directive( 'tooltipPopup', function () {
  return {
    restrict: 'EA',
    replace: true,
    scope: { content: '@', placement: '@', animation: '&', isOpen: '&' },
    templateUrl: 'template/tooltip/tooltip-popup.html'
  };
})

.directive( 'tooltip', [ '$tooltip', function ( $tooltip ) {
  return $tooltip( 'tooltip', 'tooltip', 'mouseenter' );
}])

.directive( 'tooltipHtmlUnsafePopup', function () {
  return {
    restrict: 'EA',
    replace: true,
    scope: { content: '@', placement: '@', animation: '&', isOpen: '&' },
    templateUrl: 'template/tooltip/tooltip-html-unsafe-popup.html'
  };
})

.directive( 'tooltipHtmlUnsafe', [ '$tooltip', function ( $tooltip ) {
  return $tooltip( 'tooltipHtmlUnsafe', 'tooltip', 'mouseenter' );
}]);

/**
 * The following features are still outstanding: popup delay, animation as a
 * function, placement as a function, inside, support for more triggers than
 * just mouse enter/leave, html popovers, and selector delegatation.
 */
angular.module( 'ui.bootstrap.popover', [ 'ui.bootstrap.tooltip' ] )

.directive( 'popoverPopup', function () {
  return {
    restrict: 'EA',
    replace: true,
    scope: { title: '@', content: '@', placement: '@', animation: '&', isOpen: '&' },
    templateUrl: 'template/popover/popover.html'
  };
})

.directive( 'popover', [ '$tooltip', function ( $tooltip ) {
  return $tooltip( 'popover', 'popover', 'click' );
}]);

angular.module('ui.bootstrap.progressbar', [])

.constant('progressConfig', {
  animate: true,
  max: 100
})

.controller('ProgressController', ['$scope', '$attrs', 'progressConfig', function($scope, $attrs, progressConfig) {
    var self = this,
        animate = angular.isDefined($attrs.animate) ? $scope.$parent.$eval($attrs.animate) : progressConfig.animate;

    this.bars = [];
    $scope.max = angular.isDefined($attrs.max) ? $scope.$parent.$eval($attrs.max) : progressConfig.max;

    this.addBar = function(bar, element) {
        if ( !animate ) {
            element.css({'transition': 'none'});
        }

        this.bars.push(bar);

        bar.$watch('value', function( value ) {
            bar.percent = +(100 * value / $scope.max).toFixed(2);
        });

        bar.$on('$destroy', function() {
            element = null;
            self.removeBar(bar);
        });
    };

    this.removeBar = function(bar) {
        this.bars.splice(this.bars.indexOf(bar), 1);
    };
}])

.directive('progress', function() {
    return {
        restrict: 'EA',
        replace: true,
        transclude: true,
        controller: 'ProgressController',
        require: 'progress',
        scope: {},
        templateUrl: 'template/progressbar/progress.html'
    };
})

.directive('bar', function() {
    return {
        restrict: 'EA',
        replace: true,
        transclude: true,
        require: '^progress',
        scope: {
            value: '=',
            type: '@'
        },
        templateUrl: 'template/progressbar/bar.html',
        link: function(scope, element, attrs, progressCtrl) {
            progressCtrl.addBar(scope, element);
        }
    };
})

.directive('progressbar', function() {
    return {
        restrict: 'EA',
        replace: true,
        transclude: true,
        controller: 'ProgressController',
        scope: {
            value: '=',
            type: '@'
        },
        templateUrl: 'template/progressbar/progressbar.html',
        link: function(scope, element, attrs, progressCtrl) {
            progressCtrl.addBar(scope, angular.element(element.children()[0]));
        }
    };
});
angular.module('ui.bootstrap.rating', [])

.constant('ratingConfig', {
  max: 5,
  stateOn: null,
  stateOff: null
})

.controller('RatingController', ['$scope', '$attrs', 'ratingConfig', function($scope, $attrs, ratingConfig) {
  var ngModelCtrl  = { $setViewValue: angular.noop };

  this.init = function(ngModelCtrl_) {
    ngModelCtrl = ngModelCtrl_;
    ngModelCtrl.$render = this.render;

    this.stateOn = angular.isDefined($attrs.stateOn) ? $scope.$parent.$eval($attrs.stateOn) : ratingConfig.stateOn;
    this.stateOff = angular.isDefined($attrs.stateOff) ? $scope.$parent.$eval($attrs.stateOff) : ratingConfig.stateOff;

    var ratingStates = angular.isDefined($attrs.ratingStates) ? $scope.$parent.$eval($attrs.ratingStates) :
                        new Array( angular.isDefined($attrs.max) ? $scope.$parent.$eval($attrs.max) : ratingConfig.max );
    $scope.range = this.buildTemplateObjects(ratingStates);
  };

  this.buildTemplateObjects = function(states) {
    for (var i = 0, n = states.length; i < n; i++) {
      states[i] = angular.extend({ index: i }, { stateOn: this.stateOn, stateOff: this.stateOff }, states[i]);
    }
    return states;
  };

  $scope.rate = function(value) {
    if ( !$scope.readonly && value >= 0 && value <= $scope.range.length ) {
      ngModelCtrl.$setViewValue(value);
      ngModelCtrl.$render();
    }
  };

  $scope.enter = function(value) {
    if ( !$scope.readonly ) {
      $scope.value = value;
    }
    $scope.onHover({value: value});
  };

  $scope.reset = function() {
    $scope.value = ngModelCtrl.$viewValue;
    $scope.onLeave();
  };

  $scope.onKeydown = function(evt) {
    if (/(37|38|39|40)/.test(evt.which)) {
      evt.preventDefault();
      evt.stopPropagation();
      $scope.rate( $scope.value + (evt.which === 38 || evt.which === 39 ? 1 : -1) );
    }
  };

  this.render = function() {
    $scope.value = ngModelCtrl.$viewValue;
  };
}])

.directive('rating', function() {
  return {
    restrict: 'EA',
    require: ['rating', 'ngModel'],
    scope: {
      readonly: '=?',
      onHover: '&',
      onLeave: '&'
    },
    controller: 'RatingController',
    templateUrl: 'template/rating/rating.html',
    replace: true,
    link: function(scope, element, attrs, ctrls) {
      var ratingCtrl = ctrls[0], ngModelCtrl = ctrls[1];

      if ( ngModelCtrl ) {
        ratingCtrl.init( ngModelCtrl );
      }
    }
  };
});

/**
 * @ngdoc overview
 * @name ui.bootstrap.tabs
 *
 * @description
 * AngularJS version of the tabs directive.
 */

angular.module('ui.bootstrap.tabs', [])

.controller('TabsetController', ['$scope', function TabsetCtrl($scope) {
  var ctrl = this,
      tabs = ctrl.tabs = $scope.tabs = [];

  ctrl.select = function(selectedTab) {
    angular.forEach(tabs, function(tab) {
      if (tab.active && tab !== selectedTab) {
        tab.active = false;
        tab.onDeselect();
      }
    });
    selectedTab.active = true;
    selectedTab.onSelect();
  };

  ctrl.addTab = function addTab(tab) {
    tabs.push(tab);
    // we can't run the select function on the first tab
    // since that would select it twice
    if (tabs.length === 1) {
      tab.active = true;
    } else if (tab.active) {
      ctrl.select(tab);
    }
  };

  ctrl.removeTab = function removeTab(tab) {
    var index = tabs.indexOf(tab);
    //Select a new tab if the tab to be removed is selected and not destroyed
    if (tab.active && tabs.length > 1 && !destroyed) {
      //If this is the last tab, select the previous tab. else, the next tab.
      var newActiveIndex = index == tabs.length - 1 ? index - 1 : index + 1;
      ctrl.select(tabs[newActiveIndex]);
    }
    tabs.splice(index, 1);
  };

  var destroyed;
  $scope.$on('$destroy', function() {
    destroyed = true;
  });
}])

/**
 * @ngdoc directive
 * @name ui.bootstrap.tabs.directive:tabset
 * @restrict EA
 *
 * @description
 * Tabset is the outer container for the tabs directive
 *
 * @param {boolean=} vertical Whether or not to use vertical styling for the tabs.
 * @param {boolean=} justified Whether or not to use justified styling for the tabs.
 *
 * @example
<example module="ui.bootstrap">
  <file name="index.html">
    <tabset>
      <tab heading="Tab 1"><b>First</b> Content!</tab>
      <tab heading="Tab 2"><i>Second</i> Content!</tab>
    </tabset>
    <hr />
    <tabset vertical="true">
      <tab heading="Vertical Tab 1"><b>First</b> Vertical Content!</tab>
      <tab heading="Vertical Tab 2"><i>Second</i> Vertical Content!</tab>
    </tabset>
    <tabset justified="true">
      <tab heading="Justified Tab 1"><b>First</b> Justified Content!</tab>
      <tab heading="Justified Tab 2"><i>Second</i> Justified Content!</tab>
    </tabset>
  </file>
</example>
 */
.directive('tabset', function() {
  return {
    restrict: 'EA',
    transclude: true,
    replace: true,
    scope: {
      type: '@'
    },
    controller: 'TabsetController',
    templateUrl: 'template/tabs/tabset.html',
    link: function(scope, element, attrs) {
      scope.vertical = angular.isDefined(attrs.vertical) ? scope.$parent.$eval(attrs.vertical) : false;
      scope.justified = angular.isDefined(attrs.justified) ? scope.$parent.$eval(attrs.justified) : false;
    }
  };
})

/**
 * @ngdoc directive
 * @name ui.bootstrap.tabs.directive:tab
 * @restrict EA
 *
 * @param {string=} heading The visible heading, or title, of the tab. Set HTML headings with {@link ui.bootstrap.tabs.directive:tabHeading tabHeading}.
 * @param {string=} select An expression to evaluate when the tab is selected.
 * @param {boolean=} active A binding, telling whether or not this tab is selected.
 * @param {boolean=} disabled A binding, telling whether or not this tab is disabled.
 *
 * @description
 * Creates a tab with a heading and content. Must be placed within a {@link ui.bootstrap.tabs.directive:tabset tabset}.
 *
 * @example
<example module="ui.bootstrap">
  <file name="index.html">
    <div ng-controller="TabsDemoCtrl">
      <button class="btn btn-small" ng-click="items[0].active = true">
        Select item 1, using active binding
      </button>
      <button class="btn btn-small" ng-click="items[1].disabled = !items[1].disabled">
        Enable/disable item 2, using disabled binding
      </button>
      <br />
      <tabset>
        <tab heading="Tab 1">First Tab</tab>
        <tab select="alertMe()">
          <tab-heading><i class="icon-bell"></i> Alert me!</tab-heading>
          Second Tab, with alert callback and html heading!
        </tab>
        <tab ng-repeat="item in items"
          heading="{{item.title}}"
          disabled="item.disabled"
          active="item.active">
          {{item.content}}
        </tab>
      </tabset>
    </div>
  </file>
  <file name="script.js">
    function TabsDemoCtrl($scope) {
      $scope.items = [
        { title:"Dynamic Title 1", content:"Dynamic Item 0" },
        { title:"Dynamic Title 2", content:"Dynamic Item 1", disabled: true }
      ];

      $scope.alertMe = function() {
        setTimeout(function() {
          alert("You've selected the alert tab!");
        });
      };
    };
  </file>
</example>
 */

/**
 * @ngdoc directive
 * @name ui.bootstrap.tabs.directive:tabHeading
 * @restrict EA
 *
 * @description
 * Creates an HTML heading for a {@link ui.bootstrap.tabs.directive:tab tab}. Must be placed as a child of a tab element.
 *
 * @example
<example module="ui.bootstrap">
  <file name="index.html">
    <tabset>
      <tab>
        <tab-heading><b>HTML</b> in my titles?!</tab-heading>
        And some content, too!
      </tab>
      <tab>
        <tab-heading><i class="icon-heart"></i> Icon heading?!?</tab-heading>
        That's right.
      </tab>
    </tabset>
  </file>
</example>
 */
.directive('tab', ['$parse', function($parse) {
  return {
    require: '^tabset',
    restrict: 'EA',
    replace: true,
    templateUrl: 'template/tabs/tab.html',
    transclude: true,
    scope: {
      active: '=?',
      heading: '@',
      onSelect: '&select', //This callback is called in contentHeadingTransclude
                          //once it inserts the tab's content into the dom
      onDeselect: '&deselect'
    },
    controller: function() {
      //Empty controller so other directives can require being 'under' a tab
    },
    compile: function(elm, attrs, transclude) {
      return function postLink(scope, elm, attrs, tabsetCtrl) {
        scope.$watch('active', function(active) {
          if (active) {
            tabsetCtrl.select(scope);
          }
        });

        scope.disabled = false;
        if ( attrs.disabled ) {
          scope.$parent.$watch($parse(attrs.disabled), function(value) {
            scope.disabled = !! value;
          });
        }

        scope.select = function() {
          if ( !scope.disabled ) {
            scope.active = true;
          }
        };

        tabsetCtrl.addTab(scope);
        scope.$on('$destroy', function() {
          tabsetCtrl.removeTab(scope);
        });

        //We need to transclude later, once the content container is ready.
        //when this link happens, we're inside a tab heading.
        scope.$transcludeFn = transclude;
      };
    }
  };
}])

.directive('tabHeadingTransclude', [function() {
  return {
    restrict: 'A',
    require: '^tab',
    link: function(scope, elm, attrs, tabCtrl) {
      scope.$watch('headingElement', function updateHeadingElement(heading) {
        if (heading) {
          elm.html('');
          elm.append(heading);
        }
      });
    }
  };
}])

.directive('tabContentTransclude', function() {
  return {
    restrict: 'A',
    require: '^tabset',
    link: function(scope, elm, attrs) {
      var tab = scope.$eval(attrs.tabContentTransclude);

      //Now our tab is ready to be transcluded: both the tab heading area
      //and the tab content area are loaded.  Transclude 'em both.
      tab.$transcludeFn(tab.$parent, function(contents) {
        angular.forEach(contents, function(node) {
          if (isTabHeading(node)) {
            //Let tabHeadingTransclude know.
            tab.headingElement = node;
          } else {
            elm.append(node);
          }
        });
      });
    }
  };
  function isTabHeading(node) {
    return node.tagName &&  (
      node.hasAttribute('tab-heading') ||
      node.hasAttribute('data-tab-heading') ||
      node.tagName.toLowerCase() === 'tab-heading' ||
      node.tagName.toLowerCase() === 'data-tab-heading'
    );
  }
})

;

angular.module('ui.bootstrap.timepicker', [])

.constant('timepickerConfig', {
  hourStep: 1,
  minuteStep: 1,
  showMeridian: true,
  meridians: null,
  readonlyInput: false,
  mousewheel: true
})

.controller('TimepickerController', ['$scope', '$attrs', '$parse', '$log', '$locale', 'timepickerConfig', function($scope, $attrs, $parse, $log, $locale, timepickerConfig) {
  var selected = new Date(),
      ngModelCtrl = { $setViewValue: angular.noop }, // nullModelCtrl
      meridians = angular.isDefined($attrs.meridians) ? $scope.$parent.$eval($attrs.meridians) : timepickerConfig.meridians || $locale.DATETIME_FORMATS.AMPMS;

  this.init = function( ngModelCtrl_, inputs ) {
    ngModelCtrl = ngModelCtrl_;
    ngModelCtrl.$render = this.render;

    var hoursInputEl = inputs.eq(0),
        minutesInputEl = inputs.eq(1);

    var mousewheel = angular.isDefined($attrs.mousewheel) ? $scope.$parent.$eval($attrs.mousewheel) : timepickerConfig.mousewheel;
    if ( mousewheel ) {
      this.setupMousewheelEvents( hoursInputEl, minutesInputEl );
    }

    $scope.readonlyInput = angular.isDefined($attrs.readonlyInput) ? $scope.$parent.$eval($attrs.readonlyInput) : timepickerConfig.readonlyInput;
    this.setupInputEvents( hoursInputEl, minutesInputEl );
  };

  var hourStep = timepickerConfig.hourStep;
  if ($attrs.hourStep) {
    $scope.$parent.$watch($parse($attrs.hourStep), function(value) {
      hourStep = parseInt(value, 10);
    });
  }

  var minuteStep = timepickerConfig.minuteStep;
  if ($attrs.minuteStep) {
    $scope.$parent.$watch($parse($attrs.minuteStep), function(value) {
      minuteStep = parseInt(value, 10);
    });
  }

  // 12H / 24H mode
  $scope.showMeridian = timepickerConfig.showMeridian;
  if ($attrs.showMeridian) {
    $scope.$parent.$watch($parse($attrs.showMeridian), function(value) {
      $scope.showMeridian = !!value;

      if ( ngModelCtrl.$error.time ) {
        // Evaluate from template
        var hours = getHoursFromTemplate(), minutes = getMinutesFromTemplate();
        if (angular.isDefined( hours ) && angular.isDefined( minutes )) {
          selected.setHours( hours );
          refresh();
        }
      } else {
        updateTemplate();
      }
    });
  }

  // Get $scope.hours in 24H mode if valid
  function getHoursFromTemplate ( ) {
    var hours = parseInt( $scope.hours, 10 );
    var valid = ( $scope.showMeridian ) ? (hours > 0 && hours < 13) : (hours >= 0 && hours < 24);
    if ( !valid ) {
      return undefined;
    }

    if ( $scope.showMeridian ) {
      if ( hours === 12 ) {
        hours = 0;
      }
      if ( $scope.meridian === meridians[1] ) {
        hours = hours + 12;
      }
    }
    return hours;
  }

  function getMinutesFromTemplate() {
    var minutes = parseInt($scope.minutes, 10);
    return ( minutes >= 0 && minutes < 60 ) ? minutes : undefined;
  }

  function pad( value ) {
    return ( angular.isDefined(value) && value.toString().length < 2 ) ? '0' + value : value;
  }

  // Respond on mousewheel spin
  this.setupMousewheelEvents = function( hoursInputEl, minutesInputEl ) {
    var isScrollingUp = function(e) {
      if (e.originalEvent) {
        e = e.originalEvent;
      }
      //pick correct delta variable depending on event
      var delta = (e.wheelDelta) ? e.wheelDelta : -e.deltaY;
      return (e.detail || delta > 0);
    };

    hoursInputEl.bind('mousewheel wheel', function(e) {
      $scope.$apply( (isScrollingUp(e)) ? $scope.incrementHours() : $scope.decrementHours() );
      e.preventDefault();
    });

    minutesInputEl.bind('mousewheel wheel', function(e) {
      $scope.$apply( (isScrollingUp(e)) ? $scope.incrementMinutes() : $scope.decrementMinutes() );
      e.preventDefault();
    });

  };

  this.setupInputEvents = function( hoursInputEl, minutesInputEl ) {
    if ( $scope.readonlyInput ) {
      $scope.updateHours = angular.noop;
      $scope.updateMinutes = angular.noop;
      return;
    }

    var invalidate = function(invalidHours, invalidMinutes) {
      ngModelCtrl.$setViewValue( null );
      ngModelCtrl.$setValidity('time', false);
      if (angular.isDefined(invalidHours)) {
        $scope.invalidHours = invalidHours;
      }
      if (angular.isDefined(invalidMinutes)) {
        $scope.invalidMinutes = invalidMinutes;
      }
    };

    $scope.updateHours = function() {
      var hours = getHoursFromTemplate();

      if ( angular.isDefined(hours) ) {
        selected.setHours( hours );
        refresh( 'h' );
      } else {
        invalidate(true);
      }
    };

    hoursInputEl.bind('blur', function(e) {
      if ( !$scope.invalidHours && $scope.hours < 10) {
        $scope.$apply( function() {
          $scope.hours = pad( $scope.hours );
        });
      }
    });

    $scope.updateMinutes = function() {
      var minutes = getMinutesFromTemplate();

      if ( angular.isDefined(minutes) ) {
        selected.setMinutes( minutes );
        refresh( 'm' );
      } else {
        invalidate(undefined, true);
      }
    };

    minutesInputEl.bind('blur', function(e) {
      if ( !$scope.invalidMinutes && $scope.minutes < 10 ) {
        $scope.$apply( function() {
          $scope.minutes = pad( $scope.minutes );
        });
      }
    });

  };

  this.render = function() {
    var date = ngModelCtrl.$modelValue ? new Date( ngModelCtrl.$modelValue ) : null;

    if ( isNaN(date) ) {
      ngModelCtrl.$setValidity('time', false);
      $log.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.');
    } else {
      if ( date ) {
        selected = date;
      }
      makeValid();
      updateTemplate();
    }
  };

  // Call internally when we know that model is valid.
  function refresh( keyboardChange ) {
    makeValid();
    ngModelCtrl.$setViewValue( new Date(selected) );
    updateTemplate( keyboardChange );
  }

  function makeValid() {
    ngModelCtrl.$setValidity('time', true);
    $scope.invalidHours = false;
    $scope.invalidMinutes = false;
  }

  function updateTemplate( keyboardChange ) {
    var hours = selected.getHours(), minutes = selected.getMinutes();

    if ( $scope.showMeridian ) {
      hours = ( hours === 0 || hours === 12 ) ? 12 : hours % 12; // Convert 24 to 12 hour system
    }

    $scope.hours = keyboardChange === 'h' ? hours : pad(hours);
    $scope.minutes = keyboardChange === 'm' ? minutes : pad(minutes);
    $scope.meridian = selected.getHours() < 12 ? meridians[0] : meridians[1];
  }

  function addMinutes( minutes ) {
    var dt = new Date( selected.getTime() + minutes * 60000 );
    selected.setHours( dt.getHours(), dt.getMinutes() );
    refresh();
  }

  $scope.incrementHours = function() {
    addMinutes( hourStep * 60 );
  };
  $scope.decrementHours = function() {
    addMinutes( - hourStep * 60 );
  };
  $scope.incrementMinutes = function() {
    addMinutes( minuteStep );
  };
  $scope.decrementMinutes = function() {
    addMinutes( - minuteStep );
  };
  $scope.toggleMeridian = function() {
    addMinutes( 12 * 60 * (( selected.getHours() < 12 ) ? 1 : -1) );
  };
}])

.directive('timepicker', function () {
  return {
    restrict: 'EA',
    require: ['timepicker', '?^ngModel'],
    controller:'TimepickerController',
    replace: true,
    scope: {},
    templateUrl: 'template/timepicker/timepicker.html',
    link: function(scope, element, attrs, ctrls) {
      var timepickerCtrl = ctrls[0], ngModelCtrl = ctrls[1];

      if ( ngModelCtrl ) {
        timepickerCtrl.init( ngModelCtrl, element.find('input') );
      }
    }
  };
});

angular.module('ui.bootstrap.typeahead', ['ui.bootstrap.position', 'ui.bootstrap.bindHtml'])

/**
 * A helper service that can parse typeahead's syntax (string provided by users)
 * Extracted to a separate service for ease of unit testing
 */
  .factory('typeaheadParser', ['$parse', function ($parse) {

  //                      00000111000000000000022200000000000000003333333333333330000000000044000
  var TYPEAHEAD_REGEXP = /^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;

  return {
    parse:function (input) {

      var match = input.match(TYPEAHEAD_REGEXP);
      if (!match) {
        throw new Error(
          'Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_"' +
            ' but got "' + input + '".');
      }

      return {
        itemName:match[3],
        source:$parse(match[4]),
        viewMapper:$parse(match[2] || match[1]),
        modelMapper:$parse(match[1])
      };
    }
  };
}])

  .directive('typeahead', ['$compile', '$parse', '$q', '$timeout', '$document', '$position', 'typeaheadParser',
    function ($compile, $parse, $q, $timeout, $document, $position, typeaheadParser) {

  var HOT_KEYS = [9, 13, 27, 38, 40];

  return {
    require:'ngModel',
    link:function (originalScope, element, attrs, modelCtrl) {

      //SUPPORTED ATTRIBUTES (OPTIONS)

      //minimal no of characters that needs to be entered before typeahead kicks-in
      var minSearch = originalScope.$eval(attrs.typeaheadMinLength) || 1;

      //minimal wait time after last character typed before typehead kicks-in
      var waitTime = originalScope.$eval(attrs.typeaheadWaitMs) || 0;

      //should it restrict model values to the ones selected from the popup only?
      var isEditable = originalScope.$eval(attrs.typeaheadEditable) !== false;

      //binding to a variable that indicates if matches are being retrieved asynchronously
      var isLoadingSetter = $parse(attrs.typeaheadLoading).assign || angular.noop;

      //a callback executed when a match is selected
      var onSelectCallback = $parse(attrs.typeaheadOnSelect);

      var inputFormatter = attrs.typeaheadInputFormatter ? $parse(attrs.typeaheadInputFormatter) : undefined;

      var appendToBody =  attrs.typeaheadAppendToBody ? originalScope.$eval(attrs.typeaheadAppendToBody) : false;

      var focusFirst = originalScope.$eval(attrs.typeaheadFocusFirst) !== false;

      //INTERNAL VARIABLES

      //model setter executed upon match selection
      var $setModelValue = $parse(attrs.ngModel).assign;

      //expressions used by typeahead
      var parserResult = typeaheadParser.parse(attrs.typeahead);

      var hasFocus;

      //create a child scope for the typeahead directive so we are not polluting original scope
      //with typeahead-specific data (matches, query etc.)
      var scope = originalScope.$new();
      originalScope.$on('$destroy', function(){
        scope.$destroy();
      });

      // WAI-ARIA
      var popupId = 'typeahead-' + scope.$id + '-' + Math.floor(Math.random() * 10000);
      element.attr({
        'aria-autocomplete': 'list',
        'aria-expanded': false,
        'aria-owns': popupId
      });

      //pop-up element used to display matches
      var popUpEl = angular.element('<div typeahead-popup></div>');
      popUpEl.attr({
        id: popupId,
        matches: 'matches',
        active: 'activeIdx',
        select: 'select(activeIdx)',
        query: 'query',
        position: 'position'
      });
      //custom item template
      if (angular.isDefined(attrs.typeaheadTemplateUrl)) {
        popUpEl.attr('template-url', attrs.typeaheadTemplateUrl);
      }

      var resetMatches = function() {
        scope.matches = [];
        scope.activeIdx = -1;
        element.attr('aria-expanded', false);
      };

      var getMatchId = function(index) {
        return popupId + '-option-' + index;
      };

      // Indicate that the specified match is the active (pre-selected) item in the list owned by this typeahead.
      // This attribute is added or removed automatically when the `activeIdx` changes.
      scope.$watch('activeIdx', function(index) {
        if (index < 0) {
          element.removeAttr('aria-activedescendant');
        } else {
          element.attr('aria-activedescendant', getMatchId(index));
        }
      });

      var getMatchesAsync = function(inputValue) {

        var locals = {$viewValue: inputValue};
        isLoadingSetter(originalScope, true);
        $q.when(parserResult.source(originalScope, locals)).then(function(matches) {

          //it might happen that several async queries were in progress if a user were typing fast
          //but we are interested only in responses that correspond to the current view value
          var onCurrentRequest = (inputValue === modelCtrl.$viewValue);
          if (onCurrentRequest && hasFocus) {
            if (matches.length > 0) {

              scope.activeIdx = focusFirst ? 0 : -1;
              scope.matches.length = 0;

              //transform labels
              for(var i=0; i<matches.length; i++) {
                locals[parserResult.itemName] = matches[i];
                scope.matches.push({
                  id: getMatchId(i),
                  label: parserResult.viewMapper(scope, locals),
                  model: matches[i]
                });
              }

              scope.query = inputValue;
              //position pop-up with matches - we need to re-calculate its position each time we are opening a window
              //with matches as a pop-up might be absolute-positioned and position of an input might have changed on a page
              //due to other elements being rendered
              scope.position = appendToBody ? $position.offset(element) : $position.position(element);
              scope.position.top = scope.position.top + element.prop('offsetHeight');

              element.attr('aria-expanded', true);
            } else {
              resetMatches();
            }
          }
          if (onCurrentRequest) {
            isLoadingSetter(originalScope, false);
          }
        }, function(){
          resetMatches();
          isLoadingSetter(originalScope, false);
        });
      };

      resetMatches();

      //we need to propagate user's query so we can higlight matches
      scope.query = undefined;

      //Declare the timeout promise var outside the function scope so that stacked calls can be cancelled later 
      var timeoutPromise;

      var scheduleSearchWithTimeout = function(inputValue) {
        timeoutPromise = $timeout(function () {
          getMatchesAsync(inputValue);
        }, waitTime);
      };

      var cancelPreviousTimeout = function() {
        if (timeoutPromise) {
          $timeout.cancel(timeoutPromise);
        }
      };

      //plug into $parsers pipeline to open a typeahead on view changes initiated from DOM
      //$parsers kick-in on all the changes coming from the view as well as manually triggered by $setViewValue
      modelCtrl.$parsers.unshift(function (inputValue) {

        hasFocus = true;

        if (inputValue && inputValue.length >= minSearch) {
          if (waitTime > 0) {
            cancelPreviousTimeout();
            scheduleSearchWithTimeout(inputValue);
          } else {
            getMatchesAsync(inputValue);
          }
        } else {
          isLoadingSetter(originalScope, false);
          cancelPreviousTimeout();
          resetMatches();
        }

        if (isEditable) {
          return inputValue;
        } else {
          if (!inputValue) {
            // Reset in case user had typed something previously.
            modelCtrl.$setValidity('editable', true);
            return inputValue;
          } else {
            modelCtrl.$setValidity('editable', false);
            return undefined;
          }
        }
      });

      modelCtrl.$formatters.push(function (modelValue) {

        var candidateViewValue, emptyViewValue;
        var locals = {};

        if (inputFormatter) {

          locals.$model = modelValue;
          return inputFormatter(originalScope, locals);

        } else {

          //it might happen that we don't have enough info to properly render input value
          //we need to check for this situation and simply return model value if we can't apply custom formatting
          locals[parserResult.itemName] = modelValue;
          candidateViewValue = parserResult.viewMapper(originalScope, locals);
          locals[parserResult.itemName] = undefined;
          emptyViewValue = parserResult.viewMapper(originalScope, locals);

          return candidateViewValue!== emptyViewValue ? candidateViewValue : modelValue;
        }
      });

      scope.select = function (activeIdx) {
        //called from within the $digest() cycle
        var locals = {};
        var model, item;

        locals[parserResult.itemName] = item = scope.matches[activeIdx].model;
        model = parserResult.modelMapper(originalScope, locals);
        $setModelValue(originalScope, model);
        modelCtrl.$setValidity('editable', true);

        onSelectCallback(originalScope, {
          $item: item,
          $model: model,
          $label: parserResult.viewMapper(originalScope, locals)
        });

        resetMatches();

        //return focus to the input element if a match was selected via a mouse click event
        // use timeout to avoid $rootScope:inprog error
        $timeout(function() { element[0].focus(); }, 0, false);
      };

      //bind keyboard events: arrows up(38) / down(40), enter(13) and tab(9), esc(27)
      element.bind('keydown', function (evt) {

        //typeahead is open and an "interesting" key was pressed
        if (scope.matches.length === 0 || HOT_KEYS.indexOf(evt.which) === -1) {
          return;
        }

        // if there's nothing selected (i.e. focusFirst) and enter is hit, don't do anything
        if (scope.activeIdx == -1 && (evt.which === 13 || evt.which === 9)) {
          return;
        }

        evt.preventDefault();

        if (evt.which === 40) {
          scope.activeIdx = (scope.activeIdx + 1) % scope.matches.length;
          scope.$digest();

        } else if (evt.which === 38) {
          scope.activeIdx = (scope.activeIdx > 0 ? scope.activeIdx : scope.matches.length) - 1;
          scope.$digest();

        } else if (evt.which === 13 || evt.which === 9) {
          scope.$apply(function () {
            scope.select(scope.activeIdx);
          });

        } else if (evt.which === 27) {
          evt.stopPropagation();

          resetMatches();
          scope.$digest();
        }
      });

      element.bind('blur', function (evt) {
        hasFocus = false;
      });

      // Keep reference to click handler to unbind it.
      var dismissClickHandler = function (evt) {
        if (element[0] !== evt.target) {
          resetMatches();
          scope.$digest();
        }
      };

      $document.bind('click', dismissClickHandler);

      originalScope.$on('$destroy', function(){
        $document.unbind('click', dismissClickHandler);
        if (appendToBody) {
          $popup.remove();
        }
      });

      var $popup = $compile(popUpEl)(scope);
      if (appendToBody) {
        $document.find('body').append($popup);
      } else {
        element.after($popup);
      }
    }
  };

}])

  .directive('typeaheadPopup', function () {
    return {
      restrict:'EA',
      scope:{
        matches:'=',
        query:'=',
        active:'=',
        position:'=',
        select:'&'
      },
      replace:true,
      templateUrl:'template/typeahead/typeahead-popup.html',
      link:function (scope, element, attrs) {

        scope.templateUrl = attrs.templateUrl;

        scope.isOpen = function () {
          return scope.matches.length > 0;
        };

        scope.isActive = function (matchIdx) {
          return scope.active == matchIdx;
        };

        scope.selectActive = function (matchIdx) {
          scope.active = matchIdx;
        };

        scope.selectMatch = function (activeIdx) {
          scope.select({activeIdx:activeIdx});
        };
      }
    };
  })

  .directive('typeaheadMatch', ['$http', '$templateCache', '$compile', '$parse', function ($http, $templateCache, $compile, $parse) {
    return {
      restrict:'EA',
      scope:{
        index:'=',
        match:'=',
        query:'='
      },
      link:function (scope, element, attrs) {
        var tplUrl = $parse(attrs.templateUrl)(scope.$parent) || 'template/typeahead/typeahead-match.html';
        $http.get(tplUrl, {cache: $templateCache}).success(function(tplContent){
           element.replaceWith($compile(tplContent.trim())(scope));
        });
      }
    };
  }])

  .filter('typeaheadHighlight', function() {

    function escapeRegexp(queryToEscape) {
      return queryToEscape.replace(/([.?*+^$[\]\\(){}|-])/g, '\\$1');
    }

    return function(matchItem, query) {
      return query ? ('' + matchItem).replace(new RegExp(escapeRegexp(query), 'gi'), '<strong>$&</strong>') : matchItem;
    };
  });

angular.module("template/accordion/accordion-group.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/accordion/accordion-group.html",
    "<div class=\"panel panel-default\">\n" +
    "  <div class=\"panel-heading\">\n" +
    "    <h4 class=\"panel-title\">\n" +
    "      <a href class=\"accordion-toggle\" ng-click=\"toggleOpen()\" accordion-transclude=\"heading\"><span ng-class=\"{'text-muted': isDisabled}\">{{heading}}</span></a>\n" +
    "    </h4>\n" +
    "  </div>\n" +
    "  <div class=\"panel-collapse\" collapse=\"!isOpen\">\n" +
    "     <div class=\"panel-body\" ng-transclude></div>\n" +
    "  </div>\n" +
    "</div>\n" +
    "");
}]);

angular.module("template/accordion/accordion.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/accordion/accordion.html",
    "<div class=\"panel-group\" ng-transclude></div>");
}]);

angular.module("template/alert/alert.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/alert/alert.html",
    "<div class=\"alert\" ng-class=\"['alert-' + (type || 'warning'), closeable ? 'alert-dismissable' : null]\" role=\"alert\">\n" +
    "    <button ng-show=\"closeable\" type=\"button\" class=\"close\" ng-click=\"close()\">\n" +
    "        <span aria-hidden=\"true\">&times;</span>\n" +
    "        <span class=\"sr-only\">Close</span>\n" +
    "    </button>\n" +
    "    <div ng-transclude></div>\n" +
    "</div>\n" +
    "");
}]);

angular.module("template/carousel/carousel.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/carousel/carousel.html",
    "<div ng-mouseenter=\"pause()\" ng-mouseleave=\"play()\" class=\"carousel\" ng-swipe-right=\"prev()\" ng-swipe-left=\"next()\">\n" +
    "    <ol class=\"carousel-indicators\" ng-show=\"slides.length > 1\">\n" +
    "        <li ng-repeat=\"slide in slides track by $index\" ng-class=\"{active: isActive(slide)}\" ng-click=\"select(slide)\"></li>\n" +
    "    </ol>\n" +
    "    <div class=\"carousel-inner\" ng-transclude></div>\n" +
    "    <a class=\"left carousel-control\" ng-click=\"prev()\" ng-show=\"slides.length > 1\"><span class=\"icon-chevron-left\"></span></a>\n" +
    "    <a class=\"right carousel-control\" ng-click=\"next()\" ng-show=\"slides.length > 1\"><span class=\"icon-chevron-right\"></span></a>\n" +
    "</div>\n" +
    "");
}]);

angular.module("template/carousel/slide.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/carousel/slide.html",
    "<div ng-class=\"{\n" +
    "    'active': leaving || (active && !entering),\n" +
    "    'prev': (next || active) && direction=='prev',\n" +
    "    'next': (next || active) && direction=='next',\n" +
    "    'right': direction=='prev',\n" +
    "    'left': direction=='next'\n" +
    "  }\" class=\"item text-center\" ng-transclude></div>\n" +
    "");
}]);

angular.module("template/datepicker/datepicker.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/datepicker/datepicker.html",
    "<div ng-switch=\"datepickerMode\" role=\"application\" ng-keydown=\"keydown($event)\">\n" +
    "  <daypicker ng-switch-when=\"day\" tabindex=\"0\"></daypicker>\n" +
    "  <monthpicker ng-switch-when=\"month\" tabindex=\"0\"></monthpicker>\n" +
    "  <yearpicker ng-switch-when=\"year\" tabindex=\"0\"></yearpicker>\n" +
    "</div>");
}]);

angular.module("template/datepicker/day.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/datepicker/day.html",
    "<table role=\"grid\" aria-labelledby=\"{{uniqueId}}-title\" aria-activedescendant=\"{{activeDateId}}\">\n" +
    "  <thead>\n" +
    "    <tr>\n" +
    "      <th><button type=\"button\" class=\"btn btn-default btn-sm pull-left\" ng-click=\"move(-1)\" tabindex=\"-1\"><i class=\"icon-chevron-left\"></i></button></th>\n" +
    "      <th colspan=\"{{5 + showWeeks}}\"><button id=\"{{uniqueId}}-title\" role=\"heading\" aria-live=\"assertive\" aria-atomic=\"true\" type=\"button\" class=\"btn btn-default btn-sm\" ng-click=\"toggleMode()\" tabindex=\"-1\" style=\"width:100%;\"><strong>{{title}}</strong></button></th>\n" +
    "      <th><button type=\"button\" class=\"btn btn-default btn-sm pull-right\" ng-click=\"move(1)\" tabindex=\"-1\"><i class=\"icon-chevron-right\"></i></button></th>\n" +
    "    </tr>\n" +
    "    <tr>\n" +
    "      <th ng-show=\"showWeeks\" class=\"text-center\"></th>\n" +
    "      <th ng-repeat=\"label in labels track by $index\" class=\"text-center\"><small aria-label=\"{{label.full}}\">{{label.abbr}}</small></th>\n" +
    "    </tr>\n" +
    "  </thead>\n" +
    "  <tbody>\n" +
    "    <tr ng-repeat=\"row in rows track by $index\">\n" +
    "      <td ng-show=\"showWeeks\" class=\"text-center h6\"><em>{{ weekNumbers[$index] }}</em></td>\n" +
    "      <td ng-repeat=\"dt in row track by dt.date\" class=\"text-center\" role=\"gridcell\" id=\"{{dt.uid}}\" aria-disabled=\"{{!!dt.disabled}}\">\n" +
    "        <button type=\"button\" style=\"width:100%;\" class=\"btn btn-default btn-sm\" ng-class=\"{'btn-info': dt.selected, active: isActive(dt)}\" ng-click=\"select(dt.date)\" ng-disabled=\"dt.disabled\" tabindex=\"-1\"><span ng-class=\"{'text-muted': dt.secondary, 'text-info': dt.current}\">{{dt.label}}</span></button>\n" +
    "      </td>\n" +
    "    </tr>\n" +
    "  </tbody>\n" +
    "</table>\n" +
    "");
}]);

angular.module("template/datepicker/month.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/datepicker/month.html",
    "<table role=\"grid\" aria-labelledby=\"{{uniqueId}}-title\" aria-activedescendant=\"{{activeDateId}}\">\n" +
    "  <thead>\n" +
    "    <tr>\n" +
    "      <th><button type=\"button\" class=\"btn btn-default btn-sm pull-left\" ng-click=\"move(-1)\" tabindex=\"-1\"><i class=\"icon-chevron-left\"></i></button></th>\n" +
    "      <th><button id=\"{{uniqueId}}-title\" role=\"heading\" aria-live=\"assertive\" aria-atomic=\"true\" type=\"button\" class=\"btn btn-default btn-sm\" ng-click=\"toggleMode()\" tabindex=\"-1\" style=\"width:100%;\"><strong>{{title}}</strong></button></th>\n" +
    "      <th><button type=\"button\" class=\"btn btn-default btn-sm pull-right\" ng-click=\"move(1)\" tabindex=\"-1\"><i class=\"icon-chevron-right\"></i></button></th>\n" +
    "    </tr>\n" +
    "  </thead>\n" +
    "  <tbody>\n" +
    "    <tr ng-repeat=\"row in rows track by $index\">\n" +
    "      <td ng-repeat=\"dt in row track by dt.date\" class=\"text-center\" role=\"gridcell\" id=\"{{dt.uid}}\" aria-disabled=\"{{!!dt.disabled}}\">\n" +
    "        <button type=\"button\" style=\"width:100%;\" class=\"btn btn-default\" ng-class=\"{'btn-info': dt.selected, active: isActive(dt)}\" ng-click=\"select(dt.date)\" ng-disabled=\"dt.disabled\" tabindex=\"-1\"><span ng-class=\"{'text-info': dt.current}\">{{dt.label}}</span></button>\n" +
    "      </td>\n" +
    "    </tr>\n" +
    "  </tbody>\n" +
    "</table>\n" +
    "");
}]);

angular.module("template/datepicker/popup.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/datepicker/popup.html",
    "<ul class=\"dropdown-menu\" ng-style=\"{display: (isOpen && 'block') || 'none', top: position.top+'px', left: position.left+'px'}\" ng-keydown=\"keydown($event)\">\n" +
    "   <li ng-transclude></li>\n" +
    "   <li ng-if=\"showButtonBar\" style=\"padding:10px 9px 2px\">\n" +
    "       <span class=\"btn-group pull-left\">\n" +
    "           <button type=\"button\" class=\"btn btn-sm btn-info\" ng-click=\"select('today')\">{{ getText('current') }}</button>\n" +
    "           <button type=\"button\" class=\"btn btn-sm btn-danger\" ng-click=\"select(null)\">{{ getText('clear') }}</button>\n" +
    "       </span>\n" +
    "       <button type=\"button\" class=\"btn btn-sm btn-success pull-right\" ng-click=\"close()\">{{ getText('close') }}</button>\n" +
    "   </li>\n" +
    "</ul>\n" +
    "");
}]);

angular.module("template/datepicker/year.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/datepicker/year.html",
    "<table role=\"grid\" aria-labelledby=\"{{uniqueId}}-title\" aria-activedescendant=\"{{activeDateId}}\">\n" +
    "  <thead>\n" +
    "    <tr>\n" +
    "      <th><button type=\"button\" class=\"btn btn-default btn-sm pull-left\" ng-click=\"move(-1)\" tabindex=\"-1\"><i class=\"glyphicon glyphicon-chevron-left\"></i></button></th>\n" +
    "      <th colspan=\"3\"><button id=\"{{uniqueId}}-title\" role=\"heading\" aria-live=\"assertive\" aria-atomic=\"true\" type=\"button\" class=\"btn btn-default btn-sm\" ng-click=\"toggleMode()\" tabindex=\"-1\" style=\"width:100%;\"><strong>{{title}}</strong></button></th>\n" +
    "      <th><button type=\"button\" class=\"btn btn-default btn-sm pull-right\" ng-click=\"move(1)\" tabindex=\"-1\"><i class=\"glyphicon glyphicon-chevron-right\"></i></button></th>\n" +
    "    </tr>\n" +
    "  </thead>\n" +
    "  <tbody>\n" +
    "    <tr ng-repeat=\"row in rows track by $index\">\n" +
    "      <td ng-repeat=\"dt in row track by dt.date\" class=\"text-center\" role=\"gridcell\" id=\"{{dt.uid}}\" aria-disabled=\"{{!!dt.disabled}}\">\n" +
    "        <button type=\"button\" style=\"width:100%;\" class=\"btn btn-default\" ng-class=\"{'btn-info': dt.selected, active: isActive(dt)}\" ng-click=\"select(dt.date)\" ng-disabled=\"dt.disabled\" tabindex=\"-1\"><span ng-class=\"{'text-info': dt.current}\">{{dt.label}}</span></button>\n" +
    "      </td>\n" +
    "    </tr>\n" +
    "  </tbody>\n" +
    "</table>\n" +
    "");
}]);

angular.module("template/modal/backdrop.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/modal/backdrop.html",
    "<div class=\"modal-backdrop fade {{ backdropClass }}\"\n" +
    "     ng-class=\"{in: animate}\"\n" +
    "     ng-style=\"{'z-index': 1040 + (index && 1 || 0) + index*10}\"\n" +
    "></div>\n" +
    "");
}]);

angular.module("template/modal/window.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/modal/window.html",
    "<div tabindex=\"-1\" role=\"dialog\" class=\"modal fade\" ng-class=\"{in: animate}\" ng-style=\"{'z-index': 1050 + index*10, display: 'block'}\" ng-click=\"close($event)\">\n" +
    "    <div class=\"modal-dialog\" ng-class=\"{'modal-sm': size == 'sm', 'modal-lg': size == 'lg'}\"><div class=\"modal-content\" modal-transclude></div></div>\n" +
    "</div>");
}]);

angular.module("template/pagination/pager.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/pagination/pager.html",
    "<ul class=\"pager\">\n" +
    "  <li ng-class=\"{disabled: noPrevious(), previous: align}\"><a href ng-click=\"selectPage(page - 1)\">{{getText('previous')}}</a></li>\n" +
    "  <li ng-class=\"{disabled: noNext(), next: align}\"><a href ng-click=\"selectPage(page + 1)\">{{getText('next')}}</a></li>\n" +
    "</ul>");
}]);

angular.module("template/pagination/pagination.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/pagination/pagination.html",
    "<ul class=\"pagination\">\n" +
    "  <li ng-if=\"boundaryLinks\" ng-class=\"{disabled: noPrevious()}\"><a href ng-click=\"selectPage(1)\">{{getText('first')}}</a></li>\n" +
    "  <li ng-if=\"directionLinks\" ng-class=\"{disabled: noPrevious()}\"><a href ng-click=\"selectPage(page - 1)\">{{getText('previous')}}</a></li>\n" +
    "  <li ng-repeat=\"page in pages track by $index\" ng-class=\"{active: page.active}\"><a href ng-click=\"selectPage(page.number)\">{{page.text}}</a></li>\n" +
    "  <li ng-if=\"directionLinks\" ng-class=\"{disabled: noNext()}\"><a href ng-click=\"selectPage(page + 1)\">{{getText('next')}}</a></li>\n" +
    "  <li ng-if=\"boundaryLinks\" ng-class=\"{disabled: noNext()}\"><a href ng-click=\"selectPage(totalPages)\">{{getText('last')}}</a></li>\n" +
    "</ul>");
}]);

angular.module("template/tooltip/tooltip-html-unsafe-popup.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/tooltip/tooltip-html-unsafe-popup.html",
    "<div class=\"tooltip {{placement}}\" ng-class=\"{ in: isOpen(), fade: animation() }\">\n" +
    "  <div class=\"tooltip-arrow\"></div>\n" +
    "  <div class=\"tooltip-inner\" bind-html-unsafe=\"content\"></div>\n" +
    "</div>\n" +
    "");
}]);

angular.module("template/tooltip/tooltip-popup.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/tooltip/tooltip-popup.html",
    "<div class=\"tooltip {{placement}}\" ng-class=\"{ in: isOpen(), fade: animation() }\">\n" +
    "  <div class=\"tooltip-arrow\"></div>\n" +
    "  <div class=\"tooltip-inner\" ng-bind=\"content\"></div>\n" +
    "</div>\n" +
    "");
}]);

angular.module("template/popover/popover.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/popover/popover.html",
    "<div class=\"popover {{placement}}\" ng-class=\"{ in: isOpen(), fade: animation() }\">\n" +
    "  <div class=\"arrow\"></div>\n" +
    "\n" +
    "  <div class=\"popover-inner\">\n" +
    "      <h3 class=\"popover-title\" ng-bind=\"title\" ng-show=\"title\"></h3>\n" +
    "      <div class=\"popover-content\" ng-bind=\"content\"></div>\n" +
    "  </div>\n" +
    "</div>\n" +
    "");
}]);

angular.module("template/progressbar/bar.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/progressbar/bar.html",
    "<div class=\"progress-bar\" ng-class=\"type && 'progress-bar-' + type\" role=\"progressbar\" aria-valuenow=\"{{value}}\" aria-valuemin=\"0\" aria-valuemax=\"{{max}}\" ng-style=\"{width: percent + '%'}\" aria-valuetext=\"{{percent | number:0}}%\" ng-transclude></div>");
}]);

angular.module("template/progressbar/progress.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/progressbar/progress.html",
    "<div class=\"progress\" ng-transclude></div>");
}]);

angular.module("template/progressbar/progressbar.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/progressbar/progressbar.html",
    "<div class=\"progress\">\n" +
    "  <div class=\"progress-bar\" ng-class=\"type && 'progress-bar-' + type\" role=\"progressbar\" aria-valuenow=\"{{value}}\" aria-valuemin=\"0\" aria-valuemax=\"{{max}}\" ng-style=\"{width: percent + '%'}\" aria-valuetext=\"{{percent | number:0}}%\" ng-transclude></div>\n" +
    "</div>");
}]);

angular.module("template/rating/rating.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/rating/rating.html",
    "<span ng-mouseleave=\"reset()\" ng-keydown=\"onKeydown($event)\" tabindex=\"0\" role=\"slider\" aria-valuemin=\"0\" aria-valuemax=\"{{range.length}}\" aria-valuenow=\"{{value}}\">\n" +
    "    <i ng-repeat=\"r in range track by $index\" ng-mouseenter=\"enter($index + 1)\" ng-click=\"rate($index + 1)\" class=\"glyphicon\" ng-class=\"$index < value && (r.stateOn || 'glyphicon-star') || (r.stateOff || 'glyphicon-star-empty')\">\n" +
    "        <span class=\"sr-only\">({{ $index < value ? '*' : ' ' }})</span>\n" +
    "    </i>\n" +
    "</span>");
}]);

angular.module("template/tabs/tab.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/tabs/tab.html",
    "<li ng-class=\"{active: active, disabled: disabled}\">\n" +
    "  <a href ng-click=\"select()\" tab-heading-transclude>{{heading}}</a>\n" +
    "</li>\n" +
    "");
}]);

angular.module("template/tabs/tabset.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/tabs/tabset.html",
    "<div>\n" +
    "  <ul class=\"nav nav-{{type || 'tabs'}}\" ng-class=\"{'nav-stacked': vertical, 'nav-justified': justified}\" ng-transclude></ul>\n" +
    "  <div class=\"tab-content\">\n" +
    "    <div class=\"tab-pane\" \n" +
    "         ng-repeat=\"tab in tabs\" \n" +
    "         ng-class=\"{active: tab.active}\"\n" +
    "         tab-content-transclude=\"tab\">\n" +
    "    </div>\n" +
    "  </div>\n" +
    "</div>\n" +
    "");
}]);

angular.module("template/timepicker/timepicker.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/timepicker/timepicker.html",
    "<table>\n" +
    "   <tbody>\n" +
    "       <tr class=\"text-center\">\n" +
    "           <td><a ng-click=\"incrementHours()\" class=\"btn btn-link\"><span class=\"glyphicon glyphicon-chevron-up\"></span></a></td>\n" +
    "           <td>&nbsp;</td>\n" +
    "           <td><a ng-click=\"incrementMinutes()\" class=\"btn btn-link\"><span class=\"glyphicon glyphicon-chevron-up\"></span></a></td>\n" +
    "           <td ng-show=\"showMeridian\"></td>\n" +
    "       </tr>\n" +
    "       <tr>\n" +
    "           <td style=\"width:50px;\" class=\"form-group\" ng-class=\"{'has-error': invalidHours}\">\n" +
    "               <input type=\"text\" ng-model=\"hours\" ng-change=\"updateHours()\" class=\"form-control text-center\" ng-mousewheel=\"incrementHours()\" ng-readonly=\"readonlyInput\" maxlength=\"2\">\n" +
    "           </td>\n" +
    "           <td>:</td>\n" +
    "           <td style=\"width:50px;\" class=\"form-group\" ng-class=\"{'has-error': invalidMinutes}\">\n" +
    "               <input type=\"text\" ng-model=\"minutes\" ng-change=\"updateMinutes()\" class=\"form-control text-center\" ng-readonly=\"readonlyInput\" maxlength=\"2\">\n" +
    "           </td>\n" +
    "           <td ng-show=\"showMeridian\"><button type=\"button\" class=\"btn btn-default text-center\" ng-click=\"toggleMeridian()\">{{meridian}}</button></td>\n" +
    "       </tr>\n" +
    "       <tr class=\"text-center\">\n" +
    "           <td><a ng-click=\"decrementHours()\" class=\"btn btn-link\"><span class=\"glyphicon glyphicon-chevron-down\"></span></a></td>\n" +
    "           <td>&nbsp;</td>\n" +
    "           <td><a ng-click=\"decrementMinutes()\" class=\"btn btn-link\"><span class=\"glyphicon glyphicon-chevron-down\"></span></a></td>\n" +
    "           <td ng-show=\"showMeridian\"></td>\n" +
    "       </tr>\n" +
    "   </tbody>\n" +
    "</table>\n" +
    "");
}]);

angular.module("template/typeahead/typeahead-match.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/typeahead/typeahead-match.html",
    "<a tabindex=\"-1\" bind-html-unsafe=\"match.label | typeaheadHighlight:query\"></a>");
}]);

angular.module("template/typeahead/typeahead-popup.html", []).run(["$templateCache", function($templateCache) {
  $templateCache.put("template/typeahead/typeahead-popup.html",
    "<ul class=\"dropdown-menu\" ng-show=\"isOpen()\" ng-style=\"{top: position.top+'px', left: position.left+'px'}\" style=\"display: block;\" role=\"listbox\" aria-hidden=\"{{!isOpen()}}\">\n" +
    "    <li ng-repeat=\"match in matches track by $index\" ng-class=\"{active: isActive($index) }\" ng-mouseenter=\"selectActive($index)\" ng-click=\"selectMatch($index)\" role=\"option\" id=\"{{match.id}}\">\n" +
    "        <div typeahead-match index=\"$index\" match=\"match\" query=\"query\" template-url=\"templateUrl\"></div>\n" +
    "    </li>\n" +
    "</ul>\n" +
    "");
}]);

d3=function(){function n(n){return null!=n&&!isNaN(n)}function t(n){return n.length}function e(n){for(var t=1;n*t%1;)t*=10;return t}function r(n,t){try{for(var e in t)Object.defineProperty(n.prototype,e,{value:t[e],enumerable:!1})}catch(r){n.prototype=t}}function u(){}function i(){}function o(n,t,e){return function(){var r=e.apply(t,arguments);return r===t?n:r}}function a(n,t){if(t in n)return t;t=t.charAt(0).toUpperCase()+t.substring(1);for(var e=0,r=aa.length;r>e;++e){var u=aa[e]+t;if(u in n)return u}}function c(){}function s(){}function l(n){function t(){for(var t,r=e,u=-1,i=r.length;++u<i;)(t=r[u].on)&&t.apply(this,arguments);return n}var e=[],r=new u;return t.on=function(t,u){var i,o=r.get(t);return arguments.length<2?o&&o.on:(o&&(o.on=null,e=e.slice(0,i=e.indexOf(o)).concat(e.slice(i+1)),r.remove(t)),u&&e.push(r.set(t,{on:u})),n)},t}function f(){Zo.event.preventDefault()}function h(){for(var n,t=Zo.event;n=t.sourceEvent;)t=n;return t}function g(n){for(var t=new s,e=0,r=arguments.length;++e<r;)t[arguments[e]]=l(t);return t.of=function(e,r){return function(u){try{var i=u.sourceEvent=Zo.event;u.target=n,Zo.event=u,t[u.type].apply(e,r)}finally{Zo.event=i}}},t}function p(n){return sa(n,pa),n}function v(n){return"function"==typeof n?n:function(){return la(n,this)}}function d(n){return"function"==typeof n?n:function(){return fa(n,this)}}function m(n,t){function e(){this.removeAttribute(n)}function r(){this.removeAttributeNS(n.space,n.local)}function u(){this.setAttribute(n,t)}function i(){this.setAttributeNS(n.space,n.local,t)}function o(){var e=t.apply(this,arguments);null==e?this.removeAttribute(n):this.setAttribute(n,e)}function a(){var e=t.apply(this,arguments);null==e?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,e)}return n=Zo.ns.qualify(n),null==t?n.local?r:e:"function"==typeof t?n.local?a:o:n.local?i:u}function y(n){return n.trim().replace(/\s+/g," ")}function x(n){return new RegExp("(?:^|\\s+)"+Zo.requote(n)+"(?:\\s+|$)","g")}function M(n,t){function e(){for(var e=-1;++e<u;)n[e](this,t)}function r(){for(var e=-1,r=t.apply(this,arguments);++e<u;)n[e](this,r)}n=n.trim().split(/\s+/).map(_);var u=n.length;return"function"==typeof t?r:e}function _(n){var t=x(n);return function(e,r){if(u=e.classList)return r?u.add(n):u.remove(n);var u=e.getAttribute("class")||"";r?(t.lastIndex=0,t.test(u)||e.setAttribute("class",y(u+" "+n))):e.setAttribute("class",y(u.replace(t," ")))}}function b(n,t,e){function r(){this.style.removeProperty(n)}function u(){this.style.setProperty(n,t,e)}function i(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(n):this.style.setProperty(n,r,e)}return null==t?r:"function"==typeof t?i:u}function w(n,t){function e(){delete this[n]}function r(){this[n]=t}function u(){var e=t.apply(this,arguments);null==e?delete this[n]:this[n]=e}return null==t?e:"function"==typeof t?u:r}function S(n){return"function"==typeof n?n:(n=Zo.ns.qualify(n)).local?function(){return this.ownerDocument.createElementNS(n.space,n.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,n)}}function k(n){return{__data__:n}}function E(n){return function(){return ga(this,n)}}function A(n){return arguments.length||(n=Zo.ascending),function(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}}function C(n,t){for(var e=0,r=n.length;r>e;e++)for(var u,i=n[e],o=0,a=i.length;a>o;o++)(u=i[o])&&t(u,o,e);return n}function N(n){return sa(n,da),n}function L(n){var t,e;return function(r,u,i){var o,a=n[i].update,c=a.length;for(i!=e&&(e=i,t=0),u>=t&&(t=u+1);!(o=a[t])&&++t<c;);return o}}function T(){var n=this.__transition__;n&&++n.active}function q(n,t,e){function r(){var t=this[o];t&&(this.removeEventListener(n,t,t.$),delete this[o])}function u(){var u=s(t,Xo(arguments));r.call(this),this.addEventListener(n,this[o]=u,u.$=e),u._=t}function i(){var t,e=new RegExp("^__on([^.]+)"+Zo.requote(n)+"$");for(var r in this)if(t=r.match(e)){var u=this[r];this.removeEventListener(t[1],u,u.$),delete this[r]}}var o="__on"+n,a=n.indexOf("."),s=z;a>0&&(n=n.substring(0,a));var l=ya.get(n);return l&&(n=l,s=R),a?t?u:r:t?c:i}function z(n,t){return function(e){var r=Zo.event;Zo.event=e,t[0]=this.__data__;try{n.apply(this,t)}finally{Zo.event=r}}}function R(n,t){var e=z(n,t);return function(n){var t=this,r=n.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||e.call(t,n)}}function D(){var n=".dragsuppress-"+ ++Ma,t="touchmove"+n,e="selectstart"+n,r="dragstart"+n,u="click"+n,i=Zo.select(Wo).on(t,f).on(e,f).on(r,f),o=Bo.style,a=o[xa];return o[xa]="none",function(t){function e(){i.on(u,null)}i.on(n,null),o[xa]=a,t&&(i.on(u,function(){f(),e()},!0),setTimeout(e,0))}}function P(n,t){t.changedTouches&&(t=t.changedTouches[0]);var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r=e.createSVGPoint();if(0>_a&&(Wo.scrollX||Wo.scrollY)){e=Zo.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var u=e[0][0].getScreenCTM();_a=!(u.f||u.e),e.remove()}return _a?(r.x=t.pageX,r.y=t.pageY):(r.x=t.clientX,r.y=t.clientY),r=r.matrixTransform(n.getScreenCTM().inverse()),[r.x,r.y]}var i=n.getBoundingClientRect();return[t.clientX-i.left-n.clientLeft,t.clientY-i.top-n.clientTop]}function U(n){return n>0?1:0>n?-1:0}function j(n){return n>1?0:-1>n?ba:Math.acos(n)}function H(n){return n>1?Sa:-1>n?-Sa:Math.asin(n)}function F(n){return((n=Math.exp(n))-1/n)/2}function O(n){return((n=Math.exp(n))+1/n)/2}function Y(n){return((n=Math.exp(2*n))-1)/(n+1)}function I(n){return(n=Math.sin(n/2))*n}function Z(){}function V(n,t,e){return new X(n,t,e)}function X(n,t,e){this.h=n,this.s=t,this.l=e}function $(n,t,e){function r(n){return n>360?n-=360:0>n&&(n+=360),60>n?i+(o-i)*n/60:180>n?o:240>n?i+(o-i)*(240-n)/60:i}function u(n){return Math.round(255*r(n))}var i,o;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:0>t?0:t>1?1:t,e=0>e?0:e>1?1:e,o=.5>=e?e*(1+t):e+t-e*t,i=2*e-o,ot(u(n+120),u(n),u(n-120))}function B(n,t,e){return new W(n,t,e)}function W(n,t,e){this.h=n,this.c=t,this.l=e}function J(n,t,e){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),G(e,Math.cos(n*=Aa)*t,Math.sin(n)*t)}function G(n,t,e){return new K(n,t,e)}function K(n,t,e){this.l=n,this.a=t,this.b=e}function Q(n,t,e){var r=(n+16)/116,u=r+t/500,i=r-e/200;return u=tt(u)*ja,r=tt(r)*Ha,i=tt(i)*Fa,ot(rt(3.2404542*u-1.5371385*r-.4985314*i),rt(-.969266*u+1.8760108*r+.041556*i),rt(.0556434*u-.2040259*r+1.0572252*i))}function nt(n,t,e){return n>0?B(Math.atan2(e,t)*Ca,Math.sqrt(t*t+e*e),n):B(0/0,0/0,n)}function tt(n){return n>.206893034?n*n*n:(n-4/29)/7.787037}function et(n){return n>.008856?Math.pow(n,1/3):7.787037*n+4/29}function rt(n){return Math.round(255*(.00304>=n?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function ut(n){return ot(n>>16,255&n>>8,255&n)}function it(n){return ut(n)+""}function ot(n,t,e){return new at(n,t,e)}function at(n,t,e){this.r=n,this.g=t,this.b=e}function ct(n){return 16>n?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function st(n,t,e){var r,u,i,o=0,a=0,c=0;if(r=/([a-z]+)\((.*)\)/i.exec(n))switch(u=r[2].split(","),r[1]){case"hsl":return e(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(gt(u[0]),gt(u[1]),gt(u[2]))}return(i=Ia.get(n))?t(i.r,i.g,i.b):(null!=n&&"#"===n.charAt(0)&&(4===n.length?(o=n.charAt(1),o+=o,a=n.charAt(2),a+=a,c=n.charAt(3),c+=c):7===n.length&&(o=n.substring(1,3),a=n.substring(3,5),c=n.substring(5,7)),o=parseInt(o,16),a=parseInt(a,16),c=parseInt(c,16)),t(o,a,c))}function lt(n,t,e){var r,u,i=Math.min(n/=255,t/=255,e/=255),o=Math.max(n,t,e),a=o-i,c=(o+i)/2;return a?(u=.5>c?a/(o+i):a/(2-o-i),r=n==o?(t-e)/a+(e>t?6:0):t==o?(e-n)/a+2:(n-t)/a+4,r*=60):(r=0/0,u=c>0&&1>c?0:r),V(r,u,c)}function ft(n,t,e){n=ht(n),t=ht(t),e=ht(e);var r=et((.4124564*n+.3575761*t+.1804375*e)/ja),u=et((.2126729*n+.7151522*t+.072175*e)/Ha),i=et((.0193339*n+.119192*t+.9503041*e)/Fa);return G(116*u-16,500*(r-u),200*(u-i))}function ht(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function gt(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}function pt(n){return"function"==typeof n?n:function(){return n}}function vt(n){return n}function dt(n){return function(t,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=null),mt(t,e,n,r)}}function mt(n,t,e,r){function u(){var n,t=c.status;if(!t&&c.responseText||t>=200&&300>t||304===t){try{n=e.call(i,c)}catch(r){return o.error.call(i,r),void 0}o.load.call(i,n)}else o.error.call(i,c)}var i={},o=Zo.dispatch("beforesend","progress","load","error"),a={},c=new XMLHttpRequest,s=null;return!Wo.XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(n)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=u:c.onreadystatechange=function(){c.readyState>3&&u()},c.onprogress=function(n){var t=Zo.event;Zo.event=n;try{o.progress.call(i,c)}finally{Zo.event=t}},i.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?a[n]:(null==t?delete a[n]:a[n]=t+"",i)},i.mimeType=function(n){return arguments.length?(t=null==n?null:n+"",i):t},i.responseType=function(n){return arguments.length?(s=n,i):s},i.response=function(n){return e=n,i},["get","post"].forEach(function(n){i[n]=function(){return i.send.apply(i,[n].concat(Xo(arguments)))}}),i.send=function(e,r,u){if(2===arguments.length&&"function"==typeof r&&(u=r,r=null),c.open(e,n,!0),null==t||"accept"in a||(a.accept=t+",*/*"),c.setRequestHeader)for(var l in a)c.setRequestHeader(l,a[l]);return null!=t&&c.overrideMimeType&&c.overrideMimeType(t),null!=s&&(c.responseType=s),null!=u&&i.on("error",u).on("load",function(n){u(null,n)}),o.beforesend.call(i,c),c.send(null==r?null:r),i},i.abort=function(){return c.abort(),i},Zo.rebind(i,o,"on"),null==r?i:i.get(yt(r))}function yt(n){return 1===n.length?function(t,e){n(null==t?e:null)}:n}function xt(){var n=Mt(),t=_t()-n;t>24?(isFinite(t)&&(clearTimeout($a),$a=setTimeout(xt,t)),Xa=0):(Xa=1,Wa(xt))}function Mt(){var n=Date.now();for(Ba=Za;Ba;)n>=Ba.t&&(Ba.f=Ba.c(n-Ba.t)),Ba=Ba.n;return n}function _t(){for(var n,t=Za,e=1/0;t;)t.f?t=n?n.n=t.n:Za=t.n:(t.t<e&&(e=t.t),t=(n=t).n);return Va=n,e}function bt(n,t){var e=Math.pow(10,3*ua(8-t));return{scale:t>8?function(n){return n/e}:function(n){return n*e},symbol:n}}function wt(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function St(n){return n+""}function kt(){}function Et(n,t,e){var r=e.s=n+t,u=r-n,i=r-u;e.t=n-i+(t-u)}function At(n,t){n&&ac.hasOwnProperty(n.type)&&ac[n.type](n,t)}function Ct(n,t,e){var r,u=-1,i=n.length-e;for(t.lineStart();++u<i;)r=n[u],t.point(r[0],r[1],r[2]);t.lineEnd()}function Nt(n,t){var e=-1,r=n.length;for(t.polygonStart();++e<r;)Ct(n[e],t,1);t.polygonEnd()}function Lt(){function n(n,t){n*=Aa,t=t*Aa/2+ba/4;var e=n-r,o=Math.cos(t),a=Math.sin(t),c=i*a,s=u*o+c*Math.cos(e),l=c*Math.sin(e);sc.add(Math.atan2(l,s)),r=n,u=o,i=a}var t,e,r,u,i;lc.point=function(o,a){lc.point=n,r=(t=o)*Aa,u=Math.cos(a=(e=a)*Aa/2+ba/4),i=Math.sin(a)},lc.lineEnd=function(){n(t,e)}}function Tt(n){var t=n[0],e=n[1],r=Math.cos(e);return[r*Math.cos(t),r*Math.sin(t),Math.sin(e)]}function qt(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function zt(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Rt(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function Dt(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Pt(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function Ut(n){return[Math.atan2(n[1],n[0]),H(n[2])]}function jt(n,t){return ua(n[0]-t[0])<ka&&ua(n[1]-t[1])<ka}function Ht(n,t){n*=Aa;var e=Math.cos(t*=Aa);Ft(e*Math.cos(n),e*Math.sin(n),Math.sin(t))}function Ft(n,t,e){++fc,gc+=(n-gc)/fc,pc+=(t-pc)/fc,vc+=(e-vc)/fc}function Ot(){function n(n,u){n*=Aa;var i=Math.cos(u*=Aa),o=i*Math.cos(n),a=i*Math.sin(n),c=Math.sin(u),s=Math.atan2(Math.sqrt((s=e*c-r*a)*s+(s=r*o-t*c)*s+(s=t*a-e*o)*s),t*o+e*a+r*c);hc+=s,dc+=s*(t+(t=o)),mc+=s*(e+(e=a)),yc+=s*(r+(r=c)),Ft(t,e,r)}var t,e,r;bc.point=function(u,i){u*=Aa;var o=Math.cos(i*=Aa);t=o*Math.cos(u),e=o*Math.sin(u),r=Math.sin(i),bc.point=n,Ft(t,e,r)}}function Yt(){bc.point=Ht}function It(){function n(n,t){n*=Aa;var e=Math.cos(t*=Aa),o=e*Math.cos(n),a=e*Math.sin(n),c=Math.sin(t),s=u*c-i*a,l=i*o-r*c,f=r*a-u*o,h=Math.sqrt(s*s+l*l+f*f),g=r*o+u*a+i*c,p=h&&-j(g)/h,v=Math.atan2(h,g);xc+=p*s,Mc+=p*l,_c+=p*f,hc+=v,dc+=v*(r+(r=o)),mc+=v*(u+(u=a)),yc+=v*(i+(i=c)),Ft(r,u,i)}var t,e,r,u,i;bc.point=function(o,a){t=o,e=a,bc.point=n,o*=Aa;var c=Math.cos(a*=Aa);r=c*Math.cos(o),u=c*Math.sin(o),i=Math.sin(a),Ft(r,u,i)},bc.lineEnd=function(){n(t,e),bc.lineEnd=Yt,bc.point=Ht}}function Zt(){return!0}function Vt(n,t,e,r,u){var i=[],o=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,e=n[0],r=n[t];if(jt(e,r)){u.lineStart();for(var a=0;t>a;++a)u.point((e=n[a])[0],e[1]);return u.lineEnd(),void 0}var c=new $t(e,n,null,!0),s=new $t(e,null,c,!1);c.o=s,i.push(c),o.push(s),c=new $t(r,n,null,!1),s=new $t(r,null,c,!0),c.o=s,i.push(c),o.push(s)}}),o.sort(t),Xt(i),Xt(o),i.length){for(var a=0,c=e,s=o.length;s>a;++a)o[a].e=c=!c;for(var l,f,h=i[0];;){for(var g=h,p=!0;g.v;)if((g=g.n)===h)return;l=g.z,u.lineStart();do{if(g.v=g.o.v=!0,g.e){if(p)for(var a=0,s=l.length;s>a;++a)u.point((f=l[a])[0],f[1]);else r(g.x,g.n.x,1,u);g=g.n}else{if(p){l=g.p.z;for(var a=l.length-1;a>=0;--a)u.point((f=l[a])[0],f[1])}else r(g.x,g.p.x,-1,u);g=g.p}g=g.o,l=g.z,p=!p}while(!g.v);u.lineEnd()}}}function Xt(n){if(t=n.length){for(var t,e,r=0,u=n[0];++r<t;)u.n=e=n[r],e.p=u,u=e;u.n=e=n[0],e.p=u}}function $t(n,t,e,r){this.x=n,this.z=t,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Bt(n,t,e,r){return function(u,i){function o(t,e){var r=u(t,e);n(t=r[0],e=r[1])&&i.point(t,e)}function a(n,t){var e=u(n,t);d.point(e[0],e[1])}function c(){y.point=a,d.lineStart()}function s(){y.point=o,d.lineEnd()}function l(n,t){v.push([n,t]);var e=u(n,t);M.point(e[0],e[1])}function f(){M.lineStart(),v=[]}function h(){l(v[0][0],v[0][1]),M.lineEnd();var n,t=M.clean(),e=x.buffer(),r=e.length;if(v.pop(),p.push(v),v=null,r){if(1&t){n=e[0];var u,r=n.length-1,o=-1;for(i.lineStart();++o<r;)i.point((u=n[o])[0],u[1]);return i.lineEnd(),void 0}r>1&&2&t&&e.push(e.pop().concat(e.shift())),g.push(e.filter(Wt))}}var g,p,v,d=t(i),m=u.invert(r[0],r[1]),y={point:o,lineStart:c,lineEnd:s,polygonStart:function(){y.point=l,y.lineStart=f,y.lineEnd=h,g=[],p=[],i.polygonStart()},polygonEnd:function(){y.point=o,y.lineStart=c,y.lineEnd=s,g=Zo.merge(g);var n=Kt(m,p);g.length?Vt(g,Gt,n,e,i):n&&(i.lineStart(),e(null,null,1,i),i.lineEnd()),i.polygonEnd(),g=p=null},sphere:function(){i.polygonStart(),i.lineStart(),e(null,null,1,i),i.lineEnd(),i.polygonEnd()}},x=Jt(),M=t(x);return y}}function Wt(n){return n.length>1}function Jt(){var n,t=[];return{lineStart:function(){t.push(n=[])},point:function(t,e){n.push([t,e])},lineEnd:c,buffer:function(){var e=t;return t=[],n=null,e},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function Gt(n,t){return((n=n.x)[0]<0?n[1]-Sa-ka:Sa-n[1])-((t=t.x)[0]<0?t[1]-Sa-ka:Sa-t[1])}function Kt(n,t){var e=n[0],r=n[1],u=[Math.sin(e),-Math.cos(e),0],i=0,o=0;sc.reset();for(var a=0,c=t.length;c>a;++a){var s=t[a],l=s.length;if(l)for(var f=s[0],h=f[0],g=f[1]/2+ba/4,p=Math.sin(g),v=Math.cos(g),d=1;;){d===l&&(d=0),n=s[d];var m=n[0],y=n[1]/2+ba/4,x=Math.sin(y),M=Math.cos(y),_=m-h,b=ua(_)>ba,w=p*x;if(sc.add(Math.atan2(w*Math.sin(_),v*M+w*Math.cos(_))),i+=b?_+(_>=0?wa:-wa):_,b^h>=e^m>=e){var S=zt(Tt(f),Tt(n));Pt(S);var k=zt(u,S);Pt(k);var E=(b^_>=0?-1:1)*H(k[2]);(r>E||r===E&&(S[0]||S[1]))&&(o+=b^_>=0?1:-1)}if(!d++)break;h=m,p=x,v=M,f=n}}return(-ka>i||ka>i&&0>sc)^1&o}function Qt(n){var t,e=0/0,r=0/0,u=0/0;return{lineStart:function(){n.lineStart(),t=1},point:function(i,o){var a=i>0?ba:-ba,c=ua(i-e);ua(c-ba)<ka?(n.point(e,r=(r+o)/2>0?Sa:-Sa),n.point(u,r),n.lineEnd(),n.lineStart(),n.point(a,r),n.point(i,r),t=0):u!==a&&c>=ba&&(ua(e-u)<ka&&(e-=u*ka),ua(i-a)<ka&&(i-=a*ka),r=ne(e,r,i,o),n.point(u,r),n.lineEnd(),n.lineStart(),n.point(a,r),t=0),n.point(e=i,r=o),u=a},lineEnd:function(){n.lineEnd(),e=r=0/0},clean:function(){return 2-t}}}function ne(n,t,e,r){var u,i,o=Math.sin(n-e);return ua(o)>ka?Math.atan((Math.sin(t)*(i=Math.cos(r))*Math.sin(e)-Math.sin(r)*(u=Math.cos(t))*Math.sin(n))/(u*i*o)):(t+r)/2}function te(n,t,e,r){var u;if(null==n)u=e*Sa,r.point(-ba,u),r.point(0,u),r.point(ba,u),r.point(ba,0),r.point(ba,-u),r.point(0,-u),r.point(-ba,-u),r.point(-ba,0),r.point(-ba,u);else if(ua(n[0]-t[0])>ka){var i=n[0]<t[0]?ba:-ba;u=e*i/2,r.point(-i,u),r.point(0,u),r.point(i,u)}else r.point(t[0],t[1])}function ee(n){function t(n,t){return Math.cos(n)*Math.cos(t)>i}function e(n){var e,i,c,s,l;return{lineStart:function(){s=c=!1,l=1},point:function(f,h){var g,p=[f,h],v=t(f,h),d=o?v?0:u(f,h):v?u(f+(0>f?ba:-ba),h):0;if(!e&&(s=c=v)&&n.lineStart(),v!==c&&(g=r(e,p),(jt(e,g)||jt(p,g))&&(p[0]+=ka,p[1]+=ka,v=t(p[0],p[1]))),v!==c)l=0,v?(n.lineStart(),g=r(p,e),n.point(g[0],g[1])):(g=r(e,p),n.point(g[0],g[1]),n.lineEnd()),e=g;else if(a&&e&&o^v){var m;d&i||!(m=r(p,e,!0))||(l=0,o?(n.lineStart(),n.point(m[0][0],m[0][1]),n.point(m[1][0],m[1][1]),n.lineEnd()):(n.point(m[1][0],m[1][1]),n.lineEnd(),n.lineStart(),n.point(m[0][0],m[0][1])))}!v||e&&jt(e,p)||n.point(p[0],p[1]),e=p,c=v,i=d},lineEnd:function(){c&&n.lineEnd(),e=null},clean:function(){return l|(s&&c)<<1}}}function r(n,t,e){var r=Tt(n),u=Tt(t),o=[1,0,0],a=zt(r,u),c=qt(a,a),s=a[0],l=c-s*s;if(!l)return!e&&n;var f=i*c/l,h=-i*s/l,g=zt(o,a),p=Dt(o,f),v=Dt(a,h);Rt(p,v);var d=g,m=qt(p,d),y=qt(d,d),x=m*m-y*(qt(p,p)-1);if(!(0>x)){var M=Math.sqrt(x),_=Dt(d,(-m-M)/y);if(Rt(_,p),_=Ut(_),!e)return _;var b,w=n[0],S=t[0],k=n[1],E=t[1];w>S&&(b=w,w=S,S=b);var A=S-w,C=ua(A-ba)<ka,N=C||ka>A;if(!C&&k>E&&(b=k,k=E,E=b),N?C?k+E>0^_[1]<(ua(_[0]-w)<ka?k:E):k<=_[1]&&_[1]<=E:A>ba^(w<=_[0]&&_[0]<=S)){var L=Dt(d,(-m+M)/y);return Rt(L,p),[_,Ut(L)]}}}function u(t,e){var r=o?n:ba-n,u=0;return-r>t?u|=1:t>r&&(u|=2),-r>e?u|=4:e>r&&(u|=8),u}var i=Math.cos(n),o=i>0,a=ua(i)>ka,c=Ne(n,6*Aa);return Bt(t,e,c,o?[0,-n]:[-ba,n-ba])}function re(n,t,e,r){return function(u){var i,o=u.a,a=u.b,c=o.x,s=o.y,l=a.x,f=a.y,h=0,g=1,p=l-c,v=f-s;if(i=n-c,p||!(i>0)){if(i/=p,0>p){if(h>i)return;g>i&&(g=i)}else if(p>0){if(i>g)return;i>h&&(h=i)}if(i=e-c,p||!(0>i)){if(i/=p,0>p){if(i>g)return;i>h&&(h=i)}else if(p>0){if(h>i)return;g>i&&(g=i)}if(i=t-s,v||!(i>0)){if(i/=v,0>v){if(h>i)return;g>i&&(g=i)}else if(v>0){if(i>g)return;i>h&&(h=i)}if(i=r-s,v||!(0>i)){if(i/=v,0>v){if(i>g)return;i>h&&(h=i)}else if(v>0){if(h>i)return;g>i&&(g=i)}return h>0&&(u.a={x:c+h*p,y:s+h*v}),1>g&&(u.b={x:c+g*p,y:s+g*v}),u}}}}}}function ue(n,t,e,r){function u(r,u){return ua(r[0]-n)<ka?u>0?0:3:ua(r[0]-e)<ka?u>0?2:1:ua(r[1]-t)<ka?u>0?1:0:u>0?3:2}function i(n,t){return o(n.x,t.x)}function o(n,t){var e=u(n,1),r=u(t,1);return e!==r?e-r:0===e?t[1]-n[1]:1===e?n[0]-t[0]:2===e?n[1]-t[1]:t[0]-n[0]}return function(a){function c(n){for(var t=0,e=m.length,r=n[1],u=0;e>u;++u)for(var i,o=1,a=m[u],c=a.length,l=a[0];c>o;++o)i=a[o],l[1]<=r?i[1]>r&&s(l,i,n)>0&&++t:i[1]<=r&&s(l,i,n)<0&&--t,l=i;return 0!==t}function s(n,t,e){return(t[0]-n[0])*(e[1]-n[1])-(e[0]-n[0])*(t[1]-n[1])}function l(i,a,c,s){var l=0,f=0;if(null==i||(l=u(i,c))!==(f=u(a,c))||o(i,a)<0^c>0){do s.point(0===l||3===l?n:e,l>1?r:t);while((l=(l+c+4)%4)!==f)}else s.point(a[0],a[1])}function f(u,i){return u>=n&&e>=u&&i>=t&&r>=i}function h(n,t){f(n,t)&&a.point(n,t)}function g(){L.point=v,m&&m.push(y=[]),k=!0,S=!1,b=w=0/0}function p(){d&&(v(x,M),_&&S&&C.rejoin(),d.push(C.buffer())),L.point=h,S&&a.lineEnd()}function v(n,t){n=Math.max(-Sc,Math.min(Sc,n)),t=Math.max(-Sc,Math.min(Sc,t));var e=f(n,t);if(m&&y.push([n,t]),k)x=n,M=t,_=e,k=!1,e&&(a.lineStart(),a.point(n,t));else if(e&&S)a.point(n,t);else{var r={a:{x:b,y:w},b:{x:n,y:t}};N(r)?(S||(a.lineStart(),a.point(r.a.x,r.a.y)),a.point(r.b.x,r.b.y),e||a.lineEnd(),E=!1):e&&(a.lineStart(),a.point(n,t),E=!1)}b=n,w=t,S=e}var d,m,y,x,M,_,b,w,S,k,E,A=a,C=Jt(),N=re(n,t,e,r),L={point:h,lineStart:g,lineEnd:p,polygonStart:function(){a=C,d=[],m=[],E=!0},polygonEnd:function(){a=A,d=Zo.merge(d);var t=c([n,r]),e=E&&t,u=d.length;(e||u)&&(a.polygonStart(),e&&(a.lineStart(),l(null,null,1,a),a.lineEnd()),u&&Vt(d,i,t,l,a),a.polygonEnd()),d=m=y=null}};return L}}function ie(n,t){function e(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(e.invert=function(e,r){return e=t.invert(e,r),e&&n.invert(e[0],e[1])}),e}function oe(n){var t=0,e=ba/3,r=_e(n),u=r(t,e);return u.parallels=function(n){return arguments.length?r(t=n[0]*ba/180,e=n[1]*ba/180):[180*(t/ba),180*(e/ba)]},u}function ae(n,t){function e(n,t){var e=Math.sqrt(i-2*u*Math.sin(t))/u;return[e*Math.sin(n*=u),o-e*Math.cos(n)]}var r=Math.sin(n),u=(r+Math.sin(t))/2,i=1+r*(2*u-r),o=Math.sqrt(i)/u;return e.invert=function(n,t){var e=o-t;return[Math.atan2(n,e)/u,H((i-(n*n+e*e)*u*u)/(2*u))]},e}function ce(){function n(n,t){Ec+=u*n-r*t,r=n,u=t}var t,e,r,u;Tc.point=function(i,o){Tc.point=n,t=r=i,e=u=o},Tc.lineEnd=function(){n(t,e)}}function se(n,t){Ac>n&&(Ac=n),n>Nc&&(Nc=n),Cc>t&&(Cc=t),t>Lc&&(Lc=t)}function le(){function n(n,t){o.push("M",n,",",t,i)}function t(n,t){o.push("M",n,",",t),a.point=e}function e(n,t){o.push("L",n,",",t)}function r(){a.point=n}function u(){o.push("Z")}var i=fe(4.5),o=[],a={point:n,lineStart:function(){a.point=t},lineEnd:r,polygonStart:function(){a.lineEnd=u},polygonEnd:function(){a.lineEnd=r,a.point=n},pointRadius:function(n){return i=fe(n),a},result:function(){if(o.length){var n=o.join("");return o=[],n}}};return a}function fe(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function he(n,t){gc+=n,pc+=t,++vc}function ge(){function n(n,r){var u=n-t,i=r-e,o=Math.sqrt(u*u+i*i);dc+=o*(t+n)/2,mc+=o*(e+r)/2,yc+=o,he(t=n,e=r)}var t,e;zc.point=function(r,u){zc.point=n,he(t=r,e=u)}}function pe(){zc.point=he}function ve(){function n(n,t){var e=n-r,i=t-u,o=Math.sqrt(e*e+i*i);dc+=o*(r+n)/2,mc+=o*(u+t)/2,yc+=o,o=u*n-r*t,xc+=o*(r+n),Mc+=o*(u+t),_c+=3*o,he(r=n,u=t)}var t,e,r,u;zc.point=function(i,o){zc.point=n,he(t=r=i,e=u=o)},zc.lineEnd=function(){n(t,e)}}function de(n){function t(t,e){n.moveTo(t,e),n.arc(t,e,o,0,wa)}function e(t,e){n.moveTo(t,e),a.point=r}function r(t,e){n.lineTo(t,e)}function u(){a.point=t}function i(){n.closePath()}var o=4.5,a={point:t,lineStart:function(){a.point=e},lineEnd:u,polygonStart:function(){a.lineEnd=i},polygonEnd:function(){a.lineEnd=u,a.point=t},pointRadius:function(n){return o=n,a},result:c};return a}function me(n){function t(t){function r(e,r){e=n(e,r),t.point(e[0],e[1])}function u(){x=0/0,S.point=o,t.lineStart()}function o(r,u){var o=Tt([r,u]),a=n(r,u);e(x,M,y,_,b,w,x=a[0],M=a[1],y=r,_=o[0],b=o[1],w=o[2],i,t),t.point(x,M)}function a(){S.point=r,t.lineEnd()}function c(){u(),S.point=s,S.lineEnd=l}function s(n,t){o(f=n,h=t),g=x,p=M,v=_,d=b,m=w,S.point=o}function l(){e(x,M,y,_,b,w,g,p,f,v,d,m,i,t),S.lineEnd=a,a()}var f,h,g,p,v,d,m,y,x,M,_,b,w,S={point:r,lineStart:u,lineEnd:a,polygonStart:function(){t.polygonStart(),S.lineStart=c},polygonEnd:function(){t.polygonEnd(),S.lineStart=u}};return S}function e(t,i,o,a,c,s,l,f,h,g,p,v,d,m){var y=l-t,x=f-i,M=y*y+x*x;if(M>4*r&&d--){var _=a+g,b=c+p,w=s+v,S=Math.sqrt(_*_+b*b+w*w),k=Math.asin(w/=S),E=ua(ua(w)-1)<ka?(o+h)/2:Math.atan2(b,_),A=n(E,k),C=A[0],N=A[1],L=C-t,T=N-i,q=x*L-y*T;(q*q/M>r||ua((y*L+x*T)/M-.5)>.3||u>a*g+c*p+s*v)&&(e(t,i,o,a,c,s,C,N,E,_/=S,b/=S,w,d,m),m.point(C,N),e(C,N,E,_,b,w,l,f,h,g,p,v,d,m))}}var r=.5,u=Math.cos(30*Aa),i=16;return t.precision=function(n){return arguments.length?(i=(r=n*n)>0&&16,t):Math.sqrt(r)},t}function ye(n){this.stream=n}function xe(n){var t=me(function(t,e){return n([t*Ca,e*Ca])});return function(n){var e=new ye(n=t(n));return e.point=function(t,e){n.point(t*Aa,e*Aa)},e}}function Me(n){return _e(function(){return n})()}function _e(n){function t(n){return n=a(n[0]*Aa,n[1]*Aa),[n[0]*h+c,s-n[1]*h]}function e(n){return n=a.invert((n[0]-c)/h,(s-n[1])/h),n&&[n[0]*Ca,n[1]*Ca]}function r(){a=ie(o=ke(m,y,x),i);var n=i(v,d);return c=g-n[0]*h,s=p+n[1]*h,u()}function u(){return l&&(l.valid=!1,l=null),t}var i,o,a,c,s,l,f=me(function(n,t){return n=i(n,t),[n[0]*h+c,s-n[1]*h]}),h=150,g=480,p=250,v=0,d=0,m=0,y=0,x=0,M=wc,_=vt,b=null,w=null;return t.stream=function(n){return l&&(l.valid=!1),l=be(M(o,f(_(n)))),l.valid=!0,l},t.clipAngle=function(n){return arguments.length?(M=null==n?(b=n,wc):ee((b=+n)*Aa),u()):b},t.clipExtent=function(n){return arguments.length?(w=n,_=n?ue(n[0][0],n[0][1],n[1][0],n[1][1]):vt,u()):w},t.scale=function(n){return arguments.length?(h=+n,r()):h},t.translate=function(n){return arguments.length?(g=+n[0],p=+n[1],r()):[g,p]},t.center=function(n){return arguments.length?(v=n[0]%360*Aa,d=n[1]%360*Aa,r()):[v*Ca,d*Ca]},t.rotate=function(n){return arguments.length?(m=n[0]%360*Aa,y=n[1]%360*Aa,x=n.length>2?n[2]%360*Aa:0,r()):[m*Ca,y*Ca,x*Ca]},Zo.rebind(t,f,"precision"),function(){return i=n.apply(this,arguments),t.invert=i.invert&&e,r()}}function be(n){var t=new ye(n);return t.point=function(t,e){n.point(t*Aa,e*Aa)},t}function we(n,t){return[n,t]}function Se(n,t){return[n>ba?n-wa:-ba>n?n+wa:n,t]}function ke(n,t,e){return n?t||e?ie(Ae(n),Ce(t,e)):Ae(n):t||e?Ce(t,e):Se}function Ee(n){return function(t,e){return t+=n,[t>ba?t-wa:-ba>t?t+wa:t,e]}}function Ae(n){var t=Ee(n);return t.invert=Ee(-n),t}function Ce(n,t){function e(n,t){var e=Math.cos(t),a=Math.cos(n)*e,c=Math.sin(n)*e,s=Math.sin(t),l=s*r+a*u;return[Math.atan2(c*i-l*o,a*r-s*u),H(l*i+c*o)]}var r=Math.cos(n),u=Math.sin(n),i=Math.cos(t),o=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),a=Math.cos(n)*e,c=Math.sin(n)*e,s=Math.sin(t),l=s*i-c*o;return[Math.atan2(c*i+s*o,a*r+l*u),H(l*r-a*u)]},e}function Ne(n,t){var e=Math.cos(n),r=Math.sin(n);return function(u,i,o,a){var c=o*t;null!=u?(u=Le(e,u),i=Le(e,i),(o>0?i>u:u>i)&&(u+=o*wa)):(u=n+o*wa,i=n-.5*c);for(var s,l=u;o>0?l>i:i>l;l-=c)a.point((s=Ut([e,-r*Math.cos(l),-r*Math.sin(l)]))[0],s[1])}}function Le(n,t){var e=Tt(t);e[0]-=n,Pt(e);var r=j(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-ka)%(2*Math.PI)}function Te(n,t,e){var r=Zo.range(n,t-ka,e).concat(t);return function(n){return r.map(function(t){return[n,t]})}}function qe(n,t,e){var r=Zo.range(n,t-ka,e).concat(t);return function(n){return r.map(function(t){return[t,n]})}}function ze(n){return n.source}function Re(n){return n.target}function De(n,t,e,r){var u=Math.cos(t),i=Math.sin(t),o=Math.cos(r),a=Math.sin(r),c=u*Math.cos(n),s=u*Math.sin(n),l=o*Math.cos(e),f=o*Math.sin(e),h=2*Math.asin(Math.sqrt(I(r-t)+u*o*I(e-n))),g=1/Math.sin(h),p=h?function(n){var t=Math.sin(n*=h)*g,e=Math.sin(h-n)*g,r=e*c+t*l,u=e*s+t*f,o=e*i+t*a;return[Math.atan2(u,r)*Ca,Math.atan2(o,Math.sqrt(r*r+u*u))*Ca]}:function(){return[n*Ca,t*Ca]};return p.distance=h,p}function Pe(){function n(n,u){var i=Math.sin(u*=Aa),o=Math.cos(u),a=ua((n*=Aa)-t),c=Math.cos(a);Rc+=Math.atan2(Math.sqrt((a=o*Math.sin(a))*a+(a=r*i-e*o*c)*a),e*i+r*o*c),t=n,e=i,r=o}var t,e,r;Dc.point=function(u,i){t=u*Aa,e=Math.sin(i*=Aa),r=Math.cos(i),Dc.point=n},Dc.lineEnd=function(){Dc.point=Dc.lineEnd=c}}function Ue(n,t){function e(t,e){var r=Math.cos(t),u=Math.cos(e),i=n(r*u);return[i*u*Math.sin(t),i*Math.sin(e)]}return e.invert=function(n,e){var r=Math.sqrt(n*n+e*e),u=t(r),i=Math.sin(u),o=Math.cos(u);return[Math.atan2(n*i,r*o),Math.asin(r&&e*i/r)]},e}function je(n,t){function e(n,t){var e=ua(ua(t)-Sa)<ka?0:o/Math.pow(u(t),i);return[e*Math.sin(i*n),o-e*Math.cos(i*n)]}var r=Math.cos(n),u=function(n){return Math.tan(ba/4+n/2)},i=n===t?Math.sin(n):Math.log(r/Math.cos(t))/Math.log(u(t)/u(n)),o=r*Math.pow(u(n),i)/i;return i?(e.invert=function(n,t){var e=o-t,r=U(i)*Math.sqrt(n*n+e*e);return[Math.atan2(n,e)/i,2*Math.atan(Math.pow(o/r,1/i))-Sa]},e):Fe}function He(n,t){function e(n,t){var e=i-t;return[e*Math.sin(u*n),i-e*Math.cos(u*n)]}var r=Math.cos(n),u=n===t?Math.sin(n):(r-Math.cos(t))/(t-n),i=r/u+n;return ua(u)<ka?we:(e.invert=function(n,t){var e=i-t;return[Math.atan2(n,e)/u,i-U(u)*Math.sqrt(n*n+e*e)]},e)}function Fe(n,t){return[n,Math.log(Math.tan(ba/4+t/2))]}function Oe(n){var t,e=Me(n),r=e.scale,u=e.translate,i=e.clipExtent;return e.scale=function(){var n=r.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.translate=function(){var n=u.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.clipExtent=function(n){var o=i.apply(e,arguments);if(o===e){if(t=null==n){var a=ba*r(),c=u();i([[c[0]-a,c[1]-a],[c[0]+a,c[1]+a]])}}else t&&(o=null);return o},e.clipExtent(null)}function Ye(n,t){var e=Math.cos(t)*Math.sin(n);return[Math.log((1+e)/(1-e))/2,Math.atan2(Math.tan(t),Math.cos(n))]}function Ie(n){return n[0]}function Ze(n){return n[1]}function Ve(n,t,e,r){var u,i,o,a,c,s,l;return u=r[n],i=u[0],o=u[1],u=r[t],a=u[0],c=u[1],u=r[e],s=u[0],l=u[1],(l-o)*(a-i)-(c-o)*(s-i)>0}function Xe(n,t,e){return(e[0]-t[0])*(n[1]-t[1])<(e[1]-t[1])*(n[0]-t[0])}function $e(n,t,e,r){var u=n[0],i=e[0],o=t[0]-u,a=r[0]-i,c=n[1],s=e[1],l=t[1]-c,f=r[1]-s,h=(a*(c-s)-f*(u-i))/(f*o-a*l);return[u+h*o,c+h*l]}function Be(n){var t=n[0],e=n[n.length-1];return!(t[0]-e[0]||t[1]-e[1])}function We(){dr(this),this.edge=this.site=this.circle=null}function Je(n){var t=$c.pop()||new We;return t.site=n,t}function Ge(n){ar(n),Zc.remove(n),$c.push(n),dr(n)}function Ke(n){var t=n.circle,e=t.x,r=t.cy,u={x:e,y:r},i=n.P,o=n.N,a=[n];Ge(n);for(var c=i;c.circle&&ua(e-c.circle.x)<ka&&ua(r-c.circle.cy)<ka;)i=c.P,a.unshift(c),Ge(c),c=i;a.unshift(c),ar(c);for(var s=o;s.circle&&ua(e-s.circle.x)<ka&&ua(r-s.circle.cy)<ka;)o=s.N,a.push(s),Ge(s),s=o;a.push(s),ar(s);var l,f=a.length;for(l=1;f>l;++l)s=a[l],c=a[l-1],gr(s.edge,c.site,s.site,u);c=a[0],s=a[f-1],s.edge=fr(c.site,s.site,null,u),or(c),or(s)}function Qe(n){for(var t,e,r,u,i=n.x,o=n.y,a=Zc._;a;)if(r=nr(a,o)-i,r>ka)a=a.L;else{if(u=i-tr(a,o),!(u>ka)){r>-ka?(t=a.P,e=a):u>-ka?(t=a,e=a.N):t=e=a;break}if(!a.R){t=a;break}a=a.R}var c=Je(n);if(Zc.insert(t,c),t||e){if(t===e)return ar(t),e=Je(t.site),Zc.insert(c,e),c.edge=e.edge=fr(t.site,c.site),or(t),or(e),void 0;if(!e)return c.edge=fr(t.site,c.site),void 0;ar(t),ar(e);var s=t.site,l=s.x,f=s.y,h=n.x-l,g=n.y-f,p=e.site,v=p.x-l,d=p.y-f,m=2*(h*d-g*v),y=h*h+g*g,x=v*v+d*d,M={x:(d*y-g*x)/m+l,y:(h*x-v*y)/m+f};gr(e.edge,s,p,M),c.edge=fr(s,n,null,M),e.edge=fr(n,p,null,M),or(t),or(e)}}function nr(n,t){var e=n.site,r=e.x,u=e.y,i=u-t;if(!i)return r;var o=n.P;if(!o)return-1/0;e=o.site;var a=e.x,c=e.y,s=c-t;if(!s)return a;var l=a-r,f=1/i-1/s,h=l/s;return f?(-h+Math.sqrt(h*h-2*f*(l*l/(-2*s)-c+s/2+u-i/2)))/f+r:(r+a)/2}function tr(n,t){var e=n.N;if(e)return nr(e,t);var r=n.site;return r.y===t?r.x:1/0}function er(n){this.site=n,this.edges=[]}function rr(n){for(var t,e,r,u,i,o,a,c,s,l,f=n[0][0],h=n[1][0],g=n[0][1],p=n[1][1],v=Ic,d=v.length;d--;)if(i=v[d],i&&i.prepare())for(a=i.edges,c=a.length,o=0;c>o;)l=a[o].end(),r=l.x,u=l.y,s=a[++o%c].start(),t=s.x,e=s.y,(ua(r-t)>ka||ua(u-e)>ka)&&(a.splice(o,0,new pr(hr(i.site,l,ua(r-f)<ka&&p-u>ka?{x:f,y:ua(t-f)<ka?e:p}:ua(u-p)<ka&&h-r>ka?{x:ua(e-p)<ka?t:h,y:p}:ua(r-h)<ka&&u-g>ka?{x:h,y:ua(t-h)<ka?e:g}:ua(u-g)<ka&&r-f>ka?{x:ua(e-g)<ka?t:f,y:g}:null),i.site,null)),++c)}function ur(n,t){return t.angle-n.angle}function ir(){dr(this),this.x=this.y=this.arc=this.site=this.cy=null}function or(n){var t=n.P,e=n.N;if(t&&e){var r=t.site,u=n.site,i=e.site;if(r!==i){var o=u.x,a=u.y,c=r.x-o,s=r.y-a,l=i.x-o,f=i.y-a,h=2*(c*f-s*l);if(!(h>=-Ea)){var g=c*c+s*s,p=l*l+f*f,v=(f*g-s*p)/h,d=(c*p-l*g)/h,f=d+a,m=Bc.pop()||new ir;m.arc=n,m.site=u,m.x=v+o,m.y=f+Math.sqrt(v*v+d*d),m.cy=f,n.circle=m;for(var y=null,x=Xc._;x;)if(m.y<x.y||m.y===x.y&&m.x<=x.x){if(!x.L){y=x.P;break}x=x.L}else{if(!x.R){y=x;break}x=x.R}Xc.insert(y,m),y||(Vc=m)}}}}function ar(n){var t=n.circle;t&&(t.P||(Vc=t.N),Xc.remove(t),Bc.push(t),dr(t),n.circle=null)}function cr(n){for(var t,e=Yc,r=re(n[0][0],n[0][1],n[1][0],n[1][1]),u=e.length;u--;)t=e[u],(!sr(t,n)||!r(t)||ua(t.a.x-t.b.x)<ka&&ua(t.a.y-t.b.y)<ka)&&(t.a=t.b=null,e.splice(u,1))}function sr(n,t){var e=n.b;if(e)return!0;var r,u,i=n.a,o=t[0][0],a=t[1][0],c=t[0][1],s=t[1][1],l=n.l,f=n.r,h=l.x,g=l.y,p=f.x,v=f.y,d=(h+p)/2,m=(g+v)/2;if(v===g){if(o>d||d>=a)return;if(h>p){if(i){if(i.y>=s)return}else i={x:d,y:c};e={x:d,y:s}}else{if(i){if(i.y<c)return}else i={x:d,y:s};e={x:d,y:c}}}else if(r=(h-p)/(v-g),u=m-r*d,-1>r||r>1)if(h>p){if(i){if(i.y>=s)return
}else i={x:(c-u)/r,y:c};e={x:(s-u)/r,y:s}}else{if(i){if(i.y<c)return}else i={x:(s-u)/r,y:s};e={x:(c-u)/r,y:c}}else if(v>g){if(i){if(i.x>=a)return}else i={x:o,y:r*o+u};e={x:a,y:r*a+u}}else{if(i){if(i.x<o)return}else i={x:a,y:r*a+u};e={x:o,y:r*o+u}}return n.a=i,n.b=e,!0}function lr(n,t){this.l=n,this.r=t,this.a=this.b=null}function fr(n,t,e,r){var u=new lr(n,t);return Yc.push(u),e&&gr(u,n,t,e),r&&gr(u,t,n,r),Ic[n.i].edges.push(new pr(u,n,t)),Ic[t.i].edges.push(new pr(u,t,n)),u}function hr(n,t,e){var r=new lr(n,null);return r.a=t,r.b=e,Yc.push(r),r}function gr(n,t,e,r){n.a||n.b?n.l===e?n.b=r:n.a=r:(n.a=r,n.l=t,n.r=e)}function pr(n,t,e){var r=n.a,u=n.b;this.edge=n,this.site=t,this.angle=e?Math.atan2(e.y-t.y,e.x-t.x):n.l===t?Math.atan2(u.x-r.x,r.y-u.y):Math.atan2(r.x-u.x,u.y-r.y)}function vr(){this._=null}function dr(n){n.U=n.C=n.L=n.R=n.P=n.N=null}function mr(n,t){var e=t,r=t.R,u=e.U;u?u.L===e?u.L=r:u.R=r:n._=r,r.U=u,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function yr(n,t){var e=t,r=t.L,u=e.U;u?u.L===e?u.L=r:u.R=r:n._=r,r.U=u,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function xr(n){for(;n.L;)n=n.L;return n}function Mr(n,t){var e,r,u,i=n.sort(_r).pop();for(Yc=[],Ic=new Array(n.length),Zc=new vr,Xc=new vr;;)if(u=Vc,i&&(!u||i.y<u.y||i.y===u.y&&i.x<u.x))(i.x!==e||i.y!==r)&&(Ic[i.i]=new er(i),Qe(i),e=i.x,r=i.y),i=n.pop();else{if(!u)break;Ke(u.arc)}t&&(cr(t),rr(t));var o={cells:Ic,edges:Yc};return Zc=Xc=Yc=Ic=null,o}function _r(n,t){return t.y-n.y||t.x-n.x}function br(n,t,e){return(n.x-e.x)*(t.y-n.y)-(n.x-t.x)*(e.y-n.y)}function wr(n){return n.x}function Sr(n){return n.y}function kr(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Er(n,t,e,r,u,i){if(!n(t,e,r,u,i)){var o=.5*(e+u),a=.5*(r+i),c=t.nodes;c[0]&&Er(n,c[0],e,r,o,a),c[1]&&Er(n,c[1],o,r,u,a),c[2]&&Er(n,c[2],e,a,o,i),c[3]&&Er(n,c[3],o,a,u,i)}}function Ar(n,t){n=Zo.rgb(n),t=Zo.rgb(t);var e=n.r,r=n.g,u=n.b,i=t.r-e,o=t.g-r,a=t.b-u;return function(n){return"#"+ct(Math.round(e+i*n))+ct(Math.round(r+o*n))+ct(Math.round(u+a*n))}}function Cr(n,t){var e,r={},u={};for(e in n)e in t?r[e]=Tr(n[e],t[e]):u[e]=n[e];for(e in t)e in n||(u[e]=t[e]);return function(n){for(e in r)u[e]=r[e](n);return u}}function Nr(n,t){return t-=n=+n,function(e){return n+t*e}}function Lr(n,t){var e,r,u,i,o,a=0,c=0,s=[],l=[];for(n+="",t+="",Jc.lastIndex=0,r=0;e=Jc.exec(t);++r)e.index&&s.push(t.substring(a,c=e.index)),l.push({i:s.length,x:e[0]}),s.push(null),a=Jc.lastIndex;for(a<t.length&&s.push(t.substring(a)),r=0,i=l.length;(e=Jc.exec(n))&&i>r;++r)if(o=l[r],o.x==e[0]){if(o.i)if(null==s[o.i+1])for(s[o.i-1]+=o.x,s.splice(o.i,1),u=r+1;i>u;++u)l[u].i--;else for(s[o.i-1]+=o.x+s[o.i+1],s.splice(o.i,2),u=r+1;i>u;++u)l[u].i-=2;else if(null==s[o.i+1])s[o.i]=o.x;else for(s[o.i]=o.x+s[o.i+1],s.splice(o.i+1,1),u=r+1;i>u;++u)l[u].i--;l.splice(r,1),i--,r--}else o.x=Nr(parseFloat(e[0]),parseFloat(o.x));for(;i>r;)o=l.pop(),null==s[o.i+1]?s[o.i]=o.x:(s[o.i]=o.x+s[o.i+1],s.splice(o.i+1,1)),i--;return 1===s.length?null==s[0]?(o=l[0].x,function(n){return o(n)+""}):function(){return t}:function(n){for(r=0;i>r;++r)s[(o=l[r]).i]=o.x(n);return s.join("")}}function Tr(n,t){for(var e,r=Zo.interpolators.length;--r>=0&&!(e=Zo.interpolators[r](n,t)););return e}function qr(n,t){var e,r=[],u=[],i=n.length,o=t.length,a=Math.min(n.length,t.length);for(e=0;a>e;++e)r.push(Tr(n[e],t[e]));for(;i>e;++e)u[e]=n[e];for(;o>e;++e)u[e]=t[e];return function(n){for(e=0;a>e;++e)u[e]=r[e](n);return u}}function zr(n){return function(t){return 0>=t?0:t>=1?1:n(t)}}function Rr(n){return function(t){return 1-n(1-t)}}function Dr(n){return function(t){return.5*(.5>t?n(2*t):2-n(2-2*t))}}function Pr(n){return n*n}function Ur(n){return n*n*n}function jr(n){if(0>=n)return 0;if(n>=1)return 1;var t=n*n,e=t*n;return 4*(.5>n?e:3*(n-t)+e-.75)}function Hr(n){return function(t){return Math.pow(t,n)}}function Fr(n){return 1-Math.cos(n*Sa)}function Or(n){return Math.pow(2,10*(n-1))}function Yr(n){return 1-Math.sqrt(1-n*n)}function Ir(n,t){var e;return arguments.length<2&&(t=.45),arguments.length?e=t/wa*Math.asin(1/n):(n=1,e=t/4),function(r){return 1+n*Math.pow(2,-10*r)*Math.sin((r-e)*wa/t)}}function Zr(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}}function Vr(n){return 1/2.75>n?7.5625*n*n:2/2.75>n?7.5625*(n-=1.5/2.75)*n+.75:2.5/2.75>n?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function Xr(n,t){n=Zo.hcl(n),t=Zo.hcl(t);var e=n.h,r=n.c,u=n.l,i=t.h-e,o=t.c-r,a=t.l-u;return isNaN(o)&&(o=0,r=isNaN(r)?t.c:r),isNaN(i)?(i=0,e=isNaN(e)?t.h:e):i>180?i-=360:-180>i&&(i+=360),function(n){return J(e+i*n,r+o*n,u+a*n)+""}}function $r(n,t){n=Zo.hsl(n),t=Zo.hsl(t);var e=n.h,r=n.s,u=n.l,i=t.h-e,o=t.s-r,a=t.l-u;return isNaN(o)&&(o=0,r=isNaN(r)?t.s:r),isNaN(i)?(i=0,e=isNaN(e)?t.h:e):i>180?i-=360:-180>i&&(i+=360),function(n){return $(e+i*n,r+o*n,u+a*n)+""}}function Br(n,t){n=Zo.lab(n),t=Zo.lab(t);var e=n.l,r=n.a,u=n.b,i=t.l-e,o=t.a-r,a=t.b-u;return function(n){return Q(e+i*n,r+o*n,u+a*n)+""}}function Wr(n,t){return t-=n,function(e){return Math.round(n+t*e)}}function Jr(n){var t=[n.a,n.b],e=[n.c,n.d],r=Kr(t),u=Gr(t,e),i=Kr(Qr(e,t,-u))||0;t[0]*e[1]<e[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,u*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-e[0],e[1]))*Ca,this.translate=[n.e,n.f],this.scale=[r,i],this.skew=i?Math.atan2(u,i)*Ca:0}function Gr(n,t){return n[0]*t[0]+n[1]*t[1]}function Kr(n){var t=Math.sqrt(Gr(n,n));return t&&(n[0]/=t,n[1]/=t),t}function Qr(n,t,e){return n[0]+=e*t[0],n[1]+=e*t[1],n}function nu(n,t){var e,r=[],u=[],i=Zo.transform(n),o=Zo.transform(t),a=i.translate,c=o.translate,s=i.rotate,l=o.rotate,f=i.skew,h=o.skew,g=i.scale,p=o.scale;return a[0]!=c[0]||a[1]!=c[1]?(r.push("translate(",null,",",null,")"),u.push({i:1,x:Nr(a[0],c[0])},{i:3,x:Nr(a[1],c[1])})):c[0]||c[1]?r.push("translate("+c+")"):r.push(""),s!=l?(s-l>180?l+=360:l-s>180&&(s+=360),u.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:Nr(s,l)})):l&&r.push(r.pop()+"rotate("+l+")"),f!=h?u.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:Nr(f,h)}):h&&r.push(r.pop()+"skewX("+h+")"),g[0]!=p[0]||g[1]!=p[1]?(e=r.push(r.pop()+"scale(",null,",",null,")"),u.push({i:e-4,x:Nr(g[0],p[0])},{i:e-2,x:Nr(g[1],p[1])})):(1!=p[0]||1!=p[1])&&r.push(r.pop()+"scale("+p+")"),e=u.length,function(n){for(var t,i=-1;++i<e;)r[(t=u[i]).i]=t.x(n);return r.join("")}}function tu(n,t){return t=t-(n=+n)?1/(t-n):0,function(e){return(e-n)*t}}function eu(n,t){return t=t-(n=+n)?1/(t-n):0,function(e){return Math.max(0,Math.min(1,(e-n)*t))}}function ru(n){for(var t=n.source,e=n.target,r=iu(t,e),u=[t];t!==r;)t=t.parent,u.push(t);for(var i=u.length;e!==r;)u.splice(i,0,e),e=e.parent;return u}function uu(n){for(var t=[],e=n.parent;null!=e;)t.push(n),n=e,e=e.parent;return t.push(n),t}function iu(n,t){if(n===t)return n;for(var e=uu(n),r=uu(t),u=e.pop(),i=r.pop(),o=null;u===i;)o=u,u=e.pop(),i=r.pop();return o}function ou(n){n.fixed|=2}function au(n){n.fixed&=-7}function cu(n){n.fixed|=4,n.px=n.x,n.py=n.y}function su(n){n.fixed&=-5}function lu(n,t,e){var r=0,u=0;if(n.charge=0,!n.leaf)for(var i,o=n.nodes,a=o.length,c=-1;++c<a;)i=o[c],null!=i&&(lu(i,t,e),n.charge+=i.charge,r+=i.charge*i.cx,u+=i.charge*i.cy);if(n.point){n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5);var s=t*e[n.point.index];n.charge+=n.pointCharge=s,r+=s*n.point.x,u+=s*n.point.y}n.cx=r/n.charge,n.cy=u/n.charge}function fu(n,t){return Zo.rebind(n,t,"sort","children","value"),n.nodes=n,n.links=vu,n}function hu(n){return n.children}function gu(n){return n.value}function pu(n,t){return t.value-n.value}function vu(n){return Zo.merge(n.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function du(n){return n.x}function mu(n){return n.y}function yu(n,t,e){n.y0=t,n.y=e}function xu(n){return Zo.range(n.length)}function Mu(n){for(var t=-1,e=n[0].length,r=[];++t<e;)r[t]=0;return r}function _u(n){for(var t,e=1,r=0,u=n[0][1],i=n.length;i>e;++e)(t=n[e][1])>u&&(r=e,u=t);return r}function bu(n){return n.reduce(wu,0)}function wu(n,t){return n+t[1]}function Su(n,t){return ku(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function ku(n,t){for(var e=-1,r=+n[0],u=(n[1]-r)/t,i=[];++e<=t;)i[e]=u*e+r;return i}function Eu(n){return[Zo.min(n),Zo.max(n)]}function Au(n,t){return n.parent==t.parent?1:2}function Cu(n){var t=n.children;return t&&t.length?t[0]:n._tree.thread}function Nu(n){var t,e=n.children;return e&&(t=e.length)?e[t-1]:n._tree.thread}function Lu(n,t){var e=n.children;if(e&&(u=e.length))for(var r,u,i=-1;++i<u;)t(r=Lu(e[i],t),n)>0&&(n=r);return n}function Tu(n,t){return n.x-t.x}function qu(n,t){return t.x-n.x}function zu(n,t){return n.depth-t.depth}function Ru(n,t){function e(n,r){var u=n.children;if(u&&(o=u.length))for(var i,o,a=null,c=-1;++c<o;)i=u[c],e(i,a),a=i;t(n,r)}e(n,null)}function Du(n){for(var t,e=0,r=0,u=n.children,i=u.length;--i>=0;)t=u[i]._tree,t.prelim+=e,t.mod+=e,e+=t.shift+(r+=t.change)}function Pu(n,t,e){n=n._tree,t=t._tree;var r=e/(t.number-n.number);n.change+=r,t.change-=r,t.shift+=e,t.prelim+=e,t.mod+=e}function Uu(n,t,e){return n._tree.ancestor.parent==t.parent?n._tree.ancestor:e}function ju(n,t){return n.value-t.value}function Hu(n,t){var e=n._pack_next;n._pack_next=t,t._pack_prev=n,t._pack_next=e,e._pack_prev=t}function Fu(n,t){n._pack_next=t,t._pack_prev=n}function Ou(n,t){var e=t.x-n.x,r=t.y-n.y,u=n.r+t.r;return.999*u*u>e*e+r*r}function Yu(n){function t(n){l=Math.min(n.x-n.r,l),f=Math.max(n.x+n.r,f),h=Math.min(n.y-n.r,h),g=Math.max(n.y+n.r,g)}if((e=n.children)&&(s=e.length)){var e,r,u,i,o,a,c,s,l=1/0,f=-1/0,h=1/0,g=-1/0;if(e.forEach(Iu),r=e[0],r.x=-r.r,r.y=0,t(r),s>1&&(u=e[1],u.x=u.r,u.y=0,t(u),s>2))for(i=e[2],Xu(r,u,i),t(i),Hu(r,i),r._pack_prev=i,Hu(i,u),u=r._pack_next,o=3;s>o;o++){Xu(r,u,i=e[o]);var p=0,v=1,d=1;for(a=u._pack_next;a!==u;a=a._pack_next,v++)if(Ou(a,i)){p=1;break}if(1==p)for(c=r._pack_prev;c!==a._pack_prev&&!Ou(c,i);c=c._pack_prev,d++);p?(d>v||v==d&&u.r<r.r?Fu(r,u=a):Fu(r=c,u),o--):(Hu(r,i),u=i,t(i))}var m=(l+f)/2,y=(h+g)/2,x=0;for(o=0;s>o;o++)i=e[o],i.x-=m,i.y-=y,x=Math.max(x,i.r+Math.sqrt(i.x*i.x+i.y*i.y));n.r=x,e.forEach(Zu)}}function Iu(n){n._pack_next=n._pack_prev=n}function Zu(n){delete n._pack_next,delete n._pack_prev}function Vu(n,t,e,r){var u=n.children;if(n.x=t+=r*n.x,n.y=e+=r*n.y,n.r*=r,u)for(var i=-1,o=u.length;++i<o;)Vu(u[i],t,e,r)}function Xu(n,t,e){var r=n.r+e.r,u=t.x-n.x,i=t.y-n.y;if(r&&(u||i)){var o=t.r+e.r,a=u*u+i*i;o*=o,r*=r;var c=.5+(r-o)/(2*a),s=Math.sqrt(Math.max(0,2*o*(r+a)-(r-=a)*r-o*o))/(2*a);e.x=n.x+c*u+s*i,e.y=n.y+c*i-s*u}else e.x=n.x+r,e.y=n.y}function $u(n){return 1+Zo.max(n,function(n){return n.y})}function Bu(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}function Wu(n){var t=n.children;return t&&t.length?Wu(t[0]):n}function Ju(n){var t,e=n.children;return e&&(t=e.length)?Ju(e[t-1]):n}function Gu(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function Ku(n,t){var e=n.x+t[3],r=n.y+t[0],u=n.dx-t[1]-t[3],i=n.dy-t[0]-t[2];return 0>u&&(e+=u/2,u=0),0>i&&(r+=i/2,i=0),{x:e,y:r,dx:u,dy:i}}function Qu(n){var t=n[0],e=n[n.length-1];return e>t?[t,e]:[e,t]}function ni(n){return n.rangeExtent?n.rangeExtent():Qu(n.range())}function ti(n,t,e,r){var u=e(n[0],n[1]),i=r(t[0],t[1]);return function(n){return i(u(n))}}function ei(n,t){var e,r=0,u=n.length-1,i=n[r],o=n[u];return i>o&&(e=r,r=u,u=e,e=i,i=o,o=e),n[r]=t.floor(i),n[u]=t.ceil(o),n}function ri(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:os}function ui(n,t,e,r){var u=[],i=[],o=0,a=Math.min(n.length,t.length)-1;for(n[a]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++o<=a;)u.push(e(n[o-1],n[o])),i.push(r(t[o-1],t[o]));return function(t){var e=Zo.bisect(n,t,1,a)-1;return i[e](u[e](t))}}function ii(n,t,e,r){function u(){var u=Math.min(n.length,t.length)>2?ui:ti,c=r?eu:tu;return o=u(n,t,c,e),a=u(t,n,c,Tr),i}function i(n){return o(n)}var o,a;return i.invert=function(n){return a(n)},i.domain=function(t){return arguments.length?(n=t.map(Number),u()):n},i.range=function(n){return arguments.length?(t=n,u()):t},i.rangeRound=function(n){return i.range(n).interpolate(Wr)},i.clamp=function(n){return arguments.length?(r=n,u()):r},i.interpolate=function(n){return arguments.length?(e=n,u()):e},i.ticks=function(t){return si(n,t)},i.tickFormat=function(t,e){return li(n,t,e)},i.nice=function(t){return ai(n,t),u()},i.copy=function(){return ii(n,t,e,r)},u()}function oi(n,t){return Zo.rebind(n,t,"range","rangeRound","interpolate","clamp")}function ai(n,t){return ei(n,ri(ci(n,t)[2]))}function ci(n,t){null==t&&(t=10);var e=Qu(n),r=e[1]-e[0],u=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),i=t/r*u;return.15>=i?u*=10:.35>=i?u*=5:.75>=i&&(u*=2),e[0]=Math.ceil(e[0]/u)*u,e[1]=Math.floor(e[1]/u)*u+.5*u,e[2]=u,e}function si(n,t){return Zo.range.apply(Zo,ci(n,t))}function li(n,t,e){var r=-Math.floor(Math.log(ci(n,t)[2])/Math.LN10+.01);return Zo.format(e?e.replace(tc,function(n,t,e,u,i,o,a,c,s,l){return[t,e,u,i,o,a,c,s||"."+(r-2*("%"===l)),l].join("")}):",."+r+"f")}function fi(n,t,e,r){function u(n){return(e?Math.log(0>n?0:n):-Math.log(n>0?0:-n))/Math.log(t)}function i(n){return e?Math.pow(t,n):-Math.pow(t,-n)}function o(t){return n(u(t))}return o.invert=function(t){return i(n.invert(t))},o.domain=function(t){return arguments.length?(e=t[0]>=0,n.domain((r=t.map(Number)).map(u)),o):r},o.base=function(e){return arguments.length?(t=+e,n.domain(r.map(u)),o):t},o.nice=function(){var t=ei(r.map(u),e?Math:cs);return n.domain(t),r=t.map(i),o},o.ticks=function(){var n=Qu(r),o=[],a=n[0],c=n[1],s=Math.floor(u(a)),l=Math.ceil(u(c)),f=t%1?2:t;if(isFinite(l-s)){if(e){for(;l>s;s++)for(var h=1;f>h;h++)o.push(i(s)*h);o.push(i(s))}else for(o.push(i(s));s++<l;)for(var h=f-1;h>0;h--)o.push(i(s)*h);for(s=0;o[s]<a;s++);for(l=o.length;o[l-1]>c;l--);o=o.slice(s,l)}return o},o.tickFormat=function(n,t){if(!arguments.length)return as;arguments.length<2?t=as:"function"!=typeof t&&(t=Zo.format(t));var r,a=Math.max(.1,n/o.ticks().length),c=e?(r=1e-12,Math.ceil):(r=-1e-12,Math.floor);return function(n){return n/i(c(u(n)+r))<=a?t(n):""}},o.copy=function(){return fi(n.copy(),t,e,r)},oi(o,n)}function hi(n,t,e){function r(t){return n(u(t))}var u=gi(t),i=gi(1/t);return r.invert=function(t){return i(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain((e=t.map(Number)).map(u)),r):e},r.ticks=function(n){return si(e,n)},r.tickFormat=function(n,t){return li(e,n,t)},r.nice=function(n){return r.domain(ai(e,n))},r.exponent=function(o){return arguments.length?(u=gi(t=o),i=gi(1/t),n.domain(e.map(u)),r):t},r.copy=function(){return hi(n.copy(),t,e)},oi(r,n)}function gi(n){return function(t){return 0>t?-Math.pow(-t,n):Math.pow(t,n)}}function pi(n,t){function e(e){return o[((i.get(e)||"range"===t.t&&i.set(e,n.push(e)))-1)%o.length]}function r(t,e){return Zo.range(n.length).map(function(n){return t+e*n})}var i,o,a;return e.domain=function(r){if(!arguments.length)return n;n=[],i=new u;for(var o,a=-1,c=r.length;++a<c;)i.has(o=r[a])||i.set(o,n.push(o));return e[t.t].apply(e,t.a)},e.range=function(n){return arguments.length?(o=n,a=0,t={t:"range",a:arguments},e):o},e.rangePoints=function(u,i){arguments.length<2&&(i=0);var c=u[0],s=u[1],l=(s-c)/(Math.max(1,n.length-1)+i);return o=r(n.length<2?(c+s)/2:c+l*i/2,l),a=0,t={t:"rangePoints",a:arguments},e},e.rangeBands=function(u,i,c){arguments.length<2&&(i=0),arguments.length<3&&(c=i);var s=u[1]<u[0],l=u[s-0],f=u[1-s],h=(f-l)/(n.length-i+2*c);return o=r(l+h*c,h),s&&o.reverse(),a=h*(1-i),t={t:"rangeBands",a:arguments},e},e.rangeRoundBands=function(u,i,c){arguments.length<2&&(i=0),arguments.length<3&&(c=i);var s=u[1]<u[0],l=u[s-0],f=u[1-s],h=Math.floor((f-l)/(n.length-i+2*c)),g=f-l-(n.length-i)*h;return o=r(l+Math.round(g/2),h),s&&o.reverse(),a=Math.round(h*(1-i)),t={t:"rangeRoundBands",a:arguments},e},e.rangeBand=function(){return a},e.rangeExtent=function(){return Qu(t.a[0])},e.copy=function(){return pi(n,t)},e.domain(n)}function vi(n,t){function e(){var e=0,i=t.length;for(u=[];++e<i;)u[e-1]=Zo.quantile(n,e/i);return r}function r(n){return isNaN(n=+n)?void 0:t[Zo.bisect(u,n)]}var u;return r.domain=function(t){return arguments.length?(n=t.filter(function(n){return!isNaN(n)}).sort(Zo.ascending),e()):n},r.range=function(n){return arguments.length?(t=n,e()):t},r.quantiles=function(){return u},r.invertExtent=function(e){return e=t.indexOf(e),0>e?[0/0,0/0]:[e>0?u[e-1]:n[0],e<u.length?u[e]:n[n.length-1]]},r.copy=function(){return vi(n,t)},e()}function di(n,t,e){function r(t){return e[Math.max(0,Math.min(o,Math.floor(i*(t-n))))]}function u(){return i=e.length/(t-n),o=e.length-1,r}var i,o;return r.domain=function(e){return arguments.length?(n=+e[0],t=+e[e.length-1],u()):[n,t]},r.range=function(n){return arguments.length?(e=n,u()):e},r.invertExtent=function(t){return t=e.indexOf(t),t=0>t?0/0:t/i+n,[t,t+1/i]},r.copy=function(){return di(n,t,e)},u()}function mi(n,t){function e(e){return e>=e?t[Zo.bisect(n,e)]:void 0}return e.domain=function(t){return arguments.length?(n=t,e):n},e.range=function(n){return arguments.length?(t=n,e):t},e.invertExtent=function(e){return e=t.indexOf(e),[n[e-1],n[e]]},e.copy=function(){return mi(n,t)},e}function yi(n){function t(n){return+n}return t.invert=t,t.domain=t.range=function(e){return arguments.length?(n=e.map(t),t):n},t.ticks=function(t){return si(n,t)},t.tickFormat=function(t,e){return li(n,t,e)},t.copy=function(){return yi(n)},t}function xi(n){return n.innerRadius}function Mi(n){return n.outerRadius}function _i(n){return n.startAngle}function bi(n){return n.endAngle}function wi(n){function t(t){function o(){s.push("M",i(n(l),a))}for(var c,s=[],l=[],f=-1,h=t.length,g=pt(e),p=pt(r);++f<h;)u.call(this,c=t[f],f)?l.push([+g.call(this,c,f),+p.call(this,c,f)]):l.length&&(o(),l=[]);return l.length&&o(),s.length?s.join(""):null}var e=Ie,r=Ze,u=Zt,i=Si,o=i.key,a=.7;return t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t.defined=function(n){return arguments.length?(u=n,t):u},t.interpolate=function(n){return arguments.length?(o="function"==typeof n?i=n:(i=vs.get(n)||Si).key,t):o},t.tension=function(n){return arguments.length?(a=n,t):a},t}function Si(n){return n.join("L")}function ki(n){return Si(n)+"Z"}function Ei(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("H",(r[0]+(r=n[t])[0])/2,"V",r[1]);return e>1&&u.push("H",r[0]),u.join("")}function Ai(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("V",(r=n[t])[1],"H",r[0]);return u.join("")}function Ci(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("H",(r=n[t])[0],"V",r[1]);return u.join("")}function Ni(n,t){return n.length<4?Si(n):n[1]+qi(n.slice(1,n.length-1),zi(n,t))}function Li(n,t){return n.length<3?Si(n):n[0]+qi((n.push(n[0]),n),zi([n[n.length-2]].concat(n,[n[1]]),t))}function Ti(n,t){return n.length<3?Si(n):n[0]+qi(n,zi(n,t))}function qi(n,t){if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return Si(n);var e=n.length!=t.length,r="",u=n[0],i=n[1],o=t[0],a=o,c=1;if(e&&(r+="Q"+(i[0]-2*o[0]/3)+","+(i[1]-2*o[1]/3)+","+i[0]+","+i[1],u=n[1],c=2),t.length>1){a=t[1],i=n[c],c++,r+="C"+(u[0]+o[0])+","+(u[1]+o[1])+","+(i[0]-a[0])+","+(i[1]-a[1])+","+i[0]+","+i[1];for(var s=2;s<t.length;s++,c++)i=n[c],a=t[s],r+="S"+(i[0]-a[0])+","+(i[1]-a[1])+","+i[0]+","+i[1]}if(e){var l=n[c];r+="Q"+(i[0]+2*a[0]/3)+","+(i[1]+2*a[1]/3)+","+l[0]+","+l[1]}return r}function zi(n,t){for(var e,r=[],u=(1-t)/2,i=n[0],o=n[1],a=1,c=n.length;++a<c;)e=i,i=o,o=n[a],r.push([u*(o[0]-e[0]),u*(o[1]-e[1])]);return r}function Ri(n){if(n.length<3)return Si(n);var t=1,e=n.length,r=n[0],u=r[0],i=r[1],o=[u,u,u,(r=n[1])[0]],a=[i,i,i,r[1]],c=[u,",",i,"L",ji(ys,o),",",ji(ys,a)];for(n.push(n[e-1]);++t<=e;)r=n[t],o.shift(),o.push(r[0]),a.shift(),a.push(r[1]),Hi(c,o,a);return n.pop(),c.push("L",r),c.join("")}function Di(n){if(n.length<4)return Si(n);for(var t,e=[],r=-1,u=n.length,i=[0],o=[0];++r<3;)t=n[r],i.push(t[0]),o.push(t[1]);for(e.push(ji(ys,i)+","+ji(ys,o)),--r;++r<u;)t=n[r],i.shift(),i.push(t[0]),o.shift(),o.push(t[1]),Hi(e,i,o);return e.join("")}function Pi(n){for(var t,e,r=-1,u=n.length,i=u+4,o=[],a=[];++r<4;)e=n[r%u],o.push(e[0]),a.push(e[1]);for(t=[ji(ys,o),",",ji(ys,a)],--r;++r<i;)e=n[r%u],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),Hi(t,o,a);return t.join("")}function Ui(n,t){var e=n.length-1;if(e)for(var r,u,i=n[0][0],o=n[0][1],a=n[e][0]-i,c=n[e][1]-o,s=-1;++s<=e;)r=n[s],u=s/e,r[0]=t*r[0]+(1-t)*(i+u*a),r[1]=t*r[1]+(1-t)*(o+u*c);return Ri(n)}function ji(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function Hi(n,t,e){n.push("C",ji(ds,t),",",ji(ds,e),",",ji(ms,t),",",ji(ms,e),",",ji(ys,t),",",ji(ys,e))}function Fi(n,t){return(t[1]-n[1])/(t[0]-n[0])}function Oi(n){for(var t=0,e=n.length-1,r=[],u=n[0],i=n[1],o=r[0]=Fi(u,i);++t<e;)r[t]=(o+(o=Fi(u=i,i=n[t+1])))/2;return r[t]=o,r}function Yi(n){for(var t,e,r,u,i=[],o=Oi(n),a=-1,c=n.length-1;++a<c;)t=Fi(n[a],n[a+1]),ua(t)<ka?o[a]=o[a+1]=0:(e=o[a]/t,r=o[a+1]/t,u=e*e+r*r,u>9&&(u=3*t/Math.sqrt(u),o[a]=u*e,o[a+1]=u*r));for(a=-1;++a<=c;)u=(n[Math.min(c,a+1)][0]-n[Math.max(0,a-1)][0])/(6*(1+o[a]*o[a])),i.push([u||0,o[a]*u||0]);return i}function Ii(n){return n.length<3?Si(n):n[0]+qi(n,Yi(n))}function Zi(n){for(var t,e,r,u=-1,i=n.length;++u<i;)t=n[u],e=t[0],r=t[1]+gs,t[0]=e*Math.cos(r),t[1]=e*Math.sin(r);return n}function Vi(n){function t(t){function c(){v.push("M",a(n(m),f),l,s(n(d.reverse()),f),"Z")}for(var h,g,p,v=[],d=[],m=[],y=-1,x=t.length,M=pt(e),_=pt(u),b=e===r?function(){return g}:pt(r),w=u===i?function(){return p}:pt(i);++y<x;)o.call(this,h=t[y],y)?(d.push([g=+M.call(this,h,y),p=+_.call(this,h,y)]),m.push([+b.call(this,h,y),+w.call(this,h,y)])):d.length&&(c(),d=[],m=[]);return d.length&&c(),v.length?v.join(""):null}var e=Ie,r=Ie,u=0,i=Ze,o=Zt,a=Si,c=a.key,s=a,l="L",f=.7;return t.x=function(n){return arguments.length?(e=r=n,t):r},t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(u=i=n,t):i},t.y0=function(n){return arguments.length?(u=n,t):u},t.y1=function(n){return arguments.length?(i=n,t):i},t.defined=function(n){return arguments.length?(o=n,t):o},t.interpolate=function(n){return arguments.length?(c="function"==typeof n?a=n:(a=vs.get(n)||Si).key,s=a.reverse||a,l=a.closed?"M":"L",t):c},t.tension=function(n){return arguments.length?(f=n,t):f},t}function Xi(n){return n.radius}function $i(n){return[n.x,n.y]}function Bi(n){return function(){var t=n.apply(this,arguments),e=t[0],r=t[1]+gs;return[e*Math.cos(r),e*Math.sin(r)]}}function Wi(){return 64}function Ji(){return"circle"}function Gi(n){var t=Math.sqrt(n/ba);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Ki(n,t){return sa(n,Ss),n.id=t,n}function Qi(n,t,e,r){var u=n.id;return C(n,"function"==typeof e?function(n,i,o){n.__transition__[u].tween.set(t,r(e.call(n,n.__data__,i,o)))}:(e=r(e),function(n){n.__transition__[u].tween.set(t,e)}))}function no(n){return null==n&&(n=""),function(){this.textContent=n}}function to(n,t,e,r){var i=n.__transition__||(n.__transition__={active:0,count:0}),o=i[e];if(!o){var a=r.time;o=i[e]={tween:new u,time:a,ease:r.ease,delay:r.delay,duration:r.duration},++i.count,Zo.timer(function(r){function u(r){return i.active>e?s():(i.active=e,o.event&&o.event.start.call(n,l,t),o.tween.forEach(function(e,r){(r=r.call(n,l,t))&&v.push(r)}),Zo.timer(function(){return p.c=c(r||1)?Zt:c,1},0,a),void 0)}function c(r){if(i.active!==e)return s();for(var u=r/g,a=f(u),c=v.length;c>0;)v[--c].call(n,a);return u>=1?(o.event&&o.event.end.call(n,l,t),s()):void 0}function s(){return--i.count?delete i[e]:delete n.__transition__,1}var l=n.__data__,f=o.ease,h=o.delay,g=o.duration,p=Ba,v=[];return p.t=h+a,r>=h?u(r-h):(p.c=u,void 0)},0,a)}}function eo(n,t){n.attr("transform",function(n){return"translate("+t(n)+",0)"})}function ro(n,t){n.attr("transform",function(n){return"translate(0,"+t(n)+")"})}function uo(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function io(n,t,e){function r(t){var e=n(t),r=i(e,1);return r-t>t-e?e:r}function u(e){return t(e=n(new Ts(e-1)),1),e}function i(n,e){return t(n=new Ts(+n),e),n}function o(n,r,i){var o=u(n),a=[];if(i>1)for(;r>o;)e(o)%i||a.push(new Date(+o)),t(o,1);else for(;r>o;)a.push(new Date(+o)),t(o,1);return a}function a(n,t,e){try{Ts=uo;var r=new uo;return r._=n,o(r,t,e)}finally{Ts=Date}}n.floor=n,n.round=r,n.ceil=u,n.offset=i,n.range=o;var c=n.utc=oo(n);return c.floor=c,c.round=oo(r),c.ceil=oo(u),c.offset=oo(i),c.range=a,n}function oo(n){return function(t,e){try{Ts=uo;var r=new uo;return r._=t,n(r,e)._}finally{Ts=Date}}}function ao(n){function t(t){for(var r,u,i,o=[],a=-1,c=0;++a<e;)37===n.charCodeAt(a)&&(o.push(n.substring(c,a)),null!=(u=Js[r=n.charAt(++a)])&&(r=n.charAt(++a)),(i=Gs[r])&&(r=i(t,null==u?"e"===r?" ":"0":u)),o.push(r),c=a+1);return o.push(n.substring(c,a)),o.join("")}var e=n.length;return t.parse=function(t){var e={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},r=co(e,n,t,0);if(r!=t.length)return null;"p"in e&&(e.H=e.H%12+12*e.p);var u=null!=e.Z&&Ts!==uo,i=new(u?uo:Ts);return"j"in e?i.setFullYear(e.y,0,e.j):"w"in e&&("W"in e||"U"in e)?(i.setFullYear(e.y,0,1),i.setFullYear(e.y,0,"W"in e?(e.w+6)%7+7*e.W-(i.getDay()+5)%7:e.w+7*e.U-(i.getDay()+6)%7)):i.setFullYear(e.y,e.m,e.d),i.setHours(e.H+Math.floor(e.Z/100),e.M+e.Z%100,e.S,e.L),u?i._:i},t.toString=function(){return n},t}function co(n,t,e,r){for(var u,i,o,a=0,c=t.length,s=e.length;c>a;){if(r>=s)return-1;if(u=t.charCodeAt(a++),37===u){if(o=t.charAt(a++),i=Ks[o in Js?t.charAt(a++):o],!i||(r=i(n,e,r))<0)return-1}else if(u!=e.charCodeAt(r++))return-1}return r}function so(n){return new RegExp("^(?:"+n.map(Zo.requote).join("|")+")","i")}function lo(n){for(var t=new u,e=-1,r=n.length;++e<r;)t.set(n[e].toLowerCase(),e);return t}function fo(n,t,e){var r=0>n?"-":"",u=(r?-n:n)+"",i=u.length;return r+(e>i?new Array(e-i+1).join(t)+u:u)}function ho(n,t,e){Is.lastIndex=0;var r=Is.exec(t.substring(e));return r?(n.w=Zs.get(r[0].toLowerCase()),e+r[0].length):-1}function go(n,t,e){Os.lastIndex=0;var r=Os.exec(t.substring(e));return r?(n.w=Ys.get(r[0].toLowerCase()),e+r[0].length):-1}function po(n,t,e){Qs.lastIndex=0;var r=Qs.exec(t.substring(e,e+1));return r?(n.w=+r[0],e+r[0].length):-1}function vo(n,t,e){Qs.lastIndex=0;var r=Qs.exec(t.substring(e));return r?(n.U=+r[0],e+r[0].length):-1}function mo(n,t,e){Qs.lastIndex=0;var r=Qs.exec(t.substring(e));return r?(n.W=+r[0],e+r[0].length):-1}function yo(n,t,e){$s.lastIndex=0;var r=$s.exec(t.substring(e));return r?(n.m=Bs.get(r[0].toLowerCase()),e+r[0].length):-1}function xo(n,t,e){Vs.lastIndex=0;var r=Vs.exec(t.substring(e));return r?(n.m=Xs.get(r[0].toLowerCase()),e+r[0].length):-1}function Mo(n,t,e){return co(n,Gs.c.toString(),t,e)}function _o(n,t,e){return co(n,Gs.x.toString(),t,e)}function bo(n,t,e){return co(n,Gs.X.toString(),t,e)}function wo(n,t,e){Qs.lastIndex=0;var r=Qs.exec(t.substring(e,e+4));return r?(n.y=+r[0],e+r[0].length):-1}function So(n,t,e){Qs.lastIndex=0;var r=Qs.exec(t.substring(e,e+2));return r?(n.y=Eo(+r[0]),e+r[0].length):-1}function ko(n,t,e){return/^[+-]\d{4}$/.test(t=t.substring(e,e+5))?(n.Z=+t,e+5):-1}function Eo(n){return n+(n>68?1900:2e3)}function Ao(n,t,e){Qs.lastIndex=0;var r=Qs.exec(t.substring(e,e+2));return r?(n.m=r[0]-1,e+r[0].length):-1}function Co(n,t,e){Qs.lastIndex=0;var r=Qs.exec(t.substring(e,e+2));return r?(n.d=+r[0],e+r[0].length):-1}function No(n,t,e){Qs.lastIndex=0;var r=Qs.exec(t.substring(e,e+3));return r?(n.j=+r[0],e+r[0].length):-1}function Lo(n,t,e){Qs.lastIndex=0;var r=Qs.exec(t.substring(e,e+2));return r?(n.H=+r[0],e+r[0].length):-1}function To(n,t,e){Qs.lastIndex=0;var r=Qs.exec(t.substring(e,e+2));return r?(n.M=+r[0],e+r[0].length):-1}function qo(n,t,e){Qs.lastIndex=0;var r=Qs.exec(t.substring(e,e+2));return r?(n.S=+r[0],e+r[0].length):-1}function zo(n,t,e){Qs.lastIndex=0;var r=Qs.exec(t.substring(e,e+3));return r?(n.L=+r[0],e+r[0].length):-1}function Ro(n,t,e){var r=nl.get(t.substring(e,e+=2).toLowerCase());return null==r?-1:(n.p=r,e)}function Do(n){var t=n.getTimezoneOffset(),e=t>0?"-":"+",r=~~(ua(t)/60),u=ua(t)%60;return e+fo(r,"0",2)+fo(u,"0",2)}function Po(n,t,e){Ws.lastIndex=0;var r=Ws.exec(t.substring(e,e+1));return r?e+r[0].length:-1}function Uo(n){function t(n){try{Ts=uo;var t=new Ts;return t._=n,e(t)}finally{Ts=Date}}var e=ao(n);return t.parse=function(n){try{Ts=uo;var t=e.parse(n);return t&&t._}finally{Ts=Date}},t.toString=e.toString,t}function jo(n){return n.toISOString()}function Ho(n,t,e){function r(t){return n(t)}function u(n,e){var r=n[1]-n[0],u=r/e,i=Zo.bisect(el,u);return i==el.length?[t.year,ci(n.map(function(n){return n/31536e6}),e)[2]]:i?t[u/el[i-1]<el[i]/u?i-1:i]:[ol,ci(n,e)[2]]}return r.invert=function(t){return Fo(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain(t),r):n.domain().map(Fo)},r.nice=function(n,t){function e(e){return!isNaN(e)&&!n.range(e,Fo(+e+1),t).length}var i=r.domain(),o=Qu(i),a=null==n?u(o,10):"number"==typeof n&&u(o,n);return a&&(n=a[0],t=a[1]),r.domain(ei(i,t>1?{floor:function(t){for(;e(t=n.floor(t));)t=Fo(t-1);return t},ceil:function(t){for(;e(t=n.ceil(t));)t=Fo(+t+1);return t}}:n))},r.ticks=function(n,t){var e=Qu(r.domain()),i=null==n?u(e,10):"number"==typeof n?u(e,n):!n.range&&[{range:n},t];return i&&(n=i[0],t=i[1]),n.range(e[0],Fo(+e[1]+1),1>t?1:t)},r.tickFormat=function(){return e},r.copy=function(){return Ho(n.copy(),t,e)},oi(r,n)}function Fo(n){return new Date(n)}function Oo(n){return function(t){for(var e=n.length-1,r=n[e];!r[1](t);)r=n[--e];return r[0](t)}}function Yo(n){return JSON.parse(n.responseText)}function Io(n){var t=$o.createRange();return t.selectNode($o.body),t.createContextualFragment(n.responseText)}var Zo={version:"3.3.8"};Date.now||(Date.now=function(){return+new Date});var Vo=[].slice,Xo=function(n){return Vo.call(n)},$o=document,Bo=$o.documentElement,Wo=window;try{Xo(Bo.childNodes)[0].nodeType}catch(Jo){Xo=function(n){for(var t=n.length,e=new Array(t);t--;)e[t]=n[t];return e}}try{$o.createElement("div").style.setProperty("opacity",0,"")}catch(Go){var Ko=Wo.Element.prototype,Qo=Ko.setAttribute,na=Ko.setAttributeNS,ta=Wo.CSSStyleDeclaration.prototype,ea=ta.setProperty;Ko.setAttribute=function(n,t){Qo.call(this,n,t+"")},Ko.setAttributeNS=function(n,t,e){na.call(this,n,t,e+"")},ta.setProperty=function(n,t,e){ea.call(this,n,t+"",e)}}Zo.ascending=function(n,t){return t>n?-1:n>t?1:n>=t?0:0/0},Zo.descending=function(n,t){return n>t?-1:t>n?1:t>=n?0:0/0},Zo.min=function(n,t){var e,r,u=-1,i=n.length;if(1===arguments.length){for(;++u<i&&!(null!=(e=n[u])&&e>=e);)e=void 0;for(;++u<i;)null!=(r=n[u])&&e>r&&(e=r)}else{for(;++u<i&&!(null!=(e=t.call(n,n[u],u))&&e>=e);)e=void 0;for(;++u<i;)null!=(r=t.call(n,n[u],u))&&e>r&&(e=r)}return e},Zo.max=function(n,t){var e,r,u=-1,i=n.length;if(1===arguments.length){for(;++u<i&&!(null!=(e=n[u])&&e>=e);)e=void 0;for(;++u<i;)null!=(r=n[u])&&r>e&&(e=r)}else{for(;++u<i&&!(null!=(e=t.call(n,n[u],u))&&e>=e);)e=void 0;for(;++u<i;)null!=(r=t.call(n,n[u],u))&&r>e&&(e=r)}return e},Zo.extent=function(n,t){var e,r,u,i=-1,o=n.length;if(1===arguments.length){for(;++i<o&&!(null!=(e=u=n[i])&&e>=e);)e=u=void 0;for(;++i<o;)null!=(r=n[i])&&(e>r&&(e=r),r>u&&(u=r))}else{for(;++i<o&&!(null!=(e=u=t.call(n,n[i],i))&&e>=e);)e=void 0;for(;++i<o;)null!=(r=t.call(n,n[i],i))&&(e>r&&(e=r),r>u&&(u=r))}return[e,u]},Zo.sum=function(n,t){var e,r=0,u=n.length,i=-1;if(1===arguments.length)for(;++i<u;)isNaN(e=+n[i])||(r+=e);else for(;++i<u;)isNaN(e=+t.call(n,n[i],i))||(r+=e);return r},Zo.mean=function(t,e){var r,u=t.length,i=0,o=-1,a=0;if(1===arguments.length)for(;++o<u;)n(r=t[o])&&(i+=(r-i)/++a);else for(;++o<u;)n(r=e.call(t,t[o],o))&&(i+=(r-i)/++a);return a?i:void 0},Zo.quantile=function(n,t){var e=(n.length-1)*t+1,r=Math.floor(e),u=+n[r-1],i=e-r;return i?u+i*(n[r]-u):u},Zo.median=function(t,e){return arguments.length>1&&(t=t.map(e)),t=t.filter(n),t.length?Zo.quantile(t.sort(Zo.ascending),.5):void 0},Zo.bisector=function(n){return{left:function(t,e,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var i=r+u>>>1;
n.call(t,t[i],i)<e?r=i+1:u=i}return r},right:function(t,e,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var i=r+u>>>1;e<n.call(t,t[i],i)?u=i:r=i+1}return r}}};var ra=Zo.bisector(function(n){return n});Zo.bisectLeft=ra.left,Zo.bisect=Zo.bisectRight=ra.right,Zo.shuffle=function(n){for(var t,e,r=n.length;r;)e=0|Math.random()*r--,t=n[r],n[r]=n[e],n[e]=t;return n},Zo.permute=function(n,t){for(var e=t.length,r=new Array(e);e--;)r[e]=n[t[e]];return r},Zo.pairs=function(n){for(var t,e=0,r=n.length-1,u=n[0],i=new Array(0>r?0:r);r>e;)i[e]=[t=u,u=n[++e]];return i},Zo.zip=function(){if(!(u=arguments.length))return[];for(var n=-1,e=Zo.min(arguments,t),r=new Array(e);++n<e;)for(var u,i=-1,o=r[n]=new Array(u);++i<u;)o[i]=arguments[i][n];return r},Zo.transpose=function(n){return Zo.zip.apply(Zo,n)},Zo.keys=function(n){var t=[];for(var e in n)t.push(e);return t},Zo.values=function(n){var t=[];for(var e in n)t.push(n[e]);return t},Zo.entries=function(n){var t=[];for(var e in n)t.push({key:e,value:n[e]});return t},Zo.merge=function(n){for(var t,e,r,u=n.length,i=-1,o=0;++i<u;)o+=n[i].length;for(e=new Array(o);--u>=0;)for(r=n[u],t=r.length;--t>=0;)e[--o]=r[t];return e};var ua=Math.abs;Zo.range=function(n,t,r){if(arguments.length<3&&(r=1,arguments.length<2&&(t=n,n=0)),1/0===(t-n)/r)throw new Error("infinite range");var u,i=[],o=e(ua(r)),a=-1;if(n*=o,t*=o,r*=o,0>r)for(;(u=n+r*++a)>t;)i.push(u/o);else for(;(u=n+r*++a)<t;)i.push(u/o);return i},Zo.map=function(n){var t=new u;if(n instanceof u)n.forEach(function(n,e){t.set(n,e)});else for(var e in n)t.set(e,n[e]);return t},r(u,{has:function(n){return ia+n in this},get:function(n){return this[ia+n]},set:function(n,t){return this[ia+n]=t},remove:function(n){return n=ia+n,n in this&&delete this[n]},keys:function(){var n=[];return this.forEach(function(t){n.push(t)}),n},values:function(){var n=[];return this.forEach(function(t,e){n.push(e)}),n},entries:function(){var n=[];return this.forEach(function(t,e){n.push({key:t,value:e})}),n},forEach:function(n){for(var t in this)t.charCodeAt(0)===oa&&n.call(this,t.substring(1),this[t])}});var ia="\x00",oa=ia.charCodeAt(0);Zo.nest=function(){function n(t,a,c){if(c>=o.length)return r?r.call(i,a):e?a.sort(e):a;for(var s,l,f,h,g=-1,p=a.length,v=o[c++],d=new u;++g<p;)(h=d.get(s=v(l=a[g])))?h.push(l):d.set(s,[l]);return t?(l=t(),f=function(e,r){l.set(e,n(t,r,c))}):(l={},f=function(e,r){l[e]=n(t,r,c)}),d.forEach(f),l}function t(n,e){if(e>=o.length)return n;var r=[],u=a[e++];return n.forEach(function(n,u){r.push({key:n,values:t(u,e)})}),u?r.sort(function(n,t){return u(n.key,t.key)}):r}var e,r,i={},o=[],a=[];return i.map=function(t,e){return n(e,t,0)},i.entries=function(e){return t(n(Zo.map,e,0),0)},i.key=function(n){return o.push(n),i},i.sortKeys=function(n){return a[o.length-1]=n,i},i.sortValues=function(n){return e=n,i},i.rollup=function(n){return r=n,i},i},Zo.set=function(n){var t=new i;if(n)for(var e=0,r=n.length;r>e;++e)t.add(n[e]);return t},r(i,{has:function(n){return ia+n in this},add:function(n){return this[ia+n]=!0,n},remove:function(n){return n=ia+n,n in this&&delete this[n]},values:function(){var n=[];return this.forEach(function(t){n.push(t)}),n},forEach:function(n){for(var t in this)t.charCodeAt(0)===oa&&n.call(this,t.substring(1))}}),Zo.behavior={},Zo.rebind=function(n,t){for(var e,r=1,u=arguments.length;++r<u;)n[e=arguments[r]]=o(n,t,t[e]);return n};var aa=["webkit","ms","moz","Moz","o","O"];Zo.dispatch=function(){for(var n=new s,t=-1,e=arguments.length;++t<e;)n[arguments[t]]=l(n);return n},s.prototype.on=function(n,t){var e=n.indexOf("."),r="";if(e>=0&&(r=n.substring(e+1),n=n.substring(0,e)),n)return arguments.length<2?this[n].on(r):this[n].on(r,t);if(2===arguments.length){if(null==t)for(n in this)this.hasOwnProperty(n)&&this[n].on(r,null);return this}},Zo.event=null,Zo.requote=function(n){return n.replace(ca,"\\$&")};var ca=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,sa={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)n[e]=t[e]},la=function(n,t){return t.querySelector(n)},fa=function(n,t){return t.querySelectorAll(n)},ha=Bo[a(Bo,"matchesSelector")],ga=function(n,t){return ha.call(n,t)};"function"==typeof Sizzle&&(la=function(n,t){return Sizzle(n,t)[0]||null},fa=function(n,t){return Sizzle.uniqueSort(Sizzle(n,t))},ga=Sizzle.matchesSelector),Zo.selection=function(){return ma};var pa=Zo.selection.prototype=[];pa.select=function(n){var t,e,r,u,i=[];n=v(n);for(var o=-1,a=this.length;++o<a;){i.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var c=-1,s=r.length;++c<s;)(u=r[c])?(t.push(e=n.call(u,u.__data__,c,o)),e&&"__data__"in u&&(e.__data__=u.__data__)):t.push(null)}return p(i)},pa.selectAll=function(n){var t,e,r=[];n=d(n);for(var u=-1,i=this.length;++u<i;)for(var o=this[u],a=-1,c=o.length;++a<c;)(e=o[a])&&(r.push(t=Xo(n.call(e,e.__data__,a,u))),t.parentNode=e);return p(r)};var va={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Zo.ns={prefix:va,qualify:function(n){var t=n.indexOf(":"),e=n;return t>=0&&(e=n.substring(0,t),n=n.substring(t+1)),va.hasOwnProperty(e)?{space:va[e],local:n}:n}},pa.attr=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node();return n=Zo.ns.qualify(n),n.local?e.getAttributeNS(n.space,n.local):e.getAttribute(n)}for(t in n)this.each(m(t,n[t]));return this}return this.each(m(n,t))},pa.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node(),r=(n=n.trim().split(/^|\s+/g)).length,u=-1;if(t=e.classList){for(;++u<r;)if(!t.contains(n[u]))return!1}else for(t=e.getAttribute("class");++u<r;)if(!x(n[u]).test(t))return!1;return!0}for(t in n)this.each(M(t,n[t]));return this}return this.each(M(n,t))},pa.style=function(n,t,e){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t="");for(e in n)this.each(b(e,n[e],t));return this}if(2>r)return Wo.getComputedStyle(this.node(),null).getPropertyValue(n);e=""}return this.each(b(n,t,e))},pa.property=function(n,t){if(arguments.length<2){if("string"==typeof n)return this.node()[n];for(t in n)this.each(w(t,n[t]));return this}return this.each(w(n,t))},pa.text=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}:null==n?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent},pa.html=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}:null==n?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML},pa.append=function(n){return n=S(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})},pa.insert=function(n,t){return n=S(n),t=v(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments)||null)})},pa.remove=function(){return this.each(function(){var n=this.parentNode;n&&n.removeChild(this)})},pa.data=function(n,t){function e(n,e){var r,i,o,a=n.length,f=e.length,h=Math.min(a,f),g=new Array(f),p=new Array(f),v=new Array(a);if(t){var d,m=new u,y=new u,x=[];for(r=-1;++r<a;)d=t.call(i=n[r],i.__data__,r),m.has(d)?v[r]=i:m.set(d,i),x.push(d);for(r=-1;++r<f;)d=t.call(e,o=e[r],r),(i=m.get(d))?(g[r]=i,i.__data__=o):y.has(d)||(p[r]=k(o)),y.set(d,o),m.remove(d);for(r=-1;++r<a;)m.has(x[r])&&(v[r]=n[r])}else{for(r=-1;++r<h;)i=n[r],o=e[r],i?(i.__data__=o,g[r]=i):p[r]=k(o);for(;f>r;++r)p[r]=k(e[r]);for(;a>r;++r)v[r]=n[r]}p.update=g,p.parentNode=g.parentNode=v.parentNode=n.parentNode,c.push(p),s.push(g),l.push(v)}var r,i,o=-1,a=this.length;if(!arguments.length){for(n=new Array(a=(r=this[0]).length);++o<a;)(i=r[o])&&(n[o]=i.__data__);return n}var c=N([]),s=p([]),l=p([]);if("function"==typeof n)for(;++o<a;)e(r=this[o],n.call(r,r.parentNode.__data__,o));else for(;++o<a;)e(r=this[o],n);return s.enter=function(){return c},s.exit=function(){return l},s},pa.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")},pa.filter=function(n){var t,e,r,u=[];"function"!=typeof n&&(n=E(n));for(var i=0,o=this.length;o>i;i++){u.push(t=[]),t.parentNode=(e=this[i]).parentNode;for(var a=0,c=e.length;c>a;a++)(r=e[a])&&n.call(r,r.__data__,a)&&t.push(r)}return p(u)},pa.order=function(){for(var n=-1,t=this.length;++n<t;)for(var e,r=this[n],u=r.length-1,i=r[u];--u>=0;)(e=r[u])&&(i&&i!==e.nextSibling&&i.parentNode.insertBefore(e,i),i=e);return this},pa.sort=function(n){n=A.apply(this,arguments);for(var t=-1,e=this.length;++t<e;)this[t].sort(n);return this.order()},pa.each=function(n){return C(this,function(t,e,r){n.call(t,t.__data__,e,r)})},pa.call=function(n){var t=Xo(arguments);return n.apply(t[0]=this,t),this},pa.empty=function(){return!this.node()},pa.node=function(){for(var n=0,t=this.length;t>n;n++)for(var e=this[n],r=0,u=e.length;u>r;r++){var i=e[r];if(i)return i}return null},pa.size=function(){var n=0;return this.each(function(){++n}),n};var da=[];Zo.selection.enter=N,Zo.selection.enter.prototype=da,da.append=pa.append,da.empty=pa.empty,da.node=pa.node,da.call=pa.call,da.size=pa.size,da.select=function(n){for(var t,e,r,u,i,o=[],a=-1,c=this.length;++a<c;){r=(u=this[a]).update,o.push(t=[]),t.parentNode=u.parentNode;for(var s=-1,l=u.length;++s<l;)(i=u[s])?(t.push(r[s]=e=n.call(u.parentNode,i.__data__,s,a)),e.__data__=i.__data__):t.push(null)}return p(o)},da.insert=function(n,t){return arguments.length<2&&(t=L(this)),pa.insert.call(this,n,t)},pa.transition=function(){for(var n,t,e=Ms||++ks,r=[],u=_s||{time:Date.now(),ease:jr,delay:0,duration:250},i=-1,o=this.length;++i<o;){r.push(n=[]);for(var a=this[i],c=-1,s=a.length;++c<s;)(t=a[c])&&to(t,c,e,u),n.push(t)}return Ki(r,e)},pa.interrupt=function(){return this.each(T)},Zo.select=function(n){var t=["string"==typeof n?la(n,$o):n];return t.parentNode=Bo,p([t])},Zo.selectAll=function(n){var t=Xo("string"==typeof n?fa(n,$o):n);return t.parentNode=Bo,p([t])};var ma=Zo.select(Bo);pa.on=function(n,t,e){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t=!1);for(e in n)this.each(q(e,n[e],t));return this}if(2>r)return(r=this.node()["__on"+n])&&r._;e=!1}return this.each(q(n,t,e))};var ya=Zo.map({mouseenter:"mouseover",mouseleave:"mouseout"});ya.forEach(function(n){"on"+n in $o&&ya.remove(n)});var xa=a(Bo.style,"userSelect"),Ma=0;Zo.mouse=function(n){return P(n,h())};var _a=/WebKit/.test(Wo.navigator.userAgent)?-1:0;Zo.touches=function(n,t){return arguments.length<2&&(t=h().touches),t?Xo(t).map(function(t){var e=P(n,t);return e.identifier=t.identifier,e}):[]},Zo.behavior.drag=function(){function n(){this.on("mousedown.drag",o).on("touchstart.drag",a)}function t(){return Zo.event.changedTouches[0].identifier}function e(n,t){return Zo.touches(n).filter(function(n){return n.identifier===t})[0]}function r(n,t,e,r){return function(){function o(){var n=t(l,g),e=n[0]-v[0],r=n[1]-v[1];d|=e|r,v=n,f({type:"drag",x:n[0]+c[0],y:n[1]+c[1],dx:e,dy:r})}function a(){m.on(e+"."+p,null).on(r+"."+p,null),y(d&&Zo.event.target===h),f({type:"dragend"})}var c,s=this,l=s.parentNode,f=u.of(s,arguments),h=Zo.event.target,g=n(),p=null==g?"drag":"drag-"+g,v=t(l,g),d=0,m=Zo.select(Wo).on(e+"."+p,o).on(r+"."+p,a),y=D();i?(c=i.apply(s,arguments),c=[c.x-v[0],c.y-v[1]]):c=[0,0],f({type:"dragstart"})}}var u=g(n,"drag","dragstart","dragend"),i=null,o=r(c,Zo.mouse,"mousemove","mouseup"),a=r(t,e,"touchmove","touchend");return n.origin=function(t){return arguments.length?(i=t,n):i},Zo.rebind(n,u,"on")};var ba=Math.PI,wa=2*ba,Sa=ba/2,ka=1e-6,Ea=ka*ka,Aa=ba/180,Ca=180/ba,Na=Math.SQRT2,La=2,Ta=4;Zo.interpolateZoom=function(n,t){function e(n){var t=n*y;if(m){var e=O(v),o=i/(La*h)*(e*Y(Na*t+v)-F(v));return[r+o*s,u+o*l,i*e/O(Na*t+v)]}return[r+n*s,u+n*l,i*Math.exp(Na*t)]}var r=n[0],u=n[1],i=n[2],o=t[0],a=t[1],c=t[2],s=o-r,l=a-u,f=s*s+l*l,h=Math.sqrt(f),g=(c*c-i*i+Ta*f)/(2*i*La*h),p=(c*c-i*i-Ta*f)/(2*c*La*h),v=Math.log(Math.sqrt(g*g+1)-g),d=Math.log(Math.sqrt(p*p+1)-p),m=d-v,y=(m||Math.log(c/i))/Na;return e.duration=1e3*y,e},Zo.behavior.zoom=function(){function n(n){n.on(A,s).on(Ra+".zoom",h).on(C,p).on("dblclick.zoom",v).on(L,l)}function t(n){return[(n[0]-S.x)/S.k,(n[1]-S.y)/S.k]}function e(n){return[n[0]*S.k+S.x,n[1]*S.k+S.y]}function r(n){S.k=Math.max(E[0],Math.min(E[1],n))}function u(n,t){t=e(t),S.x+=n[0]-t[0],S.y+=n[1]-t[1]}function i(){_&&_.domain(M.range().map(function(n){return(n-S.x)/S.k}).map(M.invert)),w&&w.domain(b.range().map(function(n){return(n-S.y)/S.k}).map(b.invert))}function o(n){n({type:"zoomstart"})}function a(n){i(),n({type:"zoom",scale:S.k,translate:[S.x,S.y]})}function c(n){n({type:"zoomend"})}function s(){function n(){l=1,u(Zo.mouse(r),h),a(i)}function e(){f.on(C,Wo===r?p:null).on(N,null),g(l&&Zo.event.target===s),c(i)}var r=this,i=q.of(r,arguments),s=Zo.event.target,l=0,f=Zo.select(Wo).on(C,n).on(N,e),h=t(Zo.mouse(r)),g=D();T.call(r),o(i)}function l(){function n(){var n=Zo.touches(p);return g=S.k,n.forEach(function(n){n.identifier in d&&(d[n.identifier]=t(n))}),n}function e(){for(var t=Zo.event.changedTouches,e=0,i=t.length;i>e;++e)d[t[e].identifier]=null;var o=n(),c=Date.now();if(1===o.length){if(500>c-x){var s=o[0],l=d[s.identifier];r(2*S.k),u(s,l),f(),a(v)}x=c}else if(o.length>1){var s=o[0],h=o[1],g=s[0]-h[0],p=s[1]-h[1];m=g*g+p*p}}function i(){for(var n,t,e,i,o=Zo.touches(p),c=0,s=o.length;s>c;++c,i=null)if(e=o[c],i=d[e.identifier]){if(t)break;n=e,t=i}if(i){var l=(l=e[0]-n[0])*l+(l=e[1]-n[1])*l,f=m&&Math.sqrt(l/m);n=[(n[0]+e[0])/2,(n[1]+e[1])/2],t=[(t[0]+i[0])/2,(t[1]+i[1])/2],r(f*g)}x=null,u(n,t),a(v)}function h(){if(Zo.event.touches.length){for(var t=Zo.event.changedTouches,e=0,r=t.length;r>e;++e)delete d[t[e].identifier];for(var u in d)return void n()}b.on(M,null).on(_,null),w.on(A,s).on(L,l),k(),c(v)}var g,p=this,v=q.of(p,arguments),d={},m=0,y=Zo.event.changedTouches[0].identifier,M="touchmove.zoom-"+y,_="touchend.zoom-"+y,b=Zo.select(Wo).on(M,i).on(_,h),w=Zo.select(p).on(A,null).on(L,e),k=D();T.call(p),e(),o(v)}function h(){var n=q.of(this,arguments);y?clearTimeout(y):(T.call(this),o(n)),y=setTimeout(function(){y=null,c(n)},50),f();var e=m||Zo.mouse(this);d||(d=t(e)),r(Math.pow(2,.002*qa())*S.k),u(e,d),a(n)}function p(){d=null}function v(){var n=q.of(this,arguments),e=Zo.mouse(this),i=t(e),s=Math.log(S.k)/Math.LN2;o(n),r(Math.pow(2,Zo.event.shiftKey?Math.ceil(s)-1:Math.floor(s)+1)),u(e,i),a(n),c(n)}var d,m,y,x,M,_,b,w,S={x:0,y:0,k:1},k=[960,500],E=za,A="mousedown.zoom",C="mousemove.zoom",N="mouseup.zoom",L="touchstart.zoom",q=g(n,"zoomstart","zoom","zoomend");return n.event=function(n){n.each(function(){var n=q.of(this,arguments),t=S;Ms?Zo.select(this).transition().each("start.zoom",function(){S=this.__chart__||{x:0,y:0,k:1},o(n)}).tween("zoom:zoom",function(){var e=k[0],r=k[1],u=e/2,i=r/2,o=Zo.interpolateZoom([(u-S.x)/S.k,(i-S.y)/S.k,e/S.k],[(u-t.x)/t.k,(i-t.y)/t.k,e/t.k]);return function(t){var r=o(t),c=e/r[2];this.__chart__=S={x:u-r[0]*c,y:i-r[1]*c,k:c},a(n)}}).each("end.zoom",function(){c(n)}):(this.__chart__=S,o(n),a(n),c(n))})},n.translate=function(t){return arguments.length?(S={x:+t[0],y:+t[1],k:S.k},i(),n):[S.x,S.y]},n.scale=function(t){return arguments.length?(S={x:S.x,y:S.y,k:+t},i(),n):S.k},n.scaleExtent=function(t){return arguments.length?(E=null==t?za:[+t[0],+t[1]],n):E},n.center=function(t){return arguments.length?(m=t&&[+t[0],+t[1]],n):m},n.size=function(t){return arguments.length?(k=t&&[+t[0],+t[1]],n):k},n.x=function(t){return arguments.length?(_=t,M=t.copy(),S={x:0,y:0,k:1},n):_},n.y=function(t){return arguments.length?(w=t,b=t.copy(),S={x:0,y:0,k:1},n):w},Zo.rebind(n,q,"on")};var qa,za=[0,1/0],Ra="onwheel"in $o?(qa=function(){return-Zo.event.deltaY*(Zo.event.deltaMode?120:1)},"wheel"):"onmousewheel"in $o?(qa=function(){return Zo.event.wheelDelta},"mousewheel"):(qa=function(){return-Zo.event.detail},"MozMousePixelScroll");Z.prototype.toString=function(){return this.rgb()+""},Zo.hsl=function(n,t,e){return 1===arguments.length?n instanceof X?V(n.h,n.s,n.l):st(""+n,lt,V):V(+n,+t,+e)};var Da=X.prototype=new Z;Da.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),V(this.h,this.s,this.l/n)},Da.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),V(this.h,this.s,n*this.l)},Da.rgb=function(){return $(this.h,this.s,this.l)},Zo.hcl=function(n,t,e){return 1===arguments.length?n instanceof W?B(n.h,n.c,n.l):n instanceof K?nt(n.l,n.a,n.b):nt((n=ft((n=Zo.rgb(n)).r,n.g,n.b)).l,n.a,n.b):B(+n,+t,+e)};var Pa=W.prototype=new Z;Pa.brighter=function(n){return B(this.h,this.c,Math.min(100,this.l+Ua*(arguments.length?n:1)))},Pa.darker=function(n){return B(this.h,this.c,Math.max(0,this.l-Ua*(arguments.length?n:1)))},Pa.rgb=function(){return J(this.h,this.c,this.l).rgb()},Zo.lab=function(n,t,e){return 1===arguments.length?n instanceof K?G(n.l,n.a,n.b):n instanceof W?J(n.l,n.c,n.h):ft((n=Zo.rgb(n)).r,n.g,n.b):G(+n,+t,+e)};var Ua=18,ja=.95047,Ha=1,Fa=1.08883,Oa=K.prototype=new Z;Oa.brighter=function(n){return G(Math.min(100,this.l+Ua*(arguments.length?n:1)),this.a,this.b)},Oa.darker=function(n){return G(Math.max(0,this.l-Ua*(arguments.length?n:1)),this.a,this.b)},Oa.rgb=function(){return Q(this.l,this.a,this.b)},Zo.rgb=function(n,t,e){return 1===arguments.length?n instanceof at?ot(n.r,n.g,n.b):st(""+n,ot,$):ot(~~n,~~t,~~e)};var Ya=at.prototype=new Z;Ya.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var t=this.r,e=this.g,r=this.b,u=30;return t||e||r?(t&&u>t&&(t=u),e&&u>e&&(e=u),r&&u>r&&(r=u),ot(Math.min(255,~~(t/n)),Math.min(255,~~(e/n)),Math.min(255,~~(r/n)))):ot(u,u,u)},Ya.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),ot(~~(n*this.r),~~(n*this.g),~~(n*this.b))},Ya.hsl=function(){return lt(this.r,this.g,this.b)},Ya.toString=function(){return"#"+ct(this.r)+ct(this.g)+ct(this.b)};var Ia=Zo.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Ia.forEach(function(n,t){Ia.set(n,ut(t))}),Zo.functor=pt,Zo.xhr=dt(vt),Zo.dsv=function(n,t){function e(n,e,i){arguments.length<3&&(i=e,e=null);var o=Zo.xhr(n,t,i);return o.row=function(n){return arguments.length?o.response(null==(e=n)?r:u(n)):e},o.row(e)}function r(n){return e.parse(n.responseText)}function u(n){return function(t){return e.parse(t.responseText,n)}}function o(t){return t.map(a).join(n)}function a(n){return c.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var c=new RegExp('["'+n+"\n]"),s=n.charCodeAt(0);return e.parse=function(n,t){var r;return e.parseRows(n,function(n,e){if(r)return r(n,e-1);var u=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");r=t?function(n,e){return t(u(n),e)}:u})},e.parseRows=function(n,t){function e(){if(l>=c)return o;if(u)return u=!1,i;var t=l;if(34===n.charCodeAt(t)){for(var e=t;e++<c;)if(34===n.charCodeAt(e)){if(34!==n.charCodeAt(e+1))break;++e}l=e+2;var r=n.charCodeAt(e+1);return 13===r?(u=!0,10===n.charCodeAt(e+2)&&++l):10===r&&(u=!0),n.substring(t+1,e).replace(/""/g,'"')}for(;c>l;){var r=n.charCodeAt(l++),a=1;if(10===r)u=!0;else if(13===r)u=!0,10===n.charCodeAt(l)&&(++l,++a);else if(r!==s)continue;return n.substring(t,l-a)}return n.substring(t)}for(var r,u,i={},o={},a=[],c=n.length,l=0,f=0;(r=e())!==o;){for(var h=[];r!==i&&r!==o;)h.push(r),r=e();(!t||(h=t(h,f++)))&&a.push(h)}return a},e.format=function(t){if(Array.isArray(t[0]))return e.formatRows(t);var r=new i,u=[];return t.forEach(function(n){for(var t in n)r.has(t)||u.push(r.add(t))}),[u.map(a).join(n)].concat(t.map(function(t){return u.map(function(n){return a(t[n])}).join(n)})).join("\n")},e.formatRows=function(n){return n.map(o).join("\n")},e},Zo.csv=Zo.dsv(",","text/csv"),Zo.tsv=Zo.dsv("	","text/tab-separated-values");var Za,Va,Xa,$a,Ba,Wa=Wo[a(Wo,"requestAnimationFrame")]||function(n){setTimeout(n,17)};Zo.timer=function(n,t,e){var r=arguments.length;2>r&&(t=0),3>r&&(e=Date.now());var u=e+t,i={c:n,t:u,f:!1,n:null};Va?Va.n=i:Za=i,Va=i,Xa||($a=clearTimeout($a),Xa=1,Wa(xt))},Zo.timer.flush=function(){Mt(),_t()};var Ja=".",Ga=",",Ka=[3,3],Qa="$",nc=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(bt);Zo.formatPrefix=function(n,t){var e=0;return n&&(0>n&&(n*=-1),t&&(n=Zo.round(n,wt(n,t))),e=1+Math.floor(1e-12+Math.log(n)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((0>=e?e+1:e-1)/3)))),nc[8+e/3]},Zo.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)},Zo.format=function(n){var t=tc.exec(n),e=t[1]||" ",r=t[2]||">",u=t[3]||"",i=t[4]||"",o=t[5],a=+t[6],c=t[7],s=t[8],l=t[9],f=1,h="",g=!1;switch(s&&(s=+s.substring(1)),(o||"0"===e&&"="===r)&&(o=e="0",r="=",c&&(a-=Math.floor((a-1)/4))),l){case"n":c=!0,l="g";break;case"%":f=100,h="%",l="f";break;case"p":f=100,h="%",l="r";break;case"b":case"o":case"x":case"X":"#"===i&&(i="0"+l.toLowerCase());case"c":case"d":g=!0,s=0;break;case"s":f=-1,l="r"}"#"===i?i="":"$"===i&&(i=Qa),"r"!=l||s||(l="g"),null!=s&&("g"==l?s=Math.max(1,Math.min(21,s)):("e"==l||"f"==l)&&(s=Math.max(0,Math.min(20,s)))),l=ec.get(l)||St;var p=o&&c;return function(n){if(g&&n%1)return"";var t=0>n||0===n&&0>1/n?(n=-n,"-"):u;if(0>f){var v=Zo.formatPrefix(n,s);n=v.scale(n),h=v.symbol}else n*=f;n=l(n,s);var d=n.lastIndexOf("."),m=0>d?n:n.substring(0,d),y=0>d?"":Ja+n.substring(d+1);!o&&c&&(m=rc(m));var x=i.length+m.length+y.length+(p?0:t.length),M=a>x?new Array(x=a-x+1).join(e):"";return p&&(m=rc(M+m)),t+=i,n=m+y,("<"===r?t+n+M:">"===r?M+t+n:"^"===r?M.substring(0,x>>=1)+t+n+M.substring(x):t+(p?n:M+n))+h}};var tc=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ec=Zo.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(n,t){return(n=Zo.round(n,wt(n,t))).toFixed(Math.max(0,Math.min(20,wt(n*(1+1e-15),t))))}}),rc=vt;if(Ka){var uc=Ka.length;rc=function(n){for(var t=n.length,e=[],r=0,u=Ka[0];t>0&&u>0;)e.push(n.substring(t-=u,t+u)),u=Ka[r=(r+1)%uc];return e.reverse().join(Ga)}}Zo.geo={},kt.prototype={s:0,t:0,add:function(n){Et(n,this.t,ic),Et(ic.s,this.s,this),this.s?this.t+=ic.t:this.s=ic.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ic=new kt;Zo.geo.stream=function(n,t){n&&oc.hasOwnProperty(n.type)?oc[n.type](n,t):At(n,t)};var oc={Feature:function(n,t){At(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,r=-1,u=e.length;++r<u;)At(e[r].geometry,t)}},ac={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)n=e[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){Ct(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)Ct(e[r],t,0)},Polygon:function(n,t){Nt(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)Nt(e[r],t)},GeometryCollection:function(n,t){for(var e=n.geometries,r=-1,u=e.length;++r<u;)At(e[r],t)}};Zo.geo.area=function(n){return cc=0,Zo.geo.stream(n,lc),cc};var cc,sc=new kt,lc={sphere:function(){cc+=4*ba},point:c,lineStart:c,lineEnd:c,polygonStart:function(){sc.reset(),lc.lineStart=Lt},polygonEnd:function(){var n=2*sc;cc+=0>n?4*ba+n:n,lc.lineStart=lc.lineEnd=lc.point=c}};Zo.geo.bounds=function(){function n(n,t){x.push(M=[l=n,h=n]),f>t&&(f=t),t>g&&(g=t)}function t(t,e){var r=Tt([t*Aa,e*Aa]);if(m){var u=zt(m,r),i=[u[1],-u[0],0],o=zt(i,u);Pt(o),o=Ut(o);var c=t-p,s=c>0?1:-1,v=o[0]*Ca*s,d=ua(c)>180;if(d^(v>s*p&&s*t>v)){var y=o[1]*Ca;y>g&&(g=y)}else if(v=(v+360)%360-180,d^(v>s*p&&s*t>v)){var y=-o[1]*Ca;f>y&&(f=y)}else f>e&&(f=e),e>g&&(g=e);d?p>t?a(l,t)>a(l,h)&&(h=t):a(t,h)>a(l,h)&&(l=t):h>=l?(l>t&&(l=t),t>h&&(h=t)):t>p?a(l,t)>a(l,h)&&(h=t):a(t,h)>a(l,h)&&(l=t)}else n(t,e);m=r,p=t}function e(){_.point=t}function r(){M[0]=l,M[1]=h,_.point=n,m=null}function u(n,e){if(m){var r=n-p;y+=ua(r)>180?r+(r>0?360:-360):r}else v=n,d=e;lc.point(n,e),t(n,e)}function i(){lc.lineStart()}function o(){u(v,d),lc.lineEnd(),ua(y)>ka&&(l=-(h=180)),M[0]=l,M[1]=h,m=null}function a(n,t){return(t-=n)<0?t+360:t}function c(n,t){return n[0]-t[0]}function s(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var l,f,h,g,p,v,d,m,y,x,M,_={point:n,lineStart:e,lineEnd:r,polygonStart:function(){_.point=u,_.lineStart=i,_.lineEnd=o,y=0,lc.polygonStart()},polygonEnd:function(){lc.polygonEnd(),_.point=n,_.lineStart=e,_.lineEnd=r,0>sc?(l=-(h=180),f=-(g=90)):y>ka?g=90:-ka>y&&(f=-90),M[0]=l,M[1]=h}};return function(n){g=h=-(l=f=1/0),x=[],Zo.geo.stream(n,_);var t=x.length;if(t){x.sort(c);for(var e,r=1,u=x[0],i=[u];t>r;++r)e=x[r],s(e[0],u)||s(e[1],u)?(a(u[0],e[1])>a(u[0],u[1])&&(u[1]=e[1]),a(e[0],u[1])>a(u[0],u[1])&&(u[0]=e[0])):i.push(u=e);for(var o,e,p=-1/0,t=i.length-1,r=0,u=i[t];t>=r;u=e,++r)e=i[r],(o=a(u[1],e[0]))>p&&(p=o,l=e[0],h=u[1])}return x=M=null,1/0===l||1/0===f?[[0/0,0/0],[0/0,0/0]]:[[l,f],[h,g]]}}(),Zo.geo.centroid=function(n){fc=hc=gc=pc=vc=dc=mc=yc=xc=Mc=_c=0,Zo.geo.stream(n,bc);var t=xc,e=Mc,r=_c,u=t*t+e*e+r*r;return Ea>u&&(t=dc,e=mc,r=yc,ka>hc&&(t=gc,e=pc,r=vc),u=t*t+e*e+r*r,Ea>u)?[0/0,0/0]:[Math.atan2(e,t)*Ca,H(r/Math.sqrt(u))*Ca]};var fc,hc,gc,pc,vc,dc,mc,yc,xc,Mc,_c,bc={sphere:c,point:Ht,lineStart:Ot,lineEnd:Yt,polygonStart:function(){bc.lineStart=It},polygonEnd:function(){bc.lineStart=Ot}},wc=Bt(Zt,Qt,te,[-ba,-ba/2]),Sc=1e9;Zo.geo.clipExtent=function(){var n,t,e,r,u,i,o={stream:function(n){return u&&(u.valid=!1),u=i(n),u.valid=!0,u},extent:function(a){return arguments.length?(i=ue(n=+a[0][0],t=+a[0][1],e=+a[1][0],r=+a[1][1]),u&&(u.valid=!1,u=null),o):[[n,t],[e,r]]}};return o.extent([[0,0],[960,500]])},(Zo.geo.conicEqualArea=function(){return oe(ae)}).raw=ae,Zo.geo.albers=function(){return Zo.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Zo.geo.albersUsa=function(){function n(n){var i=n[0],o=n[1];return t=null,e(i,o),t||(r(i,o),t)||u(i,o),t}var t,e,r,u,i=Zo.geo.albers(),o=Zo.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a=Zo.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(n,e){t=[n,e]}};return n.invert=function(n){var t=i.scale(),e=i.translate(),r=(n[0]-e[0])/t,u=(n[1]-e[1])/t;return(u>=.12&&.234>u&&r>=-.425&&-.214>r?o:u>=.166&&.234>u&&r>=-.214&&-.115>r?a:i).invert(n)},n.stream=function(n){var t=i.stream(n),e=o.stream(n),r=a.stream(n);return{point:function(n,u){t.point(n,u),e.point(n,u),r.point(n,u)},sphere:function(){t.sphere(),e.sphere(),r.sphere()},lineStart:function(){t.lineStart(),e.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),e.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),e.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),e.polygonEnd(),r.polygonEnd()}}},n.precision=function(t){return arguments.length?(i.precision(t),o.precision(t),a.precision(t),n):i.precision()},n.scale=function(t){return arguments.length?(i.scale(t),o.scale(.35*t),a.scale(t),n.translate(i.translate())):i.scale()},n.translate=function(t){if(!arguments.length)return i.translate();var s=i.scale(),l=+t[0],f=+t[1];return e=i.translate(t).clipExtent([[l-.455*s,f-.238*s],[l+.455*s,f+.238*s]]).stream(c).point,r=o.translate([l-.307*s,f+.201*s]).clipExtent([[l-.425*s+ka,f+.12*s+ka],[l-.214*s-ka,f+.234*s-ka]]).stream(c).point,u=a.translate([l-.205*s,f+.212*s]).clipExtent([[l-.214*s+ka,f+.166*s+ka],[l-.115*s-ka,f+.234*s-ka]]).stream(c).point,n},n.scale(1070)};var kc,Ec,Ac,Cc,Nc,Lc,Tc={point:c,lineStart:c,lineEnd:c,polygonStart:function(){Ec=0,Tc.lineStart=ce},polygonEnd:function(){Tc.lineStart=Tc.lineEnd=Tc.point=c,kc+=ua(Ec/2)}},qc={point:se,lineStart:c,lineEnd:c,polygonStart:c,polygonEnd:c},zc={point:he,lineStart:ge,lineEnd:pe,polygonStart:function(){zc.lineStart=ve},polygonEnd:function(){zc.point=he,zc.lineStart=ge,zc.lineEnd=pe}};Zo.geo.transform=function(n){return{stream:function(t){var e=new ye(t);for(var r in n)e[r]=n[r];return e}}},ye.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Zo.geo.path=function(){function n(n){return n&&("function"==typeof a&&i.pointRadius(+a.apply(this,arguments)),o&&o.valid||(o=u(i)),Zo.geo.stream(n,o)),i.result()}function t(){return o=null,n}var e,r,u,i,o,a=4.5;return n.area=function(n){return kc=0,Zo.geo.stream(n,u(Tc)),kc},n.centroid=function(n){return gc=pc=vc=dc=mc=yc=xc=Mc=_c=0,Zo.geo.stream(n,u(zc)),_c?[xc/_c,Mc/_c]:yc?[dc/yc,mc/yc]:vc?[gc/vc,pc/vc]:[0/0,0/0]},n.bounds=function(n){return Nc=Lc=-(Ac=Cc=1/0),Zo.geo.stream(n,u(qc)),[[Ac,Cc],[Nc,Lc]]},n.projection=function(n){return arguments.length?(u=(e=n)?n.stream||xe(n):vt,t()):e},n.context=function(n){return arguments.length?(i=null==(r=n)?new le:new de(n),"function"!=typeof a&&i.pointRadius(a),t()):r},n.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(i.pointRadius(+t),+t),n):a},n.projection(Zo.geo.albersUsa()).context(null)},Zo.geo.projection=Me,Zo.geo.projectionMutator=_e,(Zo.geo.equirectangular=function(){return Me(we)}).raw=we.invert=we,Zo.geo.rotation=function(n){function t(t){return t=n(t[0]*Aa,t[1]*Aa),t[0]*=Ca,t[1]*=Ca,t
}return n=ke(n[0]%360*Aa,n[1]*Aa,n.length>2?n[2]*Aa:0),t.invert=function(t){return t=n.invert(t[0]*Aa,t[1]*Aa),t[0]*=Ca,t[1]*=Ca,t},t},Se.invert=we,Zo.geo.circle=function(){function n(){var n="function"==typeof r?r.apply(this,arguments):r,t=ke(-n[0]*Aa,-n[1]*Aa,0).invert,u=[];return e(null,null,1,{point:function(n,e){u.push(n=t(n,e)),n[0]*=Ca,n[1]*=Ca}}),{type:"Polygon",coordinates:[u]}}var t,e,r=[0,0],u=6;return n.origin=function(t){return arguments.length?(r=t,n):r},n.angle=function(r){return arguments.length?(e=Ne((t=+r)*Aa,u*Aa),n):t},n.precision=function(r){return arguments.length?(e=Ne(t*Aa,(u=+r)*Aa),n):u},n.angle(90)},Zo.geo.distance=function(n,t){var e,r=(t[0]-n[0])*Aa,u=n[1]*Aa,i=t[1]*Aa,o=Math.sin(r),a=Math.cos(r),c=Math.sin(u),s=Math.cos(u),l=Math.sin(i),f=Math.cos(i);return Math.atan2(Math.sqrt((e=f*o)*e+(e=s*l-c*f*a)*e),c*l+s*f*a)},Zo.geo.graticule=function(){function n(){return{type:"MultiLineString",coordinates:t()}}function t(){return Zo.range(Math.ceil(i/d)*d,u,d).map(h).concat(Zo.range(Math.ceil(s/m)*m,c,m).map(g)).concat(Zo.range(Math.ceil(r/p)*p,e,p).filter(function(n){return ua(n%d)>ka}).map(l)).concat(Zo.range(Math.ceil(a/v)*v,o,v).filter(function(n){return ua(n%m)>ka}).map(f))}var e,r,u,i,o,a,c,s,l,f,h,g,p=10,v=p,d=90,m=360,y=2.5;return n.lines=function(){return t().map(function(n){return{type:"LineString",coordinates:n}})},n.outline=function(){return{type:"Polygon",coordinates:[h(i).concat(g(c).slice(1),h(u).reverse().slice(1),g(s).reverse().slice(1))]}},n.extent=function(t){return arguments.length?n.majorExtent(t).minorExtent(t):n.minorExtent()},n.majorExtent=function(t){return arguments.length?(i=+t[0][0],u=+t[1][0],s=+t[0][1],c=+t[1][1],i>u&&(t=i,i=u,u=t),s>c&&(t=s,s=c,c=t),n.precision(y)):[[i,s],[u,c]]},n.minorExtent=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],a=+t[0][1],o=+t[1][1],r>e&&(t=r,r=e,e=t),a>o&&(t=a,a=o,o=t),n.precision(y)):[[r,a],[e,o]]},n.step=function(t){return arguments.length?n.majorStep(t).minorStep(t):n.minorStep()},n.majorStep=function(t){return arguments.length?(d=+t[0],m=+t[1],n):[d,m]},n.minorStep=function(t){return arguments.length?(p=+t[0],v=+t[1],n):[p,v]},n.precision=function(t){return arguments.length?(y=+t,l=Te(a,o,90),f=qe(r,e,y),h=Te(s,c,90),g=qe(i,u,y),n):y},n.majorExtent([[-180,-90+ka],[180,90-ka]]).minorExtent([[-180,-80-ka],[180,80+ka]])},Zo.geo.greatArc=function(){function n(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),e||u.apply(this,arguments)]}}var t,e,r=ze,u=Re;return n.distance=function(){return Zo.geo.distance(t||r.apply(this,arguments),e||u.apply(this,arguments))},n.source=function(e){return arguments.length?(r=e,t="function"==typeof e?null:e,n):r},n.target=function(t){return arguments.length?(u=t,e="function"==typeof t?null:t,n):u},n.precision=function(){return arguments.length?n:0},n},Zo.geo.interpolate=function(n,t){return De(n[0]*Aa,n[1]*Aa,t[0]*Aa,t[1]*Aa)},Zo.geo.length=function(n){return Rc=0,Zo.geo.stream(n,Dc),Rc};var Rc,Dc={sphere:c,point:c,lineStart:Pe,lineEnd:c,polygonStart:c,polygonEnd:c},Pc=Ue(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(Zo.geo.azimuthalEqualArea=function(){return Me(Pc)}).raw=Pc;var Uc=Ue(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},vt);(Zo.geo.azimuthalEquidistant=function(){return Me(Uc)}).raw=Uc,(Zo.geo.conicConformal=function(){return oe(je)}).raw=je,(Zo.geo.conicEquidistant=function(){return oe(He)}).raw=He;var jc=Ue(function(n){return 1/n},Math.atan);(Zo.geo.gnomonic=function(){return Me(jc)}).raw=jc,Fe.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-Sa]},(Zo.geo.mercator=function(){return Oe(Fe)}).raw=Fe;var Hc=Ue(function(){return 1},Math.asin);(Zo.geo.orthographic=function(){return Me(Hc)}).raw=Hc;var Fc=Ue(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});(Zo.geo.stereographic=function(){return Me(Fc)}).raw=Fc,Ye.invert=function(n,t){return[Math.atan2(F(n),Math.cos(t)),H(Math.sin(t)/O(n))]},(Zo.geo.transverseMercator=function(){return Oe(Ye)}).raw=Ye,Zo.geom={},Zo.geom.hull=function(n){function t(n){if(n.length<3)return[];var t,u,i,o,a,c,s,l,f,h,g,p,v=pt(e),d=pt(r),m=n.length,y=m-1,x=[],M=[],_=0;if(v===Ie&&r===Ze)t=n;else for(i=0,t=[];m>i;++i)t.push([+v.call(this,u=n[i],i),+d.call(this,u,i)]);for(i=1;m>i;++i)(t[i][1]<t[_][1]||t[i][1]==t[_][1]&&t[i][0]<t[_][0])&&(_=i);for(i=0;m>i;++i)i!==_&&(c=t[i][1]-t[_][1],a=t[i][0]-t[_][0],x.push({angle:Math.atan2(c,a),index:i}));for(x.sort(function(n,t){return n.angle-t.angle}),g=x[0].angle,h=x[0].index,f=0,i=1;y>i;++i){if(o=x[i].index,g==x[i].angle){if(a=t[h][0]-t[_][0],c=t[h][1]-t[_][1],s=t[o][0]-t[_][0],l=t[o][1]-t[_][1],a*a+c*c>=s*s+l*l){x[i].index=-1;continue}x[f].index=-1}g=x[i].angle,f=i,h=o}for(M.push(_),i=0,o=0;2>i;++o)x[o].index>-1&&(M.push(x[o].index),i++);for(p=M.length;y>o;++o)if(!(x[o].index<0)){for(;!Ve(M[p-2],M[p-1],x[o].index,t);)--p;M[p++]=x[o].index}var b=[];for(i=p-1;i>=0;--i)b.push(n[M[i]]);return b}var e=Ie,r=Ze;return arguments.length?t(n):(t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t)},Zo.geom.polygon=function(n){return sa(n,Oc),n};var Oc=Zo.geom.polygon.prototype=[];Oc.area=function(){for(var n,t=-1,e=this.length,r=this[e-1],u=0;++t<e;)n=r,r=this[t],u+=n[1]*r[0]-n[0]*r[1];return.5*u},Oc.centroid=function(n){var t,e,r=-1,u=this.length,i=0,o=0,a=this[u-1];for(arguments.length||(n=-1/(6*this.area()));++r<u;)t=a,a=this[r],e=t[0]*a[1]-a[0]*t[1],i+=(t[0]+a[0])*e,o+=(t[1]+a[1])*e;return[i*n,o*n]},Oc.clip=function(n){for(var t,e,r,u,i,o,a=Be(n),c=-1,s=this.length-Be(this),l=this[s-1];++c<s;){for(t=n.slice(),n.length=0,u=this[c],i=t[(r=t.length-a)-1],e=-1;++e<r;)o=t[e],Xe(o,l,u)?(Xe(i,l,u)||n.push($e(i,o,l,u)),n.push(o)):Xe(i,l,u)&&n.push($e(i,o,l,u)),i=o;a&&n.push(n[0]),l=u}return n};var Yc,Ic,Zc,Vc,Xc,$c=[],Bc=[];er.prototype.prepare=function(){for(var n,t=this.edges,e=t.length;e--;)n=t[e].edge,n.b&&n.a||t.splice(e,1);return t.sort(ur),t.length},pr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},vr.prototype={insert:function(n,t){var e,r,u;if(n){if(t.P=n,t.N=n.N,n.N&&(n.N.P=t),n.N=t,n.R){for(n=n.R;n.L;)n=n.L;n.L=t}else n.R=t;e=n}else this._?(n=xr(this._),t.P=null,t.N=n,n.P=n.L=t,e=n):(t.P=t.N=null,this._=t,e=null);for(t.L=t.R=null,t.U=e,t.C=!0,n=t;e&&e.C;)r=e.U,e===r.L?(u=r.R,u&&u.C?(e.C=u.C=!1,r.C=!0,n=r):(n===e.R&&(mr(this,e),n=e,e=n.U),e.C=!1,r.C=!0,yr(this,r))):(u=r.L,u&&u.C?(e.C=u.C=!1,r.C=!0,n=r):(n===e.L&&(yr(this,e),n=e,e=n.U),e.C=!1,r.C=!0,mr(this,r))),e=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P),n.P&&(n.P.N=n.N),n.N=n.P=null;var t,e,r,u=n.U,i=n.L,o=n.R;if(e=i?o?xr(o):i:o,u?u.L===n?u.L=e:u.R=e:this._=e,i&&o?(r=e.C,e.C=n.C,e.L=i,i.U=e,e!==o?(u=e.U,e.U=n.U,n=e.R,u.L=n,e.R=o,o.U=e):(e.U=u,u=e,n=e.R)):(r=n.C,n=e),n&&(n.U=u),!r){if(n&&n.C)return n.C=!1,void 0;do{if(n===this._)break;if(n===u.L){if(t=u.R,t.C&&(t.C=!1,u.C=!0,mr(this,u),t=u.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,yr(this,t),t=u.R),t.C=u.C,u.C=t.R.C=!1,mr(this,u),n=this._;break}}else if(t=u.L,t.C&&(t.C=!1,u.C=!0,yr(this,u),t=u.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,mr(this,t),t=u.L),t.C=u.C,u.C=t.L.C=!1,yr(this,u),n=this._;break}t.C=!0,n=u,u=u.U}while(!n.C);n&&(n.C=!1)}}},Zo.geom.voronoi=function(n){function t(n){var t=new Array(n.length),r=a[0][0],u=a[0][1],i=a[1][0],o=a[1][1];return Mr(e(n),a).cells.forEach(function(e,a){var c=e.edges,s=e.site,l=t[a]=c.length?c.map(function(n){var t=n.start();return[t.x,t.y]}):s.x>=r&&s.x<=i&&s.y>=u&&s.y<=o?[[r,o],[i,o],[i,u],[r,u]]:[];l.point=n[a]}),t}function e(n){return n.map(function(n,t){return{x:Math.round(i(n,t)/ka)*ka,y:Math.round(o(n,t)/ka)*ka,i:t}})}var r=Ie,u=Ze,i=r,o=u,a=Wc;return n?t(n):(t.links=function(n){return Mr(e(n)).edges.filter(function(n){return n.l&&n.r}).map(function(t){return{source:n[t.l.i],target:n[t.r.i]}})},t.triangles=function(n){var t=[];return Mr(e(n)).cells.forEach(function(e,r){for(var u,i,o=e.site,a=e.edges.sort(ur),c=-1,s=a.length,l=a[s-1].edge,f=l.l===o?l.r:l.l;++c<s;)u=l,i=f,l=a[c].edge,f=l.l===o?l.r:l.l,r<i.i&&r<f.i&&br(o,i,f)<0&&t.push([n[r],n[i.i],n[f.i]])}),t},t.x=function(n){return arguments.length?(i=pt(r=n),t):r},t.y=function(n){return arguments.length?(o=pt(u=n),t):u},t.clipExtent=function(n){return arguments.length?(a=null==n?Wc:n,t):a===Wc?null:a},t.size=function(n){return arguments.length?t.clipExtent(n&&[[0,0],n]):a===Wc?null:a&&a[1]},t)};var Wc=[[-1e6,-1e6],[1e6,1e6]];Zo.geom.delaunay=function(n){return Zo.geom.voronoi().triangles(n)},Zo.geom.quadtree=function(n,t,e,r,u){function i(n){function i(n,t,e,r,u,i,o,a){if(!isNaN(e)&&!isNaN(r))if(n.leaf){var c=n.x,l=n.y;if(null!=c)if(ua(c-e)+ua(l-r)<.01)s(n,t,e,r,u,i,o,a);else{var f=n.point;n.x=n.y=n.point=null,s(n,f,c,l,u,i,o,a),s(n,t,e,r,u,i,o,a)}else n.x=e,n.y=r,n.point=t}else s(n,t,e,r,u,i,o,a)}function s(n,t,e,r,u,o,a,c){var s=.5*(u+a),l=.5*(o+c),f=e>=s,h=r>=l,g=(h<<1)+f;n.leaf=!1,n=n.nodes[g]||(n.nodes[g]=kr()),f?u=s:a=s,h?o=l:c=l,i(n,t,e,r,u,o,a,c)}var l,f,h,g,p,v,d,m,y,x=pt(a),M=pt(c);if(null!=t)v=t,d=e,m=r,y=u;else if(m=y=-(v=d=1/0),f=[],h=[],p=n.length,o)for(g=0;p>g;++g)l=n[g],l.x<v&&(v=l.x),l.y<d&&(d=l.y),l.x>m&&(m=l.x),l.y>y&&(y=l.y),f.push(l.x),h.push(l.y);else for(g=0;p>g;++g){var _=+x(l=n[g],g),b=+M(l,g);v>_&&(v=_),d>b&&(d=b),_>m&&(m=_),b>y&&(y=b),f.push(_),h.push(b)}var w=m-v,S=y-d;w>S?y=d+w:m=v+S;var k=kr();if(k.add=function(n){i(k,n,+x(n,++g),+M(n,g),v,d,m,y)},k.visit=function(n){Er(n,k,v,d,m,y)},g=-1,null==t){for(;++g<p;)i(k,n[g],f[g],h[g],v,d,m,y);--g}else n.forEach(k.add);return f=h=n=l=null,k}var o,a=Ie,c=Ze;return(o=arguments.length)?(a=wr,c=Sr,3===o&&(u=e,r=t,e=t=0),i(n)):(i.x=function(n){return arguments.length?(a=n,i):a},i.y=function(n){return arguments.length?(c=n,i):c},i.extent=function(n){return arguments.length?(null==n?t=e=r=u=null:(t=+n[0][0],e=+n[0][1],r=+n[1][0],u=+n[1][1]),i):null==t?null:[[t,e],[r,u]]},i.size=function(n){return arguments.length?(null==n?t=e=r=u=null:(t=e=0,r=+n[0],u=+n[1]),i):null==t?null:[r-t,u-e]},i)},Zo.interpolateRgb=Ar,Zo.interpolateObject=Cr,Zo.interpolateNumber=Nr,Zo.interpolateString=Lr;var Jc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;Zo.interpolate=Tr,Zo.interpolators=[function(n,t){var e=typeof t;return("string"===e?Ia.has(t)||/^(#|rgb\(|hsl\()/.test(t)?Ar:Lr:t instanceof Z?Ar:"object"===e?Array.isArray(t)?qr:Cr:Nr)(n,t)}],Zo.interpolateArray=qr;var Gc=function(){return vt},Kc=Zo.map({linear:Gc,poly:Hr,quad:function(){return Pr},cubic:function(){return Ur},sin:function(){return Fr},exp:function(){return Or},circle:function(){return Yr},elastic:Ir,back:Zr,bounce:function(){return Vr}}),Qc=Zo.map({"in":vt,out:Rr,"in-out":Dr,"out-in":function(n){return Dr(Rr(n))}});Zo.ease=function(n){var t=n.indexOf("-"),e=t>=0?n.substring(0,t):n,r=t>=0?n.substring(t+1):"in";return e=Kc.get(e)||Gc,r=Qc.get(r)||vt,zr(r(e.apply(null,Vo.call(arguments,1))))},Zo.interpolateHcl=Xr,Zo.interpolateHsl=$r,Zo.interpolateLab=Br,Zo.interpolateRound=Wr,Zo.transform=function(n){var t=$o.createElementNS(Zo.ns.prefix.svg,"g");return(Zo.transform=function(n){if(null!=n){t.setAttribute("transform",n);var e=t.transform.baseVal.consolidate()}return new Jr(e?e.matrix:ns)})(n)},Jr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ns={a:1,b:0,c:0,d:1,e:0,f:0};Zo.interpolateTransform=nu,Zo.layout={},Zo.layout.bundle=function(){return function(n){for(var t=[],e=-1,r=n.length;++e<r;)t.push(ru(n[e]));return t}},Zo.layout.chord=function(){function n(){var n,s,f,h,g,p={},v=[],d=Zo.range(i),m=[];for(e=[],r=[],n=0,h=-1;++h<i;){for(s=0,g=-1;++g<i;)s+=u[h][g];v.push(s),m.push(Zo.range(i)),n+=s}for(o&&d.sort(function(n,t){return o(v[n],v[t])}),a&&m.forEach(function(n,t){n.sort(function(n,e){return a(u[t][n],u[t][e])})}),n=(wa-l*i)/n,s=0,h=-1;++h<i;){for(f=s,g=-1;++g<i;){var y=d[h],x=m[y][g],M=u[y][x],_=s,b=s+=M*n;p[y+"-"+x]={index:y,subindex:x,startAngle:_,endAngle:b,value:M}}r[y]={index:y,startAngle:f,endAngle:s,value:(s-f)/n},s+=l}for(h=-1;++h<i;)for(g=h-1;++g<i;){var w=p[h+"-"+g],S=p[g+"-"+h];(w.value||S.value)&&e.push(w.value<S.value?{source:S,target:w}:{source:w,target:S})}c&&t()}function t(){e.sort(function(n,t){return c((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var e,r,u,i,o,a,c,s={},l=0;return s.matrix=function(n){return arguments.length?(i=(u=n)&&u.length,e=r=null,s):u},s.padding=function(n){return arguments.length?(l=n,e=r=null,s):l},s.sortGroups=function(n){return arguments.length?(o=n,e=r=null,s):o},s.sortSubgroups=function(n){return arguments.length?(a=n,e=null,s):a},s.sortChords=function(n){return arguments.length?(c=n,e&&t(),s):c},s.chords=function(){return e||n(),e},s.groups=function(){return r||n(),r},s},Zo.layout.force=function(){function n(n){return function(t,e,r,u){if(t.point!==n){var i=t.cx-n.x,o=t.cy-n.y,a=1/Math.sqrt(i*i+o*o);if(v>(u-e)*a){var c=t.charge*a*a;return n.px-=i*c,n.py-=o*c,!0}if(t.point&&isFinite(a)){var c=t.pointCharge*a*a;n.px-=i*c,n.py-=o*c}}return!t.charge}}function t(n){n.px=Zo.event.x,n.py=Zo.event.y,a.resume()}var e,r,u,i,o,a={},c=Zo.dispatch("start","tick","end"),s=[1,1],l=.9,f=ts,h=es,g=-30,p=.1,v=.8,d=[],m=[];return a.tick=function(){if((r*=.99)<.005)return c.end({type:"end",alpha:r=0}),!0;var t,e,a,f,h,v,y,x,M,_=d.length,b=m.length;for(e=0;b>e;++e)a=m[e],f=a.source,h=a.target,x=h.x-f.x,M=h.y-f.y,(v=x*x+M*M)&&(v=r*i[e]*((v=Math.sqrt(v))-u[e])/v,x*=v,M*=v,h.x-=x*(y=f.weight/(h.weight+f.weight)),h.y-=M*y,f.x+=x*(y=1-y),f.y+=M*y);if((y=r*p)&&(x=s[0]/2,M=s[1]/2,e=-1,y))for(;++e<_;)a=d[e],a.x+=(x-a.x)*y,a.y+=(M-a.y)*y;if(g)for(lu(t=Zo.geom.quadtree(d),r,o),e=-1;++e<_;)(a=d[e]).fixed||t.visit(n(a));for(e=-1;++e<_;)a=d[e],a.fixed?(a.x=a.px,a.y=a.py):(a.x-=(a.px-(a.px=a.x))*l,a.y-=(a.py-(a.py=a.y))*l);c.tick({type:"tick",alpha:r})},a.nodes=function(n){return arguments.length?(d=n,a):d},a.links=function(n){return arguments.length?(m=n,a):m},a.size=function(n){return arguments.length?(s=n,a):s},a.linkDistance=function(n){return arguments.length?(f="function"==typeof n?n:+n,a):f},a.distance=a.linkDistance,a.linkStrength=function(n){return arguments.length?(h="function"==typeof n?n:+n,a):h},a.friction=function(n){return arguments.length?(l=+n,a):l},a.charge=function(n){return arguments.length?(g="function"==typeof n?n:+n,a):g},a.gravity=function(n){return arguments.length?(p=+n,a):p},a.theta=function(n){return arguments.length?(v=+n,a):v},a.alpha=function(n){return arguments.length?(n=+n,r?r=n>0?n:0:n>0&&(c.start({type:"start",alpha:r=n}),Zo.timer(a.tick)),a):r},a.start=function(){function n(n,r){if(!e){for(e=new Array(c),a=0;c>a;++a)e[a]=[];for(a=0;s>a;++a){var u=m[a];e[u.source.index].push(u.target),e[u.target.index].push(u.source)}}for(var i,o=e[t],a=-1,s=o.length;++a<s;)if(!isNaN(i=o[a][n]))return i;return Math.random()*r}var t,e,r,c=d.length,l=m.length,p=s[0],v=s[1];for(t=0;c>t;++t)(r=d[t]).index=t,r.weight=0;for(t=0;l>t;++t)r=m[t],"number"==typeof r.source&&(r.source=d[r.source]),"number"==typeof r.target&&(r.target=d[r.target]),++r.source.weight,++r.target.weight;for(t=0;c>t;++t)r=d[t],isNaN(r.x)&&(r.x=n("x",p)),isNaN(r.y)&&(r.y=n("y",v)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(u=[],"function"==typeof f)for(t=0;l>t;++t)u[t]=+f.call(this,m[t],t);else for(t=0;l>t;++t)u[t]=f;if(i=[],"function"==typeof h)for(t=0;l>t;++t)i[t]=+h.call(this,m[t],t);else for(t=0;l>t;++t)i[t]=h;if(o=[],"function"==typeof g)for(t=0;c>t;++t)o[t]=+g.call(this,d[t],t);else for(t=0;c>t;++t)o[t]=g;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){return e||(e=Zo.behavior.drag().origin(vt).on("dragstart.force",ou).on("drag.force",t).on("dragend.force",au)),arguments.length?(this.on("mouseover.force",cu).on("mouseout.force",su).call(e),void 0):e},Zo.rebind(a,c,"on")};var ts=20,es=1;Zo.layout.hierarchy=function(){function n(t,o,a){var c=u.call(e,t,o);if(t.depth=o,a.push(t),c&&(s=c.length)){for(var s,l,f=-1,h=t.children=new Array(s),g=0,p=o+1;++f<s;)l=h[f]=n(c[f],p,a),l.parent=t,g+=l.value;r&&h.sort(r),i&&(t.value=g)}else delete t.children,i&&(t.value=+i.call(e,t,o)||0);return t}function t(n,r){var u=n.children,o=0;if(u&&(a=u.length))for(var a,c=-1,s=r+1;++c<a;)o+=t(u[c],s);else i&&(o=+i.call(e,n,r)||0);return i&&(n.value=o),o}function e(t){var e=[];return n(t,0,e),e}var r=pu,u=hu,i=gu;return e.sort=function(n){return arguments.length?(r=n,e):r},e.children=function(n){return arguments.length?(u=n,e):u},e.value=function(n){return arguments.length?(i=n,e):i},e.revalue=function(n){return t(n,0),n},e},Zo.layout.partition=function(){function n(t,e,r,u){var i=t.children;if(t.x=e,t.y=t.depth*u,t.dx=r,t.dy=u,i&&(o=i.length)){var o,a,c,s=-1;for(r=t.value?r/t.value:0;++s<o;)n(a=i[s],e,c=a.value*r,u),e+=c}}function t(n){var e=n.children,r=0;if(e&&(u=e.length))for(var u,i=-1;++i<u;)r=Math.max(r,t(e[i]));return 1+r}function e(e,i){var o=r.call(this,e,i);return n(o[0],0,u[0],u[1]/t(o[0])),o}var r=Zo.layout.hierarchy(),u=[1,1];return e.size=function(n){return arguments.length?(u=n,e):u},fu(e,r)},Zo.layout.pie=function(){function n(i){var o=i.map(function(e,r){return+t.call(n,e,r)}),a=+("function"==typeof r?r.apply(this,arguments):r),c=(("function"==typeof u?u.apply(this,arguments):u)-a)/Zo.sum(o),s=Zo.range(i.length);null!=e&&s.sort(e===rs?function(n,t){return o[t]-o[n]}:function(n,t){return e(i[n],i[t])});var l=[];return s.forEach(function(n){var t;l[n]={data:i[n],value:t=o[n],startAngle:a,endAngle:a+=t*c}}),l}var t=Number,e=rs,r=0,u=wa;return n.value=function(e){return arguments.length?(t=e,n):t},n.sort=function(t){return arguments.length?(e=t,n):e},n.startAngle=function(t){return arguments.length?(r=t,n):r},n.endAngle=function(t){return arguments.length?(u=t,n):u},n};var rs={};Zo.layout.stack=function(){function n(a,c){var s=a.map(function(e,r){return t.call(n,e,r)}),l=s.map(function(t){return t.map(function(t,e){return[i.call(n,t,e),o.call(n,t,e)]})}),f=e.call(n,l,c);s=Zo.permute(s,f),l=Zo.permute(l,f);var h,g,p,v=r.call(n,l,c),d=s.length,m=s[0].length;for(g=0;m>g;++g)for(u.call(n,s[0][g],p=v[g],l[0][g][1]),h=1;d>h;++h)u.call(n,s[h][g],p+=l[h-1][g][1],l[h][g][1]);return a}var t=vt,e=xu,r=Mu,u=yu,i=du,o=mu;return n.values=function(e){return arguments.length?(t=e,n):t},n.order=function(t){return arguments.length?(e="function"==typeof t?t:us.get(t)||xu,n):e},n.offset=function(t){return arguments.length?(r="function"==typeof t?t:is.get(t)||Mu,n):r},n.x=function(t){return arguments.length?(i=t,n):i},n.y=function(t){return arguments.length?(o=t,n):o},n.out=function(t){return arguments.length?(u=t,n):u},n};var us=Zo.map({"inside-out":function(n){var t,e,r=n.length,u=n.map(_u),i=n.map(bu),o=Zo.range(r).sort(function(n,t){return u[n]-u[t]}),a=0,c=0,s=[],l=[];for(t=0;r>t;++t)e=o[t],c>a?(a+=i[e],s.push(e)):(c+=i[e],l.push(e));return l.reverse().concat(s)},reverse:function(n){return Zo.range(n.length).reverse()},"default":xu}),is=Zo.map({silhouette:function(n){var t,e,r,u=n.length,i=n[0].length,o=[],a=0,c=[];for(e=0;i>e;++e){for(t=0,r=0;u>t;t++)r+=n[t][e][1];r>a&&(a=r),o.push(r)}for(e=0;i>e;++e)c[e]=(a-o[e])/2;return c},wiggle:function(n){var t,e,r,u,i,o,a,c,s,l=n.length,f=n[0],h=f.length,g=[];for(g[0]=c=s=0,e=1;h>e;++e){for(t=0,u=0;l>t;++t)u+=n[t][e][1];for(t=0,i=0,a=f[e][0]-f[e-1][0];l>t;++t){for(r=0,o=(n[t][e][1]-n[t][e-1][1])/(2*a);t>r;++r)o+=(n[r][e][1]-n[r][e-1][1])/a;i+=o*n[t][e][1]}g[e]=c-=u?i/u*a:0,s>c&&(s=c)}for(e=0;h>e;++e)g[e]-=s;return g},expand:function(n){var t,e,r,u=n.length,i=n[0].length,o=1/u,a=[];for(e=0;i>e;++e){for(t=0,r=0;u>t;t++)r+=n[t][e][1];if(r)for(t=0;u>t;t++)n[t][e][1]/=r;else for(t=0;u>t;t++)n[t][e][1]=o}for(e=0;i>e;++e)a[e]=0;return a},zero:Mu});Zo.layout.histogram=function(){function n(n,i){for(var o,a,c=[],s=n.map(e,this),l=r.call(this,s,i),f=u.call(this,l,s,i),i=-1,h=s.length,g=f.length-1,p=t?1:1/h;++i<g;)o=c[i]=[],o.dx=f[i+1]-(o.x=f[i]),o.y=0;if(g>0)for(i=-1;++i<h;)a=s[i],a>=l[0]&&a<=l[1]&&(o=c[Zo.bisect(f,a,1,g)-1],o.y+=p,o.push(n[i]));return c}var t=!0,e=Number,r=Eu,u=Su;return n.value=function(t){return arguments.length?(e=t,n):e},n.range=function(t){return arguments.length?(r=pt(t),n):r},n.bins=function(t){return arguments.length?(u="number"==typeof t?function(n){return ku(n,t)}:pt(t),n):u},n.frequency=function(e){return arguments.length?(t=!!e,n):t},n},Zo.layout.tree=function(){function n(n,i){function o(n,t){var r=n.children,u=n._tree;if(r&&(i=r.length)){for(var i,a,s,l=r[0],f=l,h=-1;++h<i;)s=r[h],o(s,a),f=c(s,a,f),a=s;Du(n);var g=.5*(l._tree.prelim+s._tree.prelim);t?(u.prelim=t._tree.prelim+e(n,t),u.mod=u.prelim-g):u.prelim=g}else t&&(u.prelim=t._tree.prelim+e(n,t))}function a(n,t){n.x=n._tree.prelim+t;var e=n.children;if(e&&(r=e.length)){var r,u=-1;for(t+=n._tree.mod;++u<r;)a(e[u],t)}}function c(n,t,r){if(t){for(var u,i=n,o=n,a=t,c=n.parent.children[0],s=i._tree.mod,l=o._tree.mod,f=a._tree.mod,h=c._tree.mod;a=Nu(a),i=Cu(i),a&&i;)c=Cu(c),o=Nu(o),o._tree.ancestor=n,u=a._tree.prelim+f-i._tree.prelim-s+e(a,i),u>0&&(Pu(Uu(a,n,r),n,u),s+=u,l+=u),f+=a._tree.mod,s+=i._tree.mod,h+=c._tree.mod,l+=o._tree.mod;a&&!Nu(o)&&(o._tree.thread=a,o._tree.mod+=f-l),i&&!Cu(c)&&(c._tree.thread=i,c._tree.mod+=s-h,r=n)}return r}var s=t.call(this,n,i),l=s[0];Ru(l,function(n,t){n._tree={ancestor:n,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}}),o(l),a(l,-l._tree.prelim);var f=Lu(l,qu),h=Lu(l,Tu),g=Lu(l,zu),p=f.x-e(f,h)/2,v=h.x+e(h,f)/2,d=g.depth||1;return Ru(l,u?function(n){n.x*=r[0],n.y=n.depth*r[1],delete n._tree}:function(n){n.x=(n.x-p)/(v-p)*r[0],n.y=n.depth/d*r[1],delete n._tree}),s}var t=Zo.layout.hierarchy().sort(null).value(null),e=Au,r=[1,1],u=!1;return n.separation=function(t){return arguments.length?(e=t,n):e},n.size=function(t){return arguments.length?(u=null==(r=t),n):u?null:r},n.nodeSize=function(t){return arguments.length?(u=null!=(r=t),n):u?r:null},fu(n,t)},Zo.layout.pack=function(){function n(n,i){var o=e.call(this,n,i),a=o[0],c=u[0],s=u[1],l=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(a.x=a.y=0,Ru(a,function(n){n.r=+l(n.value)}),Ru(a,Yu),r){var f=r*(t?1:Math.max(2*a.r/c,2*a.r/s))/2;Ru(a,function(n){n.r+=f}),Ru(a,Yu),Ru(a,function(n){n.r-=f})}return Vu(a,c/2,s/2,t?1:1/Math.max(2*a.r/c,2*a.r/s)),o}var t,e=Zo.layout.hierarchy().sort(ju),r=0,u=[1,1];return n.size=function(t){return arguments.length?(u=t,n):u},n.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,n):t},n.padding=function(t){return arguments.length?(r=+t,n):r},fu(n,e)},Zo.layout.cluster=function(){function n(n,i){var o,a=t.call(this,n,i),c=a[0],s=0;Ru(c,function(n){var t=n.children;t&&t.length?(n.x=Bu(t),n.y=$u(t)):(n.x=o?s+=e(n,o):0,n.y=0,o=n)});var l=Wu(c),f=Ju(c),h=l.x-e(l,f)/2,g=f.x+e(f,l)/2;return Ru(c,u?function(n){n.x=(n.x-c.x)*r[0],n.y=(c.y-n.y)*r[1]}:function(n){n.x=(n.x-h)/(g-h)*r[0],n.y=(1-(c.y?n.y/c.y:1))*r[1]}),a}var t=Zo.layout.hierarchy().sort(null).value(null),e=Au,r=[1,1],u=!1;return n.separation=function(t){return arguments.length?(e=t,n):e},n.size=function(t){return arguments.length?(u=null==(r=t),n):u?null:r},n.nodeSize=function(t){return arguments.length?(u=null!=(r=t),n):u?r:null},fu(n,t)},Zo.layout.treemap=function(){function n(n,t){for(var e,r,u=-1,i=n.length;++u<i;)r=(e=n[u]).value*(0>t?0:t),e.area=isNaN(r)||0>=r?0:r}function t(e){var i=e.children;if(i&&i.length){var o,a,c,s=f(e),l=[],h=i.slice(),p=1/0,v="slice"===g?s.dx:"dice"===g?s.dy:"slice-dice"===g?1&e.depth?s.dy:s.dx:Math.min(s.dx,s.dy);for(n(h,s.dx*s.dy/e.value),l.area=0;(c=h.length)>0;)l.push(o=h[c-1]),l.area+=o.area,"squarify"!==g||(a=r(l,v))<=p?(h.pop(),p=a):(l.area-=l.pop().area,u(l,v,s,!1),v=Math.min(s.dx,s.dy),l.length=l.area=0,p=1/0);l.length&&(u(l,v,s,!0),l.length=l.area=0),i.forEach(t)}}function e(t){var r=t.children;if(r&&r.length){var i,o=f(t),a=r.slice(),c=[];for(n(a,o.dx*o.dy/t.value),c.area=0;i=a.pop();)c.push(i),c.area+=i.area,null!=i.z&&(u(c,i.z?o.dx:o.dy,o,!a.length),c.length=c.area=0);r.forEach(e)}}function r(n,t){for(var e,r=n.area,u=0,i=1/0,o=-1,a=n.length;++o<a;)(e=n[o].area)&&(i>e&&(i=e),e>u&&(u=e));return r*=r,t*=t,r?Math.max(t*u*p/r,r/(t*i*p)):1/0}function u(n,t,e,r){var u,i=-1,o=n.length,a=e.x,s=e.y,l=t?c(n.area/t):0;if(t==e.dx){for((r||l>e.dy)&&(l=e.dy);++i<o;)u=n[i],u.x=a,u.y=s,u.dy=l,a+=u.dx=Math.min(e.x+e.dx-a,l?c(u.area/l):0);u.z=!0,u.dx+=e.x+e.dx-a,e.y+=l,e.dy-=l}else{for((r||l>e.dx)&&(l=e.dx);++i<o;)u=n[i],u.x=a,u.y=s,u.dx=l,s+=u.dy=Math.min(e.y+e.dy-s,l?c(u.area/l):0);u.z=!1,u.dy+=e.y+e.dy-s,e.x+=l,e.dx-=l}}function i(r){var u=o||a(r),i=u[0];return i.x=0,i.y=0,i.dx=s[0],i.dy=s[1],o&&a.revalue(i),n([i],i.dx*i.dy/i.value),(o?e:t)(i),h&&(o=u),u}var o,a=Zo.layout.hierarchy(),c=Math.round,s=[1,1],l=null,f=Gu,h=!1,g="squarify",p=.5*(1+Math.sqrt(5));return i.size=function(n){return arguments.length?(s=n,i):s},i.padding=function(n){function t(t){var e=n.call(i,t,t.depth);return null==e?Gu(t):Ku(t,"number"==typeof e?[e,e,e,e]:e)}function e(t){return Ku(t,n)}if(!arguments.length)return l;var r;return f=null==(l=n)?Gu:"function"==(r=typeof n)?t:"number"===r?(n=[n,n,n,n],e):e,i},i.round=function(n){return arguments.length?(c=n?Math.round:Number,i):c!=Number},i.sticky=function(n){return arguments.length?(h=n,o=null,i):h},i.ratio=function(n){return arguments.length?(p=n,i):p},i.mode=function(n){return arguments.length?(g=n+"",i):g},fu(i,a)},Zo.random={normal:function(n,t){var e=arguments.length;return 2>e&&(t=1),1>e&&(n=0),function(){var e,r,u;do e=2*Math.random()-1,r=2*Math.random()-1,u=e*e+r*r;while(!u||u>1);return n+t*e*Math.sqrt(-2*Math.log(u)/u)}},logNormal:function(){var n=Zo.random.normal.apply(Zo,arguments);return function(){return Math.exp(n())}},irwinHall:function(n){return function(){for(var t=0,e=0;n>e;e++)t+=Math.random();return t/n}}},Zo.scale={};var os={floor:vt,ceil:vt};Zo.scale.linear=function(){return ii([0,1],[0,1],Tr,!1)},Zo.scale.log=function(){return fi(Zo.scale.linear().domain([0,1]),10,!0,[1,10])};var as=Zo.format(".0e"),cs={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}};Zo.scale.pow=function(){return hi(Zo.scale.linear(),1,[0,1])},Zo.scale.sqrt=function(){return Zo.scale.pow().exponent(.5)},Zo.scale.ordinal=function(){return pi([],{t:"range",a:[[]]})},Zo.scale.category10=function(){return Zo.scale.ordinal().range(ss)},Zo.scale.category20=function(){return Zo.scale.ordinal().range(ls)},Zo.scale.category20b=function(){return Zo.scale.ordinal().range(fs)},Zo.scale.category20c=function(){return Zo.scale.ordinal().range(hs)};var ss=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(it),ls=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(it),fs=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(it),hs=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(it);Zo.scale.quantile=function(){return vi([],[])},Zo.scale.quantize=function(){return di(0,1,[0,1])},Zo.scale.threshold=function(){return mi([.5],[0,1])},Zo.scale.identity=function(){return yi([0,1])},Zo.svg={},Zo.svg.arc=function(){function n(){var n=t.apply(this,arguments),i=e.apply(this,arguments),o=r.apply(this,arguments)+gs,a=u.apply(this,arguments)+gs,c=(o>a&&(c=o,o=a,a=c),a-o),s=ba>c?"0":"1",l=Math.cos(o),f=Math.sin(o),h=Math.cos(a),g=Math.sin(a);return c>=ps?n?"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"M0,"+n+"A"+n+","+n+" 0 1,0 0,"+-n+"A"+n+","+n+" 0 1,0 0,"+n+"Z":"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z":n?"M"+i*l+","+i*f+"A"+i+","+i+" 0 "+s+",1 "+i*h+","+i*g+"L"+n*h+","+n*g+"A"+n+","+n+" 0 "+s+",0 "+n*l+","+n*f+"Z":"M"+i*l+","+i*f+"A"+i+","+i+" 0 "+s+",1 "+i*h+","+i*g+"L0,0"+"Z"}var t=xi,e=Mi,r=_i,u=bi;return n.innerRadius=function(e){return arguments.length?(t=pt(e),n):t},n.outerRadius=function(t){return arguments.length?(e=pt(t),n):e},n.startAngle=function(t){return arguments.length?(r=pt(t),n):r},n.endAngle=function(t){return arguments.length?(u=pt(t),n):u},n.centroid=function(){var n=(t.apply(this,arguments)+e.apply(this,arguments))/2,i=(r.apply(this,arguments)+u.apply(this,arguments))/2+gs;return[Math.cos(i)*n,Math.sin(i)*n]},n};var gs=-Sa,ps=wa-ka;Zo.svg.line=function(){return wi(vt)};var vs=Zo.map({linear:Si,"linear-closed":ki,step:Ei,"step-before":Ai,"step-after":Ci,basis:Ri,"basis-open":Di,"basis-closed":Pi,bundle:Ui,cardinal:Ti,"cardinal-open":Ni,"cardinal-closed":Li,monotone:Ii});vs.forEach(function(n,t){t.key=n,t.closed=/-closed$/.test(n)});var ds=[0,2/3,1/3,0],ms=[0,1/3,2/3,0],ys=[0,1/6,2/3,1/6];Zo.svg.line.radial=function(){var n=wi(Zi);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n},Ai.reverse=Ci,Ci.reverse=Ai,Zo.svg.area=function(){return Vi(vt)},Zo.svg.area.radial=function(){var n=Vi(Zi);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n},Zo.svg.chord=function(){function n(n,a){var c=t(this,i,n,a),s=t(this,o,n,a);return"M"+c.p0+r(c.r,c.p1,c.a1-c.a0)+(e(c,s)?u(c.r,c.p1,c.r,c.p0):u(c.r,c.p1,s.r,s.p0)+r(s.r,s.p1,s.a1-s.a0)+u(s.r,s.p1,c.r,c.p0))+"Z"}function t(n,t,e,r){var u=t.call(n,e,r),i=a.call(n,u,r),o=c.call(n,u,r)+gs,l=s.call(n,u,r)+gs;return{r:i,a0:o,a1:l,p0:[i*Math.cos(o),i*Math.sin(o)],p1:[i*Math.cos(l),i*Math.sin(l)]}}function e(n,t){return n.a0==t.a0&&n.a1==t.a1}function r(n,t,e){return"A"+n+","+n+" 0 "+ +(e>ba)+",1 "+t}function u(n,t,e,r){return"Q 0,0 "+r}var i=ze,o=Re,a=Xi,c=_i,s=bi;return n.radius=function(t){return arguments.length?(a=pt(t),n):a},n.source=function(t){return arguments.length?(i=pt(t),n):i},n.target=function(t){return arguments.length?(o=pt(t),n):o},n.startAngle=function(t){return arguments.length?(c=pt(t),n):c},n.endAngle=function(t){return arguments.length?(s=pt(t),n):s},n},Zo.svg.diagonal=function(){function n(n,u){var i=t.call(this,n,u),o=e.call(this,n,u),a=(i.y+o.y)/2,c=[i,{x:i.x,y:a},{x:o.x,y:a},o];return c=c.map(r),"M"+c[0]+"C"+c[1]+" "+c[2]+" "+c[3]}var t=ze,e=Re,r=$i;return n.source=function(e){return arguments.length?(t=pt(e),n):t},n.target=function(t){return arguments.length?(e=pt(t),n):e},n.projection=function(t){return arguments.length?(r=t,n):r},n},Zo.svg.diagonal.radial=function(){var n=Zo.svg.diagonal(),t=$i,e=n.projection;return n.projection=function(n){return arguments.length?e(Bi(t=n)):t},n},Zo.svg.symbol=function(){function n(n,r){return(xs.get(t.call(this,n,r))||Gi)(e.call(this,n,r))}var t=Ji,e=Wi;return n.type=function(e){return arguments.length?(t=pt(e),n):t},n.size=function(t){return arguments.length?(e=pt(t),n):e},n};var xs=Zo.map({circle:Gi,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*ws)),e=t*ws;return"M0,"+-t+"L"+e+",0"+" 0,"+t+" "+-e+",0"+"Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/bs),e=t*bs/2;return"M0,"+e+"L"+t+","+-e+" "+-t+","+-e+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/bs),e=t*bs/2;return"M0,"+-e+"L"+t+","+e+" "+-t+","+e+"Z"}});Zo.svg.symbolTypes=xs.keys();var Ms,_s,bs=Math.sqrt(3),ws=Math.tan(30*Aa),Ss=[],ks=0;Ss.call=pa.call,Ss.empty=pa.empty,Ss.node=pa.node,Ss.size=pa.size,Zo.transition=function(n){return arguments.length?Ms?n.transition():n:ma.transition()},Zo.transition.prototype=Ss,Ss.select=function(n){var t,e,r,u=this.id,i=[];n=v(n);for(var o=-1,a=this.length;++o<a;){i.push(t=[]);for(var c=this[o],s=-1,l=c.length;++s<l;)(r=c[s])&&(e=n.call(r,r.__data__,s,o))?("__data__"in r&&(e.__data__=r.__data__),to(e,s,u,r.__transition__[u]),t.push(e)):t.push(null)
}return Ki(i,u)},Ss.selectAll=function(n){var t,e,r,u,i,o=this.id,a=[];n=d(n);for(var c=-1,s=this.length;++c<s;)for(var l=this[c],f=-1,h=l.length;++f<h;)if(r=l[f]){i=r.__transition__[o],e=n.call(r,r.__data__,f,c),a.push(t=[]);for(var g=-1,p=e.length;++g<p;)(u=e[g])&&to(u,g,o,i),t.push(u)}return Ki(a,o)},Ss.filter=function(n){var t,e,r,u=[];"function"!=typeof n&&(n=E(n));for(var i=0,o=this.length;o>i;i++){u.push(t=[]);for(var e=this[i],a=0,c=e.length;c>a;a++)(r=e[a])&&n.call(r,r.__data__,a)&&t.push(r)}return Ki(u,this.id)},Ss.tween=function(n,t){var e=this.id;return arguments.length<2?this.node().__transition__[e].tween.get(n):C(this,null==t?function(t){t.__transition__[e].tween.remove(n)}:function(r){r.__transition__[e].tween.set(n,t)})},Ss.attr=function(n,t){function e(){this.removeAttribute(a)}function r(){this.removeAttributeNS(a.space,a.local)}function u(n){return null==n?e:(n+="",function(){var t,e=this.getAttribute(a);return e!==n&&(t=o(e,n),function(n){this.setAttribute(a,t(n))})})}function i(n){return null==n?r:(n+="",function(){var t,e=this.getAttributeNS(a.space,a.local);return e!==n&&(t=o(e,n),function(n){this.setAttributeNS(a.space,a.local,t(n))})})}if(arguments.length<2){for(t in n)this.attr(t,n[t]);return this}var o="transform"==n?nu:Tr,a=Zo.ns.qualify(n);return Qi(this,"attr."+n,t,a.local?i:u)},Ss.attrTween=function(n,t){function e(n,e){var r=t.call(this,n,e,this.getAttribute(u));return r&&function(n){this.setAttribute(u,r(n))}}function r(n,e){var r=t.call(this,n,e,this.getAttributeNS(u.space,u.local));return r&&function(n){this.setAttributeNS(u.space,u.local,r(n))}}var u=Zo.ns.qualify(n);return this.tween("attr."+n,u.local?r:e)},Ss.style=function(n,t,e){function r(){this.style.removeProperty(n)}function u(t){return null==t?r:(t+="",function(){var r,u=Wo.getComputedStyle(this,null).getPropertyValue(n);return u!==t&&(r=Tr(u,t),function(t){this.style.setProperty(n,r(t),e)})})}var i=arguments.length;if(3>i){if("string"!=typeof n){2>i&&(t="");for(e in n)this.style(e,n[e],t);return this}e=""}return Qi(this,"style."+n,t,u)},Ss.styleTween=function(n,t,e){function r(r,u){var i=t.call(this,r,u,Wo.getComputedStyle(this,null).getPropertyValue(n));return i&&function(t){this.style.setProperty(n,i(t),e)}}return arguments.length<3&&(e=""),this.tween("style."+n,r)},Ss.text=function(n){return Qi(this,"text",n,no)},Ss.remove=function(){return this.each("end.transition",function(){var n;this.__transition__.count<2&&(n=this.parentNode)&&n.removeChild(this)})},Ss.ease=function(n){var t=this.id;return arguments.length<1?this.node().__transition__[t].ease:("function"!=typeof n&&(n=Zo.ease.apply(Zo,arguments)),C(this,function(e){e.__transition__[t].ease=n}))},Ss.delay=function(n){var t=this.id;return C(this,"function"==typeof n?function(e,r,u){e.__transition__[t].delay=+n.call(e,e.__data__,r,u)}:(n=+n,function(e){e.__transition__[t].delay=n}))},Ss.duration=function(n){var t=this.id;return C(this,"function"==typeof n?function(e,r,u){e.__transition__[t].duration=Math.max(1,n.call(e,e.__data__,r,u))}:(n=Math.max(1,n),function(e){e.__transition__[t].duration=n}))},Ss.each=function(n,t){var e=this.id;if(arguments.length<2){var r=_s,u=Ms;Ms=e,C(this,function(t,r,u){_s=t.__transition__[e],n.call(t,t.__data__,r,u)}),_s=r,Ms=u}else C(this,function(r){var u=r.__transition__[e];(u.event||(u.event=Zo.dispatch("start","end"))).on(n,t)});return this},Ss.transition=function(){for(var n,t,e,r,u=this.id,i=++ks,o=[],a=0,c=this.length;c>a;a++){o.push(n=[]);for(var t=this[a],s=0,l=t.length;l>s;s++)(e=t[s])&&(r=Object.create(e.__transition__[u]),r.delay+=r.duration,to(e,s,i,r)),n.push(e)}return Ki(o,i)},Zo.svg.axis=function(){function n(n){n.each(function(){var n,s=Zo.select(this),l=this.__chart__||e,f=this.__chart__=e.copy(),h=null==c?f.ticks?f.ticks.apply(f,a):f.domain():c,g=null==t?f.tickFormat?f.tickFormat.apply(f,a):vt:t,p=s.selectAll(".tick").data(h,f),v=p.enter().insert("g",".domain").attr("class","tick").style("opacity",ka),d=Zo.transition(p.exit()).style("opacity",ka).remove(),m=Zo.transition(p).style("opacity",1),y=ni(f),x=s.selectAll(".domain").data([0]),M=(x.enter().append("path").attr("class","domain"),Zo.transition(x));v.append("line"),v.append("text");var _=v.select("line"),b=m.select("line"),w=p.select("text").text(g),S=v.select("text"),k=m.select("text");switch(r){case"bottom":n=eo,_.attr("y2",u),S.attr("y",Math.max(u,0)+o),b.attr("x2",0).attr("y2",u),k.attr("x",0).attr("y",Math.max(u,0)+o),w.attr("dy",".71em").style("text-anchor","middle"),M.attr("d","M"+y[0]+","+i+"V0H"+y[1]+"V"+i);break;case"top":n=eo,_.attr("y2",-u),S.attr("y",-(Math.max(u,0)+o)),b.attr("x2",0).attr("y2",-u),k.attr("x",0).attr("y",-(Math.max(u,0)+o)),w.attr("dy","0em").style("text-anchor","middle"),M.attr("d","M"+y[0]+","+-i+"V0H"+y[1]+"V"+-i);break;case"left":n=ro,_.attr("x2",-u),S.attr("x",-(Math.max(u,0)+o)),b.attr("x2",-u).attr("y2",0),k.attr("x",-(Math.max(u,0)+o)).attr("y",0),w.attr("dy",".32em").style("text-anchor","end"),M.attr("d","M"+-i+","+y[0]+"H0V"+y[1]+"H"+-i);break;case"right":n=ro,_.attr("x2",u),S.attr("x",Math.max(u,0)+o),b.attr("x2",u).attr("y2",0),k.attr("x",Math.max(u,0)+o).attr("y",0),w.attr("dy",".32em").style("text-anchor","start"),M.attr("d","M"+i+","+y[0]+"H0V"+y[1]+"H"+i)}if(f.rangeBand){var E=f.rangeBand()/2,A=function(n){return f(n)+E};v.call(n,A),m.call(n,A)}else v.call(n,l),m.call(n,f),d.call(n,f)})}var t,e=Zo.scale.linear(),r=Es,u=6,i=6,o=3,a=[10],c=null;return n.scale=function(t){return arguments.length?(e=t,n):e},n.orient=function(t){return arguments.length?(r=t in As?t+"":Es,n):r},n.ticks=function(){return arguments.length?(a=arguments,n):a},n.tickValues=function(t){return arguments.length?(c=t,n):c},n.tickFormat=function(e){return arguments.length?(t=e,n):t},n.tickSize=function(t){var e=arguments.length;return e?(u=+t,i=+arguments[e-1],n):u},n.innerTickSize=function(t){return arguments.length?(u=+t,n):u},n.outerTickSize=function(t){return arguments.length?(i=+t,n):i},n.tickPadding=function(t){return arguments.length?(o=+t,n):o},n.tickSubdivide=function(){return arguments.length&&n},n};var Es="bottom",As={top:1,right:1,bottom:1,left:1};Zo.svg.brush=function(){function n(i){i.each(function(){var i=Zo.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",u).on("touchstart.brush",u),o=i.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),i.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=i.selectAll(".resize").data(d,vt);a.exit().remove(),a.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return Cs[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),a.style("display",n.empty()?"none":null);var l,f=Zo.transition(i),h=Zo.transition(o);c&&(l=ni(c),h.attr("x",l[0]).attr("width",l[1]-l[0]),e(f)),s&&(l=ni(s),h.attr("y",l[0]).attr("height",l[1]-l[0]),r(f)),t(f)})}function t(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+l[+/e$/.test(n)]+","+h[+/^s/.test(n)]+")"})}function e(n){n.select(".extent").attr("x",l[0]),n.selectAll(".extent,.n>rect,.s>rect").attr("width",l[1]-l[0])}function r(n){n.select(".extent").attr("y",h[0]),n.selectAll(".extent,.e>rect,.w>rect").attr("height",h[1]-h[0])}function u(){function u(){32==Zo.event.keyCode&&(C||(x=null,L[0]-=l[1],L[1]-=h[1],C=2),f())}function g(){32==Zo.event.keyCode&&2==C&&(L[0]+=l[1],L[1]+=h[1],C=0,f())}function d(){var n=Zo.mouse(_),u=!1;M&&(n[0]+=M[0],n[1]+=M[1]),C||(Zo.event.altKey?(x||(x=[(l[0]+l[1])/2,(h[0]+h[1])/2]),L[0]=l[+(n[0]<x[0])],L[1]=h[+(n[1]<x[1])]):x=null),E&&m(n,c,0)&&(e(S),u=!0),A&&m(n,s,1)&&(r(S),u=!0),u&&(t(S),w({type:"brush",mode:C?"move":"resize"}))}function m(n,t,e){var r,u,a=ni(t),c=a[0],s=a[1],f=L[e],g=e?h:l,d=g[1]-g[0];return C&&(c-=f,s-=d+f),r=(e?v:p)?Math.max(c,Math.min(s,n[e])):n[e],C?u=(r+=f)+d:(x&&(f=Math.max(c,Math.min(s,2*x[e]-r))),r>f?(u=r,r=f):u=f),g[0]!=r||g[1]!=u?(e?o=null:i=null,g[0]=r,g[1]=u,!0):void 0}function y(){d(),S.style("pointer-events","all").selectAll(".resize").style("display",n.empty()?"none":null),Zo.select("body").style("cursor",null),T.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),N(),w({type:"brushend"})}var x,M,_=this,b=Zo.select(Zo.event.target),w=a.of(_,arguments),S=Zo.select(_),k=b.datum(),E=!/^(n|s)$/.test(k)&&c,A=!/^(e|w)$/.test(k)&&s,C=b.classed("extent"),N=D(),L=Zo.mouse(_),T=Zo.select(Wo).on("keydown.brush",u).on("keyup.brush",g);if(Zo.event.changedTouches?T.on("touchmove.brush",d).on("touchend.brush",y):T.on("mousemove.brush",d).on("mouseup.brush",y),S.interrupt().selectAll("*").interrupt(),C)L[0]=l[0]-L[0],L[1]=h[0]-L[1];else if(k){var q=+/w$/.test(k),z=+/^n/.test(k);M=[l[1-q]-L[0],h[1-z]-L[1]],L[0]=l[q],L[1]=h[z]}else Zo.event.altKey&&(x=L.slice());S.style("pointer-events","none").selectAll(".resize").style("display",null),Zo.select("body").style("cursor",b.style("cursor")),w({type:"brushstart"}),d()}var i,o,a=g(n,"brushstart","brush","brushend"),c=null,s=null,l=[0,0],h=[0,0],p=!0,v=!0,d=Ns[0];return n.event=function(n){n.each(function(){var n=a.of(this,arguments),t={x:l,y:h,i:i,j:o},e=this.__chart__||t;this.__chart__=t,Ms?Zo.select(this).transition().each("start.brush",function(){i=e.i,o=e.j,l=e.x,h=e.y,n({type:"brushstart"})}).tween("brush:brush",function(){var e=qr(l,t.x),r=qr(h,t.y);return i=o=null,function(u){l=t.x=e(u),h=t.y=r(u),n({type:"brush",mode:"resize"})}}).each("end.brush",function(){i=t.i,o=t.j,n({type:"brush",mode:"resize"}),n({type:"brushend"})}):(n({type:"brushstart"}),n({type:"brush",mode:"resize"}),n({type:"brushend"}))})},n.x=function(t){return arguments.length?(c=t,d=Ns[!c<<1|!s],n):c},n.y=function(t){return arguments.length?(s=t,d=Ns[!c<<1|!s],n):s},n.clamp=function(t){return arguments.length?(c&&s?(p=!!t[0],v=!!t[1]):c?p=!!t:s&&(v=!!t),n):c&&s?[p,v]:c?p:s?v:null},n.extent=function(t){var e,r,u,a,f;return arguments.length?(c&&(e=t[0],r=t[1],s&&(e=e[0],r=r[0]),i=[e,r],c.invert&&(e=c(e),r=c(r)),e>r&&(f=e,e=r,r=f),(e!=l[0]||r!=l[1])&&(l=[e,r])),s&&(u=t[0],a=t[1],c&&(u=u[1],a=a[1]),o=[u,a],s.invert&&(u=s(u),a=s(a)),u>a&&(f=u,u=a,a=f),(u!=h[0]||a!=h[1])&&(h=[u,a])),n):(c&&(i?(e=i[0],r=i[1]):(e=l[0],r=l[1],c.invert&&(e=c.invert(e),r=c.invert(r)),e>r&&(f=e,e=r,r=f))),s&&(o?(u=o[0],a=o[1]):(u=h[0],a=h[1],s.invert&&(u=s.invert(u),a=s.invert(a)),u>a&&(f=u,u=a,a=f))),c&&s?[[e,u],[r,a]]:c?[e,r]:s&&[u,a])},n.clear=function(){return n.empty()||(l=[0,0],h=[0,0],i=o=null),n},n.empty=function(){return!!c&&l[0]==l[1]||!!s&&h[0]==h[1]},Zo.rebind(n,a,"on")};var Cs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ns=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ls=Zo.time={},Ts=Date,qs=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];uo.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){zs.setUTCDate.apply(this._,arguments)},setDay:function(){zs.setUTCDay.apply(this._,arguments)},setFullYear:function(){zs.setUTCFullYear.apply(this._,arguments)},setHours:function(){zs.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){zs.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){zs.setUTCMinutes.apply(this._,arguments)},setMonth:function(){zs.setUTCMonth.apply(this._,arguments)},setSeconds:function(){zs.setUTCSeconds.apply(this._,arguments)},setTime:function(){zs.setTime.apply(this._,arguments)}};var zs=Date.prototype,Rs="%a %b %e %X %Y",Ds="%m/%d/%Y",Ps="%H:%M:%S",Us=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],js=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Hs=["January","February","March","April","May","June","July","August","September","October","November","December"],Fs=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];Ls.year=io(function(n){return n=Ls.day(n),n.setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()}),Ls.years=Ls.year.range,Ls.years.utc=Ls.year.utc.range,Ls.day=io(function(n){var t=new Ts(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1}),Ls.days=Ls.day.range,Ls.days.utc=Ls.day.utc.range,Ls.dayOfYear=function(n){var t=Ls.year(n);return Math.floor((n-t-6e4*(n.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},qs.forEach(function(n,t){n=n.toLowerCase(),t=7-t;var e=Ls[n]=io(function(n){return(n=Ls.day(n)).setDate(n.getDate()-(n.getDay()+t)%7),n},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(n){var e=Ls.year(n).getDay();return Math.floor((Ls.dayOfYear(n)+(e+t)%7)/7)-(e!==t)});Ls[n+"s"]=e.range,Ls[n+"s"].utc=e.utc.range,Ls[n+"OfYear"]=function(n){var e=Ls.year(n).getDay();return Math.floor((Ls.dayOfYear(n)+(e+t)%7)/7)}}),Ls.week=Ls.sunday,Ls.weeks=Ls.sunday.range,Ls.weeks.utc=Ls.sunday.utc.range,Ls.weekOfYear=Ls.sundayOfYear,Ls.format=ao;var Os=so(Us),Ys=lo(Us),Is=so(js),Zs=lo(js),Vs=so(Hs),Xs=lo(Hs),$s=so(Fs),Bs=lo(Fs),Ws=/^%/,Js={"-":"",_:" ",0:"0"},Gs={a:function(n){return js[n.getDay()]},A:function(n){return Us[n.getDay()]},b:function(n){return Fs[n.getMonth()]},B:function(n){return Hs[n.getMonth()]},c:ao(Rs),d:function(n,t){return fo(n.getDate(),t,2)},e:function(n,t){return fo(n.getDate(),t,2)},H:function(n,t){return fo(n.getHours(),t,2)},I:function(n,t){return fo(n.getHours()%12||12,t,2)},j:function(n,t){return fo(1+Ls.dayOfYear(n),t,3)},L:function(n,t){return fo(n.getMilliseconds(),t,3)},m:function(n,t){return fo(n.getMonth()+1,t,2)},M:function(n,t){return fo(n.getMinutes(),t,2)},p:function(n){return n.getHours()>=12?"PM":"AM"},S:function(n,t){return fo(n.getSeconds(),t,2)},U:function(n,t){return fo(Ls.sundayOfYear(n),t,2)},w:function(n){return n.getDay()},W:function(n,t){return fo(Ls.mondayOfYear(n),t,2)},x:ao(Ds),X:ao(Ps),y:function(n,t){return fo(n.getFullYear()%100,t,2)},Y:function(n,t){return fo(n.getFullYear()%1e4,t,4)},Z:Do,"%":function(){return"%"}},Ks={a:ho,A:go,b:yo,B:xo,c:Mo,d:Co,e:Co,H:Lo,I:Lo,j:No,L:zo,m:Ao,M:To,p:Ro,S:qo,U:vo,w:po,W:mo,x:_o,X:bo,y:So,Y:wo,Z:ko,"%":Po},Qs=/^\s*\d+/,nl=Zo.map({am:0,pm:1});ao.utc=Uo;var tl=Uo("%Y-%m-%dT%H:%M:%S.%LZ");ao.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?jo:tl,jo.parse=function(n){var t=new Date(n);return isNaN(t)?null:t},jo.toString=tl.toString,Ls.second=io(function(n){return new Ts(1e3*Math.floor(n/1e3))},function(n,t){n.setTime(n.getTime()+1e3*Math.floor(t))},function(n){return n.getSeconds()}),Ls.seconds=Ls.second.range,Ls.seconds.utc=Ls.second.utc.range,Ls.minute=io(function(n){return new Ts(6e4*Math.floor(n/6e4))},function(n,t){n.setTime(n.getTime()+6e4*Math.floor(t))},function(n){return n.getMinutes()}),Ls.minutes=Ls.minute.range,Ls.minutes.utc=Ls.minute.utc.range,Ls.hour=io(function(n){var t=n.getTimezoneOffset()/60;return new Ts(36e5*(Math.floor(n/36e5-t)+t))},function(n,t){n.setTime(n.getTime()+36e5*Math.floor(t))},function(n){return n.getHours()}),Ls.hours=Ls.hour.range,Ls.hours.utc=Ls.hour.utc.range,Ls.month=io(function(n){return n=Ls.day(n),n.setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()}),Ls.months=Ls.month.range,Ls.months.utc=Ls.month.utc.range;var el=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],rl=[[Ls.second,1],[Ls.second,5],[Ls.second,15],[Ls.second,30],[Ls.minute,1],[Ls.minute,5],[Ls.minute,15],[Ls.minute,30],[Ls.hour,1],[Ls.hour,3],[Ls.hour,6],[Ls.hour,12],[Ls.day,1],[Ls.day,2],[Ls.week,1],[Ls.month,1],[Ls.month,3],[Ls.year,1]],ul=[[ao("%Y"),Zt],[ao("%B"),function(n){return n.getMonth()}],[ao("%b %d"),function(n){return 1!=n.getDate()}],[ao("%a %d"),function(n){return n.getDay()&&1!=n.getDate()}],[ao("%I %p"),function(n){return n.getHours()}],[ao("%I:%M"),function(n){return n.getMinutes()}],[ao(":%S"),function(n){return n.getSeconds()}],[ao(".%L"),function(n){return n.getMilliseconds()}]],il=Oo(ul);rl.year=Ls.year,Ls.scale=function(){return Ho(Zo.scale.linear(),rl,il)};var ol={range:function(n,t,e){return Zo.range(+n,+t,e).map(Fo)}},al=rl.map(function(n){return[n[0].utc,n[1]]}),cl=[[Uo("%Y"),Zt],[Uo("%B"),function(n){return n.getUTCMonth()}],[Uo("%b %d"),function(n){return 1!=n.getUTCDate()}],[Uo("%a %d"),function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],[Uo("%I %p"),function(n){return n.getUTCHours()}],[Uo("%I:%M"),function(n){return n.getUTCMinutes()}],[Uo(":%S"),function(n){return n.getUTCSeconds()}],[Uo(".%L"),function(n){return n.getUTCMilliseconds()}]],sl=Oo(cl);return al.year=Ls.year.utc,Ls.scale.utc=function(){return Ho(Zo.scale.linear(),al,sl)},Zo.text=dt(function(n){return n.responseText}),Zo.json=function(n,t){return mt(n,"application/json",Yo,t)},Zo.html=function(n,t){return mt(n,"text/html",Io,t)},Zo.xml=dt(function(n){return n.responseXML}),Zo}();
/**
 * angular-strap
 * @version v2.0.0-rc.2 - 2014-01-29
 * @link http://mgcrea.github.io/angular-strap
 * @author [object Object]
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
(function (window, document, undefined) {
  'use strict';
  angular.module('mgcrea.ngStrap', [
    'mgcrea.ngStrap.modal',
    'mgcrea.ngStrap.aside',
    'mgcrea.ngStrap.alert',
    'mgcrea.ngStrap.button',
    'mgcrea.ngStrap.select',
    'mgcrea.ngStrap.datepicker',
    'mgcrea.ngStrap.timepicker',
    'mgcrea.ngStrap.navbar',
    'mgcrea.ngStrap.tooltip',
    'mgcrea.ngStrap.popover',
    'mgcrea.ngStrap.dropdown',
    'mgcrea.ngStrap.typeahead',
    'mgcrea.ngStrap.scrollspy',
    'mgcrea.ngStrap.affix',
    'mgcrea.ngStrap.tab'
  ]);
  angular.module('mgcrea.ngStrap.affix', ['mgcrea.ngStrap.helpers.dimensions']).provider('$affix', function () {
    var defaults = this.defaults = { offsetTop: 'auto' };
    this.$get = [
      '$window',
      'dimensions',
      function ($window, dimensions) {
        var windowEl = angular.element($window);
        var bodyEl = angular.element($window.document.body);
        function AffixFactory(element, config) {
          var $affix = {};
          var options = angular.extend({}, defaults, config);
          var reset = 'affix affix-top affix-bottom', initialAffixTop = 0, initialOffsetTop = 0, affixed = null, unpin = null;
          var parent = element.parent();
          if (options.offsetParent) {
            if (options.offsetParent.match(/^\d+$/)) {
              for (var i = 0; i < options.offsetParent * 1 - 1; i++) {
                parent = parent.parent();
              }
            } else {
              parent = angular.element(options.offsetParent);
            }
          }
          var offsetTop = 0;
          if (options.offsetTop) {
            if (options.offsetTop === 'auto') {
              options.offsetTop = '+0';
            }
            if (options.offsetTop.match(/^[-+]\d+$/)) {
              initialAffixTop -= options.offsetTop * 1;
              if (options.offsetParent) {
                offsetTop = dimensions.offset(parent[0]).top + options.offsetTop * 1;
              } else {
                offsetTop = dimensions.offset(element[0]).top - dimensions.css(element[0], 'marginTop', true) + options.offsetTop * 1;
              }
            } else {
              offsetTop = options.offsetTop * 1;
            }
          }
          var offsetBottom = 0;
          if (options.offsetBottom) {
            if (options.offsetParent && options.offsetBottom.match(/^[-+]\d+$/)) {
              offsetBottom = $window.document.body.scrollHeight - (dimensions.offset(parent[0]).top + dimensions.height(parent[0])) + options.offsetBottom * 1 + 1;
            } else {
              offsetBottom = options.offsetBottom * 1;
            }
          }
          $affix.init = function () {
            initialOffsetTop = dimensions.offset(element[0]).top + initialAffixTop;
            windowEl.on('scroll', this.checkPosition);
            windowEl.on('click', this.checkPositionWithEventLoop);
            this.checkPosition();
            this.checkPositionWithEventLoop();
          };
          $affix.destroy = function () {
            windowEl.off('scroll', this.checkPosition);
            windowEl.off('click', this.checkPositionWithEventLoop);
          };
          $affix.checkPositionWithEventLoop = function () {
            setTimeout(this.checkPosition, 1);
          };
          $affix.checkPosition = function () {
            var scrollTop = $window.pageYOffset;
            var position = dimensions.offset(element[0]);
            var elementHeight = dimensions.height(element[0]);
            var affix = getRequiredAffixClass(unpin, position, elementHeight);
            if (affixed === affix)
              return;
            affixed = affix;
            element.removeClass(reset).addClass('affix' + (affix !== 'middle' ? '-' + affix : ''));
            if (affix === 'top') {
              unpin = null;
              element.css('position', options.offsetParent ? '' : 'relative');
              element.css('top', '');
            } else if (affix === 'bottom') {
              if (options.offsetUnpin) {
                unpin = -(options.offsetUnpin * 1);
              } else {
                unpin = position.top - scrollTop;
              }
              element.css('position', options.offsetParent ? '' : 'relative');
              element.css('top', options.offsetParent ? '' : bodyEl[0].offsetHeight - offsetBottom - elementHeight - initialOffsetTop + 'px');
            } else {
              unpin = null;
              element.css('position', 'fixed');
              element.css('top', initialAffixTop + 'px');
            }
          };
          function getRequiredAffixClass(unpin, position, elementHeight) {
            var scrollTop = $window.pageYOffset;
            var scrollHeight = $window.document.body.scrollHeight;
            if (scrollTop <= offsetTop) {
              return 'top';
            } else if (unpin !== null && scrollTop + unpin <= position.top) {
              return 'middle';
            } else if (offsetBottom !== null && position.top + elementHeight + initialAffixTop >= scrollHeight - offsetBottom) {
              return 'bottom';
            } else {
              return 'middle';
            }
          }
          $affix.init();
          return $affix;
        }
        return AffixFactory;
      }
    ];
  }).directive('bsAffix', [
    '$affix',
    'dimensions',
    function ($affix, dimensions) {
      return {
        restrict: 'EAC',
        link: function postLink(scope, element, attr) {
          var options = {
              scope: scope,
              offsetTop: 'auto'
            };
          angular.forEach([
            'offsetTop',
            'offsetBottom',
            'offsetParent',
            'offsetUnpin'
          ], function (key) {
            if (angular.isDefined(attr[key]))
              options[key] = attr[key];
          });
          var affix = $affix(element, options);
          scope.$on('$destroy', function () {
            options = null;
            affix = null;
          });
        }
      };
    }
  ]);
  angular.module('mgcrea.ngStrap.alert', []).provider('$alert', function () {
    var defaults = this.defaults = {
        animation: 'am-fade',
        prefixClass: 'alert',
        placement: null,
        template: 'alert/alert.tpl.html',
        container: false,
        element: null,
        backdrop: false,
        keyboard: true,
        show: true,
        duration: false,
        type: false
      };
    this.$get = [
      '$modal',
      '$timeout',
      function ($modal, $timeout) {
        function AlertFactory(config) {
          var $alert = {};
          var options = angular.extend({}, defaults, config);
          $alert = $modal(options);
          if (options.type) {
            $alert.$scope.type = options.type;
          }
          var show = $alert.show;
          if (options.duration) {
            $alert.show = function () {
              show();
              $timeout(function () {
                $alert.hide();
              }, options.duration * 1000);
            };
          }
          return $alert;
        }
        return AlertFactory;
      }
    ];
  }).directive('bsAlert', [
    '$window',
    '$location',
    '$sce',
    '$alert',
    function ($window, $location, $sce, $alert) {
      var requestAnimationFrame = $window.requestAnimationFrame || $window.setTimeout;
      return {
        restrict: 'EAC',
        scope: true,
        link: function postLink(scope, element, attr, transclusion) {
          var options = {
              scope: scope,
              element: element,
              show: false
            };
          angular.forEach([
            'template',
            'placement',
            'keyboard',
            'html',
            'container',
            'animation',
            'duration'
          ], function (key) {
            if (angular.isDefined(attr[key]))
              options[key] = attr[key];
          });
          angular.forEach([
            'title',
            'content',
            'type'
          ], function (key) {
            attr[key] && attr.$observe(key, function (newValue, oldValue) {
              scope[key] = newValue;
            });
          });
          attr.bsAlert && scope.$watch(attr.bsAlert, function (newValue, oldValue) {
            if (angular.isObject(newValue)) {
              angular.extend(scope, newValue);
            } else {
              scope.content = newValue;
            }
          }, true);
          var alert = $alert(options);
          element.on(attr.trigger || 'click', alert.toggle);
          scope.$on('$destroy', function () {
            alert.destroy();
            options = null;
            alert = null;
          });
        }
      };
    }
  ]);
  angular.module('mgcrea.ngStrap.aside', ['mgcrea.ngStrap.modal']).provider('$aside', function () {
    var defaults = this.defaults = {
        animation: 'am-fade-and-slide-right',
        prefixClass: 'aside',
        placement: 'right',
        template: 'aside/aside.tpl.html',
        contentTemplate: false,
        container: false,
        element: null,
        backdrop: true,
        keyboard: true,
        html: false,
        show: true
      };
    this.$get = [
      '$modal',
      function ($modal) {
        function AsideFactory(config) {
          var $aside = {};
          var options = angular.extend({}, defaults, config);
          $aside = $modal(options);
          return $aside;
        }
        return AsideFactory;
      }
    ];
  }).directive('bsAside', [
    '$window',
    '$location',
    '$sce',
    '$aside',
    function ($window, $location, $sce, $aside) {
      var requestAnimationFrame = $window.requestAnimationFrame || $window.setTimeout;
      return {
        restrict: 'EAC',
        scope: true,
        link: function postLink(scope, element, attr, transclusion) {
          var options = {
              scope: scope,
              element: element,
              show: false
            };
          angular.forEach([
            'template',
            'contentTemplate',
            'placement',
            'backdrop',
            'keyboard',
            'html',
            'container',
            'animation'
          ], function (key) {
            if (angular.isDefined(attr[key]))
              options[key] = attr[key];
          });
          angular.forEach([
            'title',
            'content'
          ], function (key) {
            attr[key] && attr.$observe(key, function (newValue, oldValue) {
              scope[key] = newValue;
            });
          });
          attr.bsAside && scope.$watch(attr.bsAside, function (newValue, oldValue) {
            if (angular.isObject(newValue)) {
              angular.extend(scope, newValue);
            } else {
              scope.content = newValue;
            }
          }, true);
          var aside = $aside(options);
          element.on(attr.trigger || 'click', aside.toggle);
          scope.$on('$destroy', function () {
            aside.destroy();
            options = null;
            aside = null;
          });
        }
      };
    }
  ]);
  angular.module('mgcrea.ngStrap.button', []).provider('$button', function () {
    var defaults = this.defaults = {
        activeClass: 'active',
        toggleEvent: 'click'
      };
    this.$get = function () {
      return { defaults: defaults };
    };
  }).directive('bsCheckboxGroup', function () {
    return {
      restrict: 'A',
      require: 'ngModel',
      compile: function postLink(element, attr) {
        element.attr('data-toggle', 'buttons');
        element.removeAttr('ng-model');
        var children = element[0].querySelectorAll('input[type="checkbox"]');
        angular.forEach(children, function (child) {
          var childEl = angular.element(child);
          childEl.attr('bs-checkbox', '');
          childEl.attr('ng-model', attr.ngModel + '.' + childEl.attr('value'));
        });
      }
    };
  }).directive('bsCheckbox', [
    '$button',
    function ($button) {
      var defaults = $button.defaults;
      var constantValueRegExp = /^(true|false|\d+)$/;
      return {
        restrict: 'A',
        require: 'ngModel',
        link: function postLink(scope, element, attr, controller) {
          var options = defaults;
          var isInput = element[0].nodeName === 'INPUT';
          var activeElement = isInput ? element.parent() : element;
          var trueValue = angular.isDefined(attr.trueValue) ? attr.trueValue : true;
          if (constantValueRegExp.test(attr.trueValue)) {
            trueValue = scope.$eval(attr.trueValue);
          }
          var falseValue = angular.isDefined(attr.falseValue) ? attr.falseValue : false;
          if (constantValueRegExp.test(attr.falseValue)) {
            falseValue = scope.$eval(attr.falseValue);
          }
          var hasExoticValues = typeof trueValue !== 'boolean' || typeof falseValue !== 'boolean';
          if (hasExoticValues) {
            controller.$parsers.push(function (viewValue) {
              return viewValue ? trueValue : falseValue;
            });
            scope.$watch(attr.ngModel, function (newValue, oldValue) {
              controller.$render();
            });
          }
          controller.$render = function () {
            var isActive = angular.equals(controller.$modelValue, trueValue);
            if (isInput) {
              element[0].checked = isActive;
            }
            activeElement.toggleClass(options.activeClass, isActive);
          };
          element.bind(options.toggleEvent, function () {
            scope.$apply(function () {
              if (!isInput) {
                controller.$setViewValue(!activeElement.hasClass('active'));
              }
              if (!hasExoticValues) {
                controller.$render();
              }
            });
          });
        }
      };
    }
  ]).directive('bsRadioGroup', function () {
    return {
      restrict: 'A',
      require: 'ngModel',
      compile: function postLink(element, attr) {
        element.attr('data-toggle', 'buttons');
        element.removeAttr('ng-model');
        var children = element[0].querySelectorAll('input[type="radio"]');
        angular.forEach(children, function (child) {
          angular.element(child).attr('bs-radio', '');
          angular.element(child).attr('ng-model', attr.ngModel);
        });
      }
    };
  }).directive('bsRadio', [
    '$button',
    function ($button) {
      var defaults = $button.defaults;
      var constantValueRegExp = /^(true|false|\d+)$/;
      return {
        restrict: 'A',
        require: 'ngModel',
        link: function postLink(scope, element, attr, controller) {
          var options = defaults;
          var isInput = element[0].nodeName === 'INPUT';
          var activeElement = isInput ? element.parent() : element;
          var value = constantValueRegExp.test(attr.value) ? scope.$eval(attr.value) : attr.value;
          controller.$render = function () {
            var isActive = angular.equals(controller.$modelValue, value);
            if (isInput) {
              element[0].checked = isActive;
            }
            activeElement.toggleClass(options.activeClass, isActive);
          };
          element.bind(options.toggleEvent, function () {
            scope.$apply(function () {
              controller.$setViewValue(value);
              controller.$render();
            });
          });
        }
      };
    }
  ]);
  angular.module('mgcrea.ngStrap.datepicker', [
    'mgcrea.ngStrap.helpers.dateParser',
    'mgcrea.ngStrap.tooltip'
  ]).provider('$datepicker', function () {
    var defaults = this.defaults = {
        animation: 'am-fade',
        prefixClass: 'datepicker',
        placement: 'bottom-left',
        template: 'datepicker/datepicker.tpl.html',
        trigger: 'focus',
        container: false,
        keyboard: true,
        html: false,
        delay: 0,
        useNative: false,
        dateType: 'date',
        dateFormat: 'shortDate',
        autoclose: false,
        minDate: -Infinity,
        maxDate: +Infinity,
        startView: 0,
        minView: 0,
        weekStart: 0
      };
    this.$get = [
      '$window',
      '$document',
      '$rootScope',
      '$sce',
      '$locale',
      'dateFilter',
      'datepickerViews',
      '$tooltip',
      function ($window, $document, $rootScope, $sce, $locale, dateFilter, datepickerViews, $tooltip) {
        var bodyEl = angular.element($window.document.body);
        var isTouch = 'createTouch' in $window.document;
        var isAppleTouch = /(iP(a|o)d|iPhone)/g.test($window.navigator.userAgent);
        if (!defaults.lang)
          defaults.lang = $locale.id;
        function DatepickerFactory(element, controller, config) {
          var $datepicker = $tooltip(element, angular.extend({}, defaults, config));
          var parentScope = config.scope;
          var options = $datepicker.$options;
          var scope = $datepicker.$scope;
          var pickerViews = datepickerViews($datepicker);
          $datepicker.$views = pickerViews.views;
          var viewDate = pickerViews.viewDate;
          scope.$mode = options.startView;
          var $picker = $datepicker.$views[scope.$mode];
          scope.$select = function (date) {
            $datepicker.select(date);
          };
          scope.$selectPane = function (value) {
            $datepicker.$selectPane(value);
          };
          scope.$toggleMode = function () {
            $datepicker.setMode((scope.$mode + 1) % $datepicker.$views.length);
          };
          $datepicker.update = function (date) {
            if (!isNaN(date.getTime())) {
              $datepicker.$date = date;
              $picker.update.call($picker, date);
            } else if (!$picker.built) {
              $datepicker.$build();
            }
          };
          $datepicker.select = function (date, keep) {
            if (!angular.isDate(date))
              date = new Date(date);
            controller.$dateValue.setFullYear(date.getFullYear(), date.getMonth(), date.getDate());
            if (!scope.$mode || keep) {
              controller.$setViewValue(controller.$dateValue);
              controller.$render();
              if (options.autoclose && !keep) {
                $datepicker.hide(true);
              }
            } else {
              angular.extend(viewDate, {
                year: date.getFullYear(),
                month: date.getMonth(),
                date: date.getDate()
              });
              $datepicker.setMode(scope.$mode - 1);
              $datepicker.$build();
            }
          };
          $datepicker.setMode = function (mode) {
            scope.$mode = mode;
            $picker = $datepicker.$views[scope.$mode];
            $datepicker.$build();
          };
          $datepicker.$build = function () {
            $picker.build.call($picker);
          };
          $datepicker.$updateSelected = function () {
            for (var i = 0, l = scope.rows.length; i < l; i++) {
              angular.forEach(scope.rows[i], updateSelected);
            }
          };
          $datepicker.$isSelected = function (date) {
            return $picker.isSelected(date);
          };
          $datepicker.$selectPane = function (value) {
            var steps = $picker.steps;
            var targetDate = new Date(Date.UTC(viewDate.year + (steps.year || 0) * value, viewDate.month + (steps.month || 0) * value, viewDate.date + (steps.day || 0) * value));
            angular.extend(viewDate, {
              year: targetDate.getUTCFullYear(),
              month: targetDate.getUTCMonth(),
              date: targetDate.getUTCDate()
            });
            $datepicker.$build();
          };
          $datepicker.$onMouseDown = function (evt) {
            evt.preventDefault();
            evt.stopPropagation();
            if (isTouch) {
              var targetEl = angular.element(evt.target);
              if (targetEl[0].nodeName.toLowerCase() !== 'button') {
                targetEl = targetEl.parent();
              }
              targetEl.triggerHandler('click');
            }
          };
          $datepicker.$onKeyDown = function (evt) {
            if (!/(38|37|39|40|13)/.test(evt.keyCode) || evt.shiftKey || evt.altKey)
              return;
            evt.preventDefault();
            evt.stopPropagation();
            if (evt.keyCode === 13) {
              if (!scope.$mode) {
                return $datepicker.hide(true);
              } else {
                return scope.$apply(function () {
                  $datepicker.setMode(scope.$mode - 1);
                });
              }
            }
            $picker.onKeyDown(evt);
            parentScope.$digest();
          };
          function updateSelected(el) {
            el.selected = $datepicker.$isSelected(el.date);
          }
          function focusElement() {
            element[0].focus();
          }
          var _init = $datepicker.init;
          $datepicker.init = function () {
            if (isAppleTouch && options.useNative) {
              element.prop('type', 'date');
              element.css('-webkit-appearance', 'textfield');
              return;
            } else if (isTouch) {
              element.prop('type', 'text');
              element.attr('readonly', 'true');
              element.on('click', focusElement);
            }
            _init();
          };
          var _destroy = $datepicker.destroy;
          $datepicker.destroy = function () {
            if (isAppleTouch && options.useNative) {
              element.off('click', focusElement);
            }
            _destroy();
          };
          var _show = $datepicker.show;
          $datepicker.show = function () {
            _show();
            setTimeout(function () {
              $datepicker.$element.on(isTouch ? 'touchstart' : 'mousedown', $datepicker.$onMouseDown);
              if (options.keyboard) {
                element.on('keydown', $datepicker.$onKeyDown);
              }
            });
          };
          var _hide = $datepicker.hide;
          $datepicker.hide = function (blur) {
            $datepicker.$element.off(isTouch ? 'touchstart' : 'mousedown', $datepicker.$onMouseDown);
            if (options.keyboard) {
              element.off('keydown', $datepicker.$onKeyDown);
            }
            _hide(blur);
          };
          return $datepicker;
        }
        DatepickerFactory.defaults = defaults;
        return DatepickerFactory;
      }
    ];
  }).directive('bsDatepicker', [
    '$window',
    '$parse',
    '$q',
    '$locale',
    'dateFilter',
    '$datepicker',
    '$dateParser',
    '$timeout',
    function ($window, $parse, $q, $locale, dateFilter, $datepicker, $dateParser, $timeout) {
      var isAppleTouch = /(iP(a|o)d|iPhone)/g.test($window.navigator.userAgent);
      var requestAnimationFrame = $window.requestAnimationFrame || $window.setTimeout;
      return {
        restrict: 'EAC',
        require: 'ngModel',
        link: function postLink(scope, element, attr, controller) {
          var options = {
              scope: scope,
              controller: controller
            };
          angular.forEach([
            'placement',
            'container',
            'delay',
            'trigger',
            'keyboard',
            'html',
            'animation',
            'template',
            'autoclose',
            'dateType',
            'dateFormat',
            'useNative',
            'lang'
          ], function (key) {
            if (angular.isDefined(attr[key]))
              options[key] = attr[key];
          });
          if (isAppleTouch && options.useNative)
            options.dateFormat = 'yyyy-MM-dd';
          var datepicker = $datepicker(element, controller, options);
          options = datepicker.$options;
          angular.forEach([
            'minDate',
            'maxDate'
          ], function (key) {
            angular.isDefined(attr[key]) && attr.$observe(key, function (newValue) {
              if (newValue === 'today') {
                var today = new Date();
                datepicker.$options[key] = +new Date(today.getFullYear(), today.getMonth(), today.getDate() + (key === 'maxDate' ? 1 : 0), 0, 0, 0, key === 'minDate' ? 0 : -1);
              } else if (angular.isString(newValue) && newValue.match(/^".+"$/)) {
                datepicker.$options[key] = +new Date(newValue.substr(1, newValue.length - 2));
              } else {
                datepicker.$options[key] = +new Date(newValue);
              }
              !isNaN(datepicker.$options[key]) && datepicker.$build();
            });
          });
          scope.$watch(attr.ngModel, function (newValue, oldValue) {
            datepicker.update(controller.$dateValue);
          }, true);
          var dateParser = $dateParser({
              format: options.dateFormat,
              lang: options.lang
            });
          controller.$parsers.unshift(function (viewValue) {
            var parsedDate = dateParser.parse(viewValue, controller.$dateValue);
            if (!parsedDate || isNaN(parsedDate.getTime())) {
              controller.$setValidity('date', false);
            } else {
              var isValid = parsedDate.getTime() >= options.minDate && parsedDate.getTime() <= options.maxDate;
              controller.$setValidity('date', isValid);
              if (isValid)
                controller.$dateValue = parsedDate;
            }
            controller.$dateValue = parsedDate;
            if (options.dateType === 'string') {
              return dateFilter(viewValue, options.dateFormat);
            } else if (options.dateType === 'number') {
              return controller.$dateValue.getTime();
            } else if (options.dateType === 'iso') {
              return controller.$dateValue.toISOString();
            } else {
              return controller.$dateValue;
            }
          });
          controller.$formatters.push(function (modelValue) {
            var date = angular.isDate(modelValue) ? modelValue : new Date(modelValue);
            controller.$dateValue = date;
            return controller.$dateValue;
          });
          controller.$render = function () {
            element.val(isNaN(controller.$dateValue.getTime()) ? '' : dateFilter(controller.$dateValue, options.dateFormat));
          };
          scope.$on('$destroy', function () {
            datepicker.destroy();
            options = null;
            datepicker = null;
          });
        }
      };
    }
  ]).provider('datepickerViews', function () {
    var defaults = this.defaults = {
        dayFormat: 'dd',
        daySplit: 7
      };
    function split(arr, size) {
      var arrays = [];
      while (arr.length > 0) {
        arrays.push(arr.splice(0, size));
      }
      return arrays;
    }
    this.$get = [
      '$locale',
      '$sce',
      'dateFilter',
      function ($locale, $sce, dateFilter) {
        return function (picker) {
          var scope = picker.$scope;
          var options = picker.$options;
          var weekDaysMin = $locale.DATETIME_FORMATS.SHORTDAY;
          var weekDaysLabels = weekDaysMin.slice(options.weekStart).concat(weekDaysMin.slice(0, options.weekStart));
          var dayLabelHtml = $sce.trustAsHtml('<th class="dow text-center">' + weekDaysLabels.join('</th><th class="dow text-center">') + '</th>');
          var startDate = picker.$date || new Date();
          var viewDate = {
              year: startDate.getFullYear(),
              month: startDate.getMonth(),
              date: startDate.getDate()
            };
          var timezoneOffset = startDate.getTimezoneOffset() * 60000;
          var views = [
              {
                format: 'dd',
                split: 7,
                steps: { month: 1 },
                update: function (date, force) {
                  if (!this.built || force || date.getFullYear() !== viewDate.year || date.getMonth() !== viewDate.month) {
                    angular.extend(viewDate, {
                      year: picker.$date.getFullYear(),
                      month: picker.$date.getMonth(),
                      date: picker.$date.getDate()
                    });
                    picker.$build();
                  } else if (date.getDate() !== viewDate.date) {
                    viewDate.date = picker.$date.getDate();
                    picker.$updateSelected();
                  }
                },
                build: function () {
                  var firstDayOfMonth = new Date(viewDate.year, viewDate.month, 1);
                  var firstDate = new Date(+firstDayOfMonth - (firstDayOfMonth.getDay() - options.weekStart) * 86400000);
                  var days = [], day;
                  for (var i = 0; i < 35; i++) {
                    day = new Date(firstDate.getFullYear(), firstDate.getMonth(), firstDate.getDate() + i);
                    days.push({
                      date: day,
                      label: dateFilter(day, this.format),
                      selected: picker.$date && this.isSelected(day),
                      muted: day.getMonth() !== viewDate.month,
                      disabled: this.isDisabled(day)
                    });
                  }
                  scope.title = dateFilter(firstDayOfMonth, 'MMMM yyyy');
                  scope.labels = dayLabelHtml;
                  scope.rows = split(days, this.split);
                  this.built = true;
                },
                isSelected: function (date) {
                  return picker.$date && date.getFullYear() === picker.$date.getFullYear() && date.getMonth() === picker.$date.getMonth() && date.getDate() === picker.$date.getDate();
                },
                isDisabled: function (date) {
                  return date.getTime() < options.minDate || date.getTime() > options.maxDate;
                },
                onKeyDown: function (evt) {
                  var actualTime = picker.$date.getTime();
                  if (evt.keyCode === 37)
                    picker.select(new Date(actualTime - 1 * 86400000), true);
                  else if (evt.keyCode === 38)
                    picker.select(new Date(actualTime - 7 * 86400000), true);
                  else if (evt.keyCode === 39)
                    picker.select(new Date(actualTime + 1 * 86400000), true);
                  else if (evt.keyCode === 40)
                    picker.select(new Date(actualTime + 7 * 86400000), true);
                }
              },
              {
                name: 'month',
                format: 'MMM',
                split: 4,
                steps: { year: 1 },
                update: function (date, force) {
                  if (!this.built || date.getFullYear() !== viewDate.year) {
                    angular.extend(viewDate, {
                      year: picker.$date.getFullYear(),
                      month: picker.$date.getMonth(),
                      date: picker.$date.getDate()
                    });
                    picker.$build();
                  } else if (date.getMonth() !== viewDate.month) {
                    angular.extend(viewDate, {
                      month: picker.$date.getMonth(),
                      date: picker.$date.getDate()
                    });
                    picker.$updateSelected();
                  }
                },
                build: function () {
                  var firstMonth = new Date(viewDate.year, 0, 1);
                  var months = [], month;
                  for (var i = 0; i < 12; i++) {
                    month = new Date(viewDate.year, i, 1);
                    months.push({
                      date: month,
                      label: dateFilter(month, this.format),
                      selected: picker.$isSelected(month),
                      disabled: this.isDisabled(month)
                    });
                  }
                  scope.title = dateFilter(month, 'yyyy');
                  scope.labels = false;
                  scope.rows = split(months, this.split);
                  this.built = true;
                },
                isSelected: function (date) {
                  return picker.$date && date.getFullYear() === picker.$date.getFullYear() && date.getMonth() === picker.$date.getMonth();
                },
                isDisabled: function (date) {
                  var lastDate = +new Date(date.getFullYear(), date.getMonth() + 1, 0);
                  return lastDate < options.minDate || date.getTime() > options.maxDate;
                },
                onKeyDown: function (evt) {
                  var actualMonth = picker.$date.getMonth();
                  if (evt.keyCode === 37)
                    picker.select(picker.$date.setMonth(actualMonth - 1), true);
                  else if (evt.keyCode === 38)
                    picker.select(picker.$date.setMonth(actualMonth - 4), true);
                  else if (evt.keyCode === 39)
                    picker.select(picker.$date.setMonth(actualMonth + 1), true);
                  else if (evt.keyCode === 40)
                    picker.select(picker.$date.setMonth(actualMonth + 4), true);
                }
              },
              {
                name: 'year',
                format: 'yyyy',
                split: 4,
                steps: { year: 12 },
                update: function (date, force) {
                  if (!this.built || force || parseInt(date.getFullYear() / 20, 10) !== parseInt(viewDate.year / 20, 10)) {
                    angular.extend(viewDate, {
                      year: picker.$date.getFullYear(),
                      month: picker.$date.getMonth(),
                      date: picker.$date.getDate()
                    });
                    picker.$build();
                  } else if (date.getFullYear() !== viewDate.year) {
                    angular.extend(viewDate, {
                      year: picker.$date.getFullYear(),
                      month: picker.$date.getMonth(),
                      date: picker.$date.getDate()
                    });
                    picker.$updateSelected();
                  }
                },
                build: function () {
                  var firstYear = viewDate.year - viewDate.year % (this.split * 3);
                  var years = [], year;
                  for (var i = 0; i < 12; i++) {
                    year = new Date(firstYear + i, 0, 1);
                    years.push({
                      date: year,
                      label: dateFilter(year, this.format),
                      selected: picker.$isSelected(year),
                      disabled: this.isDisabled(year)
                    });
                  }
                  scope.title = years[0].label + '-' + years[years.length - 1].label;
                  scope.labels = false;
                  scope.rows = split(years, this.split);
                  this.built = true;
                },
                isSelected: function (date) {
                  return picker.$date && date.getFullYear() === picker.$date.getFullYear();
                },
                isDisabled: function (date) {
                  var lastDate = +new Date(date.getFullYear() + 1, 0, 0);
                  return lastDate < options.minDate || date.getTime() > options.maxDate;
                },
                onKeyDown: function (evt) {
                  var actualYear = picker.$date.getFullYear();
                  if (evt.keyCode === 37)
                    picker.select(picker.$date.setYear(actualYear - 1), true);
                  else if (evt.keyCode === 38)
                    picker.select(picker.$date.setYear(actualYear - 4), true);
                  else if (evt.keyCode === 39)
                    picker.select(picker.$date.setYear(actualYear + 1), true);
                  else if (evt.keyCode === 40)
                    picker.select(picker.$date.setYear(actualYear + 4), true);
                }
              }
            ];
          return {
            views: options.minView ? Array.prototype.slice.call(views, options.minView) : views,
            viewDate: viewDate
          };
        };
      }
    ];
  });
  angular.module('mgcrea.ngStrap.dropdown', ['mgcrea.ngStrap.tooltip']).provider('$dropdown', function () {
    var defaults = this.defaults = {
        animation: 'am-fade',
        prefixClass: 'dropdown',
        placement: 'bottom-left',
        template: 'dropdown/dropdown.tpl.html',
        trigger: 'click',
        container: false,
        keyboard: true,
        html: false,
        delay: 0
      };
    this.$get = [
      '$window',
      '$tooltip',
      function ($window, $tooltip) {
        var bodyEl = angular.element($window.document.body);
        var matchesSelector = Element.prototype.matchesSelector || Element.prototype.webkitMatchesSelector || Element.prototype.mozMatchesSelector || Element.prototype.msMatchesSelector || Element.prototype.oMatchesSelector;
        function DropdownFactory(element, config) {
          var $dropdown = {};
          var options = angular.extend({}, defaults, config);
          $dropdown = $tooltip(element, options);
          $dropdown.$onKeyDown = function (evt) {
            if (!/(38|40)/.test(evt.keyCode))
              return;
            evt.preventDefault();
            evt.stopPropagation();
            var items = angular.element($dropdown.$element[0].querySelectorAll('li:not(.divider) a'));
            if (!items.length)
              return;
            var index;
            angular.forEach(items, function (el, i) {
              if (matchesSelector && matchesSelector.call(el, ':focus'))
                index = i;
            });
            if (evt.keyCode === 38 && index > 0)
              index--;
            else if (evt.keyCode === 40 && index < items.length - 1)
              index++;
            else if (angular.isUndefined(index))
              index = 0;
            items.eq(index)[0].focus();
          };
          var show = $dropdown.show;
          $dropdown.show = function () {
            show();
            setTimeout(function () {
              options.keyboard && $dropdown.$element.on('keydown', $dropdown.$onKeyDown);
              bodyEl.on('click', onBodyClick);
            });
          };
          var hide = $dropdown.hide;
          $dropdown.hide = function () {
            options.keyboard && $dropdown.$element.off('keydown', $dropdown.$onKeyDown);
            bodyEl.off('click', onBodyClick);
            hide();
          };
          function onBodyClick(evt) {
            if (evt.target === element[0])
              return;
            return evt.target !== element[0] && $dropdown.hide();
          }
          return $dropdown;
        }
        return DropdownFactory;
      }
    ];
  }).directive('bsDropdown', [
    '$window',
    '$location',
    '$sce',
    '$dropdown',
    function ($window, $location, $sce, $dropdown) {
      return {
        restrict: 'EAC',
        scope: true,
        link: function postLink(scope, element, attr, transclusion) {
          var options = { scope: scope };
          angular.forEach([
            'placement',
            'container',
            'delay',
            'trigger',
            'keyboard',
            'html',
            'animation',
            'template'
          ], function (key) {
            if (angular.isDefined(attr[key]))
              options[key] = attr[key];
          });
          attr.bsDropdown && scope.$watch(attr.bsDropdown, function (newValue, oldValue) {
            scope.content = newValue;
          }, true);
          var dropdown = $dropdown(element, options);
          scope.$on('$destroy', function () {
            dropdown.destroy();
            options = null;
            dropdown = null;
          });
        }
      };
    }
  ]);
  angular.module('mgcrea.ngStrap.helpers.dateParser', []).provider('$dateParser', [
    '$localeProvider',
    function ($localeProvider) {
      var proto = Date.prototype;
      function isNumeric(n) {
        return !isNaN(parseFloat(n)) && isFinite(n);
      }
      var defaults = this.defaults = {
          format: 'shortDate',
          strict: false
        };
      this.$get = [
        '$locale',
        function ($locale) {
          var DateParserFactory = function (config) {
            var options = angular.extend({}, defaults, config);
            var $dateParser = {};
            var regExpMap = {
                'sss': '[0-9]{3}',
                'ss': '[0-5][0-9]',
                's': options.strict ? '[1-5]?[0-9]' : '[0-5][0-9]',
                'mm': '[0-5][0-9]',
                'm': options.strict ? '[1-5]?[0-9]' : '[0-5][0-9]',
                'HH': '[01][0-9]|2[0-3]',
                'H': options.strict ? '[0][1-9]|[1][012]' : '[01][0-9]|2[0-3]',
                'hh': '[0][1-9]|[1][012]',
                'h': options.strict ? '[1-9]|[1][012]' : '[0]?[1-9]|[1][012]',
                'a': 'AM|PM',
                'EEEE': $locale.DATETIME_FORMATS.DAY.join('|'),
                'EEE': $locale.DATETIME_FORMATS.SHORTDAY.join('|'),
                'dd': '[0-2][0-9]{1}|[3][01]{1}',
                'd': options.strict ? '[1-2]?[0-9]{1}|[3][01]{1}' : '[0-2][0-9]{1}|[3][01]{1}',
                'MMMM': $locale.DATETIME_FORMATS.MONTH.join('|'),
                'MMM': $locale.DATETIME_FORMATS.SHORTMONTH.join('|'),
                'MM': '[0][1-9]|[1][012]',
                'M': options.strict ? '[1-9]|[1][012]' : '[0][1-9]|[1][012]',
                'yyyy': '(?:(?:[1]{1}[0-9]{1}[0-9]{1}[0-9]{1})|(?:[2]{1}[0-9]{3}))(?![[0-9]])',
                'yy': '(?:(?:[0-9]{1}[0-9]{1}))(?![[0-9]])'
              };
            var setFnMap = {
                'sss': proto.setMilliseconds,
                'ss': proto.setSeconds,
                's': proto.setSeconds,
                'mm': proto.setMinutes,
                'm': proto.setMinutes,
                'HH': proto.setHours,
                'H': proto.setHours,
                'hh': proto.setHours,
                'h': proto.setHours,
                'dd': proto.setDate,
                'd': proto.setDate,
                'a': function (value) {
                  var hours = this.getHours();
                  return this.setHours(value.match(/pm/i) ? hours + 12 : hours);
                },
                'MMMM': function (value) {
                  return this.setMonth($locale.DATETIME_FORMATS.MONTH.indexOf(value));
                },
                'MMM': function (value) {
                  return this.setMonth($locale.DATETIME_FORMATS.SHORTMONTH.indexOf(value));
                },
                'MM': function (value) {
                  return this.setMonth(1 * value - 1);
                },
                'M': function (value) {
                  return this.setMonth(1 * value - 1);
                },
                'yyyy': proto.setFullYear,
                'yy': function (value) {
                  return this.setFullYear(2000 + 1 * value);
                },
                'y': proto.setFullYear
              };
            var regex, setMap;
            $dateParser.init = function () {
              $dateParser.$format = $locale.DATETIME_FORMATS[options.format] || options.format;
              regex = regExpForFormat($dateParser.$format);
              setMap = setMapForFormat($dateParser.$format);
            };
            $dateParser.isValid = function (date) {
              if (angular.isDate(date))
                return !isNaN(date.getTime());
              return regex.test(date);
            };
            $dateParser.parse = function (value, baseDate) {
              if (angular.isDate(value))
                return value;
              var matches = regex.exec(value);
              if (!matches)
                return false;
              var date = baseDate || new Date(0);
              for (var i = 0; i < matches.length - 1; i++) {
                setMap[i] && setMap[i].call(date, matches[i + 1]);
              }
              return date;
            };
            function setMapForFormat(format) {
              var keys = Object.keys(setFnMap), i;
              var map = [], sortedMap = [];
              var clonedFormat = format;
              for (i = 0; i < keys.length; i++) {
                if (format.split(keys[i]).length > 1) {
                  var index = clonedFormat.search(keys[i]);
                  format = format.split(keys[i]).join('');
                  if (setFnMap[keys[i]])
                    map[index] = setFnMap[keys[i]];
                }
              }
              angular.forEach(map, function (v) {
                sortedMap.push(v);
              });
              return sortedMap;
            }
            function escapeReservedSymbols(text) {
              return text.replace(/\//g, '[\\/]').replace('/-/g', '[-]').replace(/\./g, '[.]').replace(/\\s/g, '[\\s]');
            }
            function regExpForFormat(format) {
              var keys = Object.keys(regExpMap), i;
              var re = format;
              for (i = 0; i < keys.length; i++) {
                re = re.split(keys[i]).join('${' + i + '}');
              }
              for (i = 0; i < keys.length; i++) {
                re = re.split('${' + i + '}').join('(' + regExpMap[keys[i]] + ')');
              }
              format = escapeReservedSymbols(format);
              return new RegExp('^' + re + '$', ['i']);
            }
            $dateParser.init();
            return $dateParser;
          };
          return DateParserFactory;
        }
      ];
    }
  ]);
  angular.module('mgcrea.ngStrap.helpers.debounce', []).constant('debounce', function (func, wait, immediate) {
    var timeout, args, context, timestamp, result;
    return function () {
      context = this;
      args = arguments;
      timestamp = new Date();
      var later = function () {
        var last = new Date() - timestamp;
        if (last < wait) {
          timeout = setTimeout(later, wait - last);
        } else {
          timeout = null;
          if (!immediate)
            result = func.apply(context, args);
        }
      };
      var callNow = immediate && !timeout;
      if (!timeout) {
        timeout = setTimeout(later, wait);
      }
      if (callNow)
        result = func.apply(context, args);
      return result;
    };
  }).constant('throttle', function (func, wait, options) {
    var context, args, result;
    var timeout = null;
    var previous = 0;
    options || (options = {});
    var later = function () {
      previous = options.leading === false ? 0 : new Date();
      timeout = null;
      result = func.apply(context, args);
    };
    return function () {
      var now = new Date();
      if (!previous && options.leading === false)
        previous = now;
      var remaining = wait - (now - previous);
      context = this;
      args = arguments;
      if (remaining <= 0) {
        clearTimeout(timeout);
        timeout = null;
        previous = now;
        result = func.apply(context, args);
      } else if (!timeout && options.trailing !== false) {
        timeout = setTimeout(later, remaining);
      }
      return result;
    };
  });
  angular.module('mgcrea.ngStrap.helpers.dimensions', []).factory('dimensions', [
    '$document',
    '$window',
    function ($document, $window) {
      var jqLite = angular.element;
      var fn = {};
      var nodeName = fn.nodeName = function (element, name) {
          return element.nodeName && element.nodeName.toLowerCase() === name.toLowerCase();
        };
      fn.css = function (element, prop, extra) {
        var value;
        if (element.currentStyle) {
          value = element.currentStyle[prop];
        } else if (window.getComputedStyle) {
          value = window.getComputedStyle(element)[prop];
        } else {
          value = element.style[prop];
        }
        return extra === true ? parseFloat(value) || 0 : value;
      };
      fn.offset = function (element) {
        var boxRect = element.getBoundingClientRect();
        var docElement = element.ownerDocument;
        return {
          width: element.offsetWidth,
          height: element.offsetHeight,
          top: boxRect.top + (window.pageYOffset || docElement.documentElement.scrollTop) - (docElement.documentElement.clientTop || 0),
          left: boxRect.left + (window.pageXOffset || docElement.documentElement.scrollLeft) - (docElement.documentElement.clientLeft || 0)
        };
      };
      fn.position = function (element) {
        var offsetParentRect = {
            top: 0,
            left: 0
          }, offsetParentElement, offset;
        if (fn.css(element, 'position') === 'fixed') {
          offset = element.getBoundingClientRect();
        } else {
          offsetParentElement = offsetParent(element);
          offset = fn.offset(element);
          offset = fn.offset(element);
          if (!nodeName(offsetParentElement, 'html')) {
            offsetParentRect = fn.offset(offsetParentElement);
          }
          offsetParentRect.top += fn.css(offsetParentElement, 'borderTopWidth', true);
          offsetParentRect.left += fn.css(offsetParentElement, 'borderLeftWidth', true);
        }
        return {
          width: element.offsetWidth,
          height: element.offsetHeight,
          top: offset.top - offsetParentRect.top - fn.css(element, 'marginTop', true),
          left: offset.left - offsetParentRect.left - fn.css(element, 'marginLeft', true)
        };
      };
      var offsetParent = function offsetParentElement(element) {
        var docElement = element.ownerDocument;
        var offsetParent = element.offsetParent || docElement;
        if (nodeName(offsetParent, '#document'))
          return docElement.documentElement;
        while (offsetParent && !nodeName(offsetParent, 'html') && fn.css(offsetParent, 'position') === 'static') {
          offsetParent = offsetParent.offsetParent;
        }
        return offsetParent || docElement.documentElement;
      };
      fn.height = function (element, outer) {
        var value = element.offsetHeight;
        if (outer) {
          value += fn.css(element, 'marginTop', true) + fn.css(element, 'marginBottom', true);
        } else {
          value -= fn.css(element, 'paddingTop', true) + fn.css(element, 'paddingBottom', true) + fn.css(element, 'borderTopWidth', true) + fn.css(element, 'borderBottomWidth', true);
        }
        return value;
      };
      fn.width = function (element, outer) {
        var value = element.offsetWidth;
        if (outer) {
          value += fn.css(element, 'marginLeft', true) + fn.css(element, 'marginRight', true);
        } else {
          value -= fn.css(element, 'paddingLeft', true) + fn.css(element, 'paddingRight', true) + fn.css(element, 'borderLeftWidth', true) + fn.css(element, 'borderRightWidth', true);
        }
        return value;
      };
      return fn;
    }
  ]);
  angular.module('mgcrea.ngStrap.helpers.parseOptions', []).provider('$parseOptions', function () {
    var defaults = this.defaults = { regexp: /^\s*(.*?)(?:\s+as\s+(.*?))?(?:\s+group\s+by\s+(.*))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(.*?)(?:\s+track\s+by\s+(.*?))?$/ };
    this.$get = [
      '$parse',
      '$q',
      function ($parse, $q) {
        function ParseOptionsFactory(attr, config) {
          var $parseOptions = {};
          var options = angular.extend({}, defaults, config);
          $parseOptions.$values = [];
          var match, displayFn, valueName, keyName, groupByFn, valueFn, valuesFn;
          $parseOptions.init = function () {
            $parseOptions.$match = match = attr.match(options.regexp);
            displayFn = $parse(match[2] || match[1]), valueName = match[4] || match[6], keyName = match[5], groupByFn = $parse(match[3] || ''), valueFn = $parse(match[2] ? match[1] : valueName), valuesFn = $parse(match[7]);
          };
          $parseOptions.valuesFn = function (scope, controller) {
            return $q.when(valuesFn(scope, controller)).then(function (values) {
              $parseOptions.$values = values ? parseValues(values) : {};
              return $parseOptions.$values;
            });
          };
          function parseValues(values) {
            return values.map(function (match) {
              var locals = {}, label, value;
              locals[valueName] = match;
              label = displayFn(locals);
              value = valueFn(locals);
              return {
                label: label,
                value: value
              };
            });
          }
          $parseOptions.init();
          return $parseOptions;
        }
        return ParseOptionsFactory;
      }
    ];
  });
  angular.module('mgcrea.ngStrap.modal', ['mgcrea.ngStrap.helpers.dimensions']).provider('$modal', function () {
    var defaults = this.defaults = {
        animation: 'am-fade',
        prefixClass: 'modal',
        placement: 'top',
        template: 'modal/modal.tpl.html',
        contentTemplate: false,
        container: false,
        element: null,
        backdrop: true,
        keyboard: true,
        html: false,
        show: true
      };
    this.$get = [
      '$window',
      '$rootScope',
      '$compile',
      '$q',
      '$templateCache',
      '$http',
      '$animate',
      '$timeout',
      'dimensions',
      function ($window, $rootScope, $compile, $q, $templateCache, $http, $animate, $timeout, dimensions) {
        var forEach = angular.forEach;
        var trim = String.prototype.trim;
        var requestAnimationFrame = $window.requestAnimationFrame || $window.setTimeout;
        var bodyElement = angular.element($window.document.body);
        var htmlReplaceRegExp = /ng-bind="/gi;
        var findElement = function (query, element) {
          return angular.element((element || document).querySelectorAll(query));
        };
        function ModalFactory(config) {
          var $modal = {};
          var options = angular.extend({}, defaults, config);
          $modal.$promise = $q.when($templateCache.get(options.template) || $http.get(options.template));
          var scope = $modal.$scope = options.scope && options.scope.$new() || $rootScope.$new();
          if (!options.element && !options.container) {
            options.container = 'body';
          }
          if (!options.scope) {
            forEach([
              'title',
              'content'
            ], function (key) {
              if (options[key])
                scope[key] = options[key];
            });
          }
          scope.$hide = function () {
            scope.$$postDigest(function () {
              $modal.hide();
            });
          };
          scope.$show = function () {
            scope.$$postDigest(function () {
              $modal.show();
            });
          };
          scope.$toggle = function () {
            scope.$$postDigest(function () {
              $modal.toggle();
            });
          };
          if (options.contentTemplate) {
            $modal.$promise = $modal.$promise.then(function (template) {
              if (angular.isObject(template))
                template = template.data;
              var templateEl = angular.element(template);
              return $q.when($templateCache.get(options.contentTemplate) || $http.get(options.contentTemplate)).then(function (contentTemplate) {
                if (angular.isObject(contentTemplate))
                  contentTemplate = contentTemplate.data;
                var contentEl = findElement('[ng-bind="content"]', templateEl[0]).removeAttr('ng-bind').html(contentTemplate);
                if (!config.template)
                  contentEl.next().remove();
                return templateEl[0].outerHTML;
              });
            });
          }
          var modalLinker, modalElement;
          var backdropElement = angular.element('<div class="' + options.prefixClass + '-backdrop"/>');
          $modal.$promise.then(function (template) {
            if (angular.isObject(template))
              template = template.data;
            if (options.html)
              template = template.replace(htmlReplaceRegExp, 'ng-bind-html="');
            template = trim.apply(template);
            modalLinker = $compile(template);
            $modal.init();
          });
          $modal.init = function () {
            if (options.show) {
              scope.$$postDigest(function () {
                $modal.show();
              });
            }
          };
          $modal.destroy = function () {
            if (modalElement) {
              modalElement.remove();
              modalElement = null;
            }
            if (backdropElement) {
              backdropElement.remove();
              backdropElement = null;
            }
            scope.$destroy();
          };
          $modal.show = function () {
            var parent = options.container ? findElement(options.container) : null;
            var after = options.container ? null : options.element;
            modalElement = $modal.$element = modalLinker(scope, function (clonedElement, scope) {
            });
            modalElement.css({ display: 'block' }).addClass(options.placement);
            if (options.animation) {
              if (options.backdrop) {
                backdropElement.addClass('am-fade');
              }
              modalElement.addClass(options.animation);
            }
            if (options.backdrop) {
              $animate.enter(backdropElement, bodyElement, null, function () {
              });
            }
            $animate.enter(modalElement, parent, after, function () {
            });
            scope.$isShown = true;
            scope.$$phase || scope.$digest();
            var el = modalElement[0];
            requestAnimationFrame(function () {
              el.focus();
            });
            bodyElement.addClass(options.prefixClass + '-open');
            if (options.backdrop) {
              modalElement.on('click', hideOnBackdropClick);
              backdropElement.on('click', hideOnBackdropClick);
            }
            if (options.keyboard) {
              modalElement.on('keyup', $modal.$onKeyUp);
            }
          };
          $modal.hide = function () {
            $animate.leave(modalElement, function () {
              bodyElement.removeClass(options.prefixClass + '-open');
            });
            if (options.backdrop) {
              $animate.leave(backdropElement, function () {
              });
            }
            scope.$$phase || scope.$digest();
            scope.$isShown = false;
            if (options.backdrop) {
              modalElement.off('click', hideOnBackdropClick);
              backdropElement.off('click', hideOnBackdropClick);
            }
            if (options.keyboard) {
              modalElement.off('keyup', $modal.$onKeyUp);
            }
          };
          $modal.toggle = function () {
            scope.$isShown ? $modal.hide() : $modal.show();
          };
          $modal.focus = function () {
            modalElement[0].focus();
          };
          $modal.$onKeyUp = function (evt) {
            evt.which === 27 && $modal.hide();
          };
          function hideOnBackdropClick(evt) {
            if (evt.target !== evt.currentTarget)
              return;
            options.backdrop === 'static' ? $modal.focus() : $modal.hide();
          }
          return $modal;
        }
        return ModalFactory;
      }
    ];
  }).directive('bsModal', [
    '$window',
    '$location',
    '$sce',
    '$modal',
    function ($window, $location, $sce, $modal) {
      return {
        restrict: 'EAC',
        scope: true,
        link: function postLink(scope, element, attr, transclusion) {
          var options = {
              scope: scope,
              element: element,
              show: false
            };
          angular.forEach([
            'template',
            'contentTemplate',
            'placement',
            'backdrop',
            'keyboard',
            'html',
            'container',
            'animation'
          ], function (key) {
            if (angular.isDefined(attr[key]))
              options[key] = attr[key];
          });
          angular.forEach([
            'title',
            'content'
          ], function (key) {
            attr[key] && attr.$observe(key, function (newValue, oldValue) {
              scope[key] = newValue;
            });
          });
          attr.bsModal && scope.$watch(attr.bsModal, function (newValue, oldValue) {
            if (angular.isObject(newValue)) {
              angular.extend(scope, newValue);
            } else {
              scope.content = newValue;
            }
          }, true);
          var modal = $modal(options);
          element.on(attr.trigger || 'click', modal.toggle);
          scope.$on('$destroy', function () {
            modal.destroy();
            options = null;
            modal = null;
          });
        }
      };
    }
  ]);
  angular.module('mgcrea.ngStrap.navbar', []).provider('$navbar', function () {
    var defaults = this.defaults = {
        activeClass: 'active',
        routeAttr: 'data-match-route'
      };
    this.$get = function () {
      return { defaults: defaults };
    };
  }).directive('bsNavbar', [
    '$window',
    '$location',
    '$navbar',
    function ($window, $location, $navbar) {
      var defaults = $navbar.defaults;
      return {
        restrict: 'A',
        link: function postLink(scope, element, attr, controller) {
          var options = defaults;
          angular.forEach(Object.keys(defaults), function (key) {
            if (angular.isDefined(attr[key]))
              options[key] = attr[key];
          });
          scope.$watch(function () {
            return $location.path();
          }, function (newValue, oldValue) {
            var liElements = element[0].querySelectorAll('li[' + options.routeAttr + ']');
            angular.forEach(liElements, function (li) {
              var liElement = angular.element(li);
              var pattern = liElement.attr(options.routeAttr);
              var regexp = new RegExp('^' + pattern.replace('/', '\\/') + '$', ['i']);
              if (regexp.test(newValue)) {
                liElement.addClass(options.activeClass);
              } else {
                liElement.removeClass(options.activeClass);
              }
            });
          });
        }
      };
    }
  ]);
  angular.module('mgcrea.ngStrap.popover', ['mgcrea.ngStrap.tooltip']).provider('$popover', function () {
    var defaults = this.defaults = {
        animation: 'am-fade',
        placement: 'right',
        template: 'popover/popover.tpl.html',
        contentTemplate: false,
        trigger: 'click',
        keyboard: true,
        html: false,
        title: '',
        content: '',
        delay: 0,
        container: false
      };
    this.$get = [
      '$tooltip',
      function ($tooltip) {
        function PopoverFactory(element, config) {
          var options = angular.extend({}, defaults, config);
          var $popover = $tooltip(element, options);
          if (options.content) {
            $popover.$scope.content = options.content;
          } else if (options.contentTemplate){
              $popover.$scope.contentTemplate = options.contentTemplate;
          }
          return $popover;
        }
        return PopoverFactory;
      }
    ];
  }).directive('bsPopover', [
    '$window',
    '$location',
    '$sce',
    '$popover',
    function ($window, $location, $sce, $popover) {
      var requestAnimationFrame = $window.requestAnimationFrame || $window.setTimeout;
      return {
        restrict: 'EAC',
        scope: true,
        link: function postLink(scope, element, attr) {
          var options = { scope: scope };
          angular.forEach([
            'template',
            'contentTemplate',
            'placement',
            'container',
            'delay',
            'trigger',
            'keyboard',
            'html',
            'animation'
          ], function (key) {
            if (angular.isDefined(attr[key]))
              options[key] = attr[key];
          });
          angular.forEach([
            'title',
            'content'
          ], function (key) {
            attr[key] && attr.$observe(key, function (newValue, oldValue) {
              scope[key] = newValue;
              angular.isDefined(oldValue) && requestAnimationFrame(function () {
                popover && popover.$applyPlacement();
              });
            });
          });
          attr.bsPopover && scope.$watch(attr.bsPopover, function (newValue, oldValue) {
            if (angular.isObject(newValue)) {
              angular.extend(scope, newValue);
            } else {
              scope.content = newValue;
            }
            angular.isDefined(oldValue) && requestAnimationFrame(function () {
              popover && popover.$applyPlacement();
            });
          }, true);
          var popover = $popover(element, options);
          scope.$on('$destroy', function () {
            popover.destroy();
            options = null;
            popover = null;
          });
        }
      };
    }
  ]);
  angular.module('mgcrea.ngStrap.scrollspy', [
    'mgcrea.ngStrap.helpers.debounce',
    'mgcrea.ngStrap.helpers.dimensions'
  ]).provider('$scrollspy', function () {
    var spies = this.$$spies = {};
    var defaults = this.defaults = {
        debounce: 150,
        throttle: 100,
        offset: 100
      };
    this.$get = [
      '$window',
      '$document',
      '$rootScope',
      'dimensions',
      'debounce',
      'throttle',
      function ($window, $document, $rootScope, dimensions, debounce, throttle) {
        var windowEl = angular.element($window);
        var docEl = angular.element($document.prop('documentElement'));
        var bodyEl = angular.element($window.document.body);
        function nodeName(element, name) {
          return element[0].nodeName && element[0].nodeName.toLowerCase() === name.toLowerCase();
        }
        function ScrollSpyFactory(config) {
          var options = angular.extend({}, defaults, config);
          if (!options.element)
            options.element = bodyEl;
          var isWindowSpy = nodeName(options.element, 'body');
          var scrollEl = isWindowSpy ? windowEl : options.element;
          var scrollId = isWindowSpy ? 'window' : options.id;
          if (spies[scrollId]) {
            spies[scrollId].$$count++;
            return spies[scrollId];
          }
          var $scrollspy = {};
          var trackedElements = $scrollspy.$trackedElements = [];
          var sortedElements = [];
          var activeTarget;
          var debouncedCheckPosition;
          var throttledCheckPosition;
          var debouncedCheckOffsets;
          var viewportHeight;
          var scrollTop;
          $scrollspy.init = function () {
            this.$$count = 1;
            debouncedCheckPosition = debounce(this.checkPosition, options.debounce);
            throttledCheckPosition = throttle(this.checkPosition, options.throttle);
            scrollEl.on('click', this.checkPositionWithEventLoop);
            windowEl.on('resize', debouncedCheckPosition);
            scrollEl.on('scroll', throttledCheckPosition);
            debouncedCheckOffsets = debounce(this.checkOffsets, options.debounce);
            $rootScope.$on('$viewContentLoaded', debouncedCheckOffsets);
            $rootScope.$on('$includeContentLoaded', debouncedCheckOffsets);
            debouncedCheckOffsets();
            if (scrollId) {
              spies[scrollId] = $scrollspy;
            }
          };
          $scrollspy.destroy = function () {
            this.$$count--;
            if (this.$$count > 0) {
              return;
            }
            scrollEl.off('click', this.checkPositionWithEventLoop);
            windowEl.off('resize', debouncedCheckPosition);
            scrollEl.off('scroll', debouncedCheckPosition);
            $rootScope.$off('$viewContentLoaded', debouncedCheckOffsets);
            $rootScope.$off('$includeContentLoaded', debouncedCheckOffsets);
          };
          $scrollspy.checkPosition = function () {
            if (!sortedElements.length)
              return;
            scrollTop = (isWindowSpy ? $window.pageYOffset : scrollEl.prop('scrollTop')) || 0;
            viewportHeight = Math.max($window.innerHeight, docEl.prop('clientHeight'));
            if (scrollTop < sortedElements[0].offsetTop && activeTarget !== sortedElements[0].target) {
              return $scrollspy.$activateElement(sortedElements[0]);
            }
            for (var i = sortedElements.length; i--;) {
              if (angular.isUndefined(sortedElements[i].offsetTop) || sortedElements[i].offsetTop === null)
                continue;
              if (activeTarget === sortedElements[i].target)
                continue;
              if (scrollTop < sortedElements[i].offsetTop)
                continue;
              if (sortedElements[i + 1] && scrollTop > sortedElements[i + 1].offsetTop)
                continue;
              return $scrollspy.$activateElement(sortedElements[i]);
            }
          };
          $scrollspy.checkPositionWithEventLoop = function () {
            setTimeout(this.checkPosition, 1);
          };
          $scrollspy.$activateElement = function (element) {
            if (activeTarget) {
              var activeElement = $scrollspy.$getTrackedElement(activeTarget);
              if (activeElement) {
                activeElement.source.removeClass('active');
                if (nodeName(activeElement.source, 'li') && nodeName(activeElement.source.parent().parent(), 'li')) {
                  activeElement.source.parent().parent().removeClass('active');
                }
              }
            }
            activeTarget = element.target;
            element.source.addClass('active');
            if (nodeName(element.source, 'li') && nodeName(element.source.parent().parent(), 'li')) {
              element.source.parent().parent().addClass('active');
            }
          };
          $scrollspy.$getTrackedElement = function (target) {
            return trackedElements.filter(function (obj) {
              return obj.target === target;
            })[0];
          };
          $scrollspy.checkOffsets = function () {
            angular.forEach(trackedElements, function (trackedElement) {
              var targetElement = document.querySelector(trackedElement.target);
              trackedElement.offsetTop = targetElement ? dimensions.offset(targetElement).top : null;
              if (options.offset && trackedElement.offsetTop !== null)
                trackedElement.offsetTop -= options.offset * 1;
            });
            sortedElements = trackedElements.filter(function (el) {
              return el.offsetTop !== null;
            }).sort(function (a, b) {
              return a.offsetTop - b.offsetTop;
            });
            debouncedCheckPosition();
          };
          $scrollspy.trackElement = function (target, source) {
            trackedElements.push({
              target: target,
              source: source
            });
          };
          $scrollspy.untrackElement = function (target, source) {
            var toDelete;
            for (var i = trackedElements.length; i--;) {
              if (trackedElements[i].target === target && trackedElements[i].source === source) {
                toDelete = i;
                break;
              }
            }
            trackedElements = trackedElements.splice(toDelete, 1);
          };
          $scrollspy.activate = function (i) {
            trackedElements[i].addClass('active');
          };
          $scrollspy.init();
          return $scrollspy;
        }
        return ScrollSpyFactory;
      }
    ];
  }).directive('bsScrollspy', [
    '$rootScope',
    'debounce',
    'dimensions',
    '$scrollspy',
    function ($rootScope, debounce, dimensions, $scrollspy) {
      return {
        restrict: 'EAC',
        link: function postLink(scope, element, attr) {
          var options = { scope: scope };
          angular.forEach([
            'offset',
            'target'
          ], function (key) {
            if (angular.isDefined(attr[key]))
              options[key] = attr[key];
          });
          var scrollspy = $scrollspy(options);
          scrollspy.trackElement(options.target, element);
          scope.$on('$destroy', function () {
            scrollspy.untrackElement(options.target, element);
            scrollspy.destroy();
            options = null;
            scrollspy = null;
          });
        }
      };
    }
  ]).directive('bsScrollspyList', [
    '$rootScope',
    'debounce',
    'dimensions',
    '$scrollspy',
    function ($rootScope, debounce, dimensions, $scrollspy) {
      return {
        restrict: 'A',
        compile: function postLink(element, attr) {
          var children = element[0].querySelectorAll('li > a[href]');
          angular.forEach(children, function (child) {
            var childEl = angular.element(child);
            childEl.parent().attr('bs-scrollspy', '').attr('data-target', childEl.attr('href'));
          });
        }
      };
    }
  ]);
  angular.module('mgcrea.ngStrap.select', [
    'mgcrea.ngStrap.tooltip',
    'mgcrea.ngStrap.helpers.parseOptions'
  ]).provider('$select', function () {
    var defaults = this.defaults = {
        animation: 'am-fade',
        prefixClass: 'select',
        placement: 'bottom-left',
        template: 'select/select.tpl.html',
        trigger: 'focus',
        container: false,
        keyboard: true,
        html: false,
        delay: 0,
        multiple: false,
        sort: true,
        caretHtml: '&nbsp;<span class="caret"></span>',
        placeholder: 'Choose among the following...'
      };
    this.$get = [
      '$window',
      '$document',
      '$rootScope',
      '$tooltip',
      function ($window, $document, $rootScope, $tooltip) {
        var bodyEl = angular.element($window.document.body);
        var isTouch = 'createTouch' in $window.document;
        function SelectFactory(element, controller, config) {
          var $select = {};
          var options = angular.extend({}, defaults, config);
          $select = $tooltip(element, options);
          var parentScope = config.scope;
          var scope = $select.$scope;
          scope.$matches = [];
          scope.$activeIndex = 0;
          scope.$isMultiple = options.multiple;
          scope.$activate = function (index) {
            scope.$$postDigest(function () {
              $select.activate(index);
            });
          };
          scope.$select = function (index, evt) {
            scope.$$postDigest(function () {
              $select.select(index);
            });
          };
          scope.$isVisible = function () {
            return $select.$isVisible();
          };
          scope.$isActive = function (index) {
            return $select.$isActive(index);
          };
          $select.update = function (matches) {
            scope.$matches = matches;
            if (controller.$modelValue && matches.length) {
              if (options.multiple && angular.isArray(controller.$modelValue)) {
                scope.$activeIndex = controller.$modelValue.map(function (value) {
                  return $select.$getIndex(value);
                });
              } else {
                scope.$activeIndex = $select.$getIndex(controller.$modelValue);
              }
            } else if (scope.$activeIndex >= matches.length) {
              scope.$activeIndex = options.multiple ? [] : 0;
            }
          };
          $select.activate = function (index) {
            if (options.multiple) {
              scope.$activeIndex.sort();
              $select.$isActive(index) ? scope.$activeIndex.splice(scope.$activeIndex.indexOf(index), 1) : scope.$activeIndex.push(index);
              if (options.sort)
                scope.$activeIndex.sort();
            } else {
              scope.$activeIndex = index;
            }
            return scope.$activeIndex;
          };
          $select.select = function (index) {
            var value = scope.$matches[index].value;
            $select.activate(index);
            if (options.multiple) {
              controller.$setViewValue(scope.$activeIndex.map(function (index) {
                return scope.$matches[index].value;
              }));
            } else {
              controller.$setViewValue(value);
            }
            controller.$render();
            if (parentScope)
              parentScope.$digest();
            if (!options.multiple) {
              if (options.trigger === 'focus')
                element[0].blur();
              else if ($select.$isShown)
                $select.hide();
            }
            scope.$emit('$select.select', value, index);
          };
          $select.$isVisible = function () {
            if (!options.minLength || !controller) {
              return scope.$matches.length;
            }
            return scope.$matches.length && controller.$viewValue.length >= options.minLength;
          };
          $select.$isActive = function (index) {
            if (options.multiple) {
              return scope.$activeIndex.indexOf(index) !== -1;
            } else {
              return scope.$activeIndex === index;
            }
          };
          $select.$getIndex = function (value) {
            var l = scope.$matches.length, i = l;
            if (!l)
              return;
            for (i = l; i--;) {
              if (scope.$matches[i].value === value)
                break;
            }
            if (i < 0)
              return;
            return i;
          };
          $select.$onElementMouseDown = function (evt) {
            evt.preventDefault();
            evt.stopPropagation();
            if ($select.$isShown) {
              element[0].blur();
            } else {
              element[0].focus();
            }
          };
          $select.$onMouseDown = function (evt) {
            evt.preventDefault();
            evt.stopPropagation();
            if (isTouch) {
              var targetEl = angular.element(evt.target);
              targetEl.triggerHandler('click');
            }
          };
          $select.$onKeyDown = function (evt) {
            if (!/(38|40|13)/.test(evt.keyCode))
              return;
            evt.preventDefault();
            evt.stopPropagation();
            if (evt.keyCode === 13) {
              return $select.select(scope.$activeIndex);
            }
            if (evt.keyCode === 38 && scope.$activeIndex > 0)
              scope.$activeIndex--;
            else if (evt.keyCode === 40 && scope.$activeIndex < scope.$matches.length - 1)
              scope.$activeIndex++;
            else if (angular.isUndefined(scope.$activeIndex))
              scope.$activeIndex = 0;
            scope.$digest();
          };
          var _init = $select.init;
          $select.init = function () {
            _init();
            element.on(isTouch ? 'touchstart' : 'mousedown', $select.$onElementMouseDown);
          };
          var _destroy = $select.destroy;
          $select.destroy = function () {
            _destroy();
            element.off(isTouch ? 'touchstart' : 'mousedown', $select.$onElementMouseDown);
          };
          var _show = $select.show;
          $select.show = function () {
            _show();
            if (options.multiple) {
              $select.$element.addClass('select-multiple');
            }
            setTimeout(function () {
              $select.$element.on(isTouch ? 'touchstart' : 'mousedown', $select.$onMouseDown);
              if (options.keyboard) {
                element.on('keydown', $select.$onKeyDown);
              }
            });
          };
          var _hide = $select.hide;
          $select.hide = function () {
            $select.$element.off(isTouch ? 'touchstart' : 'mousedown', $select.$onMouseDown);
            if (options.keyboard) {
              element.off('keydown', $select.$onKeyDown);
            }
            _hide();
          };
          return $select;
        }
        SelectFactory.defaults = defaults;
        return SelectFactory;
      }
    ];
  }).directive('bsSelect', [
    '$window',
    '$parse',
    '$q',
    '$select',
    '$parseOptions',
    function ($window, $parse, $q, $select, $parseOptions) {
      var defaults = $select.defaults;
      return {
        restrict: 'EAC',
        require: 'ngModel',
        link: function postLink(scope, element, attr, controller) {
          var options = { scope: scope };
          angular.forEach([
            'placement',
            'container',
            'delay',
            'trigger',
            'keyboard',
            'html',
            'animation',
            'template',
            'placeholder',
            'multiple'
          ], function (key) {
            if (angular.isDefined(attr[key]))
              options[key] = attr[key];
          });
          var parsedOptions = $parseOptions(attr.ngOptions);
          var select = $select(element, controller, options);
          var watchedOptions = parsedOptions.$match[7].replace(/\|.+/, '').trim();
          scope.$watch(watchedOptions, function (newValue, oldValue) {
            parsedOptions.valuesFn(scope, controller).then(function (values) {
              select.update(values);
              controller.$render();
            });
          });
          controller.$render = function () {
            var selected, index;
            if (options.multiple && angular.isArray(controller.$modelValue)) {
              selected = controller.$modelValue.map(function (value) {
                index = select.$getIndex(value);
                return angular.isDefined(index) ? select.$scope.$matches[index].label : false;
              }).filter(angular.isDefined).join(', ');
            } else {
              index = select.$getIndex(controller.$modelValue);
              selected = angular.isDefined(index) ? select.$scope.$matches[index].label : false;
            }
            element.html((selected ? selected : attr.placeholder || defaults.placeholder) + defaults.caretHtml);
          };
          scope.$on('$destroy', function () {
            select.destroy();
            options = null;
            select = null;
          });
        }
      };
    }
  ]);
  angular.module('mgcrea.ngStrap.tab', []).run([
    '$templateCache',
    function ($templateCache) {
      $templateCache.put('$pane', '{{pane.content}}');
    }
  ]).provider('$tab', function () {
    var defaults = this.defaults = {
        animation: 'am-fade',
        template: 'tab/tab.tpl.html'
      };
    this.$get = function () {
      return { defaults: defaults };
    };
  }).directive('bsTabs', [
    '$window',
    '$animate',
    '$tab',
    function ($window, $animate, $tab) {
      var defaults = $tab.defaults;
      return {
        restrict: 'EAC',
        scope: true,
        require: '?ngModel',
        templateUrl: function (element, attr) {
          return attr.template || defaults.template;
        },
        link: function postLink(scope, element, attr, controller) {
          var options = defaults;
          angular.forEach(['animation'], function (key) {
            if (angular.isDefined(attr[key]))
              options[key] = attr[key];
          });
          attr.bsTabs && scope.$watch(attr.bsTabs, function (newValue, oldValue) {
            scope.panes = newValue;
          }, true);
          element.addClass('tabs');
          if (options.animation) {
            element.addClass(options.animation);
          }
          scope.active = scope.activePane = 0;
          scope.setActive = function (index, ev) {
            scope.active = index;
            if (controller) {
              controller.$setViewValue(index);
            }
          };
          if (controller) {
            controller.$render = function () {
              scope.active = controller.$modelValue * 1;
            };
          }
        }
      };
    }
  ]);
  angular.module('mgcrea.ngStrap.timepicker', [
    'mgcrea.ngStrap.helpers.dateParser',
    'mgcrea.ngStrap.tooltip'
  ]).provider('$timepicker', function () {
    var defaults = this.defaults = {
        animation: 'am-fade',
        prefixClass: 'timepicker',
        placement: 'bottom-left',
        template: 'timepicker/timepicker.tpl.html',
        trigger: 'focus',
        container: false,
        keyboard: true,
        html: false,
        delay: 0,
        useNative: false,
        timeType: 'date',
        timeFormat: 'shortTime',
        autoclose: false,
        minTime: -Infinity,
        maxTime: +Infinity,
        length: 5,
        hourStep: 1,
        minuteStep: 5
      };
    this.$get = [
      '$window',
      '$document',
      '$rootScope',
      '$sce',
      '$locale',
      'dateFilter',
      '$tooltip',
      function ($window, $document, $rootScope, $sce, $locale, dateFilter, $tooltip) {
        var bodyEl = angular.element($window.document.body);
        var isTouch = 'createTouch' in $window.document;
        var isAppleTouch = /(iP(a|o)d|iPhone)/g.test($window.navigator.userAgent);
        if (!defaults.lang)
          defaults.lang = $locale.id;
        function timepickerFactory(element, controller, config) {
          var $timepicker = $tooltip(element, angular.extend({}, defaults, config));
          var parentScope = config.scope;
          var options = $timepicker.$options;
          var scope = $timepicker.$scope;
          var selectedIndex = 0;
          var startDate = controller.$dateValue || new Date();
          var viewDate = {
              hour: startDate.getHours(),
              meridian: startDate.getHours() < 12,
              minute: startDate.getMinutes(),
              second: startDate.getSeconds(),
              millisecond: startDate.getMilliseconds()
            };
          var format = $locale.DATETIME_FORMATS[options.timeFormat] || options.timeFormat;
          var formats = /(h+)[:]?(m+)[ ]?(a?)/i.exec(format).slice(1);
          scope.$select = function (date, index) {
            $timepicker.select(date, index);
          };
          scope.$moveIndex = function (value, index) {
            $timepicker.$moveIndex(value, index);
          };
          scope.$switchMeridian = function (date) {
            $timepicker.switchMeridian(date);
          };
          $timepicker.update = function (date) {
            if (!isNaN(date.getTime())) {
              $timepicker.$date = date;
              angular.extend(viewDate, {
                hour: date.getHours(),
                minute: date.getMinutes(),
                second: date.getSeconds(),
                millisecond: date.getMilliseconds()
              });
              $timepicker.$build();
            } else if (!$timepicker.$isBuilt) {
              $timepicker.$build();
            }
          };
          $timepicker.select = function (date, index, keep) {
            if (!angular.isDate(date))
              date = new Date(date);
            if (index === 0)
              controller.$dateValue.setHours(date.getHours());
            else if (index === 1)
              controller.$dateValue.setMinutes(date.getMinutes());
            controller.$setViewValue(controller.$dateValue);
            controller.$render();
            if (options.autoclose && !keep) {
              $timepicker.hide(true);
            }
          };
          $timepicker.switchMeridian = function (date) {
            var hours = (date || controller.$dateValue).getHours();
            controller.$dateValue.setHours(hours < 12 ? hours + 12 : hours - 12);
            controller.$render();
          };
          $timepicker.$build = function () {
            var i, midIndex = scope.midIndex = parseInt(options.length / 2, 10);
            var hours = [], hour;
            for (i = 0; i < options.length; i++) {
              hour = new Date(1970, 0, 1, viewDate.hour - (midIndex - i) * options.hourStep);
              hours.push({
                date: hour,
                label: dateFilter(hour, formats[0]),
                selected: $timepicker.$date && $timepicker.$isSelected(hour, 0),
                disabled: $timepicker.$isDisabled(hour, 0)
              });
            }
            var minutes = [], minute;
            for (i = 0; i < options.length; i++) {
              minute = new Date(1970, 0, 1, 0, viewDate.minute - (midIndex - i) * options.minuteStep);
              minutes.push({
                date: minute,
                label: dateFilter(minute, formats[1]),
                selected: $timepicker.$date && $timepicker.$isSelected(minute, 1),
                disabled: $timepicker.$isDisabled(minute, 1)
              });
            }
            var rows = [];
            for (i = 0; i < options.length; i++) {
              rows.push([
                hours[i],
                minutes[i]
              ]);
            }
            scope.rows = rows;
            scope.showAM = !!formats[2];
            scope.isAM = ($timepicker.$date || hours[midIndex].date).getHours() < 12;
            $timepicker.$isBuilt = true;
          };
          $timepicker.$isSelected = function (date, index) {
            if (!$timepicker.$date)
              return false;
            else if (index === 0) {
              return date.getHours() === $timepicker.$date.getHours();
            } else if (index === 1) {
              return date.getMinutes() === $timepicker.$date.getMinutes();
            }
          };
          $timepicker.$isDisabled = function (date, index) {
            var selectedTime;
            if (index === 0) {
              selectedTime = date.getTime() + viewDate.minute * 60000;
            } else if (index === 1) {
              selectedTime = date.getTime() + viewDate.hour * 3600000;
            }
            return selectedTime < options.minTime || selectedTime > options.maxTime;
          };
          $timepicker.$moveIndex = function (value, index) {
            var targetDate;
            if (index === 0) {
              targetDate = new Date(1970, 0, 1, viewDate.hour + value * options.length, viewDate.minute);
              angular.extend(viewDate, { hour: targetDate.getHours() });
            } else if (index === 1) {
              targetDate = new Date(1970, 0, 1, viewDate.hour, viewDate.minute + value * options.length * 5);
              angular.extend(viewDate, { minute: targetDate.getMinutes() });
            }
            $timepicker.$build();
          };
          $timepicker.$onMouseDown = function (evt) {
            if (evt.target.nodeName.toLowerCase() !== 'input')
              evt.preventDefault();
            evt.stopPropagation();
            if (isTouch) {
              var targetEl = angular.element(evt.target);
              if (targetEl[0].nodeName.toLowerCase() !== 'button') {
                targetEl = targetEl.parent();
              }
              targetEl.triggerHandler('click');
            }
          };
          $timepicker.$onKeyDown = function (evt) {
            if (!/(38|37|39|40|13)/.test(evt.keyCode) || evt.shiftKey || evt.altKey)
              return;
            evt.preventDefault();
            evt.stopPropagation();
            if (evt.keyCode === 13)
              return $timepicker.hide(true);
            var newDate = new Date($timepicker.$date);
            var hours = newDate.getHours(), hoursLength = dateFilter(newDate, 'h').length;
            var minutes = newDate.getMinutes(), minutesLength = dateFilter(newDate, 'mm').length;
            var lateralMove = /(37|39)/.test(evt.keyCode);
            var count = 2 + !!formats[2] * 1;
            if (lateralMove) {
              if (evt.keyCode === 37)
                selectedIndex = selectedIndex < 1 ? count - 1 : selectedIndex - 1;
              else if (evt.keyCode === 39)
                selectedIndex = selectedIndex < count - 1 ? selectedIndex + 1 : 0;
            }
            if (selectedIndex === 0) {
              if (lateralMove)
                return createSelection(0, hoursLength);
              if (evt.keyCode === 38)
                newDate.setHours(hours - options.hourStep);
              else if (evt.keyCode === 40)
                newDate.setHours(hours + options.hourStep);
            } else if (selectedIndex === 1) {
              if (lateralMove)
                return createSelection(hoursLength + 1, hoursLength + 1 + minutesLength);
              if (evt.keyCode === 38)
                newDate.setMinutes(minutes - options.minuteStep);
              else if (evt.keyCode === 40)
                newDate.setMinutes(minutes + options.minuteStep);
            } else if (selectedIndex === 2) {
              if (lateralMove)
                return createSelection(hoursLength + 1 + minutesLength + 1, hoursLength + 1 + minutesLength + 3);
              $timepicker.switchMeridian();
            }
            $timepicker.select(newDate, selectedIndex, true);
            parentScope.$digest();
          };
          function createSelection(start, end) {
            if (element[0].createTextRange) {
              var selRange = element[0].createTextRange();
              selRange.collapse(true);
              selRange.moveStart('character', start);
              selRange.moveEnd('character', end);
              selRange.select();
            } else if (element[0].setSelectionRange) {
              element[0].setSelectionRange(start, end);
            } else if (angular.isUndefined(element[0].selectionStart)) {
              element[0].selectionStart = start;
              element[0].selectionEnd = end;
            }
          }
          function focusElement() {
            element[0].focus();
          }
          var _init = $timepicker.init;
          $timepicker.init = function () {
            if (isTouch) {
              element.prop('type', 'text');
              element.attr('readonly', 'true');
              element.on('click', focusElement);
            }
            _init();
          };
          var _destroy = $timepicker.destroy;
          $timepicker.destroy = function () {
            if (isAppleTouch && options.useNative) {
              element.off('click', focusElement);
            }
            _destroy();
          };
          var _show = $timepicker.show;
          $timepicker.show = function () {
            _show();
            setTimeout(function () {
              $timepicker.$element.on(isTouch ? 'touchstart' : 'mousedown', $timepicker.$onMouseDown);
              if (options.keyboard) {
                element.on('keydown', $timepicker.$onKeyDown);
              }
            });
          };
          var _hide = $timepicker.hide;
          $timepicker.hide = function (blur) {
            $timepicker.$element.off(isTouch ? 'touchstart' : 'mousedown', $timepicker.$onMouseDown);
            if (options.keyboard) {
              element.off('keydown', $timepicker.$onKeyDown);
            }
            _hide(blur);
          };
          return $timepicker;
        }
        timepickerFactory.defaults = defaults;
        return timepickerFactory;
      }
    ];
  }).directive('bsTimepicker', [
    '$window',
    '$parse',
    '$q',
    '$locale',
    'dateFilter',
    '$timepicker',
    '$dateParser',
    '$timeout',
    function ($window, $parse, $q, $locale, dateFilter, $timepicker, $dateParser, $timeout) {
      var requestAnimationFrame = $window.requestAnimationFrame || $window.setTimeout;
      return {
        restrict: 'EAC',
        require: 'ngModel',
        link: function postLink(scope, element, attr, controller) {
          var options = {
              scope: scope,
              controller: controller
            };
          angular.forEach([
            'placement',
            'container',
            'delay',
            'trigger',
            'keyboard',
            'html',
            'animation',
            'template',
            'autoclose',
            'timeType',
            'timeFormat',
            'useNative',
            'lang'
          ], function (key) {
            if (angular.isDefined(attr[key]))
              options[key] = attr[key];
          });
          var timepicker = $timepicker(element, controller, options);
          options = timepicker.$options;
          var dateParser = $dateParser({
              format: options.timeFormat,
              lang: options.lang
            });
          angular.forEach([
            'minTime',
            'maxTime'
          ], function (key) {
            angular.isDefined(attr[key]) && attr.$observe(key, function (newValue) {
              if (newValue === 'now') {
                timepicker.$options[key] = new Date().setFullYear(1970, 0, 1);
              } else if (angular.isString(newValue) && newValue.match(/^".+"$/)) {
                timepicker.$options[key] = +new Date(newValue.substr(1, newValue.length - 2));
              } else {
                timepicker.$options[key] = dateParser.parse(newValue);
              }
              !isNaN(timepicker.$options[key]) && timepicker.$build();
            });
          });
          scope.$watch(attr.ngModel, function (newValue, oldValue) {
            timepicker.update(controller.$dateValue);
          }, true);
          controller.$parsers.unshift(function (viewValue) {
            var parsedTime = dateParser.parse(viewValue, controller.$dateValue);
            if (!parsedTime || isNaN(parsedTime.getTime())) {
              controller.$setValidity('date', false);
            } else {
              var isValid = parsedTime.getTime() >= options.minTime && parsedTime.getTime() <= options.maxTime;
              controller.$setValidity('date', isValid);
              if (isValid)
                controller.$dateValue = parsedTime;
            }
            if (options.timeType === 'string') {
              return dateFilter(viewValue, options.timeFormat);
            } else if (options.timeType === 'number') {
              return controller.$dateValue.getTime();
            } else if (options.timeType === 'iso') {
              return controller.$dateValue.toISOString();
            } else {
              return controller.$dateValue;
            }
          });
          controller.$formatters.push(function (modelValue) {
            var date = angular.isDate(modelValue) ? modelValue : new Date(modelValue);
            if (isNaN(date.getTime()))
              date = new Date(new Date().setMinutes(0) + 3600000);
            controller.$dateValue = date;
            return controller.$dateValue;
          });
          controller.$render = function () {
            element.val(isNaN(controller.$dateValue.getTime()) ? '' : dateFilter(controller.$dateValue, options.timeFormat));
          };
          scope.$on('$destroy', function () {
            timepicker.destroy();
            options = null;
            timepicker = null;
          });
        }
      };
    }
  ]);
  angular.module('mgcrea.ngStrap.tooltip', ['mgcrea.ngStrap.helpers.dimensions']).provider('$tooltip', function () {
    var defaults = this.defaults = {
        animation: 'am-fade',
        prefixClass: 'tooltip',
        container: false,
        placement: 'top',
        template: 'tooltip/tooltip.tpl.html',
        contentTemplate: false,
        trigger: 'hover focus',
        keyboard: false,
        html: false,
        show: false,
        title: '',
        type: '',
        delay: 0
      };
    this.$get = [
      '$window',
      '$rootScope',
      '$compile',
      '$q',
      '$templateCache',
      '$http',
      '$animate',
      '$timeout',
      'dimensions',
      function ($window, $rootScope, $compile, $q, $templateCache, $http, $animate, $timeout, dimensions) {
        var trim = String.prototype.trim;
        var requestAnimationFrame = $window.requestAnimationFrame || $window.setTimeout;
        var isTouch = 'createTouch' in $window.document;
        var htmlReplaceRegExp = /ng-bind="/gi;
        var findElement = function (query, element) {
          return angular.element((element || document).querySelectorAll(query));
        };
        function TooltipFactory(element, config) {
          var $tooltip = {};
          var options = $tooltip.$options = angular.extend({}, defaults, config);
          $tooltip.$promise = $q.when($templateCache.get(options.template) || $http.get(options.template));
          var scope = $tooltip.$scope = options.scope && options.scope.$new() || $rootScope.$new();
          if (options.delay && angular.isString(options.delay)) {
            options.delay = parseFloat(options.delay);
          }
          if (options.title) {
            $tooltip.$scope.title = options.title;
          }
          scope.$hide = function () {
            scope.$$postDigest(function () {
              $tooltip.hide();
            });
          };
          scope.$show = function () {
            scope.$$postDigest(function () {
              $tooltip.show();
            });
          };
          scope.$toggle = function () {
            scope.$$postDigest(function () {
              $tooltip.toggle();
            });
          };
          $tooltip.$isShown = false;
          var timeout, hoverState;
          if (options.contentTemplate) {
            $tooltip.$promise = $tooltip.$promise.then(function (template) {
              if (angular.isObject(template))
                template = template.data;
              var templateEl = angular.element(template);
              return $q.when($templateCache.get(options.contentTemplate) || $http.get(options.contentTemplate, { cache: $templateCache })).then(function (contentTemplate) {
                if (angular.isObject(contentTemplate))
                  contentTemplate = contentTemplate.data;
                findElement('[ng-bind="content"]', templateEl[0]).removeAttr('ng-bind').html(contentTemplate);
                return templateEl[0].outerHTML;
              });
            });
          }
          var tipLinker, tipElement, tipTemplate;
          $tooltip.$promise.then(function (template) {
            if (angular.isObject(template))
              template = template.data;
            if (options.html)
              template = template.replace(htmlReplaceRegExp, 'ng-bind-html="');
            template = trim.apply(template);
            tipTemplate = template;
            tipLinker = $compile(template);
            $tooltip.init();
          });
          $tooltip.init = function () {
            if (options.delay && angular.isNumber(options.delay)) {
              options.delay = {
                show: options.delay,
                hide: options.delay
              };
            }
            var triggers = options.trigger.split(' ');
            for (var i = triggers.length; i--;) {
              var trigger = triggers[i];
              if (trigger === 'click') {
                element.on('click', $tooltip.toggle);
              } else if (trigger !== 'manual') {
                element.on(trigger === 'hover' ? 'mouseenter' : 'focus', $tooltip.enter);
                element.on(trigger === 'hover' ? 'mouseleave' : 'blur', $tooltip.leave);
              }
            }
            if (options.show) {
              scope.$$postDigest(function () {
                options.trigger === 'focus' ? element[0].focus() : $tooltip.show();
              });
            }
          };
          $tooltip.destroy = function () {
            var triggers = options.trigger.split(' ');
            for (var i = triggers.length; i--;) {
              var trigger = triggers[i];
              if (trigger === 'click') {
                element.off('click', $tooltip.toggle);
              } else if (trigger !== 'manual') {
                element.off(trigger === 'hover' ? 'mouseenter' : 'focus', $tooltip.enter);
                element.off(trigger === 'hover' ? 'mouseleave' : 'blur', $tooltip.leave);
              }
            }
            if (tipElement) {
              tipElement.remove();
              tipElement = null;
            }
            scope.$destroy();
          };
          $tooltip.enter = function () {
            clearTimeout(timeout);
            hoverState = 'in';
            if (!options.delay || !options.delay.show) {
              return $tooltip.show();
            }
            timeout = setTimeout(function () {
              if (hoverState === 'in')
                $tooltip.show();
            }, options.delay.show);
          };
          $tooltip.show = function () {
            var parent = options.container ? findElement(options.container) : null;
            var after = options.container ? null : element;
            tipElement = $tooltip.$element = tipLinker(scope, function (clonedElement, scope) {
            });
            tipElement.css({
              top: '0px',
              left: '0px',
              display: 'block'
            }).addClass(options.placement);
            if (options.animation)
              tipElement.addClass(options.animation);
            if (options.type)
              tipElement.addClass(options.prefixClass + '-' + options.type);
            $animate.enter(tipElement, parent, after, function () {
            });
            $tooltip.$isShown = true;
            scope.$$phase || scope.$digest();
            requestAnimationFrame($tooltip.$applyPlacement);
            if (options.keyboard) {
              if (options.trigger !== 'focus') {
                $tooltip.focus();
                tipElement.on('keyup', $tooltip.$onKeyUp);
              } else {
                element.on('keyup', $tooltip.$onFocusKeyUp);
              }
            }
          };
          $tooltip.leave = function () {
            if (!$tooltip.$isShown)
              return;
            clearTimeout(timeout);
            hoverState = 'out';
            if (!options.delay || !options.delay.hide) {
              return $tooltip.hide();
            }
            timeout = setTimeout(function () {
              if (hoverState === 'out') {
                $tooltip.hide();
              }
            }, options.delay.hide);
          };
          $tooltip.hide = function (blur) {
            $animate.leave(tipElement, function () {
            });
            scope.$$phase || scope.$digest();
            $tooltip.$isShown = false;
            if (options.keyboard) {
              tipElement.off('keyup', $tooltip.$onKeyUp);
            }
            if (blur && options.trigger === 'focus') {
              return element[0].blur();
            }
          };
          $tooltip.toggle = function () {
            $tooltip.$isShown ? $tooltip.leave() : $tooltip.enter();
          };
          $tooltip.focus = function () {
            tipElement[0].focus();
          };
          $tooltip.$applyPlacement = function () {
            if (!tipElement)
              return;
            var elementPosition = getPosition();
            var tipWidth = tipElement.prop('offsetWidth'), tipHeight = tipElement.prop('offsetHeight');
            var tipPosition = getCalculatedOffset(options.placement, elementPosition, tipWidth, tipHeight);
            tipPosition.top += 'px';
            tipPosition.left += 'px';
            tipElement.css(tipPosition);
          };
          $tooltip.$onKeyUp = function (evt) {
            evt.which === 27 && $tooltip.hide();
          };
          $tooltip.$onFocusKeyUp = function (evt) {
            evt.which === 27 && element[0].blur();
          };
          function getPosition() {
            if (options.container === 'body') {
              return dimensions.offset(element[0]);
            } else {
              return dimensions.position(element[0]);
            }
          }
          function getCalculatedOffset(placement, position, actualWidth, actualHeight) {
            var offset;
            var split = placement.split('-');
            switch (split[0]) {
            case 'right':
              offset = {
                top: position.top + position.height / 2 - actualHeight / 2,
                left: position.left + position.width
              };
              break;
            case 'bottom':
              offset = {
                top: position.top + position.height,
                left: position.left + position.width / 2 - actualWidth / 2
              };
              break;
            case 'left':
              offset = {
                top: position.top + position.height / 2 - actualHeight / 2,
                left: position.left - actualWidth
              };
              break;
            default:
              offset = {
                top: position.top - actualHeight,
                left: position.left + position.width / 2 - actualWidth / 2
              };
              break;
            }
            if (!split[1]) {
              return offset;
            }
            if (split[0] === 'top' || split[0] === 'bottom') {
              switch (split[1]) {
              case 'left':
                offset.left = position.left;
                break;
              case 'right':
                offset.left = position.left + position.width - actualWidth;
              }
            } else if (split[0] === 'left' || split[0] === 'right') {
              switch (split[1]) {
              case 'top':
                offset.top = position.top - actualHeight;
                break;
              case 'bottom':
                offset.top = position.top + position.height;
              }
            }
            return offset;
          }
          return $tooltip;
        }
        return TooltipFactory;
      }
    ];
  }).directive('bsTooltip', [
    '$window',
    '$location',
    '$sce',
    '$tooltip',
    function ($window, $location, $sce, $tooltip) {
      var requestAnimationFrame = $window.requestAnimationFrame || $window.setTimeout;
      return {
        restrict: 'EAC',
        scope: true,
        link: function postLink(scope, element, attr, transclusion) {
          var options = { scope: scope };
          angular.forEach([
            'template',
            'contentTemplate',
            'placement',
            'container',
            'delay',
            'trigger',
            'keyboard',
            'html',
            'animation',
            'type'
          ], function (key) {
            if (angular.isDefined(attr[key]))
              options[key] = attr[key];
          });
          angular.forEach(['title'], function (key) {
            attr[key] && attr.$observe(key, function (newValue, oldValue) {
              scope[key] = newValue;
              angular.isDefined(oldValue) && requestAnimationFrame(function () {
                tooltip && tooltip.$applyPlacement();
              });
            });
          });
          attr.bsTooltip && scope.$watch(attr.bsTooltip, function (newValue, oldValue) {
            if (angular.isObject(newValue)) {
              angular.extend(scope, newValue);
            } else {
              scope.content = newValue;
            }
            angular.isDefined(oldValue) && requestAnimationFrame(function () {
              tooltip && tooltip.$applyPlacement();
            });
          }, true);
          var tooltip = $tooltip(element, options);
          scope.$on('$destroy', function () {
            tooltip.destroy();
            options = null;
            tooltip = null;
          });
        }
      };
    }
  ]);
  angular.module('mgcrea.ngStrap.typeahead', [
    'mgcrea.ngStrap.tooltip',
    'mgcrea.ngStrap.helpers.parseOptions'
  ]).provider('$typeahead', function () {
    var defaults = this.defaults = {
        animation: 'am-fade',
        prefixClass: 'typeahead',
        placement: 'bottom-left',
        template: 'typeahead/typeahead.tpl.html',
        trigger: 'focus',
        container: false,
        keyboard: true,
        html: false,
        delay: 0,
        minLength: 1,
        limit: 6
      };
    this.$get = [
      '$window',
      '$rootScope',
      '$tooltip',
      function ($window, $rootScope, $tooltip) {
        var bodyEl = angular.element($window.document.body);
        function TypeaheadFactory(element, config) {
          var $typeahead = {};
          var options = angular.extend({}, defaults, config);
          var controller = options.controller;
          $typeahead = $tooltip(element, options);
          var parentScope = config.scope;
          var scope = $typeahead.$scope;
          scope.$matches = [];
          scope.$activeIndex = 0;
          scope.$activate = function (index) {
            scope.$$postDigest(function () {
              $typeahead.activate(index);
            });
          };
          scope.$select = function (index, evt) {
            scope.$$postDigest(function () {
              $typeahead.select(index);
            });
          };
          scope.$isVisible = function () {
            return $typeahead.$isVisible();
          };
          $typeahead.update = function (matches) {
            scope.$matches = matches;
            if (scope.$activeIndex >= matches.length) {
              scope.$activeIndex = 0;
            }
          };
          $typeahead.activate = function (index) {
            scope.$activeIndex = index;
          };
          $typeahead.select = function (index) {
            var value = scope.$matches[index].value;
            if (controller) {
              controller.$setViewValue(value);
              controller.$render();
              if (parentScope)
                parentScope.$digest();
            }
            if (options.trigger === 'focus')
              element[0].blur();
            else if ($typeahead.$isShown)
              $typeahead.hide();
            scope.$activeIndex = 0;
            scope.$emit('$typeahead.select', value, index);
          };
          $typeahead.$isVisible = function () {
            if (!options.minLength || !controller) {
              return !!scope.$matches.length;
            }
            return scope.$matches.length && angular.isString(controller.$viewValue) && controller.$viewValue.length >= options.minLength;
          };
          $typeahead.$onMouseDown = function (evt) {
            evt.preventDefault();
            evt.stopPropagation();
          };
          $typeahead.$onKeyDown = function (evt) {
            if (!/(38|40|13)/.test(evt.keyCode))
              return;
            evt.preventDefault();
            evt.stopPropagation();
            if (evt.keyCode === 13) {
              return $typeahead.select(scope.$activeIndex);
            }
            if (evt.keyCode === 38 && scope.$activeIndex > 0)
              scope.$activeIndex--;
            else if (evt.keyCode === 40 && scope.$activeIndex < scope.$matches.length - 1)
              scope.$activeIndex++;
            else if (angular.isUndefined(scope.$activeIndex))
              scope.$activeIndex = 0;
            scope.$digest();
          };
          var show = $typeahead.show;
          $typeahead.show = function () {
            show();
            setTimeout(function () {
              $typeahead.$element.on('mousedown', $typeahead.$onMouseDown);
              if (options.keyboard) {
                element.on('keydown', $typeahead.$onKeyDown);
              }
            });
          };
          var hide = $typeahead.hide;
          $typeahead.hide = function () {
            $typeahead.$element.off('mousedown', $typeahead.$onMouseDown);
            if (options.keyboard) {
              element.off('keydown', $typeahead.$onKeyDown);
            }
            hide();
          };
          return $typeahead;
        }
        TypeaheadFactory.defaults = defaults;
        return TypeaheadFactory;
      }
    ];
  }).directive('bsTypeahead', [
    '$window',
    '$parse',
    '$q',
    '$typeahead',
    '$parseOptions',
    function ($window, $parse, $q, $typeahead, $parseOptions) {
      var defaults = $typeahead.defaults;
      return {
        restrict: 'EAC',
        require: 'ngModel',
        link: function postLink(scope, element, attr, controller) {
          var options = {
              scope: scope,
              controller: controller
            };
          angular.forEach([
            'placement',
            'container',
            'delay',
            'trigger',
            'keyboard',
            'html',
            'animation',
            'template',
            'limit',
            'minLength'
          ], function (key) {
            if (angular.isDefined(attr[key]))
              options[key] = attr[key];
          });
          var limit = options.limit || defaults.limit;
          var parsedOptions = $parseOptions(attr.ngOptions + ' | filter:$viewValue |\xa0limitTo:' + limit);
          var typeahead = $typeahead(element, options);
          scope.$watch(attr.ngModel, function (newValue, oldValue) {
            parsedOptions.valuesFn(scope, controller).then(function (values) {
              if (values.length > limit)
                values = values.slice(0, limit);
              typeahead.update(values);
            });
          });
          scope.$on('$destroy', function () {
            typeahead.destroy();
            options = null;
            typeahead = null;
          });
        }
      };
    }
  ]);
}(window, document));
/**
 * AngularStrap - Twitter Bootstrap directives for AngularJS
 * @version v0.7.5 - 2013-07-21
 * @link http://mgcrea.github.com/angular-strap
 * @author Olivier Louvignes <olivier@mg-crea.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module('$strap.config', []).value('$strapConfig', {});
angular.module('$strap.filters', ['$strap.config']);
angular.module('$strap.directives', ['$strap.config']);
angular.module('$strap', [
  '$strap.filters',
  '$strap.directives',
  '$strap.config'
]);
'use strict';
angular.module('$strap.directives').directive('bsAlert', [
  '$parse',
  '$timeout',
  '$compile',
  function ($parse, $timeout, $compile) {
    return {
      restrict: 'A',
      link: function postLink(scope, element, attrs) {
        var getter = $parse(attrs.bsAlert), setter = getter.assign, value = getter(scope);
        var closeAlert = function closeAlertFn(delay) {
          $timeout(function () {
            element.alert('close');
          }, delay * 1);
        };
        if (!attrs.bsAlert) {
          if (angular.isUndefined(attrs.closeButton) || attrs.closeButton !== '0' && attrs.closeButton !== 'false') {
            element.prepend('<button type="button" class="close" data-dismiss="alert">&times;</button>');
          }
          if (attrs.closeAfter)
            closeAlert(attrs.closeAfter);
        } else {
          scope.$watch(attrs.bsAlert, function (newValue, oldValue) {
            // avoid initial run
            if (newValue === null) return;
            value = newValue;
            element.html((newValue.title ? '<strong>' + newValue.title + '</strong>&nbsp;' : '') + newValue.content || '');
            if (!!newValue.closed) {
              element.hide();
            }
            $compile(element.contents())(scope);
            if (newValue.type || oldValue.type) {
              oldValue.type && element.removeClass('alert-' + oldValue.type);
              newValue.type && element.addClass('alert-' + newValue.type);
            }
            if (angular.isDefined(newValue.closeAfter))
              closeAlert(newValue.closeAfter);
            else if (attrs.closeAfter)
              closeAlert(attrs.closeAfter);
            if (angular.isUndefined(attrs.closeButton) || attrs.closeButton !== '0' && attrs.closeButton !== 'false') {
              element.prepend('<button type="button" class="close" data-dismiss="alert">&times;</button>');
            }
          }, true);
        }
        element.addClass('alert').alert();
        if (element.hasClass('fade')) {
          element.removeClass('in');
          setTimeout(function () {
            element.addClass('in');
          });
        }
        var parentArray = attrs.ngRepeat && attrs.ngRepeat.split(' in ').pop();
        element.on('close', function (ev) {
          var removeElement;
          if (parentArray) {
            ev.preventDefault();
            element.removeClass('in');
            removeElement = function () {
              element.trigger('closed');
              if (scope.$parent) {
                scope.$parent.$apply(function () {
                  var path = parentArray.split('.');
                  var curr = scope.$parent;
                  for (var i = 0; i < path.length; ++i) {
                    if (curr) {
                      curr = curr[path[i]];
                    }
                  }
                  if (curr) {
                    curr.splice(scope.$index, 1);
                  }
                });
              }
            };
            $.support.transition && element.hasClass('fade') ? element.on($.support.transition.end, removeElement) : removeElement();
          } else if (value) {
            ev.preventDefault();
            element.removeClass('in');
            removeElement = function () {
              element.trigger('closed');
              scope.$apply(function () {
                value.closed = true;
              });
            };
            $.support.transition && element.hasClass('fade') ? element.on($.support.transition.end, removeElement) : removeElement();
          } else {
          }
        });
      }
    };
  }
]);
'use strict';
angular.module('$strap.directives').directive('bsButton', [
  '$parse',
  '$timeout',
  function ($parse, $timeout) {
    return {
      restrict: 'A',
      require: '?ngModel',
      link: function postLink(scope, element, attrs, controller) {
        if (controller) {
          if (!element.parent('[data-toggle="buttons-checkbox"], [data-toggle="buttons-radio"]').length) {
            element.attr('data-toggle', 'button');
          }
          var startValue = !!scope.$eval(attrs.ngModel);
          if (startValue) {
            element.addClass('active');
          }
          scope.$watch(attrs.ngModel, function (newValue, oldValue) {
            var bNew = !!newValue, bOld = !!oldValue;
            if (bNew !== bOld) {
              $.fn.button.Constructor.prototype.toggle.call(button);
            } else if (bNew && !startValue) {
              element.addClass('active');
            }
          });
        }
        if (!element.hasClass('btn')) {
          element.on('click.button.data-api', function (ev) {
            element.button('toggle');
          });
        }
        element.button();
        var button = element.data('button');
        button.toggle = function () {
          if (!controller) {
            return $.fn.button.Constructor.prototype.toggle.call(this);
          }
          var $parent = element.parent('[data-toggle="buttons-radio"]');
          if ($parent.length) {
            element.siblings('[ng-model]').each(function (k, v) {
              $parse($(v).attr('ng-model')).assign(scope, false);
            });
            scope.$digest();
            if (!controller.$modelValue) {
              controller.$setViewValue(!controller.$modelValue);
              scope.$digest();
            }
          } else {
            scope.$apply(function () {
              controller.$setViewValue(!controller.$modelValue);
            });
          }
        };
      }
    };
  }
]).directive('bsButtonsCheckbox', [
  '$parse',
  function ($parse) {
    return {
      restrict: 'A',
      require: '?ngModel',
      compile: function compile(tElement, tAttrs, transclude) {
        tElement.attr('data-toggle', 'buttons-checkbox').find('a, button').each(function (k, v) {
          $(v).attr('bs-button', '');
        });
      }
    };
  }
]).directive('bsButtonsRadio', [
  '$timeout',
  function ($timeout) {
    return {
      restrict: 'A',
      require: '?ngModel',
      compile: function compile(tElement, tAttrs, transclude) {
        tElement.attr('data-toggle', 'buttons-radio');
        if (!tAttrs.ngModel) {
          tElement.find('a, button').each(function (k, v) {
            $(v).attr('bs-button', '');
          });
        }
        return function postLink(scope, iElement, iAttrs, controller) {
          if (controller) {
            $timeout(function () {
              iElement.find('[value]').button().filter('[value="' + controller.$viewValue + '"]').addClass('active');
            });
            iElement.on('click.button.data-api', function (ev) {
              scope.$apply(function () {
                controller.$setViewValue($(ev.target).closest('button').attr('value'));
              });
            });
            scope.$watch(iAttrs.ngModel, function (newValue, oldValue) {
              if (newValue !== oldValue) {
                var $btn = iElement.find('[value="' + scope.$eval(iAttrs.ngModel) + '"]');
                if ($btn.length) {
                  $btn.button('toggle');
                }
              }
            });
          }
        };
      }
    };
  }
]);
'use strict';
angular.module('$strap.directives').directive('bsButtonSelect', [
  '$parse',
  '$timeout',
  function ($parse, $timeout) {
    return {
      restrict: 'A',
      require: '?ngModel',
      link: function postLink(scope, element, attrs, ctrl) {
        var getter = $parse(attrs.bsButtonSelect), setter = getter.assign;
        if (ctrl) {
          element.text(scope.$eval(attrs.ngModel));
          scope.$watch(attrs.ngModel, function (newValue, oldValue) {
            element.text(newValue);
          });
        }
        var values, value, index, newValue;
        element.bind('click', function (ev) {
          values = getter(scope);
          value = ctrl ? scope.$eval(attrs.ngModel) : element.text();
          index = values.indexOf(value);
          newValue = index > values.length - 2 ? values[0] : values[index + 1];
          scope.$apply(function () {
            element.text(newValue);
            if (ctrl) {
              ctrl.$setViewValue(newValue);
            }
          });
        });
      }
    };
  }
]);
'use strict';
angular.module('$strap.directives').directive('bsDatepicker', [
  '$timeout',
  '$strapConfig',
  function ($timeout, $strapConfig) {
    var isAppleTouch = /(iP(a|o)d|iPhone)/g.test(navigator.userAgent);
    var regexpMap = function regexpMap(language) {
      language = language || 'en';
      return {
        '/': '[\\/]',
        '-': '[-]',
        '.': '[.]',
        ' ': '[\\s]',
        'dd': '(?:(?:[0-2]?[0-9]{1})|(?:[3][01]{1}))',
        'd': '(?:(?:[0-2]?[0-9]{1})|(?:[3][01]{1}))',
        'mm': '(?:[0]?[1-9]|[1][012])',
        'm': '(?:[0]?[1-9]|[1][012])',
        'DD': '(?:' + $.fn.datepicker.dates[language].days.join('|') + ')',
        'D': '(?:' + $.fn.datepicker.dates[language].daysShort.join('|') + ')',
        'MM': '(?:' + $.fn.datepicker.dates[language].months.join('|') + ')',
        'M': '(?:' + $.fn.datepicker.dates[language].monthsShort.join('|') + ')',
        'yyyy': '(?:(?:[1]{1}[0-9]{1}[0-9]{1}[0-9]{1})|(?:[2]{1}[0-9]{3}))(?![[0-9]])',
        'yy': '(?:(?:[0-9]{1}[0-9]{1}))(?![[0-9]])'
      };
    };
    var regexpForDateFormat = function regexpForDateFormat(format, language) {
      var re = format, map = regexpMap(language), i;
      i = 0;
      angular.forEach(map, function (v, k) {
        re = re.split(k).join('${' + i + '}');
        i++;
      });
      i = 0;
      angular.forEach(map, function (v, k) {
        re = re.split('${' + i + '}').join(v);
        i++;
      });
      return new RegExp('^' + re + '$', ['i']);
    };
    return {
      restrict: 'A',
      require: '?ngModel',
      link: function postLink(scope, element, attrs, controller) {
        var options = angular.extend({ autoclose: true }, $strapConfig.datepicker || {}), type = attrs.dateType || options.type || 'date';
        angular.forEach([
          'format',
          'weekStart',
          'calendarWeeks',
          'startDate',
          'endDate',
          'daysOfWeekDisabled',
          'autoclose',
          'startView',
          'minViewMode',
          'todayBtn',
          'todayHighlight',
          'keyboardNavigation',
          'language',
          'forceParse'
        ], function (key) {
          if (angular.isDefined(attrs[key]))
            options[key] = attrs[key];
        });
        var language = options.language || 'en', readFormat = attrs.dateFormat || options.format || $.fn.datepicker.dates[language] && $.fn.datepicker.dates[language].format || 'mm/dd/yyyy', format = isAppleTouch ? 'yyyy-mm-dd' : readFormat, dateFormatRegexp = regexpForDateFormat(format, language);
        if (controller) {
          controller.$formatters.unshift(function (modelValue) {
            return type === 'date' && angular.isString(modelValue) && modelValue ? $.fn.datepicker.DPGlobal.parseDate(modelValue, $.fn.datepicker.DPGlobal.parseFormat(readFormat), language) : modelValue;
          });
          controller.$parsers.unshift(function (viewValue) {
            if (!viewValue) {
              controller.$setValidity('date', true);
              return null;
            } else if (type === 'date' && angular.isDate(viewValue)) {
              controller.$setValidity('date', true);
              return viewValue;
            } else if (angular.isString(viewValue) && dateFormatRegexp.test(viewValue)) {
              controller.$setValidity('date', true);
              if (isAppleTouch)
                return new Date(viewValue);
              return type === 'string' ? viewValue : $.fn.datepicker.DPGlobal.parseDate(viewValue, $.fn.datepicker.DPGlobal.parseFormat(format), language);
            } else {
              controller.$setValidity('date', false);
              return undefined;
            }
          });
          controller.$render = function ngModelRender() {
            if (isAppleTouch) {
              var date = controller.$viewValue ? $.fn.datepicker.DPGlobal.formatDate(controller.$viewValue, $.fn.datepicker.DPGlobal.parseFormat(format), language) : '';
              element.val(date);
              return date;
            }
            if (!controller.$viewValue)
              element.val('');
            return element.datepicker('update', controller.$viewValue);
          };
        }
        if (isAppleTouch) {
          element.prop('type', 'date').css('-webkit-appearance', 'textfield');
        } else {
          if (controller) {
            element.on('changeDate', function (ev) {
              scope.$apply(function () {
                controller.$setViewValue(type === 'string' ? element.val() : ev.date);
              });
            });
          }
          element.datepicker(angular.extend(options, {
            format: format,
            language: language
          }));
          scope.$on('$destroy', function () {
            var datepicker = element.data('datepicker');
            if (datepicker) {
              datepicker.picker.remove();
              element.data('datepicker', null);
            }
          });
          attrs.$observe('startDate', function (value) {
            element.datepicker('setStartDate', value);
          });
          attrs.$observe('endDate', function (value) {
            element.datepicker('setEndDate', value);
          });
        }
        var component = element.siblings('[data-toggle="datepicker"]');
        if (component.length) {
          component.on('click', function () {
            if (!element.prop('disabled')) {
              element.trigger('focus');
            }
          });
        }
      }
    };
  }
]);
'use strict';
angular.module('$strap.directives').directive('bsDropdown', [
  '$parse',
  '$compile',
  '$timeout',
  function ($parse, $compile, $timeout) {
    var buildTemplate = function (items, ul) {
      if (!ul)
        ul = [
          '<ul class="dropdown-menu" role="menu" aria-labelledby="drop1">',
          '</ul>'
        ];
      angular.forEach(items, function (item, index) {
        if (item.divider)
          return ul.splice(index + 1, 0, '<li class="divider"></li>');
        var li = '<li' + (item.submenu && item.submenu.length ? ' class="dropdown-submenu"' : '') + '>' + '<a tabindex="-1" ng-href="' + (item.href || '') + '"' + (item.click ? '" ng-click="' + item.click + '"' : '') + (item.target ? '" target="' + item.target + '"' : '') + (item.method ? '" data-method="' + item.method + '"' : '') + '>' + (item.text || '') + '</a>';
        if (item.submenu && item.submenu.length)
          li += buildTemplate(item.submenu).join('\n');
        li += '</li>';
        ul.splice(index + 1, 0, li);
      });
      return ul;
    };
    return {
      restrict: 'EA',
      scope: true,
      link: function postLink(scope, iElement, iAttrs) {
        var getter = $parse(iAttrs.bsDropdown), items = getter(scope);
        $timeout(function () {
          if (!angular.isArray(items)) {
          }
          var dropdown = angular.element(buildTemplate(items).join(''));
          dropdown.insertAfter(iElement);
          $compile(iElement.next('ul.dropdown-menu'))(scope);
        });
        iElement.addClass('dropdown-toggle').attr('data-toggle', 'dropdown');
      }
    };
  }
]);
'use strict';
angular.module('$strap.directives').factory('$modal', [
  '$rootScope',
  '$compile',
  '$http',
  '$timeout',
  '$q',
  '$templateCache',
  '$strapConfig',
  function ($rootScope, $compile, $http, $timeout, $q, $templateCache, $strapConfig) {
    var ModalFactory = function ModalFactory(config) {
      function Modal(config) {
        var options = angular.extend({ show: true }, $strapConfig.modal, config), scope = options.scope ? options.scope : $rootScope.$new(), templateUrl = options.template;
        return $q.when($templateCache.get(templateUrl) || $http.get(templateUrl, { cache: true }).then(function (res) {
          return res.data;
        })).then(function onSuccess(template) {
          var id = templateUrl.replace('.html', '').replace(/[\/|\.|:]/g, '-') + '-' + scope.$id;
          var $modal = $('<div class="modal hide" tabindex="-1"></div>').attr('id', id).addClass('fade').html(template);
          if (options.modalClass)
            $modal.addClass(options.modalClass);
          $('body').append($modal);
          $timeout(function () {
            $compile($modal)(scope);
          });
          scope.$modal = function (name) {
            $modal.modal(name);
          };
          angular.forEach([
            'show',
            'hide'
          ], function (name) {
            scope[name] = function () {
              $modal.modal(name);
            };
          });
          scope.dismiss = scope.hide;
          angular.forEach([
            'show',
            'shown',
            'hide',
            'hidden'
          ], function (name) {
            $modal.on(name, function (ev) {
              scope.$emit('modal-' + name, ev);
            });
          });
          $modal.on('shown', function (ev) {
            $('input[autofocus], textarea[autofocus]', $modal).first().trigger('focus');
          });
          $modal.on('hidden', function (ev) {
            if (!options.persist)
              scope.$destroy();
          });
          scope.$on('$destroy', function () {
            $modal.remove();
          });
          $modal.modal(options);
          return $modal;
        });
      }
      return new Modal(config);
    };
    return ModalFactory;
  }
]).directive('bsModal', [
  '$q',
  '$modal',
  function ($q, $modal) {
    return {
      restrict: 'A',
      scope: true,
      link: function postLink(scope, iElement, iAttrs, controller) {
        var options = {
            template: scope.$eval(iAttrs.bsModal),
            persist: true,
            show: false,
            scope: scope
          };
        angular.forEach([
          'modalClass',
          'backdrop',
          'keyboard'
        ], function (key) {
          if (angular.isDefined(iAttrs[key]))
            options[key] = iAttrs[key];
        });
        $q.when($modal(options)).then(function onSuccess(modal) {
          iElement.attr('data-target', '#' + modal.attr('id')).attr('data-toggle', 'modal');
        });
      }
    };
  }
]);
'use strict';
angular.module('$strap.directives').directive('bsNavbar', [
  '$location',
  function ($location) {
    return {
      restrict: 'A',
      link: function postLink(scope, element, attrs, controller) {
        scope.$watch(function () {
          return $location.path();
        }, function (newValue, oldValue) {
          $('li[data-match-route]', element).each(function (k, li) {
            var $li = angular.element(li), pattern = $li.attr('data-match-route'), regexp = new RegExp('^' + pattern + '$', ['i']);
            if (regexp.test(newValue)) {
              $li.addClass('active').find('.collapse.in').collapse('hide');
            } else {
              $li.removeClass('active');
            }
          });
        });
      }
    };
  }
]);
'use strict';
angular.module('$strap.directives').directive('bsPopover', [
  '$parse',
  '$compile',
  '$http',
  '$timeout',
  '$q',
  '$templateCache',
  function ($parse, $compile, $http, $timeout, $q, $templateCache) {
    $('body').on('keyup', function (ev) {
      if (ev.keyCode === 27) {
        $('.popover.in').each(function () {
          $(this).popover('hide');
        });
      }
    });
    return {
      restrict: 'A',
      scope: true,
      link: function postLink(scope, element, attr, ctrl) {
        var getter = $parse(attr.bsPopover), setter = getter.assign, value = getter(scope), options = {};
        if (angular.isObject(value)) {
          options = value;
        }
        $q.when(options.content || $templateCache.get(value) || $http.get(value, { cache: true })).then(function onSuccess(template) {
          if (angular.isObject(template)) {
            template = template.data;
          }
          if (!!attr.unique) {
            element.on('show', function (ev) {
              $('.popover.in').each(function () {
                var $this = $(this), popover = $this.data('popover');
                if (popover && !popover.$element.is(element)) {
                  $this.popover('hide');
                }
              });
            });
          }
          if (!!attr.hide) {
            scope.$watch(attr.hide, function (newValue, oldValue) {
              if (!!newValue) {
                popover.hide();
              } else if (newValue !== oldValue) {
                popover.show();
              }
            });
          }
          if (!!attr.show) {
            scope.$watch(attr.show, function (newValue, oldValue) {
              if (!!newValue) {
                $timeout(function () {
                  popover.show();
                });
              } else if (newValue !== oldValue) {
                popover.hide();
              }
            });
          }
          element.popover(angular.extend({}, options, {
            content: template,
            html: true
          }));
          var popover = element.data('popover');
          popover.hasContent = function () {
            return this.getTitle() || template;
          };
          popover.getPosition = function () {
            var r = $.fn.popover.Constructor.prototype.getPosition.apply(this, arguments);
            $compile(this.$tip)(scope);
            scope.$digest();
            this.$tip.data('popover', this);
            return r;
          };
          scope.$popover = function (name) {
            popover(name);
          };
          angular.forEach([
            'show',
            'hide'
          ], function (name) {
            scope[name] = function () {
              popover[name]();
            };
          });
          scope.dismiss = scope.hide;
          angular.forEach([
            'show',
            'shown',
            'hide',
            'hidden'
          ], function (name) {
            element.on(name, function (ev) {
              scope.$emit('popover-' + name, ev);
            });
          });
        });
      }
    };
  }
]);
'use strict';
angular.module('$strap.directives').directive('bsSelect', [
  '$timeout',
  function ($timeout) {
    var NG_OPTIONS_REGEXP = /^\s*(.*?)(?:\s+as\s+(.*?))?(?:\s+group\s+by\s+(.*))?\s+for\s+(?:([\$\w][\$\w\d]*)|(?:\(\s*([\$\w][\$\w\d]*)\s*,\s*([\$\w][\$\w\d]*)\s*\)))\s+in\s+(.*)$/;
    return {
      restrict: 'A',
      require: '?ngModel',
      link: function postLink(scope, element, attrs, controller) {
        var options = scope.$eval(attrs.bsSelect) || {};
        $timeout(function () {
          element.selectpicker(options);
          element.next().removeClass('ng-scope');
        });
        if (controller) {
          scope.$watch(attrs.ngModel, function (newValue, oldValue) {
            if (!angular.equals(newValue, oldValue)) {
              element.selectpicker('refresh');
            }
          });
        }
      }
    };
  }
]);
'use strict';
angular.module('$strap.directives').directive('bsTabs', [
  '$parse',
  '$compile',
  '$timeout',
  function ($parse, $compile, $timeout) {
    var template = '<div class="tabs">' + '<ul class="nav nav-tabs">' + '<li ng-repeat="pane in panes" ng-class="{active:pane.active}">' + '<a data-target="#{{pane.id}}" data-index="{{$index}}" data-toggle="tab">{{pane.title}}</a>' + '</li>' + '</ul>' + '<div class="tab-content" ng-transclude>' + '</div>';
    return {
      restrict: 'A',
      require: '?ngModel',
      priority: 0,
      scope: true,
      template: template,
      replace: true,
      transclude: true,
      compile: function compile(tElement, tAttrs, transclude) {
        return function postLink(scope, iElement, iAttrs, controller) {
          var getter = $parse(iAttrs.bsTabs), setter = getter.assign, value = getter(scope);
          scope.panes = [];
          var $tabs = iElement.find('ul.nav-tabs');
          var $panes = iElement.find('div.tab-content');
          var activeTab = 0, id, title, active;
          $timeout(function () {
            $panes.find('[data-title], [data-tab]').each(function (index) {
              var $this = angular.element(this);
              id = 'tab-' + scope.$id + '-' + index;
              title = $this.data('title') || $this.data('tab');
              active = !active && $this.hasClass('active');
              $this.attr('id', id).addClass('tab-pane');
              if (iAttrs.fade)
                $this.addClass('fade');
              scope.panes.push({
                id: id,
                title: title,
                content: this.innerHTML,
                active: active
              });
            });
            if (scope.panes.length && !active) {
              $panes.find('.tab-pane:first-child').addClass('active' + (iAttrs.fade ? ' in' : ''));
              scope.panes[0].active = true;
            }
          });
          if (controller) {
            iElement.on('show', function (ev) {
              var $target = $(ev.target);
              scope.$apply(function () {
                controller.$setViewValue($target.data('index'));
              });
            });
            scope.$watch(iAttrs.ngModel, function (newValue, oldValue) {
              if (angular.isUndefined(newValue))
                return;
              activeTab = newValue;
              setTimeout(function () {
                var $next = $($tabs[0].querySelectorAll('li')[newValue * 1]);
                if (!$next.hasClass('active')) {
                  $next.children('a').tab('show');
                }
              });
            });
          }
        };
      }
    };
  }
]);
'use strict';
angular.module('$strap.directives').directive('bsTimepicker', [
  '$timeout',
  '$strapConfig',
  function ($timeout, $strapConfig) {
    var TIME_REGEXP = '((?:(?:[0-1][0-9])|(?:[2][0-3])|(?:[0-9])):(?:[0-5][0-9])(?::[0-5][0-9])?(?:\\s?(?:am|AM|pm|PM))?)';
    return {
      restrict: 'A',
      require: '?ngModel',
      link: function postLink(scope, element, attrs, controller) {
        if (controller) {
          element.on('changeTime.timepicker', function (ev) {
            $timeout(function () {
              controller.$setViewValue(element.val());
            });
          });
          var timeRegExp = new RegExp('^' + TIME_REGEXP + '$', ['i']);
          controller.$parsers.unshift(function (viewValue) {
            if (!viewValue || timeRegExp.test(viewValue)) {
              controller.$setValidity('time', true);
              return viewValue;
            } else {
              controller.$setValidity('time', false);
              return;
            }
          });
        }
        element.attr('data-toggle', 'timepicker');
        element.parent().addClass('bootstrap-timepicker');
        element.timepicker($strapConfig.timepicker || {});
        var timepicker = element.data('timepicker');
        var component = element.siblings('[data-toggle="timepicker"]');
        if (component.length) {
          component.on('click', $.proxy(timepicker.showWidget, timepicker));
        }
      }
    };
  }
]);
'use strict';
angular.module('$strap.directives').directive('bsTooltip', [
  '$parse',
  '$compile',
  function ($parse, $compile) {
    return {
      restrict: 'A',
      scope: true,
      link: function postLink(scope, element, attrs, ctrl) {
        var getter = $parse(attrs.bsTooltip), setter = getter.assign, value = getter(scope);
        scope.$watch(attrs.bsTooltip, function (newValue, oldValue) {
          if (newValue !== oldValue) {
            value = newValue;
          }
        });
        if (!!attrs.unique) {
          element.on('show', function (ev) {
            $('.tooltip.in').each(function () {
              var $this = $(this), tooltip = $this.data('tooltip');
              if (tooltip && !tooltip.$element.is(element)) {
                $this.tooltip('hide');
              }
            });
          });
        }
        element.tooltip({
          title: function () {
            return angular.isFunction(value) ? value.apply(null, arguments) : value;
          },
          html: true
        });
        var tooltip = element.data('tooltip');
        tooltip.show = function () {
          var r = $.fn.tooltip.Constructor.prototype.show.apply(this, arguments);
          this.tip().data('tooltip', this);
          return r;
        };
        scope._tooltip = function (event) {
          element.tooltip(event);
        };
        scope.hide = function () {
          element.tooltip('hide');
        };
        scope.show = function () {
          element.tooltip('show');
        };
        scope.dismiss = scope.hide;
      }
    };
  }
]);
'use strict';
angular.module('$strap.directives').directive('bsTypeahead', [
  '$parse',
  function ($parse) {
    return {
      restrict: 'A',
      require: '?ngModel',
      link: function postLink(scope, element, attrs, controller) {
        var getter = $parse(attrs.bsTypeahead), setter = getter.assign, value = getter(scope);
        scope.$watch(attrs.bsTypeahead, function (newValue, oldValue) {
          if (newValue !== oldValue) {
            value = newValue;
          }
        });
        element.attr('data-provide', 'typeahead');
        element.typeahead({
          source: function (query) {
            return angular.isFunction(value) ? value.apply(null, arguments) : value;
          },
          minLength: attrs.minLength || 1,
          items: attrs.items,
          updater: function (value) {
            if (controller) {
              scope.$apply(function () {
                controller.$setViewValue(value);
              });
            }
            scope.$emit('typeahead-updated', value);
            return value;
          }
        });
        var typeahead = element.data('typeahead');
        typeahead.lookup = function (ev) {
          var items;
          this.query = this.$element.val() || '';
          if (this.query.length < this.options.minLength) {
            return this.shown ? this.hide() : this;
          }
          items = $.isFunction(this.source) ? this.source(this.query, $.proxy(this.process, this)) : this.source;
          return items ? this.process(items) : this;
        };
        if (!!attrs.matchAll) {
          typeahead.matcher = function (item) {
            return true;
          };
        }
        if (attrs.minLength === '0') {
          setTimeout(function () {
            element.on('focus', function () {
              element.val().length === 0 && setTimeout(element.typeahead.bind(element, 'lookup'), 200);
            });
          });
        }
      }
    };
  }
]);
/**
 * angular-strap
 * @version v2.0.0-rc.2 - 2014-01-29
 * @link http://mgcrea.github.io/angular-strap
 * @author [object Object]
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(){"use strict";angular.module("mgcrea.ngStrap.alert").run(["$templateCache",function(a){a.put("alert/alert.tpl.html",'<div class="alert" tabindex="-1" ng-class="[type ? \'alert-\' + type : null]"><button type="button" class="close" ng-click="$hide()">&times;</button> <strong ng-bind="title"></strong>&nbsp;<span ng-bind-html="content"></span></div>')}]),angular.module("mgcrea.ngStrap.aside").run(["$templateCache",function(a){a.put("aside/aside.tpl.html",'<div class="aside" tabindex="-1" role="dialog"><div class="aside-dialog"><div class="aside-content"><div class="aside-header" ng-show="title"><button type="button" class="close" ng-click="$hide()">&times;</button><h4 class="aside-title" ng-bind="title"></h4></div><div class="aside-body" ng-bind="content"></div><div class="aside-footer"><button type="button" class="btn btn-default" ng-click="$hide()">Close</button></div></div></div></div>')}]),angular.module("mgcrea.ngStrap.datepicker").run(["$templateCache",function(a){a.put("datepicker/datepicker.tpl.html",'<div class="dropdown-menu datepicker" ng-class="\'datepicker-mode-\' + $mode" style="max-width: 320px"><table style="table-layout: fixed; height: 100%; width: 100%"><thead><tr class="text-center"><th><button tabindex="-1" type="button" class="btn btn-default pull-left" ng-click="$selectPane(-1)"><i class="glyphicon glyphicon-chevron-left"></i></button></th><th colspan="{{ rows[0].length - 2 }}"><button tabindex="-1" type="button" class="btn btn-default btn-block text-strong" ng-click="$toggleMode()"><strong style="text-transform: capitalize" ng-bind="title"></strong></button></th><th><button tabindex="-1" type="button" class="btn btn-default pull-right" ng-click="$selectPane(+1)"><i class="glyphicon glyphicon-chevron-right"></i></button></th></tr><tr ng-show="labels" ng-bind-html="labels"></tr></thead><tbody><tr ng-repeat="(i, row) in rows" height="{{ 100 / rows.length }}%"><td class="text-center" ng-repeat="(j, el) in row"><button tabindex="-1" type="button" class="btn btn-default" style="width: 100%" ng-class="{\'btn-primary\': el.selected}" ng-click="$select(el.date)" ng-disabled="el.disabled"><span ng-class="{\'text-muted\': el.muted}" ng-bind="el.label"></span></button></td></tr></tbody></table></div>')}]),angular.module("mgcrea.ngStrap.dropdown").run(["$templateCache",function(a){a.put("dropdown/dropdown.tpl.html",'<ul tabindex="-1" class="dropdown-menu" role="menu"><li role="presentation" ng-class="{divider: item.divider}" ng-repeat="item in content"><a role="menuitem" tabindex="-1" href="{{item.href}}" ng-if="!item.divider" ng-click="$eval(item.click);$hide()" ng-bind="item.text"></a></li></ul>')}]),angular.module("mgcrea.ngStrap.modal").run(["$templateCache",function(a){a.put("modal/modal.tpl.html",'<div class="modal" tabindex="-1" role="dialog"><div class="modal-dialog"><div class="modal-content"><div class="modal-header" ng-show="title"><button type="button" class="close" ng-click="$hide()">&times;</button><h4 class="modal-title" ng-bind="title"></h4></div><div class="modal-body" ng-bind="content"></div><div class="modal-footer"><button type="button" class="btn btn-default" ng-click="$hide()">Close</button></div></div></div></div>')}]),angular.module("mgcrea.ngStrap.popover").run(["$templateCache",function(a){a.put("popover/popover.tpl.html",'<div class="popover"><div class="arrow"></div><h3 class="popover-title" ng-bind="title" ng-show="title"></h3><div class="popover-content" ng-bind="content"></div></div>')}]),angular.module("mgcrea.ngStrap.select").run(["$templateCache",function(a){a.put("select/select.tpl.html",'<ul tabindex="-1" class="select dropdown-menu" ng-show="$isVisible()" role="select"><li role="presentation" ng-repeat="match in $matches" ng-class="{active: $isActive($index)}"><a style="cursor: default" role="menuitem" tabindex="-1" ng-click="$select($index, $event)"><span ng-bind="match.label"></span> <i class="glyphicon glyphicon-ok pull-right" ng-if="$isMultiple && $isActive($index)"></i></a></li></ul>')}]),angular.module("mgcrea.ngStrap.tab").run(["$templateCache",function(a){a.put("tab/tab.tpl.html",'<ul class="nav nav-tabs"><li ng-repeat="pane in panes" ng-class="{active: $index == active}"><a data-toggle="tab" ng-click="setActive($index, $event)" data-index="{{$index}}">{{pane.title}}</a></li></ul><div class="tab-content"><div ng-repeat="pane in panes" class="tab-pane" ng-class="[$index == active ? \'active\' : \'\']" ng-include="pane.template || \'$pane\'"></div></div>')}]),angular.module("mgcrea.ngStrap.timepicker").run(["$templateCache",function(a){a.put("timepicker/timepicker.tpl.html",'<div class="dropdown-menu timepicker" style="min-width: 0px;width: auto"><table height="100%"><thead><tr class="text-center"><th><button tabindex="-1" type="button" class="btn btn-default pull-left" ng-click="$moveIndex(-1, 0)"><i class="glyphicon glyphicon-chevron-up"></i></button></th><th>&nbsp;</th><th><button tabindex="-1" type="button" class="btn btn-default pull-left" ng-click="$moveIndex(-1, 1)"><i class="glyphicon glyphicon-chevron-up"></i></button></th></tr></thead><tbody><tr ng-repeat="(i, row) in rows"><td class="text-center"><button tabindex="-1" style="width: 100%" type="button" class="btn btn-default" ng-class="{\'btn-primary\': row[0].selected}" ng-click="$select(row[0].date, 0)" ng-disabled="row[0].disabled"><span ng-class="{\'text-muted\': row[0].muted}" ng-bind="row[0].label"></span></button></td><td><span ng-bind="i == midIndex ? \':\' : \' \'"></span></td><td class="text-center"><button tabindex="-1" ng-if="row[1].date" style="width: 100%" type="button" class="btn btn-default" ng-class="{\'btn-primary\': row[1].selected}" ng-click="$select(row[1].date, 1)" ng-disabled="row[1].disabled"><span ng-class="{\'text-muted\': row[1].muted}" ng-bind="row[1].label"></span></button></td><td ng-if="showAM">&nbsp;</td><td ng-if="showAM"><button tabindex="-1" ng-show="i == midIndex - !isAM * 1" style="width: 100%" type="button" ng-class="{\'btn-primary\': !!isAM}" class="btn btn-default" ng-click="$switchMeridian()" ng-disabled="el.disabled">AM</button> <button tabindex="-1" ng-show="i == midIndex + 1 - !isAM * 1" style="width: 100%" type="button" ng-class="{\'btn-primary\': !isAM}" class="btn btn-default" ng-click="$switchMeridian()" ng-disabled="el.disabled">PM</button></td></tr></tbody><tfoot><tr class="text-center"><th><button tabindex="-1" type="button" class="btn btn-default pull-left" ng-click="$moveIndex(1, 0)"><i class="glyphicon glyphicon-chevron-down"></i></button></th><th>&nbsp;</th><th><button tabindex="-1" type="button" class="btn btn-default pull-left" ng-click="$moveIndex(1, 1)"><i class="glyphicon glyphicon-chevron-down"></i></button></th></tr></tfoot></table></div>')}]),angular.module("mgcrea.ngStrap.tooltip").run(["$templateCache",function(a){a.put("tooltip/tooltip.tpl.html",'<div class="tooltip" ng-show="title"><div class="tooltip-arrow"></div><div class="tooltip-inner" ng-bind="title"></div></div>')}]),angular.module("mgcrea.ngStrap.typeahead").run(["$templateCache",function(a){a.put("typeahead/typeahead.tpl.html",'<ul tabindex="-1" class="typeahead dropdown-menu" ng-show="$isVisible()" role="select"><li role="presentation" ng-repeat="match in $matches" ng-class="{active: $index == $activeIndex}"><a role="menuitem" tabindex="-1" ng-click="$select($index, $event)" ng-bind="match.label"></a></li></ul>')}])}(window,document);
(function(window, document, undefined) {
	'use strict';
	angular.module('d3', []).factory('d3Service',
		['$q', '$window','$rootScope',
		function($q, $window, $rootScope) {
			var d = $q.defer();
			var d3IsLoaded = false;
			function onScriptLoad() {
				// Load client in the browser
				if ($window.d3) {
					d3IsLoaded = true;
                    d.resolve($window.d3);
				}
				return d3IsLoaded;
			}

			if (!onScriptLoad()) {
				angular.select('script').on('load', onScriptLoad);
			}

			return {
				d3: function() { return d.promise; }
			};
	}]);
})(window, document);
/**
 * angular-timer - v1.1.8 - 2014-10-24 3:55 PM
 * https://github.com/siddii/angular-timer
 *
 * Copyright (c) 2014 Siddique Hameed
 * Licensed MIT <https://github.com/siddii/angular-timer/blob/master/LICENSE.txt>
 */
var timerModule=angular.module("timer",[]).directive("timer",["$compile",function(a){return{restrict:"EAC",replace:!1,scope:{interval:"=interval",startTimeAttr:"=startTime",endTimeAttr:"=endTime",countdownattr:"=countdown",finishCallback:"&finishCallback",autoStart:"&autoStart",maxTimeUnit:"="},controller:["$scope","$element","$attrs","$timeout",function(b,c,d,e){function f(){b.timeoutId&&clearTimeout(b.timeoutId)}function g(){void 0!==d.startTime&&(b.millis=new Date-new Date(b.startTimeAttr)),b.maxTimeUnit&&"day"!==b.maxTimeUnit?"second"===b.maxTimeUnit?(b.seconds=Math.floor(b.millis/1e3),b.minutes=0,b.hours=0,b.days=0,b.months=0,b.years=0):"minute"===b.maxTimeUnit?(b.seconds=Math.floor(b.millis/1e3%60),b.minutes=Math.floor(b.millis/6e4),b.hours=0,b.days=0,b.months=0,b.years=0):"hour"===b.maxTimeUnit?(b.seconds=Math.floor(b.millis/1e3%60),b.minutes=Math.floor(b.millis/6e4%60),b.hours=Math.floor(b.millis/36e5),b.days=0,b.months=0,b.years=0):"month"===b.maxTimeUnit?(b.seconds=Math.floor(b.millis/1e3%60),b.minutes=Math.floor(b.millis/6e4%60),b.hours=Math.floor(b.millis/36e5%24),b.days=Math.floor(b.millis/36e5/24%30),b.months=Math.floor(b.millis/36e5/24/30),b.years=0):"year"===b.maxTimeUnit&&(b.seconds=Math.floor(b.millis/1e3%60),b.minutes=Math.floor(b.millis/6e4%60),b.hours=Math.floor(b.millis/36e5%24),b.days=Math.floor(b.millis/36e5/24%30),b.months=Math.floor(b.millis/36e5/24/30%12),b.years=Math.floor(b.millis/36e5/24/365)):(b.seconds=Math.floor(b.millis/1e3%60),b.minutes=Math.floor(b.millis/6e4%60),b.hours=Math.floor(b.millis/36e5%24),b.days=Math.floor(b.millis/36e5/24),b.months=0,b.years=0),b.secondsS=1===b.seconds||0===b.seconds?"":"s",b.minutesS=1===b.minutes||0===b.minutes?"":"s",b.hoursS=1===b.hours||0===b.hours?"":"s",b.daysS=1===b.days||0===b.days?"":"s",b.monthsS=1===b.months||0===b.months?"":"s",b.yearsS=1===b.years||0===b.years?"":"s",b.sseconds=b.seconds<10?"0"+b.seconds:b.seconds,b.mminutes=b.minutes<10?"0"+b.minutes:b.minutes,b.hhours=b.hours<10?"0"+b.hours:b.hours,b.ddays=b.days<10?"0"+b.days:b.days,b.mmonths=b.months<10?"0"+b.months:b.months,b.yyears=b.years<10?"0"+b.years:b.years}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),b.autoStart=d.autoStart||d.autostart,c.append(0===c.html().trim().length?a("<span>{{millis}}</span>")(b):a(c.contents())(b)),b.startTime=null,b.endTime=null,b.timeoutId=null,b.countdown=b.countdownattr&&parseInt(b.countdownattr,10)>=0?parseInt(b.countdownattr,10):void 0,b.isRunning=!1,b.$on("timer-start",function(){b.start()}),b.$on("timer-resume",function(){b.resume()}),b.$on("timer-stop",function(){b.stop()}),b.$on("timer-clear",function(){b.clear()}),b.$on("timer-set-countdown",function(a,c){b.countdown=c}),b.start=c[0].start=function(){b.startTime=b.startTimeAttr?new Date(b.startTimeAttr):new Date,b.endTime=b.endTimeAttr?new Date(b.endTimeAttr):null,b.countdown||(b.countdown=b.countdownattr&&parseInt(b.countdownattr,10)>0?parseInt(b.countdownattr,10):void 0),f(),h(),b.isRunning=!0},b.resume=c[0].resume=function(){f(),b.countdownattr&&(b.countdown+=1),b.startTime=new Date-(b.stoppedTime-b.startTime),h(),b.isRunning=!0},b.stop=b.pause=c[0].stop=c[0].pause=function(){var a=b.timeoutId;b.clear(),b.$emit("timer-stopped",{timeoutId:a,millis:b.millis,seconds:b.seconds,minutes:b.minutes,hours:b.hours,days:b.days})},b.clear=c[0].clear=function(){b.stoppedTime=new Date,f(),b.timeoutId=null,b.isRunning=!1},c.bind("$destroy",function(){f(),b.isRunning=!1}),b.countdownattr?(b.millis=1e3*b.countdownattr,b.addCDSeconds=c[0].addCDSeconds=function(a){b.countdown+=a,b.$digest(),b.isRunning||b.start()},b.$on("timer-add-cd-seconds",function(a,c){e(function(){b.addCDSeconds(c)})}),b.$on("timer-set-countdown-seconds",function(a,c){b.isRunning||b.clear(),b.countdown=c,b.millis=1e3*c,g()})):b.millis=0,g();var h=function(){b.millis=new Date-b.startTime;var a=b.millis%1e3;return b.endTimeAttr&&(b.millis=b.endTime-new Date,a=b.interval-b.millis%1e3),b.countdownattr&&(b.millis=1e3*b.countdown),b.millis<0?(b.stop(),b.millis=0,g(),void(b.finishCallback&&b.$eval(b.finishCallback))):(g(),b.timeoutId=setTimeout(function(){h(),b.$digest()},b.interval-a),b.$emit("timer-tick",{timeoutId:b.timeoutId,millis:b.millis}),void(b.countdown>0?b.countdown--:b.countdown<=0&&(b.stop(),b.finishCallback&&b.$eval(b.finishCallback))))};(void 0===b.autoStart||b.autoStart===!0)&&b.start()}]}}]);"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports=timerModule);
/* =========================================================
 * bootstrap-datepicker.js
 * http://www.eyecon.ro/bootstrap-datepicker
 * =========================================================
 * Copyright 2012 Stefan Petre
 * Improvements by Andrew Rowls
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */

!function( $ ) {

	function UTCDate(){
		return new Date(Date.UTC.apply(Date, arguments));
	}
	function UTCToday(){
		var today = new Date();
		return UTCDate(today.getUTCFullYear(), today.getUTCMonth(), today.getUTCDate());
	}

	// Picker object

	var Datepicker = function(element, options) {
		var that = this;

		this.element = $(element);
		this.language = options.language||this.element.data('date-language')||"en";
		this.language = this.language in dates ? this.language : this.language.split('-')[0]; //Check if "de-DE" style date is available, if not language should fallback to 2 letter code eg "de"
		this.language = this.language in dates ? this.language : "en";
		this.isRTL = dates[this.language].rtl||false;
		this.format = DPGlobal.parseFormat(options.format||this.element.data('date-format')||dates[this.language].format||'mm/dd/yyyy');
		this.isInline = false;
		this.isInput = this.element.is('input');
		this.component = this.element.is('.date') ? this.element.find('.add-on, .btn') : false;
		this.hasInput = this.component && this.element.find('input').length;
		if(this.component && this.component.length === 0)
			this.component = false;

		this.forceParse = true;
		if ('forceParse' in options) {
			this.forceParse = options.forceParse;
		} else if ('dateForceParse' in this.element.data()) {
			this.forceParse = this.element.data('date-force-parse');
		}

		this.picker = $(DPGlobal.template);
		this._buildEvents();
		this._attachEvents();

		if(this.isInline) {
			this.picker.addClass('datepicker-inline').appendTo(this.element);
		} else {
			this.picker.addClass('datepicker-dropdown dropdown-menu');
		}
		if (this.isRTL){
			this.picker.addClass('datepicker-rtl');
			this.picker.find('.prev i, .next i')
						.toggleClass('icon-arrow-left icon-arrow-right');
		}

		this.autoclose = false;
		if ('autoclose' in options) {
			this.autoclose = options.autoclose;
		} else if ('dateAutoclose' in this.element.data()) {
			this.autoclose = this.element.data('date-autoclose');
		}

		this.keyboardNavigation = true;
		if ('keyboardNavigation' in options) {
			this.keyboardNavigation = options.keyboardNavigation;
		} else if ('dateKeyboardNavigation' in this.element.data()) {
			this.keyboardNavigation = this.element.data('date-keyboard-navigation');
		}

		this.viewMode = this.startViewMode = 0;
		switch(options.startView || this.element.data('date-start-view')){
			case 2:
			case 'decade':
				this.viewMode = this.startViewMode = 2;
				break;
			case 1:
			case 'year':
				this.viewMode = this.startViewMode = 1;
				break;
		}

		this.minViewMode = options.minViewMode||this.element.data('date-min-view-mode')||0;
		if (typeof this.minViewMode === 'string') {
			switch (this.minViewMode) {
				case 'months':
					this.minViewMode = 1;
					break;
				case 'years':
					this.minViewMode = 2;
					break;
				default:
					this.minViewMode = 0;
					break;
			}
		}

		this.viewMode = this.startViewMode = Math.max(this.startViewMode, this.minViewMode);

		this.todayBtn = (options.todayBtn||this.element.data('date-today-btn')||false);
		this.todayHighlight = (options.todayHighlight||this.element.data('date-today-highlight')||false);

		this.calendarWeeks = false;
		if ('calendarWeeks' in options) {
			this.calendarWeeks = options.calendarWeeks;
		} else if ('dateCalendarWeeks' in this.element.data()) {
			this.calendarWeeks = this.element.data('date-calendar-weeks');
		}
		if (this.calendarWeeks)
			this.picker.find('tfoot th.today')
						.attr('colspan', function(i, val){
							return parseInt(val) + 1;
						});

		this._allow_update = false;

		this.weekStart = ((options.weekStart||this.element.data('date-weekstart')||dates[this.language].weekStart||0) % 7);
		this.weekEnd = ((this.weekStart + 6) % 7);
		this.startDate = -Infinity;
		this.endDate = Infinity;
		this.daysOfWeekDisabled = [];
		this.setStartDate(options.startDate||this.element.data('date-startdate'));
		this.setEndDate(options.endDate||this.element.data('date-enddate'));
		this.setDaysOfWeekDisabled(options.daysOfWeekDisabled||this.element.data('date-days-of-week-disabled'));
		this.fillDow();
		this.fillMonths();

		this._allow_update = true;

		this.update();
		this.showMode();

		if(this.isInline) {
			this.show();
		}
	};

	Datepicker.prototype = {
		constructor: Datepicker,

		_events: [],
		_secondaryEvents: [],
		_applyEvents: function(evs){
			for (var i=0, el, ev; i<evs.length; i++){
				el = evs[i][0];
				ev = evs[i][1];
				el.on(ev);
			}
		},
		_unapplyEvents: function(evs){
			for (var i=0, el, ev; i<evs.length; i++){
				el = evs[i][0];
				ev = evs[i][1];
				el.off(ev);
			}
		},
		_buildEvents: function(){
			if (this.isInput) { // single input
				this._events = [
					[this.element, {
						focus: $.proxy(this.show, this),
						keyup: $.proxy(this.update, this),
						keydown: $.proxy(this.keydown, this)
					}]
				];
			}
			else if (this.component && this.hasInput){ // component: input + button
				this._events = [
					// For components that are not readonly, allow keyboard nav
					[this.element.find('input'), {
						focus: $.proxy(this.show, this),
						keyup: $.proxy(this.update, this),
						keydown: $.proxy(this.keydown, this)
					}],
					[this.component, {
						click: $.proxy(this.show, this)
					}]
				];
			}
			else if (this.element.is('div')) {  // inline datepicker
				this.isInline = true;
			}
			else {
				this._events = [
					[this.element, {
						click: $.proxy(this.show, this)
					}]
				];
			}

			this._secondaryEvents = [
				[this.picker, {
					click: $.proxy(this.click, this)
				}],
				[$(window), {
					resize: $.proxy(this.place, this)
				}],
				[$(document), {
					mousedown: $.proxy(function (e) {
						// Clicked outside the datepicker, hide it
						if ($(e.target).closest('.datepicker.datepicker-inline, .datepicker.datepicker-dropdown').length === 0) {
							this.hide();
						}
					}, this)
				}]
			];
		},
		_attachEvents: function(){
			this._detachEvents();
			this._applyEvents(this._events);
		},
		_detachEvents: function(){
			this._unapplyEvents(this._events);
		},
		_attachSecondaryEvents: function(){
			this._detachSecondaryEvents();
			this._applyEvents(this._secondaryEvents);
		},
		_detachSecondaryEvents: function(){
			this._unapplyEvents(this._secondaryEvents);
		},

		show: function(e) {
			if (!this.isInline)
				this.picker.appendTo('body');
			this.picker.show();
			this.height = this.component ? this.component.outerHeight() : this.element.outerHeight();
			this.place();
			this._attachSecondaryEvents();
			if (e) {
				e.preventDefault();
			}
			this.element.trigger({
				type: 'show',
				date: this.date
			});
		},

		hide: function(e){
			if(this.isInline) return;
			if (!this.picker.is(':visible')) return;
			this.picker.hide().detach();
			this._detachSecondaryEvents();
			this.viewMode = this.startViewMode;
			this.showMode();

			if (
				this.forceParse &&
				(
					this.isInput && this.element.val() ||
					this.hasInput && this.element.find('input').val()
				)
			)
				this.setValue();
			this.element.trigger({
				type: 'hide',
				date: this.date
			});
		},

		remove: function() {
			this.hide();
			this._detachEvents();
			this._detachSecondaryEvents();
			this.picker.remove();
			delete this.element.data().datepicker;
			if (!this.isInput) {
				delete this.element.data().date;
			}
		},

		getDate: function() {
			var d = this.getUTCDate();
			return new Date(d.getTime() + (d.getTimezoneOffset()*60000));
		},

		getUTCDate: function() {
			return this.date;
		},

		setDate: function(d) {
			this.setUTCDate(new Date(d.getTime() - (d.getTimezoneOffset()*60000)));
		},

		setUTCDate: function(d) {
			this.date = d;
			this.setValue();
		},

		setValue: function() {
			var formatted = this.getFormattedDate();
			if (!this.isInput) {
				if (this.component){
					this.element.find('input').val(formatted);
				}
				this.element.data('date', formatted);
			} else {
				this.element.val(formatted);
			}
		},

		getFormattedDate: function(format) {
			if (format === undefined)
				format = this.format;
			return DPGlobal.formatDate(this.date, format, this.language);
		},

		setStartDate: function(startDate){
			this.startDate = startDate||-Infinity;
			if (this.startDate !== -Infinity) {
				this.startDate = DPGlobal.parseDate(this.startDate, this.format, this.language);
			}
			this.update();
			this.updateNavArrows();
		},

		setEndDate: function(endDate){
			this.endDate = endDate||Infinity;
			if (this.endDate !== Infinity) {
				this.endDate = DPGlobal.parseDate(this.endDate, this.format, this.language);
			}
			this.update();
			this.updateNavArrows();
		},

		setDaysOfWeekDisabled: function(daysOfWeekDisabled){
			this.daysOfWeekDisabled = daysOfWeekDisabled||[];
			if (!$.isArray(this.daysOfWeekDisabled)) {
				this.daysOfWeekDisabled = this.daysOfWeekDisabled.split(/,\s*/);
			}
			this.daysOfWeekDisabled = $.map(this.daysOfWeekDisabled, function (d) {
				return parseInt(d, 10);
			});
			this.update();
			this.updateNavArrows();
		},

		place: function(){
						if(this.isInline) return;
			var zIndex = parseInt(this.element.parents().filter(function() {
							return $(this).css('z-index') != 'auto';
						}).first().css('z-index'))+10;
			var offset = this.component ? this.component.parent().offset() : this.element.offset();
			var height = this.component ? this.component.outerHeight(true) : this.element.outerHeight(true);
			this.picker.css({
				top: offset.top + height,
				left: offset.left,
				zIndex: zIndex
			});
		},

		_allow_update: true,
		update: function(){
			if (!this._allow_update) return;

			var date, fromArgs = false;
			if(arguments && arguments.length && (typeof arguments[0] === 'string' || arguments[0] instanceof Date)) {
				date = arguments[0];
				fromArgs = true;
			} else {
				date = this.isInput ? this.element.val() : this.element.data('date') || this.element.find('input').val();
			}

			this.date = DPGlobal.parseDate(date, this.format, this.language);

			if(fromArgs) this.setValue();

			if (this.date < this.startDate) {
				this.viewDate = new Date(this.startDate);
			} else if (this.date > this.endDate) {
				this.viewDate = new Date(this.endDate);
			} else {
				this.viewDate = new Date(this.date);
			}
			this.fill();
		},

		fillDow: function(){
			var dowCnt = this.weekStart,
			html = '<tr>';
			if(this.calendarWeeks){
				var cell = '<th class="cw">&nbsp;</th>';
				html += cell;
				this.picker.find('.datepicker-days thead tr:first-child').prepend(cell);
			}
			while (dowCnt < this.weekStart + 7) {
				html += '<th class="dow">'+dates[this.language].daysMin[(dowCnt++)%7]+'</th>';
			}
			html += '</tr>';
			this.picker.find('.datepicker-days thead').append(html);
		},

		fillMonths: function(){
			var html = '',
			i = 0;
			while (i < 12) {
				html += '<span class="month">'+dates[this.language].monthsShort[i++]+'</span>';
			}
			this.picker.find('.datepicker-months td').html(html);
		},

		fill: function() {
			var d = new Date(this.viewDate),
				year = d.getUTCFullYear(),
				month = d.getUTCMonth(),
				startYear = this.startDate !== -Infinity ? this.startDate.getUTCFullYear() : -Infinity,
				startMonth = this.startDate !== -Infinity ? this.startDate.getUTCMonth() : -Infinity,
				endYear = this.endDate !== Infinity ? this.endDate.getUTCFullYear() : Infinity,
				endMonth = this.endDate !== Infinity ? this.endDate.getUTCMonth() : Infinity,
				currentDate = this.date && this.date.valueOf(),
				today = new Date();
			this.picker.find('.datepicker-days thead th.switch')
						.text(dates[this.language].months[month]+' '+year);
			this.picker.find('tfoot th.today')
						.text(dates[this.language].today)
						.toggle(this.todayBtn !== false);
			this.updateNavArrows();
			this.fillMonths();
			var prevMonth = UTCDate(year, month-1, 28,0,0,0,0),
				day = DPGlobal.getDaysInMonth(prevMonth.getUTCFullYear(), prevMonth.getUTCMonth());
			prevMonth.setUTCDate(day);
			prevMonth.setUTCDate(day - (prevMonth.getUTCDay() - this.weekStart + 7)%7);
			var nextMonth = new Date(prevMonth);
			nextMonth.setUTCDate(nextMonth.getUTCDate() + 42);
			nextMonth = nextMonth.valueOf();
			var html = [];
			var clsName;
			while(prevMonth.valueOf() < nextMonth) {
				if (prevMonth.getUTCDay() == this.weekStart) {
					html.push('<tr>');
					if(this.calendarWeeks){
						// ISO 8601: First week contains first thursday.
						// ISO also states week starts on Monday, but we can be more abstract here.
						var
							// Start of current week: based on weekstart/current date
							ws = new Date(+prevMonth + (this.weekStart - prevMonth.getUTCDay() - 7) % 7 * 864e5),
							// Thursday of this week
							th = new Date(+ws + (7 + 4 - ws.getUTCDay()) % 7 * 864e5),
							// First Thursday of year, year from thursday
							yth = new Date(+(yth = UTCDate(th.getUTCFullYear(), 0, 1)) + (7 + 4 - yth.getUTCDay())%7*864e5),
							// Calendar week: ms between thursdays, div ms per day, div 7 days
							calWeek =  (th - yth) / 864e5 / 7 + 1;
						html.push('<td class="cw">'+ calWeek +'</td>');

					}
				}
				clsName = '';
				if (prevMonth.getUTCFullYear() < year || (prevMonth.getUTCFullYear() == year && prevMonth.getUTCMonth() < month)) {
					clsName += ' old';
				} else if (prevMonth.getUTCFullYear() > year || (prevMonth.getUTCFullYear() == year && prevMonth.getUTCMonth() > month)) {
					clsName += ' new';
				}
				// Compare internal UTC date with local today, not UTC today
				if (this.todayHighlight &&
					prevMonth.getUTCFullYear() == today.getFullYear() &&
					prevMonth.getUTCMonth() == today.getMonth() &&
					prevMonth.getUTCDate() == today.getDate()) {
					clsName += ' today';
				}
				if (currentDate && prevMonth.valueOf() == currentDate) {
					clsName += ' active';
				}
				if (prevMonth.valueOf() < this.startDate || prevMonth.valueOf() > this.endDate ||
					$.inArray(prevMonth.getUTCDay(), this.daysOfWeekDisabled) !== -1) {
					clsName += ' disabled';
				}
				html.push('<td class="day'+clsName+'">'+prevMonth.getUTCDate() + '</td>');
				if (prevMonth.getUTCDay() == this.weekEnd) {
					html.push('</tr>');
				}
				prevMonth.setUTCDate(prevMonth.getUTCDate()+1);
			}
			this.picker.find('.datepicker-days tbody').empty().append(html.join(''));
			var currentYear = this.date && this.date.getUTCFullYear();

			var months = this.picker.find('.datepicker-months')
						.find('th:eq(1)')
							.text(year)
							.end()
						.find('span').removeClass('active');
			if (currentYear && currentYear == year) {
				months.eq(this.date.getUTCMonth()).addClass('active');
			}
			if (year < startYear || year > endYear) {
				months.addClass('disabled');
			}
			if (year == startYear) {
				months.slice(0, startMonth).addClass('disabled');
			}
			if (year == endYear) {
				months.slice(endMonth+1).addClass('disabled');
			}

			html = '';
			year = parseInt(year/10, 10) * 10;
			var yearCont = this.picker.find('.datepicker-years')
								.find('th:eq(1)')
									.text(year + '-' + (year + 9))
									.end()
								.find('td');
			year -= 1;
			for (var i = -1; i < 11; i++) {
				html += '<span class="year'+(i == -1 || i == 10 ? ' old' : '')+(currentYear == year ? ' active' : '')+(year < startYear || year > endYear ? ' disabled' : '')+'">'+year+'</span>';
				year += 1;
			}
			yearCont.html(html);
		},

		updateNavArrows: function() {
			if (!this._allow_update) return;

			var d = new Date(this.viewDate),
				year = d.getUTCFullYear(),
				month = d.getUTCMonth();
			switch (this.viewMode) {
				case 0:
					if (this.startDate !== -Infinity && year <= this.startDate.getUTCFullYear() && month <= this.startDate.getUTCMonth()) {
						this.picker.find('.prev').css({visibility: 'hidden'});
					} else {
						this.picker.find('.prev').css({visibility: 'visible'});
					}
					if (this.endDate !== Infinity && year >= this.endDate.getUTCFullYear() && month >= this.endDate.getUTCMonth()) {
						this.picker.find('.next').css({visibility: 'hidden'});
					} else {
						this.picker.find('.next').css({visibility: 'visible'});
					}
					break;
				case 1:
				case 2:
					if (this.startDate !== -Infinity && year <= this.startDate.getUTCFullYear()) {
						this.picker.find('.prev').css({visibility: 'hidden'});
					} else {
						this.picker.find('.prev').css({visibility: 'visible'});
					}
					if (this.endDate !== Infinity && year >= this.endDate.getUTCFullYear()) {
						this.picker.find('.next').css({visibility: 'hidden'});
					} else {
						this.picker.find('.next').css({visibility: 'visible'});
					}
					break;
			}
		},

		click: function(e) {
			e.preventDefault();
			var target = $(e.target).closest('span, td, th');
			if (target.length == 1) {
				switch(target[0].nodeName.toLowerCase()) {
					case 'th':
						switch(target[0].className) {
							case 'switch':
								this.showMode(1);
								break;
							case 'prev':
							case 'next':
								var dir = DPGlobal.modes[this.viewMode].navStep * (target[0].className == 'prev' ? -1 : 1);
								switch(this.viewMode){
									case 0:
										this.viewDate = this.moveMonth(this.viewDate, dir);
										break;
									case 1:
									case 2:
										this.viewDate = this.moveYear(this.viewDate, dir);
										break;
								}
								this.fill();
								break;
							case 'today':
								var date = new Date();
								date = UTCDate(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0);

								this.showMode(-2);
								var which = this.todayBtn == 'linked' ? null : 'view';
								this._setDate(date, which);
								break;
						}
						break;
					case 'span':
						if (!target.is('.disabled')) {
							this.viewDate.setUTCDate(1);
							if (target.is('.month')) {
								var day = 1;
								var month = target.parent().find('span').index(target);
								var year = this.viewDate.getUTCFullYear();
								this.viewDate.setUTCMonth(month);
								this.element.trigger({
									type: 'changeMonth',
									date: this.viewDate
								});
								if ( this.minViewMode == 1 ) {
									this._setDate(UTCDate(year, month, day,0,0,0,0));
								}
							} else {
								var year = parseInt(target.text(), 10)||0;
								var day = 1;
								var month = 0;
								this.viewDate.setUTCFullYear(year);
								this.element.trigger({
									type: 'changeYear',
									date: this.viewDate
								});
								if ( this.minViewMode == 2 ) {
									this._setDate(UTCDate(year, month, day,0,0,0,0));
								}
							}
							this.showMode(-1);
							this.fill();
						}
						break;
					case 'td':
						if (target.is('.day') && !target.is('.disabled')){
							var day = parseInt(target.text(), 10)||1;
							var year = this.viewDate.getUTCFullYear(),
								month = this.viewDate.getUTCMonth();
							if (target.is('.old')) {
								if (month === 0) {
									month = 11;
									year -= 1;
								} else {
									month -= 1;
								}
							} else if (target.is('.new')) {
								if (month == 11) {
									month = 0;
									year += 1;
								} else {
									month += 1;
								}
							}
							this._setDate(UTCDate(year, month, day,0,0,0,0));
						}
						break;
				}
			}
		},

		_setDate: function(date, which){
			if (!which || which == 'date')
				this.date = date;
			if (!which || which  == 'view')
				this.viewDate = date;
			this.fill();
			this.setValue();
			this.element.trigger({
				type: 'changeDate',
				date: this.date
			});
			var element;
			if (this.isInput) {
				element = this.element;
			} else if (this.component){
				element = this.element.find('input');
			}
			if (element) {
				element.change();
				if (this.autoclose && (!which || which == 'date')) {
					this.hide();
				}
			}
		},

		moveMonth: function(date, dir){
			if (!dir) return date;
			var new_date = new Date(date.valueOf()),
				day = new_date.getUTCDate(),
				month = new_date.getUTCMonth(),
				mag = Math.abs(dir),
				new_month, test;
			dir = dir > 0 ? 1 : -1;
			if (mag == 1){
				test = dir == -1
					// If going back one month, make sure month is not current month
					// (eg, Mar 31 -> Feb 31 == Feb 28, not Mar 02)
					? function(){ return new_date.getUTCMonth() == month; }
					// If going forward one month, make sure month is as expected
					// (eg, Jan 31 -> Feb 31 == Feb 28, not Mar 02)
					: function(){ return new_date.getUTCMonth() != new_month; };
				new_month = month + dir;
				new_date.setUTCMonth(new_month);
				// Dec -> Jan (12) or Jan -> Dec (-1) -- limit expected date to 0-11
				if (new_month < 0 || new_month > 11)
					new_month = (new_month + 12) % 12;
			} else {
				// For magnitudes >1, move one month at a time...
				for (var i=0; i<mag; i++)
					// ...which might decrease the day (eg, Jan 31 to Feb 28, etc)...
					new_date = this.moveMonth(new_date, dir);
				// ...then reset the day, keeping it in the new month
				new_month = new_date.getUTCMonth();
				new_date.setUTCDate(day);
				test = function(){ return new_month != new_date.getUTCMonth(); };
			}
			// Common date-resetting loop -- if date is beyond end of month, make it
			// end of month
			while (test()){
				new_date.setUTCDate(--day);
				new_date.setUTCMonth(new_month);
			}
			return new_date;
		},

		moveYear: function(date, dir){
			return this.moveMonth(date, dir*12);
		},

		dateWithinRange: function(date){
			return date >= this.startDate && date <= this.endDate;
		},

		keydown: function(e){
			if (this.picker.is(':not(:visible)')){
				if (e.keyCode == 27) // allow escape to hide and re-show picker
					this.show();
				return;
			}
			var dateChanged = false,
				dir, day, month,
				newDate, newViewDate;
			switch(e.keyCode){
				case 27: // escape
					this.hide();
					e.preventDefault();
					break;
				case 37: // left
				case 39: // right
					if (!this.keyboardNavigation) break;
					dir = e.keyCode == 37 ? -1 : 1;
					if (e.ctrlKey){
						newDate = this.moveYear(this.date, dir);
						newViewDate = this.moveYear(this.viewDate, dir);
					} else if (e.shiftKey){
						newDate = this.moveMonth(this.date, dir);
						newViewDate = this.moveMonth(this.viewDate, dir);
					} else {
						newDate = new Date(this.date);
						newDate.setUTCDate(this.date.getUTCDate() + dir);
						newViewDate = new Date(this.viewDate);
						newViewDate.setUTCDate(this.viewDate.getUTCDate() + dir);
					}
					if (this.dateWithinRange(newDate)){
						this.date = newDate;
						this.viewDate = newViewDate;
						this.setValue();
						this.update();
						e.preventDefault();
						dateChanged = true;
					}
					break;
				case 38: // up
				case 40: // down
					if (!this.keyboardNavigation) break;
					dir = e.keyCode == 38 ? -1 : 1;
					if (e.ctrlKey){
						newDate = this.moveYear(this.date, dir);
						newViewDate = this.moveYear(this.viewDate, dir);
					} else if (e.shiftKey){
						newDate = this.moveMonth(this.date, dir);
						newViewDate = this.moveMonth(this.viewDate, dir);
					} else {
						newDate = new Date(this.date);
						newDate.setUTCDate(this.date.getUTCDate() + dir * 7);
						newViewDate = new Date(this.viewDate);
						newViewDate.setUTCDate(this.viewDate.getUTCDate() + dir * 7);
					}
					if (this.dateWithinRange(newDate)){
						this.date = newDate;
						this.viewDate = newViewDate;
						this.setValue();
						this.update();
						e.preventDefault();
						dateChanged = true;
					}
					break;
				case 13: // enter
					this.hide();
					e.preventDefault();
					break;
				case 9: // tab
					this.hide();
					break;
			}
			if (dateChanged){
				this.element.trigger({
					type: 'changeDate',
					date: this.date
				});
				var element;
				if (this.isInput) {
					element = this.element;
				} else if (this.component){
					element = this.element.find('input');
				}
				if (element) {
					element.change();
				}
			}
		},

		showMode: function(dir) {
			if (dir) {
				this.viewMode = Math.max(this.minViewMode, Math.min(2, this.viewMode + dir));
			}
			/*
				vitalets: fixing bug of very special conditions:
				jquery 1.7.1 + webkit + show inline datepicker in bootstrap popover.
				Method show() does not set display css correctly and datepicker is not shown.
				Changed to .css('display', 'block') solve the problem.
				See https://github.com/vitalets/x-editable/issues/37

				In jquery 1.7.2+ everything works fine.
			*/
			//this.picker.find('>div').hide().filter('.datepicker-'+DPGlobal.modes[this.viewMode].clsName).show();
			this.picker.find('>div').hide().filter('.datepicker-'+DPGlobal.modes[this.viewMode].clsName).css('display', 'block');
			this.updateNavArrows();
		}
	};

	$.fn.datepicker = function ( option ) {
		var args = Array.apply(null, arguments);
		args.shift();
		return this.each(function () {
			var $this = $(this),
				data = $this.data('datepicker'),
				options = typeof option == 'object' && option;
			if (!data) {
				$this.data('datepicker', (data = new Datepicker(this, $.extend({}, $.fn.datepicker.defaults,options))));
			}
			if (typeof option == 'string' && typeof data[option] == 'function') {
				data[option].apply(data, args);
			}
		});
	};

	$.fn.datepicker.defaults = {
	};
	$.fn.datepicker.Constructor = Datepicker;
	var dates = $.fn.datepicker.dates = {
		en: {
			days: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"],
			daysShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
			daysMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa", "Su"],
			months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
			monthsShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
			today: "Today"
		}
	};

	var DPGlobal = {
		modes: [
			{
				clsName: 'days',
				navFnc: 'Month',
				navStep: 1
			},
			{
				clsName: 'months',
				navFnc: 'FullYear',
				navStep: 1
			},
			{
				clsName: 'years',
				navFnc: 'FullYear',
				navStep: 10
		}],
		isLeapYear: function (year) {
			return (((year % 4 === 0) && (year % 100 !== 0)) || (year % 400 === 0));
		},
		getDaysInMonth: function (year, month) {
			return [31, (DPGlobal.isLeapYear(year) ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month];
		},
		validParts: /dd?|DD?|mm?|MM?|yy(?:yy)?/g,
		nonpunctuation: /[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,
		parseFormat: function(format){
			// IE treats \0 as a string end in inputs (truncating the value),
			// so it's a bad format delimiter, anyway
			var separators = format.replace(this.validParts, '\0').split('\0'),
				parts = format.match(this.validParts);
			if (!separators || !separators.length || !parts || parts.length === 0){
				throw new Error("Invalid date format.");
			}
			return {separators: separators, parts: parts};
		},
		parseDate: function(date, format, language) {
			if (date instanceof Date) return date;
			if (/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(date)) {
				var part_re = /([\-+]\d+)([dmwy])/,
					parts = date.match(/([\-+]\d+)([dmwy])/g),
					part, dir;
				date = new Date();
				for (var i=0; i<parts.length; i++) {
					part = part_re.exec(parts[i]);
					dir = parseInt(part[1]);
					switch(part[2]){
						case 'd':
							date.setUTCDate(date.getUTCDate() + dir);
							break;
						case 'm':
							date = Datepicker.prototype.moveMonth.call(Datepicker.prototype, date, dir);
							break;
						case 'w':
							date.setUTCDate(date.getUTCDate() + dir * 7);
							break;
						case 'y':
							date = Datepicker.prototype.moveYear.call(Datepicker.prototype, date, dir);
							break;
					}
				}
				return UTCDate(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), 0, 0, 0);
			}
			var parts = date && date.match(this.nonpunctuation) || [],
				date = new Date(),
				parsed = {},
				setters_order = ['yyyy', 'yy', 'M', 'MM', 'm', 'mm', 'd', 'dd'],
				setters_map = {
					yyyy: function(d,v){ return d.setUTCFullYear(v); },
					yy: function(d,v){ return d.setUTCFullYear(2000+v); },
					m: function(d,v){
						v -= 1;
						while (v<0) v += 12;
						v %= 12;
						d.setUTCMonth(v);
						while (d.getUTCMonth() != v)
							d.setUTCDate(d.getUTCDate()-1);
						return d;
					},
					d: function(d,v){ return d.setUTCDate(v); }
				},
				val, filtered, part;
			setters_map['M'] = setters_map['MM'] = setters_map['mm'] = setters_map['m'];
			setters_map['dd'] = setters_map['d'];
			date = UTCDate(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0);
			var fparts = format.parts.slice();
			// Remove noop parts
			if (parts.length != fparts.length) {
				fparts = $(fparts).filter(function(i,p){
					return $.inArray(p, setters_order) !== -1;
				}).toArray();
			}
			// Process remainder
			if (parts.length == fparts.length) {
				for (var i=0, cnt = fparts.length; i < cnt; i++) {
					val = parseInt(parts[i], 10);
					part = fparts[i];
					if (isNaN(val)) {
						switch(part) {
							case 'MM':
								filtered = $(dates[language].months).filter(function(){
									var m = this.slice(0, parts[i].length),
										p = parts[i].slice(0, m.length);
									return m == p;
								});
								val = $.inArray(filtered[0], dates[language].months) + 1;
								break;
							case 'M':
								filtered = $(dates[language].monthsShort).filter(function(){
									var m = this.slice(0, parts[i].length),
										p = parts[i].slice(0, m.length);
									return m == p;
								});
								val = $.inArray(filtered[0], dates[language].monthsShort) + 1;
								break;
						}
					}
					parsed[part] = val;
				}
				for (var i=0, s; i<setters_order.length; i++){
					s = setters_order[i];
					if (s in parsed && !isNaN(parsed[s]))
						setters_map[s](date, parsed[s]);
				}
			}
			return date;
		},
		formatDate: function(date, format, language){
			var val = {
				d: date.getUTCDate(),
				D: dates[language].daysShort[date.getUTCDay()],
				DD: dates[language].days[date.getUTCDay()],
				m: date.getUTCMonth() + 1,
				M: dates[language].monthsShort[date.getUTCMonth()],
				MM: dates[language].months[date.getUTCMonth()],
				yy: date.getUTCFullYear().toString().substring(2),
				yyyy: date.getUTCFullYear()
			};
			val.dd = (val.d < 10 ? '0' : '') + val.d;
			val.mm = (val.m < 10 ? '0' : '') + val.m;
			var date = [],
				seps = $.extend([], format.separators);
			for (var i=0, cnt = format.parts.length; i < cnt; i++) {
				if (seps.length)
					date.push(seps.shift());
				date.push(val[format.parts[i]]);
			}
			return date.join('');
		},
		headTemplate: '<thead>'+
							'<tr>'+
								'<th class="prev"><i class="icon-arrow-left"/></th>'+
								'<th colspan="5" class="switch"></th>'+
								'<th class="next"><i class="icon-arrow-right"/></th>'+
							'</tr>'+
						'</thead>',
		contTemplate: '<tbody><tr><td colspan="7"></td></tr></tbody>',
		footTemplate: '<tfoot><tr><th colspan="7" class="today"></th></tr></tfoot>'
	};
	DPGlobal.template = '<div class="datepicker">'+
							'<div class="datepicker-days">'+
								'<table class=" table-condensed">'+
									DPGlobal.headTemplate+
									'<tbody></tbody>'+
									DPGlobal.footTemplate+
								'</table>'+
							'</div>'+
							'<div class="datepicker-months">'+
								'<table class="table-condensed">'+
									DPGlobal.headTemplate+
									DPGlobal.contTemplate+
									DPGlobal.footTemplate+
								'</table>'+
							'</div>'+
							'<div class="datepicker-years">'+
								'<table class="table-condensed">'+
									DPGlobal.headTemplate+
									DPGlobal.contTemplate+
									DPGlobal.footTemplate+
								'</table>'+
							'</div>'+
						'</div>';

	$.fn.datepicker.DPGlobal = DPGlobal;

}( window.jQuery );

/**
The MIT License (MIT)

Copyright (c) 2013 Michal Zielenkiewicz

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
'use strict';

angular.module('colorpicker.module', [])
    .factory('Helper', function () {
      return {
        closestSlider: function (elem) {
          var matchesSelector = elem.matches || elem.webkitMatchesSelector || elem.mozMatchesSelector || elem.msMatchesSelector;
          if (matchesSelector.bind(elem)('I')) {
            return elem.parentNode;
          }
          return elem;
        },
        getOffset: function (elem, fixedPosition) {
          var
              x = 0,
              y = 0,
              scrollX = 0,
              scrollY = 0;
          while (elem && !isNaN(elem.offsetLeft) && !isNaN(elem.offsetTop)) {
            x += elem.offsetLeft;
            y += elem.offsetTop;
            if (!fixedPosition && elem.tagName === 'BODY') {
              scrollX += document.documentElement.scrollLeft || elem.scrollLeft;
              scrollY += document.documentElement.scrollTop || elem.scrollTop;
            } else {
              scrollX += elem.scrollLeft;
              scrollY += elem.scrollTop;
            }
            elem = elem.offsetParent;
          }
          return {
            top: y,
            left: x,
            scrollX: scrollX,
            scrollY: scrollY
          };
        },
        // a set of RE's that can match strings and generate color tuples. https://github.com/jquery/jquery-color/
        stringParsers: [
          {
            re: /rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,
            parse: function (execResult) {
              return [
                execResult[1],
                execResult[2],
                execResult[3],
                execResult[4]
              ];
            }
          },
          {
            re: /rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,
            parse: function (execResult) {
              return [
                2.55 * execResult[1],
                2.55 * execResult[2],
                2.55 * execResult[3],
                execResult[4]
              ];
            }
          },
          {
            re: /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,
            parse: function (execResult) {
              return [
                parseInt(execResult[1], 16),
                parseInt(execResult[2], 16),
                parseInt(execResult[3], 16)
              ];
            }
          },
          {
            re: /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,
            parse: function (execResult) {
              return [
                parseInt(execResult[1] + execResult[1], 16),
                parseInt(execResult[2] + execResult[2], 16),
                parseInt(execResult[3] + execResult[3], 16)
              ];
            }
          }
        ]
      };
    })
    .factory('Color', ['Helper', function (Helper) {
      return {
        value: {
          h: 1,
          s: 1,
          b: 1,
          a: 1
        },
        // translate a format from Color object to a string
        'rgb': function () {
          var rgb = this.toRGB();
          return 'rgb(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ')';
        },
        'rgba': function () {
          var rgb = this.toRGB();
          return 'rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ',' + rgb.a + ')';
        },
        'hex': function () {
          return  this.toHex();
        },

        // HSBtoRGB from RaphaelJS
        RGBtoHSB: function (r, g, b, a) {
          r /= 255;
          g /= 255;
          b /= 255;

          var H, S, V, C;
          V = Math.max(r, g, b);
          C = V - Math.min(r, g, b);
          H = (C === 0 ? null :
              V === r ? (g - b) / C :
                  V === g ? (b - r) / C + 2 :
                      (r - g) / C + 4
              );
          H = ((H + 360) % 6) * 60 / 360;
          S = C === 0 ? 0 : C / V;
          return {h: H || 1, s: S, b: V, a: a || 1};
        },

        //parse a string to HSB
        setColor: function (val) {
          val = val.toLowerCase();
          for (var key in Helper.stringParsers) {
            if (Helper.stringParsers.hasOwnProperty(key)) {
              var parser = Helper.stringParsers[key];
              var match = parser.re.exec(val),
                  values = match && parser.parse(match);
              if (values) {
                this.value = this.RGBtoHSB.apply(null, values);
                return false;
              }
            }
          }
        },

        setHue: function (h) {
          this.value.h = 1 - h;
        },

        setSaturation: function (s) {
          this.value.s = s;
        },

        setLightness: function (b) {
          this.value.b = 1 - b;
        },

        setAlpha: function (a) {
          this.value.a = parseInt((1 - a) * 100, 10) / 100;
        },

        // HSBtoRGB from RaphaelJS
        // https://github.com/DmitryBaranovskiy/raphael/
        toRGB: function (h, s, b, a) {
          if (!h) {
            h = this.value.h;
            s = this.value.s;
            b = this.value.b;
          }
          h *= 360;
          var R, G, B, X, C;
          h = (h % 360) / 60;
          C = b * s;
          X = C * (1 - Math.abs(h % 2 - 1));
          R = G = B = b - C;

          h = ~~h;
          R += [C, X, 0, 0, X, C][h];
          G += [X, C, C, X, 0, 0][h];
          B += [0, 0, X, C, C, X][h];
          return {
            r: Math.round(R * 255),
            g: Math.round(G * 255),
            b: Math.round(B * 255),
            a: a || this.value.a
          };
        },

        toHex: function (h, s, b, a) {
          var rgb = this.toRGB(h, s, b, a);
          return '#' + ((1 << 24) | (parseInt(rgb.r, 10) << 16) | (parseInt(rgb.g, 10) << 8) | parseInt(rgb.b, 10)).toString(16).substr(1);
        }
      };
    }])
    .factory('Slider', ['Helper', function (Helper) {
      var
          slider = {
            maxLeft: 0,
            maxTop: 0,
            callLeft: null,
            callTop: null,
            knob: {
              top: 0,
              left: 0
            }
          },
          pointer = {};

      return {
        getSlider: function() {
          return slider;
        },
        getLeftPosition: function(event) {
          return Math.max(0, Math.min(slider.maxLeft, slider.left + ((event.pageX || pointer.left) - pointer.left)));
        },
        getTopPosition: function(event) {
          return Math.max(0, Math.min(slider.maxTop, slider.top + ((event.pageY || pointer.top) - pointer.top)));
        },
        setSlider: function (event, fixedPosition) {
          var
            target = Helper.closestSlider(event.target),
            targetOffset = Helper.getOffset(target, fixedPosition);
          slider.knob = target.children[0].style;
          slider.left = event.pageX - targetOffset.left - window.pageXOffset + targetOffset.scrollX;
          slider.top = event.pageY - targetOffset.top - window.pageYOffset + targetOffset.scrollY;

          pointer = {
            left: event.pageX,
            top: event.pageY
          };
        },
        setSaturation: function(event, fixedPosition) {
          slider = {
            maxLeft: 100,
            maxTop: 100,
            callLeft: 'setSaturation',
            callTop: 'setLightness'
          };
          this.setSlider(event, fixedPosition);
        },
        setHue: function(event, fixedPosition) {
          slider = {
            maxLeft: 0,
            maxTop: 100,
            callLeft: false,
            callTop: 'setHue'
          };
          this.setSlider(event, fixedPosition);
        },
        setAlpha: function(event, fixedPosition) {
          slider = {
            maxLeft: 0,
            maxTop: 100,
            callLeft: false,
            callTop: 'setAlpha'
          };
          this.setSlider(event, fixedPosition);
        },
        setKnob: function(top, left) {
          slider.knob.top = top + 'px';
          slider.knob.left = left + 'px';
        }
      };
    }])
    .directive('colorpicker', ['$document', '$compile', 'Color', 'Slider', 'Helper', function ($document, $compile, Color, Slider, Helper) {
      return {
        require: '?ngModel',
        restrict: 'A',
        link: function ($scope, elem, attrs, ngModel) {
          var
              thisFormat = attrs.colorpicker ? attrs.colorpicker : 'hex',
              position = angular.isDefined(attrs.colorpickerPosition) ? attrs.colorpickerPosition : 'bottom',
              fixedPosition = angular.isDefined(attrs.colorpickerFixedPosition) ? attrs.colorpickerFixedPosition : false,
              target = angular.isDefined(attrs.colorpickerParent) ? elem.parent() : angular.element(document.body),
              withInput = angular.isDefined(attrs.colorpickerWithInput) ? attrs.colorpickerWithInput : false,
              inputTemplate = withInput ? '<input type="text" name="colorpicker-input">' : '',
              template =
                  '<div class="colorpicker dropdown">' +
                      '<div class="dropdown-menu">' +
                      '<colorpicker-saturation><i></i></colorpicker-saturation>' +
                      '<colorpicker-hue><i></i></colorpicker-hue>' +
                      '<colorpicker-alpha><i></i></colorpicker-alpha>' +
                      '<colorpicker-preview></colorpicker-preview>' +
                      inputTemplate +
                      '<button class="close close-colorpicker">&times;</button>' +
                      '</div>' +
                      '</div>',
              colorpickerTemplate = angular.element(template),
              pickerColor = Color,
              sliderAlpha,
              sliderHue = colorpickerTemplate.find('colorpicker-hue'),
              sliderSaturation = colorpickerTemplate.find('colorpicker-saturation'),
              colorpickerPreview = colorpickerTemplate.find('colorpicker-preview'),
              pickerColorPointers = colorpickerTemplate.find('i');

          $compile(colorpickerTemplate)($scope);

          if (withInput) {
            var pickerColorInput = colorpickerTemplate.find('input');
            pickerColorInput
                .on('mousedown', function(event) {
                  event.stopPropagation();
                })
                .on('keyup', function(event) {
                  var newColor = this.value;
                  elem.val(newColor);
                  if(ngModel) {
                    $scope.$apply(ngModel.$setViewValue(newColor));
                  }
                  event.stopPropagation();
                  event.preventDefault();
                });
            elem.on('keyup', function() {
              pickerColorInput.val(elem.val());
            });
          }

          var bindMouseEvents = function() {
            $document.on('mousemove', mousemove);
            $document.on('mouseup', mouseup);
          };

          if (thisFormat === 'rgba') {
            colorpickerTemplate.addClass('alpha');
            sliderAlpha = colorpickerTemplate.find('colorpicker-alpha');
            sliderAlpha
                .on('click', function(event) {
                  Slider.setAlpha(event, fixedPosition);
                  mousemove(event);
                })
                .on('mousedown', function(event) {
                  Slider.setAlpha(event, fixedPosition);
                  bindMouseEvents();
                });
          }

          sliderHue
              .on('click', function(event) {
                Slider.setHue(event, fixedPosition);
                mousemove(event);
              })
              .on('mousedown', function(event) {
                Slider.setHue(event, fixedPosition);
                bindMouseEvents();
              });

          sliderSaturation
              .on('click', function(event) {
                Slider.setSaturation(event, fixedPosition);
                mousemove(event);
              })
              .on('mousedown', function(event) {
                Slider.setSaturation(event, fixedPosition);
                bindMouseEvents();
              });

          if (fixedPosition) {
            colorpickerTemplate.addClass('colorpicker-fixed-position');
          }

          colorpickerTemplate.addClass('colorpicker-position-' + position);

          target.append(colorpickerTemplate);

          if(ngModel) {
            ngModel.$render = function () {
              elem.val(ngModel.$viewValue);
            };
            $scope.$watch(attrs.ngModel, function() {
              update();
            });
          }

          elem.on('$destroy', function() {
            colorpickerTemplate.remove();
          });

          var previewColor = function () {
            try {
              colorpickerPreview.css('backgroundColor', pickerColor[thisFormat]());
            } catch (e) {
              colorpickerPreview.css('backgroundColor', pickerColor.toHex());
            }
            sliderSaturation.css('backgroundColor', pickerColor.toHex(pickerColor.value.h, 1, 1, 1));
            if (thisFormat === 'rgba') {
              sliderAlpha.css.backgroundColor = pickerColor.toHex();
            }
          };

          var mousemove = function (event) {
            var
                left = Slider.getLeftPosition(event),
                top = Slider.getTopPosition(event),
                slider = Slider.getSlider();

            Slider.setKnob(top, left);

            if (slider.callLeft) {
              pickerColor[slider.callLeft].call(pickerColor, left / 100);
            }
            if (slider.callTop) {
              pickerColor[slider.callTop].call(pickerColor, top / 100);
            }
            previewColor();
            var newColor = pickerColor[thisFormat]();
            elem.val(newColor);
            if(ngModel) {
              $scope.$apply(ngModel.$setViewValue(newColor));
            }
            if (withInput) {
              pickerColorInput.val(newColor);
            }
            return false;
          };

          var mouseup = function () {
            $document.off('mousemove', mousemove);
            $document.off('mouseup', mouseup);
          };

          var update = function () {
            pickerColor.setColor(elem.val());
            pickerColorPointers.eq(0).css({
              left: pickerColor.value.s * 100 + 'px',
              top: 100 - pickerColor.value.b * 100 + 'px'
            });
            pickerColorPointers.eq(1).css('top', 100 * (1 - pickerColor.value.h) + 'px');
            pickerColorPointers.eq(2).css('top', 100 * (1 - pickerColor.value.a) + 'px');
            previewColor();
          };

          var getColorpickerTemplatePosition = function() {
            var
                positionValue,
                positionOffset = Helper.getOffset(elem[0]);

            if(angular.isDefined(attrs.colorpickerParent)) {
              positionOffset.left = 0;
              positionOffset.top = 0;
            }

            if (position === 'top') {
              positionValue =  {
                'top': positionOffset.top - 147,
                'left': positionOffset.left
              };
            } else if (position === 'right') {
              positionValue = {
                'top': positionOffset.top,
                'left': positionOffset.left + 126
              };
            } else if (position === 'bottom') {
              positionValue = {
                'top': positionOffset.top + elem[0].offsetHeight + 2,
                'left': positionOffset.left
              };
            } else if (position === 'left') {
              positionValue = {
                'top': positionOffset.top,
                'left': positionOffset.left - 150
              };
            }
            return {
              'top': positionValue.top + 'px',
              'left': positionValue.left + 'px'
            };
          };

          var documentMousedownHandler = function() {
            hideColorpickerTemplate();
          };

          elem.on('click', function () {
            update();
            colorpickerTemplate
                .addClass('colorpicker-visible')
                .css(getColorpickerTemplatePosition());

            // register global mousedown event to hide the colorpicker
            $document.on('mousedown', documentMousedownHandler);
          });

          colorpickerTemplate.on('mousedown', function (event) {
            event.stopPropagation();
            event.preventDefault();
          });

          var emitEvent = function(name) {
            if(ngModel) {
              $scope.$emit(name, {
                name: attrs.ngModel,
                value: ngModel.$modelValue
              });
            }
          };

          var hideColorpickerTemplate = function() {
            if (colorpickerTemplate.hasClass('colorpicker-visible')) {
              colorpickerTemplate.removeClass('colorpicker-visible');
              emitEvent('colorpicker-closed');
              // unregister the global mousedown event
              $document.off('mousedown', documentMousedownHandler);
            }
          };

          colorpickerTemplate.find('button').on('click', function () {
            hideColorpickerTemplate();
          });
        }
      };
    }]);
/*!
 * Timepicker Component for Twitter Bootstrap
 *
 * Copyright 2013 Joris de Wit
 *
 * Contributors https://github.com/jdewit/bootstrap-timepicker/graphs/contributors
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */
(function($, window, document, undefined) {
  'use strict';

  // TIMEPICKER PUBLIC CLASS DEFINITION
  var Timepicker = function(element, options) {
    this.widget = '';
    this.$element = $(element);
    this.defaultTime = options.defaultTime;
    this.disableFocus = options.disableFocus;
    this.isOpen = options.isOpen;
    this.minuteStep = options.minuteStep;
    this.modalBackdrop = options.modalBackdrop;
    this.secondStep = options.secondStep;
    this.showInputs = options.showInputs;
    this.showMeridian = options.showMeridian;
    this.showSeconds = options.showSeconds;
    this.template = options.template;
    this.appendWidgetTo = options.appendWidgetTo;

    this._init();
  };

  Timepicker.prototype = {

    constructor: Timepicker,

    _init: function() {
      var self = this;

      if (this.$element.parent().hasClass('input-append') || this.$element.parent().hasClass('input-prepend')) {
        this.$element.parent('.input-append, .input-prepend').find('.add-on').on({
          'click.timepicker': $.proxy(this.showWidget, this)
        });
        this.$element.on({
          'focus.timepicker': $.proxy(this.highlightUnit, this),
          'click.timepicker': $.proxy(this.highlightUnit, this),
          'keydown.timepicker': $.proxy(this.elementKeydown, this),
          'blur.timepicker': $.proxy(this.blurElement, this)
        });
      } else {
        if (this.template) {
          this.$element.on({
            'focus.timepicker': $.proxy(this.showWidget, this),
            'click.timepicker': $.proxy(this.showWidget, this),
            'blur.timepicker': $.proxy(this.blurElement, this)
          });
        } else {
          this.$element.on({
            'focus.timepicker': $.proxy(this.highlightUnit, this),
            'click.timepicker': $.proxy(this.highlightUnit, this),
            'keydown.timepicker': $.proxy(this.elementKeydown, this),
            'blur.timepicker': $.proxy(this.blurElement, this)
          });
        }
      }

      if (this.template !== false) {
        this.$widget = $(this.getTemplate()).prependTo(this.$element.parents(this.appendWidgetTo)).on('click', $.proxy(this.widgetClick, this));
      } else {
        this.$widget = false;
      }

      if (this.showInputs && this.$widget !== false) {
        this.$widget.find('input').each(function() {
          $(this).on({
            'click.timepicker': function() { $(this).select(); },
            'keydown.timepicker': $.proxy(self.widgetKeydown, self)
          });
        });
      }

      this.setDefaultTime(this.defaultTime);
    },

    blurElement: function() {
      this.highlightedUnit = undefined;
      this.updateFromElementVal();
    },

    decrementHour: function() {
      if (this.showMeridian) {
        if (this.hour === 1) {
          this.hour = 12;
        } else if (this.hour === 12) {
          this.hour--;

          return this.toggleMeridian();
        } else if (this.hour === 0) {
          this.hour = 11;

          return this.toggleMeridian();
        } else {
          this.hour--;
        }
      } else {
        if (this.hour === 0) {
          this.hour = 23;
        } else {
          this.hour--;
        }
      }
      this.update();
    },

    decrementMinute: function(step) {
      var newVal;

      if (step) {
        newVal = this.minute - step;
      } else {
        newVal = this.minute - this.minuteStep;
      }

      if (newVal < 0) {
        this.decrementHour();
        this.minute = newVal + 60;
      } else {
        this.minute = newVal;
      }
      this.update();
    },

    decrementSecond: function() {
      var newVal = this.second - this.secondStep;

      if (newVal < 0) {
        this.decrementMinute(true);
        this.second = newVal + 60;
      } else {
        this.second = newVal;
      }
      this.update();
    },

    elementKeydown: function(e) {
      switch (e.keyCode) {
      case 9: //tab
        this.updateFromElementVal();

        switch (this.highlightedUnit) {
        case 'hour':
          e.preventDefault();
          this.highlightNextUnit();
          break;
        case 'minute':
          if (this.showMeridian || this.showSeconds) {
            e.preventDefault();
            this.highlightNextUnit();
          }
          break;
        case 'second':
          if (this.showMeridian) {
            e.preventDefault();
            this.highlightNextUnit();
          }
          break;
        }
        break;
      case 27: // escape
        this.updateFromElementVal();
        break;
      case 37: // left arrow
        e.preventDefault();
        this.highlightPrevUnit();
        this.updateFromElementVal();
        break;
      case 38: // up arrow
        e.preventDefault();
        switch (this.highlightedUnit) {
        case 'hour':
          this.incrementHour();
          this.highlightHour();
          break;
        case 'minute':
          this.incrementMinute();
          this.highlightMinute();
          break;
        case 'second':
          this.incrementSecond();
          this.highlightSecond();
          break;
        case 'meridian':
          this.toggleMeridian();
          this.highlightMeridian();
          break;
        }
        break;
      case 39: // right arrow
        e.preventDefault();
        this.updateFromElementVal();
        this.highlightNextUnit();
        break;
      case 40: // down arrow
        e.preventDefault();
        switch (this.highlightedUnit) {
        case 'hour':
          this.decrementHour();
          this.highlightHour();
          break;
        case 'minute':
          this.decrementMinute();
          this.highlightMinute();
          break;
        case 'second':
          this.decrementSecond();
          this.highlightSecond();
          break;
        case 'meridian':
          this.toggleMeridian();
          this.highlightMeridian();
          break;
        }
        break;
      }
    },

    formatTime: function(hour, minute, second, meridian) {
      hour = hour < 10 ? '0' + hour : hour;
      minute = minute < 10 ? '0' + minute : minute;
      second = second < 10 ? '0' + second : second;

      return hour + ':' + minute + (this.showSeconds ? ':' + second : '') + (this.showMeridian ? ' ' + meridian : '');
    },

    getCursorPosition: function() {
      var input = this.$element.get(0);

      if ('selectionStart' in input) {// Standard-compliant browsers

        return input.selectionStart;
      } else if (document.selection) {// IE fix
        input.focus();
        var sel = document.selection.createRange(),
          selLen = document.selection.createRange().text.length;

        sel.moveStart('character', - input.value.length);

        return sel.text.length - selLen;
      }
    },

    getTemplate: function() {
      var template,
        hourTemplate,
        minuteTemplate,
        secondTemplate,
        meridianTemplate,
        templateContent;

      if (this.showInputs) {
        hourTemplate = '<input type="text" name="hour" class="bootstrap-timepicker-hour" maxlength="2"/>';
        minuteTemplate = '<input type="text" name="minute" class="bootstrap-timepicker-minute" maxlength="2"/>';
        secondTemplate = '<input type="text" name="second" class="bootstrap-timepicker-second" maxlength="2"/>';
        meridianTemplate = '<input type="text" name="meridian" class="bootstrap-timepicker-meridian" maxlength="2"/>';
      } else {
        hourTemplate = '<span class="bootstrap-timepicker-hour"></span>';
        minuteTemplate = '<span class="bootstrap-timepicker-minute"></span>';
        secondTemplate = '<span class="bootstrap-timepicker-second"></span>';
        meridianTemplate = '<span class="bootstrap-timepicker-meridian"></span>';
      }

      templateContent = '<table>'+
         '<tr>'+
           '<td><a href="#" data-action="incrementHour"><i class="icon-chevron-up"></i></a></td>'+
           '<td class="separator">&nbsp;</td>'+
           '<td><a href="#" data-action="incrementMinute"><i class="icon-chevron-up"></i></a></td>'+
           (this.showSeconds ?
             '<td class="separator">&nbsp;</td>'+
             '<td><a href="#" data-action="incrementSecond"><i class="icon-chevron-up"></i></a></td>'
           : '') +
           (this.showMeridian ?
             '<td class="separator">&nbsp;</td>'+
             '<td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="icon-chevron-up"></i></a></td>'
           : '') +
         '</tr>'+
         '<tr>'+
           '<td>'+ hourTemplate +'</td> '+
           '<td class="separator">:</td>'+
           '<td>'+ minuteTemplate +'</td> '+
           (this.showSeconds ?
            '<td class="separator">:</td>'+
            '<td>'+ secondTemplate +'</td>'
           : '') +
           (this.showMeridian ?
            '<td class="separator">&nbsp;</td>'+
            '<td>'+ meridianTemplate +'</td>'
           : '') +
         '</tr>'+
         '<tr>'+
           '<td><a href="#" data-action="decrementHour"><i class="icon-chevron-down"></i></a></td>'+
           '<td class="separator"></td>'+
           '<td><a href="#" data-action="decrementMinute"><i class="icon-chevron-down"></i></a></td>'+
           (this.showSeconds ?
            '<td class="separator">&nbsp;</td>'+
            '<td><a href="#" data-action="decrementSecond"><i class="icon-chevron-down"></i></a></td>'
           : '') +
           (this.showMeridian ?
            '<td class="separator">&nbsp;</td>'+
            '<td><a href="#" data-action="toggleMeridian"><i class="icon-chevron-down"></i></a></td>'
           : '') +
         '</tr>'+
       '</table>';

      switch(this.template) {
      case 'modal':
        template = '<div class="bootstrap-timepicker-widget modal hide fade in" data-backdrop="'+ (this.modalBackdrop ? 'true' : 'false') +'">'+
          '<div class="modal-header">'+
            '<a href="#" class="close" data-dismiss="modal">×</a>'+
            '<h3>Pick a Time</h3>'+
          '</div>'+
          '<div class="modal-content">'+
            templateContent +
          '</div>'+
          '<div class="modal-footer">'+
            '<a href="#" class="btn btn-primary" data-dismiss="modal">OK</a>'+
          '</div>'+
        '</div>';
        break;
      case 'dropdown':
        template = '<div class="bootstrap-timepicker-widget dropdown-menu">'+ templateContent +'</div>';
        break;
      }

      return template;
    },

    getTime: function() {
      return this.formatTime(this.hour, this.minute, this.second, this.meridian);
    },

    hideWidget: function() {
      if (this.isOpen === false) {
        return;
      }

      if (this.showInputs) {
        this.updateFromWidgetInputs();
      }

      this.$element.trigger({
        'type': 'hide.timepicker',
        'time': {
          'value': this.getTime(),
          'hours': this.hour,
          'minutes': this.minute,
          'seconds': this.second,
          'meridian': this.meridian
        }
      });

      if (this.template === 'modal') {
        this.$widget.modal('hide');
      } else {
        this.$widget.removeClass('open');
      }

      $(document).off('mousedown.timepicker');

      this.isOpen = false;
    },

    highlightUnit: function() {
      this.position = this.getCursorPosition();
      if (this.position >= 0 && this.position <= 2) {
        this.highlightHour();
      } else if (this.position >= 3 && this.position <= 5) {
        this.highlightMinute();
      } else if (this.position >= 6 && this.position <= 8) {
        if (this.showSeconds) {
          this.highlightSecond();
        } else {
          this.highlightMeridian();
        }
      } else if (this.position >= 9 && this.position <= 11) {
        this.highlightMeridian();
      }
    },

    highlightNextUnit: function() {
      switch (this.highlightedUnit) {
      case 'hour':
        this.highlightMinute();
        break;
      case 'minute':
        if (this.showSeconds) {
          this.highlightSecond();
        } else if (this.showMeridian){
          this.highlightMeridian();
        } else {
          this.highlightHour();
        }
        break;
      case 'second':
        if (this.showMeridian) {
          this.highlightMeridian();
        } else {
          this.highlightHour();
        }
        break;
      case 'meridian':
        this.highlightHour();
        break;
      }
    },

    highlightPrevUnit: function() {
      switch (this.highlightedUnit) {
      case 'hour':
        this.highlightMeridian();
        break;
      case 'minute':
        this.highlightHour();
        break;
      case 'second':
        this.highlightMinute();
        break;
      case 'meridian':
        if (this.showSeconds) {
          this.highlightSecond();
        } else {
          this.highlightMinute();
        }
        break;
      }
    },

    highlightHour: function() {
      var $element = this.$element.get(0);

      this.highlightedUnit = 'hour';

      if ($element.setSelectionRange) {
        setTimeout(function() {
          $element.setSelectionRange(0,2);
        }, 0);
      }
    },

    highlightMinute: function() {
      var $element = this.$element.get(0);

      this.highlightedUnit = 'minute';

      if ($element.setSelectionRange) {
        setTimeout(function() {
          $element.setSelectionRange(3,5);
        }, 0);
      }
    },

    highlightSecond: function() {
      var $element = this.$element.get(0);

      this.highlightedUnit = 'second';

      if ($element.setSelectionRange) {
        setTimeout(function() {
          $element.setSelectionRange(6,8);
        }, 0);
      }
    },

    highlightMeridian: function() {
      var $element = this.$element.get(0);

      this.highlightedUnit = 'meridian';

      if ($element.setSelectionRange) {
        if (this.showSeconds) {
          setTimeout(function() {
            $element.setSelectionRange(9,11);
          }, 0);
        } else {
          setTimeout(function() {
            $element.setSelectionRange(6,8);
          }, 0);
        }
      }
    },

    incrementHour: function() {
      if (this.showMeridian) {
        if (this.hour === 11) {
          this.hour++;
          return this.toggleMeridian();
        } else if (this.hour === 12) {
          this.hour = 0;
        }
      }
      if (this.hour === 23) {
        this.hour = 0;

        return;
      }
      this.hour++;
      this.update();
    },

    incrementMinute: function(step) {
      var newVal;

      if (step) {
        newVal = this.minute + step;
      } else {
        newVal = this.minute + this.minuteStep - (this.minute % this.minuteStep);
      }

      if (newVal > 59) {
        this.incrementHour();
        this.minute = newVal - 60;
      } else {
        this.minute = newVal;
      }
      this.update();
    },

    incrementSecond: function() {
      var newVal = this.second + this.secondStep - (this.second % this.secondStep);

      if (newVal > 59) {
        this.incrementMinute(true);
        this.second = newVal - 60;
      } else {
        this.second = newVal;
      }
      this.update();
    },

    remove: function() {
      $('document').off('.timepicker');
      if (this.$widget) {
        this.$widget.remove();
      }
      delete this.$element.data().timepicker;
    },

    setDefaultTime: function(defaultTime){
      if (!this.$element.val()) {
        if (defaultTime === 'current') {
          var dTime = new Date(),
            hours = dTime.getHours(),
            minutes = Math.floor(dTime.getMinutes() / this.minuteStep) * this.minuteStep,
            seconds = Math.floor(dTime.getSeconds() / this.secondStep) * this.secondStep,
            meridian = 'AM';

          if (this.showMeridian) {
            if (hours === 0) {
              hours = 12;
            } else if (hours >= 12) {
              if (hours > 12) {
                hours = hours - 12;
              }
              meridian = 'PM';
            } else {
              meridian = 'AM';
            }
          }

          this.hour = hours;
          this.minute = minutes;
          this.second = seconds;
          this.meridian = meridian;

          this.update();

        } else if (defaultTime === false) {
          this.hour = 0;
          this.minute = 0;
          this.second = 0;
          this.meridian = 'AM';
        } else {
          this.setTime(defaultTime);
        }
      } else {
        this.updateFromElementVal();
      }
    },

    setTime: function(time) {
      var arr,
        timeArray;

      if (this.showMeridian) {
        arr = time.split(' ');
        timeArray = arr[0].split(':');
        this.meridian = arr[1];
      } else {
        timeArray = time.split(':');
      }

      this.hour = parseInt(timeArray[0], 10);
      this.minute = parseInt(timeArray[1], 10);
      this.second = parseInt(timeArray[2], 10);

      if (isNaN(this.hour)) {
        this.hour = 0;
      }
      if (isNaN(this.minute)) {
        this.minute = 0;
      }

      if (this.showMeridian) {
        if (this.hour > 12) {
          this.hour = 12;
        } else if (this.hour < 1) {
          this.hour = 12;
        }

        if (this.meridian === 'am' || this.meridian === 'a') {
          this.meridian = 'AM';
        } else if (this.meridian === 'pm' || this.meridian === 'p') {
          this.meridian = 'PM';
        }

        if (this.meridian !== 'AM' && this.meridian !== 'PM') {
          this.meridian = 'AM';
        }
      } else {
        if (this.hour >= 24) {
          this.hour = 23;
        } else if (this.hour < 0) {
          this.hour = 0;
        }
      }

      if (this.minute < 0) {
        this.minute = 0;
      } else if (this.minute >= 60) {
        this.minute = 59;
      }

      if (this.showSeconds) {
        if (isNaN(this.second)) {
          this.second = 0;
        } else if (this.second < 0) {
          this.second = 0;
        } else if (this.second >= 60) {
          this.second = 59;
        }
      }

      this.update();
    },

    showWidget: function() {
      if (this.isOpen) {
        return;
      }

      if (this.$element.is(':disabled')) {
        return;
      }

      var self = this;
      $(document).on('mousedown.timepicker', function (e) {
        // Clicked outside the timepicker, hide it
        if ($(e.target).closest('.bootstrap-timepicker-widget').length === 0) {
          self.hideWidget();
        }
      });

      this.$element.trigger({
        'type': 'show.timepicker',
        'time': {
          'value': this.getTime(),
          'hours': this.hour,
          'minutes': this.minute,
          'seconds': this.second,
          'meridian': this.meridian
        }
      });

      if (this.disableFocus) {
        this.$element.blur();
      }

      this.updateFromElementVal();

      if (this.template === 'modal') {
        this.$widget.modal('show').on('hidden', $.proxy(this.hideWidget, this));
      } else {
        if (this.isOpen === false) {
          this.$widget.addClass('open');
        }
      }

      this.isOpen = true;
    },

    toggleMeridian: function() {
      this.meridian = this.meridian === 'AM' ? 'PM' : 'AM';
      this.update();
    },

    update: function() {
      this.$element.trigger({
        'type': 'changeTime.timepicker',
        'time': {
          'value': this.getTime(),
          'hours': this.hour,
          'minutes': this.minute,
          'seconds': this.second,
          'meridian': this.meridian
        }
      });

      this.updateElement();
      this.updateWidget();
    },

    updateElement: function() {
      this.$element.val(this.getTime()).change();
    },

    updateFromElementVal: function() {
      var val = this.$element.val();

      if (val) {
        this.setTime(val);
      }
    },

    updateWidget: function() {
      if (this.$widget === false) {
        return;
      }

      var hour = this.hour < 10 ? '0' + this.hour : this.hour,
          minute = this.minute < 10 ? '0' + this.minute : this.minute,
          second = this.second < 10 ? '0' + this.second : this.second;

      if (this.showInputs) {
        this.$widget.find('input.bootstrap-timepicker-hour').val(hour);
        this.$widget.find('input.bootstrap-timepicker-minute').val(minute);

        if (this.showSeconds) {
          this.$widget.find('input.bootstrap-timepicker-second').val(second);
        }
        if (this.showMeridian) {
          this.$widget.find('input.bootstrap-timepicker-meridian').val(this.meridian);
        }
      } else {
        this.$widget.find('span.bootstrap-timepicker-hour').text(hour);
        this.$widget.find('span.bootstrap-timepicker-minute').text(minute);

        if (this.showSeconds) {
          this.$widget.find('span.bootstrap-timepicker-second').text(second);
        }
        if (this.showMeridian) {
          this.$widget.find('span.bootstrap-timepicker-meridian').text(this.meridian);
        }
      }
    },

    updateFromWidgetInputs: function() {
      if (this.$widget === false) {
        return;
      }
      var time = $('input.bootstrap-timepicker-hour', this.$widget).val() + ':' +
        $('input.bootstrap-timepicker-minute', this.$widget).val() +
        (this.showSeconds ? ':' + $('input.bootstrap-timepicker-second', this.$widget).val() : '') +
        (this.showMeridian ? ' ' + $('input.bootstrap-timepicker-meridian', this.$widget).val() : '');

      this.setTime(time);
    },

    widgetClick: function(e) {
      e.stopPropagation();
      e.preventDefault();

      var action = $(e.target).closest('a').data('action');
      if (action) {
        this[action]();
      }
    },

    widgetKeydown: function(e) {
      var $input = $(e.target).closest('input'),
          name = $input.attr('name');

      switch (e.keyCode) {
      case 9: //tab
        if (this.showMeridian) {
          if (name === 'meridian') {
            return this.hideWidget();
          }
        } else {
          if (this.showSeconds) {
            if (name === 'second') {
              return this.hideWidget();
            }
          } else {
            if (name === 'minute') {
              return this.hideWidget();
            }
          }
        }

        this.updateFromWidgetInputs();
        break;
      case 27: // escape
        this.hideWidget();
        break;
      case 38: // up arrow
        e.preventDefault();
        switch (name) {
        case 'hour':
          this.incrementHour();
          break;
        case 'minute':
          this.incrementMinute();
          break;
        case 'second':
          this.incrementSecond();
          break;
        case 'meridian':
          this.toggleMeridian();
          break;
        }
        break;
      case 40: // down arrow
        e.preventDefault();
        switch (name) {
        case 'hour':
          this.decrementHour();
          break;
        case 'minute':
          this.decrementMinute();
          break;
        case 'second':
          this.decrementSecond();
          break;
        case 'meridian':
          this.toggleMeridian();
          break;
        }
        break;
      }
    }
  };


  //TIMEPICKER PLUGIN DEFINITION
  $.fn.timepicker = function(option) {
    var args = Array.apply(null, arguments);
    args.shift();
    return this.each(function() {
      var $this = $(this),
        data = $this.data('timepicker'),
        options = typeof option === 'object' && option;

      if (!data) {
        $this.data('timepicker', (data = new Timepicker(this, $.extend({}, $.fn.timepicker.defaults, options, $(this).data()))));
      }

      if (typeof option === 'string') {
        data[option].apply(data, args);
      }
    });
  };

  $.fn.timepicker.defaults = {
    defaultTime: '00:00',
    disableFocus: false,
    isOpen: false,
    minuteStep: 30,
    modalBackdrop: false,
    secondStep: 15,
    showSeconds: false,
    showInputs: false,
    showMeridian: false,
    template: 'dropdown',
    appendWidgetTo: '.bootstrap-timepicker',
    snapToStep: true
  };

  $.fn.timepicker.Constructor = Timepicker;

})(jQuery, window, document);

/**
 * Enhanced Select2 Dropmenus
 * Copyright (c) 2012 the AngularUI Team, http://angular-ui.github.com

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
 *
 * forked from https://github.com/angular-ui/ui-select2/blob/master/src/select2.js
 * original author: AngularUI team
 *
 */
angular.module('ui.select2', []).value('uiSelect2Config', {}).directive('uiSelect2', ['uiSelect2Config', '$timeout', function (uiSelect2Config, $timeout) {
  var options = {};
  if (uiSelect2Config) {
    angular.extend(options, uiSelect2Config);
  }
  return {
    require: 'ngModel',
    priority: 1,
    compile: function (tElm, tAttrs) {
      var watch,
        repeatOption,
        repeatAttr,
        isSelect = tElm.is('select'),
        isMultiple = angular.isDefined(tAttrs.multiple);

      // Enable watching of the options dataset if in use
      if (tElm.is('select')) {
        repeatOption = tElm.find('option[ng-repeat], option[data-ng-repeat]');

        if (repeatOption.length) {
          repeatAttr = repeatOption.attr('ng-repeat') || repeatOption.attr('data-ng-repeat');
          watch = jQuery.trim(repeatAttr.split('|')[0]).split(' ').pop();
        }
      }

      return function (scope, elm, attrs, controller) {
        // instance-specific options
        var opts = angular.extend({}, options, scope.$eval(attrs.uiSelect2));

        /*
        Convert from Select2 view-model to Angular view-model.
        */
        var convertToAngularModel = function(select2_data) {
          var model;
          if (opts.simple_tags) {
            model = [];
            angular.forEach(select2_data, function(value, index) {
              model.push(value.id);
            });
          } else {
            model = select2_data;
          }
          return model;
        };

        /*
        Convert from Angular view-model to Select2 view-model.
        */
        var convertToSelect2Model = function(angular_data) {
          var model = [];
          if (!angular_data) {
            return model;
          }

          if (opts.simple_tags) {
            model = [];
            angular.forEach(
              angular_data,
              function(value, index) {
                model.push({'id': value, 'text': value});
              });
          } else {
            model = angular_data;
          }
          return model;
        };

            if (isSelect) {
          // Use <select multiple> instead
          delete opts.multiple;
          delete opts.initSelection;
        } else if (isMultiple) {
          opts.multiple = true;
        }

        if (controller) {
          // Watch the model for programmatic changes
           scope.$watch(tAttrs.ngModel, function(current, old) {
            if (!current) {
              return;
            }
            if (current === old) {
              return;
            }
            controller.$render();
          }, true);
          controller.$render = function () {
            if (isSelect) {
              elm.select2('val', controller.$viewValue);
            } else {
              if (opts.multiple) {
                var viewValue = controller.$viewValue;
                if (angular.isString(viewValue)) {
                  viewValue = viewValue.split(',');
                }
                elm.select2(
                  'data', convertToSelect2Model(viewValue));
              } else {
                if (angular.isObject(controller.$viewValue)) {
                  elm.select2('data', controller.$viewValue);
                } else if (!controller.$viewValue) {
                  elm.select2('data', null);
                } else {
                  elm.select2('val', controller.$viewValue);
                }
              }
            }
          };

          // Watch the options dataset for changes
          if (watch) {
            scope.$watch(watch, function (newVal, oldVal, scope) {
              if (angular.equals(newVal, oldVal)) {
                return;
              }
              // Delayed so that the options have time to be rendered
              $timeout(function () {
                elm.select2('val', controller.$viewValue);
                // Refresh angular to remove the superfluous option
                elm.trigger('change');
                if(newVal && !oldVal && controller.$setPristine) {
                  controller.$setPristine(true);
                }
              });
            });
          }

          // Update valid and dirty statuses
          controller.$parsers.push(function (value) {
            var div = elm.prev();
            div
              .toggleClass('ng-invalid', !controller.$valid)
              .toggleClass('ng-valid', controller.$valid)
              .toggleClass('ng-invalid-required', !controller.$valid)
              .toggleClass('ng-valid-required', controller.$valid)
              .toggleClass('ng-dirty', controller.$dirty)
              .toggleClass('ng-pristine', controller.$pristine);
            return value;
          });

          if (!isSelect) {
            // Set the view and model value and update the angular template manually for the ajax/multiple select2.
            elm.bind("change", function (e) {
              e.stopImmediatePropagation();

              if (scope.$$phase || scope.$root.$$phase) {
                return;
              }
              scope.$apply(function () {
                controller.$setViewValue(
                  convertToAngularModel(elm.select2('data')));
              });
            });

            if (opts.initSelection) {
              var initSelection = opts.initSelection;
              opts.initSelection = function (element, callback) {
                initSelection(element, function (value) {
                  var isPristine = controller.$pristine;
                  controller.$setViewValue(convertToAngularModel(value));
                  callback(value);
                  if (isPristine) {
                    controller.$setPristine();
                  }
                  elm.prev().toggleClass('ng-pristine', controller.$pristine);
                });
              };
            }
          }
        }

        elm.bind("$destroy", function() {
          elm.select2("destroy");
        });

        attrs.$observe('disabled', function (value) {
          elm.select2('enable', !value);
        });

        if (attrs.ngMultiple) {
          scope.$watch(attrs.ngMultiple, function(newVal) {
            attrs.$set('multiple', !!newVal);
            elm.select2(opts);
          });
        }

        // Initialize the plugin late so that the injected DOM does not disrupt the template compiler
        $timeout(function () {
          elm.select2(opts);

          // Set initial value - I'm not sure about this but it seems to need to be there
          elm.val(controller.$viewValue);
          // important!
          controller.$render();

          // Not sure if I should just check for !isSelect OR if I should check for 'tags' key
          if (!opts.initSelection && !isSelect) {
            controller.$setViewValue(
              convertToAngularModel(elm.select2('data'))
            );
          }
        });
      };
    }
  };
}]);

/**
 * @license AngularJS v1.2.9
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
(function(window, angular, undefined) {'use strict';

var $resourceMinErr = angular.$$minErr('$resource');

// Helper functions and regex to lookup a dotted path on an object
// stopping at undefined/null.  The path must be composed of ASCII
// identifiers (just like $parse)
var MEMBER_NAME_REGEX = /^(\.[a-zA-Z_$][0-9a-zA-Z_$]*)+$/;

function isValidDottedPath(path) {
  return (path != null && path !== '' && path !== 'hasOwnProperty' &&
      MEMBER_NAME_REGEX.test('.' + path));
}

function lookupDottedPath(obj, path) {
  if (!isValidDottedPath(path)) {
    throw $resourceMinErr('badmember', 'Dotted member path "@{0}" is invalid.', path);
  }
  var keys = path.split('.');
  for (var i = 0, ii = keys.length; i < ii && obj !== undefined; i++) {
    var key = keys[i];
    obj = (obj !== null) ? obj[key] : undefined;
  }
  return obj;
}

/**
 * Create a shallow copy of an object and clear other fields from the destination
 */
function shallowClearAndCopy(src, dst) {
  dst = dst || {};

  angular.forEach(dst, function(value, key){
    delete dst[key];
  });

  for (var key in src) {
    if (src.hasOwnProperty(key) && key.charAt(0) !== '$' && key.charAt(1) !== '$') {
      dst[key] = src[key];
    }
  }

  return dst;
}

/**
 * @ngdoc overview
 * @name ngResource
 * @description
 *
 * # ngResource
 *
 * The `ngResource` module provides interaction support with RESTful services
 * via the $resource service.
 *
 * {@installModule resource}
 *
 * <div doc-module-components="ngResource"></div>
 *
 * See {@link ngResource.$resource `$resource`} for usage.
 */

/**
 * @ngdoc object
 * @name ngResource.$resource
 * @requires $http
 *
 * @description
 * A factory which creates a resource object that lets you interact with
 * [RESTful](http://en.wikipedia.org/wiki/Representational_State_Transfer) server-side data sources.
 *
 * The returned resource object has action methods which provide high-level behaviors without
 * the need to interact with the low level {@link ng.$http $http} service.
 *
 * Requires the {@link ngResource `ngResource`} module to be installed.
 *
 * @param {string} url A parametrized URL template with parameters prefixed by `:` as in
 *   `/user/:username`. If you are using a URL with a port number (e.g.
 *   `http://example.com:8080/api`), it will be respected.
 *
 *   If you are using a url with a suffix, just add the suffix, like this:
 *   `$resource('http://example.com/resource.json')` or `$resource('http://example.com/:id.json')`
 *   or even `$resource('http://example.com/resource/:resource_id.:format')`
 *   If the parameter before the suffix is empty, :resource_id in this case, then the `/.` will be
 *   collapsed down to a single `.`.  If you need this sequence to appear and not collapse then you
 *   can escape it with `/\.`.
 *
 * @param {Object=} paramDefaults Default values for `url` parameters. These can be overridden in
 *   `actions` methods. If any of the parameter value is a function, it will be executed every time
 *   when a param value needs to be obtained for a request (unless the param was overridden).
 *
 *   Each key value in the parameter object is first bound to url template if present and then any
 *   excess keys are appended to the url search query after the `?`.
 *
 *   Given a template `/path/:verb` and parameter `{verb:'greet', salutation:'Hello'}` results in
 *   URL `/path/greet?salutation=Hello`.
 *
 *   If the parameter value is prefixed with `@` then the value of that parameter is extracted from
 *   the data object (useful for non-GET operations).
 *
 * @param {Object.<Object>=} actions Hash with declaration of custom action that should extend the
 *   default set of resource actions. The declaration should be created in the format of {@link
 *   ng.$http#usage_parameters $http.config}:
 *
 *       {action1: {method:?, params:?, isArray:?, headers:?, ...},
 *        action2: {method:?, params:?, isArray:?, headers:?, ...},
 *        ...}
 *
 *   Where:
 *
 *   - **`action`** â€“ {string} â€“ The name of action. This name becomes the name of the method on
 *     your resource object.
 *   - **`method`** â€“ {string} â€“ HTTP request method. Valid methods are: `GET`, `POST`, `PUT`,
 *     `DELETE`, and `JSONP`.
 *   - **`params`** â€“ {Object=} â€“ Optional set of pre-bound parameters for this action. If any of
 *     the parameter value is a function, it will be executed every time when a param value needs to
 *     be obtained for a request (unless the param was overridden).
 *   - **`url`** â€“ {string} â€“ action specific `url` override. The url templating is supported just
 *     like for the resource-level urls.
 *   - **`isArray`** â€“ {boolean=} â€“ If true then the returned object for this action is an array,
 *     see `returns` section.
 *   - **`transformRequest`** â€“
 *     `{function(data, headersGetter)|Array.<function(data, headersGetter)>}` â€“
 *     transform function or an array of such functions. The transform function takes the http
 *     request body and headers and returns its transformed (typically serialized) version.
 *   - **`transformResponse`** â€“
 *     `{function(data, headersGetter)|Array.<function(data, headersGetter)>}` â€“
 *     transform function or an array of such functions. The transform function takes the http
 *     response body and headers and returns its transformed (typically deserialized) version.
 *   - **`cache`** â€“ `{boolean|Cache}` â€“ If true, a default $http cache will be used to cache the
 *     GET request, otherwise if a cache instance built with
 *     {@link ng.$cacheFactory $cacheFactory}, this cache will be used for
 *     caching.
 *   - **`timeout`** â€“ `{number|Promise}` â€“ timeout in milliseconds, or {@link ng.$q promise} that
 *     should abort the request when resolved.
 *   - **`withCredentials`** - `{boolean}` - whether to set the `withCredentials` flag on the
 *     XHR object. See {@link https://developer.mozilla.org/en/http_access_control#section_5
 *     requests with credentials} for more information.
 *   - **`responseType`** - `{string}` - see {@link
 *     https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest#responseType requestType}.
 *   - **`interceptor`** - `{Object=}` - The interceptor object has two optional methods -
 *     `response` and `responseError`. Both `response` and `responseError` interceptors get called
 *     with `http response` object. See {@link ng.$http $http interceptors}.
 *
 * @returns {Object} A resource "class" object with methods for the default set of resource actions
 *   optionally extended with custom `actions`. The default set contains these actions:
 *
 *       { 'get':    {method:'GET'},
 *         'save':   {method:'POST'},
 *         'query':  {method:'GET', isArray:true},
 *         'remove': {method:'DELETE'},
 *         'delete': {method:'DELETE'} };
 *
 *   Calling these methods invoke an {@link ng.$http} with the specified http method,
 *   destination and parameters. When the data is returned from the server then the object is an
 *   instance of the resource class. The actions `save`, `remove` and `delete` are available on it
 *   as  methods with the `$` prefix. This allows you to easily perform CRUD operations (create,
 *   read, update, delete) on server-side data like this:
 *   <pre>
        var User = $resource('/user/:userId', {userId:'@id'});
        var user = User.get({userId:123}, function() {
          user.abc = true;
          user.$save();
        });
     </pre>
 *
 *   It is important to realize that invoking a $resource object method immediately returns an
 *   empty reference (object or array depending on `isArray`). Once the data is returned from the
 *   server the existing reference is populated with the actual data. This is a useful trick since
 *   usually the resource is assigned to a model which is then rendered by the view. Having an empty
 *   object results in no rendering, once the data arrives from the server then the object is
 *   populated with the data and the view automatically re-renders itself showing the new data. This
 *   means that in most cases one never has to write a callback function for the action methods.
 *
 *   The action methods on the class object or instance object can be invoked with the following
 *   parameters:
 *
 *   - HTTP GET "class" actions: `Resource.action([parameters], [success], [error])`
 *   - non-GET "class" actions: `Resource.action([parameters], postData, [success], [error])`
 *   - non-GET instance actions:  `instance.$action([parameters], [success], [error])`
 *
 *   Success callback is called with (value, responseHeaders) arguments. Error callback is called
 *   with (httpResponse) argument.
 *
 *   Class actions return empty instance (with additional properties below).
 *   Instance actions return promise of the action.
 *
 *   The Resource instances and collection have these additional properties:
 *
 *   - `$promise`: the {@link ng.$q promise} of the original server interaction that created this
 *     instance or collection.
 *
 *     On success, the promise is resolved with the same resource instance or collection object,
 *     updated with data from server. This makes it easy to use in
 *     {@link ngRoute.$routeProvider resolve section of $routeProvider.when()} to defer view
 *     rendering until the resource(s) are loaded.
 *
 *     On failure, the promise is resolved with the {@link ng.$http http response} object, without
 *     the `resource` property.
 *
 *   - `$resolved`: `true` after first server interaction is completed (either with success or
 *      rejection), `false` before that. Knowing if the Resource has been resolved is useful in
 *      data-binding.
 *
 * @example
 *
 * # Credit card resource
 *
 * <pre>
     // Define CreditCard class
     var CreditCard = $resource('/user/:userId/card/:cardId',
      {userId:123, cardId:'@id'}, {
       charge: {method:'POST', params:{charge:true}}
      });

     // We can retrieve a collection from the server
     var cards = CreditCard.query(function() {
       // GET: /user/123/card
       // server returns: [ {id:456, number:'1234', name:'Smith'} ];

       var card = cards[0];
       // each item is an instance of CreditCard
       expect(card instanceof CreditCard).toEqual(true);
       card.name = "J. Smith";
       // non GET methods are mapped onto the instances
       card.$save();
       // POST: /user/123/card/456 {id:456, number:'1234', name:'J. Smith'}
       // server returns: {id:456, number:'1234', name: 'J. Smith'};

       // our custom method is mapped as well.
       card.$charge({amount:9.99});
       // POST: /user/123/card/456?amount=9.99&charge=true {id:456, number:'1234', name:'J. Smith'}
     });

     // we can create an instance as well
     var newCard = new CreditCard({number:'0123'});
     newCard.name = "Mike Smith";
     newCard.$save();
     // POST: /user/123/card {number:'0123', name:'Mike Smith'}
     // server returns: {id:789, number:'0123', name: 'Mike Smith'};
     expect(newCard.id).toEqual(789);
 * </pre>
 *
 * The object returned from this function execution is a resource "class" which has "static" method
 * for each action in the definition.
 *
 * Calling these methods invoke `$http` on the `url` template with the given `method`, `params` and
 * `headers`.
 * When the data is returned from the server then the object is an instance of the resource type and
 * all of the non-GET methods are available with `$` prefix. This allows you to easily support CRUD
 * operations (create, read, update, delete) on server-side data.

   <pre>
     var User = $resource('/user/:userId', {userId:'@id'});
     var user = User.get({userId:123}, function() {
       user.abc = true;
       user.$save();
     });
   </pre>
 *
 * It's worth noting that the success callback for `get`, `query` and other methods gets passed
 * in the response that came from the server as well as $http header getter function, so one
 * could rewrite the above example and get access to http headers as:
 *
   <pre>
     var User = $resource('/user/:userId', {userId:'@id'});
     User.get({userId:123}, function(u, getResponseHeaders){
       u.abc = true;
       u.$save(function(u, putResponseHeaders) {
         //u => saved user object
         //putResponseHeaders => $http header getter
       });
     });
   </pre>

 * # Creating a custom 'PUT' request
 * In this example we create a custom method on our resource to make a PUT request
 * <pre>
 *        var app = angular.module('app', ['ngResource', 'ngRoute']);
 *
 *        // Some APIs expect a PUT request in the format URL/object/ID
 *        // Here we are creating an 'update' method
 *        app.factory('Notes', ['$resource', function($resource) {
 *    return $resource('/notes/:id', null,
 *        {
 *            'update': { method:'PUT' }
 *        });
 *        }]);
 *
 *        // In our controller we get the ID from the URL using ngRoute and $routeParams
 *        // We pass in $routeParams and our Notes factory along with $scope
 *        app.controller('NotesCtrl', ['$scope', '$routeParams', 'Notes',
                                      function($scope, $routeParams, Notes) {
 *    // First get a note object from the factory
 *    var note = Notes.get({ id:$routeParams.id });
 *    $id = note.id;
 *
 *    // Now call update passing in the ID first then the object you are updating
 *    Notes.update({ id:$id }, note);
 *
 *    // This will PUT /notes/ID with the note object in the request payload
 *        }]);
 * </pre>
 */
angular.module('ngResource', ['ng']).
  factory('$resource', ['$http', '$q', function($http, $q) {

    var DEFAULT_ACTIONS = {
      'get':    {method:'GET'},
      'save':   {method:'POST'},
      'query':  {method:'GET', isArray:true},
      'remove': {method:'DELETE'},
      'delete': {method:'DELETE'}
    };
    var noop = angular.noop,
        forEach = angular.forEach,
        extend = angular.extend,
        copy = angular.copy,
        isFunction = angular.isFunction;

    /**
     * We need our custom method because encodeURIComponent is too aggressive and doesn't follow
     * http://www.ietf.org/rfc/rfc3986.txt with regards to the character set (pchar) allowed in path
     * segments:
     *    segment       = *pchar
     *    pchar         = unreserved / pct-encoded / sub-delims / ":" / "@"
     *    pct-encoded   = "%" HEXDIG HEXDIG
     *    unreserved    = ALPHA / DIGIT / "-" / "." / "_" / "~"
     *    sub-delims    = "!" / "$" / "&" / "'" / "(" / ")"
     *                     / "*" / "+" / "," / ";" / "="
     */
    function encodeUriSegment(val) {
      return encodeUriQuery(val, true).
        replace(/%26/gi, '&').
        replace(/%3D/gi, '=').
        replace(/%2B/gi, '+');
    }


    /**
     * This method is intended for encoding *key* or *value* parts of query component. We need a
     * custom method because encodeURIComponent is too aggressive and encodes stuff that doesn't
     * have to be encoded per http://tools.ietf.org/html/rfc3986:
     *    query       = *( pchar / "/" / "?" )
     *    pchar         = unreserved / pct-encoded / sub-delims / ":" / "@"
     *    unreserved    = ALPHA / DIGIT / "-" / "." / "_" / "~"
     *    pct-encoded   = "%" HEXDIG HEXDIG
     *    sub-delims    = "!" / "$" / "&" / "'" / "(" / ")"
     *                     / "*" / "+" / "," / ";" / "="
     */
    function encodeUriQuery(val, pctEncodeSpaces) {
      return encodeURIComponent(val).
        replace(/%40/gi, '@').
        replace(/%3A/gi, ':').
        replace(/%24/g, '$').
        replace(/%2C/gi, ',').
        replace(/%20/g, (pctEncodeSpaces ? '%20' : '+'));
    }

    function Route(template, defaults) {
      this.template = template;
      this.defaults = defaults || {};
      this.urlParams = {};
    }

    Route.prototype = {
      setUrlParams: function(config, params, actionUrl) {
        var self = this,
            url = actionUrl || self.template,
            val,
            encodedVal;

        var urlParams = self.urlParams = {};
        forEach(url.split(/\W/), function(param){
          if (param === 'hasOwnProperty') {
            throw $resourceMinErr('badname', "hasOwnProperty is not a valid parameter name.");
          }
          if (!(new RegExp("^\\d+$").test(param)) && param &&
               (new RegExp("(^|[^\\\\]):" + param + "(\\W|$)").test(url))) {
            urlParams[param] = true;
          }
        });
        url = url.replace(/\\:/g, ':');

        params = params || {};
        forEach(self.urlParams, function(_, urlParam){
          val = params.hasOwnProperty(urlParam) ? params[urlParam] : self.defaults[urlParam];
          if (angular.isDefined(val) && val !== null) {
            encodedVal = encodeUriSegment(val);
            url = url.replace(new RegExp(":" + urlParam + "(\\W|$)", "g"), encodedVal + "$1");
          } else {
            url = url.replace(new RegExp("(\/?):" + urlParam + "(\\W|$)", "g"), function(match,
                leadingSlashes, tail) {
              if (tail.charAt(0) == '/') {
                return tail;
              } else {
                return leadingSlashes + tail;
              }
            });
          }
        });

        // strip trailing slashes and set the url
        url = url.replace(/\/+$/, '') || '/';
        // then replace collapse `/.` if found in the last URL path segment before the query
        // E.g. `http://url.com/id./format?q=x` becomes `http://url.com/id.format?q=x`
        url = url.replace(/\/\.(?=\w+($|\?))/, '.');
        // replace escaped `/\.` with `/.`
        config.url = url.replace(/\/\\\./, '/.');


        // set params - delegate param encoding to $http
        forEach(params, function(value, key){
          if (!self.urlParams[key]) {
            config.params = config.params || {};
            config.params[key] = value;
          }
        });
      }
    };


    function resourceFactory(url, paramDefaults, actions) {
      var route = new Route(url);

      actions = extend({}, DEFAULT_ACTIONS, actions);

      function extractParams(data, actionParams){
        var ids = {};
        actionParams = extend({}, paramDefaults, actionParams);
        forEach(actionParams, function(value, key){
          if (isFunction(value)) { value = value(); }
          ids[key] = value && value.charAt && value.charAt(0) == '@' ?
            lookupDottedPath(data, value.substr(1)) : value;
        });
        return ids;
      }

      function defaultResponseInterceptor(response) {
        return response.resource;
      }

      function Resource(value){
        shallowClearAndCopy(value || {}, this);
      }

      forEach(actions, function(action, name) {
        var hasBody = /^(POST|PUT|PATCH)$/i.test(action.method);

        Resource[name] = function(a1, a2, a3, a4) {
          var params = {}, data, success, error;

          /* jshint -W086 */ /* (purposefully fall through case statements) */
          switch(arguments.length) {
          case 4:
            error = a4;
            success = a3;
            //fallthrough
          case 3:
          case 2:
            if (isFunction(a2)) {
              if (isFunction(a1)) {
                success = a1;
                error = a2;
                break;
              }

              success = a2;
              error = a3;
              //fallthrough
            } else {
              params = a1;
              data = a2;
              success = a3;
              break;
            }
          case 1:
            if (isFunction(a1)) success = a1;
            else if (hasBody) data = a1;
            else params = a1;
            break;
          case 0: break;
          default:
            throw $resourceMinErr('badargs',
              "Expected up to 4 arguments [params, data, success, error], got {0} arguments",
              arguments.length);
          }
          /* jshint +W086 */ /* (purposefully fall through case statements) */

          var isInstanceCall = this instanceof Resource;
          var value = isInstanceCall ? data : (action.isArray ? [] : new Resource(data));
          var httpConfig = {};
          var responseInterceptor = action.interceptor && action.interceptor.response ||
                                    defaultResponseInterceptor;
          var responseErrorInterceptor = action.interceptor && action.interceptor.responseError ||
                                    undefined;

          forEach(action, function(value, key) {
            if (key != 'params' && key != 'isArray' && key != 'interceptor') {
              httpConfig[key] = copy(value);
            }
          });

          if (hasBody) httpConfig.data = data;
          route.setUrlParams(httpConfig,
                             extend({}, extractParams(data, action.params || {}), params),
                             action.url);

          var promise = $http(httpConfig).then(function(response) {
            var data = response.data,
                promise = value.$promise;

            if (data) {
              // Need to convert action.isArray to boolean in case it is undefined
              // jshint -W018
              if (angular.isArray(data) !== (!!action.isArray)) {
                throw $resourceMinErr('badcfg', 'Error in resource configuration. Expected ' +
                  'response to contain an {0} but got an {1}',
                  action.isArray?'array':'object', angular.isArray(data)?'array':'object');
              }
              // jshint +W018
              if (action.isArray) {
                value.length = 0;
                forEach(data, function(item) {
                  value.push(new Resource(item));
                });
              } else {
                shallowClearAndCopy(data, value);
                value.$promise = promise;
              }
            }

            value.$resolved = true;

            response.resource = value;

            return response;
          }, function(response) {
            value.$resolved = true;

            (error||noop)(response);

            return $q.reject(response);
          });

          promise = promise.then(
              function(response) {
                var value = responseInterceptor(response);
                (success||noop)(value, response.headers);
                return value;
              },
              responseErrorInterceptor);

          if (!isInstanceCall) {
            // we are creating instance / collection
            // - set the initial promise
            // - return the instance / collection
            value.$promise = promise;
            value.$resolved = false;

            return value;
          }

          // instance call
          return promise;
        };


        Resource.prototype['$' + name] = function(params, success, error) {
          if (isFunction(params)) {
            error = success; success = params; params = {};
          }
          var result = Resource[name].call(this, params, this, success, error);
          return result.$promise || result;
        };
      });

      Resource.bind = function(additionalParamDefaults){
        return resourceFactory(url, extend({}, paramDefaults, additionalParamDefaults), actions);
      };

      return Resource;
    }

    return resourceFactory;
  }]);


})(window, window.angular);

angular.module('phoneNumberModule', [])
.factory('phoneNumberFormatterFactory', function(COUNTRY_NAME_MAP){
    return {
        phoneNumberTranslator: function(value, format){
            var phoneUtil = libphonenumber.PhoneNumberUtil.getInstance();
            var formattedNumber = value;
            try {
                var number = phoneUtil.parseAndKeepRawInput(value, '');
                var regionCode = phoneUtil.getRegionCodeForNumber(number);
                var phoneNumber = phoneUtil.parse(value, regionCode);
                formattedNumber = phoneUtil.format(phoneNumber, format);
            } catch (err) {
                console.log(err);
            }
            return formattedNumber;
        },
        phoneNumberValidator: function(value) {
            var phoneUtil = libphonenumber.PhoneNumberUtil.getInstance();
            try {
                var number = phoneUtil.parseAndKeepRawInput(value, '');
                return phoneUtil.isPossibleNumber(number);
            } catch (err) {
                console.log(value + " is not a valid number format!");
                return false;
            }
        },
        getAllCountryList: function() {
            var phoneUtil = libphonenumber.PhoneNumberUtil.getInstance();
            var countryList = [];
            _.forEach(COUNTRY_NAME_MAP, function(name, iso) {
                var countryCode = phoneUtil.getCountryCodeForRegion(iso);
                var flagClass = iso.toLowerCase() + "-flag";
                countryList.push({"value": iso, "name": name, "code": "+" + countryCode, "flag": flagClass});
            });
            return countryList;
        },
        getCountryList: function(data) {
            var phoneUtil = libphonenumber.PhoneNumberUtil.getInstance();
            var countryList = [];
            _.forEach(data, function(country) {
                var countryCode = phoneUtil.getCountryCodeForRegion(country.isocode);
                var flagClass = country.isocode.toLowerCase() + "-flag";
                countryList.push({"value": country.isocode, "name": country.countryName, "code": "+" + countryCode, "flag": flagClass});
            });
            return countryList;
        },
        getCountryListFromNames: function(data) {
            var phoneUtil = libphonenumber.PhoneNumberUtil.getInstance();
            var countryList = [];
            _.forEach(data, function(isocode) {
                var countryCode = phoneUtil.getCountryCodeForRegion(isocode);
                var flagClass = isocode.toLowerCase() + "-flag";
                countryList.push(
                    {
                        "value": isocode,
                        "name": COUNTRY_NAME_MAP[isocode.toUpperCase()],
                        "code": "+" + countryCode,
                        "flag": flagClass
                    }
                );
            });
            return countryList;
        },
        analyzeNumber: function(value) {
            try {
                var phoneUtil = libphonenumber.PhoneNumberUtil.getInstance();
                var number = phoneUtil.parseAndKeepRawInput(value, '');
                var isocode = phoneUtil.getRegionCodeForNumber(number);

                return {
                    number:  number.getNationalNumber(),
                    code:   "+" + number.getCountryCode(),
                    flag:   isocode.toLowerCase() + "-flag",
                    country: isocode
                };
            } catch (e) {
                console.log("Phone number is not in E.164 format.");
                return null;
            }
        }
    };
})
.factory('AvailableCountriesService', function($resource){
    return $resource('', {}, {
        getAvailableCountries: {
            url: document.requestPathPrefix + '/numbers/get-available-countries',
            method: 'GET'
        },
        getClaimableCountries: {
            url: document.requestPathPrefix + '/numbers/get-claimable-countries',
            method: 'GET'
        },
        getDialableCountries: {
            url: document.requestPathPrefix + "/users/get-dialable-countries",
            method: "GET",
            isArray: true
        }
    });
})
.directive('phoneNumberFormatter', function(phoneNumberFormatterFactory) {
    return {
        restrict: 'AE',
        scope: true,
        controllerAs: '',
        link: function(scope, element, attrs) {
            scope.$watch(attrs.phoneNumberFormatter, function(newValue, oldValue) {
                var formattedNumber = phoneNumberFormatterFactory.phoneNumberTranslator(newValue, window.libphonenumber.PhoneNumberFormat.INTERNATIONAL);
                if (element.text() !== formattedNumber){
                    element.text(formattedNumber);
                }
            });
        }
    };
})
.constant("COUNTRY_NAME_MAP", {
    'AF' : 'Afghanistan',
    'AX' : 'Aland Islands',
    'AL' : 'Albania',
    'DZ' : 'Algeria',
    'AS' : 'American Samoa',
    'AD' : 'Andorra',
    'AO' : 'Angola',
    'AI' : 'Anguilla',
    'AQ' : 'Antarctica',
    'AG' : 'Antigua And Barbuda',
    'AR' : 'Argentina',
    'AM' : 'Armenia',
    'AW' : 'Aruba',
    'AC' : 'Ascension Island',
    'AU' : 'Australia',
    'AT' : 'Austria',
    'AZ' : 'Azerbaijan',
    'BS' : 'Bahamas',
    'BH' : 'Bahrain',
    'BD' : 'Bangladesh',
    'BB' : 'Barbados',
    'BY' : 'Belarus',
    'BE' : 'Belgium',
    'BZ' : 'Belize',
    'BJ' : 'Benin',
    'BM' : 'Bermuda',
    'BT' : 'Bhutan',
    'BO' : 'Bolivia',
    'BA' : 'Bosnia And Herzegovina',
    'BW' : 'Botswana',
    'BV' : 'Bouvet Island',
    'BR' : 'Brazil',
    'IO' : 'British Indian Ocean Territory',
    'BN' : 'Brunei Darussalam',
    'BG' : 'Bulgaria',
    'BF' : 'Burkina Faso',
    'BI' : 'Burundi',
    'KH' : 'Cambodia',
    'CM' : 'Cameroon',
    'CA' : 'Canada',
    'CV' : 'Cape Verde',
    'KY' : 'Cayman Islands',
    'CF' : 'Central African Republic',
    'TD' : 'Chad',
    'CL' : 'Chile',
    'CN' : 'China',
    'CX' : 'Christmas Island',
    'CC' : 'Cocos (Keeling) Islands',
    'CO' : 'Colombia',
    'KM' : 'Comoros',
    'CG' : 'Congo',
    'CD' : 'Congo, Democratic Republic',
    'CK' : 'Cook Islands',
    'CR' : 'Costa Rica',
    'CI' : 'Cote D\'Ivoire',
    'HR' : 'Croatia',
    'CU' : 'Cuba',
    'CW' : 'Curacao',
    'CY' : 'Cyprus',
    'CZ' : 'Czech Republic',
    'DK' : 'Denmark',
    'DG' : 'Diego Garcia',
    'DJ' : 'Djibouti',
    'DM' : 'Dominica',
    'DO' : 'Dominican Republic',
    'EC' : 'Ecuador',
    'EG' : 'Egypt',
    'SV' : 'El Salvador',
    'GQ' : 'Equatorial Guinea',
    'ER' : 'Eritrea',
    'EE' : 'Estonia',
    'ET' : 'Ethiopia',
    'FK' : 'Falkland Islands (Malvinas)',
    'FO' : 'Faroe Islands',
    'FJ' : 'Fiji',
    'FI' : 'Finland',
    'FR' : 'France',
    'GF' : 'French Guiana',
    'PF' : 'French Polynesia',
    'TF' : 'French Southern Territories',
    'GA' : 'Gabon',
    'GM' : 'Gambia',
    'GE' : 'Georgia',
    'DE' : 'Germany',
    'GH' : 'Ghana',
    'GI' : 'Gibraltar',
    'GR' : 'Greece',
    'GL' : 'Greenland',
    'GD' : 'Grenada',
    'GP' : 'Guadeloupe',
    'GU' : 'Guam',
    'GT' : 'Guatemala',
    'GG' : 'Guernsey',
    'GN' : 'Guinea',
    'GW' : 'Guinea-Bissau',
    'GY' : 'Guyana',
    'HT' : 'Haiti',
    'HM' : 'Heard Island & Mcdonald Islands',
    'VA' : 'Holy See (Vatican City State)',
    'HN' : 'Honduras',
    'HK' : 'Hong Kong',
    'HU' : 'Hungary',
    'IS' : 'Iceland',
    'IN' : 'India',
    'ID' : 'Indonesia',
    'IR' : 'Iran, Islamic Republic Of',
    'IQ' : 'Iraq',
    'IE' : 'Ireland',
    'IM' : 'Isle Of Man',
    'IL' : 'Israel',
    'IT' : 'Italy',
    'JM' : 'Jamaica',
    'JP' : 'Japan',
    'JE' : 'Jersey',
    'JO' : 'Jordan',
    'KZ' : 'Kazakhstan',
    'KE' : 'Kenya',
    'KI' : 'Kiribati',
    'KR' : 'Korea',
    'KW' : 'Kuwait',
    'KG' : 'Kyrgyzstan',
    'LA' : 'Lao People\'s Democratic Republic',
    'LV' : 'Latvia',
    'LB' : 'Lebanon',
    'LS' : 'Lesotho',
    'LR' : 'Liberia',
    'LY' : 'Libyan Arab Jamahiriya',
    'LI' : 'Liechtenstein',
    'LT' : 'Lithuania',
    'LU' : 'Luxembourg',
    'MO' : 'Macao',
    'MK' : 'Macedonia',
    'MG' : 'Madagascar',
    'MW' : 'Malawi',
    'MY' : 'Malaysia',
    'MV' : 'Maldives',
    'ML' : 'Mali',
    'MT' : 'Malta',
    'MH' : 'Marshall Islands',
    'MQ' : 'Martinique',
    'MR' : 'Mauritania',
    'MU' : 'Mauritius',
    'YT' : 'Mayotte',
    'MX' : 'Mexico',
    'FM' : 'Micronesia, Federated States Of',
    'MD' : 'Moldova',
    'MC' : 'Monaco',
    'MN' : 'Mongolia',
    'ME' : 'Montenegro',
    'MS' : 'Montserrat',
    'MA' : 'Morocco',
    'MZ' : 'Mozambique',
    'MM' : 'Myanmar',
    'NA' : 'Namibia',
    'NR' : 'Nauru',
    'NP' : 'Nepal',
    'NL' : 'Netherlands',
    'AN' : 'Netherlands Antilles',
    'NC' : 'New Caledonia',
    'NZ' : 'New Zealand',
    'NI' : 'Nicaragua',
    'NE' : 'Niger',
    'NG' : 'Nigeria',
    'NU' : 'Niue',
    'NF' : 'Norfolk Island',
    'MP' : 'Northern Mariana Islands',
    'NO' : 'Norway',
    'OM' : 'Oman',
    'PK' : 'Pakistan',
    'PW' : 'Palau',
    'PS' : 'Palestinian Territory, Occupied',
    'PA' : 'Panama',
    'PG' : 'Papua New Guinea',
    'PY' : 'Paraguay',
    'PE' : 'Peru',
    'PH' : 'Philippines',
    'PN' : 'Pitcairn',
    'PL' : 'Poland',
    'PT' : 'Portugal',
    'PR' : 'Puerto Rico',
    'QA' : 'Qatar',
    'RE' : 'Reunion',
    'RO' : 'Romania',
    'RU' : 'Russian Federation',
    'RW' : 'Rwanda',
    'BL' : 'Saint Barthelemy',
    'SH' : 'Saint Helena',
    'KN' : 'Saint Kitts And Nevis',
    'LC' : 'Saint Lucia',
    'MF' : 'Saint Martin',
    'PM' : 'Saint Pierre And Miquelon',
    'VC' : 'Saint Vincent And Grenadines',
    'WS' : 'Samoa',
    'SM' : 'San Marino',
    'ST' : 'Sao Tome And Principe',
    'SA' : 'Saudi Arabia',
    'SN' : 'Senegal',
    'RS' : 'Serbia',
    'SC' : 'Seychelles',
    'SL' : 'Sierra Leone',
    'SG' : 'Singapore',
    'SX' : 'Sint Maarten',
    'SK' : 'Slovakia',
    'SI' : 'Slovenia',
    'SB' : 'Solomon Islands',
    'SO' : 'Somalia',
    'ZA' : 'South Africa',
    'GS' : 'South Georgia And Sandwich Isl.',
    'SS' : 'South Sudan',
    'ES' : 'Spain',
    'LK' : 'Sri Lanka',
    'SD' : 'Sudan',
    'SR' : 'Suriname',
    'SJ' : 'Svalbard And Jan Mayen',
    'SZ' : 'Swaziland',
    'SE' : 'Sweden',
    'CH' : 'Switzerland',
    'SY' : 'Syrian Arab Republic',
    'TW' : 'Taiwan',
    'TJ' : 'Tajikistan',
    'TZ' : 'Tanzania',
    'TH' : 'Thailand',
    'TL' : 'Timor-Leste',
    'TG' : 'Togo',
    'TK' : 'Tokelau',
    'TO' : 'Tonga',
    'TT' : 'Trinidad And Tobago',
    'TN' : 'Tunisia',
    'TR' : 'Turkey',
    'TM' : 'Turkmenistan',
    'TC' : 'Turks And Caicos Islands',
    'TV' : 'Tuvalu',
    'UG' : 'Uganda',
    'UA' : 'Ukraine',
    'AE' : 'United Arab Emirates',
    'GB' : 'United Kingdom',
    'US' : 'United States',
    'UM' : 'United States Outlying Islands',
    'UY' : 'Uruguay',
    'UZ' : 'Uzbekistan',
    'VU' : 'Vanuatu',
    'VE' : 'Venezuela',
    'VN' : 'Viet Nam',
    'VG' : 'Virgin Islands, British',
    'VI' : 'Virgin Islands, U.S.',
    'WF' : 'Wallis And Futuna',
    'EH' : 'Western Sahara',
    'YE' : 'Yemen',
    'ZM' : 'Zambia',
    'ZW' : 'Zimbabwe'
});


angular.module('tap.selectors', ['ui.select2', 'tap.strings', 'phoneNumberModule', 'lily.utils'])
    .factory('select', function(){
        return function select(options){
            return {
                require: "?ngModel",
                restrict: "AE",
                replace: true,
                scope: {
                    "ngModel": "=?",
                    "select2Opts": "=?"
                },
                template: '<input type="hidden" ng-class="class" ui-select2="select2Opts"></input>',
                compile: function(elem, attrs){
                    return {
                        pre: function (scope, elem, attrs, ngModel){
                            var select2Opts = angular.extend({}, options.select2Opts, scope.select2Opts);
                            if(angular.isDefined(attrs.multiple)){
                                select2Opts.multiple = true;
                            }

                            angular.extend(scope, {
                                select2Opts: select2Opts
                            });
                        }
                    };
                }
            };
        };
    })
    .directive('entrypointaddressselect', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                             placeholder: TapStrings.searchForEntryPoints,
                             urlSuffix: "/entryPointsByAddress"
                         })
        });
    })
    .directive('promptselect', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                             placeholder: TapStrings.searchForPrompts,
                             urlSuffix: "/prompts"
                         })
        })
    })
    .directive('skillselect', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                             placeholder: TapStrings.searchForSkill,
                             urlSuffix: "/skills"
                         })
        });
    })
    .directive('siteselect', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                             placeholder: TapStrings.searchForSite,
                             urlSuffix: "/callCenters"
                         })
        });
    })
    .directive('ownerselect', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                             placeholder: TapStrings.searchForOwner,
                             urlSuffix: "/owners"
                         })
        });
    })
    .directive('timezoneselect', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForTimezone,
                urlSuffix: "/timezones"
            })
        });
    })
    .directive('teamselect', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                             placeholder: TapStrings.searchForTeam,
                             urlSuffix: "/teams"
                         })
        });
    })
    .directive('profileselect', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                             placeholder: TapStrings.searchForProfile,
                             urlSuffix: "/profiles"
                         })
        });
    })
    .directive('securityprofileselect', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                             placeholder: TapStrings.searchForSecurityProfile,
                             urlSuffix: "/securityprofiles"
                         })
        });
    })

    .directive('securityprofilesarnselect', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForSecurityProfile,
                urlSuffix: "/securityprofilesarn"
            })
        });
    })

    .directive('tdselect', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForQuickConnects,
                urlSuffix: "/transfer-dests"
                })
        });
    })

    .directive('hoopselect', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForHoursOfOperation,
                urlSuffix: "/hoops"
                })
        });
    })

    .directive('callflowselect', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForCallFlow,
                urlSuffix: "/callflowTemplates"
                })
        });
    })

    .directive('callflowselectnoattr', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForCallFlow,
                urlSuffix: "/callflowTemplates-no-req-attr"
                })
        });
    })

    .directive('claimednumberarnselect', function(SelectorService, TapStrings, select, phoneNumberFormatterFactory ) {
            return select({
                select2Opts: SelectorService.select2Options({
                    placeholder: TapStrings.searchForClaimedPhoneNumbers,
                    urlSuffix: "/claimed-phone-numbers-arn",
                    selectFormatter: function(result) {
                        var formattedNumber = phoneNumberFormatterFactory.phoneNumberTranslator(result.text, window.libphonenumber.PhoneNumberFormat.INTERNATIONAL);
                        return formattedNumber;
                    }
                    })
            });
        })

    .directive('publishedcontactflowselect', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForCallFlow,
                urlSuffix: "/published-contact-flow"
                })
        });
    })

    .directive('agentholdcontactflowselect', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForCallFlow,
                urlSuffix: "/agent-hold-contact-flow"
                })
        });
    })

    .directive('customerholdcontactflowselect', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForCallFlow,
                urlSuffix: "/customer-hold-contact-flow"
                })
        });
    })

    .directive('agentwhispercontactflowselect', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForCallFlow,
                urlSuffix: "/agent-whisper-contact-flow"
                })
        });
    })

    .directive('lexbotSelector', function(SelectorService, TapStrings, select, lilyLocalization) {
            return select({
                select2Opts: SelectorService.select2Options({
                    // To make sure not to have the search option
                    minimumResultsForSearch: Infinity,
                    placeholder: lilyLocalization.getString("lily-admin-selector-lex-bots"),
                    urlSuffix: "/lexbots",
                    selectFormatter:  function(result){
                        return result.text + " (" + lilyLocalization.getString("lily-admin-region-name-" + result.id.split("|")[1]) + ")";
                    }
                })
        });
    })

    .directive('lexbotV2Selector', function(ContactFlowService, select, lilyLocalization) {
        // select2 requires results to have a text field for UI display
        let addDisplayTextToLexbot = function(lexbots) {
            lexbots.forEach(function(bot) {
                bot.text = bot.name;
            });
        };
        return select({
            select2Opts: {
                minimumInputLength: 0,
                minimumResultsForSearch: Infinity,
                allowClear: true,
                multiple: false,
                placeholder: lilyLocalization.getString("lily-admin-selector-lex-bots"),
                query: function(query) {
                    ContactFlowService.listLexBots({
                    }, function success(data) {
                        addDisplayTextToLexbot(data);
                        query.callback({more: false, results: data});
                    }, function error(data) {
                    });
                },
                formatResult: function(result) {
                    return escapeHtml(result.text);
                },
                formatSelection: function(result){
                    return escapeHtml(result.text);
                }
            }
        });
    })

    .directive('customerwhispercontactflowselect', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForCallFlow,
                urlSuffix: "/customer-whisper-contact-flow"
                })
        });
    })

    .directive('outboundwhisperflowselect', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForCallFlow,
                urlSuffix: "/outbound-whisper-contact-flow"
                })
        });
    })

    .directive('customerqueuecontactflowselect', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForCallFlow,
                urlSuffix: "/customer-queue-contact-flow"
                })
        });
    })

    .directive('agenttransfercontactflowselect', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForCallFlow,
                urlSuffix: "/agent-transfer-contact-flow"
                })
        });
    })

    .directive('queuetransfercontactflowselect', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForCallFlow,
                urlSuffix: "/queue-transfer-contact-flow"
                })
        });
    })

    .directive('metricsagentselect', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForAgents,
                urlSuffix: "/named-agents"
                })
        });
    })

    .directive('agentselect', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForAgents,
                urlSuffix: "/agents"
                })
        });
    })

    .directive('agentQueueSelector', function(SelectorService, TapStrings, select) {
        return select({
            select2Opts: SelectorService.select2Options({
                placeholder: TapStrings.searchForAgents,
                urlSuffix: "/agent-queues"
                })
        });
    })

    .directive('agentgroupl1select', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                 placeholder: TapStrings.selectAgentGroup,
                 urlSuffix: "/agentGroups",
                 multiple: false,
                 getData: SelectorService.getAgentGroupMetadataForLevel,
                 level: "level1"
             })
        });
    })
    .directive('agentgroupl2select', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                             placeholder: TapStrings.selectAgentGroup,
                             urlSuffix: "/agentGroups",
                             multiple: false,
                             getData: SelectorService.getAgentGroupMetadataForLevel,
                             level: "level2"
                         })
        });
    })
    .directive('agentgroupl3select', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                             placeholder: TapStrings.selectAgentGroup,
                             urlSuffix: "/agentGroups",
                             multiple: false,
                             getData: SelectorService.getAgentGroupMetadataForLevel,
                             level: "level3"
                         })
        });
    })
    .directive('agentgroupl4select', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                             placeholder: TapStrings.selectAgentGroup,
                             urlSuffix: "/agentGroups",
                             multiple: false,
                             getData: SelectorService.getAgentGroupMetadataForLevel,
                             level: "level4"
                         })
        });
    })
    .directive('agentgroupl5select', function(SelectorService, TapStrings, select){
        return select({
            select2Opts: SelectorService.select2Options({
                             placeholder: TapStrings.selectAgentGroup,
                             urlSuffix: "/agentGroups",
                             multiple: false,
                             getData: SelectorService.getAgentGroupMetadataForLevel,
                             level: "level5"
                         })
        });
    })

    .directive('contactflowversionselector', function(SelectorService, TapStrings, select, lilyLocalization){
        var entityIdVal = new URL(window.location).searchParams.get("id");
        return select({
            select2Opts: SelectorService.select2Options({
                            minimumResultsForSearch: -1,
                            placeholder: "  - ",
                            urlSuffix: "/contact-flow-version-history",
                            params: {contactFlowId: entityIdVal},
                            allowClear: false,
                            processResults: function (data, page) {
                                if (page === 1) {
                                    data.results.unshift({
                                        id: "latest",
                                        text: lilyLocalization.getString('lily-admin-contact-flow-latest-version-option')
                                    });
                                }
                              return data;
                            }
                        })
        });
    })
// TODO: Remove once contactlensrealtime FAC GAs
    .directive('analysislanguageselector', function(SelectorService, TapStrings, select, lilyLocalization){
        return select({
            select2Opts: SelectorService.select2Options({
                            minimumResultsForSearch: -1,
                            placeholder: TapStrings.selectAnalyticsLanguage,
                            urlSuffix: "/analysis-language-options",
                            params: {},
                            allowClear: false,
                            processResults: function (data, page) {
                                return data;
                            }
                        })
        });
    })

    .service('SelectorService', function($http, TapStrings){
        var agentGroupMetadataAllLevels = {level1:{}, level2:{}, level3:{}, level4:{}, level5:{}};

        var BASE_SEARCH_URL = "/selector-search";
        function initSelection(element, callback, urlSuffix){
            $http.get(document.requestPathPrefix + BASE_SEARCH_URL + urlSuffix, {
                dataType: 'json',
                params: {
                         name: "",
                         page: 0,
                         ids:  element.val()
                      }
            }).then(function(response) {
                var data = response.data;
                var selectData;
                if (element.attr('multiple')) {
                    selectData = data.results;
                } else {
                    selectData = (data.results && data.results.length > 0) ? data.results[0] : null;
                }
                callback(selectData);
            });
        };

        function getAgentGroupMetadataForLevel(level) {
            return agentGroupMetadataAllLevels[level];
        }

        function setAgentGroupMetadataForLevel(level, levelArn, parentArn) {
            agentGroupMetadataAllLevels[level] = {
                levelArn: levelArn,
                parentArn: parentArn
            };
        }

        return {
            getAgentGroupMetadataForLevel: getAgentGroupMetadataForLevel,
            setAgentGroupMetadataForLevel: setAgentGroupMetadataForLevel,
            select2Options: function(options){
                options = angular.extend({
                    minimumInputLength: 0,
                    allowClear: true,
                    params: {},
                    nextToken: null
                }, options);
                return {
                    minimumInputLength: options.minimumInputLength,
                    minimumResultsForSearch: options.minimumResultsForSearch,
                    initSelection: function(element, callback){
                        initSelection(element, callback, options.urlSuffix);
                    },
                    allowClear: options.allowClear,
                    placeholder: options.placeholder,
                    multiple: options.multiple,
                    ajax: {
                        url: document.requestPathPrefix + BASE_SEARCH_URL + options.urlSuffix,
                        dataType: 'json',
                        quietMillis: 300,
                        data: function(term, page) {
                            if (options.getData) {
                                var levelArnAndParentArn = options.getData(options.level);
                                return {
                                    name: term,
                                    page: page-1,
                                    levelArn: levelArnAndParentArn.levelArn,
                                    parentArn: levelArnAndParentArn.parentArn
                                };
                            }
                            return Object.assign({name: term, page: page - 1, nextToken: options.nextToken}, options.params);
                        },
                        results: function (data, page) {
                          // Adding additional option to the result
                          if (options.processResults) {
                            options.processResults(data, page);
                          }
                          options.nextToken = data.nextToken;
                          return data;
                        }
                    },
                    formatResult: function(result) {
                        if(options.selectFormatter) {
                            return escapeHtml(options.selectFormatter(result));
                        }
                        return escapeHtml(result.text);
                    },
                    formatSelection: function(result){
                        if(options.selectFormatter) {
                            return escapeHtml(options.selectFormatter(result));
                        }
                        return escapeHtml(result.text);
                    }
                };
            }
        };
    }
);

angular.module('metrics.selectors', ['ui.select2', 'tap.strings'])
    .factory('select', function(){
        return function select(options){
            return {
                require: "?ngModel",
                restrict: "AE",
                replace: true,
                scope: {
                    "ngModel": "=?",
                    "select2Opts": "=?"
                },
                template: '<input type="hidden" ng-class="class" ui-select2="select2Opts"></input>',
                compile: function(elem, attrs){
                    return {
                        pre: function (scope, elem, attrs, ngModel){
                            var select2Opts = angular.extend({}, options.select2Opts, scope.select2Opts);
                            if(angular.isDefined(attrs.multiple)){
                                select2Opts.multiple = true;
                            }
                            angular.extend(scope, {
                                select2Opts: select2Opts
                            });
                        }
                    };
                }
            };
        };
    })
    .directive('metricsentrypointselect', function(MetricsSelectorService, TapStrings, select){
        return select({
            select2Opts: MetricsSelectorService.select2Options({
                             placeholder: TapStrings.searchForEntryPoints,
                             urlSuffix: "/entryPoints",
                             closeOnSelect: false
                         })
        });
    })
    .directive('metricsphonenumberselect', function(MetricsSelectorService, TapStrings, select){
           return select({
               select2Opts: MetricsSelectorService.select2Options({
                              placeholder: TapStrings.searchForClaimedPhoneNumbers,
                              urlSuffix: "/claimedPhoneNumbers",
                              closeOnSelect: false
                          })
         });
    })
    .directive('metricscontactflowselect', function(MetricsSelectorService, TapStrings, select){
            return select({
                select2Opts: MetricsSelectorService.select2Options({
                            placeholder: TapStrings.searchForCallFlow,
                            urlSuffix: "/contactFlows",
                            closeOnSelect: false
                })
            });
    })
    .directive('metricsagentgroupl1select', function(MetricsSelectorService, TapStrings, select){
        return select({
            select2Opts: MetricsSelectorService.select2Options({
                             placeholder: TapStrings.searchAndSelect,
                             urlSuffix: "/agentGroups",
                             multiple: false,
                             getData: MetricsSelectorService.getAgentGroupL1Metadata
                         })
        });
    })
    .directive('metricsagentgroupl2select', function(MetricsSelectorService, TapStrings, select){
        return select({
            select2Opts: MetricsSelectorService.select2Options({
                             placeholder: TapStrings.searchAndSelect,
                             urlSuffix: "/agentGroups",
                             multiple: false,
                             getData: MetricsSelectorService.getAgentGroupL2Metadata
                         })
        });
    })
    .directive('metricsagentgroupl3select', function(MetricsSelectorService, TapStrings, select){
        return select({
            select2Opts: MetricsSelectorService.select2Options({
                             placeholder: TapStrings.searchAndSelect,
                             urlSuffix: "/agentGroups",
                             multiple: false,
                             getData: MetricsSelectorService.getAgentGroupL3Metadata
                         })
        });
    })
    .directive('metricsagentgroupl4select', function(MetricsSelectorService, TapStrings, select){
        return select({
            select2Opts: MetricsSelectorService.select2Options({
                             placeholder: TapStrings.searchAndSelect,
                             urlSuffix: "/agentGroups",
                             multiple: false,
                             getData: MetricsSelectorService.getAgentGroupL4Metadata
                         })
        });
    })
    .directive('metricsagentgroupl5select', function(MetricsSelectorService, TapStrings, select){
        return select({
            select2Opts: MetricsSelectorService.select2Options({
                             placeholder: TapStrings.searchAndSelect,
                             urlSuffix: "/agentGroups",
                             multiple: false,
                             getData: MetricsSelectorService.getAgentGroupL5Metadata
                         })
        });
    })
    .directive('metricsskillselect', function(MetricsSelectorService, TapStrings, select){
        return select({
            select2Opts: MetricsSelectorService.select2Options({
                             placeholder: TapStrings.searchForSkill,
                             urlSuffix: "/skills",
                             closeOnSelect: false
                         })
        });
    })
    .directive('metricssiteselect', function(MetricsSelectorService, TapStrings, select){
        return select({
            select2Opts: MetricsSelectorService.select2Options({
                             placeholder: TapStrings.searchForSite,
                             urlSuffix: "/callCenters"
                         })
        });
    })
    .directive('metricsownerselect', function(MetricsSelectorService, TapStrings, select){
        return select({
            select2Opts: MetricsSelectorService.select2Options({
                             placeholder: TapStrings.searchForOwner,
                             urlSuffix: "/owners"
                         })
        });
    })
    .directive('metricsteamselect', function(MetricsSelectorService, TapStrings, select){
        return select({
            select2Opts: MetricsSelectorService.select2Options({
                             placeholder: TapStrings.searchForTeam,
                             urlSuffix: "/teams"
                         })
        });
    })
    .directive('metricsprofileselect', function(MetricsSelectorService, TapStrings, select){
        return select({
            select2Opts: MetricsSelectorService.select2Options({
                             placeholder: TapStrings.searchForProfile,
                             urlSuffix: "/profiles",
                             closeOnSelect: false
                         })
        });
    })
    .directive('metricstimezoneselect', function(MetricsSelectorService, TapStrings, select){
        return select({
            select2Opts: MetricsSelectorService.select2Options({
                             placeholder: TapStrings.searchForTimezone,
                             urlSuffix: "/timezones",
                             allowClear: false
                         })
        });
    })

    .service('MetricsSelectorService', function($http, TapStrings){
        var agentGroupMetadataAllLevels = {level1:{}, level2:{}, level3:{}, level4:{}, level5:{}};

        var BASE_SEARCH_URL = "/metrics-selector-search";
        function initSelection(element, callback, urlSuffix){
            $http.get(document.requestPathPrefix + BASE_SEARCH_URL + urlSuffix, {
                dataType: 'json',
                params: {
                         name: "",
                         page: 0,
                         ids:  element.val()
                      }
            }).success(function(data) {
                var selectData;
                if (element.attr('multiple')) {
                    selectData = data.results;
                } else {
                    selectData = data.results.length > 0 ? data.results[0] : null;
                }

                callback(selectData);
            });
        };

        function setAgentGroupL1Metadata(levelArn, parentArn) {
            agentGroupMetadataAllLevels.level1 = {
                            levelArn: levelArn,
                            parentArn: parentArn
                        };
        }

        function getAgentGroupL1Metadata() {
            return agentGroupMetadataAllLevels.level1;
        }

        function setAgentGroupL2Metadata(levelArn, parentArn) {
            agentGroupMetadataAllLevels.level2 = {
                            levelArn: levelArn,
                            parentArn: parentArn
                        };
        }

        function getAgentGroupL2Metadata() {
            return agentGroupMetadataAllLevels.level2;
        }

        function setAgentGroupL3Metadata(levelArn, parentArn) {
            agentGroupMetadataAllLevels.level3 = {
                            levelArn: levelArn,
                            parentArn: parentArn
                        };
        }

        function getAgentGroupL3Metadata() {
            return agentGroupMetadataAllLevels.level3;
        }

        function setAgentGroupL4Metadata(levelArn, parentArn) {
            agentGroupMetadataAllLevels.level4 = {
                            levelArn: levelArn,
                            parentArn: parentArn
                        };
        }

        function getAgentGroupL4Metadata() {
            return agentGroupMetadataAllLevels.level4;
        }

        function setAgentGroupL5Metadata(levelArn, parentArn) {
            agentGroupMetadataAllLevels.level5 = {
                            levelArn: levelArn,
                            parentArn: parentArn
                        };
        }

        function getAgentGroupL5Metadata() {
            return agentGroupMetadataAllLevels.level5;
        }


        return {
            setAgentGroupL1Metadata: setAgentGroupL1Metadata,
            getAgentGroupL1Metadata: getAgentGroupL1Metadata,
            setAgentGroupL2Metadata: setAgentGroupL2Metadata,
            getAgentGroupL2Metadata: getAgentGroupL2Metadata,
            setAgentGroupL3Metadata: setAgentGroupL3Metadata,
            getAgentGroupL3Metadata: getAgentGroupL3Metadata,
            setAgentGroupL4Metadata: setAgentGroupL4Metadata,
            getAgentGroupL4Metadata: getAgentGroupL4Metadata,
            setAgentGroupL5Metadata: setAgentGroupL5Metadata,
            getAgentGroupL5Metadata: getAgentGroupL5Metadata,

            select2Options: function(options){
                options = angular.extend({
                    minimumInputLength: 0,
                    allowClear: true
                }, options);
                return {
                    minimumInputLength: options.minimumInputLength,
                    initSelection: function(element, callback){
                        initSelection(element, callback, options.urlSuffix);
                    },
                    allowClear: options.allowClear,
                    placeholder: options.placeholder,
                    multiple: options.multiple,
                    closeOnSelect: options.closeOnSelect,
                    ajax: {
                        url: document.requestPathPrefix + BASE_SEARCH_URL + options.urlSuffix,
                        dataType: 'json',
                        quietMillis: 300,
                        data: function(term, page) {
                            if (options.getData) {
                                var levelArnAndParentArn = options.getData();
                                return {
                                    name: term,
                                    page: page-1,
                                    levelArn: levelArnAndParentArn.levelArn,
                                    parentArn: levelArnAndParentArn.parentArn
                                };
                            }
                            return {name: term, page: page - 1};
                        },
                        results: function(data, page) {
                            return data;
                        }
                    }
                };
            }
        };
    }
);

/** dir-btn-group.js
  * Directive for creating twitter bootstrap style button groups
  * author dzlier 08/19/2014
  */
function btnGroup(){
    return {
        require: "?ngModel",
        restrict: "AE",
        replace: "true",
        scope: {
            btnClass: "@",
            disabled: "=",
            ngModel: "=",
            options: "="
        },
        template: '<div class="btn-group">' +
                  '  <button class="{{getBtnClass(option)}}" ng-repeat="option in options"' +
                  '    ng-disabled="option==disabled" ng-click="select(option)">{{option.text || option.name || option}}</button>' +
                  '</div>',
        link: function(scope, elem, attr, ngModel){
            scope.btnClassOb = {
                'btn-primary': 'ngModel == option'
            };
            if(scope.btnClass){
                scope.btnClassOb[scope.btnClass] = true;
            }
            scope.getBtnClass = function(option){
                var classes = [
                    'btn',
                    'btn-default'
                ];
                if(scope.btnClass){
                    classes.push(scope.btnClass);
                }
                if(scope.ngModel == option && scope.disabled != option){
                    classes.push('btn-primary');
                }
                return classes.join(' ');
            };
            scope.select = function(option){
                scope.ngModel = option;
            };
        }
    };
}

angular.module("BtnGroup", []).directive("btnGroup", btnGroup);
/** dir-key-enter.js
    attribute directive to run a function when Enter is clicked within a given element
    author: dzlier
 **/
var enums = enums || {
    keyboard: {}
};
function keyEnter(){
    return {
        restrict: "A",
        link: function(scope, elem, attrs){
            function keyEnter(){
                scope.$eval(attrs.keyEnter);
            }
            elem.on('keydown', function(e){
                if(e.keyCode == enums.keyboard.ENTER){
                    keyEnter();
                    scope.$apply();
                }
            });
        }
    };
}
function keyEsc(){
    return {
        restrict: "A",
        link: function(scope, elem, attrs){
            function keyEsc(){
                scope.$eval(attrs.keyEsc);
            }
            elem.on('keydown', function(e){
                if(e.keyCode == enums.keyboard.ESCAPE){
                    keyEsc();
                    scope.$apply();
                }
            });
        }
    };
}
angular.module('KeyEvent', []).directive("keyEnter", keyEnter).directive("keyEsc", keyEsc);
/**
 * dir-select-click.js
 * directive for inputs to select all text when first clicked
 **/
function selectClick(){
    return {
        restrict: "A",
        link: function(scope, elem, attr){
            elem.on('click', function(){
                this.select();
            });
            elem.on('keydown', function(e){
                if(e.keyCode == 65 && e.ctrlKey){
                    e.preventDefault();
                    this.select();
                }
            });
        }
    };
}
angular.module('SelectClick', []).directive('selectClick', selectClick);
/** span-input.js
 *  directive for a span that switches to input and back when clicked, with key-enter and key-esc support
 */

function spanInput() {
    return {
        replace: true,
        restrict: 'AE',
        scope: {
            text: '=',
            onOpen: '&',
            onClose: '&'
        },
        templateUrl:'metrics-table-title.html',
        link: function (scope, elem, attr){
            scope.showTooltip = false;
            elem.on('mouseover', function () {
                var textBody = elem.find('.title-long-text')[0];
                scope.showTooltip = textBody.offsetWidth < textBody.scrollWidth;
            });
            function onSpanClick($event){
                elem.find('#span-input').select();
            }
            if(typeof scope.onOpen == 'undefined'){
                scope.onOpen = function(){};
            }
            if(typeof scope.onClose == 'undefined'){
                scope.onClose = function(){};
            }
            elem.click(onSpanClick);
            function openEdit(){
                scope.onOpen();
                scope.newText = scope.text;
                scope.edit = true;
            }
            function closeEdit(save){
                scope.onClose();
                scope.text = save ? (scope.newText || scope.text) : scope.text;
                scope.edit = false;
            }
            angular.extend(scope, {
                closeEdit:   closeEdit,
                openEdit:    openEdit
            });

            scope.$on("$destroy", function() {
                elem.off();
                elem.children().off();
                elem.remove();
            });
        }
    };
}

angular.module('SpanInput', ['res.constants']).directive('spanInput', spanInput);
/** dir-toggler.js
    directive for a simple click toggler
    author: dzlier
 **/
function toggler() {
    return {
        template:
            '<div class="toggler" ng-click="toggler = !toggler; expand()">'              +
            '    <i ng-class="{                                           '              +
            '                \'icon-chevron-down\': iconReversed ? !toggler : toggler, ' +
            '                \'icon-chevron-right\':iconReversed ? toggler : !toggler  ' +
            '            }"></i>                                          ' +
            '    <a ng-if="text && link" href="{{link}}" target="_self">  ' +
            '        {{text}}                                             ' +
            '    </a>                                                     ' +
            '    <span ng-if="text && !link">{{text}}</span>              ' +
            '</div>',
        scope: {
            toggler: "=",
            onExpand: "&",
            text: "=",
            link: "="
        },
        restrict:"EA",
        link: function (scope, el, attrs) {
            scope.iconReversed = attrs.iconReversed;
        }
    };
}
angular.module('Toggler', []).directive("toggler", toggler);
/**
  * Service to provide default English strings to angular modules
  * Modules may edit config value "TapStrings' to include overrides:
  **  myAppModule.run(['TapStrings', function(TapStrings) {
  **      angular.extend(TapStrings, LOCAL_OVERRIDE_MAP);
  **  }]);
  */

angular.module("tap.strings", [])
    .value('TapStrings', {
        /* selector placeholders */
        searchForPrompts: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-prompts'],
        searchForEntryPoints: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-phone-number'],
        searchForSkill: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-skill'],
        searchForSite: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-site'],
        searchForOwner: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-owner'],
        searchForTeam: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-team'],
        searchForProfile: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-profile'],
        searchForTimezone: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-timezone'],
        searchForSecurityProfile: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-security-profile'],
        searchForQuickConnects: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-quick-connects'],
        searchForHoop: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-hoop'],
        searchForClaimedPhoneNumbers: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-claimed-phone-numbers'],
        searchForHoursOfOperation: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-hours-of-operation'],
        searchForCallFlow: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-call-flow'],
        searchForAgents: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-agents'],
        searchForGroups: window.localizedStrings['selectors-js']['lily-admin-selector-search-for-groups'],
        searchAndSelect: window.localizedStrings['selectors-js']['lily-admin-selector-search-and-select'],
        search: window.localizedStrings['selectors-js']['lily-admin-selector-search'],
        loadMore: window.localizedStrings['selectors-js']['lily-admin-selector-load-more-data'],
        selectAnalyticsLanguage: window.localizedStrings['selectors-js']['lily-admin-selector-analytics-language']
    });

angular.module("Lily.MaximumLengthDirective", [])
  .directive('maxLength', function() {
     return {
     require: 'ngModel',
     link: function (scope, element, attrs, ngModelCtrl) {
        var maxlength = Number(attrs.maxLength);
        function userInput(text) {
           ngModelCtrl.$setValidity('unique', text !== "" && text.length <= maxlength);
           return text;
        }
        ngModelCtrl.$parsers.push(userInput);
    }
  };
});
angular.module('PageHeaderModule', [])
.controller("PageHeaderController", function($scope, $window, $location) {
    angular.extend($scope, {
        initialize: function(isLawlessContactFlowsEnabled) {
            $scope.pageHeadersToNotShow = [
                document.requestPathPrefix + '/contact-flows/edit',
                document.requestPathPrefix + '/users-v2',
                document.requestPathPrefix + '/contact-flows/view',
                document.requestPathPrefix + '/contact-flows/create',
                document.requestPathPrefix + '/flow-modules/create'
            ];
            // We don't show the common main page header if contact flows is loaded
            // "lawless" via web component as the header will part of the web component itself
            if (isLawlessContactFlowsEnabled === true) {
                $scope.pageHeadersToNotShow.push(document.requestPathPrefix + '/contact-flows');
            }
        },
        initializeHeader: function(header) {
            return !_.contains($scope.pageHeadersToNotShow, location.pathname);
        }
    });
});

}
/**
 * @license
 * lodash 3.10.1 (Custom Build) lodash.com/license | Underscore.js 1.8.3 underscorejs.org/LICENSE
 * Build: `lodash modern -o ./lodash.js`
 */
;(function(){function n(n,t){if(n!==t){var r=null===n,e=n===w,u=n===n,o=null===t,i=t===w,f=t===t;if(n>t&&!o||!u||r&&!i&&f||e&&f)return 1;if(n<t&&!r||!f||o&&!e&&u||i&&u)return-1}return 0}function t(n,t,r){for(var e=n.length,u=r?e:-1;r?u--:++u<e;)if(t(n[u],u,n))return u;return-1}function r(n,t,r){if(t!==t)return p(n,r);r-=1;for(var e=n.length;++r<e;)if(n[r]===t)return r;return-1}function e(n){return typeof n=="function"||false}function u(n){return null==n?"":n+""}function o(n,t){for(var r=-1,e=n.length;++r<e&&-1<t.indexOf(n.charAt(r)););
return r}function i(n,t){for(var r=n.length;r--&&-1<t.indexOf(n.charAt(r)););return r}function f(t,r){return n(t.a,r.a)||t.b-r.b}function a(n){return Nn[n]}function c(n){return Tn[n]}function l(n,t,r){return t?n=Bn[n]:r&&(n=Dn[n]),"\\"+n}function s(n){return"\\"+Dn[n]}function p(n,t,r){var e=n.length;for(t+=r?0:-1;r?t--:++t<e;){var u=n[t];if(u!==u)return t}return-1}function h(n){return!!n&&typeof n=="object"}function _(n){return 160>=n&&9<=n&&13>=n||32==n||160==n||5760==n||6158==n||8192<=n&&(8202>=n||8232==n||8233==n||8239==n||8287==n||12288==n||65279==n);
}function v(n,t){for(var r=-1,e=n.length,u=-1,o=[];++r<e;)n[r]===t&&(n[r]=z,o[++u]=r);return o}function g(n){for(var t=-1,r=n.length;++t<r&&_(n.charCodeAt(t)););return t}function y(n){for(var t=n.length;t--&&_(n.charCodeAt(t)););return t}function d(n){return Ln[n]}function m(_){function Nn(n){if(h(n)&&!(Oo(n)||n instanceof zn)){if(n instanceof Ln)return n;if(nu.call(n,"__chain__")&&nu.call(n,"__wrapped__"))return Mr(n)}return new Ln(n)}function Tn(){}function Ln(n,t,r){this.__wrapped__=n,this.__actions__=r||[],
this.__chain__=!!t}function zn(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=false,this.__iteratees__=[],this.__takeCount__=Ru,this.__views__=[]}function Bn(){this.__data__={}}function Dn(n){var t=n?n.length:0;for(this.data={hash:gu(null),set:new lu};t--;)this.push(n[t])}function Mn(n,t){var r=n.data;return(typeof t=="string"||ge(t)?r.set.has(t):r.hash[t])?0:-1}function qn(n,t){var r=-1,e=n.length;for(t||(t=Be(e));++r<e;)t[r]=n[r];return t}function Pn(n,t){for(var r=-1,e=n.length;++r<e&&false!==t(n[r],r,n););
return n}function Kn(n,t){for(var r=-1,e=n.length;++r<e;)if(!t(n[r],r,n))return false;return true}function Vn(n,t){for(var r=-1,e=n.length,u=-1,o=[];++r<e;){var i=n[r];t(i,r,n)&&(o[++u]=i)}return o}function Gn(n,t){for(var r=-1,e=n.length,u=Be(e);++r<e;)u[r]=t(n[r],r,n);return u}function Jn(n,t){for(var r=-1,e=t.length,u=n.length;++r<e;)n[u+r]=t[r];return n}function Xn(n,t,r,e){var u=-1,o=n.length;for(e&&o&&(r=n[++u]);++u<o;)r=t(r,n[u],u,n);return r}function Hn(n,t){for(var r=-1,e=n.length;++r<e;)if(t(n[r],r,n))return true;
return false}function Qn(n,t,r,e){return n!==w&&nu.call(e,r)?n:t}function nt(n,t,r){for(var e=-1,u=zo(t),o=u.length;++e<o;){var i=u[e],f=n[i],a=r(f,t[i],i,n,t);(a===a?a===f:f!==f)&&(f!==w||i in n)||(n[i]=a)}return n}function tt(n,t){return null==t?n:et(t,zo(t),n)}function rt(n,t){for(var r=-1,e=null==n,u=!e&&Er(n),o=u?n.length:0,i=t.length,f=Be(i);++r<i;){var a=t[r];f[r]=u?Cr(a,o)?n[a]:w:e?w:n[a]}return f}function et(n,t,r){r||(r={});for(var e=-1,u=t.length;++e<u;){var o=t[e];r[o]=n[o]}return r}function ut(n,t,r){
var e=typeof n;return"function"==e?t===w?n:Bt(n,t,r):null==n?Fe:"object"==e?bt(n):t===w?ze(n):xt(n,t)}function ot(n,t,r,e,u,o,i){var f;if(r&&(f=u?r(n,e,u):r(n)),f!==w)return f;if(!ge(n))return n;if(e=Oo(n)){if(f=kr(n),!t)return qn(n,f)}else{var a=ru.call(n),c=a==K;if(a!=Z&&a!=B&&(!c||u))return Fn[a]?Rr(n,a,t):u?n:{};if(f=Ir(c?{}:n),!t)return tt(f,n)}for(o||(o=[]),i||(i=[]),u=o.length;u--;)if(o[u]==n)return i[u];return o.push(n),i.push(f),(e?Pn:_t)(n,function(e,u){f[u]=ot(e,t,r,u,n,o,i)}),f}function it(n,t,r){
if(typeof n!="function")throw new Ge(L);return su(function(){n.apply(w,r)},t)}function ft(n,t){var e=n?n.length:0,u=[];if(!e)return u;var o=-1,i=xr(),f=i===r,a=f&&t.length>=F&&gu&&lu?new Dn(t):null,c=t.length;a&&(i=Mn,f=false,t=a);n:for(;++o<e;)if(a=n[o],f&&a===a){for(var l=c;l--;)if(t[l]===a)continue n;u.push(a)}else 0>i(t,a,0)&&u.push(a);return u}function at(n,t){var r=true;return Su(n,function(n,e,u){return r=!!t(n,e,u)}),r}function ct(n,t,r,e){var u=e,o=u;return Su(n,function(n,i,f){i=+t(n,i,f),(r(i,u)||i===e&&i===o)&&(u=i,
o=n)}),o}function lt(n,t){var r=[];return Su(n,function(n,e,u){t(n,e,u)&&r.push(n)}),r}function st(n,t,r,e){var u;return r(n,function(n,r,o){return t(n,r,o)?(u=e?r:n,false):void 0}),u}function pt(n,t,r,e){e||(e=[]);for(var u=-1,o=n.length;++u<o;){var i=n[u];h(i)&&Er(i)&&(r||Oo(i)||pe(i))?t?pt(i,t,r,e):Jn(e,i):r||(e[e.length]=i)}return e}function ht(n,t){Nu(n,t,Re)}function _t(n,t){return Nu(n,t,zo)}function vt(n,t){return Tu(n,t,zo)}function gt(n,t){for(var r=-1,e=t.length,u=-1,o=[];++r<e;){var i=t[r];
ve(n[i])&&(o[++u]=i)}return o}function yt(n,t,r){if(null!=n){r!==w&&r in Br(n)&&(t=[r]),r=0;for(var e=t.length;null!=n&&r<e;)n=n[t[r++]];return r&&r==e?n:w}}function dt(n,t,r,e,u,o){if(n===t)n=true;else if(null==n||null==t||!ge(n)&&!h(t))n=n!==n&&t!==t;else n:{var i=dt,f=Oo(n),a=Oo(t),c=D,l=D;f||(c=ru.call(n),c==B?c=Z:c!=Z&&(f=xe(n))),a||(l=ru.call(t),l==B?l=Z:l!=Z&&xe(t));var s=c==Z,a=l==Z,l=c==l;if(!l||f||s){if(!e&&(c=s&&nu.call(n,"__wrapped__"),a=a&&nu.call(t,"__wrapped__"),c||a)){n=i(c?n.value():n,a?t.value():t,r,e,u,o);
break n}if(l){for(u||(u=[]),o||(o=[]),c=u.length;c--;)if(u[c]==n){n=o[c]==t;break n}u.push(n),o.push(t),n=(f?yr:mr)(n,t,i,r,e,u,o),u.pop(),o.pop()}else n=false}else n=dr(n,t,c)}return n}function mt(n,t,r){var e=t.length,u=e,o=!r;if(null==n)return!u;for(n=Br(n);e--;){var i=t[e];if(o&&i[2]?i[1]!==n[i[0]]:!(i[0]in n))return false}for(;++e<u;){var i=t[e],f=i[0],a=n[f],c=i[1];if(o&&i[2]){if(a===w&&!(f in n))return false}else if(i=r?r(a,c,f):w,i===w?!dt(c,a,r,true):!i)return false}return true}function wt(n,t){var r=-1,e=Er(n)?Be(n.length):[];
return Su(n,function(n,u,o){e[++r]=t(n,u,o)}),e}function bt(n){var t=Ar(n);if(1==t.length&&t[0][2]){var r=t[0][0],e=t[0][1];return function(n){return null==n?false:n[r]===e&&(e!==w||r in Br(n))}}return function(n){return mt(n,t)}}function xt(n,t){var r=Oo(n),e=Wr(n)&&t===t&&!ge(t),u=n+"";return n=Dr(n),function(o){if(null==o)return false;var i=u;if(o=Br(o),!(!r&&e||i in o)){if(o=1==n.length?o:yt(o,Et(n,0,-1)),null==o)return false;i=Zr(n),o=Br(o)}return o[i]===t?t!==w||i in o:dt(t,o[i],w,true)}}function At(n,t,r,e,u){
if(!ge(n))return n;var o=Er(t)&&(Oo(t)||xe(t)),i=o?w:zo(t);return Pn(i||t,function(f,a){if(i&&(a=f,f=t[a]),h(f)){e||(e=[]),u||(u=[]);n:{for(var c=a,l=e,s=u,p=l.length,_=t[c];p--;)if(l[p]==_){n[c]=s[p];break n}var p=n[c],v=r?r(p,_,c,n,t):w,g=v===w;g&&(v=_,Er(_)&&(Oo(_)||xe(_))?v=Oo(p)?p:Er(p)?qn(p):[]:me(_)||pe(_)?v=pe(p)?ke(p):me(p)?p:{}:g=false),l.push(_),s.push(v),g?n[c]=At(v,_,r,l,s):(v===v?v!==p:p===p)&&(n[c]=v)}}else c=n[a],l=r?r(c,f,a,n,t):w,(s=l===w)&&(l=f),l===w&&(!o||a in n)||!s&&(l===l?l===c:c!==c)||(n[a]=l);
}),n}function jt(n){return function(t){return null==t?w:t[n]}}function kt(n){var t=n+"";return n=Dr(n),function(r){return yt(r,n,t)}}function It(n,t){for(var r=n?t.length:0;r--;){var e=t[r];if(e!=u&&Cr(e)){var u=e;pu.call(n,e,1)}}}function Rt(n,t){return n+yu(ku()*(t-n+1))}function Ot(n,t,r,e,u){return u(n,function(n,u,o){r=e?(e=false,n):t(r,n,u,o)}),r}function Et(n,t,r){var e=-1,u=n.length;for(t=null==t?0:+t||0,0>t&&(t=-t>u?0:u+t),r=r===w||r>u?u:+r||0,0>r&&(r+=u),u=t>r?0:r-t>>>0,t>>>=0,r=Be(u);++e<u;)r[e]=n[e+t];
return r}function Ct(n,t){var r;return Su(n,function(n,e,u){return r=t(n,e,u),!r}),!!r}function Ut(n,t){var r=n.length;for(n.sort(t);r--;)n[r]=n[r].c;return n}function Wt(t,r,e){var u=wr(),o=-1;return r=Gn(r,function(n){return u(n)}),t=wt(t,function(n){return{a:Gn(r,function(t){return t(n)}),b:++o,c:n}}),Ut(t,function(t,r){var u;n:{for(var o=-1,i=t.a,f=r.a,a=i.length,c=e.length;++o<a;)if(u=n(i[o],f[o])){if(o>=c)break n;o=e[o],u*="asc"===o||true===o?1:-1;break n}u=t.b-r.b}return u})}function $t(n,t){
var r=0;return Su(n,function(n,e,u){r+=+t(n,e,u)||0}),r}function St(n,t){var e=-1,u=xr(),o=n.length,i=u===r,f=i&&o>=F,a=f&&gu&&lu?new Dn(void 0):null,c=[];a?(u=Mn,i=false):(f=false,a=t?[]:c);n:for(;++e<o;){var l=n[e],s=t?t(l,e,n):l;if(i&&l===l){for(var p=a.length;p--;)if(a[p]===s)continue n;t&&a.push(s),c.push(l)}else 0>u(a,s,0)&&((t||f)&&a.push(s),c.push(l))}return c}function Ft(n,t){for(var r=-1,e=t.length,u=Be(e);++r<e;)u[r]=n[t[r]];return u}function Nt(n,t,r,e){for(var u=n.length,o=e?u:-1;(e?o--:++o<u)&&t(n[o],o,n););
return r?Et(n,e?0:o,e?o+1:u):Et(n,e?o+1:0,e?u:o)}function Tt(n,t){var r=n;r instanceof zn&&(r=r.value());for(var e=-1,u=t.length;++e<u;)var o=t[e],r=o.func.apply(o.thisArg,Jn([r],o.args));return r}function Lt(n,t,r){var e=0,u=n?n.length:e;if(typeof t=="number"&&t===t&&u<=Eu){for(;e<u;){var o=e+u>>>1,i=n[o];(r?i<=t:i<t)&&null!==i?e=o+1:u=o}return u}return zt(n,t,Fe,r)}function zt(n,t,r,e){t=r(t);for(var u=0,o=n?n.length:0,i=t!==t,f=null===t,a=t===w;u<o;){var c=yu((u+o)/2),l=r(n[c]),s=l!==w,p=l===l;
(i?p||e:f?p&&s&&(e||null!=l):a?p&&(e||s):null==l?0:e?l<=t:l<t)?u=c+1:o=c}return xu(o,Ou)}function Bt(n,t,r){if(typeof n!="function")return Fe;if(t===w)return n;switch(r){case 1:return function(r){return n.call(t,r)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,o){return n.call(t,r,e,u,o)};case 5:return function(r,e,u,o,i){return n.call(t,r,e,u,o,i)}}return function(){return n.apply(t,arguments)}}function Dt(n){var t=new ou(n.byteLength);return new hu(t).set(new hu(n)),
t}function Mt(n,t,r){for(var e=r.length,u=-1,o=bu(n.length-e,0),i=-1,f=t.length,a=Be(f+o);++i<f;)a[i]=t[i];for(;++u<e;)a[r[u]]=n[u];for(;o--;)a[i++]=n[u++];return a}function qt(n,t,r){for(var e=-1,u=r.length,o=-1,i=bu(n.length-u,0),f=-1,a=t.length,c=Be(i+a);++o<i;)c[o]=n[o];for(i=o;++f<a;)c[i+f]=t[f];for(;++e<u;)c[i+r[e]]=n[o++];return c}function Pt(n,t){return function(r,e,u){var o=t?t():{};if(e=wr(e,u,3),Oo(r)){u=-1;for(var i=r.length;++u<i;){var f=r[u];n(o,f,e(f,u,r),r)}}else Su(r,function(t,r,u){
n(o,t,e(t,r,u),u)});return o}}function Kt(n){return le(function(t,r){var e=-1,u=null==t?0:r.length,o=2<u?r[u-2]:w,i=2<u?r[2]:w,f=1<u?r[u-1]:w;for(typeof o=="function"?(o=Bt(o,f,5),u-=2):(o=typeof f=="function"?f:w,u-=o?1:0),i&&Ur(r[0],r[1],i)&&(o=3>u?w:o,u=1);++e<u;)(i=r[e])&&n(t,i,o);return t})}function Vt(n,t){return function(r,e){var u=r?Bu(r):0;if(!Sr(u))return n(r,e);for(var o=t?u:-1,i=Br(r);(t?o--:++o<u)&&false!==e(i[o],o,i););return r}}function Zt(n){return function(t,r,e){var u=Br(t);e=e(t);for(var o=e.length,i=n?o:-1;n?i--:++i<o;){
var f=e[i];if(false===r(u[f],f,u))break}return t}}function Yt(n,t){function r(){return(this&&this!==Zn&&this instanceof r?e:n).apply(t,arguments)}var e=Jt(n);return r}function Gt(n){return function(t){var r=-1;t=$e(Ce(t));for(var e=t.length,u="";++r<e;)u=n(u,t[r],r);return u}}function Jt(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:
return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=$u(n.prototype),t=n.apply(r,t);return ge(t)?t:r}}function Xt(n){function t(r,e,u){return u&&Ur(r,e,u)&&(e=w),r=gr(r,n,w,w,w,w,w,e),r.placeholder=t.placeholder,r}return t}function Ht(n,t){return le(function(r){var e=r[0];return null==e?e:(r.push(t),n.apply(w,r))})}function Qt(n,t){return function(r,e,u){if(u&&Ur(r,e,u)&&(e=w),e=wr(e,u,3),1==e.length){
u=r=Oo(r)?r:zr(r);for(var o=e,i=-1,f=u.length,a=t,c=a;++i<f;){var l=u[i],s=+o(l);n(s,a)&&(a=s,c=l)}if(u=c,!r.length||u!==t)return u}return ct(r,e,n,t)}}function nr(n,r){return function(e,u,o){return u=wr(u,o,3),Oo(e)?(u=t(e,u,r),-1<u?e[u]:w):st(e,u,n)}}function tr(n){return function(r,e,u){return r&&r.length?(e=wr(e,u,3),t(r,e,n)):-1}}function rr(n){return function(t,r,e){return r=wr(r,e,3),st(t,r,n,true)}}function er(n){return function(){for(var t,r=arguments.length,e=n?r:-1,u=0,o=Be(r);n?e--:++e<r;){
var i=o[u++]=arguments[e];if(typeof i!="function")throw new Ge(L);!t&&Ln.prototype.thru&&"wrapper"==br(i)&&(t=new Ln([],true))}for(e=t?-1:r;++e<r;){var i=o[e],u=br(i),f="wrapper"==u?zu(i):w;t=f&&$r(f[0])&&f[1]==(E|k|R|C)&&!f[4].length&&1==f[9]?t[br(f[0])].apply(t,f[3]):1==i.length&&$r(i)?t[u]():t.thru(i)}return function(){var n=arguments,e=n[0];if(t&&1==n.length&&Oo(e)&&e.length>=F)return t.plant(e).value();for(var u=0,n=r?o[u].apply(this,n):e;++u<r;)n=o[u].call(this,n);return n}}}function ur(n,t){
return function(r,e,u){return typeof e=="function"&&u===w&&Oo(r)?n(r,e):t(r,Bt(e,u,3))}}function or(n){return function(t,r,e){return(typeof r!="function"||e!==w)&&(r=Bt(r,e,3)),n(t,r,Re)}}function ir(n){return function(t,r,e){return(typeof r!="function"||e!==w)&&(r=Bt(r,e,3)),n(t,r)}}function fr(n){return function(t,r,e){var u={};return r=wr(r,e,3),_t(t,function(t,e,o){o=r(t,e,o),e=n?o:e,t=n?t:o,u[e]=t}),u}}function ar(n){return function(t,r,e){return t=u(t),(n?t:"")+pr(t,r,e)+(n?"":t)}}function cr(n){
var t=le(function(r,e){var u=v(e,t.placeholder);return gr(r,n,w,e,u)});return t}function lr(n,t){return function(r,e,u,o){var i=3>arguments.length;return typeof e=="function"&&o===w&&Oo(r)?n(r,e,u,i):Ot(r,wr(e,o,4),u,i,t)}}function sr(n,t,r,e,u,o,i,f,a,c){function l(){for(var m=arguments.length,b=m,j=Be(m);b--;)j[b]=arguments[b];if(e&&(j=Mt(j,e,u)),o&&(j=qt(j,o,i)),_||y){var b=l.placeholder,k=v(j,b),m=m-k.length;if(m<c){var I=f?qn(f):w,m=bu(c-m,0),E=_?k:w,k=_?w:k,C=_?j:w,j=_?w:j;return t|=_?R:O,t&=~(_?O:R),
g||(t&=~(x|A)),j=[n,t,r,C,E,j,k,I,a,m],I=sr.apply(w,j),$r(n)&&Du(I,j),I.placeholder=b,I}}if(b=p?r:this,I=h?b[n]:n,f)for(m=j.length,E=xu(f.length,m),k=qn(j);E--;)C=f[E],j[E]=Cr(C,m)?k[C]:w;return s&&a<j.length&&(j.length=a),this&&this!==Zn&&this instanceof l&&(I=d||Jt(n)),I.apply(b,j)}var s=t&E,p=t&x,h=t&A,_=t&k,g=t&j,y=t&I,d=h?w:Jt(n);return l}function pr(n,t,r){return n=n.length,t=+t,n<t&&mu(t)?(t-=n,r=null==r?" ":r+"",Ue(r,vu(t/r.length)).slice(0,t)):""}function hr(n,t,r,e){function u(){for(var t=-1,f=arguments.length,a=-1,c=e.length,l=Be(c+f);++a<c;)l[a]=e[a];
for(;f--;)l[a++]=arguments[++t];return(this&&this!==Zn&&this instanceof u?i:n).apply(o?r:this,l)}var o=t&x,i=Jt(n);return u}function _r(n){var t=Pe[n];return function(n,r){return(r=r===w?0:+r||0)?(r=au(10,r),t(n*r)/r):t(n)}}function vr(n){return function(t,r,e,u){var o=wr(e);return null==e&&o===ut?Lt(t,r,n):zt(t,r,o(e,u,1),n)}}function gr(n,t,r,e,u,o,i,f){var a=t&A;if(!a&&typeof n!="function")throw new Ge(L);var c=e?e.length:0;if(c||(t&=~(R|O),e=u=w),c-=u?u.length:0,t&O){var l=e,s=u;e=u=w}var p=a?w:zu(n);
return r=[n,t,r,e,u,l,s,o,i,f],p&&(e=r[1],t=p[1],f=e|t,u=t==E&&e==k||t==E&&e==C&&r[7].length<=p[8]||t==(E|C)&&e==k,(f<E||u)&&(t&x&&(r[2]=p[2],f|=e&x?0:j),(e=p[3])&&(u=r[3],r[3]=u?Mt(u,e,p[4]):qn(e),r[4]=u?v(r[3],z):qn(p[4])),(e=p[5])&&(u=r[5],r[5]=u?qt(u,e,p[6]):qn(e),r[6]=u?v(r[5],z):qn(p[6])),(e=p[7])&&(r[7]=qn(e)),t&E&&(r[8]=null==r[8]?p[8]:xu(r[8],p[8])),null==r[9]&&(r[9]=p[9]),r[0]=p[0],r[1]=f),t=r[1],f=r[9]),r[9]=null==f?a?0:n.length:bu(f-c,0)||0,(p?Lu:Du)(t==x?Yt(r[0],r[2]):t!=R&&t!=(x|R)||r[4].length?sr.apply(w,r):hr.apply(w,r),r);
}function yr(n,t,r,e,u,o,i){var f=-1,a=n.length,c=t.length;if(a!=c&&(!u||c<=a))return false;for(;++f<a;){var l=n[f],c=t[f],s=e?e(u?c:l,u?l:c,f):w;if(s!==w){if(s)continue;return false}if(u){if(!Hn(t,function(n){return l===n||r(l,n,e,u,o,i)}))return false}else if(l!==c&&!r(l,c,e,u,o,i))return false}return true}function dr(n,t,r){switch(r){case M:case q:return+n==+t;case P:return n.name==t.name&&n.message==t.message;case V:return n!=+n?t!=+t:n==+t;case Y:case G:return n==t+""}return false}function mr(n,t,r,e,u,o,i){var f=zo(n),a=f.length,c=zo(t).length;
if(a!=c&&!u)return false;for(c=a;c--;){var l=f[c];if(!(u?l in t:nu.call(t,l)))return false}for(var s=u;++c<a;){var l=f[c],p=n[l],h=t[l],_=e?e(u?h:p,u?p:h,l):w;if(_===w?!r(p,h,e,u,o,i):!_)return false;s||(s="constructor"==l)}return s||(r=n.constructor,e=t.constructor,!(r!=e&&"constructor"in n&&"constructor"in t)||typeof r=="function"&&r instanceof r&&typeof e=="function"&&e instanceof e)?true:false}function wr(n,t,r){var e=Nn.callback||Se,e=e===Se?ut:e;return r?e(n,t,r):e}function br(n){for(var t=n.name+"",r=Wu[t],e=r?r.length:0;e--;){
var u=r[e],o=u.func;if(null==o||o==n)return u.name}return t}function xr(n,t,e){var u=Nn.indexOf||Vr,u=u===Vr?r:u;return n?u(n,t,e):u}function Ar(n){n=Oe(n);for(var t=n.length;t--;){var r=n[t][1];n[t][2]=r===r&&!ge(r)}return n}function jr(n,t){var r=null==n?w:n[t];return ye(r)?r:w}function kr(n){var t=n.length,r=new n.constructor(t);return t&&"string"==typeof n[0]&&nu.call(n,"index")&&(r.index=n.index,r.input=n.input),r}function Ir(n){return n=n.constructor,typeof n=="function"&&n instanceof n||(n=Ve),
new n}function Rr(n,t,r){var e=n.constructor;switch(t){case J:return Dt(n);case M:case q:return new e(+n);case X:case H:case Q:case nn:case tn:case rn:case en:case un:case on:return t=n.buffer,new e(r?Dt(t):t,n.byteOffset,n.length);case V:case G:return new e(n);case Y:var u=new e(n.source,kn.exec(n));u.lastIndex=n.lastIndex}return u}function Or(n,t,r){return null==n||Wr(t,n)||(t=Dr(t),n=1==t.length?n:yt(n,Et(t,0,-1)),t=Zr(t)),t=null==n?n:n[t],null==t?w:t.apply(n,r)}function Er(n){return null!=n&&Sr(Bu(n));
}function Cr(n,t){return n=typeof n=="number"||On.test(n)?+n:-1,t=null==t?Cu:t,-1<n&&0==n%1&&n<t}function Ur(n,t,r){if(!ge(r))return false;var e=typeof t;return("number"==e?Er(r)&&Cr(t,r.length):"string"==e&&t in r)?(t=r[t],n===n?n===t:t!==t):false}function Wr(n,t){var r=typeof n;return"string"==r&&dn.test(n)||"number"==r?true:Oo(n)?false:!yn.test(n)||null!=t&&n in Br(t)}function $r(n){var t=br(n),r=Nn[t];return typeof r=="function"&&t in zn.prototype?n===r?true:(t=zu(r),!!t&&n===t[0]):false}function Sr(n){return typeof n=="number"&&-1<n&&0==n%1&&n<=Cu;
}function Fr(n,t){return n===w?t:Eo(n,t,Fr)}function Nr(n,t){n=Br(n);for(var r=-1,e=t.length,u={};++r<e;){var o=t[r];o in n&&(u[o]=n[o])}return u}function Tr(n,t){var r={};return ht(n,function(n,e,u){t(n,e,u)&&(r[e]=n)}),r}function Lr(n){for(var t=Re(n),r=t.length,e=r&&n.length,u=!!e&&Sr(e)&&(Oo(n)||pe(n)),o=-1,i=[];++o<r;){var f=t[o];(u&&Cr(f,e)||nu.call(n,f))&&i.push(f)}return i}function zr(n){return null==n?[]:Er(n)?ge(n)?n:Ve(n):Ee(n)}function Br(n){return ge(n)?n:Ve(n)}function Dr(n){if(Oo(n))return n;
var t=[];return u(n).replace(mn,function(n,r,e,u){t.push(e?u.replace(An,"$1"):r||n)}),t}function Mr(n){return n instanceof zn?n.clone():new Ln(n.__wrapped__,n.__chain__,qn(n.__actions__))}function qr(n,t,r){return n&&n.length?((r?Ur(n,t,r):null==t)&&(t=1),Et(n,0>t?0:t)):[]}function Pr(n,t,r){var e=n?n.length:0;return e?((r?Ur(n,t,r):null==t)&&(t=1),t=e-(+t||0),Et(n,0,0>t?0:t)):[]}function Kr(n){return n?n[0]:w}function Vr(n,t,e){var u=n?n.length:0;if(!u)return-1;if(typeof e=="number")e=0>e?bu(u+e,0):e;else if(e)return e=Lt(n,t),
e<u&&(t===t?t===n[e]:n[e]!==n[e])?e:-1;return r(n,t,e||0)}function Zr(n){var t=n?n.length:0;return t?n[t-1]:w}function Yr(n){return qr(n,1)}function Gr(n,t,e,u){if(!n||!n.length)return[];null!=t&&typeof t!="boolean"&&(u=e,e=Ur(n,t,u)?w:t,t=false);var o=wr();if((null!=e||o!==ut)&&(e=o(e,u,3)),t&&xr()===r){t=e;var i;e=-1,u=n.length;for(var o=-1,f=[];++e<u;){var a=n[e],c=t?t(a,e,n):a;e&&i===c||(i=c,f[++o]=a)}n=f}else n=St(n,e);return n}function Jr(n){if(!n||!n.length)return[];var t=-1,r=0;n=Vn(n,function(n){
return Er(n)?(r=bu(n.length,r),true):void 0});for(var e=Be(r);++t<r;)e[t]=Gn(n,jt(t));return e}function Xr(n,t,r){return n&&n.length?(n=Jr(n),null==t?n:(t=Bt(t,r,4),Gn(n,function(n){return Xn(n,t,w,true)}))):[]}function Hr(n,t){var r=-1,e=n?n.length:0,u={};for(!e||t||Oo(n[0])||(t=[]);++r<e;){var o=n[r];t?u[o]=t[r]:o&&(u[o[0]]=o[1])}return u}function Qr(n){return n=Nn(n),n.__chain__=true,n}function ne(n,t,r){return t.call(r,n)}function te(n,t,r){var e=Oo(n)?Kn:at;return r&&Ur(n,t,r)&&(t=w),(typeof t!="function"||r!==w)&&(t=wr(t,r,3)),
e(n,t)}function re(n,t,r){var e=Oo(n)?Vn:lt;return t=wr(t,r,3),e(n,t)}function ee(n,t,r,e){var u=n?Bu(n):0;return Sr(u)||(n=Ee(n),u=n.length),r=typeof r!="number"||e&&Ur(t,r,e)?0:0>r?bu(u+r,0):r||0,typeof n=="string"||!Oo(n)&&be(n)?r<=u&&-1<n.indexOf(t,r):!!u&&-1<xr(n,t,r)}function ue(n,t,r){var e=Oo(n)?Gn:wt;return t=wr(t,r,3),e(n,t)}function oe(n,t,r){if(r?Ur(n,t,r):null==t){n=zr(n);var e=n.length;return 0<e?n[Rt(0,e-1)]:w}r=-1,n=je(n);var e=n.length,u=e-1;for(t=xu(0>t?0:+t||0,e);++r<t;){var e=Rt(r,u),o=n[e];
n[e]=n[r],n[r]=o}return n.length=t,n}function ie(n,t,r){var e=Oo(n)?Hn:Ct;return r&&Ur(n,t,r)&&(t=w),(typeof t!="function"||r!==w)&&(t=wr(t,r,3)),e(n,t)}function fe(n,t){var r;if(typeof t!="function"){if(typeof n!="function")throw new Ge(L);var e=n;n=t,t=e}return function(){return 0<--n&&(r=t.apply(this,arguments)),1>=n&&(t=w),r}}function ae(n,t,r){function e(t,r){r&&iu(r),a=p=h=w,t&&(_=ho(),c=n.apply(s,f),p||a||(f=s=w))}function u(){var n=t-(ho()-l);0>=n||n>t?e(h,a):p=su(u,n)}function o(){e(g,p);
}function i(){if(f=arguments,l=ho(),s=this,h=g&&(p||!y),false===v)var r=y&&!p;else{a||y||(_=l);var e=v-(l-_),i=0>=e||e>v;i?(a&&(a=iu(a)),_=l,c=n.apply(s,f)):a||(a=su(o,e))}return i&&p?p=iu(p):p||t===v||(p=su(u,t)),r&&(i=true,c=n.apply(s,f)),!i||p||a||(f=s=w),c}var f,a,c,l,s,p,h,_=0,v=false,g=true;if(typeof n!="function")throw new Ge(L);if(t=0>t?0:+t||0,true===r)var y=true,g=false;else ge(r)&&(y=!!r.leading,v="maxWait"in r&&bu(+r.maxWait||0,t),g="trailing"in r?!!r.trailing:g);return i.cancel=function(){p&&iu(p),a&&iu(a),
_=0,a=p=h=w},i}function ce(n,t){function r(){var e=arguments,u=t?t.apply(this,e):e[0],o=r.cache;return o.has(u)?o.get(u):(e=n.apply(this,e),r.cache=o.set(u,e),e)}if(typeof n!="function"||t&&typeof t!="function")throw new Ge(L);return r.cache=new ce.Cache,r}function le(n,t){if(typeof n!="function")throw new Ge(L);return t=bu(t===w?n.length-1:+t||0,0),function(){for(var r=arguments,e=-1,u=bu(r.length-t,0),o=Be(u);++e<u;)o[e]=r[t+e];switch(t){case 0:return n.call(this,o);case 1:return n.call(this,r[0],o);
case 2:return n.call(this,r[0],r[1],o)}for(u=Be(t+1),e=-1;++e<t;)u[e]=r[e];return u[t]=o,n.apply(this,u)}}function se(n,t){return n>t}function pe(n){return h(n)&&Er(n)&&nu.call(n,"callee")&&!cu.call(n,"callee")}function he(n,t,r,e){return e=(r=typeof r=="function"?Bt(r,e,3):w)?r(n,t):w,e===w?dt(n,t,r):!!e}function _e(n){return h(n)&&typeof n.message=="string"&&ru.call(n)==P}function ve(n){return ge(n)&&ru.call(n)==K}function ge(n){var t=typeof n;return!!n&&("object"==t||"function"==t)}function ye(n){
return null==n?false:ve(n)?uu.test(Qe.call(n)):h(n)&&Rn.test(n)}function de(n){return typeof n=="number"||h(n)&&ru.call(n)==V}function me(n){var t;if(!h(n)||ru.call(n)!=Z||pe(n)||!(nu.call(n,"constructor")||(t=n.constructor,typeof t!="function"||t instanceof t)))return false;var r;return ht(n,function(n,t){r=t}),r===w||nu.call(n,r)}function we(n){return ge(n)&&ru.call(n)==Y}function be(n){return typeof n=="string"||h(n)&&ru.call(n)==G}function xe(n){return h(n)&&Sr(n.length)&&!!Sn[ru.call(n)]}function Ae(n,t){
return n<t}function je(n){var t=n?Bu(n):0;return Sr(t)?t?qn(n):[]:Ee(n)}function ke(n){return et(n,Re(n))}function Ie(n){return gt(n,Re(n))}function Re(n){if(null==n)return[];ge(n)||(n=Ve(n));for(var t=n.length,t=t&&Sr(t)&&(Oo(n)||pe(n))&&t||0,r=n.constructor,e=-1,r=typeof r=="function"&&r.prototype===n,u=Be(t),o=0<t;++e<t;)u[e]=e+"";for(var i in n)o&&Cr(i,t)||"constructor"==i&&(r||!nu.call(n,i))||u.push(i);return u}function Oe(n){n=Br(n);for(var t=-1,r=zo(n),e=r.length,u=Be(e);++t<e;){var o=r[t];
u[t]=[o,n[o]]}return u}function Ee(n){return Ft(n,zo(n))}function Ce(n){return(n=u(n))&&n.replace(En,a).replace(xn,"")}function Ue(n,t){var r="";if(n=u(n),t=+t,1>t||!n||!mu(t))return r;do t%2&&(r+=n),t=yu(t/2),n+=n;while(t);return r}function We(n,t,r){var e=n;return(n=u(n))?(r?Ur(e,t,r):null==t)?n.slice(g(n),y(n)+1):(t+="",n.slice(o(n,t),i(n,t)+1)):n}function $e(n,t,r){return r&&Ur(n,t,r)&&(t=w),n=u(n),n.match(t||Wn)||[]}function Se(n,t,r){return r&&Ur(n,t,r)&&(t=w),h(n)?Ne(n):ut(n,t)}function Fe(n){
return n}function Ne(n){return bt(ot(n,true))}function Te(n,t,r){if(null==r){var e=ge(t),u=e?zo(t):w;((u=u&&u.length?gt(t,u):w)?u.length:e)||(u=false,r=t,t=n,n=this)}u||(u=gt(t,zo(t)));var o=true,e=-1,i=ve(n),f=u.length;false===r?o=false:ge(r)&&"chain"in r&&(o=r.chain);for(;++e<f;){r=u[e];var a=t[r];n[r]=a,i&&(n.prototype[r]=function(t){return function(){var r=this.__chain__;if(o||r){var e=n(this.__wrapped__);return(e.__actions__=qn(this.__actions__)).push({func:t,args:arguments,thisArg:n}),e.__chain__=r,e}return t.apply(n,Jn([this.value()],arguments));
}}(a))}return n}function Le(){}function ze(n){return Wr(n)?jt(n):kt(n)}_=_?Yn.defaults(Zn.Object(),_,Yn.pick(Zn,$n)):Zn;var Be=_.Array,De=_.Date,Me=_.Error,qe=_.Function,Pe=_.Math,Ke=_.Number,Ve=_.Object,Ze=_.RegExp,Ye=_.String,Ge=_.TypeError,Je=Be.prototype,Xe=Ve.prototype,He=Ye.prototype,Qe=qe.prototype.toString,nu=Xe.hasOwnProperty,tu=0,ru=Xe.toString,eu=Zn._,uu=Ze("^"+Qe.call(nu).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ou=_.ArrayBuffer,iu=_.clearTimeout,fu=_.parseFloat,au=Pe.pow,cu=Xe.propertyIsEnumerable,lu=jr(_,"Set"),su=_.setTimeout,pu=Je.splice,hu=_.Uint8Array,_u=jr(_,"WeakMap"),vu=Pe.ceil,gu=jr(Ve,"create"),yu=Pe.floor,du=jr(Be,"isArray"),mu=_.isFinite,wu=jr(Ve,"keys"),bu=Pe.max,xu=Pe.min,Au=jr(De,"now"),ju=_.parseInt,ku=Pe.random,Iu=Ke.NEGATIVE_INFINITY,Ru=Ke.POSITIVE_INFINITY,Ou=4294967294,Eu=2147483647,Cu=9007199254740991,Uu=_u&&new _u,Wu={};
Nn.support={},Nn.templateSettings={escape:_n,evaluate:vn,interpolate:gn,variable:"",imports:{_:Nn}};var $u=function(){function n(){}return function(t){if(ge(t)){n.prototype=t;var r=new n;n.prototype=w}return r||{}}}(),Su=Vt(_t),Fu=Vt(vt,true),Nu=Zt(),Tu=Zt(true),Lu=Uu?function(n,t){return Uu.set(n,t),n}:Fe,zu=Uu?function(n){return Uu.get(n)}:Le,Bu=jt("length"),Du=function(){var n=0,t=0;return function(r,e){var u=ho(),o=S-(u-t);if(t=u,0<o){if(++n>=$)return r}else n=0;return Lu(r,e)}}(),Mu=le(function(n,t){
return h(n)&&Er(n)?ft(n,pt(t,false,true)):[]}),qu=tr(),Pu=tr(true),Ku=le(function(n){for(var t=n.length,e=t,u=Be(l),o=xr(),i=o===r,f=[];e--;){var a=n[e]=Er(a=n[e])?a:[];u[e]=i&&120<=a.length&&gu&&lu?new Dn(e&&a):null}var i=n[0],c=-1,l=i?i.length:0,s=u[0];n:for(;++c<l;)if(a=i[c],0>(s?Mn(s,a):o(f,a,0))){for(e=t;--e;){var p=u[e];if(0>(p?Mn(p,a):o(n[e],a,0)))continue n}s&&s.push(a),f.push(a)}return f}),Vu=le(function(t,r){r=pt(r);var e=rt(t,r);return It(t,r.sort(n)),e}),Zu=vr(),Yu=vr(true),Gu=le(function(n){return St(pt(n,false,true));
}),Ju=le(function(n,t){return Er(n)?ft(n,t):[]}),Xu=le(Jr),Hu=le(function(n){var t=n.length,r=2<t?n[t-2]:w,e=1<t?n[t-1]:w;return 2<t&&typeof r=="function"?t-=2:(r=1<t&&typeof e=="function"?(--t,e):w,e=w),n.length=t,Xr(n,r,e)}),Qu=le(function(n){return n=pt(n),this.thru(function(t){t=Oo(t)?t:[Br(t)];for(var r=n,e=-1,u=t.length,o=-1,i=r.length,f=Be(u+i);++e<u;)f[e]=t[e];for(;++o<i;)f[e++]=r[o];return f})}),no=le(function(n,t){return rt(n,pt(t))}),to=Pt(function(n,t,r){nu.call(n,r)?++n[r]:n[r]=1}),ro=nr(Su),eo=nr(Fu,true),uo=ur(Pn,Su),oo=ur(function(n,t){
for(var r=n.length;r--&&false!==t(n[r],r,n););return n},Fu),io=Pt(function(n,t,r){nu.call(n,r)?n[r].push(t):n[r]=[t]}),fo=Pt(function(n,t,r){n[r]=t}),ao=le(function(n,t,r){var e=-1,u=typeof t=="function",o=Wr(t),i=Er(n)?Be(n.length):[];return Su(n,function(n){var f=u?t:o&&null!=n?n[t]:w;i[++e]=f?f.apply(n,r):Or(n,t,r)}),i}),co=Pt(function(n,t,r){n[r?0:1].push(t)},function(){return[[],[]]}),lo=lr(Xn,Su),so=lr(function(n,t,r,e){var u=n.length;for(e&&u&&(r=n[--u]);u--;)r=t(r,n[u],u,n);return r},Fu),po=le(function(n,t){
if(null==n)return[];var r=t[2];return r&&Ur(t[0],t[1],r)&&(t.length=1),Wt(n,pt(t),[])}),ho=Au||function(){return(new De).getTime()},_o=le(function(n,t,r){var e=x;if(r.length)var u=v(r,_o.placeholder),e=e|R;return gr(n,e,t,r,u)}),vo=le(function(n,t){t=t.length?pt(t):Ie(n);for(var r=-1,e=t.length;++r<e;){var u=t[r];n[u]=gr(n[u],x,n)}return n}),go=le(function(n,t,r){var e=x|A;if(r.length)var u=v(r,go.placeholder),e=e|R;return gr(t,e,n,r,u)}),yo=Xt(k),mo=Xt(I),wo=le(function(n,t){return it(n,1,t)}),bo=le(function(n,t,r){
return it(n,t,r)}),xo=er(),Ao=er(true),jo=le(function(n,t){if(t=pt(t),typeof n!="function"||!Kn(t,e))throw new Ge(L);var r=t.length;return le(function(e){for(var u=xu(e.length,r);u--;)e[u]=t[u](e[u]);return n.apply(this,e)})}),ko=cr(R),Io=cr(O),Ro=le(function(n,t){return gr(n,C,w,w,w,pt(t))}),Oo=du||function(n){return h(n)&&Sr(n.length)&&ru.call(n)==D},Eo=Kt(At),Co=Kt(function(n,t,r){return r?nt(n,t,r):tt(n,t)}),Uo=Ht(Co,function(n,t){return n===w?t:n}),Wo=Ht(Eo,Fr),$o=rr(_t),So=rr(vt),Fo=or(Nu),No=or(Tu),To=ir(_t),Lo=ir(vt),zo=wu?function(n){
var t=null==n?w:n.constructor;return typeof t=="function"&&t.prototype===n||typeof n!="function"&&Er(n)?Lr(n):ge(n)?wu(n):[]}:Lr,Bo=fr(true),Do=fr(),Mo=le(function(n,t){if(null==n)return{};if("function"!=typeof t[0])return t=Gn(pt(t),Ye),Nr(n,ft(Re(n),t));var r=Bt(t[0],t[1],3);return Tr(n,function(n,t,e){return!r(n,t,e)})}),qo=le(function(n,t){return null==n?{}:"function"==typeof t[0]?Tr(n,Bt(t[0],t[1],3)):Nr(n,pt(t))}),Po=Gt(function(n,t,r){return t=t.toLowerCase(),n+(r?t.charAt(0).toUpperCase()+t.slice(1):t);
}),Ko=Gt(function(n,t,r){return n+(r?"-":"")+t.toLowerCase()}),Vo=ar(),Zo=ar(true),Yo=Gt(function(n,t,r){return n+(r?"_":"")+t.toLowerCase()}),Go=Gt(function(n,t,r){return n+(r?" ":"")+(t.charAt(0).toUpperCase()+t.slice(1))}),Jo=le(function(n,t){try{return n.apply(w,t)}catch(r){return _e(r)?r:new Me(r)}}),Xo=le(function(n,t){return function(r){return Or(r,n,t)}}),Ho=le(function(n,t){return function(r){return Or(n,r,t)}}),Qo=_r("ceil"),ni=_r("floor"),ti=Qt(se,Iu),ri=Qt(Ae,Ru),ei=_r("round");return Nn.prototype=Tn.prototype,
Ln.prototype=$u(Tn.prototype),Ln.prototype.constructor=Ln,zn.prototype=$u(Tn.prototype),zn.prototype.constructor=zn,Bn.prototype["delete"]=function(n){return this.has(n)&&delete this.__data__[n]},Bn.prototype.get=function(n){return"__proto__"==n?w:this.__data__[n]},Bn.prototype.has=function(n){return"__proto__"!=n&&nu.call(this.__data__,n)},Bn.prototype.set=function(n,t){return"__proto__"!=n&&(this.__data__[n]=t),this},Dn.prototype.push=function(n){var t=this.data;typeof n=="string"||ge(n)?t.set.add(n):t.hash[n]=true;
},ce.Cache=Bn,Nn.after=function(n,t){if(typeof t!="function"){if(typeof n!="function")throw new Ge(L);var r=n;n=t,t=r}return n=mu(n=+n)?n:0,function(){return 1>--n?t.apply(this,arguments):void 0}},Nn.ary=function(n,t,r){return r&&Ur(n,t,r)&&(t=w),t=n&&null==t?n.length:bu(+t||0,0),gr(n,E,w,w,w,w,t)},Nn.assign=Co,Nn.at=no,Nn.before=fe,Nn.bind=_o,Nn.bindAll=vo,Nn.bindKey=go,Nn.callback=Se,Nn.chain=Qr,Nn.chunk=function(n,t,r){t=(r?Ur(n,t,r):null==t)?1:bu(yu(t)||1,1),r=0;for(var e=n?n.length:0,u=-1,o=Be(vu(e/t));r<e;)o[++u]=Et(n,r,r+=t);
return o},Nn.compact=function(n){for(var t=-1,r=n?n.length:0,e=-1,u=[];++t<r;){var o=n[t];o&&(u[++e]=o)}return u},Nn.constant=function(n){return function(){return n}},Nn.countBy=to,Nn.create=function(n,t,r){var e=$u(n);return r&&Ur(n,t,r)&&(t=w),t?tt(e,t):e},Nn.curry=yo,Nn.curryRight=mo,Nn.debounce=ae,Nn.defaults=Uo,Nn.defaultsDeep=Wo,Nn.defer=wo,Nn.delay=bo,Nn.difference=Mu,Nn.drop=qr,Nn.dropRight=Pr,Nn.dropRightWhile=function(n,t,r){return n&&n.length?Nt(n,wr(t,r,3),true,true):[]},Nn.dropWhile=function(n,t,r){
return n&&n.length?Nt(n,wr(t,r,3),true):[]},Nn.fill=function(n,t,r,e){var u=n?n.length:0;if(!u)return[];for(r&&typeof r!="number"&&Ur(n,t,r)&&(r=0,e=u),u=n.length,r=null==r?0:+r||0,0>r&&(r=-r>u?0:u+r),e=e===w||e>u?u:+e||0,0>e&&(e+=u),u=r>e?0:e>>>0,r>>>=0;r<u;)n[r++]=t;return n},Nn.filter=re,Nn.flatten=function(n,t,r){var e=n?n.length:0;return r&&Ur(n,t,r)&&(t=false),e?pt(n,t):[]},Nn.flattenDeep=function(n){return n&&n.length?pt(n,true):[]},Nn.flow=xo,Nn.flowRight=Ao,Nn.forEach=uo,Nn.forEachRight=oo,Nn.forIn=Fo,
Nn.forInRight=No,Nn.forOwn=To,Nn.forOwnRight=Lo,Nn.functions=Ie,Nn.groupBy=io,Nn.indexBy=fo,Nn.initial=function(n){return Pr(n,1)},Nn.intersection=Ku,Nn.invert=function(n,t,r){r&&Ur(n,t,r)&&(t=w),r=-1;for(var e=zo(n),u=e.length,o={};++r<u;){var i=e[r],f=n[i];t?nu.call(o,f)?o[f].push(i):o[f]=[i]:o[f]=i}return o},Nn.invoke=ao,Nn.keys=zo,Nn.keysIn=Re,Nn.map=ue,Nn.mapKeys=Bo,Nn.mapValues=Do,Nn.matches=Ne,Nn.matchesProperty=function(n,t){return xt(n,ot(t,true))},Nn.memoize=ce,Nn.merge=Eo,Nn.method=Xo,Nn.methodOf=Ho,
Nn.mixin=Te,Nn.modArgs=jo,Nn.negate=function(n){if(typeof n!="function")throw new Ge(L);return function(){return!n.apply(this,arguments)}},Nn.omit=Mo,Nn.once=function(n){return fe(2,n)},Nn.pairs=Oe,Nn.partial=ko,Nn.partialRight=Io,Nn.partition=co,Nn.pick=qo,Nn.pluck=function(n,t){return ue(n,ze(t))},Nn.property=ze,Nn.propertyOf=function(n){return function(t){return yt(n,Dr(t),t+"")}},Nn.pull=function(){var n=arguments,t=n[0];if(!t||!t.length)return t;for(var r=0,e=xr(),u=n.length;++r<u;)for(var o=0,i=n[r];-1<(o=e(t,i,o));)pu.call(t,o,1);
return t},Nn.pullAt=Vu,Nn.range=function(n,t,r){r&&Ur(n,t,r)&&(t=r=w),n=+n||0,r=null==r?1:+r||0,null==t?(t=n,n=0):t=+t||0;var e=-1;t=bu(vu((t-n)/(r||1)),0);for(var u=Be(t);++e<t;)u[e]=n,n+=r;return u},Nn.rearg=Ro,Nn.reject=function(n,t,r){var e=Oo(n)?Vn:lt;return t=wr(t,r,3),e(n,function(n,r,e){return!t(n,r,e)})},Nn.remove=function(n,t,r){var e=[];if(!n||!n.length)return e;var u=-1,o=[],i=n.length;for(t=wr(t,r,3);++u<i;)r=n[u],t(r,u,n)&&(e.push(r),o.push(u));return It(n,o),e},Nn.rest=Yr,Nn.restParam=le,
Nn.set=function(n,t,r){if(null==n)return n;var e=t+"";t=null!=n[e]||Wr(t,n)?[e]:Dr(t);for(var e=-1,u=t.length,o=u-1,i=n;null!=i&&++e<u;){var f=t[e];ge(i)&&(e==o?i[f]=r:null==i[f]&&(i[f]=Cr(t[e+1])?[]:{})),i=i[f]}return n},Nn.shuffle=function(n){return oe(n,Ru)},Nn.slice=function(n,t,r){var e=n?n.length:0;return e?(r&&typeof r!="number"&&Ur(n,t,r)&&(t=0,r=e),Et(n,t,r)):[]},Nn.sortBy=function(n,t,r){if(null==n)return[];r&&Ur(n,t,r)&&(t=w);var e=-1;return t=wr(t,r,3),n=wt(n,function(n,r,u){return{a:t(n,r,u),
b:++e,c:n}}),Ut(n,f)},Nn.sortByAll=po,Nn.sortByOrder=function(n,t,r,e){return null==n?[]:(e&&Ur(t,r,e)&&(r=w),Oo(t)||(t=null==t?[]:[t]),Oo(r)||(r=null==r?[]:[r]),Wt(n,t,r))},Nn.spread=function(n){if(typeof n!="function")throw new Ge(L);return function(t){return n.apply(this,t)}},Nn.take=function(n,t,r){return n&&n.length?((r?Ur(n,t,r):null==t)&&(t=1),Et(n,0,0>t?0:t)):[]},Nn.takeRight=function(n,t,r){var e=n?n.length:0;return e?((r?Ur(n,t,r):null==t)&&(t=1),t=e-(+t||0),Et(n,0>t?0:t)):[]},Nn.takeRightWhile=function(n,t,r){
return n&&n.length?Nt(n,wr(t,r,3),false,true):[]},Nn.takeWhile=function(n,t,r){return n&&n.length?Nt(n,wr(t,r,3)):[]},Nn.tap=function(n,t,r){return t.call(r,n),n},Nn.throttle=function(n,t,r){var e=true,u=true;if(typeof n!="function")throw new Ge(L);return false===r?e=false:ge(r)&&(e="leading"in r?!!r.leading:e,u="trailing"in r?!!r.trailing:u),ae(n,t,{leading:e,maxWait:+t,trailing:u})},Nn.thru=ne,Nn.times=function(n,t,r){if(n=yu(n),1>n||!mu(n))return[];var e=-1,u=Be(xu(n,4294967295));for(t=Bt(t,r,1);++e<n;)4294967295>e?u[e]=t(e):t(e);
return u},Nn.toArray=je,Nn.toPlainObject=ke,Nn.transform=function(n,t,r,e){var u=Oo(n)||xe(n);return t=wr(t,e,4),null==r&&(u||ge(n)?(e=n.constructor,r=u?Oo(n)?new e:[]:$u(ve(e)?e.prototype:w)):r={}),(u?Pn:_t)(n,function(n,e,u){return t(r,n,e,u)}),r},Nn.union=Gu,Nn.uniq=Gr,Nn.unzip=Jr,Nn.unzipWith=Xr,Nn.values=Ee,Nn.valuesIn=function(n){return Ft(n,Re(n))},Nn.where=function(n,t){return re(n,bt(t))},Nn.without=Ju,Nn.wrap=function(n,t){return t=null==t?Fe:t,gr(t,R,w,[n],[])},Nn.xor=function(){for(var n=-1,t=arguments.length;++n<t;){
var r=arguments[n];if(Er(r))var e=e?Jn(ft(e,r),ft(r,e)):r}return e?St(e):[]},Nn.zip=Xu,Nn.zipObject=Hr,Nn.zipWith=Hu,Nn.backflow=Ao,Nn.collect=ue,Nn.compose=Ao,Nn.each=uo,Nn.eachRight=oo,Nn.extend=Co,Nn.iteratee=Se,Nn.methods=Ie,Nn.object=Hr,Nn.select=re,Nn.tail=Yr,Nn.unique=Gr,Te(Nn,Nn),Nn.add=function(n,t){return(+n||0)+(+t||0)},Nn.attempt=Jo,Nn.camelCase=Po,Nn.capitalize=function(n){return(n=u(n))&&n.charAt(0).toUpperCase()+n.slice(1)},Nn.ceil=Qo,Nn.clone=function(n,t,r,e){return t&&typeof t!="boolean"&&Ur(n,t,r)?t=false:typeof t=="function"&&(e=r,
r=t,t=false),typeof r=="function"?ot(n,t,Bt(r,e,3)):ot(n,t)},Nn.cloneDeep=function(n,t,r){return typeof t=="function"?ot(n,true,Bt(t,r,3)):ot(n,true)},Nn.deburr=Ce,Nn.endsWith=function(n,t,r){n=u(n),t+="";var e=n.length;return r=r===w?e:xu(0>r?0:+r||0,e),r-=t.length,0<=r&&n.indexOf(t,r)==r},Nn.escape=function(n){return(n=u(n))&&hn.test(n)?n.replace(sn,c):n},Nn.escapeRegExp=function(n){return(n=u(n))&&bn.test(n)?n.replace(wn,l):n||"(?:)"},Nn.every=te,Nn.find=ro,Nn.findIndex=qu,Nn.findKey=$o,Nn.findLast=eo,
Nn.findLastIndex=Pu,Nn.findLastKey=So,Nn.findWhere=function(n,t){return ro(n,bt(t))},Nn.first=Kr,Nn.floor=ni,Nn.get=function(n,t,r){return n=null==n?w:yt(n,Dr(t),t+""),n===w?r:n},Nn.gt=se,Nn.gte=function(n,t){return n>=t},Nn.has=function(n,t){if(null==n)return false;var r=nu.call(n,t);if(!r&&!Wr(t)){if(t=Dr(t),n=1==t.length?n:yt(n,Et(t,0,-1)),null==n)return false;t=Zr(t),r=nu.call(n,t)}return r||Sr(n.length)&&Cr(t,n.length)&&(Oo(n)||pe(n))},Nn.identity=Fe,Nn.includes=ee,Nn.indexOf=Vr,Nn.inRange=function(n,t,r){
return t=+t||0,r===w?(r=t,t=0):r=+r||0,n>=xu(t,r)&&n<bu(t,r)},Nn.isArguments=pe,Nn.isArray=Oo,Nn.isBoolean=function(n){return true===n||false===n||h(n)&&ru.call(n)==M},Nn.isDate=function(n){return h(n)&&ru.call(n)==q},Nn.isElement=function(n){return!!n&&1===n.nodeType&&h(n)&&!me(n)},Nn.isEmpty=function(n){return null==n?true:Er(n)&&(Oo(n)||be(n)||pe(n)||h(n)&&ve(n.splice))?!n.length:!zo(n).length},Nn.isEqual=he,Nn.isError=_e,Nn.isFinite=function(n){return typeof n=="number"&&mu(n)},Nn.isFunction=ve,Nn.isMatch=function(n,t,r,e){
return r=typeof r=="function"?Bt(r,e,3):w,mt(n,Ar(t),r)},Nn.isNaN=function(n){return de(n)&&n!=+n},Nn.isNative=ye,Nn.isNull=function(n){return null===n},Nn.isNumber=de,Nn.isObject=ge,Nn.isPlainObject=me,Nn.isRegExp=we,Nn.isString=be,Nn.isTypedArray=xe,Nn.isUndefined=function(n){return n===w},Nn.kebabCase=Ko,Nn.last=Zr,Nn.lastIndexOf=function(n,t,r){var e=n?n.length:0;if(!e)return-1;var u=e;if(typeof r=="number")u=(0>r?bu(e+r,0):xu(r||0,e-1))+1;else if(r)return u=Lt(n,t,true)-1,n=n[u],(t===t?t===n:n!==n)?u:-1;
if(t!==t)return p(n,u,true);for(;u--;)if(n[u]===t)return u;return-1},Nn.lt=Ae,Nn.lte=function(n,t){return n<=t},Nn.max=ti,Nn.min=ri,Nn.noConflict=function(){return Zn._=eu,this},Nn.noop=Le,Nn.now=ho,Nn.pad=function(n,t,r){n=u(n),t=+t;var e=n.length;return e<t&&mu(t)?(e=(t-e)/2,t=yu(e),e=vu(e),r=pr("",e,r),r.slice(0,t)+n+r):n},Nn.padLeft=Vo,Nn.padRight=Zo,Nn.parseInt=function(n,t,r){return(r?Ur(n,t,r):null==t)?t=0:t&&(t=+t),n=We(n),ju(n,t||(In.test(n)?16:10))},Nn.random=function(n,t,r){r&&Ur(n,t,r)&&(t=r=w);
var e=null==n,u=null==t;return null==r&&(u&&typeof n=="boolean"?(r=n,n=1):typeof t=="boolean"&&(r=t,u=true)),e&&u&&(t=1,u=false),n=+n||0,u?(t=n,n=0):t=+t||0,r||n%1||t%1?(r=ku(),xu(n+r*(t-n+fu("1e-"+((r+"").length-1))),t)):Rt(n,t)},Nn.reduce=lo,Nn.reduceRight=so,Nn.repeat=Ue,Nn.result=function(n,t,r){var e=null==n?w:n[t];return e===w&&(null==n||Wr(t,n)||(t=Dr(t),n=1==t.length?n:yt(n,Et(t,0,-1)),e=null==n?w:n[Zr(t)]),e=e===w?r:e),ve(e)?e.call(n):e},Nn.round=ei,Nn.runInContext=m,Nn.size=function(n){var t=n?Bu(n):0;
return Sr(t)?t:zo(n).length},Nn.snakeCase=Yo,Nn.some=ie,Nn.sortedIndex=Zu,Nn.sortedLastIndex=Yu,Nn.startCase=Go,Nn.startsWith=function(n,t,r){return n=u(n),r=null==r?0:xu(0>r?0:+r||0,n.length),n.lastIndexOf(t,r)==r},Nn.sum=function(n,t,r){if(r&&Ur(n,t,r)&&(t=w),t=wr(t,r,3),1==t.length){n=Oo(n)?n:zr(n),r=n.length;for(var e=0;r--;)e+=+t(n[r])||0;n=e}else n=$t(n,t);return n},Nn.template=function(n,t,r){var e=Nn.templateSettings;r&&Ur(n,t,r)&&(t=r=w),n=u(n),t=nt(tt({},r||t),e,Qn),r=nt(tt({},t.imports),e.imports,Qn);
var o,i,f=zo(r),a=Ft(r,f),c=0;r=t.interpolate||Cn;var l="__p+='";r=Ze((t.escape||Cn).source+"|"+r.source+"|"+(r===gn?jn:Cn).source+"|"+(t.evaluate||Cn).source+"|$","g");var p="sourceURL"in t?"//# sourceURL="+t.sourceURL+"\n":"";if(n.replace(r,function(t,r,e,u,f,a){return e||(e=u),l+=n.slice(c,a).replace(Un,s),r&&(o=true,l+="'+__e("+r+")+'"),f&&(i=true,l+="';"+f+";\n__p+='"),e&&(l+="'+((__t=("+e+"))==null?'':__t)+'"),c=a+t.length,t}),l+="';",(t=t.variable)||(l="with(obj){"+l+"}"),l=(i?l.replace(fn,""):l).replace(an,"$1").replace(cn,"$1;"),
l="function("+(t||"obj")+"){"+(t?"":"obj||(obj={});")+"var __t,__p=''"+(o?",__e=_.escape":"")+(i?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+l+"return __p}",t=Jo(function(){return qe(f,p+"return "+l).apply(w,a)}),t.source=l,_e(t))throw t;return t},Nn.trim=We,Nn.trimLeft=function(n,t,r){var e=n;return(n=u(n))?n.slice((r?Ur(e,t,r):null==t)?g(n):o(n,t+"")):n},Nn.trimRight=function(n,t,r){var e=n;return(n=u(n))?(r?Ur(e,t,r):null==t)?n.slice(0,y(n)+1):n.slice(0,i(n,t+"")+1):n;
},Nn.trunc=function(n,t,r){r&&Ur(n,t,r)&&(t=w);var e=U;if(r=W,null!=t)if(ge(t)){var o="separator"in t?t.separator:o,e="length"in t?+t.length||0:e;r="omission"in t?u(t.omission):r}else e=+t||0;if(n=u(n),e>=n.length)return n;if(e-=r.length,1>e)return r;if(t=n.slice(0,e),null==o)return t+r;if(we(o)){if(n.slice(e).search(o)){var i,f=n.slice(0,e);for(o.global||(o=Ze(o.source,(kn.exec(o)||"")+"g")),o.lastIndex=0;n=o.exec(f);)i=n.index;t=t.slice(0,null==i?e:i)}}else n.indexOf(o,e)!=e&&(o=t.lastIndexOf(o),
-1<o&&(t=t.slice(0,o)));return t+r},Nn.unescape=function(n){return(n=u(n))&&pn.test(n)?n.replace(ln,d):n},Nn.uniqueId=function(n){var t=++tu;return u(n)+t},Nn.words=$e,Nn.all=te,Nn.any=ie,Nn.contains=ee,Nn.eq=he,Nn.detect=ro,Nn.foldl=lo,Nn.foldr=so,Nn.head=Kr,Nn.include=ee,Nn.inject=lo,Te(Nn,function(){var n={};return _t(Nn,function(t,r){Nn.prototype[r]||(n[r]=t)}),n}(),false),Nn.sample=oe,Nn.prototype.sample=function(n){return this.__chain__||null!=n?this.thru(function(t){return oe(t,n)}):oe(this.value());
},Nn.VERSION=b,Pn("bind bindKey curry curryRight partial partialRight".split(" "),function(n){Nn[n].placeholder=Nn}),Pn(["drop","take"],function(n,t){zn.prototype[n]=function(r){var e=this.__filtered__;if(e&&!t)return new zn(this);r=null==r?1:bu(yu(r)||0,0);var u=this.clone();return e?u.__takeCount__=xu(u.__takeCount__,r):u.__views__.push({size:r,type:n+(0>u.__dir__?"Right":"")}),u},zn.prototype[n+"Right"]=function(t){return this.reverse()[n](t).reverse()}}),Pn(["filter","map","takeWhile"],function(n,t){
var r=t+1,e=r!=T;zn.prototype[n]=function(n,t){var u=this.clone();return u.__iteratees__.push({iteratee:wr(n,t,1),type:r}),u.__filtered__=u.__filtered__||e,u}}),Pn(["first","last"],function(n,t){var r="take"+(t?"Right":"");zn.prototype[n]=function(){return this[r](1).value()[0]}}),Pn(["initial","rest"],function(n,t){var r="drop"+(t?"":"Right");zn.prototype[n]=function(){return this.__filtered__?new zn(this):this[r](1)}}),Pn(["pluck","where"],function(n,t){var r=t?"filter":"map",e=t?bt:ze;zn.prototype[n]=function(n){
return this[r](e(n))}}),zn.prototype.compact=function(){return this.filter(Fe)},zn.prototype.reject=function(n,t){return n=wr(n,t,1),this.filter(function(t){return!n(t)})},zn.prototype.slice=function(n,t){n=null==n?0:+n||0;var r=this;return r.__filtered__&&(0<n||0>t)?new zn(r):(0>n?r=r.takeRight(-n):n&&(r=r.drop(n)),t!==w&&(t=+t||0,r=0>t?r.dropRight(-t):r.take(t-n)),r)},zn.prototype.takeRightWhile=function(n,t){return this.reverse().takeWhile(n,t).reverse()},zn.prototype.toArray=function(){return this.take(Ru);
},_t(zn.prototype,function(n,t){var r=/^(?:filter|map|reject)|While$/.test(t),e=/^(?:first|last)$/.test(t),u=Nn[e?"take"+("last"==t?"Right":""):t];u&&(Nn.prototype[t]=function(){function t(n){return e&&i?u(n,1)[0]:u.apply(w,Jn([n],o))}var o=e?[1]:arguments,i=this.__chain__,f=this.__wrapped__,a=!!this.__actions__.length,c=f instanceof zn,l=o[0],s=c||Oo(f);return s&&r&&typeof l=="function"&&1!=l.length&&(c=s=false),l={func:ne,args:[t],thisArg:w},a=c&&!a,e&&!i?a?(f=f.clone(),f.__actions__.push(l),n.call(f)):u.call(w,this.value())[0]:!e&&s?(f=a?f:new zn(this),
f=n.apply(f,o),f.__actions__.push(l),new Ln(f,i)):this.thru(t)})}),Pn("join pop push replace shift sort splice split unshift".split(" "),function(n){var t=(/^(?:replace|split)$/.test(n)?He:Je)[n],r=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",e=/^(?:join|pop|replace|shift)$/.test(n);Nn.prototype[n]=function(){var n=arguments;return e&&!this.__chain__?t.apply(this.value(),n):this[r](function(r){return t.apply(r,n)})}}),_t(zn.prototype,function(n,t){var r=Nn[t];if(r){var e=r.name+"";(Wu[e]||(Wu[e]=[])).push({
name:t,func:r})}}),Wu[sr(w,A).name]=[{name:"wrapper",func:w}],zn.prototype.clone=function(){var n=new zn(this.__wrapped__);return n.__actions__=qn(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=qn(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=qn(this.__views__),n},zn.prototype.reverse=function(){if(this.__filtered__){var n=new zn(this);n.__dir__=-1,n.__filtered__=true}else n=this.clone(),n.__dir__*=-1;return n},zn.prototype.value=function(){
var n,t=this.__wrapped__.value(),r=this.__dir__,e=Oo(t),u=0>r,o=e?t.length:0;n=o;for(var i=this.__views__,f=0,a=-1,c=i.length;++a<c;){var l=i[a],s=l.size;switch(l.type){case"drop":f+=s;break;case"dropRight":n-=s;break;case"take":n=xu(n,f+s);break;case"takeRight":f=bu(f,n-s)}}if(n={start:f,end:n},i=n.start,f=n.end,n=f-i,u=u?f:i-1,i=this.__iteratees__,f=i.length,a=0,c=xu(n,this.__takeCount__),!e||o<F||o==n&&c==n)return Tt(t,this.__actions__);e=[];n:for(;n--&&a<c;){for(u+=r,o=-1,l=t[u];++o<f;){var p=i[o],s=p.type,p=p.iteratee(l);
if(s==T)l=p;else if(!p){if(s==N)continue n;break n}}e[a++]=l}return e},Nn.prototype.chain=function(){return Qr(this)},Nn.prototype.commit=function(){return new Ln(this.value(),this.__chain__)},Nn.prototype.concat=Qu,Nn.prototype.plant=function(n){for(var t,r=this;r instanceof Tn;){var e=Mr(r);t?u.__wrapped__=e:t=e;var u=e,r=r.__wrapped__}return u.__wrapped__=n,t},Nn.prototype.reverse=function(){function n(n){return n.reverse()}var t=this.__wrapped__;return t instanceof zn?(this.__actions__.length&&(t=new zn(this)),
t=t.reverse(),t.__actions__.push({func:ne,args:[n],thisArg:w}),new Ln(t,this.__chain__)):this.thru(n)},Nn.prototype.toString=function(){return this.value()+""},Nn.prototype.run=Nn.prototype.toJSON=Nn.prototype.valueOf=Nn.prototype.value=function(){return Tt(this.__wrapped__,this.__actions__)},Nn.prototype.collect=Nn.prototype.map,Nn.prototype.head=Nn.prototype.first,Nn.prototype.select=Nn.prototype.filter,Nn.prototype.tail=Nn.prototype.rest,Nn}var w,b="3.10.1",x=1,A=2,j=4,k=8,I=16,R=32,O=64,E=128,C=256,U=30,W="...",$=150,S=16,F=200,N=1,T=2,L="Expected a function",z="__lodash_placeholder__",B="[object Arguments]",D="[object Array]",M="[object Boolean]",q="[object Date]",P="[object Error]",K="[object Function]",V="[object Number]",Z="[object Object]",Y="[object RegExp]",G="[object String]",J="[object ArrayBuffer]",X="[object Float32Array]",H="[object Float64Array]",Q="[object Int8Array]",nn="[object Int16Array]",tn="[object Int32Array]",rn="[object Uint8Array]",en="[object Uint8ClampedArray]",un="[object Uint16Array]",on="[object Uint32Array]",fn=/\b__p\+='';/g,an=/\b(__p\+=)''\+/g,cn=/(__e\(.*?\)|\b__t\))\+'';/g,ln=/&(?:amp|lt|gt|quot|#39|#96);/g,sn=/[&<>"'`]/g,pn=RegExp(ln.source),hn=RegExp(sn.source),_n=/<%-([\s\S]+?)%>/g,vn=/<%([\s\S]+?)%>/g,gn=/<%=([\s\S]+?)%>/g,yn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,dn=/^\w*$/,mn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,wn=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,bn=RegExp(wn.source),xn=/[\u0300-\u036f\ufe20-\ufe23]/g,An=/\\(\\)?/g,jn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,kn=/\w*$/,In=/^0[xX]/,Rn=/^\[object .+?Constructor\]$/,On=/^\d+$/,En=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Cn=/($^)/,Un=/['\n\r\u2028\u2029\\]/g,Wn=RegExp("[A-Z\\xc0-\\xd6\\xd8-\\xde]+(?=[A-Z\\xc0-\\xd6\\xd8-\\xde][a-z\\xdf-\\xf6\\xf8-\\xff]+)|[A-Z\\xc0-\\xd6\\xd8-\\xde]?[a-z\\xdf-\\xf6\\xf8-\\xff]+|[A-Z\\xc0-\\xd6\\xd8-\\xde]+|[0-9]+","g"),$n="Array ArrayBuffer Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Math Number Object RegExp Set String _ clearTimeout isFinite parseFloat parseInt setTimeout TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap".split(" "),Sn={};
Sn[X]=Sn[H]=Sn[Q]=Sn[nn]=Sn[tn]=Sn[rn]=Sn[en]=Sn[un]=Sn[on]=true,Sn[B]=Sn[D]=Sn[J]=Sn[M]=Sn[q]=Sn[P]=Sn[K]=Sn["[object Map]"]=Sn[V]=Sn[Z]=Sn[Y]=Sn["[object Set]"]=Sn[G]=Sn["[object WeakMap]"]=false;var Fn={};Fn[B]=Fn[D]=Fn[J]=Fn[M]=Fn[q]=Fn[X]=Fn[H]=Fn[Q]=Fn[nn]=Fn[tn]=Fn[V]=Fn[Z]=Fn[Y]=Fn[G]=Fn[rn]=Fn[en]=Fn[un]=Fn[on]=true,Fn[P]=Fn[K]=Fn["[object Map]"]=Fn["[object Set]"]=Fn["[object WeakMap]"]=false;var Nn={"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a",
"\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y",
"\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss"},Tn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Ln={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},zn={"function":true,object:true},Bn={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},Dn={"\\":"\\",
"'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Mn=zn[typeof exports]&&exports&&!exports.nodeType&&exports,qn=zn[typeof module]&&module&&!module.nodeType&&module,Pn=zn[typeof self]&&self&&self.Object&&self,Kn=zn[typeof window]&&window&&window.Object&&window,Vn=qn&&qn.exports===Mn&&Mn,Zn=Mn&&qn&&typeof global=="object"&&global&&global.Object&&global||Kn!==(this&&this.window)&&Kn||Pn||this,Yn=m();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Zn._=Yn, define(function(){
return Yn})):Mn&&qn?Vn?(qn.exports=Yn)._=Yn:Mn._=Yn:Zn._=Yn}).call(this);
/*! JointJS v1.1.0 (2017-03-31) - JavaScript diagramming library


This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.
*/
(function(root, factory) {

    if (typeof define === 'function' && define.amd) {

        // For AMD.

        define(['backbone', 'lodash', 'jquery'], function(Backbone, _, $) {

            Backbone.$ = $;

            return factory(root, Backbone, _, $);
        });

    } else if (typeof exports !== 'undefined') {

        // For Node.js or CommonJS.

        var Backbone = require('backbone');
        var _ = require('lodash');
        var $ = Backbone.$ = require('jquery');

        module.exports = factory(root, Backbone, _, $);

    } else {

        // As a browser global.

        var Backbone = root.Backbone;
        var _ = root._;
        var $ = Backbone.$ = root.jQuery || root.$;

        root.joint = factory(root, Backbone, _, $);
        root.g = root.joint.g;
        root.V = root.Vectorizer = root.joint.V;
    }

}(this, function(root, Backbone, _, $) {

(function() {

    /**
     * version: 0.3.0
     * git://github.com/davidchambers/Base64.js.git
     */

    var object = typeof exports != 'undefined' ? exports : this; // #8: web workers
    var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';

    function InvalidCharacterError(message) {
        this.message = message;
    }

    InvalidCharacterError.prototype = new Error;
    InvalidCharacterError.prototype.name = 'InvalidCharacterError';

    // encoder
    // [https://gist.github.com/999166] by [https://github.com/nignag]
    object.btoa || (
        object.btoa = function(input) {
            var str = String(input);
            for (
                // initialize result and counter
                var block, charCode, idx = 0, map = chars, output = '';
                // if the next str index does not exist:
                //   change the mapping table to "="
                //   check if d has no fractional digits
                str.charAt(idx | 0) || (map = '=', idx % 1);
                // "8 - idx % 1 * 8" generates the sequence 2, 4, 6, 8
                output += map.charAt(63 & block >> 8 - idx % 1 * 8)
            ) {
                charCode = str.charCodeAt(idx += 3 / 4);
                if (charCode > 0xFF) {
                    throw new InvalidCharacterError("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");
                }
                block = block << 8 | charCode;
            }
            return output;
        });

    // decoder
    // [https://gist.github.com/1020396] by [https://github.com/atk]
    object.atob || (
        object.atob = function(input) {
            var str = String(input).replace(/=+$/, '');
            if (str.length % 4 == 1) {
                throw new InvalidCharacterError("'atob' failed: The string to be decoded is not correctly encoded.");
            }
            for (
                // initialize result and counters
                var bc = 0, bs, buffer, idx = 0, output = '';
                // get next character
                // eslint-disable-next-line no-cond-assign
                buffer = str.charAt(idx++);
                // character found in table? initialize bit storage and add its ascii value;
                ~buffer && (bs = bc % 4 ? bs * 64 + buffer : buffer,
                    // and if not first of each 4 characters,
                    // convert the first 8 bits to one ascii character
                bc++ % 4) ? output += String.fromCharCode(255 & bs >> (-2 * bc & 6)) : 0
            ) {
                // try to find character in table (0-63, not found => -1)
                buffer = chars.indexOf(buffer);
            }
            return output;
        });

}());

(function() {

    if (typeof Uint8Array !== 'undefined' || typeof window === 'undefined') {
        return;
    }

    function subarray(start, end) {
        return this.slice(start, end);
    }

    function set_(array, offset) {

        if (arguments.length < 2) {
            offset = 0;
        }
        for (var i = 0, n = array.length; i < n; ++i, ++offset) {
            this[offset] = array[i] & 0xFF;
        }
    }

    // we need typed arrays
    function TypedArray(arg1) {

        var result;
        if (typeof arg1 === 'number') {
            result = new Array(arg1);
            for (var i = 0; i < arg1; ++i) {
                result[i] = 0;
            }
        } else {
            result = arg1.slice(0);
        }
        result.subarray = subarray;
        result.buffer = result;
        result.byteLength = result.length;
        result.set = set_;
        if (typeof arg1 === 'object' && arg1.buffer) {
            result.buffer = arg1.buffer;
        }

        return result;
    }

    window.Uint8Array = TypedArray;
    window.Uint32Array = TypedArray;
    window.Int32Array = TypedArray;
})();

/**
 * make xhr.response = 'arraybuffer' available for the IE9
 */
(function() {

    if (typeof XMLHttpRequest === 'undefined') {
        return;
    }

    if ('response' in XMLHttpRequest.prototype ||
        'mozResponseArrayBuffer' in XMLHttpRequest.prototype ||
        'mozResponse' in XMLHttpRequest.prototype ||
        'responseArrayBuffer' in XMLHttpRequest.prototype) {
        return;
    }

    Object.defineProperty(XMLHttpRequest.prototype, 'response', {
        get: function() {
            return new Uint8Array(new VBArray(this.responseBody).toArray());
        }
    });
})();


//      Geometry library.

var g = (function() {

    var g = {};

    // Declare shorthands to the most used math functions.
    var math = Math;
    var abs = math.abs;
    var cos = math.cos;
    var sin = math.sin;
    var sqrt = math.sqrt;
    var mmin = math.min;
    var mmax = math.max;
    var atan2 = math.atan2;
    var round = math.round;
    var floor = math.floor;
    var PI = math.PI;
    var random = math.random;
    var pow = math.pow;

    g.bezier = {

        // Cubic Bezier curve path through points.
        // Ported from C# implementation by Oleg V. Polikarpotchkin and Peter Lee (http://www.codeproject.com/KB/graphics/BezierSpline.aspx).
        // @param {array} points Array of points through which the smooth line will go.
        // @return {array} SVG Path commands as an array
        curveThroughPoints: function(points) {

            var controlPoints = this.getCurveControlPoints(points);
            var path = ['M', points[0].x, points[0].y];

            for (var i = 0; i < controlPoints[0].length; i++) {
                path.push('C', controlPoints[0][i].x, controlPoints[0][i].y, controlPoints[1][i].x, controlPoints[1][i].y, points[i + 1].x, points[i + 1].y);
            }

            return path;
        },

        // Get open-ended Bezier Spline Control Points.
        // @param knots Input Knot Bezier spline points (At least two points!).
        // @param firstControlPoints Output First Control points. Array of knots.length - 1 length.
        // @param secondControlPoints Output Second Control points. Array of knots.length - 1 length.
        getCurveControlPoints: function(knots) {

            var firstControlPoints = [];
            var secondControlPoints = [];
            var n = knots.length - 1;
            var i;

            // Special case: Bezier curve should be a straight line.
            if (n == 1) {
                // 3P1 = 2P0 + P3
                firstControlPoints[0] = Point((2 * knots[0].x + knots[1].x) / 3,
                                              (2 * knots[0].y + knots[1].y) / 3);
                // P2 = 2P1 – P0
                secondControlPoints[0] = Point(2 * firstControlPoints[0].x - knots[0].x,
                                               2 * firstControlPoints[0].y - knots[0].y);
                return [firstControlPoints, secondControlPoints];
            }

            // Calculate first Bezier control points.
            // Right hand side vector.
            var rhs = [];

            // Set right hand side X values.
            for (i = 1; i < n - 1; i++) {
                rhs[i] = 4 * knots[i].x + 2 * knots[i + 1].x;
            }
            rhs[0] = knots[0].x + 2 * knots[1].x;
            rhs[n - 1] = (8 * knots[n - 1].x + knots[n].x) / 2.0;
            // Get first control points X-values.
            var x = this.getFirstControlPoints(rhs);

            // Set right hand side Y values.
            for (i = 1; i < n - 1; ++i) {
                rhs[i] = 4 * knots[i].y + 2 * knots[i + 1].y;
            }
            rhs[0] = knots[0].y + 2 * knots[1].y;
            rhs[n - 1] = (8 * knots[n - 1].y + knots[n].y) / 2.0;
            // Get first control points Y-values.
            var y = this.getFirstControlPoints(rhs);

            // Fill output arrays.
            for (i = 0; i < n; i++) {
                // First control point.
                firstControlPoints.push(Point(x[i], y[i]));
                // Second control point.
                if (i < n - 1) {
                    secondControlPoints.push(Point(2 * knots [i + 1].x - x[i + 1],
                                                   2 * knots[i + 1].y - y[i + 1]));
                } else {
                    secondControlPoints.push(Point((knots[n].x + x[n - 1]) / 2,
                                                   (knots[n].y + y[n - 1]) / 2));
                }
            }
            return [firstControlPoints, secondControlPoints];
        },

        // Divide a Bezier curve into two at point defined by value 't' <0,1>.
        // Using deCasteljau algorithm. http://math.stackexchange.com/a/317867
        // @param control points (start, control start, control end, end)
        // @return a function accepts t and returns 2 curves each defined by 4 control points.
        getCurveDivider: function(p0, p1, p2, p3) {

            return function divideCurve(t) {

                var l = Line(p0, p1).pointAt(t);
                var m = Line(p1, p2).pointAt(t);
                var n = Line(p2, p3).pointAt(t);
                var p = Line(l, m).pointAt(t);
                var q = Line(m, n).pointAt(t);
                var r = Line(p, q).pointAt(t);
                return [{ p0: p0, p1: l, p2: p, p3: r }, { p0: r, p1: q, p2: n, p3: p3 }];
            };
        },

        // Solves a tridiagonal system for one of coordinates (x or y) of first Bezier control points.
        // @param rhs Right hand side vector.
        // @return Solution vector.
        getFirstControlPoints: function(rhs) {

            var n = rhs.length;
            // `x` is a solution vector.
            var x = [];
            var tmp = [];
            var b = 2.0;

            x[0] = rhs[0] / b;
            // Decomposition and forward substitution.
            for (var i = 1; i < n; i++) {
                tmp[i] = 1 / b;
                b = (i < n - 1 ? 4.0 : 3.5) - tmp[i];
                x[i] = (rhs[i] - x[i - 1]) / b;
            }
            for (i = 1; i < n; i++) {
                // Backsubstitution.
                x[n - i - 1] -= tmp[n - i] * x[n - i];
            }
            return x;
        },

        // Solves an inversion problem -- Given the (x, y) coordinates of a point which lies on
        // a parametric curve x = x(t)/w(t), y = y(t)/w(t), ﬁnd the parameter value t
        // which corresponds to that point.
        // @param control points (start, control start, control end, end)
        // @return a function accepts a point and returns t.
        getInversionSolver: function(p0, p1, p2, p3) {

            var pts = arguments;
            function l(i, j) {
                // calculates a determinant 3x3
                // [p.x  p.y  1]
                // [pi.x pi.y 1]
                // [pj.x pj.y 1]
                var pi = pts[i];
                var pj = pts[j];
                return function(p) {
                    var w = (i % 3 ? 3 : 1) * (j % 3 ? 3 : 1);
                    var lij = p.x * (pi.y - pj.y) + p.y * (pj.x - pi.x) + pi.x * pj.y - pi.y * pj.x;
                    return w * lij;
                };
            }
            return function solveInversion(p) {
                var ct = 3 * l(2, 3)(p1);
                var c1 = l(1, 3)(p0) / ct;
                var c2 = -l(2, 3)(p0) / ct;
                var la = c1 * l(3, 1)(p) + c2 * (l(3, 0)(p) + l(2, 1)(p)) + l(2, 0)(p);
                var lb = c1 * l(3, 0)(p) + c2 * l(2, 0)(p) + l(1, 0)(p);
                return lb / (lb - la);
            };
        }
    };

    var Ellipse = g.Ellipse = function(c, a, b) {

        if (!(this instanceof Ellipse)) {
            return new Ellipse(c, a, b);
        }

        if (c instanceof Ellipse) {
            return new Ellipse(Point(c), c.a, c.b);
        }

        c = Point(c);
        this.x = c.x;
        this.y = c.y;
        this.a = a;
        this.b = b;
    };

    g.Ellipse.fromRect = function(rect) {

        rect = Rect(rect);
        return Ellipse(rect.center(), rect.width / 2, rect.height / 2);
    };

    g.Ellipse.prototype = {

        bbox: function() {

            return Rect(this.x - this.a, this.y - this.b, 2 * this.a, 2 * this.b);
        },

        clone: function() {

            return Ellipse(this);
        },

        /**
         * @param {g.Point} point
         * @returns {number} result < 1 - inside ellipse, result == 1 - on ellipse boundary, result > 1 - outside
         */
        normalizedDistance: function(point) {

            var x0 = point.x;
            var y0 = point.y;
            var a = this.a;
            var b = this.b;
            var x = this.x;
            var y = this.y;

            return ((x0 - x) * (x0 - x)) / (a * a ) + ((y0 - y) * (y0 - y)) / (b * b);
        },

        // inflate by dx and dy
        // @param dx {delta_x} representing additional size to x
        // @param dy {delta_y} representing additional size to y -
        // dy param is not required -> in that case y is sized by dx
        inflate: function(dx, dy) {
            if (dx === undefined) {
                dx = 0;
            }

            if (dy === undefined) {
                dy = dx;
            }

            this.a += 2 * dx;
            this.b += 2 * dy;

            return this;
        },


        /**
         * @param {g.Point} p
         * @returns {boolean}
         */
        containsPoint: function(p) {

            return this.normalizedDistance(p) <= 1;
        },

        /**
         * @returns {g.Point}
         */
        center: function() {

            return Point(this.x, this.y);
        },

        /** Compute angle between tangent and x axis
         * @param {g.Point} p Point of tangency, it has to be on ellipse boundaries.
         * @returns {number} angle between tangent and x axis
         */
        tangentTheta: function(p) {

            var refPointDelta = 30;
            var x0 = p.x;
            var y0 = p.y;
            var a = this.a;
            var b = this.b;
            var center = this.bbox().center();
            var m = center.x;
            var n = center.y;

            var q1 = x0 > center.x + a / 2;
            var q3 = x0 < center.x - a / 2;

            var y, x;
            if (q1 || q3) {
                y = x0 > center.x ? y0 - refPointDelta : y0 + refPointDelta;
                x = (a * a / (x0 - m)) - (a * a * (y0 - n) * (y - n)) / (b * b * (x0 - m)) + m;
            } else {
                x = y0 > center.y ? x0 + refPointDelta : x0 - refPointDelta;
                y = ( b * b / (y0 - n)) - (b * b * (x0 - m) * (x - m)) / (a * a * (y0 - n)) + n;
            }

            return g.point(x, y).theta(p);

        },

        equals: function(ellipse) {

            ellipse = Ellipse(ellipse);
            return ellipse.x === this.x &&
                    ellipse.y === this.y &&
                    ellipse.a === this.a &&
                    ellipse.b === this.b;
        },

        // Find point on me where line from my center to
        // point p intersects my boundary.
        // @param {number} angle If angle is specified, intersection with rotated ellipse is computed.
        intersectionWithLineFromCenterToPoint: function(p, angle) {

            p = Point(p);
            if (angle) p.rotate(Point(this.x, this.y), angle);
            var dx = p.x - this.x;
            var dy = p.y - this.y;
            var result;
            if (dx === 0) {
                result = this.bbox().pointNearestToPoint(p);
                if (angle) return result.rotate(Point(this.x, this.y), -angle);
                return result;
            }
            var m = dy / dx;
            var mSquared = m * m;
            var aSquared = this.a * this.a;
            var bSquared = this.b * this.b;
            var x = sqrt(1 / ((1 / aSquared) + (mSquared / bSquared)));

            x = dx < 0 ? -x : x;
            var y = m * x;
            result = Point(this.x + x, this.y + y);
            if (angle) return result.rotate(Point(this.x, this.y), -angle);
            return result;
        },

        toString: function() {

            return Point(this.x, this.y).toString() + ' ' + this.a + ' ' + this.b;
        }
    };

    var Line = g.Line = function(p1, p2) {

        if (!(this instanceof Line)) {
            return new Line(p1, p2);
        }

        this.start = Point(p1);
        this.end = Point(p2);
    };

    g.Line.prototype = {

        // @return the bearing (cardinal direction) of the line. For example N, W, or SE.
        // @returns {String} One of the following bearings : NE, E, SE, S, SW, W, NW, N.
        bearing: function() {

            var lat1 = toRad(this.start.y);
            var lat2 = toRad(this.end.y);
            var lon1 = this.start.x;
            var lon2 = this.end.x;
            var dLon = toRad(lon2 - lon1);
            var y = sin(dLon) * cos(lat2);
            var x = cos(lat1) * sin(lat2) - sin(lat1) * cos(lat2) * cos(dLon);
            var brng = toDeg(atan2(y, x));

            var bearings = ['NE', 'E', 'SE', 'S', 'SW', 'W', 'NW', 'N'];

            var index = brng - 22.5;
            if (index < 0)
                index += 360;
            index = parseInt(index / 45);

            return bearings[index];
        },

        clone: function() {

            return Line(this);
        },

        equals: function(l) {

            return this.start.x === l.start.x &&
                    this.start.y === l.start.y &&
                    this.end.x === l.end.x &&
                    this.end.y === l.end.y;
        },

        // @return {point} Point where I'm intersecting a line.
        // @return [point] Points where I'm intersecting a rectangle.
        // @see Squeak Smalltalk, LineSegment>>intersectionWith:
        intersect: function(l) {

            if (l instanceof Line) {
                // Passed in parameter is a line.

                var pt1Dir = Point(this.end.x - this.start.x, this.end.y - this.start.y);
                var pt2Dir = Point(l.end.x - l.start.x, l.end.y - l.start.y);
                var det = (pt1Dir.x * pt2Dir.y) - (pt1Dir.y * pt2Dir.x);
                var deltaPt = Point(l.start.x - this.start.x, l.start.y - this.start.y);
                var alpha = (deltaPt.x * pt2Dir.y) - (deltaPt.y * pt2Dir.x);
                var beta = (deltaPt.x * pt1Dir.y) - (deltaPt.y * pt1Dir.x);

                if (det === 0 ||
                    alpha * det < 0 ||
                    beta * det < 0) {
                    // No intersection found.
                    return null;
                }
                if (det > 0) {
                    if (alpha > det || beta > det) {
                        return null;
                    }
                } else {
                    if (alpha < det || beta < det) {
                        return null;
                    }
                }
                return Point(this.start.x + (alpha * pt1Dir.x / det),
                             this.start.y + (alpha * pt1Dir.y / det));

            } else if (l instanceof Rect) {
                // Passed in parameter is a rectangle.

                var r = l;
                var rectLines = [ r.topLine(), r.rightLine(), r.bottomLine(), r.leftLine() ];
                var points = [];
                var dedupeArr = [];
                var pt, i;

                for (i = 0; i < rectLines.length; i ++) {
                    pt = this.intersect(rectLines[i]);
                    if (pt !== null && dedupeArr.indexOf(pt.toString()) < 0) {
                        points.push(pt);
                        dedupeArr.push(pt.toString());
                    }
                }

                return points.length > 0 ? points : null;
            }

            // Passed in parameter is neither a Line nor a Rectangle.
            return null;
        },

        // @return {double} length of the line
        length: function() {
            return sqrt(this.squaredLength());
        },

        // @return {point} my midpoint
        midpoint: function() {
            return Point((this.start.x + this.end.x) / 2,
                         (this.start.y + this.end.y) / 2);
        },

        // @return {point} my point at 't' <0,1>
        pointAt: function(t) {

            var x = (1 - t) * this.start.x + t * this.end.x;
            var y = (1 - t) * this.start.y + t * this.end.y;
            return Point(x, y);
        },

        // @return {number} the offset of the point `p` from the line. + if the point `p` is on the right side of the line, - if on the left and 0 if on the line.
        pointOffset: function(p) {

            // Find the sign of the determinant of vectors (start,end), where p is the query point.
            return ((this.end.x - this.start.x) * (p.y - this.start.y) - (this.end.y - this.start.y) * (p.x - this.start.x)) / 2;
        },

        // @return {integer} length without sqrt
        // @note for applications where the exact length is not necessary (e.g. compare only)
        squaredLength: function() {
            var x0 = this.start.x;
            var y0 = this.start.y;
            var x1 = this.end.x;
            var y1 = this.end.y;
            return (x0 -= x1) * x0 + (y0 -= y1) * y0;
        },

        toString: function() {
            return this.start.toString() + ' ' + this.end.toString();
        }
    };

    // For backwards compatibility:
    g.Line.prototype.intersection = g.Line.prototype.intersect;

    /*
        Point is the most basic object consisting of x/y coordinate.

        Possible instantiations are:
        * `Point(10, 20)`
        * `new Point(10, 20)`
        * `Point('10 20')`
        * `Point(Point(10, 20))`
    */
    var Point = g.Point = function(x, y) {

        if (!(this instanceof Point)) {
            return new Point(x, y);
        }

        if (typeof x === 'string') {
            var xy = x.split(x.indexOf('@') === -1 ? ' ' : '@');
            x = parseInt(xy[0], 10);
            y = parseInt(xy[1], 10);
        } else if (Object(x) === x) {
            y = x.y;
            x = x.x;
        }

        this.x = x === undefined ? 0 : x;
        this.y = y === undefined ? 0 : y;
    };

    // Alternative constructor, from polar coordinates.
    // @param {number} Distance.
    // @param {number} Angle in radians.
    // @param {point} [optional] Origin.
    g.Point.fromPolar = function(distance, angle, origin) {

        origin = (origin && Point(origin)) || Point(0, 0);
        var x = abs(distance * cos(angle));
        var y = abs(distance * sin(angle));
        var deg = normalizeAngle(toDeg(angle));

        if (deg < 90) {
            y = -y;
        } else if (deg < 180) {
            x = -x;
            y = -y;
        } else if (deg < 270) {
            x = -x;
        }

        return Point(origin.x + x, origin.y + y);
    };

    // Create a point with random coordinates that fall into the range `[x1, x2]` and `[y1, y2]`.
    g.Point.random = function(x1, x2, y1, y2) {

        return Point(floor(random() * (x2 - x1 + 1) + x1), floor(random() * (y2 - y1 + 1) + y1));
    };

    g.Point.prototype = {

        // If point lies outside rectangle `r`, return the nearest point on the boundary of rect `r`,
        // otherwise return point itself.
        // (see Squeak Smalltalk, Point>>adhereTo:)
        adhereToRect: function(r) {

            if (r.containsPoint(this)) {
                return this;
            }

            this.x = mmin(mmax(this.x, r.x), r.x + r.width);
            this.y = mmin(mmax(this.y, r.y), r.y + r.height);
            return this;
        },

        // Return the bearing between me and the given point.
        bearing: function(point) {

            return Line(this, point).bearing();
        },

        // Returns change in angle from my previous position (-dx, -dy) to my new position
        // relative to ref point.
        changeInAngle: function(dx, dy, ref) {

            // Revert the translation and measure the change in angle around x-axis.
            return Point(this).offset(-dx, -dy).theta(ref) - this.theta(ref);
        },

        clone: function() {

            return Point(this);
        },

        difference: function(dx, dy) {

            if ((Object(dx) === dx)) {
                dy = dx.y;
                dx = dx.x;
            }

            return Point(this.x - (dx || 0), this.y - (dy || 0));
        },

        // Returns distance between me and point `p`.
        distance: function(p) {

            return Line(this, p).length();
        },

        equals: function(p) {

            return this.x === p.x && this.y === p.y;
        },

        magnitude: function() {

            return sqrt((this.x * this.x) + (this.y * this.y)) || 0.01;
        },

        // Returns a manhattan (taxi-cab) distance between me and point `p`.
        manhattanDistance: function(p) {

            return abs(p.x - this.x) + abs(p.y - this.y);
        },

        // Move point on line starting from ref ending at me by
        // distance distance.
        move: function(ref, distance) {

            var theta = toRad(Point(ref).theta(this));
            return this.offset(cos(theta) * distance, -sin(theta) * distance);
        },

        // Scales x and y such that the distance between the point and the origin (0,0) is equal to the given length.
        normalize: function(length) {

            var scale = (length || 1) / this.magnitude();
            return this.scale(scale, scale);
        },

        // Offset me by the specified amount.
        offset: function(dx, dy) {

            if ((Object(dx) === dx)) {
                dy = dx.y;
                dx = dx.x;
            }

            this.x += dx || 0;
            this.y += dy || 0;
            return this;
        },

        // Returns a point that is the reflection of me with
        // the center of inversion in ref point.
        reflection: function(ref) {

            return Point(ref).move(this, this.distance(ref));
        },

        // Rotate point by angle around origin.
        rotate: function(origin, angle) {

            angle = (angle + 360) % 360;
            this.toPolar(origin);
            this.y += toRad(angle);
            var point = Point.fromPolar(this.x, this.y, origin);
            this.x = point.x;
            this.y = point.y;
            return this;
        },

        round: function(precision) {

            var f = pow(10, precision || 0);
            this.x = round(this.x * f) / f;
            this.y = round(this.y * f) / f;
            return this;
        },

        // Scale point with origin.
        scale: function(sx, sy, origin) {

            origin = (origin && Point(origin)) || Point(0, 0);
            this.x = origin.x + sx * (this.x - origin.x);
            this.y = origin.y + sy * (this.y - origin.y);
            return this;
        },

        snapToGrid: function(gx, gy) {

            this.x = snapToGrid(this.x, gx);
            this.y = snapToGrid(this.y, gy || gx);
            return this;
        },

        // Compute the angle between me and `p` and the x axis.
        // (cartesian-to-polar coordinates conversion)
        // Return theta angle in degrees.
        theta: function(p) {

            p = Point(p);
            // Invert the y-axis.
            var y = -(p.y - this.y);
            var x = p.x - this.x;
            // Makes sure that the comparison with zero takes rounding errors into account.
            var PRECISION = 10;
            // Note that `atan2` is not defined for `x`, `y` both equal zero.
            var rad = (y.toFixed(PRECISION) == 0 && x.toFixed(PRECISION) == 0) ? 0 : atan2(y, x);

            // Correction for III. and IV. quadrant.
            if (rad < 0) {
                rad = 2 * PI + rad;
            }
            return 180 * rad / PI;
        },

        toJSON: function() {

            return { x: this.x, y: this.y };
        },

        // Converts rectangular to polar coordinates.
        // An origin can be specified, otherwise it's 0@0.
        toPolar: function(o) {

            o = (o && Point(o)) || Point(0, 0);
            var x = this.x;
            var y = this.y;
            this.x = sqrt((x - o.x) * (x - o.x) + (y - o.y) * (y - o.y)); // r
            this.y = toRad(o.theta(Point(x, y)));
            return this;
        },

        toString: function() {

            return this.x + '@' + this.y;
        },

        update: function(x, y) {

            this.x = x || 0;
            this.y = y || 0;
            return this;
        }
    };

    var Rect = g.Rect = function(x, y, w, h) {

        if (!(this instanceof Rect)) {
            return new Rect(x, y, w, h);
        }

        if ((Object(x) === x)) {
            y = x.y;
            w = x.width;
            h = x.height;
            x = x.x;
        }

        this.x = x === undefined ? 0 : x;
        this.y = y === undefined ? 0 : y;
        this.width = w === undefined ? 0 : w;
        this.height = h === undefined ? 0 : h;
    };

    g.Rect.fromEllipse = function(e) {

        e = Ellipse(e);
        return Rect(e.x - e.a, e.y - e.b, 2 * e.a, 2 * e.b);
    };

    g.Rect.prototype = {

        // Find my bounding box when I'm rotated with the center of rotation in the center of me.
        // @return r {rectangle} representing a bounding box
        bbox: function(angle) {

            var theta = toRad(angle || 0);
            var st = abs(sin(theta));
            var ct = abs(cos(theta));
            var w = this.width * ct + this.height * st;
            var h = this.width * st + this.height * ct;
            return Rect(this.x + (this.width - w) / 2, this.y + (this.height - h) / 2, w, h);
        },

        bottomLeft: function() {

            return Point(this.x, this.y + this.height);
        },

        bottomLine: function() {

            return Line(this.bottomLeft(), this.corner());
        },

        bottomMiddle: function() {

            return Point(this.x + this.width / 2, this.y + this.height);
        },

        center: function() {

            return Point(this.x + this.width / 2, this.y + this.height / 2);
        },

        clone: function() {

            return Rect(this);
        },

        // @return {bool} true if point p is insight me
        containsPoint: function(p) {

            p = Point(p);
            return p.x >= this.x && p.x <= this.x + this.width && p.y >= this.y && p.y <= this.y + this.height;
        },

        // @return {bool} true if rectangle `r` is inside me.
        containsRect: function(r) {

            var r0 = Rect(this).normalize();
            var r1 = Rect(r).normalize();
            var w0 = r0.width;
            var h0 = r0.height;
            var w1 = r1.width;
            var h1 = r1.height;

            if (!w0 || !h0 || !w1 || !h1) {
                // At least one of the dimensions is 0
                return false;
            }

            var x0 = r0.x;
            var y0 = r0.y;
            var x1 = r1.x;
            var y1 = r1.y;

            w1 += x1;
            w0 += x0;
            h1 += y1;
            h0 += y0;

            return x0 <= x1 && w1 <= w0 && y0 <= y1 && h1 <= h0;
        },

        corner: function() {

            return Point(this.x + this.width, this.y + this.height);
        },

        // @return {boolean} true if rectangles are equal.
        equals: function(r) {

            var mr = Rect(this).normalize();
            var nr = Rect(r).normalize();
            return mr.x === nr.x && mr.y === nr.y && mr.width === nr.width && mr.height === nr.height;
        },

        // @return {rect} if rectangles intersect, {null} if not.
        intersect: function(r) {

            var myOrigin = this.origin();
            var myCorner = this.corner();
            var rOrigin = r.origin();
            var rCorner = r.corner();

            // No intersection found
            if (rCorner.x <= myOrigin.x ||
                rCorner.y <= myOrigin.y ||
                rOrigin.x >= myCorner.x ||
                rOrigin.y >= myCorner.y) return null;

            var x = Math.max(myOrigin.x, rOrigin.x);
            var y = Math.max(myOrigin.y, rOrigin.y);

            return Rect(x, y, Math.min(myCorner.x, rCorner.x) - x, Math.min(myCorner.y, rCorner.y) - y);
        },

        // Find point on my boundary where line starting
        // from my center ending in point p intersects me.
        // @param {number} angle If angle is specified, intersection with rotated rectangle is computed.
        intersectionWithLineFromCenterToPoint: function(p, angle) {

            p = Point(p);
            var center = Point(this.x + this.width / 2, this.y + this.height / 2);
            var result;
            if (angle) p.rotate(center, angle);

            // (clockwise, starting from the top side)
            var sides = [
                Line(this.origin(), this.topRight()),
                Line(this.topRight(), this.corner()),
                Line(this.corner(), this.bottomLeft()),
                Line(this.bottomLeft(), this.origin())
            ];
            var connector = Line(center, p);

            for (var i = sides.length - 1; i >= 0; --i) {
                var intersection = sides[i].intersection(connector);
                if (intersection !== null) {
                    result = intersection;
                    break;
                }
            }
            if (result && angle) result.rotate(center, -angle);
            return result;
        },

        leftLine: function() {

            return Line(this.origin(), this.bottomLeft());
        },

        leftMiddle: function() {

            return Point(this.x , this.y + this.height / 2);
        },

        // Move and expand me.
        // @param r {rectangle} representing deltas
        moveAndExpand: function(r) {

            this.x += r.x || 0;
            this.y += r.y || 0;
            this.width += r.width || 0;
            this.height += r.height || 0;
            return this;
        },

        // inflate by dx and dy, recompute origin [x, y]
        // @param dx {delta_x} representing additional size to x
        // @param dy {delta_y} representing additional size to y -
        // dy param is not required -> in that case y is sized by dx
        inflate: function(dx, dy) {
            if (dx === undefined) {
                dx = 0;
            }

            if (dy === undefined) {
                dy = dx;
            }

            this.x -= dx;
            this.y -= dy;
            this.width += 2 * dx;
            this.height += 2 * dy;

            return this;
        },

        // Normalize the rectangle; i.e., make it so that it has a non-negative width and height.
        // If width < 0 the function swaps the left and right corners,
        // and it swaps the top and bottom corners if height < 0
        // like in http://qt-project.org/doc/qt-4.8/qrectf.html#normalized
        normalize: function() {

            var newx = this.x;
            var newy = this.y;
            var newwidth = this.width;
            var newheight = this.height;
            if (this.width < 0) {
                newx = this.x + this.width;
                newwidth = -this.width;
            }
            if (this.height < 0) {
                newy = this.y + this.height;
                newheight = -this.height;
            }
            this.x = newx;
            this.y = newy;
            this.width = newwidth;
            this.height = newheight;
            return this;
        },

        origin: function() {

            return Point(this.x, this.y);
        },

        // @return {point} a point on my boundary nearest to the given point.
        // @see Squeak Smalltalk, Rectangle>>pointNearestTo:
        pointNearestToPoint: function(point) {

            point = Point(point);
            if (this.containsPoint(point)) {
                var side = this.sideNearestToPoint(point);
                switch (side){
                    case 'right': return Point(this.x + this.width, point.y);
                    case 'left': return Point(this.x, point.y);
                    case 'bottom': return Point(point.x, this.y + this.height);
                    case 'top': return Point(point.x, this.y);
                }
            }
            return point.adhereToRect(this);
        },

        rightLine: function() {

            return Line(this.topRight(), this.corner());
        },

        rightMiddle: function() {

            return Point(this.x + this.width, this.y + this.height / 2);
        },

        round: function(precision) {

            var f = pow(10, precision || 0);
            this.x = round(this.x * f) / f;
            this.y = round(this.y * f) / f;
            this.width = round(this.width * f) / f;
            this.height = round(this.height * f) / f;
            return this;
        },

        // Scale rectangle with origin.
        scale: function(sx, sy, origin) {

            origin = this.origin().scale(sx, sy, origin);
            this.x = origin.x;
            this.y = origin.y;
            this.width *= sx;
            this.height *= sy;
            return this;
        },

        maxRectScaleToFit: function(rect, origin) {

            rect = g.Rect(rect);
            origin || (origin = rect.center());

            var sx1, sx2, sx3, sx4, sy1, sy2, sy3, sy4;
            var ox = origin.x;
            var oy = origin.y;

            // Here we find the maximal possible scale for all corner points (for x and y axis) of the rectangle,
            // so when the scale is applied the point is still inside the rectangle.

            sx1 = sx2 = sx3 = sx4 = sy1 = sy2 = sy3 = sy4 = Infinity;

            // Top Left
            var p1 = rect.origin();
            if (p1.x < ox) {
                sx1 = (this.x - ox) / (p1.x - ox);
            }
            if (p1.y < oy) {
                sy1 = (this.y - oy) / (p1.y - oy);
            }
            // Bottom Right
            var p2 = rect.corner();
            if (p2.x > ox) {
                sx2 = (this.x + this.width - ox) / (p2.x - ox);
            }
            if (p2.y > oy) {
                sy2 = (this.y + this.height - oy) / (p2.y - oy);
            }
            // Top Right
            var p3 = rect.topRight();
            if (p3.x > ox) {
                sx3 = (this.x + this.width - ox) / (p3.x - ox);
            }
            if (p3.y < oy) {
                sy3 = (this.y - oy) / (p3.y - oy);
            }
            // Bottom Left
            var p4 = rect.bottomLeft();
            if (p4.x < ox) {
                sx4 = (this.x - ox) / (p4.x - ox);
            }
            if (p4.y > oy) {
                sy4 = (this.y + this.height - oy) / (p4.y - oy);
            }

            return {
                sx: Math.min(sx1, sx2, sx3, sx4),
                sy: Math.min(sy1, sy2, sy3, sy4)
            };
        },

        maxRectUniformScaleToFit: function(rect, origin) {

            var scale = this.maxRectScaleToFit(rect, origin);
            return Math.min(scale.sx, scale.sy);
        },

        // @return {string} (left|right|top|bottom) side which is nearest to point
        // @see Squeak Smalltalk, Rectangle>>sideNearestTo:
        sideNearestToPoint: function(point) {

            point = Point(point);
            var distToLeft = point.x - this.x;
            var distToRight = (this.x + this.width) - point.x;
            var distToTop = point.y - this.y;
            var distToBottom = (this.y + this.height) - point.y;
            var closest = distToLeft;
            var side = 'left';

            if (distToRight < closest) {
                closest = distToRight;
                side = 'right';
            }
            if (distToTop < closest) {
                closest = distToTop;
                side = 'top';
            }
            if (distToBottom < closest) {
                closest = distToBottom;
                side = 'bottom';
            }
            return side;
        },

        snapToGrid: function(gx, gy) {

            var origin = this.origin().snapToGrid(gx, gy);
            var corner = this.corner().snapToGrid(gx, gy);
            this.x = origin.x;
            this.y = origin.y;
            this.width = corner.x - origin.x;
            this.height = corner.y - origin.y;
            return this;
        },

        topLine: function() {

            return Line(this.origin(), this.topRight());
        },

        topMiddle: function() {

            return Point(this.x + this.width / 2, this.y);
        },

        topRight: function() {

            return Point(this.x + this.width, this.y);
        },

        toJSON: function() {

            return { x: this.x, y: this.y, width: this.width, height: this.height };
        },

        toString: function() {

            return this.origin().toString() + ' ' + this.corner().toString();
        },

        // @return {rect} representing the union of both rectangles.
        union: function(rect) {

            var myOrigin = this.origin();
            var myCorner = this.corner();
            var rOrigin = rect.origin();
            var rCorner = rect.corner();

            var originX = Math.min(myOrigin.x, rOrigin.x);
            var originY = Math.min(myOrigin.y, rOrigin.y);
            var cornerX = Math.max(myCorner.x, rCorner.x);
            var cornerY = Math.max(myCorner.y, rCorner.y);

            return Rect(originX, originY, cornerX - originX, cornerY - originY);
        }
    };

    var normalizeAngle = g.normalizeAngle = function(angle) {

        return (angle % 360) + (angle < 0 ? 360 : 0);
    };

    g.scale = {

        // Return the `value` from the `domain` interval scaled to the `range` interval.
        linear: function(domain, range, value) {

            var domainSpan = domain[1] - domain[0];
            var rangeSpan = range[1] - range[0];
            return (((value - domain[0]) / domainSpan) * rangeSpan + range[0]) || 0;
        }
    };

    var snapToGrid = g.snapToGrid = function(value, gridSize) {

        return gridSize * Math.round(value / gridSize);
    };

    var toDeg = g.toDeg = function(rad) {

        return (180 * rad / PI) % 360;
    };

    var toRad = g.toRad = function(deg, over360) {

        over360 = over360 || false;
        deg = over360 ? deg : (deg % 360);
        return deg * PI / 180;
    };

    // For backwards compatibility:
    g.ellipse = g.Ellipse;
    g.line = g.Line;
    g.point = g.Point;
    g.rect = g.Rect;

    return g;

})();

// Vectorizer.
// -----------

// A tiny library for making your life easier when dealing with SVG.
// The only Vectorizer dependency is the Geometry library.


var V;
var Vectorizer;

V = Vectorizer = (function() {

    'use strict';

    var hasSvg = typeof window === 'object' &&
                !!(
                    window.SVGAngle ||
                    document.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1')
                );

    // SVG support is required.
    if (!hasSvg) {

        // Return a function that throws an error when it is used.
        return function() {
            throw new Error('SVG is required to use Vectorizer.');
        };
    }

    // XML namespaces.
    var ns = {
        xmlns: 'http://www.w3.org/2000/svg',
        xml: 'http://www.w3.org/XML/1998/namespace',
        xlink: 'http://www.w3.org/1999/xlink'
    };

    var SVGversion = '1.1';

    var V = function(el, attrs, children) {

        // This allows using V() without the new keyword.
        if (!(this instanceof V)) {
            return V.apply(Object.create(V.prototype), arguments);
        }

        if (!el) return;

        if (V.isV(el)) {
            el = el.node;
        }

        attrs = attrs || {};

        if (V.isString(el)) {

            if (el.toLowerCase() === 'svg') {

                // Create a new SVG canvas.
                el = V.createSvgDocument();

            } else if (el[0] === '<') {

                // Create element from an SVG string.
                // Allows constructs of type: `document.appendChild(V('<rect></rect>').node)`.

                var svgDoc = V.createSvgDocument(el);

                // Note that `V()` might also return an array should the SVG string passed as
                // the first argument contain more than one root element.
                if (svgDoc.childNodes.length > 1) {

                    // Map child nodes to `V`s.
                    var arrayOfVels = [];
                    var i, len;

                    for (i = 0, len = svgDoc.childNodes.length; i < len; i++) {

                        var childNode = svgDoc.childNodes[i];
                        arrayOfVels.push(new V(document.importNode(childNode, true)));
                    }

                    return arrayOfVels;
                }

                el = document.importNode(svgDoc.firstChild, true);

            } else {

                el = document.createElementNS(ns.xmlns, el);
            }

            V.ensureId(el);
        }

        this.node = el;

        this.setAttributes(attrs);

        if (children) {
            this.append(children);
        }

        return this;
    };

    /**
     * @param {SVGGElement} toElem
     * @returns {SVGMatrix}
     */
    V.prototype.getTransformToElement = function(toElem) {
        toElem = V.toNode(toElem);
        return toElem.getScreenCTM().inverse().multiply(this.node.getScreenCTM());
    };

    /**
     * @param {SVGMatrix} matrix
     * @param {Object=} opt
     * @returns {Vectorizer|SVGMatrix} Setter / Getter
     */
    V.prototype.transform = function(matrix, opt) {

        var node = this.node;
        if (V.isUndefined(matrix)) {
            return V.transformStringToMatrix(this.attr('transform'));
        }

        if (opt && opt.absolute) {
            return this.attr('transform', V.matrixToTransformString(matrix));
        }

        var svgTransform = V.createSVGTransform(matrix);
        node.transform.baseVal.appendItem(svgTransform);
        return this;
    };

    V.prototype.translate = function(tx, ty, opt) {

        opt = opt || {};
        ty = ty || 0;

        var transformAttr = this.attr('transform') || '';
        var transform = V.parseTransformString(transformAttr);
        transformAttr = transform.value;
        // Is it a getter?
        if (V.isUndefined(tx)) {
            return transform.translate;
        }

        transformAttr = transformAttr.replace(/translate\([^\)]*\)/g, '').trim();

        var newTx = opt.absolute ? tx : transform.translate.tx + tx;
        var newTy = opt.absolute ? ty : transform.translate.ty + ty;
        var newTranslate = 'translate(' + newTx + ',' + newTy + ')';

        // Note that `translate()` is always the first transformation. This is
        // usually the desired case.
        this.attr('transform', (newTranslate + ' ' + transformAttr).trim());
        return this;
    };

    V.prototype.rotate = function(angle, cx, cy, opt) {

        opt = opt || {};

        var transformAttr = this.attr('transform') || '';
        var transform = V.parseTransformString(transformAttr);
        transformAttr = transform.value;

        // Is it a getter?
        if (V.isUndefined(angle)) {
            return transform.rotate;
        }

        transformAttr = transformAttr.replace(/rotate\([^\)]*\)/g, '').trim();

        angle %= 360;

        var newAngle = opt.absolute ? angle : transform.rotate.angle + angle;
        var newOrigin = (cx !== undefined && cy !== undefined) ? ',' + cx + ',' + cy : '';
        var newRotate = 'rotate(' + newAngle + newOrigin + ')';

        this.attr('transform', (transformAttr + ' ' + newRotate).trim());
        return this;
    };

    // Note that `scale` as the only transformation does not combine with previous values.
    V.prototype.scale = function(sx, sy) {

        sy = V.isUndefined(sy) ? sx : sy;

        var transformAttr = this.attr('transform') || '';
        var transform = V.parseTransformString(transformAttr);
        transformAttr = transform.value;

        // Is it a getter?
        if (V.isUndefined(sx)) {
            return transform.scale;
        }

        transformAttr = transformAttr.replace(/scale\([^\)]*\)/g, '').trim();

        var newScale = 'scale(' + sx + ',' + sy + ')';

        this.attr('transform', (transformAttr + ' ' + newScale).trim());
        return this;
    };

    // Get SVGRect that contains coordinates and dimension of the real bounding box,
    // i.e. after transformations are applied.
    // If `target` is specified, bounding box will be computed relatively to `target` element.
    V.prototype.bbox = function(withoutTransformations, target) {

        // If the element is not in the live DOM, it does not have a bounding box defined and
        // so fall back to 'zero' dimension element.
        if (!this.node.ownerSVGElement) return { x: 0, y: 0, width: 0, height: 0 };

        var box;
        try {

            box = this.node.getBBox();
            // We are creating a new object as the standard says that you can't
            // modify the attributes of a bbox.
            box = { x: box.x, y: box.y, width: box.width, height: box.height };

        } catch (e) {

            // Fallback for IE.
            box = {
                x: this.node.clientLeft,
                y: this.node.clientTop,
                width: this.node.clientWidth,
                height: this.node.clientHeight
            };
        }

        if (withoutTransformations) {

            return box;
        }

        var matrix = this.getTransformToElement(target || this.node.ownerSVGElement);

        return V.transformRect(box, matrix);
    };

    V.prototype.text = function(content, opt) {

        // Replace all spaces with the Unicode No-break space (http://www.fileformat.info/info/unicode/char/a0/index.htm).
        // IE would otherwise collapse all spaces into one.
        content = V.sanitizeText(content);
        opt = opt || {};
        var lines = content.split('\n');
        var tspan;

        // `alignment-baseline` does not work in Firefox.
        // Setting `dominant-baseline` on the `<text>` element doesn't work in IE9.
        // In order to have the 0,0 coordinate of the `<text>` element (or the first `<tspan>`)
        // in the top left corner we translate the `<text>` element by `0.8em`.
        // See `http://www.w3.org/Graphics/SVG/WG/wiki/How_to_determine_dominant_baseline`.
        // See also `http://apike.ca/prog_svg_text_style.html`.
        var y = this.attr('y');
        if (!y) {
            this.attr('y', '0.8em');
        }

        // An empty text gets rendered into the DOM in webkit-based browsers.
        // In order to unify this behaviour across all browsers
        // we rather hide the text element when it's empty.
        if (content) {
            this.removeAttr('display');
        } else {
            this.attr('display', 'none');
        }

        // Preserve spaces. In other words, we do not want consecutive spaces to get collapsed to one.
        this.attr('xml:space', 'preserve');

        // Easy way to erase all `<tspan>` children;
        this.node.textContent = '';

        var textNode = this.node;

        if (opt.textPath) {

            // Wrap the text in the SVG <textPath> element that points
            // to a path defined by `opt.textPath` inside the internal `<defs>` element.
            var defs = this.find('defs');
            if (defs.length === 0) {
                defs = V('defs');
                this.append(defs);
            }

            // If `opt.textPath` is a plain string, consider it to be directly the
            // SVG path data for the text to go along (this is a shortcut).
            // Otherwise if it is an object and contains the `d` property, then this is our path.
            var d = Object(opt.textPath) === opt.textPath ? opt.textPath.d : opt.textPath;
            if (d) {
                var path = V('path', { d: d });
                defs.append(path);
            }

            var textPath = V('textPath');
            // Set attributes on the `<textPath>`. The most important one
            // is the `xlink:href` that points to our newly created `<path/>` element in `<defs/>`.
            // Note that we also allow the following construct:
            // `t.text('my text', { textPath: { 'xlink:href': '#my-other-path' } })`.
            // In other words, one can completely skip the auto-creation of the path
            // and use any other arbitrary path that is in the document.
            if (!opt.textPath['xlink:href'] && path) {
                textPath.attr('xlink:href', '#' + path.node.id);
            }

            if (Object(opt.textPath) === opt.textPath) {
                textPath.attr(opt.textPath);
            }
            this.append(textPath);
            // Now all the `<tspan>`s will be inside the `<textPath>`.
            textNode = textPath.node;
        }

        var offset = 0;
        var x = this.attr('x') || 0;

        // Shift all the <tspan> but first by one line (`1em`)
        var lineHeight = opt.lineHeight || '1em';
        if (opt.lineHeight === 'auto') {
            lineHeight = '1.5em';
        }

        for (var i = 0; i < lines.length; i++) {

            var line = lines[i];

            var vLine = V('tspan', { 'class': 'v-line',  dy: (i == 0 ? '0em' : lineHeight), x: x });

            if (line) {

                if (opt.annotations) {

                    // Get the line height based on the biggest font size in the annotations for this line.
                    var maxFontSize = 0;

                    // Find the *compacted* annotations for this line.
                    var lineAnnotations = V.annotateString(lines[i], V.isArray(opt.annotations) ? opt.annotations : [opt.annotations], { offset: -offset, includeAnnotationIndices: opt.includeAnnotationIndices });
                    for (var j = 0; j < lineAnnotations.length; j++) {

                        var annotation = lineAnnotations[j];
                        if (V.isObject(annotation)) {

                            var fontSize = parseInt(annotation.attrs['font-size'], 10);
                            if (fontSize && fontSize > maxFontSize) {
                                maxFontSize = fontSize;
                            }

                            tspan = V('tspan', annotation.attrs);
                            if (opt.includeAnnotationIndices) {
                                // If `opt.includeAnnotationIndices` is `true`,
                                // set the list of indices of all the applied annotations
                                // in the `annotations` attribute. This list is a comma
                                // separated list of indices.
                                tspan.attr('annotations', annotation.annotations);
                            }
                            if (annotation.attrs['class']) {
                                tspan.addClass(annotation.attrs['class']);
                            }
                            tspan.node.textContent = annotation.t;

                        } else {

                            tspan = document.createTextNode(annotation || ' ');

                        }
                        vLine.append(tspan);
                    }

                    if (opt.lineHeight === 'auto' && maxFontSize && i !== 0) {

                        vLine.attr('dy', (maxFontSize * 1.2) + 'px');
                    }

                } else {

                    vLine.node.textContent = line;
                }

            } else {

                // Make sure the textContent is never empty. If it is, add a dummy
                // character and make it invisible, making the following lines correctly
                // relatively positioned. `dy=1em` won't work with empty lines otherwise.
                vLine.addClass('v-empty-line');
                // 'opacity' needs to be specified with fill, stroke. Opacity without specification
                // is not applied in Firefox
                vLine.node.style.fillOpacity = 0;
                vLine.node.style.strokeOpacity = 0;
                vLine.node.textContent = '-';
            }

            V(textNode).append(vLine);

            offset += line.length + 1;      // + 1 = newline character.
        }

        return this;
    };

    /**
     * @public
     * @param {string} name
     * @returns {Vectorizer}
     */
    V.prototype.removeAttr = function(name) {

        var qualifiedName = V.qualifyAttr(name);
        var el = this.node;

        if (qualifiedName.ns) {
            if (el.hasAttributeNS(qualifiedName.ns, qualifiedName.local)) {
                el.removeAttributeNS(qualifiedName.ns, qualifiedName.local);
            }
        } else if (el.hasAttribute(name)) {
            el.removeAttribute(name);
        }
        return this;
    };

    V.prototype.attr = function(name, value) {

        if (V.isUndefined(name)) {

            // Return all attributes.
            var attributes = this.node.attributes;
            var attrs = {};

            for (var i = 0; i < attributes.length; i++) {
                attrs[attributes[i].name] = attributes[i].value;
            }

            return attrs;
        }

        if (V.isString(name) && V.isUndefined(value)) {
            return this.node.getAttribute(name);
        }

        if (typeof name === 'object') {

            for (var attrName in name) {
                if (name.hasOwnProperty(attrName)) {
                    this.setAttribute(attrName, name[attrName]);
                }
            }

        } else {

            this.setAttribute(name, value);
        }

        return this;
    };

    V.prototype.remove = function() {

        if (this.node.parentNode) {
            this.node.parentNode.removeChild(this.node);
        }

        return this;
    };

    V.prototype.empty = function() {

        while (this.node.firstChild) {
            this.node.removeChild(this.node.firstChild);
        }

        return this;
    };

    V.prototype.setAttributes = function(attrs) {

        for (var key in attrs) {
            if (attrs.hasOwnProperty(key)) {
                this.setAttribute(key, attrs[key]);
            }
        }

        return this;
    };

    V.prototype.append = function(els) {

        if (!V.isArray(els)) {
            els = [els];
        }

        for (var i = 0, len = els.length; i < len; i++) {
            this.node.appendChild(V.toNode(els[i]));
        }

        return this;
    };

    V.prototype.prepend = function(els) {

        var child = this.node.firstChild;
        return child ? V(child).before(els) : this.append(els);
    };

    V.prototype.before = function(els) {

        var node = this.node;
        var parent = node.parentNode;

        if (parent) {

            if (!V.isArray(els)) {
                els = [els];
            }

            for (var i = 0, len = els.length; i < len; i++) {
                parent.insertBefore(V.toNode(els[i]), node);
            }
        }

        return this;
    };

    V.prototype.appendTo = function(node) {
        V.toNode(node).appendChild(this.node);
        return this;
    },

    V.prototype.svg = function() {

        return this.node instanceof window.SVGSVGElement ? this : V(this.node.ownerSVGElement);
    };

    V.prototype.defs = function() {

        var defs = this.svg().node.getElementsByTagName('defs');

        return (defs && defs.length) ? V(defs[0]) : undefined;
    };

    V.prototype.clone = function() {

        var clone = V(this.node.cloneNode(true/* deep */));
        // Note that clone inherits also ID. Therefore, we need to change it here.
        clone.node.id = V.uniqueId();
        return clone;
    };

    V.prototype.findOne = function(selector) {

        var found = this.node.querySelector(selector);
        return found ? V(found) : undefined;
    };

    V.prototype.find = function(selector) {

        var vels = [];
        var nodes = this.node.querySelectorAll(selector);

        if (nodes) {

            // Map DOM elements to `V`s.
            for (var i = 0; i < nodes.length; i++) {
                vels.push(V(nodes[i]));
            }
        }

        return vels;
    };

    // Find an index of an element inside its container.
    V.prototype.index = function() {

        var index = 0;
        var node = this.node.previousSibling;

        while (node) {
            // nodeType 1 for ELEMENT_NODE
            if (node.nodeType === 1) index++;
            node = node.previousSibling;
        }

        return index;
    };

    V.prototype.findParentByClass = function(className, terminator) {

        var ownerSVGElement = this.node.ownerSVGElement;
        var node = this.node.parentNode;

        while (node && node !== terminator && node !== ownerSVGElement) {

            var vel = V(node);
            if (vel.hasClass(className)) {
                return vel;
            }

            node = node.parentNode;
        }

        return null;
    };

    // https://jsperf.com/get-common-parent
    V.prototype.contains = function(el) {

        var a = this.node;
        var b = V.toNode(el);
        var bup = b && b.parentNode;

        return (a === bup) || !!(bup && bup.nodeType === 1 && (a.compareDocumentPosition(bup) & 16));
    };

    // Convert global point into the coordinate space of this element.
    V.prototype.toLocalPoint = function(x, y) {

        var svg = this.svg().node;

        var p = svg.createSVGPoint();
        p.x = x;
        p.y = y;

        try {

            var globalPoint = p.matrixTransform(svg.getScreenCTM().inverse());
            var globalToLocalMatrix = this.getTransformToElement(svg).inverse();

        } catch (e) {
            // IE9 throws an exception in odd cases. (`Unexpected call to method or property access`)
            // We have to make do with the original coordianates.
            return p;
        }

        return globalPoint.matrixTransform(globalToLocalMatrix);
    };

    V.prototype.translateCenterToPoint = function(p) {

        var bbox = this.bbox();
        var center = g.rect(bbox).center();

        this.translate(p.x - center.x, p.y - center.y);
    };

    // Efficiently auto-orient an element. This basically implements the orient=auto attribute
    // of markers. The easiest way of understanding on what this does is to imagine the element is an
    // arrowhead. Calling this method on the arrowhead makes it point to the `position` point while
    // being auto-oriented (properly rotated) towards the `reference` point.
    // `target` is the element relative to which the transformations are applied. Usually a viewport.
    V.prototype.translateAndAutoOrient = function(position, reference, target) {

        // Clean-up previously set transformations except the scale. If we didn't clean up the
        // previous transformations then they'd add up with the old ones. Scale is an exception as
        // it doesn't add up, consider: `this.scale(2).scale(2).scale(2)`. The result is that the
        // element is scaled by the factor 2, not 8.

        var s = this.scale();
        this.attr('transform', '');
        this.scale(s.sx, s.sy);

        var svg = this.svg().node;
        var bbox = this.bbox(false, target);

        // 1. Translate to origin.
        var translateToOrigin = svg.createSVGTransform();
        translateToOrigin.setTranslate(-bbox.x - bbox.width / 2, -bbox.y - bbox.height / 2);

        // 2. Rotate around origin.
        var rotateAroundOrigin = svg.createSVGTransform();
        var angle = g.point(position).changeInAngle(position.x - reference.x, position.y - reference.y, reference);
        rotateAroundOrigin.setRotate(angle, 0, 0);

        // 3. Translate to the `position` + the offset (half my width) towards the `reference` point.
        var translateFinal = svg.createSVGTransform();
        var finalPosition = g.point(position).move(reference, bbox.width / 2);
        translateFinal.setTranslate(position.x + (position.x - finalPosition.x), position.y + (position.y - finalPosition.y));

        // 4. Apply transformations.
        var ctm = this.getTransformToElement(target);
        var transform = svg.createSVGTransform();
        transform.setMatrix(
            translateFinal.matrix.multiply(
                rotateAroundOrigin.matrix.multiply(
                    translateToOrigin.matrix.multiply(
                        ctm)))
        );

        // Instead of directly setting the `matrix()` transform on the element, first, decompose
        // the matrix into separate transforms. This allows us to use normal Vectorizer methods
        // as they don't work on matrices. An example of this is to retrieve a scale of an element.
        // this.node.transform.baseVal.initialize(transform);

        var decomposition = V.decomposeMatrix(transform.matrix);

        this.translate(decomposition.translateX, decomposition.translateY);
        this.rotate(decomposition.rotation);
        // Note that scale has been already applied, hence the following line stays commented. (it's here just for reference).
        //this.scale(decomposition.scaleX, decomposition.scaleY);

        return this;
    };

    V.prototype.animateAlongPath = function(attrs, path) {

        path = V.toNode(path);

        var id = V.ensureId(path);
        var animateMotion = V('animateMotion', attrs);
        var mpath = V('mpath', { 'xlink:href': '#' + id });

        animateMotion.append(mpath);

        this.append(animateMotion);
        try {
            animateMotion.node.beginElement();
        } catch (e) {
            // Fallback for IE 9.
            // Run the animation programatically if FakeSmile (`http://leunen.me/fakesmile/`) present
            if (document.documentElement.getAttribute('smiling') === 'fake') {

                // Register the animation. (See `https://answers.launchpad.net/smil/+question/203333`)
                var animation = animateMotion.node;
                animation.animators = [];

                var animationID = animation.getAttribute('id');
                if (animationID) id2anim[animationID] = animation;

                var targets = getTargets(animation);
                for (var i = 0, len = targets.length; i < len; i++) {
                    var target = targets[i];
                    var animator = new Animator(animation, target, i);
                    animators.push(animator);
                    animation.animators[i] = animator;
                    animator.register();
                }
            }
        }
    };

    V.prototype.hasClass = function(className) {

        return new RegExp('(\\s|^)' + className + '(\\s|$)').test(this.node.getAttribute('class'));
    };

    V.prototype.addClass = function(className) {

        if (!this.hasClass(className)) {
            var prevClasses = this.node.getAttribute('class') || '';
            this.node.setAttribute('class', (prevClasses + ' ' + className).trim());
        }

        return this;
    };

    V.prototype.removeClass = function(className) {

        if (this.hasClass(className)) {
            var newClasses = this.node.getAttribute('class').replace(new RegExp('(\\s|^)' + className + '(\\s|$)', 'g'), '$2');
            this.node.setAttribute('class', newClasses);
        }

        return this;
    };

    V.prototype.toggleClass = function(className, toAdd) {

        var toRemove = V.isUndefined(toAdd) ? this.hasClass(className) : !toAdd;

        if (toRemove) {
            this.removeClass(className);
        } else {
            this.addClass(className);
        }

        return this;
    };

    // Interpolate path by discrete points. The precision of the sampling
    // is controlled by `interval`. In other words, `sample()` will generate
    // a point on the path starting at the beginning of the path going to the end
    // every `interval` pixels.
    // The sampler can be very useful for e.g. finding intersection between two
    // paths (finding the two closest points from two samples).
    V.prototype.sample = function(interval) {

        interval = interval || 1;
        var node = this.node;
        var length = node.getTotalLength();
        var samples = [];
        var distance = 0;
        var sample;
        while (distance < length) {
            sample = node.getPointAtLength(distance);
            samples.push({ x: sample.x, y: sample.y, distance: distance });
            distance += interval;
        }
        return samples;
    };

    V.prototype.convertToPath = function() {

        var path = V('path');
        path.attr(this.attr());
        var d = this.convertToPathData();
        if (d) {
            path.attr('d', d);
        }
        return path;
    };

    V.prototype.convertToPathData = function() {

        var tagName = this.node.tagName.toUpperCase();

        switch (tagName) {
            case 'PATH':
                return this.attr('d');
            case 'LINE':
                return V.convertLineToPathData(this.node);
            case 'POLYGON':
                return V.convertPolygonToPathData(this.node);
            case 'POLYLINE':
                return V.convertPolylineToPathData(this.node);
            case 'ELLIPSE':
                return V.convertEllipseToPathData(this.node);
            case 'CIRCLE':
                return V.convertCircleToPathData(this.node);
            case 'RECT':
                return V.convertRectToPathData(this.node);
        }

        throw new Error(tagName + ' cannot be converted to PATH.');
    };

    // Find the intersection of a line starting in the center
    // of the SVG `node` ending in the point `ref`.
    // `target` is an SVG element to which `node`s transformations are relative to.
    // In JointJS, `target` is the `paper.viewport` SVG group element.
    // Note that `ref` point must be in the coordinate system of the `target` for this function to work properly.
    // Returns a point in the `target` coordinte system (the same system as `ref` is in) if
    // an intersection is found. Returns `undefined` otherwise.
    V.prototype.findIntersection = function(ref, target) {

        var svg = this.svg().node;
        target = target || svg;
        var bbox = g.rect(this.bbox(false, target));
        var center = bbox.center();

        if (!bbox.intersectionWithLineFromCenterToPoint(ref)) return undefined;

        var spot;
        var tagName = this.node.localName.toUpperCase();

        // Little speed up optimalization for `<rect>` element. We do not do conversion
        // to path element and sampling but directly calculate the intersection through
        // a transformed geometrical rectangle.
        if (tagName === 'RECT') {

            var gRect = g.rect(
                parseFloat(this.attr('x') || 0),
                parseFloat(this.attr('y') || 0),
                parseFloat(this.attr('width')),
                parseFloat(this.attr('height'))
            );
            // Get the rect transformation matrix with regards to the SVG document.
            var rectMatrix = this.getTransformToElement(target);
            // Decompose the matrix to find the rotation angle.
            var rectMatrixComponents = V.decomposeMatrix(rectMatrix);
            // Now we want to rotate the rectangle back so that we
            // can use `intersectionWithLineFromCenterToPoint()` passing the angle as the second argument.
            var resetRotation = svg.createSVGTransform();
            resetRotation.setRotate(-rectMatrixComponents.rotation, center.x, center.y);
            var rect = V.transformRect(gRect, resetRotation.matrix.multiply(rectMatrix));
            spot = g.rect(rect).intersectionWithLineFromCenterToPoint(ref, rectMatrixComponents.rotation);

        } else if (tagName === 'PATH' || tagName === 'POLYGON' || tagName === 'POLYLINE' || tagName === 'CIRCLE' || tagName === 'ELLIPSE') {

            var pathNode = (tagName === 'PATH') ? this : this.convertToPath();
            var samples = pathNode.sample();
            var minDistance = Infinity;
            var closestSamples = [];

            var i, sample, gp, centerDistance, refDistance, distance;

            for (i = 0; i < samples.length; i++) {

                sample = samples[i];
                // Convert the sample point in the local coordinate system to the global coordinate system.
                gp = V.createSVGPoint(sample.x, sample.y);
                gp = gp.matrixTransform(this.getTransformToElement(target));
                sample = g.point(gp);
                centerDistance = sample.distance(center);
                // Penalize a higher distance to the reference point by 10%.
                // This gives better results. This is due to
                // inaccuracies introduced by rounding errors and getPointAtLength() returns.
                refDistance = sample.distance(ref) * 1.1;
                distance = centerDistance + refDistance;

                if (distance < minDistance) {
                    minDistance = distance;
                    closestSamples = [{ sample: sample, refDistance: refDistance }];
                } else if (distance < minDistance + 1) {
                    closestSamples.push({ sample: sample, refDistance: refDistance });
                }
            }

            closestSamples.sort(function(a, b) {
                return a.refDistance - b.refDistance;
            });

            if (closestSamples[0]) {
                spot = closestSamples[0].sample;
            }
        }

        return spot;
    };

    /**
     * @private
     * @param {string} name
     * @param {string} value
     * @returns {Vectorizer}
     */
    V.prototype.setAttribute = function(name, value) {

        var el = this.node;

        if (value === null) {
            this.removeAttr(name);
            return this;
        }

        var qualifiedName = V.qualifyAttr(name);

        if (qualifiedName.ns) {
            // Attribute names can be namespaced. E.g. `image` elements
            // have a `xlink:href` attribute to set the source of the image.
            el.setAttributeNS(qualifiedName.ns, name, value);
        } else if (name === 'id') {
            el.id = value;
        } else {
            el.setAttribute(name, value);
        }

        return this;
    };

    // Create an SVG document element.
    // If `content` is passed, it will be used as the SVG content of the `<svg>` root element.
    V.createSvgDocument = function(content) {

        var svg = '<svg xmlns="' + ns.xmlns + '" xmlns:xlink="' + ns.xlink + '" version="' + SVGversion + '">' + (content || '') + '</svg>';
        var xml = V.parseXML(svg, { async: false });
        return xml.documentElement;
    };

    V.idCounter = 0;

    // A function returning a unique identifier for this client session with every call.
    V.uniqueId = function() {

        return 'v-' + (++V.idCounter);
    };

    V.ensureId = function(node) {

        return node.id || (node.id = V.uniqueId());
    };
    // Replace all spaces with the Unicode No-break space (http://www.fileformat.info/info/unicode/char/a0/index.htm).
    // IE would otherwise collapse all spaces into one. This is used in the text() method but it is
    // also exposed so that the programmer can use it in case he needs to. This is useful e.g. in tests
    // when you want to compare the actual DOM text content without having to add the unicode character in
    // the place of all spaces.
    V.sanitizeText = function(text) {

        return (text || '').replace(/ /g, '\u00A0');
    };

    V.isUndefined = function(value) {

        return typeof value === 'undefined';
    };

    V.isString = function(value) {

        return typeof value === 'string';
    };

    V.isObject = function(value) {

        return value && (typeof value === 'object');
    };

    V.isArray = Array.isArray;

    V.parseXML = function(data, opt) {

        opt = opt || {};

        var xml;

        try {
            var parser = new DOMParser();

            if (!V.isUndefined(opt.async)) {
                parser.async = opt.async;
            }

            xml = parser.parseFromString(data, 'text/xml');
        } catch (error) {
            xml = undefined;
        }

        if (!xml || xml.getElementsByTagName('parsererror').length) {
            throw new Error('Invalid XML: ' + data);
        }

        return xml;
    };

    /**
     * @param {string} name
     * @returns {{ns: string|null, local: string}} namespace and attribute name
     */
    V.qualifyAttr = function(name) {

        if (name.indexOf(':') !== -1) {
            var combinedKey = name.split(':');
            return {
                ns: ns[combinedKey[0]],
                local: combinedKey[1]
            };
        }

        return {
            ns: null,
            local: name
        };
    };

    V.transformRegex = /(\w+)\(([^,)]+),?([^)]+)?\)/gi;
    V.transformSeparatorRegex = /[ ,]+/;
    V.transformationListRegex = /^(\w+)\((.*)\)/;

    V.transformStringToMatrix = function(transform) {

        var transformationMatrix = V.createSVGMatrix();
        var matches = transform && transform.match(V.transformRegex);
        if (!matches) {
            return transformationMatrix;
        }

        for (var i = 0, n = matches.length; i < n; i++) {
            var transformationString = matches[i];

            var transformationMatch = transformationString.match(V.transformationListRegex);
            if (transformationMatch) {
                var sx, sy, tx, ty, angle;
                var ctm = V.createSVGMatrix();
                var args = transformationMatch[2].split(V.transformSeparatorRegex);
                switch (transformationMatch[1].toLowerCase()) {
                    case 'scale':
                        sx = parseFloat(args[0]);
                        sy = (args[1] === undefined) ? sx : parseFloat(args[1]);
                        ctm = ctm.scaleNonUniform(sx, sy);
                        break;
                    case 'translate':
                        tx = parseFloat(args[0]);
                        ty = parseFloat(args[1]);
                        ctm = ctm.translate(tx, ty);
                        break;
                    case 'rotate':
                        angle = parseFloat(args[0]);
                        tx = parseFloat(args[1]) || 0;
                        ty = parseFloat(args[2]) || 0;
                        if (tx !== 0 || ty !== 0) {
                            ctm = ctm.translate(tx, ty).rotate(angle).translate(-tx, -ty);
                        } else {
                            ctm = ctm.rotate(angle);
                        }
                        break;
                    case 'skewx':
                        angle = parseFloat(args[0]);
                        ctm = ctm.skewX(angle);
                        break;
                    case 'skewy':
                        angle = parseFloat(args[0]);
                        ctm = ctm.skewY(angle);
                        break;
                    case 'matrix':
                        ctm.a = parseFloat(args[0]);
                        ctm.b = parseFloat(args[1]);
                        ctm.c = parseFloat(args[2]);
                        ctm.d = parseFloat(args[3]);
                        ctm.e = parseFloat(args[4]);
                        ctm.f = parseFloat(args[5]);
                        break;
                    default:
                        continue;
                }

                transformationMatrix = transformationMatrix.multiply(ctm);
            }

        }
        return transformationMatrix;
    };

    V.matrixToTransformString = function(matrix) {
        matrix || (matrix = true);

        return 'matrix(' +
            (matrix.a || 1) + ',' +
            (matrix.b || 0) + ',' +
            (matrix.c || 0) + ',' +
            (matrix.d || 1) + ',' +
            (matrix.e || 0) + ',' +
            (matrix.f || 0) +
            ')';
    };

    V.parseTransformString = function(transform) {

        var translate, rotate, scale;

        if (transform) {

            var separator = V.transformSeparatorRegex;

            // Allow reading transform string with a single matrix
            if (transform.trim().indexOf('matrix') >= 0) {

                var matrix = V.transformStringToMatrix(transform);
                var decomposedMatrix = V.decomposeMatrix(matrix);

                translate = [decomposedMatrix.translateX, decomposedMatrix.translateY];
                scale = [decomposedMatrix.scaleX, decomposedMatrix.scaleY];
                rotate = [decomposedMatrix.rotation];

                var transformations = [];
                if (translate[0] !== 0 ||  translate[0] !== 0) {
                    transformations.push('translate(' + translate + ')');
                }
                if (scale[0] !== 1 ||  scale[1] !== 1) {
                    transformations.push('scale(' + scale + ')');
                }
                if (rotate[0] !== 0) {
                    transformations.push('rotate(' + rotate + ')');
                }
                transform = transformations.join(' ');

            } else {

                var translateMatch = transform.match(/translate\((.*)\)/);
                if (translateMatch) {
                    translate = translateMatch[1].split(separator);
                }
                var rotateMatch = transform.match(/rotate\((.*)\)/);
                if (rotateMatch) {
                    rotate = rotateMatch[1].split(separator);
                }
                var scaleMatch = transform.match(/scale\((.*)\)/);
                if (scaleMatch) {
                    scale = scaleMatch[1].split(separator);
                }
            }
        }

        var sx = (scale && scale[0]) ? parseFloat(scale[0]) : 1;

        return {
            value: transform,
            translate: {
                tx: (translate && translate[0]) ? parseInt(translate[0], 10) : 0,
                ty: (translate && translate[1]) ? parseInt(translate[1], 10) : 0
            },
            rotate: {
                angle: (rotate && rotate[0]) ? parseInt(rotate[0], 10) : 0,
                cx: (rotate && rotate[1]) ? parseInt(rotate[1], 10) : undefined,
                cy: (rotate && rotate[2]) ? parseInt(rotate[2], 10) : undefined
            },
            scale: {
                sx: sx,
                sy: (scale && scale[1]) ? parseFloat(scale[1]) : sx
            }
        };
    };

    V.deltaTransformPoint = function(matrix, point) {

        var dx = point.x * matrix.a + point.y * matrix.c + 0;
        var dy = point.x * matrix.b + point.y * matrix.d + 0;
        return { x: dx, y: dy };
    };

    V.decomposeMatrix = function(matrix) {

        // @see https://gist.github.com/2052247

        // calculate delta transform point
        var px = V.deltaTransformPoint(matrix, { x: 0, y: 1 });
        var py = V.deltaTransformPoint(matrix, { x: 1, y: 0 });

        // calculate skew
        var skewX = ((180 / Math.PI) * Math.atan2(px.y, px.x) - 90);
        var skewY = ((180 / Math.PI) * Math.atan2(py.y, py.x));

        return {

            translateX: matrix.e,
            translateY: matrix.f,
            scaleX: Math.sqrt(matrix.a * matrix.a + matrix.b * matrix.b),
            scaleY: Math.sqrt(matrix.c * matrix.c + matrix.d * matrix.d),
            skewX: skewX,
            skewY: skewY,
            rotation: skewX // rotation is the same as skew x
        };
    };

    // Return the `scale` transformation from the following equation:
    // `translate(tx, ty) . rotate(angle) . scale(sx, sy) === matrix(a,b,c,d,e,f)`
    V.matrixToScale = function(matrix) {

        var a,b,c,d;
        if (matrix) {
            a = V.isUndefined(matrix.a) ? 1 : matrix.a;
            d = V.isUndefined(matrix.d) ? 1 : matrix.d;
            b = matrix.b;
            c = matrix.c;
        } else {
            a = d = 1;
        }
        return {
            sx: b ? Math.sqrt(a * a + b * b) : a,
            sy: c ? Math.sqrt(c * c + d * d) : d
        };
    },

    // Return the `rotate` transformation from the following equation:
    // `translate(tx, ty) . rotate(angle) . scale(sx, sy) === matrix(a,b,c,d,e,f)`
    V.matrixToRotate = function(matrix) {

        var p = { x: 0, y: 1 };
        if (matrix) {
            p =  V.deltaTransformPoint(matrix, p);
        }

        return {
            angle: g.normalizeAngle(g.toDeg(Math.atan2(p.y, p.x)) - 90)
        };
    },

    // Return the `translate` transformation from the following equation:
    // `translate(tx, ty) . rotate(angle) . scale(sx, sy) === matrix(a,b,c,d,e,f)`
    V.matrixToTranslate = function(matrix) {

        return {
            tx: (matrix && matrix.e) || 0,
            ty: (matrix && matrix.f) || 0
        };
    },

    V.isV = function(object) {

        return object instanceof V;
    };

    // For backwards compatibility:
    V.isVElement = V.isV;

    var svgDocument = V('svg').node;

    V.createSVGMatrix = function(matrix) {

        var svgMatrix = svgDocument.createSVGMatrix();
        for (var component in matrix) {
            svgMatrix[component] = matrix[component];
        }

        return svgMatrix;
    };

    V.createSVGTransform = function(matrix) {

        if (!V.isUndefined(matrix)) {

            if (!(matrix instanceof SVGMatrix)) {
                matrix = V.createSVGMatrix(matrix);
            }

            return svgDocument.createSVGTransformFromMatrix(matrix);
        }

        return svgDocument.createSVGTransform();
    };

    V.createSVGPoint = function(x, y) {

        var p = svgDocument.createSVGPoint();
        p.x = x;
        p.y = y;
        return p;
    };

    V.transformRect = function(r, matrix) {

        var p = svgDocument.createSVGPoint();

        p.x = r.x;
        p.y = r.y;
        var corner1 = p.matrixTransform(matrix);

        p.x = r.x + r.width;
        p.y = r.y;
        var corner2 = p.matrixTransform(matrix);

        p.x = r.x + r.width;
        p.y = r.y + r.height;
        var corner3 = p.matrixTransform(matrix);

        p.x = r.x;
        p.y = r.y + r.height;
        var corner4 = p.matrixTransform(matrix);

        var minX = Math.min(corner1.x, corner2.x, corner3.x, corner4.x);
        var maxX = Math.max(corner1.x, corner2.x, corner3.x, corner4.x);
        var minY = Math.min(corner1.y, corner2.y, corner3.y, corner4.y);
        var maxY = Math.max(corner1.y, corner2.y, corner3.y, corner4.y);

        return g.Rect(minX, minY, maxX - minX, maxY - minY);
    };

    V.transformPoint = function(p, matrix) {

        return g.Point(V.createSVGPoint(p.x, p.y).matrixTransform(matrix));
    };

    // Convert a style represented as string (e.g. `'fill="blue"; stroke="red"'`) to
    // an object (`{ fill: 'blue', stroke: 'red' }`).
    V.styleToObject = function(styleString) {
        var ret = {};
        var styles = styleString.split(';');
        for (var i = 0; i < styles.length; i++) {
            var style = styles[i];
            var pair = style.split('=');
            ret[pair[0].trim()] = pair[1].trim();
        }
        return ret;
    };

    // Inspired by d3.js https://github.com/mbostock/d3/blob/master/src/svg/arc.js
    V.createSlicePathData = function(innerRadius, outerRadius, startAngle, endAngle) {

        var svgArcMax = 2 * Math.PI - 1e-6;
        var r0 = innerRadius;
        var r1 = outerRadius;
        var a0 = startAngle;
        var a1 = endAngle;
        var da = (a1 < a0 && (da = a0, a0 = a1, a1 = da), a1 - a0);
        var df = da < Math.PI ? '0' : '1';
        var c0 = Math.cos(a0);
        var s0 = Math.sin(a0);
        var c1 = Math.cos(a1);
        var s1 = Math.sin(a1);

        return (da >= svgArcMax)
            ? (r0
               ? 'M0,' + r1
               + 'A' + r1 + ',' + r1 + ' 0 1,1 0,' + (-r1)
               + 'A' + r1 + ',' + r1 + ' 0 1,1 0,' + r1
               + 'M0,' + r0
               + 'A' + r0 + ',' + r0 + ' 0 1,0 0,' + (-r0)
               + 'A' + r0 + ',' + r0 + ' 0 1,0 0,' + r0
               + 'Z'
               : 'M0,' + r1
               + 'A' + r1 + ',' + r1 + ' 0 1,1 0,' + (-r1)
               + 'A' + r1 + ',' + r1 + ' 0 1,1 0,' + r1
               + 'Z')
            : (r0
               ? 'M' + r1 * c0 + ',' + r1 * s0
               + 'A' + r1 + ',' + r1 + ' 0 ' + df + ',1 ' + r1 * c1 + ',' + r1 * s1
               + 'L' + r0 * c1 + ',' + r0 * s1
               + 'A' + r0 + ',' + r0 + ' 0 ' + df + ',0 ' + r0 * c0 + ',' + r0 * s0
               + 'Z'
               : 'M' + r1 * c0 + ',' + r1 * s0
               + 'A' + r1 + ',' + r1 + ' 0 ' + df + ',1 ' + r1 * c1 + ',' + r1 * s1
               + 'L0,0'
               + 'Z');
    };

    // Merge attributes from object `b` with attributes in object `a`.
    // Note that this modifies the object `a`.
    // Also important to note that attributes are merged but CSS classes are concatenated.
    V.mergeAttrs = function(a, b) {

        for (var attr in b) {

            if (attr === 'class') {
                // Concatenate classes.
                a[attr] = a[attr] ? a[attr] + ' ' + b[attr] : b[attr];
            } else if (attr === 'style') {
                // `style` attribute can be an object.
                if (V.isObject(a[attr]) && V.isObject(b[attr])) {
                    // `style` stored in `a` is an object.
                    a[attr] = V.mergeAttrs(a[attr], b[attr]);
                } else if (V.isObject(a[attr])) {
                    // `style` in `a` is an object but it's a string in `b`.
                    // Convert the style represented as a string to an object in `b`.
                    a[attr] = V.mergeAttrs(a[attr], V.styleToObject(b[attr]));
                } else if (V.isObject(b[attr])) {
                    // `style` in `a` is a string, in `b` it's an object.
                    a[attr] = V.mergeAttrs(V.styleToObject(a[attr]), b[attr]);
                } else {
                    // Both styles are strings.
                    a[attr] = V.mergeAttrs(V.styleToObject(a[attr]), V.styleToObject(b[attr]));
                }
            } else {
                a[attr] = b[attr];
            }
        }

        return a;
    };

    V.annotateString = function(t, annotations, opt) {

        annotations = annotations || [];
        opt = opt || {};

        var offset = opt.offset || 0;
        var compacted = [];
        var batch;
        var ret = [];
        var item;
        var prev;

        for (var i = 0; i < t.length; i++) {

            item = ret[i] = t[i];

            for (var j = 0; j < annotations.length; j++) {

                var annotation = annotations[j];
                var start = annotation.start + offset;
                var end = annotation.end + offset;

                if (i >= start && i < end) {
                    // Annotation applies.
                    if (V.isObject(item)) {
                        // There is more than one annotation to be applied => Merge attributes.
                        item.attrs = V.mergeAttrs(V.mergeAttrs({}, item.attrs), annotation.attrs);
                    } else {
                        item = ret[i] = { t: t[i], attrs: annotation.attrs };
                    }
                    if (opt.includeAnnotationIndices) {
                        (item.annotations || (item.annotations = [])).push(j);
                    }
                }
            }

            prev = ret[i - 1];

            if (!prev) {

                batch = item;

            } else if (V.isObject(item) && V.isObject(prev)) {
                // Both previous item and the current one are annotations. If the attributes
                // didn't change, merge the text.
                if (JSON.stringify(item.attrs) === JSON.stringify(prev.attrs)) {
                    batch.t += item.t;
                } else {
                    compacted.push(batch);
                    batch = item;
                }

            } else if (V.isObject(item)) {
                // Previous item was a string, current item is an annotation.
                compacted.push(batch);
                batch = item;

            } else if (V.isObject(prev)) {
                // Previous item was an annotation, current item is a string.
                compacted.push(batch);
                batch = item;

            } else {
                // Both previous and current item are strings.
                batch = (batch || '') + item;
            }
        }

        if (batch) {
            compacted.push(batch);
        }

        return compacted;
    };

    V.findAnnotationsAtIndex = function(annotations, index) {

        var found = [];

        if (annotations) {

            annotations.forEach(function(annotation) {

                if (annotation.start < index && index <= annotation.end) {
                    found.push(annotation);
                }
            });
        }

        return found;
    };

    V.findAnnotationsBetweenIndexes = function(annotations, start, end) {

        var found = [];

        if (annotations) {

            annotations.forEach(function(annotation) {

                if ((start >= annotation.start && start < annotation.end) || (end > annotation.start && end <= annotation.end) || (annotation.start >= start && annotation.end < end)) {
                    found.push(annotation);
                }
            });
        }

        return found;
    };

    // Shift all the text annotations after character `index` by `offset` positions.
    V.shiftAnnotations = function(annotations, index, offset) {

        if (annotations) {

            annotations.forEach(function(annotation) {

                if (annotation.start < index && annotation.end >= index) {
                    annotation.end += offset;
                } else if (annotation.start >= index) {
                    annotation.start += offset;
                    annotation.end += offset;
                }
            });
        }

        return annotations;
    };

    V.convertLineToPathData = function(line) {

        line = V(line);
        var d = [
            'M', line.attr('x1'), line.attr('y1'),
            'L', line.attr('x2'), line.attr('y2')
        ].join(' ');
        return d;
    };

    V.convertPolygonToPathData = function(polygon) {

        var points = V.getPointsFromSvgNode(V(polygon).node);

        if (!(points.length > 0)) return null;

        return V.svgPointsToPath(points) + ' Z';
    };

    V.convertPolylineToPathData = function(polyline) {

        var points = V.getPointsFromSvgNode(V(polyline).node);

        if (!(points.length > 0)) return null;

        return V.svgPointsToPath(points);
    };

    V.svgPointsToPath = function(points) {

        var i;

        for (i = 0; i < points.length; i++) {
            points[i] = points[i].x + ' ' + points[i].y;
        }

        return 'M ' + points.join(' L');
    };

    V.getPointsFromSvgNode = function(node) {

        var points = [];
        var i;

        for (i = 0; i < node.points.numberOfItems; i++) {
            points.push(node.points.getItem(i));
        }

        return points;
    };

    V.KAPPA = 0.5522847498307935;

    V.convertCircleToPathData = function(circle) {

        circle = V(circle);
        var cx = parseFloat(circle.attr('cx')) || 0;
        var cy = parseFloat(circle.attr('cy')) || 0;
        var r = parseFloat(circle.attr('r'));
        var cd = r * V.KAPPA; // Control distance.

        var d = [
            'M', cx, cy - r,    // Move to the first point.
            'C', cx + cd, cy - r, cx + r, cy - cd, cx + r, cy, // I. Quadrant.
            'C', cx + r, cy + cd, cx + cd, cy + r, cx, cy + r, // II. Quadrant.
            'C', cx - cd, cy + r, cx - r, cy + cd, cx - r, cy, // III. Quadrant.
            'C', cx - r, cy - cd, cx - cd, cy - r, cx, cy - r, // IV. Quadrant.
            'Z'
        ].join(' ');
        return d;
    };

    V.convertEllipseToPathData = function(ellipse) {

        ellipse = V(ellipse);
        var cx = parseFloat(ellipse.attr('cx')) || 0;
        var cy = parseFloat(ellipse.attr('cy')) || 0;
        var rx = parseFloat(ellipse.attr('rx'));
        var ry = parseFloat(ellipse.attr('ry')) || rx;
        var cdx = rx * V.KAPPA; // Control distance x.
        var cdy = ry * V.KAPPA; // Control distance y.

        var d = [
            'M', cx, cy - ry,    // Move to the first point.
            'C', cx + cdx, cy - ry, cx + rx, cy - cdy, cx + rx, cy, // I. Quadrant.
            'C', cx + rx, cy + cdy, cx + cdx, cy + ry, cx, cy + ry, // II. Quadrant.
            'C', cx - cdx, cy + ry, cx - rx, cy + cdy, cx - rx, cy, // III. Quadrant.
            'C', cx - rx, cy - cdy, cx - cdx, cy - ry, cx, cy - ry, // IV. Quadrant.
            'Z'
        ].join(' ');
        return d;
    };

    V.convertRectToPathData = function(rect) {

        rect = V(rect);

        return V.rectToPath({
            x: parseFloat(rect.attr('x')) || 0,
            y: parseFloat(rect.attr('y')) || 0,
            width: parseFloat(rect.attr('width')) || 0,
            height: parseFloat(rect.attr('height')) || 0,
            rx: parseFloat(rect.attr('rx')) || 0,
            ry: parseFloat(rect.attr('ry')) || 0
        });
    };

    // Convert a rectangle to SVG path commands. `r` is an object of the form:
    // `{ x: [number], y: [number], width: [number], height: [number], top-ry: [number], top-ry: [number], bottom-rx: [number], bottom-ry: [number] }`,
    // where `x, y, width, height` are the usual rectangle attributes and [top-/bottom-]rx/ry allows for
    // specifying radius of the rectangle for all its sides (as opposed to the built-in SVG rectangle
    // that has only `rx` and `ry` attributes).
    V.rectToPath = function(r) {

        var d;
        var x = r.x;
        var y = r.y;
        var width = r.width;
        var height = r.height;
        var topRx = Math.min(r.rx || r['top-rx'] || 0, width / 2);
        var bottomRx = Math.min(r.rx || r['bottom-rx'] || 0, width / 2);
        var topRy = Math.min(r.ry || r['top-ry'] || 0, height / 2);
        var bottomRy = Math.min(r.ry || r['bottom-ry'] || 0, height / 2);

        if (topRx || bottomRx || topRy || bottomRy) {
            d = [
                'M', x, y + topRy,
                'v', height - topRy - bottomRy,
                'a', bottomRx, bottomRy, 0, 0, 0, bottomRx, bottomRy,
                'h', width - 2 * bottomRx,
                'a', bottomRx, bottomRy, 0, 0, 0, bottomRx, -bottomRy,
                'v', -(height - bottomRy - topRy),
                'a', topRx, topRy, 0, 0, 0, -topRx, -topRy,
                'h', -(width - 2 * topRx),
                'a', topRx, topRy, 0, 0, 0, -topRx, topRy,
                'Z'
            ];
        } else {
            d = [
                'M', x, y,
                'H', x + width,
                'V', y + height,
                'H', x,
                'V', y,
                'Z'
            ];
        }

        return d.join(' ');
    };

    V.toNode = function(el) {
        return V.isV(el) ? el.node : (el.nodeName && el || el[0]);
    };

    return V;

})();


// Global namespace.

var joint = {

    version: '1.1.0',

    config: {
        // The class name prefix config is for advanced use only.
        // Be aware that if you change the prefix, the JointJS CSS will no longer function properly.
        classNamePrefix: 'joint-',
        defaultTheme: 'default'
    },

    // `joint.dia` namespace.
    dia: {},

    // `joint.ui` namespace.
    ui: {},

    // `joint.layout` namespace.
    layout: {},

    // `joint.shapes` namespace.
    shapes: {},

    // `joint.format` namespace.
    format: {},

    // `joint.connectors` namespace.
    connectors: {},

    // `joint.highlighters` namespace.
    highlighters: {},

    // `joint.routers` namespace.
    routers: {},

    // `joint.mvc` namespace.
    mvc: {
        views: {}
    },

    setTheme: function(theme, opt) {

        opt = opt || {};

        _.invoke(joint.mvc.views, 'setTheme', theme, opt);

        // Update the default theme on the view prototype.
        joint.mvc.View.prototype.defaultTheme = theme;
    },

    // `joint.env` namespace.
    env: {

        _results: {},

        _tests: {

            svgforeignobject: function() {
                return !!document.createElementNS &&
              /SVGForeignObject/.test(({}).toString.call(document.createElementNS('http://www.w3.org/2000/svg', 'foreignObject')));
            }
        },

        addTest: function(name, fn) {

            return joint.env._tests[name] = fn;
        },

        test: function(name) {

            var fn = joint.env._tests[name];

            if (!fn) {
                throw new Error('Test not defined ("' + name + '"). Use `joint.env.addTest(name, fn) to add a new test.`');
            }

            var result = joint.env._results[name];

            if (typeof result !== 'undefined') {
                return result;
            }

            try {
                result = fn();
            } catch (error) {
                result = false;
            }

            // Cache the test result.
            joint.env._results[name] = result;

            return result;
        }
    },

    util: {

        // Return a simple hash code from a string. See http://werxltd.com/wp/2010/05/13/javascript-implementation-of-javas-string-hashcode-method/.
        hashCode: function(str) {

            var hash = 0;
            if (str.length == 0) return hash;
            for (var i = 0; i < str.length; i++) {
                var c = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + c;
                hash = hash & hash; // Convert to 32bit integer
            }
            return hash;
        },

        getByPath: function(obj, path, delim) {

            var keys = _.isArray(path) ? path.slice() : path.split(delim || '/');
            var key;

            while (keys.length) {
                key = keys.shift();
                if (Object(obj) === obj && key in obj) {
                    obj = obj[key];
                } else {
                    return undefined;
                }
            }
            return obj;
        },

        setByPath: function(obj, path, value, delim) {

            var keys = _.isArray(path) ? path : path.split(delim || '/');

            var diver = obj;
            var i = 0;

            for (var len = keys.length; i < len - 1; i++) {
                // diver creates an empty object if there is no nested object under such a key.
                // This means that one can populate an empty nested object with setByPath().
                diver = diver[keys[i]] || (diver[keys[i]] = {});
            }
            diver[keys[len - 1]] = value;

            return obj;
        },

        unsetByPath: function(obj, path, delim) {

            delim = delim || '/';

            var pathArray = _.isArray(path) ? path.slice() : path.split(delim);

            var propertyToRemove = pathArray.pop();
            if (pathArray.length > 0) {

                // unsetting a nested attribute
                var parent = joint.util.getByPath(obj, pathArray, delim);

                if (parent) {
                    delete parent[propertyToRemove];
                }

            } else {

                // unsetting a primitive attribute
                delete obj[propertyToRemove];
            }

            return obj;
        },

        flattenObject: function(obj, delim, stop) {

            delim = delim || '/';
            var ret = {};

            for (var key in obj) {

                if (!obj.hasOwnProperty(key)) continue;

                var shouldGoDeeper = typeof obj[key] === 'object';
                if (shouldGoDeeper && stop && stop(obj[key])) {
                    shouldGoDeeper = false;
                }

                if (shouldGoDeeper) {

                    var flatObject = this.flattenObject(obj[key], delim, stop);

                    for (var flatKey in flatObject) {
                        if (!flatObject.hasOwnProperty(flatKey)) continue;
                        ret[key + delim + flatKey] = flatObject[flatKey];
                    }

                } else {

                    ret[key] = obj[key];
                }
            }

            return ret;
        },

        uuid: function() {

            // credit: http://stackoverflow.com/posts/2117523/revisions

            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                var r = Math.random() * 16|0;
                var v = c == 'x' ? r : (r&0x3|0x8);
                return v.toString(16);
            });
        },

        // Generate global unique id for obj and store it as a property of the object.
        guid: function(obj) {

            this.guid.id = this.guid.id || 1;
            obj.id = (obj.id === undefined ? 'j_' + this.guid.id++ : obj.id);
            return obj.id;
        },

        toKebabCase: function(string) {

            return string.replace(/[A-Z]/g, '-$&').toLowerCase();
        },

        // Copy all the properties to the first argument from the following arguments.
        // All the properties will be overwritten by the properties from the following
        // arguments. Inherited properties are ignored.
        mixin: _.assign,

        // Copy all properties to the first argument from the following
        // arguments only in case if they don't exists in the first argument.
        // All the function propererties in the first argument will get
        // additional property base pointing to the extenders same named
        // property function's call method.
        supplement: _.defaults,

        // Same as `mixin()` but deep version.
        deepMixin: _.mixin,

        // Same as `supplement()` but deep version.
        deepSupplement: _.defaultsDeep,

        normalizeEvent: function(evt) {

            var touchEvt = evt.originalEvent && evt.originalEvent.changedTouches && evt.originalEvent.changedTouches[0];
            if (touchEvt) {
                for (var property in evt) {
                    // copy all the properties from the input event that are not
                    // defined on the touch event (functions included).
                    if (touchEvt[property] === undefined) {
                        touchEvt[property] = evt[property];
                    }
                }
                return touchEvt;
            }

            return evt;
        },

        nextFrame: (function() {

            var raf;

            if (typeof window !== 'undefined') {

                raf = window.requestAnimationFrame ||
                        window.webkitRequestAnimationFrame ||
                        window.mozRequestAnimationFrame ||
                        window.oRequestAnimationFrame ||
                        window.msRequestAnimationFrame;
            }

            if (!raf) {

                var lastTime = 0;

                raf = function(callback) {

                    var currTime = new Date().getTime();
                    var timeToCall = Math.max(0, 16 - (currTime - lastTime));
                    var id = setTimeout(function() { callback(currTime + timeToCall); }, timeToCall);

                    lastTime = currTime + timeToCall;

                    return id;
                };
            }

            return function(callback, context) {
                return context
                    ? raf(_.bind(callback, context))
                    : raf(callback);
            };

        })(),

        cancelFrame: (function() {

            var caf;
            var client = typeof window != 'undefined';

            if (client) {

                caf = window.cancelAnimationFrame ||
                        window.webkitCancelAnimationFrame ||
                        window.webkitCancelRequestAnimationFrame ||
                        window.msCancelAnimationFrame ||
                        window.msCancelRequestAnimationFrame ||
                        window.oCancelAnimationFrame ||
                        window.oCancelRequestAnimationFrame ||
                        window.mozCancelAnimationFrame ||
                        window.mozCancelRequestAnimationFrame;
            }

            caf = caf || clearTimeout;

            return client ? _.bind(caf, window) : caf;

        })(),

        shapePerimeterConnectionPoint: function(linkView, view, magnet, reference) {

            var bbox;
            var spot;

            if (!magnet) {

                // There is no magnet, try to make the best guess what is the
                // wrapping SVG element. This is because we want this "smart"
                // connection points to work out of the box without the
                // programmer to put magnet marks to any of the subelements.
                // For example, we want the functoin to work on basic.Path elements
                // without any special treatment of such elements.
                // The code below guesses the wrapping element based on
                // one simple assumption. The wrapping elemnet is the
                // first child of the scalable group if such a group exists
                // or the first child of the rotatable group if not.
                // This makese sense because usually the wrapping element
                // is below any other sub element in the shapes.
                var scalable = view.$('.scalable')[0];
                var rotatable = view.$('.rotatable')[0];

                if (scalable && scalable.firstChild) {

                    magnet = scalable.firstChild;

                } else if (rotatable && rotatable.firstChild) {

                    magnet = rotatable.firstChild;
                }
            }

            if (magnet) {

                spot = V(magnet).findIntersection(reference, linkView.paper.viewport);
                if (!spot) {
                    bbox = g.rect(V(magnet).bbox(false, linkView.paper.viewport));
                }

            } else {

                bbox = view.model.getBBox();
                spot = bbox.intersectionWithLineFromCenterToPoint(reference);
            }
            return spot || bbox.center();
        },

        parseCssNumeric: function(strValue, restrictUnits) {

            restrictUnits = restrictUnits || [];
            var cssNumeric = { value: parseFloat(strValue) };

            if (_.isNaN(cssNumeric.value)) {
                return null;
            }

            var validUnitsExp = restrictUnits.join('|');

            if (_.isString(strValue)) {
                var matches = new RegExp('(\\d+)(' + validUnitsExp + ')$').exec(strValue);
                if (!matches) {
                    return null;
                }
                if (matches[2]) {
                    cssNumeric.unit = matches[2];
                }
            }
            return cssNumeric;
        },

        breakText: function(text, size, styles, opt) {

            opt = opt || {};

            var width = size.width;
            var height = size.height;

            var svgDocument = opt.svgDocument || V('svg').node;
            var textElement = V('<text><tspan></tspan></text>').attr(styles || {}).node;
            var textSpan = textElement.firstChild;
            var textNode = document.createTextNode('');

            // Prevent flickering
            textElement.style.opacity = 0;
            // Prevent FF from throwing an uncaught exception when `getBBox()`
            // called on element that is not in the render tree (is not measurable).
            // <tspan>.getComputedTextLength() returns always 0 in this case.
            // Note that the `textElement` resp. `textSpan` can become hidden
            // when it's appended to the DOM and a `display: none` CSS stylesheet
            // rule gets applied.
            textElement.style.display = 'block';
            textSpan.style.display = 'block';

            textSpan.appendChild(textNode);
            svgDocument.appendChild(textElement);

            if (!opt.svgDocument) {

                document.body.appendChild(svgDocument);
            }

            var words = text.split(' ');
            var full = [];
            var lines = [];
            var p;
            var lineHeight;

            for (var i = 0, l = 0, len = words.length; i < len; i++) {

                var word = words[i];

                textNode.data = lines[l] ? lines[l] + ' ' + word : word;

                if (textSpan.getComputedTextLength() <= width) {

                    // the current line fits
                    lines[l] = textNode.data;

                    if (p) {
                        // We were partitioning. Put rest of the word onto next line
                        full[l++] = true;

                        // cancel partitioning
                        p = 0;
                    }

                } else {

                    if (!lines[l] || p) {

                        var partition = !!p;

                        p = word.length - 1;

                        if (partition || !p) {

                            // word has only one character.
                            if (!p) {

                                if (!lines[l]) {

                                    // we won't fit this text within our rect
                                    lines = [];

                                    break;
                                }

                                // partitioning didn't help on the non-empty line
                                // try again, but this time start with a new line

                                // cancel partitions created
                                words.splice(i, 2, word + words[i + 1]);

                                // adjust word length
                                len--;

                                full[l++] = true;
                                i--;

                                continue;
                            }

                            // move last letter to the beginning of the next word
                            words[i] = word.substring(0, p);
                            words[i + 1] = word.substring(p) + words[i + 1];

                        } else {

                            // We initiate partitioning
                            // split the long word into two words
                            words.splice(i, 1, word.substring(0, p), word.substring(p));

                            // adjust words length
                            len++;

                            if (l && !full[l - 1]) {
                                // if the previous line is not full, try to fit max part of
                                // the current word there
                                l--;
                            }
                        }

                        i--;

                        continue;
                    }

                    l++;
                    i--;
                }

                // if size.height is defined we have to check whether the height of the entire
                // text exceeds the rect height
                if (height !== undefined) {

                    if (lineHeight === undefined) {

                        var heightValue;

                        // use the same defaults as in V.prototype.text
                        if (styles.lineHeight === 'auto') {
                            heightValue = { value: 1.5, unit: 'em' };
                        } else {
                            heightValue = joint.util.parseCssNumeric(styles.lineHeight, ['em']) || { value: 1, unit: 'em' };
                        }

                        lineHeight = heightValue.value;
                        if (heightValue.unit === 'em' ) {
                            lineHeight *= textElement.getBBox().height;
                        }
                    }

                    if (lineHeight * lines.length > height) {

                        // remove overflowing lines
                        lines.splice(Math.floor(height / lineHeight));

                        break;
                    }
                }
            }

            if (opt.svgDocument) {

                // svg document was provided, remove the text element only
                svgDocument.removeChild(textElement);

            } else {

                // clean svg document
                document.body.removeChild(svgDocument);
            }

            return lines.join('\n');
        },

        imageToDataUri: function(url, callback) {

            if (!url || url.substr(0, 'data:'.length) === 'data:') {
                // No need to convert to data uri if it is already in data uri.

                // This not only convenient but desired. For example,
                // IE throws a security error if data:image/svg+xml is used to render
                // an image to the canvas and an attempt is made to read out data uri.
                // Now if our image is already in data uri, there is no need to render it to the canvas
                // and so we can bypass this error.

                // Keep the async nature of the function.
                return setTimeout(function() {
                    callback(null, url);
                }, 0);
            }

            // chrome IE10 IE11
            var modernHandler = function(xhr, callback) {

                if (xhr.status === 200) {

                    var reader = new FileReader();

                    reader.onload = function(evt) {
                        var dataUri = evt.target.result;
                        callback(null, dataUri);
                    };

                    reader.onerror = function() {
                        callback(new Error('Failed to load image ' + url));
                    };

                    reader.readAsDataURL(xhr.response);
                } else {
                    callback(new Error('Failed to load image ' + url));
                }

            };

            var legacyHandler = function(xhr, callback) {

                var Uint8ToString = function(u8a) {
                    var CHUNK_SZ = 0x8000;
                    var c = [];
                    for (var i = 0; i < u8a.length; i += CHUNK_SZ) {
                        c.push(String.fromCharCode.apply(null, u8a.subarray(i, i + CHUNK_SZ)));
                    }
                    return c.join('');
                };


                if (xhr.status === 200) {

                    var bytes = new Uint8Array(xhr.response);

                    var suffix = (url.split('.').pop()) || 'png';
                    var map = {
                        'svg': 'svg+xml'
                    };
                    var meta = 'data:image/' + (map[suffix] || suffix) + ';base64,';
                    var b64encoded = meta + btoa(Uint8ToString(bytes));
                    callback(null, b64encoded);
                } else {
                    callback(new Error('Failed to load image ' + url));
                }
            };

            var xhr = new XMLHttpRequest();

            xhr.open('GET', url, true);
            xhr.addEventListener('error', function() {
                callback(new Error('Failed to load image ' + url));
            });

            xhr.responseType = window.FileReader ? 'blob' : 'arraybuffer';

            xhr.addEventListener('load', function() {
                if (window.FileReader) {
                    modernHandler(xhr, callback);
                } else {
                    legacyHandler(xhr, callback);
                }
            });

            xhr.send();
        },

        getElementBBox: function(el) {

            var $el = $(el);
            if ($el.length === 0) {
                throw new Error('Element not found')
            }

            var element = $el[0];
            var doc = element.ownerDocument;
            var clientBBox = element.getBoundingClientRect();

            var strokeWidthX = 0;
            var strokeWidthY = 0;

            // Firefox correction
            if (element.ownerSVGElement) {

                var bbox = V(element).bbox();

                // if FF getBoundingClientRect includes stroke-width, getBBox doesn't.
                // To unify this across all browsers we need to adjust the final bBox with `stroke-width` value.
                strokeWidthX = (clientBBox.width - bbox.width);
                strokeWidthY = (clientBBox.height - bbox.height);
            }

            return  {
                x: clientBBox.left + window.pageXOffset - doc.documentElement.offsetLeft + strokeWidthX / 2,
                y: clientBBox.top + window.pageYOffset - doc.documentElement.offsetTop + strokeWidthY / 2,
                width: clientBBox.width - strokeWidthX,
                height: clientBBox.height - strokeWidthY
            };
        },


        // Highly inspired by the jquery.sortElements plugin by Padolsey.
        // See http://james.padolsey.com/javascript/sorting-elements-with-jquery/.
        sortElements: function(elements, comparator) {

            var $elements = $(elements);
            var placements = $elements.map(function() {

                var sortElement = this;
                var parentNode = sortElement.parentNode;
                // Since the element itself will change position, we have
                // to have some way of storing it's original position in
                // the DOM. The easiest way is to have a 'flag' node:
                var nextSibling = parentNode.insertBefore(document.createTextNode(''), sortElement.nextSibling);

                return function() {

                    if (parentNode === this) {
                        throw new Error('You can\'t sort elements if any one is a descendant of another.');
                    }

                    // Insert before flag:
                    parentNode.insertBefore(this, nextSibling);
                    // Remove flag:
                    parentNode.removeChild(nextSibling);
                };
            });

            return Array.prototype.sort.call($elements, comparator).each(function(i) {
                placements[i].call(this);
            });
        },

        // Sets attributes on the given element and its descendants based on the selector.
        // `attrs` object: { [SELECTOR1]: { attrs1 }, [SELECTOR2]: { attrs2}, ... } e.g. { 'input': { color : 'red' }}
        setAttributesBySelector: function(element, attrs) {

            var $element = $(element);

            _.each(attrs, function(attrs, selector) {
                var $elements = $element.find(selector).addBack().filter(selector);
                // Make a special case for setting classes.
                // We do not want to overwrite any existing class.
                if (_.has(attrs, 'class')) {
                    $elements.addClass(attrs['class']);
                    attrs = _.omit(attrs, 'class');
                }
                $elements.attr(attrs);
            });
        },

        // Return a new object with all for sides (top, bottom, left and right) in it.
        // Value of each side is taken from the given argument (either number or object).
        // Default value for a side is 0.
        // Examples:
        // joint.util.normalizeSides(5) --> { top: 5, left: 5, right: 5, bottom: 5 }
        // joint.util.normalizeSides({ left: 5 }) --> { top: 0, left: 5, right: 0, bottom: 0 }
        normalizeSides: function(box) {

            if (Object(box) !== box) {
                box = box || 0;
                return { top: box, bottom: box, left: box, right: box };
            }

            return {
                top: box.top || 0,
                bottom: box.bottom || 0,
                left: box.left || 0,
                right: box.right || 0
            };
        },

        timing: {

            linear: function(t) {
                return t;
            },

            quad: function(t) {
                return t * t;
            },

            cubic: function(t) {
                return t * t * t;
            },

            inout: function(t) {
                if (t <= 0) return 0;
                if (t >= 1) return 1;
                var t2 = t * t;
                var t3 = t2 * t;
                return 4 * (t < .5 ? t3 : 3 * (t - t2) + t3 - .75);
            },

            exponential: function(t) {
                return Math.pow(2, 10 * (t - 1));
            },

            bounce: function(t) {
                for (var a = 0, b = 1; 1; a += b, b /= 2) {
                    if (t >= (7 - 4 * a) / 11) {
                        var q = (11 - 6 * a - 11 * t) / 4;
                        return -q * q + b * b;
                    }
                }
            },

            reverse: function(f) {
                return function(t) {
                    return 1 - f(1 - t);
                };
            },

            reflect: function(f) {
                return function(t) {
                    return .5 * (t < .5 ? f(2 * t) : (2 - f(2 - 2 * t)));
                };
            },

            clamp: function(f, n, x) {
                n = n || 0;
                x = x || 1;
                return function(t) {
                    var r = f(t);
                    return r < n ? n : r > x ? x : r;
                };
            },

            back: function(s) {
                if (!s) s = 1.70158;
                return function(t) {
                    return t * t * ((s + 1) * t - s);
                };
            },

            elastic: function(x) {
                if (!x) x = 1.5;
                return function(t) {
                    return Math.pow(2, 10 * (t - 1)) * Math.cos(20 * Math.PI * x / 3 * t);
                };
            }
        },

        interpolate: {

            number: function(a, b) {
                var d = b - a;
                return function(t) { return a + d * t; };
            },

            object: function(a, b) {
                var s = _.keys(a);
                return function(t) {
                    var i, p;
                    var r = {};
                    for (i = s.length - 1; i != -1; i--) {
                        p = s[i];
                        r[p] = a[p] + (b[p] - a[p]) * t;
                    }
                    return r;
                };
            },

            hexColor: function(a, b) {

                var ca = parseInt(a.slice(1), 16);
                var cb = parseInt(b.slice(1), 16);
                var ra = ca & 0x0000ff;
                var rd = (cb & 0x0000ff) - ra;
                var ga = ca & 0x00ff00;
                var gd = (cb & 0x00ff00) - ga;
                var ba = ca & 0xff0000;
                var bd = (cb & 0xff0000) - ba;

                return function(t) {

                    var r = (ra + rd * t) & 0x000000ff;
                    var g = (ga + gd * t) & 0x0000ff00;
                    var b = (ba + bd * t) & 0x00ff0000;

                    return '#' + (1 << 24 | r | g | b ).toString(16).slice(1);
                };
            },

            unit: function(a, b) {

                var r = /(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/;
                var ma = r.exec(a);
                var mb = r.exec(b);
                var p = mb[1].indexOf('.');
                var f = p > 0 ? mb[1].length - p - 1 : 0;
                a = +ma[1];
                var d = +mb[1] - a;
                var u = ma[2];

                return function(t) {
                    return (a + d * t).toFixed(f) + u;
                };
            }
        },

        // SVG filters.
        filter: {

            // `color` ... outline color
            // `width`... outline width
            // `opacity` ... outline opacity
            // `margin` ... gap between outline and the element
            outline: function(args) {

                var tpl = '<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${outerRadius}" /><feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${innerRadius}" /><feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/><feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/><feMerge><feMergeNode in="outline"/><feMergeNode in="SourceGraphic"/></feMerge></filter>';

                var margin = _.isFinite(args.margin) ? args.margin : 2;
                var width = _.isFinite(args.width) ? args.width : 1;

                return joint.util.template(tpl)({
                    color: args.color || 'blue',
                    opacity: _.isFinite(args.opacity) ? args.opacity : 1,
                    outerRadius: margin + width,
                    innerRadius: margin
                });
            },

            // `color` ... color
            // `width`... width
            // `blur` ... blur
            // `opacity` ... opacity
            highlight: function(args) {

                var tpl = '<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${width}"/><feComposite result="composed" in="colored" in2="morphed" operator="in"/><feGaussianBlur result="blured" in="composed" stdDeviation="${blur}"/><feBlend in="SourceGraphic" in2="blured" mode="normal"/></filter>';

                return joint.util.template(tpl)({
                    color: args.color || 'red',
                    width: _.isFinite(args.width) ? args.width : 1,
                    blur: _.isFinite(args.blur) ? args.blur : 0,
                    opacity: _.isFinite(args.opacity) ? args.opacity : 1
                });
            },

            // `x` ... horizontal blur
            // `y` ... vertical blur (optional)
            blur: function(args) {

                var x = _.isFinite(args.x) ? args.x : 2;

                return joint.util.template('<filter><feGaussianBlur stdDeviation="${stdDeviation}"/></filter>')({
                    stdDeviation: _.isFinite(args.y) ? [x, args.y] : x
                });
            },

            // `dx` ... horizontal shift
            // `dy` ... vertical shift
            // `blur` ... blur
            // `color` ... color
            // `opacity` ... opacity
            dropShadow: function(args) {

                var tpl = 'SVGFEDropShadowElement' in window
                    ? '<filter><feDropShadow stdDeviation="${blur}" dx="${dx}" dy="${dy}" flood-color="${color}" flood-opacity="${opacity}"/></filter>'
                    : '<filter><feGaussianBlur in="SourceAlpha" stdDeviation="${blur}"/><feOffset dx="${dx}" dy="${dy}" result="offsetblur"/><feFlood flood-color="${color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="${opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';

                return joint.util.template(tpl)({
                    dx: args.dx || 0,
                    dy: args.dy || 0,
                    opacity: _.isFinite(args.opacity) ? args.opacity : 1,
                    color: args.color || 'black',
                    blur: _.isFinite(args.blur) ? args.blur : 4
                });
            },

            // `amount` ... the proportion of the conversion. A value of 1 is completely grayscale. A value of 0 leaves the input unchanged.
            grayscale: function(args) {

                var amount = _.isFinite(args.amount) ? args.amount : 1;

                return joint.util.template('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0"/></filter>')({
                    a: 0.2126 + 0.7874 * (1 - amount),
                    b: 0.7152 - 0.7152 * (1 - amount),
                    c: 0.0722 - 0.0722 * (1 - amount),
                    d: 0.2126 - 0.2126 * (1 - amount),
                    e: 0.7152 + 0.2848 * (1 - amount),
                    f: 0.0722 - 0.0722 * (1 - amount),
                    g: 0.2126 - 0.2126 * (1 - amount),
                    h: 0.0722 + 0.9278 * (1 - amount)
                });
            },

            // `amount` ... the proportion of the conversion. A value of 1 is completely sepia. A value of 0 leaves the input unchanged.
            sepia: function(args) {

                var amount = _.isFinite(args.amount) ? args.amount : 1;

                return joint.util.template('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0"/></filter>')({
                    a: 0.393 + 0.607 * (1 - amount),
                    b: 0.769 - 0.769 * (1 - amount),
                    c: 0.189 - 0.189 * (1 - amount),
                    d: 0.349 - 0.349 * (1 - amount),
                    e: 0.686 + 0.314 * (1 - amount),
                    f: 0.168 - 0.168 * (1 - amount),
                    g: 0.272 - 0.272 * (1 - amount),
                    h: 0.534 - 0.534 * (1 - amount),
                    i: 0.131 + 0.869 * (1 - amount)
                });
            },

            // `amount` ... the proportion of the conversion. A value of 0 is completely un-saturated. A value of 1 leaves the input unchanged.
            saturate: function(args) {

                var amount = _.isFinite(args.amount) ? args.amount : 1;

                return joint.util.template('<filter><feColorMatrix type="saturate" values="${amount}"/></filter>')({
                    amount: 1 - amount
                });
            },

            // `angle` ...  the number of degrees around the color circle the input samples will be adjusted.
            hueRotate: function(args) {

                return joint.util.template('<filter><feColorMatrix type="hueRotate" values="${angle}"/></filter>')({
                    angle: args.angle || 0
                });
            },

            // `amount` ... the proportion of the conversion. A value of 1 is completely inverted. A value of 0 leaves the input unchanged.
            invert: function(args) {

                var amount = _.isFinite(args.amount) ? args.amount : 1;

                return joint.util.template('<filter><feComponentTransfer><feFuncR type="table" tableValues="${amount} ${amount2}"/><feFuncG type="table" tableValues="${amount} ${amount2}"/><feFuncB type="table" tableValues="${amount} ${amount2}"/></feComponentTransfer></filter>')({
                    amount: amount,
                    amount2: 1 - amount
                });
            },

            // `amount` ... proportion of the conversion. A value of 0 will create an image that is completely black. A value of 1 leaves the input unchanged.
            brightness: function(args) {

                return joint.util.template('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}"/><feFuncG type="linear" slope="${amount}"/><feFuncB type="linear" slope="${amount}"/></feComponentTransfer></filter>')({
                    amount: _.isFinite(args.amount) ? args.amount : 1
                });
            },

            // `amount` ... proportion of the conversion. A value of 0 will create an image that is completely black. A value of 1 leaves the input unchanged.
            contrast: function(args) {

                var amount = _.isFinite(args.amount) ? args.amount : 1;

                return joint.util.template('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}" intercept="${amount2}"/><feFuncG type="linear" slope="${amount}" intercept="${amount2}"/><feFuncB type="linear" slope="${amount}" intercept="${amount2}"/></feComponentTransfer></filter>')({
                    amount: amount,
                    amount2: .5 - amount / 2
                });
            }
        },

        format: {

            // Formatting numbers via the Python Format Specification Mini-language.
            // See http://docs.python.org/release/3.1.3/library/string.html#format-specification-mini-language.
            // Heavilly inspired by the D3.js library implementation.
            number: function(specifier, value, locale) {

                locale = locale || {

                    currency: ['$', ''],
                    decimal: '.',
                    thousands: ',',
                    grouping: [3]
                };

                // See Python format specification mini-language: http://docs.python.org/release/3.1.3/library/string.html#format-specification-mini-language.
                // [[fill]align][sign][symbol][0][width][,][.precision][type]
                var re = /(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i;

                var match = re.exec(specifier);
                var fill = match[1] || ' ';
                var align = match[2] || '>';
                var sign = match[3] || '';
                var symbol = match[4] || '';
                var zfill = match[5];
                var width = +match[6];
                var comma = match[7];
                var precision = match[8];
                var type = match[9];
                var scale = 1;
                var prefix = '';
                var suffix = '';
                var integer = false;

                if (precision) precision = +precision.substring(1);

                if (zfill || fill === '0' && align === '=') {
                    zfill = fill = '0';
                    align = '=';
                    if (comma) width -= Math.floor((width - 1) / 4);
                }

                switch (type) {
                    case 'n':
                        comma = true; type = 'g';
                        break;
                    case '%':
                        scale = 100; suffix = '%'; type = 'f';
                        break;
                    case 'p':
                        scale = 100; suffix = '%'; type = 'r';
                        break;
                    case 'b':
                    case 'o':
                    case 'x':
                    case 'X':
                        if (symbol === '#') prefix = '0' + type.toLowerCase();
                        break;
                    case 'c':
                    case 'd':
                        integer = true; precision = 0;
                        break;
                    case 's':
                        scale = -1; type = 'r';
                        break;
                }

                if (symbol === '$') {
                    prefix = locale.currency[0];
                    suffix = locale.currency[1];
                }

                // If no precision is specified for `'r'`, fallback to general notation.
                if (type == 'r' && !precision) type = 'g';

                // Ensure that the requested precision is in the supported range.
                if (precision != null) {
                    if (type == 'g') precision = Math.max(1, Math.min(21, precision));
                    else if (type == 'e' || type == 'f') precision = Math.max(0, Math.min(20, precision));
                }

                var zcomma = zfill && comma;

                // Return the empty string for floats formatted as ints.
                if (integer && (value % 1)) return '';

                // Convert negative to positive, and record the sign prefix.
                var negative = value < 0 || value === 0 && 1 / value < 0 ? (value = -value, '-') : sign;

                var fullSuffix = suffix;

                // Apply the scale, computing it from the value's exponent for si format.
                // Preserve the existing suffix, if any, such as the currency symbol.
                if (scale < 0) {
                    var unit = this.prefix(value, precision);
                    value = unit.scale(value);
                    fullSuffix = unit.symbol + suffix;
                } else {
                    value *= scale;
                }

                // Convert to the desired precision.
                value = this.convert(type, value, precision);

                // Break the value into the integer part (before) and decimal part (after).
                var i = value.lastIndexOf('.');
                var before = i < 0 ? value : value.substring(0, i);
                var after = i < 0 ? '' : locale.decimal + value.substring(i + 1);

                function formatGroup(value) {

                    var i = value.length;
                    var t = [];
                    var j = 0;
                    var g = locale.grouping[0];
                    while (i > 0 && g > 0) {
                        t.push(value.substring(i -= g, i + g));
                        g = locale.grouping[j = (j + 1) % locale.grouping.length];
                    }
                    return t.reverse().join(locale.thousands);
                }

                // If the fill character is not `'0'`, grouping is applied before padding.
                if (!zfill && comma && locale.grouping) {

                    before = formatGroup(before);
                }

                var length = prefix.length + before.length + after.length + (zcomma ? 0 : negative.length);
                var padding = length < width ? new Array(length = width - length + 1).join(fill) : '';

                // If the fill character is `'0'`, grouping is applied after padding.
                if (zcomma) before = formatGroup(padding + before);

                // Apply prefix.
                negative += prefix;

                // Rejoin integer and decimal parts.
                value = before + after;

                return (align === '<' ? negative + value + padding
                        : align === '>' ? padding + negative + value
                        : align === '^' ? padding.substring(0, length >>= 1) + negative + value + padding.substring(length)
                        : negative + (zcomma ? value : padding + value)) + fullSuffix;
            },

            // Formatting string via the Python Format string.
            // See https://docs.python.org/2/library/string.html#format-string-syntax)
            string: function(formatString, value) {

                var fieldDelimiterIndex;
                var fieldDelimiter = '{';
                var endPlaceholder = false;
                var formattedStringArray = [];

                while ((fieldDelimiterIndex = formatString.indexOf(fieldDelimiter)) !== -1) {

                    var pieceFormatedString, formatSpec, fieldName;

                    pieceFormatedString = formatString.slice(0, fieldDelimiterIndex);

                    if (endPlaceholder) {
                        formatSpec = pieceFormatedString.split(':');
                        fieldName = formatSpec.shift().split('.');
                        pieceFormatedString = value;

                        for (var i = 0; i < fieldName.length; i++)
                            pieceFormatedString = pieceFormatedString[fieldName[i]];

                        if (formatSpec.length)
                            pieceFormatedString = this.number(formatSpec, pieceFormatedString);
                    }

                    formattedStringArray.push(pieceFormatedString);

                    formatString = formatString.slice(fieldDelimiterIndex + 1);
                    fieldDelimiter = (endPlaceholder = !endPlaceholder) ? '}' : '{';
                }
                formattedStringArray.push(formatString);

                return formattedStringArray.join('');
            },

            convert: function(type, value, precision) {

                switch (type) {
                    case 'b': return value.toString(2);
                    case 'c': return String.fromCharCode(value);
                    case 'o': return value.toString(8);
                    case 'x': return value.toString(16);
                    case 'X': return value.toString(16).toUpperCase();
                    case 'g': return value.toPrecision(precision);
                    case 'e': return value.toExponential(precision);
                    case 'f': return value.toFixed(precision);
                    case 'r': return (value = this.round(value, this.precision(value, precision))).toFixed(Math.max(0, Math.min(20, this.precision(value * (1 + 1e-15), precision))));
                    default: return value + '';
                }
            },

            round: function(value, precision) {

                return precision
                    ? Math.round(value * (precision = Math.pow(10, precision))) / precision
                    : Math.round(value);
            },

            precision: function(value, precision) {

                return precision - (value ? Math.ceil(Math.log(value) / Math.LN10) : 1);
            },

            prefix: function(value, precision) {

                var prefixes = _.map(['y', 'z', 'a', 'f', 'p', 'n', 'µ', 'm', '', 'k', 'M', 'G', 'T', 'P', 'E', 'Z', 'Y'], function(d, i) {
                    var k = Math.pow(10, Math.abs(8 - i) * 3);
                    return {
                        scale: i > 8 ? function(d) { return d / k; } : function(d) { return d * k; },
                        symbol: d
                    };
                });

                var i = 0;
                if (value) {
                    if (value < 0) value *= -1;
                    if (precision) value = this.round(value, this.precision(value, precision));
                    i = 1 + Math.floor(1e-12 + Math.log(value) / Math.LN10);
                    i = Math.max(-24, Math.min(24, Math.floor((i <= 0 ? i + 1 : i - 1) / 3) * 3));
                }
                return prefixes[8 + i / 3];
            }
        },

        /*
            Pre-compile the HTML to be used as a template.
        */
        template: function(html) {

            /*
                Must support the variation in templating syntax found here:
                https://lodash.com/docs#template
            */
            var regex = /<%= ([^ ]+) %>|\$\{ ?([^\{\} ]+) ?\}|\{\{([^\{\} ]+)\}\}/g;

            return function(data) {

                data = data || {};

                return html.replace(regex, function(match) {

                    var args = Array.prototype.slice.call(arguments);
                    var attr = _.find(args.slice(1, 4), function(_attr) {
                        return !!_attr;
                    });

                    var attrArray = attr.split('.');
                    var value = data[attrArray.shift()];

                    while (!_.isUndefined(value) && attrArray.length) {
                        value = value[attrArray.shift()];
                    }

                    return !_.isUndefined(value) ? value : '';
                });
            };
        },

        /**
         * @param {Element=} el Element, which content is intent to display in full-screen mode, 'document.body' is default.
         */
        toggleFullScreen: function(el) {

            el = el || document.body;

            function prefixedResult(el, prop) {

                var prefixes = ['webkit', 'moz', 'ms', 'o', ''];
                for (var i = 0; i < prefixes.length; i++) {
                    var prefix = prefixes[i];
                    var propName = prefix ? (prefix + prop) : (prop.substr(0, 1).toLowerCase() + prop.substr(1));
                    if (!_.isUndefined(el[propName])) {
                        return _.isFunction(el[propName]) ? el[propName]() : el[propName];
                    }
                }
            }

            if (prefixedResult(document, 'FullscreenElement') || prefixedResult(document, 'FullScreenElement')) {
                prefixedResult(document, 'ExitFullscreen') || // Spec.
                prefixedResult(document, 'CancelFullScreen'); // Firefox
            } else {
                prefixedResult(el, 'RequestFullscreen') || // Spec.
                prefixedResult(el, 'RequestFullScreen'); // Firefox
            }
        },

        addClassNamePrefix: function(className) {

            if (!className) return className;

            return _.map(className.toString().split(' '), function(_className) {

                if (_className.substr(0, joint.config.classNamePrefix.length) !== joint.config.classNamePrefix) {
                    _className = joint.config.classNamePrefix + _className;
                }

                return _className;

            }).join(' ');
        },

        removeClassNamePrefix: function(className) {

            if (!className) return className;

            return _.map(className.toString().split(' '), function(_className) {

                if (_className.substr(0, joint.config.classNamePrefix.length) === joint.config.classNamePrefix) {
                    _className = _className.substr(joint.config.classNamePrefix.length);
                }

                return _className;

            }).join(' ');
        },

        wrapWith: function(object, methods, wrapper) {

            if (_.isString(wrapper)) {

                if (!joint.util.wrappers[wrapper]) {
                    throw new Error('Unknown wrapper: "' + wrapper + '"');
                }

                wrapper = joint.util.wrappers[wrapper];
            }

            if (!_.isFunction(wrapper)) {
                throw new Error('Wrapper must be a function.');
            }

            _.each(methods, function(method) {
                object[method] = wrapper(object[method]);
            });
        },

        wrappers: {

            /*
                Prepares a function with the following usage:

                    fn([cell, cell, cell], opt);
                    fn([cell, cell, cell]);
                    fn(cell, cell, cell, opt);
                    fn(cell, cell, cell);
                    fn(cell);
            */
            cells: function(fn) {

                return function() {

                    var args = Array.prototype.slice.call(arguments);
                    var cells = args.length > 0 && _.first(args) || [];
                    var opt = args.length > 1 && _.last(args) || {};

                    if (!_.isArray(cells)) {

                        if (opt instanceof joint.dia.Cell) {
                            cells = args;
                        } else if (cells instanceof joint.dia.Cell) {
                            cells = args.length > 1 ? _.initial(args) : args;
                        }
                    }

                    if (opt instanceof joint.dia.Cell) {
                        opt = {};
                    }

                    return fn.call(this, cells, opt);
                };
            }
        }
    }
};


joint.mvc.View = Backbone.View.extend({

    options: {},
    theme: null,
    themeClassNamePrefix: joint.util.addClassNamePrefix('theme-'),
    requireSetThemeOverride: false,
    defaultTheme: joint.config.defaultTheme,

    constructor: function(options) {

        Backbone.View.call(this, options);
    },

    initialize: function(options) {

        this.requireSetThemeOverride = options && !!options.theme;

        this.options = _.extend({}, this.options, options);

        _.bindAll(this, 'setTheme', 'onSetTheme', 'remove', 'onRemove');

        joint.mvc.views[this.cid] = this;

        this.setTheme(this.options.theme || this.defaultTheme);
        this._ensureElClassName();
        this.init();
    },

    // Override the Backbone `_ensureElement()` method in order to create an
    // svg element (e.g., `<g>`) node that wraps all the nodes of the Cell view.
    _ensureElement: function() {
        var el;

        if (this.svgElement) {

            if (!this.el) {

                var attrs = _.extend({ id: this.id }, _.result(this, 'attributes'));
                if (this.className) attrs['class'] = _.result(this, 'className');
                el = V(_.result(this, 'tagName'), attrs).node;

            } else {

                el = _.result(this, 'el');
            }

            this.setElement(el, false);

        } else {

            Backbone.View.prototype._ensureElement.call(this);

        }

    },

    // Utilize an alternative DOM manipulation API by
    // adding an element reference wrapped in Vectorizer.
    _setElement: function(el) {

        if (this.svgElement) {

            this.$el = el instanceof Backbone.$ ? el : Backbone.$(el);
            this.el = this.$el[0];
            this.vel = V(this.el);

        } else {

            Backbone.View.prototype._setElement.call(this, el);

        }

    },

    _ensureElClassName: function() {

        var className = _.result(this, 'className');
        var prefixedClassName = joint.util.addClassNamePrefix(className);

        this.$el.removeClass(className);
        this.$el.addClass(prefixedClassName);
    },

    init: function() {
        // Intentionally empty.
        // This method is meant to be overriden.
    },

    onRender: function() {
        // Intentionally empty.
        // This method is meant to be overriden.
    },

    setTheme: function(theme, opt) {

        opt = opt || {};

        // Theme is already set, override is required, and override has not been set.
        // Don't set the theme.
        if (this.theme && this.requireSetThemeOverride && !opt.override) {
            return this;
        }

        this.removeThemeClassName();
        this.addThemeClassName(theme);
        this.onSetTheme(this.theme/* oldTheme */, theme/* newTheme */);
        this.theme = theme;

        return this;
    },

    addThemeClassName: function(theme) {

        theme = theme || this.theme;

        var className = this.themeClassNamePrefix + theme;

        this.$el.addClass(className);

        return this;
    },

    removeThemeClassName: function(theme) {

        theme = theme || this.theme;

        var className = this.themeClassNamePrefix + theme;

        this.$el.removeClass(className);

        return this;
    },

    onSetTheme: function(oldTheme, newTheme) {
        // Intentionally empty.
        // This method is meant to be overriden.
    },

    remove: function() {

        this.onRemove();

        joint.mvc.views[this.cid] = null;

        Backbone.View.prototype.remove.apply(this, arguments);

        return this;
    },

    onRemove: function() {
        // Intentionally empty.
        // This method is meant to be overriden.
    },

    getEventNamespace: function() {
        // Returns a per-session unique namespace
        return '.joint-event-ns-' + this.cid;
    }

}, {

    extend: function() {

        var args = Array.prototype.slice.call(arguments);

        // Deep clone the prototype and static properties objects.
        // This prevents unexpected behavior where some properties are overwritten outside of this function.
        var protoProps = args[0] && _.clone(args[0]) || {};
        var staticProps = args[1] && _.clone(args[1]) || {};

        // Need the real render method so that we can wrap it and call it later.
        var renderFn = protoProps.render || (this.prototype && this.prototype.render) || null;

        /*
            Wrap the real render method so that:
                .. `onRender` is always called.
                .. `this` is always returned.
        */
        protoProps.render = function() {

            if (renderFn) {
                // Call the original render method.
                renderFn.apply(this, arguments);
            }

            // Should always call onRender() method.
            this.onRender();

            // Should always return itself.
            return this;
        };

        return Backbone.View.extend.call(this, protoProps, staticProps);
    }
});



joint.dia.GraphCells = Backbone.Collection.extend({

    cellNamespace: joint.shapes,

    initialize: function(models, opt) {

        // Set the optional namespace where all model classes are defined.
        if (opt.cellNamespace) {
            this.cellNamespace = opt.cellNamespace;
        }

        this.graph = opt.graph;
    },

    model: function(attrs, options) {

        var collection = options.collection;
        var namespace = collection.cellNamespace;

        // Find the model class in the namespace or use the default one.
        var ModelClass = (attrs.type === 'link')
            ? joint.dia.Link
            : joint.util.getByPath(namespace, attrs.type, '.') || joint.dia.Element;

        var cell = new ModelClass(attrs, options);
        // Add a reference to the graph. It is necessary to do this here because this is the earliest place
        // where a new model is created from a plain JS object. For other objects, see `joint.dia.Graph>>_prepareCell()`.
        cell.graph = collection.graph;

        return cell;
    },

    // `comparator` makes it easy to sort cells based on their `z` index.
    comparator: function(model) {

        return model.get('z') || 0;
    }
});


joint.dia.Graph = Backbone.Model.extend({

    _batches: {},

    initialize: function(attrs, opt) {

        opt = opt || {};

        // Passing `cellModel` function in the options object to graph allows for
        // setting models based on attribute objects. This is especially handy
        // when processing JSON graphs that are in a different than JointJS format.
        var cells = new joint.dia.GraphCells([], {
            model: opt.cellModel,
            cellNamespace: opt.cellNamespace,
            graph: this
        });
        Backbone.Model.prototype.set.call(this, 'cells', cells);

        // Make all the events fired in the `cells` collection available.
        // to the outside world.
        cells.on('all', this.trigger, this);

        // Backbone automatically doesn't trigger re-sort if models attributes are changed later when
        // they're already in the collection. Therefore, we're triggering sort manually here.
        this.on('change:z', this._sortOnChangeZ, this);
        this.on('batch:stop', this._onBatchStop, this);

        // `joint.dia.Graph` keeps an internal data structure (an adjacency list)
        // for fast graph queries. All changes that affect the structure of the graph
        // must be reflected in the `al` object. This object provides fast answers to
        // questions such as "what are the neighbours of this node" or "what
        // are the sibling links of this link".

        // Outgoing edges per node. Note that we use a hash-table for the list
        // of outgoing edges for a faster lookup.
        // [node ID] -> Object [edge] -> true
        this._out = {};
        // Ingoing edges per node.
        // [node ID] -> Object [edge] -> true
        this._in = {};
        // `_nodes` is useful for quick lookup of all the elements in the graph, without
        // having to go through the whole cells array.
        // [node ID] -> true
        this._nodes = {};
        // `_edges` is useful for quick lookup of all the links in the graph, without
        // having to go through the whole cells array.
        // [edge ID] -> true
        this._edges = {};

        cells.on('add', this._restructureOnAdd, this);
        cells.on('remove', this._restructureOnRemove, this);
        cells.on('reset', this._restructureOnReset, this);
        cells.on('change:source', this._restructureOnChangeSource, this);
        cells.on('change:target', this._restructureOnChangeTarget, this);
        cells.on('remove', this._removeCell, this);
    },

    _sortOnChangeZ: function() {

        if (!this.hasActiveBatch('to-front') && !this.hasActiveBatch('to-back')) {
            this.get('cells').sort();
        }
    },

    _onBatchStop: function(data) {

        var batchName = data && data.batchName;
        if ((batchName === 'to-front' || batchName === 'to-back') && !this.hasActiveBatch(batchName)) {
            this.get('cells').sort();
        }
    },

    _restructureOnAdd: function(cell) {

        if (cell.isLink()) {
            this._edges[cell.id] = true;
            var source = cell.get('source');
            var target = cell.get('target');
            if (source.id) {
                (this._out[source.id] || (this._out[source.id] = {}))[cell.id] = true;
            }
            if (target.id) {
                (this._in[target.id] || (this._in[target.id] = {}))[cell.id] = true;
            }
        } else {
            this._nodes[cell.id] = true;
        }
    },

    _restructureOnRemove: function(cell) {

        if (cell.isLink()) {
            delete this._edges[cell.id];
            var source = cell.get('source');
            var target = cell.get('target');
            if (source.id && this._out[source.id] && this._out[source.id][cell.id]) {
                delete this._out[source.id][cell.id];
            }
            if (target.id && this._in[target.id] && this._in[target.id][cell.id]) {
                delete this._in[target.id][cell.id];
            }
        } else {
            delete this._nodes[cell.id];
        }
    },

    _restructureOnReset: function(cells) {

        // Normalize into an array of cells. The original `cells` is GraphCells Backbone collection.
        cells = cells.models;

        this._out = {};
        this._in = {};
        this._nodes = {};
        this._edges = {};

        _.each(cells, this._restructureOnAdd, this);
    },

    _restructureOnChangeSource: function(link) {

        var prevSource = link.previous('source');
        if (prevSource.id && this._out[prevSource.id]) {
            delete this._out[prevSource.id][link.id];
        }
        var source = link.get('source');
        if (source.id) {
            (this._out[source.id] || (this._out[source.id] = {}))[link.id] = true;
        }
    },

    _restructureOnChangeTarget: function(link) {

        var prevTarget = link.previous('target');
        if (prevTarget.id && this._in[prevTarget.id]) {
            delete this._in[prevTarget.id][link.id];
        }
        var target = link.get('target');
        if (target.id) {
            (this._in[target.id] || (this._in[target.id] = {}))[link.id] = true;
        }
    },

    // Return all outbound edges for the node. Return value is an object
    // of the form: [edge] -> true
    getOutboundEdges: function(node) {

        return (this._out && this._out[node]) || {};
    },

    // Return all inbound edges for the node. Return value is an object
    // of the form: [edge] -> true
    getInboundEdges: function(node) {

        return (this._in && this._in[node]) || {};
    },

    toJSON: function() {

        // Backbone does not recursively call `toJSON()` on attributes that are themselves models/collections.
        // It just clones the attributes. Therefore, we must call `toJSON()` on the cells collection explicitely.
        var json = Backbone.Model.prototype.toJSON.apply(this, arguments);
        json.cells = this.get('cells').toJSON();
        return json;
    },

    fromJSON: function(json, opt) {

        if (!json.cells) {

            throw new Error('Graph JSON must contain cells array.');
        }

        return this.set(json, opt);
    },

    set: function(key, val, opt) {

        var attrs;

        // Handle both `key`, value and {key: value} style arguments.
        if (typeof key === 'object') {
            attrs = key;
            opt = val;
        } else {
            (attrs = {})[key] = val;
        }

        // Make sure that `cells` attribute is handled separately via resetCells().
        if (attrs.hasOwnProperty('cells')) {
            this.resetCells(attrs.cells, opt);
            attrs = _.omit(attrs, 'cells');
        }

        // The rest of the attributes are applied via original set method.
        return Backbone.Model.prototype.set.call(this, attrs, opt);
    },

    clear: function(opt) {

        opt = _.extend({}, opt, { clear: true });

        var collection = this.get('cells');

        if (collection.length === 0) return this;

        this.startBatch('clear', opt);

        // The elements come after the links.
        var cells = collection.sortBy(function(cell) {
            return cell.isLink() ? 1 : 2;
        });

        do {

            // Remove all the cells one by one.
            // Note that all the links are removed first, so it's
            // safe to remove the elements without removing the connected
            // links first.
            cells.shift().remove(opt);

        } while (cells.length > 0);

        this.stopBatch('clear');

        return this;
    },

    _prepareCell: function(cell, opt) {

        var attrs;
        if (cell instanceof Backbone.Model) {
            attrs = cell.attributes;
            if (!cell.graph && (!opt || !opt.dry)) {
                // An element can not be member of more than one graph.
                // A cell stops being the member of the graph after it's explicitely removed.
                cell.graph = this;
            }
        } else {
            // In case we're dealing with a plain JS object, we have to set the reference
            // to the `graph` right after the actual model is created. This happens in the `model()` function
            // of `joint.dia.GraphCells`.
            attrs = cell;
        }

        if (!_.isString(attrs.type)) {
            throw new TypeError('dia.Graph: cell type must be a string.');
        }

        return cell;
    },

    maxZIndex: function() {

        var lastCell = this.get('cells').last();
        return lastCell ? (lastCell.get('z') || 0) : 0;
    },

    addCell: function(cell, opt) {

        if (_.isArray(cell)) {

            return this.addCells(cell, opt);
        }

        if (cell instanceof Backbone.Model) {

            if (!cell.has('z')) {
                cell.set('z', this.maxZIndex() + 1);
            }

        } else if (_.isUndefined(cell.z)) {

            cell.z = this.maxZIndex() + 1;
        }

        this.get('cells').add(this._prepareCell(cell, opt), opt || {});

        return this;
    },

    addCells: function(cells, opt) {

        if (cells.length) {

            cells = _.flattenDeep(cells);
            opt.position = cells.length;

            this.startBatch('add');
            _.each(cells, function(cell) {
                opt.position--;
                this.addCell(cell, opt);
            }, this);
            this.stopBatch('add');
        }

        return this;
    },

    // When adding a lot of cells, it is much more efficient to
    // reset the entire cells collection in one go.
    // Useful for bulk operations and optimizations.
    resetCells: function(cells, opt) {

        var preparedCells = _.map(cells, _.bind(this._prepareCell, this, _, opt));
        this.get('cells').reset(preparedCells, opt);

        return this;
    },

    removeCells: function(cells, opt) {

        if (cells.length) {

            this.startBatch('remove');
            _.invoke(cells, 'remove', opt);
            this.stopBatch('remove');
        }

        return this;
    },

    _removeCell: function(cell, collection, options) {

        options = options || {};

        if (!options.clear) {
            // Applications might provide a `disconnectLinks` option set to `true` in order to
            // disconnect links when a cell is removed rather then removing them. The default
            // is to remove all the associated links.
            if (options.disconnectLinks) {

                this.disconnectLinks(cell, options);

            } else {

                this.removeLinks(cell, options);
            }
        }
        // Silently remove the cell from the cells collection. Silently, because
        // `joint.dia.Cell.prototype.remove` already triggers the `remove` event which is
        // then propagated to the graph model. If we didn't remove the cell silently, two `remove` events
        // would be triggered on the graph model.
        this.get('cells').remove(cell, { silent: true });

        if (cell.graph === this) {
            // Remove the element graph reference only if the cell is the member of this graph.
            cell.graph = null;
        }
    },

    // Get a cell by `id`.
    getCell: function(id) {

        return this.get('cells').get(id);
    },

    getCells: function() {

        return this.get('cells').toArray();
    },

    getElements: function() {

        return _.map(this._nodes, function(exists, node) { return this.getCell(node); }, this);
    },

    getLinks: function() {

        return _.map(this._edges, function(exists, edge) { return this.getCell(edge); }, this);
    },

    getFirstCell: function() {

        return this.get('cells').first();
    },

    getLastCell: function() {

        return this.get('cells').last();
    },

    // Get all inbound and outbound links connected to the cell `model`.
    getConnectedLinks: function(model, opt) {

        opt = opt || {};

        var inbound = opt.inbound;
        var outbound = opt.outbound;
        if (_.isUndefined(inbound) && _.isUndefined(outbound)) {
            inbound = outbound = true;
        }

        // The final array of connected link models.
        var links = [];
        // Connected edges. This hash table ([edge] -> true) serves only
        // for a quick lookup to check if we already added a link.
        var edges = {};

        if (outbound) {
            _.each(this.getOutboundEdges(model.id), function(exists, edge) {
                if (!edges[edge]) {
                    links.push(this.getCell(edge));
                    edges[edge] = true;
                }
            }, this);
        }
        if (inbound) {
            _.each(this.getInboundEdges(model.id), function(exists, edge) {
                // Skip links that were already added. Those must be self-loop links
                // because they are both inbound and outbond edges of the same element.
                if (!edges[edge]) {
                    links.push(this.getCell(edge));
                    edges[edge] = true;
                }
            }, this);
        }

        // If 'deep' option is 'true', return all the links that are connected to any of the descendent cells
        // and are not descendents themselves.
        if (opt.deep) {

            var embeddedCells = model.getEmbeddedCells({ deep: true });
            // In the first round, we collect all the embedded edges so that we can exclude
            // them from the final result.
            var embeddedEdges = {};
            _.each(embeddedCells, function(cell) {
                if (cell.isLink()) {
                    embeddedEdges[cell.id] = true;
                }
            });
            _.each(embeddedCells, function(cell) {
                if (cell.isLink()) return;
                if (outbound) {
                    _.each(this.getOutboundEdges(cell.id), function(exists, edge) {
                        if (!edges[edge] && !embeddedEdges[edge]) {
                            links.push(this.getCell(edge));
                            edges[edge] = true;
                        }
                    }, this);
                }
                if (inbound) {
                    _.each(this.getInboundEdges(cell.id), function(exists, edge) {
                        if (!edges[edge] && !embeddedEdges[edge]) {
                            links.push(this.getCell(edge));
                            edges[edge] = true;
                        }
                    }, this);
                }
            }, this);
        }

        return links;
    },

    getNeighbors: function(model, opt) {

        opt = opt || {};

        var inbound = opt.inbound;
        var outbound = opt.outbound;
        if (_.isUndefined(inbound) && _.isUndefined(outbound)) {
            inbound = outbound = true;
        }

        var neighbors = _.transform(this.getConnectedLinks(model, opt), function(res, link) {

            var source = link.get('source');
            var target = link.get('target');
            var loop = link.hasLoop(opt);

            // Discard if it is a point, or if the neighbor was already added.
            if (inbound && _.has(source, 'id') && !res[source.id]) {

                var sourceElement = this.getCell(source.id);

                if (loop || (sourceElement && sourceElement !== model && (!opt.deep || !sourceElement.isEmbeddedIn(model)))) {
                    res[source.id] = sourceElement;
                }
            }

            // Discard if it is a point, or if the neighbor was already added.
            if (outbound && _.has(target, 'id') && !res[target.id]) {

                var targetElement = this.getCell(target.id);

                if (loop || (targetElement && targetElement !== model && (!opt.deep || !targetElement.isEmbeddedIn(model)))) {
                    res[target.id] = targetElement;
                }
            }

        }, {}, this);

        return _.values(neighbors);
    },

    getCommonAncestor: function(/* cells */) {

        var cellsAncestors = _.map(arguments, function(cell) {

            var ancestors = [];
            var parentId = cell.get('parent');

            while (parentId) {

                ancestors.push(parentId);
                parentId = this.getCell(parentId).get('parent');
            }

            return ancestors;

        }, this);

        cellsAncestors = _.sortBy(cellsAncestors, 'length');

        var commonAncestor = _.find(cellsAncestors.shift(), function(ancestor) {

            return _.every(cellsAncestors, function(cellAncestors) {
                return _.contains(cellAncestors, ancestor);
            });
        });

        return this.getCell(commonAncestor);
    },

    // Find the whole branch starting at `element`.
    // If `opt.deep` is `true`, take into account embedded elements too.
    // If `opt.breadthFirst` is `true`, use the Breadth-first search algorithm, otherwise use Depth-first search.
    getSuccessors: function(element, opt) {

        opt = opt || {};
        var res = [];
        // Modify the options so that it includes the `outbound` neighbors only. In other words, search forwards.
        this.search(element, function(el) {
            if (el !== element) {
                res.push(el);
            }
        }, _.extend({}, opt, { outbound: true }));
        return res;
    },

    // Clone `cells` returning an object that maps the original cell ID to the clone. The number
    // of clones is exactly the same as the `cells.length`.
    // This function simply clones all the `cells`. However, it also reconstructs
    // all the `source/target` and `parent/embed` references within the `cells`.
    // This is the main difference from the `cell.clone()` method. The
    // `cell.clone()` method works on one single cell only.
    // For example, for a graph: `A --- L ---> B`, `cloneCells([A, L, B])`
    // returns `[A2, L2, B2]` resulting to a graph: `A2 --- L2 ---> B2`, i.e.
    // the source and target of the link `L2` is changed to point to `A2` and `B2`.
    cloneCells: function(cells) {

        cells = _.unique(cells);

        // A map of the form [original cell ID] -> [clone] helping
        // us to reconstruct references for source/target and parent/embeds.
        // This is also the returned value.
        var cloneMap = _.transform(cells, function(map, cell) {
            map[cell.id] = cell.clone();
        }, {});

        _.each(cells, function(cell) {

            var clone = cloneMap[cell.id];
            // assert(clone exists)

            if (clone.isLink()) {
                var source = clone.get('source');
                var target = clone.get('target');
                if (source.id && cloneMap[source.id]) {
                    // Source points to an element and the element is among the clones.
                    // => Update the source of the cloned link.
                    clone.prop('source/id', cloneMap[source.id].id);
                }
                if (target.id && cloneMap[target.id]) {
                    // Target points to an element and the element is among the clones.
                    // => Update the target of the cloned link.
                    clone.prop('target/id', cloneMap[target.id].id);
                }
            }

            // Find the parent of the original cell
            var parent = cell.get('parent');
            if (parent && cloneMap[parent]) {
                clone.set('parent', cloneMap[parent].id);
            }

            // Find the embeds of the original cell
            var embeds = _.reduce(cell.get('embeds'), function(newEmbeds, embed) {
                // Embedded cells that are not being cloned can not be carried
                // over with other embedded cells.
                if (cloneMap[embed]) {
                    newEmbeds.push(cloneMap[embed].id);
                }
                return newEmbeds;
            }, []);

            if (!_.isEmpty(embeds)) {
                clone.set('embeds', embeds);
            }
        });

        return cloneMap;
    },

    // Clone the whole subgraph (including all the connected links whose source/target is in the subgraph).
    // If `opt.deep` is `true`, also take into account all the embedded cells of all the subgraph cells.
    // Return a map of the form: [original cell ID] -> [clone].
    cloneSubgraph: function(cells, opt) {

        var subgraph = this.getSubgraph(cells, opt);
        return this.cloneCells(subgraph);
    },

    // Return `cells` and all the connected links that connect cells in the `cells` array.
    // If `opt.deep` is `true`, return all the cells including all their embedded cells
    // and all the links that connect any of the returned cells.
    // For example, for a single shallow element, the result is that very same element.
    // For two elements connected with a link: `A --- L ---> B`, the result for
    // `getSubgraph([A, B])` is `[A, L, B]`. The same goes for `getSubgraph([L])`, the result is again `[A, L, B]`.
    getSubgraph: function(cells, opt) {

        opt = opt || {};

        var subgraph = [];
        // `cellMap` is used for a quick lookup of existance of a cell in the `cells` array.
        var cellMap = {};
        var elements = [];
        var links = [];

        _.each(cells, function(cell) {
            if (!cellMap[cell.id]) {
                subgraph.push(cell);
                cellMap[cell.id] = cell;
                if (cell.isLink()) {
                    links.push(cell);
                } else {
                    elements.push(cell);
                }
            }

            if (opt.deep) {
                var embeds = cell.getEmbeddedCells({ deep: true });
                _.each(embeds, function(embed) {
                    if (!cellMap[embed.id]) {
                        subgraph.push(embed);
                        cellMap[embed.id] = embed;
                        if (embed.isLink()) {
                            links.push(embed);
                        } else {
                            elements.push(embed);
                        }
                    }
                });
            }
        });

        _.each(links, function(link) {
            // For links, return their source & target (if they are elements - not points).
            var source = link.get('source');
            var target = link.get('target');
            if (source.id && !cellMap[source.id]) {
                var sourceElement = this.getCell(source.id);
                subgraph.push(sourceElement);
                cellMap[sourceElement.id] = sourceElement;
                elements.push(sourceElement);
            }
            if (target.id && !cellMap[target.id]) {
                var targetElement = this.getCell(target.id);
                subgraph.push(this.getCell(target.id));
                cellMap[targetElement.id] = targetElement;
                elements.push(targetElement);
            }
        }, this);

        _.each(elements, function(element) {
            // For elements, include their connected links if their source/target is in the subgraph;
            var links = this.getConnectedLinks(element, opt);
            _.each(links, function(link) {
                var source = link.get('source');
                var target = link.get('target');
                if (!cellMap[link.id] && source.id && cellMap[source.id] && target.id && cellMap[target.id]) {
                    subgraph.push(link);
                    cellMap[link.id] = link;
                }
            });
        }, this);

        return subgraph;
    },

    // Find all the predecessors of `element`. This is a reverse operation of `getSuccessors()`.
    // If `opt.deep` is `true`, take into account embedded elements too.
    // If `opt.breadthFirst` is `true`, use the Breadth-first search algorithm, otherwise use Depth-first search.
    getPredecessors: function(element, opt) {

        opt = opt || {};
        var res = [];
        // Modify the options so that it includes the `inbound` neighbors only. In other words, search backwards.
        this.search(element, function(el) {
            if (el !== element) {
                res.push(el);
            }
        }, _.extend({}, opt, { inbound: true }));
        return res;
    },

    // Perform search on the graph.
    // If `opt.breadthFirst` is `true`, use the Breadth-first Search algorithm, otherwise use Depth-first search.
    // By setting `opt.inbound` to `true`, you can reverse the direction of the search.
    // If `opt.deep` is `true`, take into account embedded elements too.
    // `iteratee` is a function of the form `function(element) {}`.
    // If `iteratee` explicitely returns `false`, the searching stops.
    search: function(element, iteratee, opt) {

        opt = opt || {};
        if (opt.breadthFirst) {
            this.bfs(element, iteratee, opt);
        } else {
            this.dfs(element, iteratee, opt);
        }
    },

    // Breadth-first search.
    // If `opt.deep` is `true`, take into account embedded elements too.
    // If `opt.inbound` is `true`, reverse the search direction (it's like reversing all the link directions).
    // `iteratee` is a function of the form `function(element, distance) {}`.
    // where `element` is the currently visited element and `distance` is the distance of that element
    // from the root `element` passed the `bfs()`, i.e. the element we started the search from.
    // Note that the `distance` is not the shortest or longest distance, it is simply the number of levels
    // crossed till we visited the `element` for the first time. It is especially useful for tree graphs.
    // If `iteratee` explicitely returns `false`, the searching stops.
    bfs: function(element, iteratee, opt) {

        opt = opt || {};
        var visited = {};
        var distance = {};
        var queue = [];

        queue.push(element);
        distance[element.id] = 0;

        while (queue.length > 0) {
            var next = queue.shift();
            if (!visited[next.id]) {
                visited[next.id] = true;
                if (iteratee(next, distance[next.id]) === false) return;
                _.each(this.getNeighbors(next, opt), function(neighbor) {
                    distance[neighbor.id] = distance[next.id] + 1;
                    queue.push(neighbor);
                });
            }
        }
    },

    // Depth-first search.
    // If `opt.deep` is `true`, take into account embedded elements too.
    // If `opt.inbound` is `true`, reverse the search direction (it's like reversing all the link directions).
    // `iteratee` is a function of the form `function(element, distance) {}`.
    // If `iteratee` explicitely returns `false`, the search stops.
    dfs: function(element, iteratee, opt, _visited, _distance) {

        opt = opt || {};
        var visited = _visited || {};
        var distance = _distance || 0;
        if (iteratee(element, distance) === false) return;
        visited[element.id] = true;

        _.each(this.getNeighbors(element, opt), function(neighbor) {
            if (!visited[neighbor.id]) {
                this.dfs(neighbor, iteratee, opt, visited, distance + 1);
            }
        }, this);
    },

    // Get all the roots of the graph. Time complexity: O(|V|).
    getSources: function() {

        var sources = [];
        _.each(this._nodes, function(exists, node) {
            if (!this._in[node] || _.isEmpty(this._in[node])) {
                sources.push(this.getCell(node));
            }
        }, this);
        return sources;
    },

    // Get all the leafs of the graph. Time complexity: O(|V|).
    getSinks: function() {

        var sinks = [];
        _.each(this._nodes, function(exists, node) {
            if (!this._out[node] || _.isEmpty(this._out[node])) {
                sinks.push(this.getCell(node));
            }
        }, this);
        return sinks;
    },

    // Return `true` if `element` is a root. Time complexity: O(1).
    isSource: function(element) {

        return !this._in[element.id] || _.isEmpty(this._in[element.id]);
    },

    // Return `true` if `element` is a leaf. Time complexity: O(1).
    isSink: function(element) {

        return !this._out[element.id] || _.isEmpty(this._out[element.id]);
    },

    // Return `true` is `elementB` is a successor of `elementA`. Return `false` otherwise.
    isSuccessor: function(elementA, elementB) {

        var isSuccessor = false;
        this.search(elementA, function(element) {
            if (element === elementB && element !== elementA) {
                isSuccessor = true;
                return false;
            }
        }, { outbound: true });
        return isSuccessor;
    },

    // Return `true` is `elementB` is a predecessor of `elementA`. Return `false` otherwise.
    isPredecessor: function(elementA, elementB) {

        var isPredecessor = false;
        this.search(elementA, function(element) {
            if (element === elementB && element !== elementA) {
                isPredecessor = true;
                return false;
            }
        }, { inbound: true });
        return isPredecessor;
    },

    // Return `true` is `elementB` is a neighbor of `elementA`. Return `false` otherwise.
    // `opt.deep` controls whether to take into account embedded elements as well. See `getNeighbors()`
    // for more details.
    // If `opt.outbound` is set to `true`, return `true` only if `elementB` is a successor neighbor.
    // Similarly, if `opt.inbound` is set to `true`, return `true` only if `elementB` is a predecessor neighbor.
    isNeighbor: function(elementA, elementB, opt) {

        opt = opt || {};

        var inbound = opt.inbound;
        var outbound = opt.outbound;
        if (_.isUndefined(inbound) && _.isUndefined(outbound)) {
            inbound = outbound = true;
        }

        var isNeighbor = false;

        _.each(this.getConnectedLinks(elementA, opt), function(link) {

            var source = link.get('source');
            var target = link.get('target');

            // Discard if it is a point.
            if (inbound && _.has(source, 'id') && source.id === elementB.id) {
                isNeighbor = true;
                return false;
            }

            // Discard if it is a point, or if the neighbor was already added.
            if (outbound && _.has(target, 'id') && target.id === elementB.id) {
                isNeighbor = true;
                return false;
            }
        });

        return isNeighbor;
    },

    // Disconnect links connected to the cell `model`.
    disconnectLinks: function(model, options) {

        _.each(this.getConnectedLinks(model), function(link) {

            link.set(link.get('source').id === model.id ? 'source' : 'target', g.point(0, 0), options);
        });
    },

    // Remove links connected to the cell `model` completely.
    removeLinks: function(model, options) {

        _.invoke(this.getConnectedLinks(model), 'remove', options);
    },

    // Find all elements at given point
    findModelsFromPoint: function(p) {

        return _.filter(this.getElements(), function(el) {
            return el.getBBox().containsPoint(p);
        });
    },

    // Find all elements in given area
    findModelsInArea: function(rect, opt) {

        rect = g.rect(rect);
        opt = _.defaults(opt || {}, { strict: false });

        var method = opt.strict ? 'containsRect' : 'intersect';

        return _.filter(this.getElements(), function(el) {
            return rect[method](el.getBBox());
        });
    },

    // Find all elements under the given element.
    findModelsUnderElement: function(element, opt) {

        opt = _.defaults(opt || {}, { searchBy: 'bbox' });

        var bbox = element.getBBox();
        var elements = (opt.searchBy == 'bbox')
            ? this.findModelsInArea(bbox)
            : this.findModelsFromPoint(bbox[opt.searchBy]());

        // don't account element itself or any of its descendents
        return _.reject(elements, function(el) {
            return element.id == el.id || el.isEmbeddedIn(element);
        });
    },


    // Return bounding box of all elements.
    getBBox: function(cells, opt) {

        return this.getCellsBBox(cells || this.getElements(), opt);
    },

    // Return the bounding box of all cells in array provided.
    // Links are being ignored.
    getCellsBBox: function(cells, opt) {

        return _.reduce(cells, function(memo, cell) {
            if (cell.isLink()) return memo;
            if (memo) {
                return memo.union(cell.getBBox(opt));
            } else {
                return cell.getBBox(opt);
            }
        }, null);
    },

    translate: function(dx, dy, opt) {

        // Don't translate cells that are embedded in any other cell.
        var cells = _.reject(this.getCells(), function(cell) {
            return cell.isEmbedded();
        });

        _.invoke(cells, 'translate', dx, dy, opt);
    },

    resize: function(width, height, opt) {

        return this.resizeCells(width, height, this.getCells(), opt);
    },

    resizeCells: function(width, height, cells, opt) {

        // `getBBox` method returns `null` if no elements provided.
        // i.e. cells can be an array of links
        var bbox = this.getCellsBBox(cells);
        if (bbox) {
            var sx = Math.max(width / bbox.width, 0);
            var sy = Math.max(height / bbox.height, 0);
            _.invoke(cells, 'scale', sx, sy, bbox.origin(), opt);
        }

        return this;
    },

    startBatch: function(name, data) {

        data = data || {};
        this._batches[name] = (this._batches[name] || 0) + 1;

        return this.trigger('batch:start', _.extend({}, data, { batchName: name }));
    },

    stopBatch: function(name, data) {

        data = data || {};
        this._batches[name] = (this._batches[name] || 0) - 1;

        return this.trigger('batch:stop', _.extend({}, data, { batchName: name }));
    },

    hasActiveBatch: function(name) {
        if (name) {
            return this._batches[name];
        } else {
            return _.any(this._batches, function(batches) { return batches > 0; });
        }
    }
});

joint.util.wrapWith(joint.dia.Graph.prototype, ['resetCells', 'addCells', 'removeCells'], 'cells');

(function(joint, _, g, $) {

    function isPercentage(val) {
        return _.isString(val) && val.slice(-1) === '%';
    }

    function setWrapper(attrName, dimension) {
        return function(value, refBBox) {
            var isValuePercentage = isPercentage(value);
            value = parseFloat(value);
            if (isValuePercentage) {
                value /= 100;
            }

            var attrs = {};
            if (isFinite(value)) {
                var attrValue = (isValuePercentage || value >= 0 && value <= 1)
                    ? value * refBBox[dimension]
                    : Math.max(value + refBBox[dimension], 0);
                attrs[attrName] = attrValue;
            }

            return attrs;
        };
    }

    function positionWrapper(axis, dimension, origin) {
        return function(value, refBBox) {
            var valuePercentage = isPercentage(value);
            value = parseFloat(value);
            if (valuePercentage) {
                value /= 100;
            }

            var delta;
            if (isFinite(value)) {
                var refOrigin = refBBox[origin]();
                if (valuePercentage || value > 0 && value < 1) {
                    delta = refOrigin[axis] + refBBox[dimension] * value;
                } else {
                    delta = refOrigin[axis] + value;
                }
            }

            var point = g.Point();
            point[axis] = delta || 0;
            return point;
        };
    }

    function offsetWrapper(axis, dimension, corner) {
        return function(value, nodeBBox) {
            var delta;
            if (value === 'middle') {
                delta = nodeBBox[dimension] / 2;
            } else if (value === corner) {
                delta = nodeBBox[dimension];
            } else if (isFinite(value)) {
                // TODO: or not to do a breaking change?
                delta = (value > -1 && value < 1) ? (-nodeBBox[dimension] * value) : -value;
            } else if (isPercentage(value)) {
                delta = nodeBBox[dimension] * parseFloat(value) / 100;
            } else {
                delta = 0;
            }

            var point = g.Point();
            point[axis] = -(nodeBBox[axis] + delta);
            return point;
        };
    }

    var attributesNS = joint.dia.attributes = {

        xlinkHref: {
            set: 'xlink:href'
        },

        xmlSpace: {
            set: 'xml:space'
        },

        filter: {
            qualify: _.isPlainObject,
            set: function(filter) {
                return 'url(#' + this.paper.defineFilter(filter) + ')';
            }
        },

        fill: {
            qualify: _.isPlainObject,
            set: function(fill) {
                return 'url(#' + this.paper.defineGradient(fill) + ')';
            }
        },

        stroke: {
            qualify: _.isPlainObject,
            set: function(stroke) {
                return 'url(#' + this.paper.defineGradient(stroke) + ')';
            }
        },

        sourceMarker: {
            qualify: _.isPlainObject,
            set: function(marker) {
                return { 'marker-start': 'url(#' + this.paper.defineMarker(marker) + ')' };
            }
        },

        targetMarker: {
            qualify: _.isPlainObject,
            set: function(marker) {
                marker = _.assign({ transform: 'rotate(180)' }, marker);
                return { 'marker-end': 'url(#' + this.paper.defineMarker(marker) + ')' };
            }
        },

        vertexMarker: {
            qualify: _.isPlainObject,
            set: function(marker) {
                return { 'marker-mid': 'url(#' + this.paper.defineMarker(marker) + ')' };
            }
        },

        text: {
            set: function(text, refBBox, node, attrs) {
                var $node = $(node);
                var cacheName = 'joint-text';
                var cache = $node.data(cacheName);
                var textAttrs = _.pick(attrs, 'lineHeight', 'annotations', 'textPath');
                var fontSize = textAttrs.fontSize = attrs['font-size'] || attrs['fontSize'];
                var textHash = JSON.stringify([text, textAttrs]);
                // Update the text only if there was a change in the string
                // or any of its attributes.
                if (cache === undefined || cache !== textHash) {
                    // Chrome bug:
                    // Tspans positions defined as `em` are not updated
                    // when container `font-size` change.
                    if (fontSize) {
                        node.setAttribute('font-size', fontSize);
                    }
                    V(node).text('' + text, textAttrs);
                    $node.data(cacheName, textHash);
                }
            }
        },

        textWrap: {
            qualify: _.isPlainObject,
            set: function(value, refBBox, node, attrs) {
                // option `width`
                var width = value.width || 0;
                if (isPercentage(width)) {
                    refBBox.width *= parseFloat(width) / 100;
                } else if (width <= 0) {
                    refBBox.width += width;
                } else {
                    refBBox.width = width;
                }
                // option `height`
                var height = value.height || 0;
                if (isPercentage(height)) {
                    refBBox.height *= parseFloat(height) / 100;
                } else if (height <= 0) {
                    refBBox.height += height;
                } else {
                    refBBox.height = height;
                }
                // option `text`
                var wrappedText = joint.util.breakText('' + value.text, refBBox, {
                    'font-weight': attrs['font-weight'] || attrs.fontWeight,
                    'font-size': attrs['font-size'] || attrs.fontSize,
                    'font-family': attrs['font-family'] || attrs.fontFamily
                }, {
                    // Provide an existing SVG Document here
                    // instead of creating a temporary one over again.
                    svgDocument: this.paper.svg
                });

                V(node).text(wrappedText);
            }
        },

        lineHeight: {
            qualify: function(lineHeight, node, attrs) {
                return (attrs.text !== undefined);
            }
        },

        textPath: {
            qualify: function(textPath, node, attrs) {
                return (attrs.text !== undefined);
            }
        },

        annotations: {
            qualify: function(annotations, node, attrs) {
                return (attrs.text !== undefined);
            }
        },

        // `port` attribute contains the `id` of the port that the underlying magnet represents.
        port: {
            set: function(port) {
                return (port === null || port.id === undefined) ? port : port.id;
            }
        },

        // `style` attribute is special in the sense that it sets the CSS style of the subelement.
        style: {
            qualify: _.isPlainObject,
            set: function(styles, refBBox, node) {
                $(node).css(styles);
            }
        },

        html: {
            set: function(html, refBBox, node) {
                $(node).html(html + '');
            }
        },

        ref: {
            // We do not set `ref` attribute directly on an element.
            // The attribute itself does not qualify for relative positioning.
        },

        // if `refX` is in [0, 1] then `refX` is a fraction of bounding box width
        // if `refX` is < 0 then `refX`'s absolute values is the right coordinate of the bounding box
        // otherwise, `refX` is the left coordinate of the bounding box

        refX: {
            position: positionWrapper('x', 'width', 'origin')
        },

        refY: {
            position: positionWrapper('y', 'height', 'origin')
        },

        // `ref-dx` and `ref-dy` define the offset of the subelement relative to the right and/or bottom
        // coordinate of the reference element.

        refDx: {
            position: positionWrapper('x', 'width', 'corner')
        },

        refDy: {
            position: positionWrapper('y', 'height', 'corner')
        },

        // 'ref-width'/'ref-height' defines the width/height of the subelement relatively to
        // the reference element size
        // val in 0..1         ref-width = 0.75 sets the width to 75% of the ref. el. width
        // val < 0 || val > 1  ref-height = -20 sets the height to the the ref. el. height shorter by 20

        refWidth: {
            set: setWrapper('width', 'width')
        },

        refHeight: {
            set: setWrapper('height', 'height')
        },

        refRx: {
            set: setWrapper('rx', 'width')
        },

        refRy: {
            set: setWrapper('ry', 'height')
        },

        refCx: {
            set: setWrapper('cx', 'width')
        },

        refCy: {
            set: setWrapper('cy', 'height')
        },

        // `x-alignment` when set to `middle` causes centering of the subelement around its new x coordinate.
        // `x-alignment` when set to `right` uses the x coordinate as referenced to the right of the bbox.

        xAlignment: {
            offset: offsetWrapper('x', 'width', 'right')
        },

        // `y-alignment` when set to `middle` causes centering of the subelement around its new y coordinate.
        // `y-alignment` when set to `bottom` uses the y coordinate as referenced to the bottom of the bbox.

        yAlignment: {
            offset: offsetWrapper('y', 'height', 'bottom')
        }
    };

    // This allows to combine both absolute and relative positioning
    // refX: 50%, refX2: 20
    attributesNS.refX2 = attributesNS.refX;
    attributesNS.refY2 = attributesNS.refY;

    // Aliases for backwards compatibility
    attributesNS['ref-x'] = attributesNS.refX;
    attributesNS['ref-y'] = attributesNS.refY;
    attributesNS['ref-dy'] = attributesNS.refDy;
    attributesNS['ref-dx'] = attributesNS.refDx;
    attributesNS['ref-width'] = attributesNS.refWidth;
    attributesNS['ref-height'] = attributesNS.refHeight;
    attributesNS['x-alignment'] = attributesNS.xAlignment;
    attributesNS['y-alignment'] = attributesNS.yAlignment;

})(joint, _, g, $);


// joint.dia.Cell base model.
// --------------------------

joint.dia.Cell = Backbone.Model.extend({

    // This is the same as Backbone.Model with the only difference that is uses _.merge
    // instead of just _.extend. The reason is that we want to mixin attributes set in upper classes.
    constructor: function(attributes, options) {

        var defaults;
        var attrs = attributes || {};
        this.cid = _.uniqueId('c');
        this.attributes = {};
        if (options && options.collection) this.collection = options.collection;
        if (options && options.parse) attrs = this.parse(attrs, options) || {};
        if ((defaults = _.result(this, 'defaults'))) {
            //<custom code>
            // Replaced the call to _.defaults with _.merge.
            attrs = _.merge({}, defaults, attrs);
            //</custom code>
        }
        this.set(attrs, options);
        this.changed = {};
        this.initialize.apply(this, arguments);
    },

    translate: function(dx, dy, opt) {

        throw new Error('Must define a translate() method.');
    },

    toJSON: function() {

        var defaultAttrs = this.constructor.prototype.defaults.attrs || {};
        var attrs = this.attributes.attrs;
        var finalAttrs = {};

        // Loop through all the attributes and
        // omit the default attributes as they are implicitly reconstructable by the cell 'type'.
        _.each(attrs, function(attr, selector) {

            var defaultAttr = defaultAttrs[selector];

            _.each(attr, function(value, name) {

                // attr is mainly flat though it might have one more level (consider the `style` attribute).
                // Check if the `value` is object and if yes, go one level deep.
                if (_.isObject(value) && !_.isArray(value)) {

                    _.each(value, function(value2, name2) {

                        if (!defaultAttr || !defaultAttr[name] || !_.isEqual(defaultAttr[name][name2], value2)) {

                            finalAttrs[selector] = finalAttrs[selector] || {};
                            (finalAttrs[selector][name] || (finalAttrs[selector][name] = {}))[name2] = value2;
                        }
                    });

                } else if (!defaultAttr || !_.isEqual(defaultAttr[name], value)) {
                    // `value` is not an object, default attribute for such a selector does not exist
                    // or it is different than the attribute value set on the model.

                    finalAttrs[selector] = finalAttrs[selector] || {};
                    finalAttrs[selector][name] = value;
                }
            });
        });

        var attributes = _.cloneDeep(_.omit(this.attributes, 'attrs'));
        //var attributes = JSON.parse(JSON.stringify(_.omit(this.attributes, 'attrs')));
        attributes.attrs = finalAttrs;

        return attributes;
    },

    initialize: function(options) {

        if (!options || !options.id) {

            this.set('id', joint.util.uuid(), { silent: true });
        }

        this._transitionIds = {};

        // Collect ports defined in `attrs` and keep collecting whenever `attrs` object changes.
        this.processPorts();
        this.on('change:attrs', this.processPorts, this);
    },

    /**
     * @deprecated
     */
    processPorts: function() {

        // Whenever `attrs` changes, we extract ports from the `attrs` object and store it
        // in a more accessible way. Also, if any port got removed and there were links that had `target`/`source`
        // set to that port, we remove those links as well (to follow the same behaviour as
        // with a removed element).

        var previousPorts = this.ports;

        // Collect ports from the `attrs` object.
        var ports = {};
        _.each(this.get('attrs'), function(attrs, selector) {

            if (attrs && attrs.port) {

                // `port` can either be directly an `id` or an object containing an `id` (and potentially other data).
                if (!_.isUndefined(attrs.port.id)) {
                    ports[attrs.port.id] = attrs.port;
                } else {
                    ports[attrs.port] = { id: attrs.port };
                }
            }
        });

        // Collect ports that have been removed (compared to the previous ports) - if any.
        // Use hash table for quick lookup.
        var removedPorts = {};
        _.each(previousPorts, function(port, id) {

            if (!ports[id]) removedPorts[id] = true;
        });

        // Remove all the incoming/outgoing links that have source/target port set to any of the removed ports.
        if (this.graph && !_.isEmpty(removedPorts)) {

            var inboundLinks = this.graph.getConnectedLinks(this, { inbound: true });
            _.each(inboundLinks, function(link) {

                if (removedPorts[link.get('target').port]) link.remove();
            });

            var outboundLinks = this.graph.getConnectedLinks(this, { outbound: true });
            _.each(outboundLinks, function(link) {

                if (removedPorts[link.get('source').port]) link.remove();
            });
        }

        // Update the `ports` object.
        this.ports = ports;
    },

    remove: function(opt) {

        opt = opt || {};

        // Store the graph in a variable because `this.graph` won't' be accessbile after `this.trigger('remove', ...)` down below.
        var graph = this.graph;
        if (graph) {
            graph.startBatch('remove');
        }

        // First, unembed this cell from its parent cell if there is one.
        var parentCellId = this.get('parent');
        if (parentCellId) {

            var parentCell = graph && graph.getCell(parentCellId);
            parentCell.unembed(this);
        }

        _.invoke(this.getEmbeddedCells(), 'remove', opt);

        this.trigger('remove', this, this.collection, opt);

        if (graph) {
            graph.stopBatch('remove');
        }

        return this;
    },

    toFront: function(opt) {

        if (this.graph) {

            opt = opt || {};

            var z = (this.graph.getLastCell().get('z') || 0) + 1;

            this.startBatch('to-front').set('z', z, opt);

            if (opt.deep) {

                var cells = this.getEmbeddedCells({ deep: true, breadthFirst: true });
                _.each(cells, function(cell) { cell.set('z', ++z, opt); });

            }

            this.stopBatch('to-front');
        }

        return this;
    },

    toBack: function(opt) {

        if (this.graph) {

            opt = opt || {};

            var z = (this.graph.getFirstCell().get('z') || 0) - 1;

            this.startBatch('to-back');

            if (opt.deep) {

                var cells = this.getEmbeddedCells({ deep: true, breadthFirst: true });
                _.eachRight(cells, function(cell) { cell.set('z', z--, opt); });
            }

            this.set('z', z, opt).stopBatch('to-back');
        }

        return this;
    },

    embed: function(cell, opt) {

        if (this === cell || this.isEmbeddedIn(cell)) {

            throw new Error('Recursive embedding not allowed.');

        } else {

            this.startBatch('embed');

            var embeds = _.clone(this.get('embeds') || []);

            // We keep all element ids after link ids.
            embeds[cell.isLink() ? 'unshift' : 'push'](cell.id);

            cell.set('parent', this.id, opt);
            this.set('embeds', _.uniq(embeds), opt);

            this.stopBatch('embed');
        }

        return this;
    },

    unembed: function(cell, opt) {

        this.startBatch('unembed');

        cell.unset('parent', opt);
        this.set('embeds', _.without(this.get('embeds'), cell.id), opt);

        this.stopBatch('unembed');

        return this;
    },

    // Return an array of ancestor cells.
    // The array is ordered from the parent of the cell
    // to the most distant ancestor.
    getAncestors: function() {

        var ancestors = [];
        var parentId = this.get('parent');

        if (!this.graph) {
            return ancestors;
        }

        while (parentId !== undefined) {
            var parent = this.graph.getCell(parentId);
            if (parent !== undefined) {
                ancestors.push(parent);
                parentId = parent.get('parent');
            } else {
                break;
            }
        }

        return ancestors;
    },

    getEmbeddedCells: function(opt) {

        opt = opt || {};

        // Cell models can only be retrieved when this element is part of a collection.
        // There is no way this element knows about other cells otherwise.
        // This also means that calling e.g. `translate()` on an element with embeds before
        // adding it to a graph does not translate its embeds.
        if (this.graph) {

            var cells;

            if (opt.deep) {

                if (opt.breadthFirst) {

                    // breadthFirst algorithm
                    cells = [];
                    var queue = this.getEmbeddedCells();

                    while (queue.length > 0) {

                        var parent = queue.shift();
                        cells.push(parent);
                        queue.push.apply(queue, parent.getEmbeddedCells());
                    }

                } else {

                    // depthFirst algorithm
                    cells = this.getEmbeddedCells();
                    _.each(cells, function(cell) {
                        cells.push.apply(cells, cell.getEmbeddedCells(opt));
                    });
                }

            } else {

                cells = _.map(this.get('embeds'), this.graph.getCell, this.graph);
            }

            return cells;
        }
        return [];
    },

    isEmbeddedIn: function(cell, opt) {

        var cellId = _.isString(cell) ? cell : cell.id;
        var parentId = this.get('parent');

        opt = _.defaults({ deep: true }, opt);

        // See getEmbeddedCells().
        if (this.graph && opt.deep) {

            while (parentId) {
                if (parentId === cellId) {
                    return true;
                }
                parentId = this.graph.getCell(parentId).get('parent');
            }

            return false;

        } else {

            // When this cell is not part of a collection check
            // at least whether it's a direct child of given cell.
            return parentId === cellId;
        }
    },

    // Whether or not the cell is embedded in any other cell.
    isEmbedded: function() {

        return !!this.get('parent');
    },

    // Isolated cloning. Isolated cloning has two versions: shallow and deep (pass `{ deep: true }` in `opt`).
    // Shallow cloning simply clones the cell and returns a new cell with different ID.
    // Deep cloning clones the cell and all its embedded cells recursively.
    clone: function(opt) {

        opt = opt || {};

        if (!opt.deep) {
            // Shallow cloning.

            var clone = Backbone.Model.prototype.clone.apply(this, arguments);
            // We don't want the clone to have the same ID as the original.
            clone.set('id', joint.util.uuid());
            // A shallow cloned element does not carry over the original embeds.
            clone.unset('embeds');
            // And can not be embedded in any cell
            // as the clone is not part of the graph.
            clone.unset('parent');

            return clone;

        } else {
            // Deep cloning.

            // For a deep clone, simply call `graph.cloneCells()` with the cell and all its embedded cells.
            return _.values(joint.dia.Graph.prototype.cloneCells.call(null, [this].concat(this.getEmbeddedCells({ deep: true }))));
        }
    },

    // A convenient way to set nested properties.
    // This method merges the properties you'd like to set with the ones
    // stored in the cell and makes sure change events are properly triggered.
    // You can either set a nested property with one object
    // or use a property path.
    // The most simple use case is:
    // `cell.prop('name/first', 'John')` or
    // `cell.prop({ name: { first: 'John' } })`.
    // Nested arrays are supported too:
    // `cell.prop('series/0/data/0/degree', 50)` or
    // `cell.prop({ series: [ { data: [ { degree: 50 } ] } ] })`.
    prop: function(props, value, opt) {

        var delim = '/';
        var isString = _.isString(props);

        if (isString || _.isArray(props)) {
            // Get/set an attribute by a special path syntax that delimits
            // nested objects by the colon character.

            if (arguments.length > 1) {

                var path;
                var pathArray;

                if (isString) {
                    path = props;
                    pathArray = path.split('/')
                } else {
                    path = props.join(delim);
                    pathArray = props.slice();
                }

                var property = pathArray[0];
                var pathArrayLength = pathArray.length;

                opt = opt || {};
                opt.propertyPath = path;
                opt.propertyValue = value;
                opt.propertyPathArray = pathArray;

                if (pathArrayLength === 1) {
                    // Property is not nested. We can simply use `set()`.
                    return this.set(property, value, opt);
                }

                var update = {};
                // Initialize the nested object. Subobjects are either arrays or objects.
                // An empty array is created if the sub-key is an integer. Otherwise, an empty object is created.
                // Note that this imposes a limitation on object keys one can use with Inspector.
                // Pure integer keys will cause issues and are therefore not allowed.
                var initializer = update;
                var prevProperty = property;

                for (var i = 1; i < pathArrayLength; i++) {
                    var pathItem = pathArray[i];
                    var isArrayIndex = _.isFinite(isString ? Number(pathItem) : pathItem);
                    initializer = initializer[prevProperty] = isArrayIndex ? [] : {};
                    prevProperty = pathItem;
                }

                // Fill update with the `value` on `path`.
                update = joint.util.setByPath(update, pathArray, value, '/');

                var baseAttributes = _.merge({}, this.attributes);
                // if rewrite mode enabled, we replace value referenced by path with
                // the new one (we don't merge).
                opt.rewrite && joint.util.unsetByPath(baseAttributes, path, '/');

                // Merge update with the model attributes.
                var attributes = _.merge(baseAttributes, update);
                // Finally, set the property to the updated attributes.
                return this.set(property, attributes[property], opt);

            } else {

                return joint.util.getByPath(this.attributes, props, delim);
            }
        }

        return this.set(_.merge({}, this.attributes, props), value);
    },

    // A convient way to unset nested properties
    removeProp: function(path, opt) {

        // Once a property is removed from the `attrs` attribute
        // the cellView will recognize a `dirty` flag and rerender itself
        // in order to remove the attribute from SVG element.
        opt = opt || {};
        opt.dirty = true;

        var pathArray = _.isArray(path) ? path : path.split('/');

        if (pathArray.length === 1) {
            // A top level property
            return this.unset(path, opt);
        }

        // A nested property
        var property = pathArray[0];
        var nestedPath = pathArray.slice(1);
        var propertyValue = _.merge({}, this.get(property));

        joint.util.unsetByPath(propertyValue, nestedPath, '/');

        return this.set(property, propertyValue, opt);
    },

    // A convenient way to set nested attributes.
    attr: function(attrs, value, opt) {

        var args = Array.prototype.slice.call(arguments);
        if (args.length === 0) {
            return this.get('attrs');
        }

        if (_.isArray(attrs)) {
            args[0] = ['attrs'].concat(attrs);
        } else if (_.isString(attrs)) {
            // Get/set an attribute by a special path syntax that delimits
            // nested objects by the colon character.
            args[0] = 'attrs/' + attrs;

        } else {

            args[0] = { 'attrs' : attrs };
        }

        return this.prop.apply(this, args);
    },

    // A convenient way to unset nested attributes
    removeAttr: function(path, opt) {

        if (_.isArray(path)) {

            return this.removeProp(['attrs'].concat(path));
        }

        return this.removeProp('attrs/' + path, opt);
    },

    transition: function(path, value, opt, delim) {

        delim = delim || '/';

        var defaults = {
            duration: 100,
            delay: 10,
            timingFunction: joint.util.timing.linear,
            valueFunction: joint.util.interpolate.number
        };

        opt = _.extend(defaults, opt);

        var firstFrameTime = 0;
        var interpolatingFunction;

        var setter = _.bind(function(runtime) {

            var id, progress, propertyValue;

            firstFrameTime = firstFrameTime || runtime;
            runtime -= firstFrameTime;
            progress = runtime / opt.duration;

            if (progress < 1) {
                this._transitionIds[path] = id = joint.util.nextFrame(setter);
            } else {
                progress = 1;
                delete this._transitionIds[path];
            }

            propertyValue = interpolatingFunction(opt.timingFunction(progress));

            opt.transitionId = id;

            this.prop(path, propertyValue, opt);

            if (!id) this.trigger('transition:end', this, path);

        }, this);

        var initiator = _.bind(function(callback) {

            this.stopTransitions(path);

            interpolatingFunction = opt.valueFunction(joint.util.getByPath(this.attributes, path, delim), value);

            this._transitionIds[path] = joint.util.nextFrame(callback);

            this.trigger('transition:start', this, path);

        }, this);

        return _.delay(initiator, opt.delay, setter);
    },

    getTransitions: function() {
        return _.keys(this._transitionIds);
    },

    stopTransitions: function(path, delim) {

        delim = delim || '/';

        var pathArray = path && path.split(delim);

        _(this._transitionIds).keys().filter(pathArray && function(key) {

            return _.isEqual(pathArray, key.split(delim).slice(0, pathArray.length));

        }).each(function(key) {

            joint.util.cancelFrame(this._transitionIds[key]);

            delete this._transitionIds[key];

            this.trigger('transition:end', this, key);

        }, this);

        return this;
    },

    // A shorcut making it easy to create constructs like the following:
    // `var el = (new joint.shapes.basic.Rect).addTo(graph)`.
    addTo: function(graph, opt) {

        graph.addCell(this, opt);
        return this;
    },

    // A shortcut for an equivalent call: `paper.findViewByModel(cell)`
    // making it easy to create constructs like the following:
    // `cell.findView(paper).highlight()`
    findView: function(paper) {

        return paper.findViewByModel(this);
    },

    isElement: function() {

        return false;
    },

    isLink: function() {

        return false;
    },

    startBatch: function(name, opt) {
        if (this.graph) { this.graph.startBatch(name, _.extend({}, opt, { cell: this })); }
        return this;
    },

    stopBatch: function(name, opt) {
        if (this.graph) { this.graph.stopBatch(name, _.extend({}, opt, { cell: this })); }
        return this;
    }

}, {

    getAttributeDefinition: function(attrName) {

        var defNS = this.attributes;
        var globalDefNS = joint.dia.attributes;
        return (defNS && defNS[attrName]) || globalDefNS[attrName];
    },

    define: function(type, defaults, protoProps, staticProps) {

        protoProps = _.assign({
            defaults: _.defaultsDeep({ type: type }, defaults, this.prototype.defaults)
        }, protoProps);

        var Cell = this.extend(protoProps, staticProps);
        joint.util.setByPath(joint.shapes, type, Cell, '.');
        return Cell;
    }
});

// joint.dia.CellView base view and controller.
// --------------------------------------------

// This is the base view and controller for `joint.dia.ElementView` and `joint.dia.LinkView`.

joint.dia.CellView = joint.mvc.View.extend({

    tagName: 'g',

    svgElement: true,

    className: function() {

        var classNames = ['cell'];
        var type = this.model.get('type');

        if (type) {

            _.each(type.toLowerCase().split('.'), function(value, index, list) {
                classNames.push('type-' + list.slice(0, index + 1).join('-'));
            });
        }

        return classNames.join(' ');
    },

    attributes: function() {

        return { 'model-id': this.model.id };
    },

    constructor: function(options) {

        // Make sure a global unique id is assigned to this view. Store this id also to the properties object.
        // The global unique id makes sure that the same view can be rendered on e.g. different machines and
        // still be associated to the same object among all those clients. This is necessary for real-time
        // collaboration mechanism.
        options.id = options.id || joint.util.guid(this);

        joint.mvc.View.call(this, options);
    },

    init: function() {

        _.bindAll(this, 'remove', 'update');

        // Store reference to this to the <g> DOM element so that the view is accessible through the DOM tree.
        this.$el.data('view', this);

        // Add the cell's type to the view's element as a data attribute.
        this.$el.attr('data-type', this.model.get('type'));

        this.listenTo(this.model, 'change:attrs', this.onChangeAttrs);
    },

    onChangeAttrs: function(cell, attrs, opt) {

        if (opt.dirty) {

            // dirty flag could be set when a model attribute was removed and it needs to be cleared
            // also from the DOM element. See cell.removeAttr().
            return this.render();
        }

        return this.update(cell, attrs, opt);
    },

    // Return `true` if cell link is allowed to perform a certain UI `feature`.
    // Example: `can('vertexMove')`, `can('labelMove')`.
    can: function(feature) {

        var interactive = _.isFunction(this.options.interactive)
                            ? this.options.interactive(this)
                            : this.options.interactive;

        return (_.isObject(interactive) && interactive[feature] !== false) ||
                (_.isBoolean(interactive) && interactive !== false);
    },

    findBySelector: function(selector, root) {

        var $root = $(root || this.el);
        // These are either descendants of `this.$el` of `this.$el` itself.
        // `.` is a special selector used to select the wrapping `<g>` element.
        return (selector === '.') ? $root : $root.find(selector);
    },

    notify: function(eventName) {

        if (this.paper) {

            var args = Array.prototype.slice.call(arguments, 1);

            // Trigger the event on both the element itself and also on the paper.
            this.trigger.apply(this, [eventName].concat(args));

            // Paper event handlers receive the view object as the first argument.
            this.paper.trigger.apply(this.paper, [eventName, this].concat(args));
        }
    },

    getStrokeBBox: function(el) {
        // Return a bounding box rectangle that takes into account stroke.
        // Note that this is a naive and ad-hoc implementation that does not
        // works only in certain cases and should be replaced as soon as browsers will
        // start supporting the getStrokeBBox() SVG method.
        // @TODO any better solution is very welcome!

        var isMagnet = !!el;

        el = el || this.el;
        var bbox = V(el).bbox(false, this.paper.viewport);

        var strokeWidth;
        if (isMagnet) {

            strokeWidth = V(el).attr('stroke-width');

        } else {

            strokeWidth = this.model.attr('rect/stroke-width') || this.model.attr('circle/stroke-width') || this.model.attr('ellipse/stroke-width') || this.model.attr('path/stroke-width');
        }

        strokeWidth = parseFloat(strokeWidth) || 0;

        return g.rect(bbox).moveAndExpand({ x: -strokeWidth / 2, y: -strokeWidth / 2, width: strokeWidth, height: strokeWidth });
    },

    getBBox: function() {

        return g.rect(this.vel.bbox());
    },

    highlight: function(el, opt) {

        el = !el ? this.el : this.$(el)[0] || this.el;

        // set partial flag if the highlighted element is not the entire view.
        opt = opt || {};
        opt.partial = (el !== this.el);

        this.notify('cell:highlight', el, opt);
        return this;
    },

    unhighlight: function(el, opt) {

        el = !el ? this.el : this.$(el)[0] || this.el;

        opt = opt || {};
        opt.partial = el != this.el;

        this.notify('cell:unhighlight', el, opt);
        return this;
    },

    // Find the closest element that has the `magnet` attribute set to `true`. If there was not such
    // an element found, return the root element of the cell view.
    findMagnet: function(el) {

        var $el = this.$(el);
        var $rootEl = this.$el;

        if ($el.length === 0) {
            $el = $rootEl;
        }

        do {

            var magnet = $el.attr('magnet');
            if ((magnet || $el.is($rootEl)) && magnet !== 'false') {
                return $el[0];
            }

            $el = $el.parent();

        } while ($el.length > 0);

        // If the overall cell has set `magnet === false`, then return `undefined` to
        // announce there is no magnet found for this cell.
        // This is especially useful to set on cells that have 'ports'. In this case,
        // only the ports have set `magnet === true` and the overall element has `magnet === false`.
        return undefined;
    },

    // Construct a unique selector for the `el` element within this view.
    // `prevSelector` is being collected through the recursive call.
    // No value for `prevSelector` is expected when using this method.
    getSelector: function(el, prevSelector) {

        if (el === this.el) {
            return prevSelector;
        }

        var selector;

        if (el) {

            var nthChild = V(el).index() + 1;
            selector = el.tagName + ':nth-child(' + nthChild + ')';

            if (prevSelector) {
                selector += ' > ' + prevSelector;
            }

            selector = this.getSelector(el.parentNode, selector);
        }

        return selector;
    },

    getAttributeDefinition: function(attrName) {

        return this.model.constructor.getAttributeDefinition(attrName);
    },

    setNodeAttributes: function(node, attrs) {

        if (!_.isEmpty(attrs)) {
            if (node instanceof SVGElement) {
                V(node).attr(attrs);
            } else {
                $(node).attr(attrs);
            }
        }
    },

    processNodeAttributes: function(node, attrs) {

        var attrName, attrVal, def, i, n;
        var normalAttrs, setAttrs, positionAttrs, offsetAttrs;
        var relatives = [];
        // divide the attributes between normal and special
        for (attrName in attrs) {
            if (!attrs.hasOwnProperty(attrName)) continue;
            attrVal = attrs[attrName];
            def = this.getAttributeDefinition(attrName);
            if (def && (!_.isFunction(def.qualify) || def.qualify.call(this, attrVal, node, attrs))) {
                if (_.isString(def.set)) {
                    normalAttrs || (normalAttrs = {});
                    normalAttrs[def.set] = attrVal;
                }
                if (attrVal !== null) {
                    relatives.push(attrName, def);
                }
            } else {
                normalAttrs || (normalAttrs = {});
                normalAttrs[joint.util.toKebabCase(attrName)] = attrVal;
            }
        }

        // handle the rest of attributes via related method
        // from the special attributes namespace.
        for (i = 0, n = relatives.length; i < n; i+=2) {
            attrName = relatives[i];
            def = relatives[i+1];
            attrVal = attrs[attrName];
            if (_.isFunction(def.set)) {
                setAttrs || (setAttrs = {});
                setAttrs[attrName] = attrVal;
            }
            if (_.isFunction(def.position)) {
                positionAttrs || (positionAttrs = {});
                positionAttrs[attrName] = attrVal;
            }
            if (_.isFunction(def.offset)) {
                offsetAttrs || (offsetAttrs = {});
                offsetAttrs[attrName] = attrVal;
            }
        }

        return {
            raw: attrs,
            normal: normalAttrs,
            set: setAttrs,
            position: positionAttrs,
            offset: offsetAttrs
        };
    },

    updateRelativeAttributes: function(node, attrs, refBBox, opt) {

        opt || (opt = {});

        var attrName, attrVal, def;
        var rawAttrs = attrs.raw || {};
        var nodeAttrs = attrs.normal || {};
        var setAttrs = attrs.set;
        var positionAttrs = attrs.position;
        var offsetAttrs = attrs.offset;

        for (attrName in setAttrs) {
            attrVal = setAttrs[attrName];
            def = this.getAttributeDefinition(attrName);
            // SET - set function should return attributes to be set on the node,
            // which will affect the node dimensions based on the reference bounding
            // box. e.g. `width`, `height`, `d`, `rx`, `ry`, `points
            var setResult = def.set.call(this, attrVal, refBBox.clone(), node, rawAttrs);
            if (_.isObject(setResult)) {
                _.extend(nodeAttrs, setResult);
            } else if (setResult !== undefined) {
                nodeAttrs[attrName] = setResult;
            }
        }

        if (node instanceof HTMLElement) {
            // TODO: setting the `transform` attribute on HTMLElements
            // via `node.style.transform = 'matrix(...)';` would introduce
            // a breaking change (e.g. basic.TextBlock).
            this.setNodeAttributes(node, nodeAttrs);
            return;
        }

        // The final translation of the subelement.
        var nodeTransform = nodeAttrs.transform || '';
        var nodeMatrix = V.transformStringToMatrix(nodeTransform);
        var nodePosition = g.Point(nodeMatrix.e, nodeMatrix.f);
        if (nodeTransform) {
            nodeAttrs = _.omit(nodeAttrs, 'transform');
            nodeMatrix.e = nodeMatrix.f = 0;
        }

        // Calculate node scale determined by the scalable group
        // only if later needed.
        var sx, sy, translation;
        if (positionAttrs || offsetAttrs) {
            var nodeScale = this.getNodeScale(node, opt.scalableNode);
            sx = nodeScale.sx;
            sy = nodeScale.sy;
        }

        for (attrName in positionAttrs) {
            attrVal = positionAttrs[attrName];
            def = this.getAttributeDefinition(attrName);
            // POSITION - position function should return a point from the
            // reference bounding box. The default position of the node is x:0, y:0 of
            // the reference bounding box or could be further specify by some
            // SVG attributes e.g. `x`, `y`
            translation = def.position.call(this, attrVal, refBBox.clone(), node, rawAttrs);
            if (translation) {
                nodePosition.offset(g.Point(translation).scale(sx, sy));
            }
        }

        // The node bounding box could depend on the `size` set from the previous loop.
        // Here we know, that all the size attributes have been already set.
        this.setNodeAttributes(node, nodeAttrs);

        if (offsetAttrs) {
            // Check if the node is visible
            var nodeClientRect = node.getBoundingClientRect();
            if (nodeClientRect.width > 0 && nodeClientRect.height > 0) {
                var nodeBBox = V.transformRect(node.getBBox(), nodeMatrix).scale(1 / sx, 1 / sy);
                for (attrName in offsetAttrs) {
                    attrVal = offsetAttrs[attrName];
                    def = this.getAttributeDefinition(attrName);
                    // OFFSET - offset function should return a point from the element
                    // bounding box. The default offset point is x:0, y:0 (origin) or could be further
                    // specify with some SVG attributes e.g. `text-anchor`, `cx`, `cy`
                    translation = def.offset.call(this, attrVal, nodeBBox, node, rawAttrs);
                    if (translation) {
                        nodePosition.offset(g.Point(translation).scale(sx, sy));
                    }
                }
            }
        }

        // Round the coordinates to 1 decimal point.
        nodePosition.round(1);
        nodeMatrix.e = nodePosition.x;
        nodeMatrix.f = nodePosition.y;
        node.setAttribute('transform', V.matrixToTransformString(nodeMatrix));
    },

    getNodeScale: function(node, scalableNode) {

        // Check if the node is a descendant of the scalable group.
        var sx, sy;
        if (scalableNode && scalableNode.contains(node)) {
            var scale = scalableNode.scale();
            sx = 1 / scale.sx;
            sy = 1 / scale.sy;
        } else {
            sx = 1;
            sy = 1;
        }

        return { sx: sx, sy: sy };
    },

    findNodesAttributes: function(attrs, root, selectorCache) {

        // TODO: merge attributes in order defined by `index` property

        var nodesAttrs = {};

        for (var selector in attrs) {
            if (!attrs.hasOwnProperty(selector)) continue;
            var $selected = selectorCache[selector] = this.findBySelector(selector, root);

            for (var i = 0, n = $selected.length; i < n; i++) {
                var node = $selected[i];
                var nodeId = V.ensureId(node);
                var nodeAttrs = attrs[selector];
                var prevNodeAttrs = nodesAttrs[nodeId];
                if (prevNodeAttrs) {
                    if (!prevNodeAttrs.merged) {
                        prevNodeAttrs.merged = true;
                        prevNodeAttrs.attributes = _.cloneDeep(prevNodeAttrs.attributes);
                    }
                    _.merge(prevNodeAttrs.attributes, nodeAttrs);
                } else {
                    nodesAttrs[nodeId] = {
                        attributes: nodeAttrs,
                        node: node,
                        merged: false
                    };
                }
            }
        }

        return nodesAttrs;
    },

    // Default is to process the `model.attributes.attrs` object and set attributes on subelements based on the selectors,
    // unless `attrs` parameter was passed.
    updateDOMSubtreeAttributes: function(rootNode, attrs, opt) {

        opt || (opt = {});
        opt.rootBBox || (opt.rootBBox = g.Rect());

        // Cache table for query results and bounding box calculation.
        // Note that `selectorCache` needs to be invalidated for all
        // `updateAttributes` calls, as the selectors might pointing
        // to nodes designated by an attribute or elements dynamically
        // created.
        var selectorCache = {};
        var bboxCache = {};
        var relativeItems = [];
        var item, node, nodeAttrs, nodeData, processedAttrs;

        var roAttrs = opt.roAttributes;
        var nodesAttrs = this.findNodesAttributes(roAttrs || attrs, rootNode, selectorCache);
        // `nodesAttrs` are different from all attributes, when
        // rendering only  attributes sent to this method.
        var nodesAllAttrs = (roAttrs)
            ? nodesAllAttrs = this.findNodesAttributes(attrs, rootNode, selectorCache)
            : nodesAttrs;

        for (var nodeId in nodesAttrs) {
            nodeData = nodesAttrs[nodeId];
            nodeAttrs = nodeData.attributes;
            node = nodeData.node;
            processedAttrs = this.processNodeAttributes(node, nodeAttrs);

            if (!processedAttrs.set && !processedAttrs.position && !processedAttrs.offset) {
                // Set all the normal attributes right on the SVG/HTML element.
                this.setNodeAttributes(node, processedAttrs.normal);

            } else {

                var nodeAllAttrs = nodesAllAttrs[nodeId] && nodesAllAttrs[nodeId].attributes;
                var refSelector = (nodeAllAttrs && (nodeAttrs.ref === undefined))
                    ? nodeAllAttrs.ref
                    : nodeAttrs.ref;

                var refNode;
                if (refSelector) {
                    refNode = (selectorCache[refSelector] || this.findBySelector(refSelector, rootNode))[0];
                    if (!refNode) {
                        throw new Error('dia.ElementView: "' + refSelector + '" reference does not exists.');
                    }
                } else {
                    refNode = null;
                }

                item = {
                    node: node,
                    refNode: refNode,
                    processedAttributes: processedAttrs,
                    allAttributes: nodeAllAttrs
                };

                // If an element in the list is positioned relative to this one, then
                // we want to insert this one before it in the list.
                var itemIndex = _.findIndex(relativeItems, { refNode: node });
                if (itemIndex > -1) {
                    relativeItems.splice(itemIndex, 0, item);
                } else {
                    relativeItems.push(item);
                }
            }
        }

        for (var i = 0, n = relativeItems.length; i < n; i++) {
            item = relativeItems[i];
            node = item.node;
            refNode = item.refNode;

            // Find the reference element bounding box. If no reference was provided, we
            // use the optional bounding box.
            var refNodeId = refNode ? V.ensureId(refNode) : '';
            var refBBox = bboxCache[refNodeId];
            if (!refBBox) {
                // Get the bounding box of the reference element relative to the `rotatable` `<g>` (without rotation)
                // or to the root `<g>` element if no rotatable group present if reference node present.
                // Uses the bounding box provided.
                refBBox = bboxCache[refNodeId] = (refNode)
                    ? V(refNode).bbox(false, (opt.rotatableNode || rootNode))
                    : opt.rootBBox;
            }

            if (roAttrs) {
                // if there was a special attribute affecting the position amongst passed-in attributes
                // we have to merge it with the rest of the element's attributes as they are necessary
                // to update the position relatively (i.e `ref-x` && 'ref-dx')
                processedAttrs = this.processNodeAttributes(node, item.allAttributes);
                this.mergeProcessedAttributes(processedAttrs, item.processedAttributes);

            } else {
                processedAttrs = item.processedAttributes;
            }

            this.updateRelativeAttributes(node, processedAttrs, refBBox, opt);
        }
    },

    mergeProcessedAttributes: function(processedAttrs, roProcessedAttrs) {

        processedAttrs.set || (processedAttrs.set = {});
        processedAttrs.position || (processedAttrs.position = {});
        processedAttrs.offset || (processedAttrs.offset = {});

        _.extend(processedAttrs.set, roProcessedAttrs.set);
        _.extend(processedAttrs.position, roProcessedAttrs.position);
        _.extend(processedAttrs.offset, roProcessedAttrs.offset);

        // Handle also the special transform property.
        var transform = processedAttrs.normal && processedAttrs.normal.transform;
        if (transform !== undefined && roProcessedAttrs.normal) {
            roProcessedAttrs.normal.transform = transform;
        }
        processedAttrs.normal = roProcessedAttrs.normal;
    },

    // Interaction. The controller part.
    // ---------------------------------

    // Interaction is handled by the paper and delegated to the view in interest.
    // `x` & `y` parameters passed to these functions represent the coordinates already snapped to the paper grid.
    // If necessary, real coordinates can be obtained from the `evt` event object.

    // These functions are supposed to be overriden by the views that inherit from `joint.dia.Cell`,
    // i.e. `joint.dia.Element` and `joint.dia.Link`.

    pointerdblclick: function(evt, x, y) {

        this.notify('cell:pointerdblclick', evt, x, y);
    },

    pointerclick: function(evt, x, y) {

        this.notify('cell:pointerclick', evt, x, y);
    },

    pointerdown: function(evt, x, y) {

        if (this.model.graph) {
            this.model.startBatch('pointer');
            this._graph = this.model.graph;
        }

        this.notify('cell:pointerdown', evt, x, y);
    },

    pointermove: function(evt, x, y) {

        this.notify('cell:pointermove', evt, x, y);
    },

    pointerup: function(evt, x, y) {

        this.notify('cell:pointerup', evt, x, y);

        if (this._graph) {
            // we don't want to trigger event on model as model doesn't
            // need to be member of collection anymore (remove)
            this._graph.stopBatch('pointer', { cell: this.model });
            delete this._graph;
        }
    },

    mouseover: function(evt) {

        this.notify('cell:mouseover', evt);
    },

    mouseout: function(evt) {

        this.notify('cell:mouseout', evt);
    },

    mouseenter: function(evt) {

        this.notify('cell:mouseenter', evt);
    },

    mouseleave: function(evt) {

        this.notify('cell:mouseleave', evt);
    },

    mousewheel: function(evt, x, y, delta) {

        this.notify('cell:mousewheel', evt, x, y, delta);
    },

    contextmenu: function(evt, x, y) {

        this.notify('cell:contextmenu', evt, x, y);
    },

    setInteractivity: function(value) {

        this.options.interactive = value;
    }
});

// joint.dia.Element base model.
// -----------------------------

joint.dia.Element = joint.dia.Cell.extend({

    defaults: {
        position: { x: 0, y: 0 },
        size: { width: 1, height: 1 },
        angle: 0
    },

    initialize: function() {

        this._initializePorts();
        joint.dia.Cell.prototype.initialize.apply(this, arguments);
    },

    /**
     * @abstract
     */
    _initializePorts: function() {
        // implemented in ports.js
    },

    isElement: function() {

        return true;
    },

    position: function(x, y, opt) {

        var isSetter = _.isNumber(y);

        opt = (isSetter ? opt : x) || {};

        // option `parentRelative` for setting the position relative to the element's parent.
        if (opt.parentRelative) {

            // Getting the parent's position requires the collection.
            // Cell.get('parent') helds cell id only.
            if (!this.graph) throw new Error('Element must be part of a graph.');

            var parent = this.graph.getCell(this.get('parent'));
            var parentPosition = parent && !parent.isLink()
                ? parent.get('position')
                : { x: 0, y: 0 };
        }

        if (isSetter) {

            if (opt.parentRelative) {
                x += parentPosition.x;
                y += parentPosition.y;
            }

            return this.set('position', { x: x, y: y }, opt);

        } else { // Getter returns a geometry point.

            var elementPosition = g.point(this.get('position'));

            return opt.parentRelative
                ? elementPosition.difference(parentPosition)
                : elementPosition;
        }
    },

    translate: function(tx, ty, opt) {

        tx = tx || 0;
        ty = ty || 0;

        if (tx === 0 && ty === 0) {
            // Like nothing has happened.
            return this;
        }

        opt = opt || {};
        // Pass the initiator of the translation.
        opt.translateBy = opt.translateBy || this.id;

        var position = this.get('position') || { x: 0, y: 0 };

        if (opt.restrictedArea && opt.translateBy === this.id) {

            // We are restricting the translation for the element itself only. We get
            // the bounding box of the element including all its embeds.
            // All embeds have to be translated the exact same way as the element.
            var bbox = this.getBBox({ deep: true });
            var ra = opt.restrictedArea;
            //- - - - - - - - - - - - -> ra.x + ra.width
            // - - - -> position.x      |
            // -> bbox.x
            //                ▓▓▓▓▓▓▓   |
            //         ░░░░░░░▓▓▓▓▓▓▓
            //         ░░░░░░░░░        |
            //   ▓▓▓▓▓▓▓▓░░░░░░░
            //   ▓▓▓▓▓▓▓▓               |
            //   <-dx->                     | restricted area right border
            //         <-width->        |   ░ translated element
            //   <- - bbox.width - ->       ▓ embedded element
            var dx = position.x - bbox.x;
            var dy = position.y - bbox.y;
            // Find the maximal/minimal coordinates that the element can be translated
            // while complies the restrictions.
            var x = Math.max(ra.x + dx, Math.min(ra.x + ra.width + dx - bbox.width, position.x + tx));
            var y = Math.max(ra.y + dy, Math.min(ra.y + ra.height + dy - bbox.height, position.y + ty));
            // recalculate the translation taking the resctrictions into account.
            tx = x - position.x;
            ty = y - position.y;
        }

        var translatedPosition = {
            x: position.x + tx,
            y: position.y + ty
        };

        // To find out by how much an element was translated in event 'change:position' handlers.
        opt.tx = tx;
        opt.ty = ty;

        if (opt.transition) {

            if (!_.isObject(opt.transition)) opt.transition = {};

            this.transition('position', translatedPosition, _.extend({}, opt.transition, {
                valueFunction: joint.util.interpolate.object
            }));

        } else {

            this.set('position', translatedPosition, opt);
        }

        // Recursively call `translate()` on all the embeds cells.
        _.invoke(this.getEmbeddedCells(), 'translate', tx, ty, opt);

        return this;
    },

    size: function(width, height, opt) {

        var currentSize = this.get('size');
        // Getter
        // () signature
        if (width === undefined) {
            return {
                width: currentSize.width,
                height: currentSize.height
            };
        }
        // Setter
        // (size, opt) signature
        if (_.isObject(width)) {
            opt = height;
            height = _.isNumber(width.height) ? width.height : currentSize.height;
            width = _.isNumber(width.width) ? width.width : currentSize.width;
        }

        return this.resize(width, height, opt);
    },

    resize: function(width, height, opt) {

        opt = opt || {};

        this.startBatch('resize', opt);

        if (opt.direction) {

            var currentSize = this.get('size');

            switch (opt.direction) {

                case 'left':
                case 'right':
                    // Don't change height when resizing horizontally.
                    height = currentSize.height;
                    break;

                case 'top':
                case 'bottom':
                    // Don't change width when resizing vertically.
                    width = currentSize.width;
                    break;
            }

            // Get the angle and clamp its value between 0 and 360 degrees.
            var angle = g.normalizeAngle(this.get('angle') || 0);

            var quadrant = {
                'top-right': 0,
                'right': 0,
                'top-left': 1,
                'top': 1,
                'bottom-left': 2,
                'left': 2,
                'bottom-right': 3,
                'bottom': 3
            }[opt.direction];

            if (opt.absolute) {

                // We are taking the element's rotation into account
                quadrant += Math.floor((angle + 45) / 90);
                quadrant %= 4;
            }

            // This is a rectangle in size of the unrotated element.
            var bbox = this.getBBox();

            // Pick the corner point on the element, which meant to stay on its place before and
            // after the rotation.
            var fixedPoint = bbox[['bottomLeft', 'corner', 'topRight', 'origin'][quadrant]]();

            // Find  an image of the previous indent point. This is the position, where is the
            // point actually located on the screen.
            var imageFixedPoint = g.point(fixedPoint).rotate(bbox.center(), -angle);

            // Every point on the element rotates around a circle with the centre of rotation
            // in the middle of the element while the whole element is being rotated. That means
            // that the distance from a point in the corner of the element (supposed its always rect) to
            // the center of the element doesn't change during the rotation and therefore it equals
            // to a distance on unrotated element.
            // We can find the distance as DISTANCE = (ELEMENTWIDTH/2)^2 + (ELEMENTHEIGHT/2)^2)^0.5.
            var radius = Math.sqrt((width * width) + (height * height)) / 2;

            // Now we are looking for an angle between x-axis and the line starting at image of fixed point
            // and ending at the center of the element. We call this angle `alpha`.

            // The image of a fixed point is located in n-th quadrant. For each quadrant passed
            // going anti-clockwise we have to add 90 degrees. Note that the first quadrant has index 0.
            //
            // 3 | 2
            // --c-- Quadrant positions around the element's center `c`
            // 0 | 1
            //
            var alpha = quadrant * Math.PI / 2;

            // Add an angle between the beginning of the current quadrant (line parallel with x-axis or y-axis
            // going through the center of the element) and line crossing the indent of the fixed point and the center
            // of the element. This is the angle we need but on the unrotated element.
            alpha += Math.atan(quadrant % 2 == 0 ? height / width : width / height);

            // Lastly we have to deduct the original angle the element was rotated by and that's it.
            alpha -= g.toRad(angle);

            // With this angle and distance we can easily calculate the centre of the unrotated element.
            // Note that fromPolar constructor accepts an angle in radians.
            var center = g.point.fromPolar(radius, alpha, imageFixedPoint);

            // The top left corner on the unrotated element has to be half a width on the left
            // and half a height to the top from the center. This will be the origin of rectangle
            // we were looking for.
            var origin = g.point(center).offset(width / -2, height / -2);

            // Resize the element (before re-positioning it).
            this.set('size', { width: width, height: height }, opt);

            // Finally, re-position the element.
            this.position(origin.x, origin.y, opt);

        } else {

            // Resize the element.
            this.set('size', { width: width, height: height }, opt);
        }

        this.stopBatch('resize', opt);

        return this;
    },

    scale: function(sx, sy, origin, opt) {

        var scaledBBox = this.getBBox().scale(sx, sy, origin);
        this.startBatch('scale', opt);
        this.position(scaledBBox.x, scaledBBox.y, opt);
        this.resize(scaledBBox.width, scaledBBox.height, opt);
        this.stopBatch('scale');
        return this;
    },

    fitEmbeds: function(opt) {

        opt = opt || {};

        // Getting the children's size and position requires the collection.
        // Cell.get('embdes') helds an array of cell ids only.
        if (!this.graph) throw new Error('Element must be part of a graph.');

        var embeddedCells = this.getEmbeddedCells();

        if (embeddedCells.length > 0) {

            this.startBatch('fit-embeds', opt);

            if (opt.deep) {
                // Recursively apply fitEmbeds on all embeds first.
                _.invoke(embeddedCells, 'fitEmbeds', opt);
            }

            // Compute cell's size and position  based on the children bbox
            // and given padding.
            var bbox = this.graph.getCellsBBox(embeddedCells);
            var padding = joint.util.normalizeSides(opt.padding);

            // Apply padding computed above to the bbox.
            bbox.moveAndExpand({
                x: -padding.left,
                y: -padding.top,
                width: padding.right + padding.left,
                height: padding.bottom + padding.top
            });

            // Set new element dimensions finally.
            this.set({
                position: { x: bbox.x, y: bbox.y },
                size: { width: bbox.width, height: bbox.height }
            }, opt);

            this.stopBatch('fit-embeds');
        }

        return this;
    },

    // Rotate element by `angle` degrees, optionally around `origin` point.
    // If `origin` is not provided, it is considered to be the center of the element.
    // If `absolute` is `true`, the `angle` is considered is abslute, i.e. it is not
    // the difference from the previous angle.
    rotate: function(angle, absolute, origin, opt) {

        if (origin) {

            var center = this.getBBox().center();
            var size = this.get('size');
            var position = this.get('position');
            center.rotate(origin, this.get('angle') - angle);
            var dx = center.x - size.width / 2 - position.x;
            var dy = center.y - size.height / 2 - position.y;
            this.startBatch('rotate', { angle: angle, absolute: absolute, origin: origin });
            this.position(position.x + dx, position.y + dy, opt);
            this.rotate(angle, absolute, null, opt);
            this.stopBatch('rotate');

        } else {

            this.set('angle', absolute ? angle : (this.get('angle') + angle) % 360, opt);
        }

        return this;
    },

    getBBox: function(opt) {

        opt = opt || {};

        if (opt.deep && this.graph) {

            // Get all the embedded elements using breadth first algorithm,
            // that doesn't use recursion.
            var elements = this.getEmbeddedCells({ deep: true, breadthFirst: true });
            // Add the model itself.
            elements.push(this);

            return this.graph.getCellsBBox(elements);
        }

        var position = this.get('position');
        var size = this.get('size');

        return g.rect(position.x, position.y, size.width, size.height);
    }
});

// joint.dia.Element base view and controller.
// -------------------------------------------


joint.dia.ElementView = joint.dia.CellView.extend({

    /**
     * @abstract
     */
    _removePorts: function() {
        // implemented in ports.js
    },

    /**
     *
     * @abstract
     */
    _renderPorts: function() {
        // implemented in ports.js
    },

    className: function() {

        var classNames = joint.dia.CellView.prototype.className.apply(this).split(' ');

        classNames.push('element');

        return classNames.join(' ');
    },

    initialize: function() {

        joint.dia.CellView.prototype.initialize.apply(this, arguments);

        var model = this.model;

        this.listenTo(model, 'change:position', this.translate);
        this.listenTo(model, 'change:size', this.resize);
        this.listenTo(model, 'change:angle', this.rotate);
        this.listenTo(model, 'change:markup', this.render);

        this._initializePorts();
    },

    /**
     * @abstract
     */
    _initializePorts: function() {

    },

    update: function(cell, renderingOnlyAttrs) {

        this._removePorts();

        var model = this.model;
        var modelAttrs = model.attr();
        this.updateDOMSubtreeAttributes(this.el, modelAttrs, {
            rootBBox: g.Rect(model.size()),
            scalableNode: this.scalableNode,
            rotatableNode: this.rotatableNode,
            // Use rendering only attributes if they differs from the model attributes
            roAttributes: (renderingOnlyAttrs === modelAttrs) ? null : renderingOnlyAttrs
        });

        this._renderPorts();
    },

    // `prototype.markup` is rendered by default. Set the `markup` attribute on the model if the
    // default markup is not desirable.
    renderMarkup: function() {

        var markup = this.model.get('markup') || this.model.markup;

        if (markup) {

            var svg = joint.util.template(markup)();
            var nodes = V(svg);

            this.vel.append(nodes);

        } else {

            throw new Error('properties.markup is missing while the default render() implementation is used.');
        }
    },

    render: function() {

        this.$el.empty();

        this.renderMarkup();
        this.rotatableNode = this.vel.findOne('.rotatable');
        var scalable = this.scalableNode = this.vel.findOne('.scalable');
        if (scalable) {
            // Double update is necessary for elements with the scalable group only
            // Note the resize() triggers the other `update`.
            this.update();
        }
        this.resize();
        this.rotate();
        this.translate();

        return this;
    },

    resize: function(cell, changed, opt) {

        var model = this.model;
        var size = model.get('size') || { width: 1, height: 1 };
        var angle = model.get('angle') || 0;

        var scalable = this.scalableNode;
        if (!scalable) {

            if (angle !== 0) {
                // update the origin of the rotation
                this.rotate();
            }
            // update the ref attributes
            this.update();

            // If there is no scalable elements, than there is nothing to scale.
            return;
        }

        var scalableBbox = scalable.bbox(true);
        // Make sure `scalableBbox.width` and `scalableBbox.height` are not zero which can happen if the element does not have any content. By making
        // the width/height 1, we prevent HTML errors of the type `scale(Infinity, Infinity)`.
        scalable.attr('transform', 'scale(' + (size.width / (scalableBbox.width || 1)) + ',' + (size.height / (scalableBbox.height || 1)) + ')');

        // Now the interesting part. The goal is to be able to store the object geometry via just `x`, `y`, `angle`, `width` and `height`
        // Order of transformations is significant but we want to reconstruct the object always in the order:
        // resize(), rotate(), translate() no matter of how the object was transformed. For that to work,
        // we must adjust the `x` and `y` coordinates of the object whenever we resize it (because the origin of the
        // rotation changes). The new `x` and `y` coordinates are computed by canceling the previous rotation
        // around the center of the resized object (which is a different origin then the origin of the previous rotation)
        // and getting the top-left corner of the resulting object. Then we clean up the rotation back to what it originally was.

        // Cancel the rotation but now around a different origin, which is the center of the scaled object.
        var rotatable = this.rotatableNode;
        var rotation = rotatable && rotatable.attr('transform');
        if (rotation && rotation !== 'null') {

            rotatable.attr('transform', rotation + ' rotate(' + (-angle) + ',' + (size.width / 2) + ',' + (size.height / 2) + ')');
            var rotatableBbox = scalable.bbox(false, this.paper.viewport);

            // Store new x, y and perform rotate() again against the new rotation origin.
            model.set('position', { x: rotatableBbox.x, y: rotatableBbox.y }, opt);
            this.rotate();
        }

        // Update must always be called on non-rotated element. Otherwise, relative positioning
        // would work with wrong (rotated) bounding boxes.
        this.update();
    },

    translate: function(model, changes, opt) {

        var position = this.model.get('position') || { x: 0, y: 0 };

        this.vel.attr('transform', 'translate(' + position.x + ',' + position.y + ')');
    },

    rotate: function() {

        var rotatable = this.rotatableNode;
        if (!rotatable) {
            // If there is no rotatable elements, then there is nothing to rotate.
            return;
        }

        var angle = this.model.get('angle') || 0;
        var size = this.model.get('size') || { width: 1, height: 1 };

        var ox = size.width / 2;
        var oy = size.height / 2;

        if (angle !== 0) {
            rotatable.attr('transform', 'rotate(' + angle + ',' + ox + ',' + oy + ')');
        } else {
            rotatable.removeAttr('transform');
        }
    },

    getBBox: function(opt) {

        if (opt && opt.useModelGeometry) {
            var bbox = this.model.getBBox().bbox(this.model.get('angle'));
            return this.paper.localToPaperRect(bbox);
        }

        return joint.dia.CellView.prototype.getBBox.apply(this, arguments);
    },

    // Embedding mode methods
    // ----------------------

    prepareEmbedding: function(opt) {

        opt = opt || {};

        var model = opt.model || this.model;
        var paper = opt.paper || this.paper;
        var graph = paper.model;

        model.startBatch('to-front', opt);

        // Bring the model to the front with all his embeds.
        model.toFront({ deep: true, ui: true });

        // Note that at this point cells in the collection are not sorted by z index (it's running in the batch, see
        // the dia.Graph._sortOnChangeZ), so we can't assume that the last cell in the collection has the highest z.
        var maxZ = graph.get('cells').max('z').get('z');
        var connectedLinks = graph.getConnectedLinks(model, { deep: true });

        // Move to front also all the inbound and outbound links that are connected
        // to any of the element descendant. If we bring to front only embedded elements,
        // links connected to them would stay in the background.
        _.invoke(connectedLinks, 'set', 'z', maxZ + 1, { ui: true });

        model.stopBatch('to-front');

        // Before we start looking for suitable parent we remove the current one.
        var parentId = model.get('parent');
        parentId && graph.getCell(parentId).unembed(model, { ui: true });
    },

    processEmbedding: function(opt) {

        opt = opt || {};

        var model = opt.model || this.model;
        var paper = opt.paper || this.paper;

        var paperOptions = paper.options;
        var candidates = paper.model.findModelsUnderElement(model, { searchBy: paperOptions.findParentBy });

        if (paperOptions.frontParentOnly) {
            // pick the element with the highest `z` index
            candidates = candidates.slice(-1);
        }

        var newCandidateView = null;
        var prevCandidateView = this._candidateEmbedView;

        // iterate over all candidates starting from the last one (has the highest z-index).
        for (var i = candidates.length - 1; i >= 0; i--) {

            var candidate = candidates[i];

            if (prevCandidateView && prevCandidateView.model.id == candidate.id) {

                // candidate remains the same
                newCandidateView = prevCandidateView;
                break;

            } else {

                var view = candidate.findView(paper);
                if (paperOptions.validateEmbedding.call(paper, this, view)) {

                    // flip to the new candidate
                    newCandidateView = view;
                    break;
                }
            }
        }

        if (newCandidateView && newCandidateView != prevCandidateView) {
            // A new candidate view found. Highlight the new one.
            this.clearEmbedding();
            this._candidateEmbedView = newCandidateView.highlight(null, { embedding: true });
        }

        if (!newCandidateView && prevCandidateView) {
            // No candidate view found. Unhighlight the previous candidate.
            this.clearEmbedding();
        }
    },

    clearEmbedding: function() {

        var candidateView = this._candidateEmbedView;
        if (candidateView) {
            // No candidate view found. Unhighlight the previous candidate.
            candidateView.unhighlight(null, { embedding: true });
            this._candidateEmbedView = null;
        }
    },

    finalizeEmbedding: function(opt) {

        opt = opt || {};

        var candidateView = this._candidateEmbedView;
        var model = opt.model || this.model;
        var paper = opt.paper || this.paper;

        if (candidateView) {

            // We finished embedding. Candidate view is chosen to become the parent of the model.
            candidateView.model.embed(model, { ui: true });
            candidateView.unhighlight(null, { embedding: true });

            delete this._candidateEmbedView;
        }

        _.invoke(paper.model.getConnectedLinks(model, { deep: true }), 'reparent', { ui: true });
    },

    // Interaction. The controller part.
    // ---------------------------------

    pointerdown: function(evt, x, y) {

        var paper = this.paper;

        if (
            evt.target.getAttribute('magnet') &&
            this.can('addLinkFromMagnet') &&
            paper.options.validateMagnet.call(paper, this, evt.target)
        ) {

            this.model.startBatch('add-link');

            var link = paper.getDefaultLink(this, evt.target);

            link.set({
                source: {
                    id: this.model.id,
                    selector: this.getSelector(evt.target),
                    port: evt.target.getAttribute('port')
                },
                target: { x: x, y: y }
            });

            paper.model.addCell(link);

            var linkView = this._linkView = paper.findViewByModel(link);

            linkView.pointerdown(evt, x, y);
            linkView.startArrowheadMove('target', { whenNotAllowed: 'remove' });

        } else {

            this._dx = x;
            this._dy = y;

            this.restrictedArea = paper.getRestrictedArea(this);

            joint.dia.CellView.prototype.pointerdown.apply(this, arguments);
            this.notify('element:pointerdown', evt, x, y);
        }
    },

    pointermove: function(evt, x, y) {

        if (this._linkView) {

            // let the linkview deal with this event
            this._linkView.pointermove(evt, x, y);

        } else {

            var grid = this.paper.options.gridSize;

            if (this.can('elementMove')) {

                var position = this.model.get('position');

                // Make sure the new element's position always snaps to the current grid after
                // translate as the previous one could be calculated with a different grid size.
                var tx = g.snapToGrid(position.x, grid) - position.x + g.snapToGrid(x - this._dx, grid);
                var ty = g.snapToGrid(position.y, grid) - position.y + g.snapToGrid(y - this._dy, grid);

                this.model.translate(tx, ty, { restrictedArea: this.restrictedArea, ui: true });

                if (this.paper.options.embeddingMode) {

                    if (!this._inProcessOfEmbedding) {
                        // Prepare the element for embedding only if the pointer moves.
                        // We don't want to do unnecessary action with the element
                        // if an user only clicks/dblclicks on it.
                        this.prepareEmbedding();
                        this._inProcessOfEmbedding = true;
                    }

                    this.processEmbedding();
                }
            }

            this._dx = g.snapToGrid(x, grid);
            this._dy = g.snapToGrid(y, grid);

            joint.dia.CellView.prototype.pointermove.apply(this, arguments);
            this.notify('element:pointermove', evt, x, y);
        }
    },

    pointerup: function(evt, x, y) {

        if (this._linkView) {

            // Let the linkview deal with this event.
            this._linkView.pointerup(evt, x, y);
            this._linkView = null;
            this.model.stopBatch('add-link');

        } else {

            if (this._inProcessOfEmbedding) {
                this.finalizeEmbedding();
                this._inProcessOfEmbedding = false;
            }

            this.notify('element:pointerup', evt, x, y);
            joint.dia.CellView.prototype.pointerup.apply(this, arguments);
        }
    },

    mouseenter: function(evt) {

        joint.dia.CellView.prototype.mouseenter.apply(this, arguments);
        this.notify('element:mouseenter', evt);
    },

    mouseleave: function(evt) {

        joint.dia.CellView.prototype.mouseleave.apply(this, arguments);
        this.notify('element:mouseleave', evt);
    }
});


// joint.dia.Link base model.
// --------------------------

joint.dia.Link = joint.dia.Cell.extend({

    // The default markup for links.
    markup: [
        '<path class="connection" stroke="black" d="M 0 0 0 0"/>',
        '<path class="marker-source" fill="black" stroke="black" d="M 0 0 0 0"/>',
        '<path class="marker-target" fill="black" stroke="black" d="M 0 0 0 0"/>',
        '<path class="connection-wrap" d="M 0 0 0 0"/>',
        '<g class="labels"/>',
        '<g class="marker-vertices"/>',
        '<g class="marker-arrowheads"/>',
        '<g class="link-tools"/>'
    ].join(''),

    labelMarkup: [
        '<g class="label">',
        '<rect />',
        '<text />',
        '</g>'
    ].join(''),

    toolMarkup: [
        '<g class="link-tool">',
        '<g class="tool-remove" event="remove">',
        '<circle r="11" />',
        '<path transform="scale(.8) translate(-16, -16)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z" />',
        '<title>Remove link.</title>',
        '</g>',
        '<g class="tool-options" event="link:options">',
        '<circle r="11" transform="translate(25)"/>',
        '<path fill="white" transform="scale(.55) translate(29, -16)" d="M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z"/>',
        '<title>Link options.</title>',
        '</g>',
        '</g>'
    ].join(''),

    // The default markup for showing/removing vertices. These elements are the children of the .marker-vertices element (see `this.markup`).
    // Only .marker-vertex and .marker-vertex-remove element have special meaning. The former is used for
    // dragging vertices (changin their position). The latter is used for removing vertices.
    vertexMarkup: [
        '<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">',
        '<circle class="marker-vertex" idx="<%= idx %>" r="10" />',
        '<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>',
        '<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',
        '<title>Remove vertex.</title>',
        '</path>',
        '</g>'
    ].join(''),

    arrowheadMarkup: [
        '<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">',
        '<path class="marker-arrowhead" end="<%= end %>" d="M 26 0 L 0 13 L 26 26 z" />',
        '</g>'
    ].join(''),

    defaults: {

        type: 'link',
        source: {},
        target: {}
    },

    isLink: function() {

        return true;
    },

    disconnect: function() {

        return this.set({ source: g.point(0, 0), target: g.point(0, 0) });
    },

    // A convenient way to set labels. Currently set values will be mixined with `value` if used as a setter.
    label: function(idx, value, opt) {

        idx = idx || 0;

        // Is it a getter?
        if (arguments.length <= 1) {
            return this.prop(['labels', idx]);
        }

        return this.prop(['labels', idx], value, opt);
    },

    translate: function(tx, ty, opt) {

        // enrich the option object
        opt = opt || {};
        opt.translateBy = opt.translateBy || this.id;
        opt.tx = tx;
        opt.ty = ty;

        return this.applyToPoints(function(p) {
            return { x: (p.x || 0) + tx, y: (p.y || 0) + ty };
        }, opt);
    },

    scale: function(sx, sy, origin, opt) {

        return this.applyToPoints(function(p) {
            return g.point(p).scale(sx, sy, origin).toJSON();
        }, opt);
    },

    applyToPoints: function(fn, opt) {

        if (!_.isFunction(fn)) {
            throw new TypeError('dia.Link: applyToPoints expects its first parameter to be a function.');
        }

        var attrs = {};

        var source = this.get('source');
        if (!source.id) {
            attrs.source = fn(source);
        }

        var target = this.get('target');
        if (!target.id) {
            attrs.target = fn(target);
        }

        var vertices = this.get('vertices');
        if (vertices && vertices.length > 0) {
            attrs.vertices = _.map(vertices, fn);
        }

        return this.set(attrs, opt);
    },

    reparent: function(opt) {

        var newParent;

        if (this.graph) {

            var source = this.graph.getCell(this.get('source').id);
            var target = this.graph.getCell(this.get('target').id);
            var prevParent = this.graph.getCell(this.get('parent'));

            if (source && target) {
                newParent = this.graph.getCommonAncestor(source, target);
            }

            if (prevParent && (!newParent || newParent.id !== prevParent.id)) {
                // Unembed the link if source and target has no common ancestor
                // or common ancestor changed
                prevParent.unembed(this, opt);
            }

            if (newParent) {
                newParent.embed(this, opt);
            }
        }

        return newParent;
    },

    hasLoop: function(opt) {

        opt = opt || {};

        var sourceId = this.get('source').id;
        var targetId = this.get('target').id;

        if (!sourceId || !targetId) {
            // Link "pinned" to the paper does not have a loop.
            return false;
        }

        var loop = sourceId === targetId;

        // Note that there in the deep mode a link can have a loop,
        // even if it connects only a parent and its embed.
        // A loop "target equals source" is valid in both shallow and deep mode.
        if (!loop && opt.deep && this.graph) {

            var sourceElement = this.graph.getCell(sourceId);
            var targetElement = this.graph.getCell(targetId);

            loop = sourceElement.isEmbeddedIn(targetElement) || targetElement.isEmbeddedIn(sourceElement);
        }

        return loop;
    },

    getSourceElement: function() {

        var source = this.get('source');

        return (source && source.id && this.graph && this.graph.getCell(source.id)) || null;
    },

    getTargetElement: function() {

        var target = this.get('target');

        return (target && target.id && this.graph && this.graph.getCell(target.id)) || null;
    },

    // Returns the common ancestor for the source element,
    // target element and the link itself.
    getRelationshipAncestor: function() {

        var connectionAncestor;

        if (this.graph) {

            var cells = _.compact([
                this,
                this.getSourceElement(), // null if source is a point
                this.getTargetElement() // null if target is a point
            ]);

            connectionAncestor = this.graph.getCommonAncestor.apply(this.graph, cells);
        }

        return connectionAncestor || null;
    },

    // Is source, target and the link itself embedded in a given element?
    isRelationshipEmbeddedIn: function(element) {

        var elementId = _.isString(element) ? element : element.id;
        var ancestor = this.getRelationshipAncestor();

        return !!ancestor && (ancestor.id === elementId || ancestor.isEmbeddedIn(elementId));
    }
},
    {
        endsEqual: function(a, b) {

            var portsEqual = a.port === b.port || !a.port && !b.port;
            return a.id === b.id && portsEqual;
        }
    });


// joint.dia.Link base view and controller.
// ----------------------------------------

joint.dia.LinkView = joint.dia.CellView.extend({

    className: function() {

        var classNames = joint.dia.CellView.prototype.className.apply(this).split(' ');

        classNames.push('link');

        return classNames.join(' ');
    },

    options: {

        shortLinkLength: 100,
        doubleLinkTools: false,
        longLinkLength: 160,
        linkToolsOffset: 40,
        doubleLinkToolsOffset: 60,
        sampleInterval: 50
    },

    _z: null,

    initialize: function(options) {

        joint.dia.CellView.prototype.initialize.apply(this, arguments);

        // create methods in prototype, so they can be accessed from any instance and
        // don't need to be create over and over
        if (typeof this.constructor.prototype.watchSource !== 'function') {
            this.constructor.prototype.watchSource = this.createWatcher('source');
            this.constructor.prototype.watchTarget = this.createWatcher('target');
        }

        // `_.labelCache` is a mapping of indexes of labels in the `this.get('labels')` array to
        // `<g class="label">` nodes wrapped by Vectorizer. This allows for quick access to the
        // nodes in `updateLabelPosition()` in order to update the label positions.
        this._labelCache = {};

        // keeps markers bboxes and positions again for quicker access
        this._markerCache = {};

        // bind events
        this.startListening();
    },

    startListening: function() {

        var model = this.model;

        this.listenTo(model, 'change:markup', this.render);
        this.listenTo(model, 'change:smooth change:manhattan change:router change:connector', this.update);
        this.listenTo(model, 'change:toolMarkup', this.onToolsChange);
        this.listenTo(model, 'change:labels change:labelMarkup', this.onLabelsChange);
        this.listenTo(model, 'change:vertices change:vertexMarkup', this.onVerticesChange);
        this.listenTo(model, 'change:source', this.onSourceChange);
        this.listenTo(model, 'change:target', this.onTargetChange);
    },

    onSourceChange: function(cell, source, opt) {

        // Start watching the new source model.
        this.watchSource(cell, source);
        // This handler is called when the source attribute is changed.
        // This can happen either when someone reconnects the link (or moves arrowhead),
        // or when an embedded link is translated by its ancestor.
        // 1. Always do update.
        // 2. Do update only if the opposite end ('target') is also a point.
        if (!opt.translateBy || !this.model.get('target').id) {
            opt.updateConnectionOnly = true;
            this.update(this.model, null, opt);
        }
    },

    onTargetChange: function(cell, target, opt) {

        // Start watching the new target model.
        this.watchTarget(cell, target);
        // See `onSourceChange` method.
        if (!opt.translateBy) {
            opt.updateConnectionOnly = true;
            this.update(this.model, null, opt);
        }
    },

    onVerticesChange: function(cell, changed, opt) {

        this.renderVertexMarkers();

        // If the vertices have been changed by a translation we do update only if the link was
        // the only link that was translated. If the link was translated via another element which the link
        // is embedded in, this element will be translated as well and that triggers an update.
        // Note that all embeds in a model are sorted - first comes links, then elements.
        if (!opt.translateBy || opt.translateBy === this.model.id) {
            // Vertices were changed (not as a reaction on translate)
            // or link.translate() was called or
            opt.updateConnectionOnly = true;
            this.update(cell, null, opt);
        }
    },

    onToolsChange: function() {

        this.renderTools().updateToolsPosition();
    },

    onLabelsChange: function() {

        this.renderLabels().updateLabelPositions();
    },

    // Rendering
    //----------

    render: function() {

        this.$el.empty();

        // A special markup can be given in the `properties.markup` property. This might be handy
        // if e.g. arrowhead markers should be `<image>` elements or any other element than `<path>`s.
        // `.connection`, `.connection-wrap`, `.marker-source` and `.marker-target` selectors
        // of elements with special meaning though. Therefore, those classes should be preserved in any
        // special markup passed in `properties.markup`.
        var model = this.model;
        var markup = model.get('markup') || model.markup;
        var children = V(markup);

        // custom markup may contain only one children
        if (!_.isArray(children)) children = [children];

        // Cache all children elements for quicker access.
        this._V = {}; // vectorized markup;
        _.each(children, function(child) {

            var className = child.attr('class');

            if (className) {
                // Strip the joint class name prefix, if there is one.
                className = joint.util.removeClassNamePrefix(className);
                this._V[$.camelCase(className)] = child;
            }

        }, this);

        // Only the connection path is mandatory
        if (!this._V.connection) throw new Error('link: no connection path in the markup');

        // partial rendering
        this.renderTools();
        this.renderVertexMarkers();
        this.renderArrowheadMarkers();

        this.vel.append(children);

        // rendering labels has to be run after the link is appended to DOM tree. (otherwise <Text> bbox
        // returns zero values)
        this.renderLabels();

        // start watching the ends of the link for changes
        this.watchSource(model, model.get('source'))
            .watchTarget(model, model.get('target'))
            .update();

        return this;
    },

    renderLabels: function() {

        var vLabels = this._V.labels;
        if (!vLabels) {
            return this;
        }

        vLabels.empty();

        var model = this.model;
        var labels = model.get('labels') || [];
        var labelCache = this._labelCache = {};
        var labelsCount = labels.length;
        if (labelsCount === 0) {
            return this;
        }

        var labelTemplate = joint.util.template(model.get('labelMarkup') || model.labelMarkup);
        // This is a prepared instance of a vectorized SVGDOM node for the label element resulting from
        // compilation of the labelTemplate. The purpose is that all labels will just `clone()` this
        // node to create a duplicate.
        var labelNodeInstance = V(labelTemplate());
        var canLabelMove = this.can('labelMove');

        for (var i = 0; i < labelsCount; i++) {

            var label = labels[i];
            var labelMarkup = label.markup;
            // Cache label nodes so that the `updateLabels()` can just update the label node positions.
            var vLabelNode = labelCache[i] = (labelMarkup)
                ? V('g').append(V(labelMarkup))
                : labelNodeInstance.clone();

            vLabelNode
                .addClass('label')
                .attr({
                    'label-idx': i,
                    'cursor': (canLabelMove ? 'move' : 'default')
                })
                .appendTo(vLabels);

            var labelAttrs = label.attrs;
            if (!labelMarkup) {
                // Default attributes to maintain backwards compatibility
                labelAttrs = _.merge({
                    text: {
                        textAnchor: 'middle',
                        fontSize: 14,
                        pointerEvents: 'none',
                        yAlignment: 'middle'
                    },
                    rect: {
                        ref: 'text',
                        fill: 'white',
                        rx: 3,
                        ry: 3,
                        refWidth: 1,
                        refHeight: 1,
                        refX: 0,
                        refY: 0
                    }
                }, labelAttrs);
            }

            this.updateDOMSubtreeAttributes(vLabelNode.node, labelAttrs);
        }

        return this;
    },

    renderTools: function() {

        if (!this._V.linkTools) return this;

        // Tools are a group of clickable elements that manipulate the whole link.
        // A good example of this is the remove tool that removes the whole link.
        // Tools appear after hovering the link close to the `source` element/point of the link
        // but are offset a bit so that they don't cover the `marker-arrowhead`.

        var $tools = $(this._V.linkTools.node).empty();
        var toolTemplate = joint.util.template(this.model.get('toolMarkup') || this.model.toolMarkup);
        var tool = V(toolTemplate());

        $tools.append(tool.node);

        // Cache the tool node so that the `updateToolsPosition()` can update the tool position quickly.
        this._toolCache = tool;

        // If `doubleLinkTools` is enabled, we render copy of the tools on the other side of the
        // link as well but only if the link is longer than `longLinkLength`.
        if (this.options.doubleLinkTools) {

            var tool2;
            if (this.model.get('doubleToolMarkup') || this.model.doubleToolMarkup) {
                toolTemplate = joint.util.template(this.model.get('doubleToolMarkup') || this.model.doubleToolMarkup);
                tool2 = V(toolTemplate());
            } else {
                tool2 = tool.clone();
            }

            $tools.append(tool2.node);
            this._tool2Cache = tool2;
        }

        return this;
    },

    renderVertexMarkers: function() {

        if (!this._V.markerVertices) return this;

        var $markerVertices = $(this._V.markerVertices.node).empty();

        // A special markup can be given in the `properties.vertexMarkup` property. This might be handy
        // if default styling (elements) are not desired. This makes it possible to use any
        // SVG elements for .marker-vertex and .marker-vertex-remove tools.
        var markupTemplate = joint.util.template(this.model.get('vertexMarkup') || this.model.vertexMarkup);

        _.each(this.model.get('vertices'), function(vertex, idx) {

            $markerVertices.append(V(markupTemplate(_.extend({ idx: idx }, vertex))).node);
        });

        return this;
    },

    renderArrowheadMarkers: function() {

        // Custom markups might not have arrowhead markers. Therefore, jump of this function immediately if that's the case.
        if (!this._V.markerArrowheads) return this;

        var $markerArrowheads = $(this._V.markerArrowheads.node);

        $markerArrowheads.empty();

        // A special markup can be given in the `properties.vertexMarkup` property. This might be handy
        // if default styling (elements) are not desired. This makes it possible to use any
        // SVG elements for .marker-vertex and .marker-vertex-remove tools.
        var markupTemplate = joint.util.template(this.model.get('arrowheadMarkup') || this.model.arrowheadMarkup);

        this._V.sourceArrowhead = V(markupTemplate({ end: 'source' }));
        this._V.targetArrowhead = V(markupTemplate({ end: 'target' }));

        $markerArrowheads.append(this._V.sourceArrowhead.node, this._V.targetArrowhead.node);

        return this;
    },

    // Updating
    //---------

    // Default is to process the `attrs` object and set attributes on subelements based on the selectors.
    update: function(model, attributes, opt) {

        opt = opt || {};

        if (!opt.updateConnectionOnly) {
            // update SVG attributes defined by 'attrs/'.
            this.updateDOMSubtreeAttributes(this.el, this.model.attr());
        }

        // update the link path, label position etc.
        this.updateConnection(opt);
        this.updateLabelPositions();
        this.updateToolsPosition();
        this.updateArrowheadMarkers();

        // Local perpendicular flag (as opposed to one defined on paper).
        // Could be enabled inside a connector/router. It's valid only
        // during the update execution.
        this.options.perpendicular = null;
        // Mark that postponed update has been already executed.
        this.updatePostponed = false;

        return this;
    },

    updateConnection: function(opt) {

        opt = opt || {};

        var model = this.model;
        var route;

        if (opt.translateBy && model.isRelationshipEmbeddedIn(opt.translateBy)) {
            // The link is being translated by an ancestor that will
            // shift source point, target point and all vertices
            // by an equal distance.
            var tx = opt.tx || 0;
            var ty = opt.ty || 0;

            route = this.route =  _.map(this.route, function(point) {
                // translate point by point by delta translation
                return g.point(point).offset(tx, ty);
            });

            // translate source and target connection and marker points.
            this._translateConnectionPoints(tx, ty);

        } else {
            // Necessary path finding
            route = this.route = this.findRoute(model.get('vertices') || [], opt);
            // finds all the connection points taking new vertices into account
            this._findConnectionPoints(route);
        }

        var pathData = this.getPathData(route);

        // The markup needs to contain a `.connection`
        this._V.connection.attr('d', pathData);
        this._V.connectionWrap && this._V.connectionWrap.attr('d', pathData);

        this._translateAndAutoOrientArrows(this._V.markerSource, this._V.markerTarget);
    },

    _findConnectionPoints: function(vertices) {

        // cache source and target points
        var sourcePoint, targetPoint, sourceMarkerPoint, targetMarkerPoint;

        var firstVertex = _.first(vertices);

        sourcePoint = this.getConnectionPoint(
            'source', this.model.get('source'), firstVertex || this.model.get('target')
        ).round();

        var lastVertex = _.last(vertices);

        targetPoint = this.getConnectionPoint(
            'target', this.model.get('target'), lastVertex || sourcePoint
        ).round();

        // Move the source point by the width of the marker taking into account
        // its scale around x-axis. Note that scale is the only transform that
        // makes sense to be set in `.marker-source` attributes object
        // as all other transforms (translate/rotate) will be replaced
        // by the `translateAndAutoOrient()` function.
        var cache = this._markerCache;

        if (this._V.markerSource) {

            cache.sourceBBox = cache.sourceBBox || this._V.markerSource.bbox(true);

            sourceMarkerPoint = g.point(sourcePoint).move(
                firstVertex || targetPoint,
                cache.sourceBBox.width * this._V.markerSource.scale().sx * -1
            ).round();
        }

        if (this._V.markerTarget) {

            cache.targetBBox = cache.targetBBox || this._V.markerTarget.bbox(true);

            targetMarkerPoint = g.point(targetPoint).move(
                lastVertex || sourcePoint,
                cache.targetBBox.width * this._V.markerTarget.scale().sx * -1
            ).round();
        }

        // if there was no markup for the marker, use the connection point.
        cache.sourcePoint = sourceMarkerPoint || sourcePoint.clone();
        cache.targetPoint = targetMarkerPoint || targetPoint.clone();

        // make connection points public
        this.sourcePoint = sourcePoint;
        this.targetPoint = targetPoint;
    },

    _translateConnectionPoints: function(tx, ty) {

        var cache = this._markerCache;

        cache.sourcePoint.offset(tx, ty);
        cache.targetPoint.offset(tx, ty);
        this.sourcePoint.offset(tx, ty);
        this.targetPoint.offset(tx, ty);
    },

    updateLabelPositions: function() {

        if (!this._V.labels) return this;

        // This method assumes all the label nodes are stored in the `this._labelCache` hash table
        // by their indexes in the `this.get('labels')` array. This is done in the `renderLabels()` method.

        var labels = this.model.get('labels') || [];
        if (!labels.length) return this;

        var connectionElement = this._V.connection.node;
        var connectionLength = connectionElement.getTotalLength();

        // Firefox returns connectionLength=NaN in odd cases (for bezier curves).
        // In that case we won't update labels at all.
        if (!_.isNaN(connectionLength)) {

            var samples;

            _.each(labels, function(label, idx) {

                var position = label.position;
                var distance = _.isObject(position) ? position.distance : position;
                var offset = _.isObject(position) ? position.offset : { x: 0, y: 0 };

                if (_.isFinite(distance)) {
                    distance = (distance > connectionLength) ? connectionLength : distance; // sanity check
                    distance = (distance < 0) ? connectionLength + distance : distance;
                    distance = (distance > 1) ? distance : connectionLength * distance;
                } else {
                    distance = connectionLength / 2;
                }

                var labelCoordinates = connectionElement.getPointAtLength(distance);

                if (_.isObject(offset)) {

                    // Just offset the label by the x,y provided in the offset object.
                    labelCoordinates = g.point(labelCoordinates).offset(offset);

                } else if (_.isFinite(offset)) {

                    if (!samples) {
                        samples = this._samples || this._V.connection.sample(this.options.sampleInterval);
                    }

                    // Offset the label by the amount provided in `offset` to an either
                    // side of the link.

                    // 1. Find the closest sample & its left and right neighbours.
                    var minSqDistance = Infinity;
                    var closestSampleIndex, sample, sqDistance;
                    for (var i = 0; i < samples.length; i++) {
                        sample = samples[i];
                        sqDistance = g.line(sample, labelCoordinates).squaredLength();
                        if (sqDistance < minSqDistance) {
                            minSqDistance = sqDistance;
                            closestSampleIndex = i;
                        }
                    }
                    var prevSample = samples[closestSampleIndex - 1];
                    var nextSample = samples[closestSampleIndex + 1];

                    // 2. Offset the label on the perpendicular line between
                    // the current label coordinate ("at `distance`") and
                    // the next sample.
                    var angle = 0;
                    if (nextSample) {
                        angle = g.point(labelCoordinates).theta(nextSample);
                    } else if (prevSample) {
                        angle = g.point(prevSample).theta(labelCoordinates);
                    }
                    labelCoordinates = g.point(labelCoordinates).offset(offset).rotate(labelCoordinates, angle - 90);
                }

                this._labelCache[idx].attr('transform', 'translate(' + labelCoordinates.x + ', ' + labelCoordinates.y + ')');

            }, this);
        }

        return this;
    },


    updateToolsPosition: function() {

        if (!this._V.linkTools) return this;

        // Move the tools a bit to the target position but don't cover the `sourceArrowhead` marker.
        // Note that the offset is hardcoded here. The offset should be always
        // more than the `this.$('.marker-arrowhead[end="source"]')[0].bbox().width` but looking
        // this up all the time would be slow.

        var scale = '';
        var offset = this.options.linkToolsOffset;
        var connectionLength = this.getConnectionLength();

        // Firefox returns connectionLength=NaN in odd cases (for bezier curves).
        // In that case we won't update tools position at all.
        if (!_.isNaN(connectionLength)) {

            // If the link is too short, make the tools half the size and the offset twice as low.
            if (connectionLength < this.options.shortLinkLength) {
                scale = 'scale(.5)';
                offset /= 2;
            }

            var toolPosition = this.getPointAtLength(offset);

            this._toolCache.attr('transform', 'translate(' + toolPosition.x + ', ' + toolPosition.y + ') ' + scale);

            if (this.options.doubleLinkTools && connectionLength >= this.options.longLinkLength) {

                var doubleLinkToolsOffset = this.options.doubleLinkToolsOffset || offset;

                toolPosition = this.getPointAtLength(connectionLength - doubleLinkToolsOffset);
                this._tool2Cache.attr('transform', 'translate(' + toolPosition.x + ', ' + toolPosition.y + ') ' + scale);
                this._tool2Cache.attr('visibility', 'visible');

            } else if (this.options.doubleLinkTools) {

                this._tool2Cache.attr('visibility', 'hidden');
            }
        }

        return this;
    },


    updateArrowheadMarkers: function() {

        if (!this._V.markerArrowheads) return this;

        // getting bbox of an element with `display="none"` in IE9 ends up with access violation
        if ($.css(this._V.markerArrowheads.node, 'display') === 'none') return this;

        var sx = this.getConnectionLength() < this.options.shortLinkLength ? .5 : 1;
        this._V.sourceArrowhead.scale(sx);
        this._V.targetArrowhead.scale(sx);

        this._translateAndAutoOrientArrows(this._V.sourceArrowhead, this._V.targetArrowhead);

        return this;
    },

    // Returns a function observing changes on an end of the link. If a change happens and new end is a new model,
    // it stops listening on the previous one and starts listening to the new one.
    createWatcher: function(endType) {

        // create handler for specific end type (source|target).
        var onModelChange = _.partial(this.onEndModelChange, endType);

        function watchEndModel(link, end) {

            end = end || {};

            var endModel = null;
            var previousEnd = link.previous(endType) || {};

            if (previousEnd.id) {
                this.stopListening(this.paper.getModelById(previousEnd.id), 'change', onModelChange);
            }

            if (end.id) {
                // If the observed model changes, it caches a new bbox and do the link update.
                endModel = this.paper.getModelById(end.id);
                this.listenTo(endModel, 'change', onModelChange);
            }

            onModelChange.call(this, endModel, { cacheOnly: true });

            return this;
        }

        return watchEndModel;
    },

    onEndModelChange: function(endType, endModel, opt) {

        var doUpdate = !opt.cacheOnly;
        var model = this.model;
        var end = model.get(endType) || {};

        if (endModel) {

            var selector = this.constructor.makeSelector(end);
            var oppositeEndType = endType == 'source' ? 'target' : 'source';
            var oppositeEnd = model.get(oppositeEndType) || {};
            var oppositeSelector = oppositeEnd.id && this.constructor.makeSelector(oppositeEnd);

            // Caching end models bounding boxes.
            // If `opt.handleBy` equals the client-side ID of this link view and it is a loop link, then we already cached
            // the bounding boxes in the previous turn (e.g. for loop link, the change:source event is followed
            // by change:target and so on change:source, we already chached the bounding boxes of - the same - element).
            if (opt.handleBy === this.cid && selector == oppositeSelector) {

                // Source and target elements are identical. We're dealing with a loop link. We are handling `change` event for the
                // second time now. There is no need to calculate bbox and find magnet element again.
                // It was calculated already for opposite link end.
                this[endType + 'BBox'] = this[oppositeEndType + 'BBox'];
                this[endType + 'View'] = this[oppositeEndType + 'View'];
                this[endType + 'Magnet'] = this[oppositeEndType + 'Magnet'];

            } else if (opt.translateBy) {
                // `opt.translateBy` optimizes the way we calculate bounding box of the source/target element.
                // If `opt.translateBy` is an ID of the element that was originally translated. This allows us
                // to just offset the cached bounding box by the translation instead of calculating the bounding
                // box from scratch on every translate.

                var bbox = this[endType + 'BBox'];
                bbox.x += opt.tx;
                bbox.y += opt.ty;

            } else {
                // The slowest path, source/target could have been rotated or resized or any attribute
                // that affects the bounding box of the view might have been changed.

                var view = this.paper.findViewByModel(end.id);
                var magnetElement = view.el.querySelector(selector);

                this[endType + 'BBox'] = view.getStrokeBBox(magnetElement);
                this[endType + 'View'] = view;
                this[endType + 'Magnet'] = magnetElement;
            }

            if (opt.handleBy === this.cid && opt.translateBy &&
                model.isEmbeddedIn(endModel) &&
                !_.isEmpty(model.get('vertices'))) {
                // Loop link whose element was translated and that has vertices (that need to be translated with
                // the parent in which my element is embedded).
                // If the link is embedded, has a loop and vertices and the end model
                // has been translated, do not update yet. There are vertices still to be updated (change:vertices
                // event will come in the next turn).
                doUpdate = false;
            }

            if (!this.updatePostponed && oppositeEnd.id) {
                // The update was not postponed (that can happen e.g. on the first change event) and the opposite
                // end is a model (opposite end is the opposite end of the link we're just updating, e.g. if
                // we're reacting on change:source event, the oppositeEnd is the target model).

                var oppositeEndModel = this.paper.getModelById(oppositeEnd.id);

                // Passing `handleBy` flag via event option.
                // Note that if we are listening to the same model for event 'change' twice.
                // The same event will be handled by this method also twice.
                if (end.id === oppositeEnd.id) {
                    // We're dealing with a loop link. Tell the handlers in the next turn that they should update
                    // the link instead of me. (We know for sure there will be a next turn because
                    // loop links react on at least two events: change on the source model followed by a change on
                    // the target model).
                    opt.handleBy = this.cid;
                }

                if (opt.handleBy === this.cid || (opt.translateBy && oppositeEndModel.isEmbeddedIn(opt.translateBy))) {

                    // Here are two options:
                    // - Source and target are connected to the same model (not necessarily the same port).
                    // - Both end models are translated by the same ancestor. We know that opposite end
                    //   model will be translated in the next turn as well.
                    // In both situations there will be more changes on the model that trigger an
                    // update. So there is no need to update the linkView yet.
                    this.updatePostponed = true;
                    doUpdate = false;
                }
            }

        } else {

            // the link end is a point ~ rect 1x1
            this[endType + 'BBox'] = g.rect(end.x || 0, end.y || 0, 1, 1);
            this[endType + 'View'] = this[endType + 'Magnet'] = null;
        }

        if (doUpdate) {
            opt.updateConnectionOnly = true;
            this.update(model, null, opt);
        }
    },

    _translateAndAutoOrientArrows: function(sourceArrow, targetArrow) {

        // Make the markers "point" to their sticky points being auto-oriented towards
        // `targetPosition`/`sourcePosition`. And do so only if there is a markup for them.
        if (sourceArrow) {
            sourceArrow.translateAndAutoOrient(
                this.sourcePoint,
                _.first(this.route) || this.targetPoint,
                this.paper.viewport
            );
        }

        if (targetArrow) {
            targetArrow.translateAndAutoOrient(
                this.targetPoint,
                _.last(this.route) || this.sourcePoint,
                this.paper.viewport
            );
        }
    },

    removeVertex: function(idx) {

        var vertices = _.clone(this.model.get('vertices'));

        if (vertices && vertices.length) {

            vertices.splice(idx, 1);
            this.model.set('vertices', vertices, { ui: true });
        }

        return this;
    },

    // This method ads a new vertex to the `vertices` array of `.connection`. This method
    // uses a heuristic to find the index at which the new `vertex` should be placed at assuming
    // the new vertex is somewhere on the path.
    addVertex: function(vertex) {

        // As it is very hard to find a correct index of the newly created vertex,
        // a little heuristics is taking place here.
        // The heuristics checks if length of the newly created
        // path is lot more than length of the old path. If this is the case,
        // new vertex was probably put into a wrong index.
        // Try to put it into another index and repeat the heuristics again.

        var vertices = (this.model.get('vertices') || []).slice();
        // Store the original vertices for a later revert if needed.
        var originalVertices = vertices.slice();

        // A `<path>` element used to compute the length of the path during heuristics.
        var path = this._V.connection.node.cloneNode(false);

        // Length of the original path.
        var originalPathLength = path.getTotalLength();
        // Current path length.
        var pathLength;
        // Tolerance determines the highest possible difference between the length
        // of the old and new path. The number has been chosen heuristically.
        var pathLengthTolerance = 20;
        // Total number of vertices including source and target points.
        var idx = vertices.length + 1;

        // Loop through all possible indexes and check if the difference between
        // path lengths changes significantly. If not, the found index is
        // most probably the right one.
        while (idx--) {

            vertices.splice(idx, 0, vertex);
            V(path).attr('d', this.getPathData(this.findRoute(vertices)));

            pathLength = path.getTotalLength();

            // Check if the path lengths changed significantly.
            if (pathLength - originalPathLength > pathLengthTolerance) {

                // Revert vertices to the original array. The path length has changed too much
                // so that the index was not found yet.
                vertices = originalVertices.slice();

            } else {

                break;
            }
        }

        if (idx === -1) {
            // If no suitable index was found for such a vertex, make the vertex the first one.
            idx = 0;
            vertices.splice(idx, 0, vertex);
        }

        this.model.set('vertices', vertices, { ui: true });

        return idx;
    },

    // Send a token (an SVG element, usually a circle) along the connection path.
    // Example: `paper.findViewByModel(link).sendToken(V('circle', { r: 7, fill: 'green' }).node)`
    // `duration` is optional and is a time in milliseconds that the token travels from the source to the target of the link. Default is `1000`.
    // `callback` is optional and is a function to be called once the token reaches the target.
    sendToken: function(token, duration, callback) {

        duration = duration || 1000;

        V(this.paper.viewport).append(token);
        V(token).animateAlongPath({ dur: duration + 'ms', repeatCount: 1 }, this._V.connection.node);
        _.delay(function() { V(token).remove(); callback && callback(); }, duration);
    },

    findRoute: function(oldVertices) {

        var namespace = joint.routers;
        var router = this.model.get('router');
        var defaultRouter = this.paper.options.defaultRouter;

        if (!router) {

            if (this.model.get('manhattan')) {
                // backwards compability
                router = { name: 'orthogonal' };
            } else if (defaultRouter) {
                router = defaultRouter;
            } else {
                return oldVertices;
            }
        }

        var args = router.args || {};
        var routerFn = _.isFunction(router) ? router : namespace[router.name];

        if (!_.isFunction(routerFn)) {
            throw new Error('unknown router: "' + router.name + '"');
        }

        var newVertices = routerFn.call(this, oldVertices || [], args, this);

        return newVertices;
    },

    // Return the `d` attribute value of the `<path>` element representing the link
    // between `source` and `target`.
    getPathData: function(vertices) {

        var namespace = joint.connectors;
        var connector = this.model.get('connector');
        var defaultConnector = this.paper.options.defaultConnector;

        if (!connector) {

            // backwards compability
            if (this.model.get('smooth')) {
                connector = { name: 'smooth' };
            } else {
                connector = defaultConnector || {};
            }
        }

        var connectorFn = _.isFunction(connector) ? connector : namespace[connector.name];
        var args = connector.args || {};

        if (!_.isFunction(connectorFn)) {
            throw new Error('unknown connector: "' + connector.name + '"');
        }

        var pathData = connectorFn.call(
            this,
            this._markerCache.sourcePoint, // Note that the value is translated by the size
            this._markerCache.targetPoint, // of the marker. (We'r not using this.sourcePoint)
            vertices || (this.model.get('vertices') || {}),
            args, // options
            this
        );

        return pathData;
    },

    // Find a point that is the start of the connection.
    // If `selectorOrPoint` is a point, then we're done and that point is the start of the connection.
    // If the `selectorOrPoint` is an element however, we need to know a reference point (or element)
    // that the link leads to in order to determine the start of the connection on the original element.
    getConnectionPoint: function(end, selectorOrPoint, referenceSelectorOrPoint) {

        var spot;

        // If the `selectorOrPoint` (or `referenceSelectorOrPoint`) is `undefined`, the `source`/`target` of the link model is `undefined`.
        // We want to allow this however so that one can create links such as `var link = new joint.dia.Link` and
        // set the `source`/`target` later.
        _.isEmpty(selectorOrPoint) && (selectorOrPoint = { x: 0, y: 0 });
        _.isEmpty(referenceSelectorOrPoint) && (referenceSelectorOrPoint = { x: 0, y: 0 });

        if (!selectorOrPoint.id) {

            // If the source is a point, we don't need a reference point to find the sticky point of connection.
            spot = g.Point(selectorOrPoint);

        } else {

            // If the source is an element, we need to find a point on the element boundary that is closest
            // to the reference point (or reference element).
            // Get the bounding box of the spot relative to the paper viewport. This is necessary
            // in order to follow paper viewport transformations (scale/rotate).
            // `_sourceBbox` (`_targetBbox`) comes from `_sourceBboxUpdate` (`_sourceBboxUpdate`)
            // method, it exists since first render and are automatically updated
            var spotBBox = g.Rect(end === 'source' ? this.sourceBBox : this.targetBBox);

            var reference;

            if (!referenceSelectorOrPoint.id) {

                // Reference was passed as a point, therefore, we're ready to find the sticky point of connection on the source element.
                reference = g.Point(referenceSelectorOrPoint);

            } else {

                // Reference was passed as an element, therefore we need to find a point on the reference
                // element boundary closest to the source element.
                // Get the bounding box of the spot relative to the paper viewport. This is necessary
                // in order to follow paper viewport transformations (scale/rotate).
                var referenceBBox = g.Rect(end === 'source' ? this.targetBBox : this.sourceBBox);

                reference = referenceBBox.intersectionWithLineFromCenterToPoint(spotBBox.center());
                reference = reference || referenceBBox.center();
            }

            var paperOptions = this.paper.options;
            // If `perpendicularLinks` flag is set on the paper and there are vertices
            // on the link, then try to find a connection point that makes the link perpendicular
            // even though the link won't point to the center of the targeted object.
            if (paperOptions.perpendicularLinks || this.options.perpendicular) {

                var nearestSide;
                var spotOrigin = spotBBox.origin();
                var spotCorner = spotBBox.corner();

                if (spotOrigin.y <= reference.y && reference.y <= spotCorner.y) {

                    nearestSide = spotBBox.sideNearestToPoint(reference);
                    switch (nearestSide) {
                        case 'left':
                            spot = g.Point(spotOrigin.x, reference.y);
                            break;
                        case 'right':
                            spot = g.Point(spotCorner.x, reference.y);
                            break;
                        default:
                            spot = spotBBox.center();
                            break;
                    }

                } else if (spotOrigin.x <= reference.x && reference.x <= spotCorner.x) {

                    nearestSide = spotBBox.sideNearestToPoint(reference);
                    switch (nearestSide) {
                        case 'top':
                            spot = g.Point(reference.x, spotOrigin.y);
                            break;
                        case 'bottom':
                            spot = g.Point(reference.x, spotCorner.y);
                            break;
                        default:
                            spot = spotBBox.center();
                            break;
                    }

                } else {

                    // If there is no intersection horizontally or vertically with the object bounding box,
                    // then we fall back to the regular situation finding straight line (not perpendicular)
                    // between the object and the reference point.
                    spot = spotBBox.intersectionWithLineFromCenterToPoint(reference);
                    spot = spot || spotBBox.center();
                }

            } else if (paperOptions.linkConnectionPoint) {

                var view = end === 'target' ? this.targetView : this.sourceView;
                var magnet = end === 'target' ? this.targetMagnet : this.sourceMagnet;

                spot = paperOptions.linkConnectionPoint(this, view, magnet, reference);

            } else {

                spot = spotBBox.intersectionWithLineFromCenterToPoint(reference);
                spot = spot || spotBBox.center();
            }
        }

        return spot;
    },

    // Public API
    // ----------

    getConnectionLength: function() {

        return this._V.connection.node.getTotalLength();
    },

    getPointAtLength: function(length) {

        return this._V.connection.node.getPointAtLength(length);
    },

    // Interaction. The controller part.
    // ---------------------------------

    _beforeArrowheadMove: function() {

        this._z = this.model.get('z');
        this.model.toFront();

        // Let the pointer propagate throught the link view elements so that
        // the `evt.target` is another element under the pointer, not the link itself.
        this.el.style.pointerEvents = 'none';

        if (this.paper.options.markAvailable) {
            this._markAvailableMagnets();
        }
    },

    _afterArrowheadMove: function() {

        if (!_.isNull(this._z)) {
            this.model.set('z', this._z, { ui: true });
            this._z = null;
        }

        // Put `pointer-events` back to its original value. See `startArrowheadMove()` for explanation.
        // Value `auto` doesn't work in IE9. We force to use `visiblePainted` instead.
        // See `https://developer.mozilla.org/en-US/docs/Web/CSS/pointer-events`.
        this.el.style.pointerEvents = 'visiblePainted';

        if (this.paper.options.markAvailable) {
            this._unmarkAvailableMagnets();
        }
    },

    _createValidateConnectionArgs: function(arrowhead) {
        // It makes sure the arguments for validateConnection have the following form:
        // (source view, source magnet, target view, target magnet and link view)
        var args = [];

        args[4] = arrowhead;
        args[5] = this;

        var oppositeArrowhead;
        var i = 0;
        var j = 0;

        if (arrowhead === 'source') {
            i = 2;
            oppositeArrowhead = 'target';
        } else {
            j = 2;
            oppositeArrowhead = 'source';
        }

        var end = this.model.get(oppositeArrowhead);

        if (end.id) {
            args[i] = this.paper.findViewByModel(end.id);
            args[i + 1] = end.selector && args[i].el.querySelector(end.selector);
        }

        function validateConnectionArgs(cellView, magnet) {
            args[j] = cellView;
            args[j + 1] = cellView.el === magnet ? undefined : magnet;
            return args;
        }

        return validateConnectionArgs;
    },

    _markAvailableMagnets: function() {

        function isMagnetAvailable(view, magnet) {
            var paper = view.paper;
            var validate = paper.options.validateConnection;
            return validate.apply(paper, this._validateConnectionArgs(view, magnet));
        }

        var paper = this.paper;
        var elements = paper.model.getElements();
        this._marked = {};

        _.chain(elements).map(paper.findViewByModel, paper).each(function(view) {

            var magnets = Array.prototype.slice.call(view.el.querySelectorAll('[magnet]'));
            if (view.el.getAttribute('magnet') !== 'false') {
                // Element wrapping group is also a magnet
                magnets.push(view.el);
            }

            var availableMagnets = _.filter(magnets, _.partial(isMagnetAvailable, view), this);
            if (availableMagnets.length > 0) {
                // highlight all available magnets
                _.each(availableMagnets, _.partial(view.highlight, _, { magnetAvailability: true }), view);
                // highlight the entire view
                view.highlight(null, { elementAvailability: true });

                this._marked[view.model.id] = availableMagnets;
            }

        }, this).value();
    },

    _unmarkAvailableMagnets: function() {

        _.each(this._marked, function(markedMagnets, id) {
            var view = this.paper.findViewByModel(id);
            if (view) {
                _.each(markedMagnets, _.partial(view.unhighlight, _, { magnetAvailability: true }), view);
                view.unhighlight(null, { elementAvailability: true });
            }
        }, this);

        this._marked = null;
    },

    startArrowheadMove: function(end, opt) {

        opt = _.defaults(opt || {}, { whenNotAllowed: 'revert' });
        // Allow to delegate events from an another view to this linkView in order to trigger arrowhead
        // move without need to click on the actual arrowhead dom element.
        this._action = 'arrowhead-move';
        this._whenNotAllowed = opt.whenNotAllowed;
        this._arrowhead = end;
        this._initialMagnet = this[end + 'Magnet'] || (this[end + 'View'] ? this[end + 'View'].el : null);
        this._initialEnd = _.clone(this.model.get(end)) || { x: 0, y: 0 };
        this._validateConnectionArgs = this._createValidateConnectionArgs(this._arrowhead);
        this._beforeArrowheadMove();
    },

    pointerdown: function(evt, x, y) {

        joint.dia.CellView.prototype.pointerdown.apply(this, arguments);
        this.notify('link:pointerdown', evt, x, y);

        this._dx = x;
        this._dy = y;

        // if are simulating pointerdown on a link during a magnet click, skip link interactions
        if (evt.target.getAttribute('magnet') != null) return;

        var className = joint.util.removeClassNamePrefix(evt.target.getAttribute('class'));
        var parentClassName = joint.util.removeClassNamePrefix(evt.target.parentNode.getAttribute('class'));
        var labelNode;
        if (parentClassName === 'label') {
            className = parentClassName;
            labelNode = evt.target.parentNode;
        } else {
            labelNode = evt.target;
        }

        switch (className) {

            case 'marker-vertex':
                if (this.can('vertexMove')) {
                    this._action = 'vertex-move';
                    this._vertexIdx = evt.target.getAttribute('idx');
                }
                break;

            case 'marker-vertex-remove':
            case 'marker-vertex-remove-area':
                if (this.can('vertexRemove')) {
                    this.removeVertex(evt.target.getAttribute('idx'));
                }
                break;

            case 'marker-arrowhead':
                if (this.can('arrowheadMove')) {
                    this.startArrowheadMove(evt.target.getAttribute('end'));
                }
                break;

            case 'label':
                if (this.can('labelMove')) {
                    this._action = 'label-move';
                    this._labelIdx = parseInt(V(labelNode).attr('label-idx'), 10);
                    // Precalculate samples so that we don't have to do that
                    // over and over again while dragging the label.
                    this._samples = this._V.connection.sample(1);
                    this._linkLength = this._V.connection.node.getTotalLength();
                }
                break;

            default:

                var targetParentEvent = evt.target.parentNode.getAttribute('event');
                if (targetParentEvent) {
                    if (this.can('useLinkTools')) {
                        // `remove` event is built-in. Other custom events are triggered on the paper.
                        if (targetParentEvent === 'remove') {
                            this.model.remove();
                        } else {
                            this.notify(targetParentEvent, evt, x, y);
                        }
                    }
                } else {
                    if (this.can('vertexAdd')) {

                        // Store the index at which the new vertex has just been placed.
                        // We'll be update the very same vertex position in `pointermove()`.
                        this._vertexIdx = this.addVertex({ x: x, y: y });
                        this._action = 'vertex-move';
                    }
                }
        }
    },

    pointermove: function(evt, x, y) {

        switch (this._action) {

            case 'vertex-move':

                var vertices = _.clone(this.model.get('vertices'));
                vertices[this._vertexIdx] = { x: x, y: y };
                this.model.set('vertices', vertices, { ui: true });
                break;

            case 'label-move':

                var dragPoint = { x: x, y: y };
                var samples = this._samples;
                var minSqDistance = Infinity;
                var closestSample;
                var closestSampleIndex;
                var p;
                var sqDistance;
                for (var i = 0, len = samples.length; i < len; i++) {
                    p = samples[i];
                    sqDistance = g.line(p, dragPoint).squaredLength();
                    if (sqDistance < minSqDistance) {
                        minSqDistance = sqDistance;
                        closestSample = p;
                        closestSampleIndex = i;
                    }
                }
                var prevSample = samples[closestSampleIndex - 1];
                var nextSample = samples[closestSampleIndex + 1];
                var offset = 0;
                if (prevSample && nextSample) {
                    offset = g.line(prevSample, nextSample).pointOffset(dragPoint);
                } else if (prevSample) {
                    offset = g.line(prevSample, closestSample).pointOffset(dragPoint);
                } else if (nextSample) {
                    offset = g.line(closestSample, nextSample).pointOffset(dragPoint);
                }

                this.model.label(this._labelIdx, {
                    position: {
                        distance: closestSample.distance / this._linkLength,
                        offset: offset
                    }
                });
                break;

            case 'arrowhead-move':

                if (this.paper.options.snapLinks) {

                    // checking view in close area of the pointer

                    var r = this.paper.options.snapLinks.radius || 50;
                    var viewsInArea = this.paper.findViewsInArea({ x: x - r, y: y - r, width: 2 * r, height: 2 * r });

                    if (this._closestView) {
                        this._closestView.unhighlight(this._closestEnd.selector, {
                            connecting: true,
                            snapping: true
                        });
                    }
                    this._closestView = this._closestEnd = null;

                    var distance;
                    var minDistance = Number.MAX_VALUE;
                    var pointer = g.point(x, y);

                    _.each(viewsInArea, function(view) {

                        // skip connecting to the element in case '.': { magnet: false } attribute present
                        if (view.el.getAttribute('magnet') !== 'false') {

                            // find distance from the center of the model to pointer coordinates
                            distance = view.model.getBBox().center().distance(pointer);

                            // the connection is looked up in a circle area by `distance < r`
                            if (distance < r && distance < minDistance) {

                                if (this.paper.options.validateConnection.apply(
                                    this.paper, this._validateConnectionArgs(view, null)
                                )) {
                                    minDistance = distance;
                                    this._closestView = view;
                                    this._closestEnd = { id: view.model.id };
                                }
                            }
                        }

                        view.$('[magnet]').each(_.bind(function(index, magnet) {

                            var bbox = V(magnet).bbox(false, this.paper.viewport);

                            distance = pointer.distance({
                                x: bbox.x + bbox.width / 2,
                                y: bbox.y + bbox.height / 2
                            });

                            if (distance < r && distance < minDistance) {

                                if (this.paper.options.validateConnection.apply(
                                    this.paper, this._validateConnectionArgs(view, magnet)
                                )) {
                                    minDistance = distance;
                                    this._closestView = view;
                                    this._closestEnd = {
                                        id: view.model.id,
                                        selector: view.getSelector(magnet),
                                        port: magnet.getAttribute('port')
                                    };
                                }
                            }

                        }, this));

                    }, this);

                    if (this._closestView) {
                        this._closestView.highlight(this._closestEnd.selector, {
                            connecting: true,
                            snapping: true
                        });
                    }

                    this.model.set(this._arrowhead, this._closestEnd || { x: x, y: y }, { ui: true });

                } else {

                    // checking views right under the pointer

                    // Touchmove event's target is not reflecting the element under the coordinates as mousemove does.
                    // It holds the element when a touchstart triggered.
                    var target = (evt.type === 'mousemove')
                        ? evt.target
                        : document.elementFromPoint(evt.clientX, evt.clientY);

                    if (this._targetEvent !== target) {
                        // Unhighlight the previous view under pointer if there was one.
                        if (this._magnetUnderPointer) {
                            this._viewUnderPointer.unhighlight(this._magnetUnderPointer, {
                                connecting: true
                            });
                        }

                        this._viewUnderPointer = this.paper.findView(target);
                        if (this._viewUnderPointer) {
                            // If we found a view that is under the pointer, we need to find the closest
                            // magnet based on the real target element of the event.
                            this._magnetUnderPointer = this._viewUnderPointer.findMagnet(target);

                            if (this._magnetUnderPointer && this.paper.options.validateConnection.apply(
                                this.paper,
                                this._validateConnectionArgs(this._viewUnderPointer, this._magnetUnderPointer)
                            )) {
                                // If there was no magnet found, do not highlight anything and assume there
                                // is no view under pointer we're interested in reconnecting to.
                                // This can only happen if the overall element has the attribute `'.': { magnet: false }`.
                                if (this._magnetUnderPointer) {
                                    this._viewUnderPointer.highlight(this._magnetUnderPointer, {
                                        connecting: true
                                    });
                                }
                            } else {
                                // This type of connection is not valid. Disregard this magnet.
                                this._magnetUnderPointer = null;
                            }
                        } else {
                            // Make sure we'll unset previous magnet.
                            this._magnetUnderPointer = null;
                        }
                    }

                    this._targetEvent = target;

                    this.model.set(this._arrowhead, { x: x, y: y }, { ui: true });
                }
                break;
        }

        this._dx = x;
        this._dy = y;

        joint.dia.CellView.prototype.pointermove.apply(this, arguments);
        this.notify('link:pointermove', evt, x, y);
    },

    pointerup: function(evt, x, y) {

        if (this._action === 'label-move') {

            this._samples = null;

        } else if (this._action === 'arrowhead-move') {

            var paper = this.paper;
            var paperOptions = paper.options;
            var arrowhead = this._arrowhead;
            var initialEnd = this._initialEnd;
            var magnetUnderPointer;

            if (paperOptions.snapLinks) {

                // Finish off link snapping.
                // Everything except view unhighlighting was already done on pointermove.
                if (this._closestView) {
                    this._closestView.unhighlight(this._closestEnd.selector, {
                        connecting: true,
                        snapping: true
                    });

                    magnetUnderPointer = this._closestView.findMagnet(this._closestEnd.selector);
                }

                this._closestView = this._closestEnd = null;

            } else {

                var viewUnderPointer = this._viewUnderPointer;
                magnetUnderPointer = this._magnetUnderPointer;

                this._viewUnderPointer = null;
                this._magnetUnderPointer = null;

                if (magnetUnderPointer) {

                    viewUnderPointer.unhighlight(magnetUnderPointer, { connecting: true });
                    // Find a unique `selector` of the element under pointer that is a magnet. If the
                    // `this._magnetUnderPointer` is the root element of the `this._viewUnderPointer` itself,
                    // the returned `selector` will be `undefined`. That means we can directly pass it to the
                    // `source`/`target` attribute of the link model below.
                    var selector = viewUnderPointer.getSelector(magnetUnderPointer);
                    var port = magnetUnderPointer.getAttribute('port');
                    var arrowheadValue = { id: viewUnderPointer.model.id };
                    if (port != null) arrowheadValue.port = port;
                    if (selector != null) arrowheadValue.selector = selector;
                    this.model.set(arrowhead, arrowheadValue, { ui: true });
                }
            }

            // If the changed link is not allowed, revert to its previous state.
            if (!paper.linkAllowed(this)) {

                switch (this._whenNotAllowed) {

                    case 'remove':
                        this.model.remove();
                        break;

                    case 'revert':
                    default:
                        this.model.set(arrowhead, initialEnd, { ui: true });
                        break;
                }
            }

            // Reparent the link if embedding is enabled
            if (paperOptions.embeddingMode && this.model.reparent()) {
                // Make sure we don't reverse to the original 'z' index (see afterArrowheadMove()).
                this._z = null;
            }

            var currentEnd = this.model.prop(arrowhead) || {};
            var endChanged = !joint.dia.Link.endsEqual(initialEnd, currentEnd);

            if (endChanged) {

                if (initialEnd.id) {
                    this.notify('link:disconnect', evt, paper.findViewByModel(initialEnd.id), this._initialMagnet, arrowhead);
                }
                if (currentEnd.id) {
                    this.notify('link:connect', evt, paper.findViewByModel(currentEnd.id), magnetUnderPointer, arrowhead);
                }
            }

            this._afterArrowheadMove();
        }

        this._action = null;
        this._whenNotAllowed = null;
        this._initialMagnet = null;
        this._initialEnd = null;
        this._validateConnectionArgs = null;

        this.notify('link:pointerup', evt, x, y);
        joint.dia.CellView.prototype.pointerup.apply(this, arguments);
    },

    mouseenter: function(evt) {

        joint.dia.CellView.prototype.mouseenter.apply(this, arguments);
        this.notify('link:mouseenter', evt);
    },

    mouseleave: function(evt) {

        joint.dia.CellView.prototype.mouseleave.apply(this, arguments);
        this.notify('link:mouseleave', evt);
    }

}, {

    makeSelector: function(end) {

        var selector = '[model-id="' + end.id + '"]';
        // `port` has a higher precendence over `selector`. This is because the selector to the magnet
        // might change while the name of the port can stay the same.
        if (end.port) {
            selector += ' [port="' + end.port + '"]';
        } else if (end.selector) {
            selector += ' ' + end.selector;
        }

        return selector;
    }

});


joint.dia.Paper = joint.mvc.View.extend({

    className: 'paper',

    options: {

        width: 800,
        height: 600,
        origin: { x: 0, y: 0 }, // x,y coordinates in top-left corner
        gridSize: 1,

        // Whether or not to draw the grid lines on the paper's DOM element.
        // e.g drawGrid: true, drawGrid: { color: 'red', thickness: 2 }
        drawGrid: false,

        // Whether or not to draw the background on the paper's DOM element.
        // e.g. background: { color: 'lightblue', image: '/paper-background.png', repeat: 'flip-xy' }
        background: false,

        perpendicularLinks: false,
        elementView: joint.dia.ElementView,
        linkView: joint.dia.LinkView,
        snapLinks: false, // false, true, { radius: value }

        // When set to FALSE, an element may not have more than 1 link with the same source and target element.
        multiLinks: true,

        // For adding custom guard logic.
        guard: function(evt, view) {

            // FALSE means the event isn't guarded.
            return false;
        },

        highlighting: {
            'default': {
                name: 'stroke',
                options: {
                    padding: 3
                }
            },
            magnetAvailability: {
                name: 'addClass',
                options: {
                    className: 'available-magnet'
                }
            },
            elementAvailability: {
                name: 'addClass',
                options: {
                    className: 'available-cell'
                }
            }
        },

        // Prevent the default context menu from being displayed.
        preventContextMenu: true,

        // Restrict the translation of elements by given bounding box.
        // Option accepts a boolean:
        //  true - the translation is restricted to the paper area
        //  false - no restrictions
        // A method:
        // restrictTranslate: function(elementView) {
        //     var parentId = elementView.model.get('parent');
        //     return parentId && this.model.getCell(parentId).getBBox();
        // },
        // Or a bounding box:
        // restrictTranslate: { x: 10, y: 10, width: 790, height: 590 }
        restrictTranslate: false,
        // Marks all available magnets with 'available-magnet' class name and all available cells with
        // 'available-cell' class name. Marks them when dragging a link is started and unmark
        // when the dragging is stopped.
        markAvailable: false,

        // Defines what link model is added to the graph after an user clicks on an active magnet.
        // Value could be the Backbone.model or a function returning the Backbone.model
        // defaultLink: function(elementView, magnet) { return condition ? new customLink1() : new customLink2() }
        defaultLink: new joint.dia.Link,

        // A connector that is used by links with no connector defined on the model.
        // e.g. { name: 'rounded', args: { radius: 5 }} or a function
        defaultConnector: { name: 'normal' },

        // A router that is used by links with no router defined on the model.
        // e.g. { name: 'oneSide', args: { padding: 10 }} or a function
        defaultRouter: { name: 'normal' },

        /* CONNECTING */

        // Check whether to add a new link to the graph when user clicks on an a magnet.
        validateMagnet: function(cellView, magnet) {
            return magnet.getAttribute('magnet') !== 'passive';
        },

        // Check whether to allow or disallow the link connection while an arrowhead end (source/target)
        // being changed.
        validateConnection: function(cellViewS, magnetS, cellViewT, magnetT, end, linkView) {
            return (end === 'target' ? cellViewT : cellViewS) instanceof joint.dia.ElementView;
        },

        /* EMBEDDING */

        // Enables embedding. Reparents the dragged element with elements under it and makes sure that
        // all links and elements are visible taken the level of embedding into account.
        embeddingMode: false,

        // Check whether to allow or disallow the element embedding while an element being translated.
        validateEmbedding: function(childView, parentView) {
            // by default all elements can be in relation child-parent
            return true;
        },

        // Determines the way how a cell finds a suitable parent when it's dragged over the paper.
        // The cell with the highest z-index (visually on the top) will be choosen.
        findParentBy: 'bbox', // 'bbox'|'center'|'origin'|'corner'|'topRight'|'bottomLeft'

        // If enabled only the element on the very front is taken into account for the embedding.
        // If disabled the elements under the dragged view are tested one by one
        // (from front to back) until a valid parent found.
        frontParentOnly: true,

        // Interactive flags. See online docs for the complete list of interactive flags.
        interactive: {
            labelMove: false
        },

        // When set to true the links can be pinned to the paper.
        // i.e. link source/target can be a point e.g. link.get('source') ==> { x: 100, y: 100 };
        linkPinning: true,

        // Allowed number of mousemove events after which the pointerclick event will be still triggered.
        clickThreshold: 0,

        // The namespace, where all the cell views are defined.
        cellViewNamespace: joint.shapes,

        // The namespace, where all the cell views are defined.
        highlighterNamespace: joint.highlighters
    },

    events: {

        'mousedown': 'pointerdown',
        'dblclick': 'mousedblclick',
        'click': 'mouseclick',
        'touchstart': 'pointerdown',
        'touchend': 'mouseclick',
        'touchmove': 'pointermove',
        'mousemove': 'pointermove',
        'mouseover .joint-cell': 'cellMouseover',
        'mouseout .joint-cell': 'cellMouseout',
        'contextmenu': 'contextmenu',
        'mousewheel': 'mousewheel',
        'DOMMouseScroll': 'mousewheel',
        'mouseenter .joint-cell': 'cellMouseenter',
        'mouseleave .joint-cell': 'cellMouseleave'
    },

    _highlights: {},

    init: function() {

        _.bindAll(this, 'pointerup');

        var model = this.model = this.options.model || new joint.dia.Graph;

        this.setGrid(this.options.drawGrid);
        this.cloneOptions();
        this.render();
        this.setDimensions();

        this.listenTo(model, 'add', this.onCellAdded)
            .listenTo(model, 'remove', this.removeView)
            .listenTo(model, 'reset', this.resetViews)
            .listenTo(model, 'sort', this._onSort)
            .listenTo(model, 'batch:stop', this._onBatchStop);

        this.on('cell:highlight', this.onCellHighlight)
            .on('cell:unhighlight', this.onCellUnhighlight)
            .on('scale translate', this.update);

        // Hold the value when mouse has been moved: when mouse moved, no click event will be triggered.
        this._mousemoved = 0;
        // Hash of all cell views.
        this._views = {};
        // Reference to the paper owner document
        this.$document = $(this.el.ownerDocument);
    },

    cloneOptions: function() {

        var options = this.options;

        // This is a fix for the case where two papers share the same options.
        // Changing origin.x for one paper would change the value of origin.x for the other.
        // This prevents that behavior.
        options.origin = _.clone(options.origin);
        options.defaultConnector = _.clone(options.defaultConnector);
        // Return the default highlighting options into the user specified options.
        options.highlighting = _.defaultsDeep(
            {},
            options.highlighting,
            this.constructor.prototype.options.highlighting
        );
    },

    bindDocumentEvents: function() {
        var eventNS = this.getEventNamespace();
        this.$document.on('mouseup' + eventNS + ' touchend' + eventNS, this.pointerup);
    },

    unbindDocumentEvents: function() {
        this.$document.off(this.getEventNamespace());
    },

    render: function() {

        this.svg = V('svg').attr({ width: '100%', height: '100%' }).node;
        this.viewport = V('g').addClass(joint.util.addClassNamePrefix('viewport')).node;
        this.defs = V('defs').node;

        // Append `<defs>` element to the SVG document. This is useful for filters and gradients.
        V(this.svg).append([this.viewport, this.defs]);

        this.$el.append(this.$background, this.$grid, this.svg);

        return this;
    },

    update: function() {

        if (this.options.drawGrid) {
            this.drawGrid();
        }

        if (this._background) {
            this.updateBackgroundImage(this._background);
        }
    },

    // For storing the current transformation matrix (CTM) of the paper's viewport.
    _viewportMatrix: null,
    // For verifying whether the CTM is up-to-date. The viewport transform attribute
    // could have been manipulated directly.
    _viewportTransformString: null,

    matrix: function(ctm) {

        var viewport = this.viewport;

        // Getter:
        if (ctm === undefined) {

            var transformString = viewport.getAttribute('transform');

            if ((this._viewportTransformString || null) === transformString) {
                // It's ok to return the cached matrix. The transform attribute has not changed since
                // the matrix was stored.
                ctm = this._viewportMatrix;
            } else {
                // The viewport transform attribute has changed. Measure the matrix and cache again.
                ctm = viewport.getCTM();
                this._viewportMatrix = ctm;
                this._viewportTransformString = transformString;
            }

            // Clone the cached current transformation matrix.
            // If no matrix previously stored the identity matrix is returned.
            return V.createSVGMatrix(ctm);
        }

        // Setter:
        ctm = V.createSVGMatrix(ctm);
        V(viewport).transform(ctm, { absolute: true });
        this._viewportMatrix = ctm;
        this._viewportTransformString = viewport.getAttribute('transform');

        return this;
    },

    clientMatrix: function() {

        return V.createSVGMatrix(this.viewport.getScreenCTM());
    },

    _onSort: function() {
        if (!this.model.hasActiveBatch('add')) {
            this.sortViews();
        }
    },

    _onBatchStop: function(data) {
        var name = data && data.batchName;
        if (name === 'add' && !this.model.hasActiveBatch('add')) {
            this.sortViews();
        }
    },

    onRemove: function() {

        //clean up all DOM elements/views to prevent memory leaks
        this.removeViews();
        this.unbindDocumentEvents();
    },

    setDimensions: function(width, height) {

        width = this.options.width = width || this.options.width;
        height = this.options.height = height || this.options.height;

        this.$el.css({
            width: Math.round(width),
            height: Math.round(height)
        });

        this.trigger('resize', width, height);
    },

    setOrigin: function(ox, oy) {

        return this.translate(ox || 0, oy || 0, { absolute: true });
    },

    // Expand/shrink the paper to fit the content. Snap the width/height to the grid
    // defined in `gridWidth`, `gridHeight`. `padding` adds to the resulting width/height of the paper.
    // When options { fitNegative: true } it also translates the viewport in order to make all
    // the content visible.
    fitToContent: function(gridWidth, gridHeight, padding, opt) { // alternatively function(opt)

        if (_.isObject(gridWidth)) {
            // first parameter is an option object
            opt = gridWidth;
            gridWidth = opt.gridWidth || 1;
            gridHeight = opt.gridHeight || 1;
            padding = opt.padding || 0;

        } else {

            opt = opt || {};
            gridWidth = gridWidth || 1;
            gridHeight = gridHeight || 1;
            padding = padding || 0;
        }

        padding = joint.util.normalizeSides(padding);

        // Calculate the paper size to accomodate all the graph's elements.
        var bbox = V(this.viewport).bbox(true, this.svg);

        var currentScale = this.scale();
        var currentTranslate = this.translate();

        bbox.x *= currentScale.sx;
        bbox.y *= currentScale.sy;
        bbox.width *= currentScale.sx;
        bbox.height *= currentScale.sy;

        var calcWidth = Math.max(Math.ceil((bbox.width + bbox.x) / gridWidth), 1) * gridWidth;
        var calcHeight = Math.max(Math.ceil((bbox.height + bbox.y) / gridHeight), 1) * gridHeight;

        var tx = 0;
        var ty = 0;

        if ((opt.allowNewOrigin == 'negative' && bbox.x < 0) || (opt.allowNewOrigin == 'positive' && bbox.x >= 0) || opt.allowNewOrigin == 'any') {
            tx = Math.ceil(-bbox.x / gridWidth) * gridWidth;
            tx += padding.left;
            calcWidth += tx;
        }

        if ((opt.allowNewOrigin == 'negative' && bbox.y < 0) || (opt.allowNewOrigin == 'positive' && bbox.y >= 0) || opt.allowNewOrigin == 'any') {
            ty = Math.ceil(-bbox.y / gridHeight) * gridHeight;
            ty += padding.top;
            calcHeight += ty;
        }

        calcWidth += padding.right;
        calcHeight += padding.bottom;

        // Make sure the resulting width and height are greater than minimum.
        calcWidth = Math.max(calcWidth, opt.minWidth || 0);
        calcHeight = Math.max(calcHeight, opt.minHeight || 0);

        // Make sure the resulting width and height are lesser than maximum.
        calcWidth = Math.min(calcWidth, opt.maxWidth || Number.MAX_VALUE);
        calcHeight = Math.min(calcHeight, opt.maxHeight || Number.MAX_VALUE);

        var dimensionChange = calcWidth != this.options.width || calcHeight != this.options.height;
        var originChange = tx != currentTranslate.tx || ty != currentTranslate.ty;

        // Change the dimensions only if there is a size discrepency or an origin change
        if (originChange) {
            this.translate(tx, ty);
        }
        if (dimensionChange) {
            this.setDimensions(calcWidth, calcHeight);
        }
    },

    scaleContentToFit: function(opt) {

        var contentBBox = this.getContentBBox();

        if (!contentBBox.width || !contentBBox.height) return;

        opt = opt || {};

        _.defaults(opt, {
            padding: 0,
            preserveAspectRatio: true,
            scaleGrid: null,
            minScale: 0,
            maxScale: Number.MAX_VALUE
            //minScaleX
            //minScaleY
            //maxScaleX
            //maxScaleY
            //fittingBBox
        });

        var padding = opt.padding;

        var minScaleX = opt.minScaleX || opt.minScale;
        var maxScaleX = opt.maxScaleX || opt.maxScale;
        var minScaleY = opt.minScaleY || opt.minScale;
        var maxScaleY = opt.maxScaleY || opt.maxScale;

        var fittingBBox;
        if (opt.fittingBBox) {
            fittingBBox = opt.fittingBBox;
        } else {
            var currentTranslate = this.translate();
            fittingBBox = {
                x: currentTranslate.tx,
                y: currentTranslate.ty,
                width: this.options.width,
                height: this.options.height
            };
        }

        fittingBBox = g.rect(fittingBBox).moveAndExpand({
            x: padding,
            y: padding,
            width: -2 * padding,
            height: -2 * padding
        });

        var currentScale = this.scale();

        var newSx = fittingBBox.width / contentBBox.width * currentScale.sx;
        var newSy = fittingBBox.height / contentBBox.height * currentScale.sy;

        if (opt.preserveAspectRatio) {
            newSx = newSy = Math.min(newSx, newSy);
        }

        // snap scale to a grid
        if (opt.scaleGrid) {

            var gridSize = opt.scaleGrid;

            newSx = gridSize * Math.floor(newSx / gridSize);
            newSy = gridSize * Math.floor(newSy / gridSize);
        }

        // scale min/max boundaries
        newSx = Math.min(maxScaleX, Math.max(minScaleX, newSx));
        newSy = Math.min(maxScaleY, Math.max(minScaleY, newSy));

        this.scale(newSx, newSy);

        var contentTranslation = this.getContentBBox();

        var newOx = fittingBBox.x - contentTranslation.x;
        var newOy = fittingBBox.y - contentTranslation.y;

        this.translate(newOx, newOy);
    },

    getContentBBox: function() {

        var crect = this.viewport.getBoundingClientRect();

        // Using Screen CTM was the only way to get the real viewport bounding box working in both
        // Google Chrome and Firefox.
        var clientCTM = this.clientMatrix();

        // for non-default origin we need to take the viewport translation into account
        var currentTranslate = this.translate();

        return g.rect({
            x: crect.left - clientCTM.e + currentTranslate.tx,
            y: crect.top - clientCTM.f + currentTranslate.ty,
            width: crect.width,
            height: crect.height
        });
    },

    // Returns a geometry rectangle represeting the entire
    // paper area (coordinates from the left paper border to the right one
    // and the top border to the bottom one).
    getArea: function() {

        return this.paperToLocalRect({
            x: 0,
            y: 0,
            width: this.options.width,
            height: this.options.height
        });
    },

    getRestrictedArea: function() {

        var restrictedArea;

        if (_.isFunction(this.options.restrictTranslate)) {
            // A method returning a bounding box
            restrictedArea = this.options.restrictTranslate.apply(this, arguments);
        } else if (this.options.restrictTranslate === true) {
            // The paper area
            restrictedArea = this.getArea();
        } else {
            // Either false or a bounding box
            restrictedArea = this.options.restrictTranslate || null;
        }

        return restrictedArea;
    },

    createViewForModel: function(cell) {

        // A class taken from the paper options.
        var optionalViewClass;

        // A default basic class (either dia.ElementView or dia.LinkView)
        var defaultViewClass;

        // A special class defined for this model in the corresponding namespace.
        // e.g. joint.shapes.basic.Rect searches for joint.shapes.basic.RectView
        var namespace = this.options.cellViewNamespace;
        var type = cell.get('type') + 'View';
        var namespaceViewClass = joint.util.getByPath(namespace, type, '.');

        if (cell.isLink()) {
            optionalViewClass = this.options.linkView;
            defaultViewClass = joint.dia.LinkView;
        } else {
            optionalViewClass = this.options.elementView;
            defaultViewClass = joint.dia.ElementView;
        }

        // a) the paper options view is a class (deprecated)
        //  1. search the namespace for a view
        //  2. if no view was found, use view from the paper options
        // b) the paper options view is a function
        //  1. call the function from the paper options
        //  2. if no view was return, search the namespace for a view
        //  3. if no view was found, use the default
        var ViewClass = (optionalViewClass.prototype instanceof Backbone.View)
            ? namespaceViewClass || optionalViewClass
            : optionalViewClass.call(this, cell) || namespaceViewClass || defaultViewClass;

        return new ViewClass({
            model: cell,
            interactive: this.options.interactive
        });
    },

    onCellAdded: function(cell, graph, opt) {

        if (this.options.async && opt.async !== false && _.isNumber(opt.position)) {

            this._asyncCells = this._asyncCells || [];
            this._asyncCells.push(cell);

            if (opt.position == 0) {

                if (this._frameId) throw new Error('another asynchronous rendering in progress');

                this.asyncRenderViews(this._asyncCells, opt);
                delete this._asyncCells;
            }

        } else {

            this.renderView(cell);
        }
    },

    removeView: function(cell) {

        var view = this._views[cell.id];

        if (view) {
            view.remove();
            delete this._views[cell.id];
        }

        return view;
    },

    renderView: function(cell) {

        var view = this._views[cell.id] = this.createViewForModel(cell);

        V(this.viewport).append(view.el);
        view.paper = this;
        view.render();

        // This is the only way to prevent image dragging in Firefox that works.
        // Setting -moz-user-select: none, draggable="false" attribute or user-drag: none didn't help.
        $(view.el).find('image').on('dragstart', function() { return false; });

        return view;
    },

    beforeRenderViews: function(cells) {

        // Make sure links are always added AFTER elements.
        // They wouldn't find their sources/targets in the DOM otherwise.
        cells.sort(function(a) { return a instanceof joint.dia.Link ? 1 : -1; });

        return cells;
    },

    afterRenderViews: function() {

        this.sortViews();
    },

    resetViews: function(cellsCollection, opt) {

        // clearing views removes any event listeners
        this.removeViews();

        var cells = cellsCollection.models.slice();

        // `beforeRenderViews()` can return changed cells array (e.g sorted).
        cells = this.beforeRenderViews(cells, opt) || cells;

        if (this._frameId) {

            joint.util.cancelFrame(this._frameId);
            delete this._frameId;
        }

        if (this.options.async) {

            this.asyncRenderViews(cells, opt);
            // Sort the cells once all elements rendered (see asyncRenderViews()).

        } else {

            _.each(cells, this.renderView, this);

            // Sort the cells in the DOM manually as we might have changed the order they
            // were added to the DOM (see above).
            this.sortViews();
        }
    },

    removeViews: function() {

        _.invoke(this._views, 'remove');

        this._views = {};
    },

    asyncBatchAdded: _.noop,

    asyncRenderViews: function(cells, opt) {

        if (this._frameId) {

            var batchSize = (this.options.async && this.options.async.batchSize) || 50;
            var batchCells = cells.splice(0, batchSize);

            _.each(batchCells, function(cell) {

                // The cell has to be part of the graph.
                // There is a chance in asynchronous rendering
                // that a cell was removed before it's rendered to the paper.
                if (cell.graph === this.model) this.renderView(cell);

            }, this);

            this.asyncBatchAdded();
        }

        if (!cells.length) {

            // No cells left to render.
            delete this._frameId;
            this.afterRenderViews(opt);
            this.trigger('render:done', opt);

        } else {

            // Schedule a next batch to render.
            this._frameId = joint.util.nextFrame(function() {
                this.asyncRenderViews(cells, opt);
            }, this);
        }
    },

    sortViews: function() {

        // Run insertion sort algorithm in order to efficiently sort DOM elements according to their
        // associated model `z` attribute.

        var $cells = $(this.viewport).children('[model-id]');
        var cells = this.model.get('cells');

        joint.util.sortElements($cells, function(a, b) {

            var cellA = cells.get($(a).attr('model-id'));
            var cellB = cells.get($(b).attr('model-id'));

            return (cellA.get('z') || 0) > (cellB.get('z') || 0) ? 1 : -1;
        });
    },

    scale: function(sx, sy, ox, oy) {

        // getter
        if (sx === undefined) {
            return V.matrixToScale(this.matrix());
        }

        // setter
        if (sy === undefined) {
            sy = sx;
        }
        if (ox === undefined) {
            ox = 0;
            oy = 0;
        }

        var translate = this.translate();

        if (ox || oy || translate.tx || translate.ty) {
            var newTx = translate.tx - ox * (sx - 1);
            var newTy = translate.ty - oy * (sy - 1);
            this.translate(newTx, newTy);
        }

        var ctm = this.matrix();
        ctm.a = sx || 0;
        ctm.d = sy || 0;

        this.matrix(ctm);

        this.trigger('scale', sx, sy, ox, oy);

        return this;
    },

    // Experimental - do not use in production.
    rotate: function(angle, cx, cy) {

        // getter
        if (angle === undefined) {
            return V.matrixToRotate(this.matrix());
        }

        // setter

        // If the origin is not set explicitely, rotate around the center. Note that
        // we must use the plain bounding box (`this.el.getBBox()` instead of the one that gives us
        // the real bounding box (`bbox()`) including transformations).
        if (cx === undefined) {
            var bbox = this.viewport.getBBox();
            cx = bbox.width / 2;
            cy = bbox.height / 2;
        }

        var ctm = this.matrix().translate(cx,cy).rotate(angle).translate(-cx,-cy);
        this.matrix(ctm);

        return this;
    },

    translate: function(tx, ty) {

        // getter
        if (tx === undefined) {
            return V.matrixToTranslate(this.matrix());
        }

        // setter

        var ctm = this.matrix();
        ctm.e = tx || 0;
        ctm.f = ty || 0;

        this.matrix(ctm);

        var newTranslate = this.translate();
        var origin = this.options.origin;
        origin.x = newTranslate.tx;
        origin.y = newTranslate.ty;

        this.trigger('translate', newTranslate.tx, newTranslate.ty);

        if (this.options.drawGrid) {
            this.drawGrid();
        }

        return this;
    },

    // Find the first view climbing up the DOM tree starting at element `el`. Note that `el` can also
    // be a selector or a jQuery object.
    findView: function($el) {

        var el = _.isString($el)
            ? this.viewport.querySelector($el)
            : $el instanceof $ ? $el[0] : $el;

        while (el && el !== this.el && el !== document) {

            var id = el.getAttribute('model-id');
            if (id) return this._views[id];

            el = el.parentNode;
        }

        return undefined;
    },

    // Find a view for a model `cell`. `cell` can also be a string representing a model `id`.
    findViewByModel: function(cell) {

        var id = _.isString(cell) ? cell : cell.id;

        return this._views[id];
    },

    // Find all views at given point
    findViewsFromPoint: function(p) {

        p = g.point(p);

        var views = _.map(this.model.getElements(), this.findViewByModel, this);

        return _.filter(views, function(view) {
            return view && g.rect(view.vel.bbox(false, this.viewport)).containsPoint(p);
        }, this);
    },

    // Find all views in given area
    findViewsInArea: function(rect, opt) {

        opt = _.defaults(opt || {}, { strict: false });
        rect = g.rect(rect);

        var views = _.map(this.model.getElements(), this.findViewByModel, this);
        var method = opt.strict ? 'containsRect' : 'intersect';

        return _.filter(views, function(view) {
            return view && rect[method](g.rect(view.vel.bbox(false, this.viewport)));
        }, this);
    },

    getModelById: function(id) {

        return this.model.getCell(id);
    },

    snapToGrid: function(x, y) {

        // Convert global coordinates to the local ones of the `viewport`. Otherwise,
        // improper transformation would be applied when the viewport gets transformed (scaled/rotated).
        return this.clientToLocalPoint(x, y).snapToGrid(this.options.gridSize);
    },

    localToPaperPoint: function(x, y) {
        // allow `x` to be a point and `y` undefined
        var localPoint = g.Point(x, y);
        var paperPoint = V.transformPoint(localPoint, this.matrix());
        return g.Point(paperPoint);
    },

    localToPaperRect: function(x, y, width, height) {
        // allow `x` to be a rectangle and rest arguments undefined
        var localRect = g.Rect(x, y);
        var paperRect = V.transformRect(localRect, this.matrix());
        return g.Rect(paperRect);
    },

    paperToLocalPoint: function(x, y) {
        // allow `x` to be a point and `y` undefined
        var paperPoint = g.Point(x, y);
        var localPoint = V.transformPoint(paperPoint, this.matrix().inverse());
        return g.Point(localPoint);
    },

    paperToLocalRect: function(x, y, width, height) {
        // allow `x` to be a rectangle and rest arguments undefined
        var paperRect = g.Rect(x, y, width, height);
        var localRect = V.transformRect(paperRect, this.matrix().inverse());
        return g.Rect(localRect);
    },

    localToClientPoint: function(x, y) {
        // allow `x` to be a point and `y` undefined
        var localPoint = g.Point(x, y);
        var clientPoint = V.transformPoint(localPoint, this.clientMatrix());
        return g.Point(clientPoint);
    },

    localToClientRect: function(x, y, width, height) {
        // allow `x` to be a point and `y` undefined
        var localRect = g.Rect(x, y, width, height);
        var clientRect = V.transformRect(localRect, this.clientMatrix());
        return g.Rect(clientRect);
    },

    // Transform client coordinates to the paper local coordinates.
    // Useful when you have a mouse event object and you'd like to get coordinates
    // inside the paper that correspond to `evt.clientX` and `evt.clientY` point.
    // Example: var localPoint = paper.clientToLocalPoint({ x: evt.clientX, y: evt.clientY });
    clientToLocalPoint: function(x, y) {
        // allow `x` to be a point and `y` undefined
        var clientPoint = g.Point(x, y);
        var localPoint = V.transformPoint(clientPoint, this.clientMatrix().inverse());
        return g.Point(localPoint);
    },

    clientToLocalRect: function(x, y, width, height) {
        // allow `x` to be a point and `y` undefined
        var clientRect = g.Rect(x, y, width, height);
        var localRect = V.transformRect(clientRect, this.clientMatrix().inverse());
        return g.Rect(localRect);
    },

    localToPagePoint: function(x, y) {
        return this.localToPaperPoint(x, y).offset(this.pageOffset());
    },

    localToPageRect: function(x, y, width, height) {
        return this.localToPaperRect(x, y, width, height).moveAndExpand(this.pageOffset());
    },

    pageToLocalPoint: function(x, y) {
        var pagePoint = g.Point(x, y);
        var paperPoint = pagePoint.difference(this.pageOffset());
        return this.paperToLocalPoint(paperPoint);
    },

    pageToLocalRect: function(x, y, width, height) {
        var pageOffset = this.pageOffset();
        var paperRect = g.Rect(x, y, width, height);
        paperRect.x -= pageOffset.x;
        paperRect.y -= pageOffset.y;
        return this.paperToLocalRect(paperRect);
    },

    clientOffset: function() {
        var clientRect = this.svg.getBoundingClientRect();
        return g.Point(clientRect.left, clientRect.top);
    },

    pageOffset: function() {
        return this.clientOffset().offset(window.scrollX, window.scrollY);
    },

    linkAllowed: function(linkViewOrModel) {

        var link;

        if (linkViewOrModel instanceof joint.dia.Link) {
            link = linkViewOrModel;
        } else if (linkViewOrModel instanceof joint.dia.LinkView) {
            link = linkViewOrModel.model;
        } else {
            throw new Error('Must provide link model or view.');
        }

        if (!this.options.multiLinks) {

            // Do not allow multiple links to have the same source and target.

            var source = link.get('source');
            var target = link.get('target');

            if (source.id && target.id) {

                var sourceModel = link.getSourceElement();

                if (sourceModel) {

                    var connectedLinks = this.model.getConnectedLinks(sourceModel, {
                        outbound: true,
                        inbound: false
                    });

                    var numSameLinks = _.filter(connectedLinks, function(_link) {

                        var _source = _link.get('source');
                        var _target = _link.get('target');

                        return _source && _source.id === source.id &&
                                (!_source.port || (_source.port === source.port)) &&
                                _target && _target.id === target.id &&
                                (!_target.port || (_target.port === target.port));

                    }).length;

                    if (numSameLinks > 1) {
                        return false;
                    }
                }
            }
        }

        if (
            !this.options.linkPinning &&
            (
                !_.has(link.get('source'), 'id') ||
                !_.has(link.get('target'), 'id')
            )
        ) {
            // Link pinning is not allowed and the link is not connected to the target.
            return false;
        }

        return true;
    },

    getDefaultLink: function(cellView, magnet) {

        return _.isFunction(this.options.defaultLink)
        // default link is a function producing link model
            ? this.options.defaultLink.call(this, cellView, magnet)
        // default link is the Backbone model
            : this.options.defaultLink.clone();
    },

    // Cell highlighting
    // -----------------
    resolveHighlighter: function(opt) {

        opt = opt || {};
        var highlighterDef = opt.highlighter;
        var paperOpt = this.options;

        /*
            Expecting opt.highlighter to have the following structure:
            {
                name: 'highlighter-name',
                options: {
                    some: 'value'
                }
            }
        */
        if (_.isUndefined(highlighterDef)) {

            // check for built-in types
            var type = _.chain(opt)
                .pick('embedding', 'connecting', 'magnetAvailability', 'elementAvailability')
                .keys().first().value();

            highlighterDef = (type && paperOpt.highlighting[type]) || paperOpt.highlighting['default'];
        }

        // Do nothing if opt.highlighter is falsey.
        // This allows the case to not highlight cell(s) in certain cases.
        // For example, if you want to NOT highlight when embedding elements.
        if (!highlighterDef) return false;

        // Allow specifying a highlighter by name.
        if (_.isString(highlighterDef)) {
            highlighterDef = {
                name: highlighterDef
            };
        }

        var name = highlighterDef.name;
        var highlighter = paperOpt.highlighterNamespace[name];

        // Highlighter validation
        if (!highlighter) {
            throw new Error('Unknown highlighter ("' + name + '")');
        }
        if (typeof highlighter.highlight !== 'function') {
            throw new Error('Highlighter ("' + name + '") is missing required highlight() method');
        }
        if (typeof highlighter.unhighlight !== 'function') {
            throw new Error('Highlighter ("' + name + '") is missing required unhighlight() method');
        }

        return {
            highlighter: highlighter,
            options: highlighterDef.options || {},
            name: name
        };
    },

    onCellHighlight: function(cellView, magnetEl, opt) {

        opt = this.resolveHighlighter(opt);
        if (!opt) return;
        if (!magnetEl.id) {
            magnetEl.id = V.uniqueId();
        }

        var key = opt.name + magnetEl.id + JSON.stringify(opt.options);
        if (!this._highlights[key]) {

            var highlighter = opt.highlighter;
            highlighter.highlight(cellView, magnetEl, _.clone(opt.options));

            this._highlights[key] = {
                cellView: cellView,
                magnetEl: magnetEl,
                opt: opt.options,
                highlighter: highlighter
            };
        }
    },

    onCellUnhighlight: function(cellView, magnetEl, opt) {

        opt = this.resolveHighlighter(opt);
        if (!opt) return;

        var key = opt.name + magnetEl.id + JSON.stringify(opt.options);
        var highlight = this._highlights[key];
        if (highlight) {

            // Use the cellView and magnetEl that were used by the highlighter.highlight() method.
            highlight.highlighter.unhighlight(highlight.cellView, highlight.magnetEl, highlight.opt);

            this._highlights[key] = null;
        }
    },

    // Interaction.
    // ------------

    mousedblclick: function(evt) {

        evt.preventDefault();
        evt = joint.util.normalizeEvent(evt);

        var view = this.findView(evt.target);
        if (this.guard(evt, view)) return;

        var localPoint = this.snapToGrid({ x: evt.clientX, y: evt.clientY });

        if (view) {

            view.pointerdblclick(evt, localPoint.x, localPoint.y);

        } else {

            this.trigger('blank:pointerdblclick', evt, localPoint.x, localPoint.y);
        }
    },

    mouseclick: function(evt) {

        // Trigger event when mouse not moved.
        if (this._mousemoved <= this.options.clickThreshold) {

            evt = joint.util.normalizeEvent(evt);

            var view = this.findView(evt.target);
            if (this.guard(evt, view)) return;

            var localPoint = this.snapToGrid({ x: evt.clientX, y: evt.clientY });

            if (view) {

                view.pointerclick(evt, localPoint.x, localPoint.y);

            } else {

                this.trigger('blank:pointerclick', evt, localPoint.x, localPoint.y);
            }
        }
    },

    // Guard guards the event received. If the event is not interesting, guard returns `true`.
    // Otherwise, it return `false`.
    guard: function(evt, view) {

        if (this.options.guard && this.options.guard(evt, view)) {
            return true;
        }

        if (evt.data && !_.isUndefined(evt.data.guarded)) {
            return evt.data.guarded;
        }

        if (view && view.model && (view.model instanceof joint.dia.Cell)) {
            return false;
        }

        if (this.svg === evt.target || this.el === evt.target || $.contains(this.svg, evt.target)) {
            return false;
        }

        return true;    // Event guarded. Paper should not react on it in any way.
    },

    contextmenu: function(evt) {

        evt = joint.util.normalizeEvent(evt);

        if (this.options.preventContextMenu) {
            evt.preventDefault();
        }

        var view = this.findView(evt.target);
        if (this.guard(evt, view)) return;

        var localPoint = this.snapToGrid({ x: evt.clientX, y: evt.clientY });

        if (view) {

            view.contextmenu(evt, localPoint.x, localPoint.y);

        } else {

            this.trigger('blank:contextmenu', evt, localPoint.x, localPoint.y);
        }
    },

    pointerdown: function(evt) {

        this.bindDocumentEvents();

        evt = joint.util.normalizeEvent(evt);

        var view = this.findView(evt.target);
        if (this.guard(evt, view)) return;

        evt.preventDefault();

        this._mousemoved = 0;

        var localPoint = this.snapToGrid({ x: evt.clientX, y: evt.clientY });

        if (view) {

            this.sourceView = view;

            view.pointerdown(evt, localPoint.x, localPoint.y);

        } else {

            this.trigger('blank:pointerdown', evt, localPoint.x, localPoint.y);
        }
    },

    pointermove: function(evt) {

        if (this.sourceView) {

            evt.preventDefault();
            evt = joint.util.normalizeEvent(evt);

            // Mouse moved counter.
            this._mousemoved++;

            var localPoint = this.snapToGrid({ x: evt.clientX, y: evt.clientY });

            this.sourceView.pointermove(evt, localPoint.x, localPoint.y);
        }
    },

    pointerup: function(evt) {

        this.unbindDocumentEvents();

        evt = joint.util.normalizeEvent(evt);

        var localPoint = this.snapToGrid({ x: evt.clientX, y: evt.clientY });

        if (this.sourceView) {

            this.sourceView.pointerup(evt, localPoint.x, localPoint.y);

            //"delete sourceView" occasionally throws an error in chrome (illegal access exception)
            this.sourceView = null;

        } else {

            this.trigger('blank:pointerup', evt, localPoint.x, localPoint.y);
        }
    },

    mousewheel: function(evt) {

        evt = joint.util.normalizeEvent(evt);
        var view = this.findView(evt.target);
        if (this.guard(evt, view)) return;

        var originalEvent = evt.originalEvent;
        var localPoint = this.snapToGrid({ x: originalEvent.clientX, y: originalEvent.clientY });
        var delta = Math.max(-1, Math.min(1, (originalEvent.wheelDelta || -originalEvent.detail)));

        if (view) {

            view.mousewheel(evt, localPoint.x, localPoint.y, delta);

        } else {

            this.trigger('blank:mousewheel', evt, localPoint.x, localPoint.y, delta);
        }
    },

    cellMouseover: function(evt) {

        evt = joint.util.normalizeEvent(evt);
        var view = this.findView(evt.target);
        if (view) {
            if (this.guard(evt, view)) return;
            view.mouseover(evt);
        }
    },

    cellMouseout: function(evt) {

        evt = joint.util.normalizeEvent(evt);
        var view = this.findView(evt.target);
        if (view) {
            if (this.guard(evt, view)) return;
            view.mouseout(evt);
        }
    },

    cellMouseenter: function(evt) {

        evt = joint.util.normalizeEvent(evt);
        var view = this.findView(evt.target);
        if (view && !this.guard(evt, view)) {
            view.mouseenter(evt);
        }
    },

    cellMouseleave: function(evt) {

        evt = joint.util.normalizeEvent(evt);
        var view = this.findView(evt.target);
        if (view && !this.guard(evt, view)) {
            view.mouseleave(evt);
        }
    },

    setGridSize: function(gridSize) {

        this.options.gridSize = gridSize;

        if (this.options.drawGrid) {
            this.drawGrid();
        }

        return this;
    },

    clearGrid: function() {

        if (this.$grid) {
            this.$grid.css('backgroundImage', 'none');
        }
        return this;
    },

    _getGriRefs: function () {

        if (!this._gridCache) {

            this._gridCache = {
                root: V('svg', { width: '100%', height: '100%' }, V('defs')),
                patterns: {},
                add: function (id, vel) {
                    V(this.root.node.childNodes[0]).append(vel);
                    this.patterns[id] = vel;
                    this.root.append(V('rect', { width: "100%", height: "100%", fill: 'url(#' + id + ')' }));
                },
                get: function (id) {
                    return  this.patterns[id]
                },
                exist: function (id) {
                    return this.patterns[id] !== undefined;
                }
            }
        }

        return this._gridCache;
    },

    setGrid:function (drawGrid) {

        this.clearGrid();

        this._gridCache = null;
        this._gridSettings = [];

        var optionsList = _.isArray(drawGrid) ? drawGrid : [drawGrid || {}];
        _.each(optionsList, function (item) {
            this._gridSettings.push.apply(this._gridSettings, this._resolveDrawGridOption(item));
        }, this);
        return this;
    },

    _resolveDrawGridOption: function (opt) {

        var namespace = this.constructor.gridPatterns;
        if (_.isString(opt) && namespace[opt]) {
            return _.map(namespace[opt], _.clone);
        }

        var options = opt || { args: [{}] };
        var isArray = _.isArray(options);
        var name = options.name;

        if (!isArray && !name && !options.markup ) {
            name = 'dot';
        }

        if (name && namespace[name]) {
            var pattern = _.map(namespace[name], _.clone);

            var args = _.isArray(options.args) ? options.args : [options.args || {}];

            _.defaults(args[0], _.omit(opt, 'args'));
            for (var i = 0; i < args.length; i++) {
                if (pattern[i]) {
                    _.extend(pattern[i], args[i]);
                }
            }
            return pattern;
        }

        return isArray ? options : [options];
    },

    drawGrid: function(opt) {

        var gridSize = this.options.gridSize;
        if (gridSize <= 1) {
            return this.clearGrid();
        }

        var localOptions = _.isArray(opt) ? opt : [opt];

        var ctm = this.matrix();
        var refs = this._getGriRefs();

        _.each(this._gridSettings, function (gridLayerSetting, index) {

            var id = 'pattern_'  + index;
            var options = _.merge(gridLayerSetting, localOptions[index], {
                sx: ctm.a || 1,
                sy: ctm.d || 1,
                ox: ctm.e || 0,
                oy: ctm.f || 0
            });

            options.width = gridSize * (ctm.a || 1) * (options.scaleFactor || 1);
            options.height = gridSize * (ctm.d || 1) * (options.scaleFactor || 1);

            if (!refs.exist(id)) {
                refs.add(id, V('pattern', { id: id, patternUnits: 'userSpaceOnUse' }, V(options.markup)))
            }

            var patternDefVel = refs.get(id);

            if (_.isFunction(options.update)) {
                options.update(patternDefVel.node.childNodes[0], options);
            }

            var x = options.ox % options.width;
            if (x < 0) x += options.width;

            var y = options.oy % options.height;
            if (y < 0) y += options.height;

            patternDefVel.attr({
                x: x,
                y: y,
                width: options.width,
                height: options.height
            });
        });

        var patternUri = new XMLSerializer().serializeToString(refs.root.node);
        patternUri = 'url(data:image/svg+xml;base64,' + btoa(patternUri) + ')';

        this.$grid.css('backgroundImage', patternUri);

        return this;
    },

    updateBackgroundImage: function(opt) {

        opt = opt || {};

        var backgroundPosition = opt.position || 'center';
        var backgroundSize = opt.size || 'auto auto';

        var currentScale = this.scale();
        var currentTranslate = this.translate();

        // backgroundPosition
        if (_.isObject(backgroundPosition)) {
            var x = currentTranslate.tx + (currentScale.sx * (backgroundPosition.x || 0));
            var y = currentTranslate.ty + (currentScale.sy * (backgroundPosition.y || 0));
            backgroundPosition = x + 'px ' + y + 'px';
        }

        // backgroundSize
        if (_.isObject(backgroundSize)) {
            backgroundSize = g.rect(backgroundSize).scale(currentScale.sx, currentScale.sy);
            backgroundSize = backgroundSize.width + 'px ' + backgroundSize.height + 'px';
        }

        this.$background.css({
            backgroundSize: backgroundSize,
            backgroundPosition: backgroundPosition
        });
    },

    drawBackgroundImage: function(img, opt) {

        // Clear the background image if no image provided
        if (!(img instanceof HTMLImageElement)) {
            this.$background.css('backgroundImage', '');
            return;
        }

        opt = opt || {};

        var backgroundImage;
        var backgroundSize = opt.size;
        var backgroundRepeat = opt.repeat || 'no-repeat';
        var backgroundOpacity = opt.opacity || 1;
        var backgroundQuality = Math.abs(opt.quality) || 1;
        var backgroundPattern = this.constructor.backgroundPatterns[_.camelCase(backgroundRepeat)];

        if (_.isFunction(backgroundPattern)) {
            // 'flip-x', 'flip-y', 'flip-xy', 'watermark' and custom
            img.width *= backgroundQuality;
            img.height *= backgroundQuality;
            var canvas = backgroundPattern(img, opt);
            if (!(canvas instanceof HTMLCanvasElement)) {
                throw new Error('dia.Paper: background pattern must return an HTML Canvas instance');
            }

            backgroundImage = canvas.toDataURL('image/png');
            backgroundRepeat = 'repeat';
            if (_.isObject(backgroundSize)) {
                // recalculate the tile size if an object passed in
                backgroundSize.width *= canvas.width / img.width;
                backgroundSize.height *= canvas.height / img.height;
            } else if (_.isUndefined(backgroundSize)) {
                // calcule the tile size if no provided
                opt.size = {
                    width: canvas.width / backgroundQuality,
                    height: canvas.height / backgroundQuality
                };
            }
        } else {
            // backgroundRepeat:
            // no-repeat', 'round', 'space', 'repeat', 'repeat-x', 'repeat-y'
            backgroundImage = img.src;
            if (_.isUndefined(backgroundSize)) {
                // pass the image size for  the backgroundSize if no size provided
                opt.size = {
                    width: img.width,
                    height: img.height
                };
            }
        }

        this.$background.css({
            opacity: backgroundOpacity,
            backgroundRepeat: backgroundRepeat,
            backgroundImage: 'url(' + backgroundImage + ')'
        });

        this.updateBackgroundImage(opt);
    },

    updateBackgroundColor: function(color) {

        this.$el.css('backgroundColor', color || '');
    },

    drawBackground: function(opt) {

        opt = opt || {};

        this.updateBackgroundColor(opt.color);

        if (opt.image) {
            opt = this._background = _.cloneDeep(opt);
            var img = document.createElement('img');
            img.onload = _.bind(this.drawBackgroundImage, this, img, opt);
            img.src = opt.image;
        } else {
            this.drawBackgroundImage(null);
            this._background = null;
        }

        return this;
    },

    setInteractivity: function(value) {

        this.options.interactive = value;

        _.invoke(this._views, 'setInteractivity', value);
    },

    // Paper Defs

    isDefined: function(defId) {
        return !!this.svg.getElementById(defId);
    },

    defineFilter: function(filter) {

        if (!_.isObject(filter)) {
            throw new TypeError('dia.Paper: defineFilter() requires 1. argument to be an object.');
        }

        var filterId = filter.id;
        var name = filter.name;
        // Generate a hash code from the stringified filter definition. This gives us
        // a unique filter ID for different definitions.
        if (!filterId) {
            filterId = name + this.svg.id + joint.util.hashCode(JSON.stringify(filter));
        }
        // If the filter already exists in the document,
        // we're done and we can just use it (reference it using `url()`).
        // If not, create one.
        if (!this.isDefined(filterId)) {

            var namespace = joint.util.filter;
            var filterSVGString = namespace[name] && namespace[name](filter.args || {});
            if (!filterSVGString) {
                throw new Error('Non-existing filter ' + name);
            }

            // Set the filter area to be 3x the bounding box of the cell
            // and center the filter around the cell.
            var filterAttrs = _.extend({
                filterUnits: 'objectBoundingBox',
                x: -1,
                y: -1,
                width: 3,
                height: 3
            }, filter.attrs, {
                id: filterId
            });

            V(filterSVGString, filterAttrs).appendTo(this.defs);
        }

        return filterId;
    },

    defineGradient: function(gradient) {

        if (!_.isObject(gradient)) {
            throw new TypeError('dia.Paper: defineGradient() requires 1. argument to be an object.');
        }

        var gradientId = gradient.id;
        var type = gradient.type;
        var stops = gradient.stops;
        // Generate a hash code from the stringified filter definition. This gives us
        // a unique filter ID for different definitions.
        if (!gradientId) {
            gradientId = type + this.svg.id + joint.util.hashCode(JSON.stringify(gradient));
        }
        // If the gradient already exists in the document,
        // we're done and we can just use it (reference it using `url()`).
        // If not, create one.
        if (!this.isDefined(gradientId)) {

            var stopTemplate = joint.util.template('<stop offset="${offset}" stop-color="${color}" stop-opacity="${opacity}"/>');
            var gradientStopsStrings = _.map(stops, function(stop) {
                return stopTemplate({
                    offset: stop.offset,
                    color: stop.color,
                    opacity: _.isFinite(stop.opacity) ? stop.opacity : 1
                });
            });

            var gradientSVGString = [
                '<' + type + '>',
                gradientStopsStrings.join(''),
                '</' + type + '>'
            ].join('');

            var gradientAttrs = _.extend({ id: gradientId }, gradient.attrs);

            V(gradientSVGString, gradientAttrs).appendTo(this.defs);
        }

        return gradientId;
    },

    defineMarker: function(marker) {

        if (!_.isObject(marker)) {
            throw new TypeError('dia.Paper: defineMarker() requires 1. argument to be an object.');
        }

        var markerId = marker.id;

        // Generate a hash code from the stringified filter definition. This gives us
        // a unique filter ID for different definitions.
        if (!markerId) {
            markerId = this.svg.id + joint.util.hashCode(JSON.stringify(marker));
        }

        if (!this.isDefined(markerId)) {

            var attrs = _.omit(marker, 'type', 'userSpaceOnUse');
            var pathMarker = V('marker', {
                id: markerId,
                orient: 'auto',
                overflow: 'visible',
                markerUnits: marker.markerUnits || 'userSpaceOnUse'
            }, [
                V(marker.type || 'path', attrs)
            ]);

            pathMarker.appendTo(this.defs);
        }

        return markerId;
    }

}, {

    backgroundPatterns: {

        flipXy: function(img) {
            // d b
            // q p

            var canvas = document.createElement('canvas');
            var imgWidth = img.width;
            var imgHeight = img.height;

            canvas.width = 2 * imgWidth;
            canvas.height = 2 * imgHeight;

            var ctx = canvas.getContext('2d');
            // top-left image
            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);
            // xy-flipped bottom-right image
            ctx.setTransform(-1, 0, 0, -1, canvas.width, canvas.height);
            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);
            // x-flipped top-right image
            ctx.setTransform(-1, 0, 0, 1, canvas.width, 0);
            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);
            // y-flipped bottom-left image
            ctx.setTransform(1, 0, 0, -1, 0, canvas.height);
            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);

            return canvas;
        },

        flipX: function(img) {
            // d b
            // d b

            var canvas = document.createElement('canvas');
            var imgWidth = img.width;
            var imgHeight = img.height;

            canvas.width = imgWidth * 2;
            canvas.height = imgHeight;

            var ctx = canvas.getContext('2d');
            // left image
            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);
            // flipped right image
            ctx.translate(2 * imgWidth, 0);
            ctx.scale(-1, 1);
            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);

            return canvas;
        },

        flipY: function(img) {
            // d d
            // q q

            var canvas = document.createElement('canvas');
            var imgWidth = img.width;
            var imgHeight = img.height;

            canvas.width = imgWidth;
            canvas.height = imgHeight * 2;

            var ctx = canvas.getContext('2d');
            // top image
            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);
            // flipped bottom image
            ctx.translate(0, 2 * imgHeight);
            ctx.scale(1, -1);
            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);

            return canvas;
        },

        watermark: function(img, opt) {
            //   d
            // d

            opt = opt || {};

            var imgWidth = img.width;
            var imgHeight = img.height;

            var canvas = document.createElement('canvas');
            canvas.width = imgWidth * 3;
            canvas.height = imgHeight * 3;

            var ctx = canvas.getContext('2d');
            var angle = _.isNumber(opt.watermarkAngle) ? -opt.watermarkAngle : -20;
            var radians = g.toRad(angle);
            var stepX = canvas.width / 4;
            var stepY = canvas.height / 4;

            for (var i = 0; i < 4; i ++) {
                for (var j = 0; j < 4; j++) {
                    if ((i + j) % 2 > 0) {
                        // reset the current transformations
                        ctx.setTransform(1, 0, 0, 1, (2 * i - 1) * stepX, (2 * j - 1)  * stepY);
                        ctx.rotate(radians);
                        ctx.drawImage(img, -imgWidth / 2, -imgHeight / 2, imgWidth, imgHeight);
                    }
                }
            }

            return canvas;
        }
    },

    gridPatterns: {
        dot: [{
            color: '#AAAAAA',
            thickness: 1,
            markup: 'rect',
            update: function(el, opt) {
                V(el).attr({
                    width: opt.thickness * opt.sx,
                    height: opt.thickness * opt.sy,
                    fill: opt.color
                });
            }
        }],
        fixedDot: [{
            color: '#AAAAAA',
            thickness: 1,
            markup: 'rect',
            update: function(el, opt) {
                var size = opt.sx <= 1 ? opt.thickness * opt.sx : opt.thickness;
                V(el).attr({ width: size, height: size, fill: opt.color });
            }
        }],
        mesh: [{
            color: '#AAAAAA',
            thickness: 1,
            markup: 'path',
            update: function(el, opt) {

                var d;
                var width = opt.width;
                var height = opt.height;
                var thickness = opt.thickness;

                if (width - thickness >= 0 && height - thickness >= 0) {
                    d = ['M', width, 0, 'H0 M0 0 V0', height].join(' ');
                } else {
                    d = 'M 0 0 0 0';
                }

                V(el).attr({ 'd': d, stroke: opt.color, 'stroke-width': opt.thickness });
            }
        }],
        doubleMesh: [{
            color: '#AAAAAA',
            thickness: 1,
            markup: 'path',
            update: function(el, opt) {

                var d;
                var width = opt.width;
                var height = opt.height;
                var thickness = opt.thickness;

                if (width - thickness >= 0 && height - thickness >= 0) {
                    d = ['M', width, 0, 'H0 M0 0 V0', height].join(' ');
                } else {
                    d = 'M 0 0 0 0';
                }

                V(el).attr({ 'd': d, stroke: opt.color, 'stroke-width': opt.thickness });
            }
        }, {
            color: '#000000',
            thickness: 3,
            scaleFactor: 4,
            markup: 'path',
            update: function(el, opt) {

                var d;
                var width = opt.width;
                var height = opt.height;
                var thickness = opt.thickness;

                if (width - thickness >= 0 && height - thickness >= 0) {
                    d = ['M', width, 0, 'H0 M0 0 V0', height].join(' ');
                } else {
                    d = 'M 0 0 0 0';
                }

                V(el).attr({ 'd': d, stroke: opt.color, 'stroke-width': opt.thickness });
            }
        }]
    }
});

(function(joint, _) {

    var PortData = function(data) {

        var clonedData = _.cloneDeep(data) || {};
        this.ports = [];
        this.groups = {};
        this.portLayoutNamespace = joint.layout.Port;
        this.portLabelLayoutNamespace = joint.layout.PortLabel;

        this._init(clonedData);
    };

    PortData.prototype = {

        getPorts: function() {
            return this.ports;
        },

        getGroup: function(name) {
            return this.groups[name] || {};
        },

        getPortsByGroup: function(groupName) {

            return _.filter(this.ports, function(port) {
                return port.group === groupName;
            });
        },

        getGroupPortsMetrics: function(groupName, elBBox) {

            var group = this.getGroup(groupName);
            var ports = this.getPortsByGroup(groupName);

            var groupPosition = group.position || {};
            var groupPositionName = groupPosition.name;
            var namespace = this.portLayoutNamespace;
            if (!namespace[groupPositionName]) {
                groupPositionName = 'left';
            }

            var groupArgs = groupPosition.args || {};
            var portsArgs = _.pluck(ports, 'position.args');
            var groupPortTransformations = namespace[groupPositionName](portsArgs, elBBox, groupArgs);

            return _.transform(groupPortTransformations, _.bind(function(result, portTransformation, index) {
                var port = ports[index];
                result.push({
                    portId: port.id,
                    portTransformation: portTransformation,
                    labelTransformation: this._getPortLabelLayout(port, g.Point(portTransformation), elBBox),
                    portAttrs: port.attrs,
                    portSize: port.size,
                    labelSize: port.label.size
                });
            }, this), []);
        },

        _getPortLabelLayout: function(port, portPosition, elBBox) {

            var namespace = this.portLabelLayoutNamespace;
            var labelPosition = port.label.position.name || 'left';

            if (namespace[labelPosition]) {
                return namespace[labelPosition](portPosition, elBBox, port.label.position.args);
            }

            return null;
        },

        _init: function(data) {

            // prepare groups
            _.transform(data.groups || {}, _.bind(this._evaluateGroup, this), this.groups);
            // prepare ports
            _.transform(data.items || [], _.bind(this._evaluatePort, this), this.ports);
        },

        _evaluateGroup: function (resultMap, group, key) {

            resultMap[key] = _.merge(group, {
                position: this._getPosition(group.position, true),
                label: this._getLabel(group, true)
            });
        },

        _evaluatePort: function(resultArray, port) {

            var evaluated = _.clone(port);

            var group = this.getGroup(port.group);

            evaluated.markup = evaluated.markup || group.markup;
            evaluated.attrs = _.merge({}, group.attrs, evaluated.attrs);
            evaluated.position = this._createPositionNode(group, evaluated);
            evaluated.label = _.merge({}, group.label, this._getLabel(evaluated));
            evaluated.z = this._getZIndex(group, evaluated);
            evaluated.size = _.extend({}, group.size, evaluated.size);

            resultArray.push(evaluated);
        },

        _getZIndex: function(group, port) {

            if (_.isNumber(port.z)) {
                return port.z;
            }
            if (_.isNumber(group.z) || group.z === 'auto') {
                return group.z;
            }
            return 'auto';
        },

        _createPositionNode: function(group, port) {

            return _.merge({
                name: 'left',
                args: {}
            }, group.position, { args: port.args });
        },

        _getPosition: function(position, setDefault) {

            var args = {};
            var positionName;

            if (_.isFunction(position)) {
                positionName = 'fn';
                args.fn = position;
            } else if (_.isString(position)) {
                positionName = position;
            } else if (_.isUndefined(position)) {
                positionName = setDefault ? 'left' : null;
            } else if (_.isArray(position)) {
                positionName = 'absolute';
                args.x = position[0];
                args.y = position[1];
            } else if (_.isObject(position)) {
                positionName = position.name;
                _.extend(args, position.args);
            }

            var result = { args: args };

            if (positionName) {
                result.name = positionName;
            }
            return result;
        },

        _getLabel: function(item, setDefaults) {

            var label = item.label || {};

            var ret = label;
            ret.position = this._getPosition(label.position, setDefaults);

            return ret;
        }
    };

    _.extend(joint.dia.Element.prototype, {

        _initializePorts: function() {

            this._createPortData();
            this.on('change:ports', function() {

                this._processRemovedPort();
                this._createPortData();
            }, this);
        },

        /**
         * remove links tied wiht just removed element
         * @private
         */
        _processRemovedPort: function() {

            var current = this.get('ports') || {};
            var currentItemsMap = {};

            _.each(current.items, function(item) {
                currentItemsMap[item.id] = true;
            });

            var previous = this.previous('ports') || {};
            var removed = {};

            _.each(previous.items, function(item) {
                if (!currentItemsMap[item.id]) {
                    removed[item.id] = true;
                }
            });

            var graph = this.graph;
            if (graph && !_.isEmpty(removed)) {

                var inboundLinks = graph.getConnectedLinks(this, { inbound: true });
                _.each(inboundLinks, function(link) {

                    if (removed[link.get('target').port]) link.remove();
                });

                var outboundLinks = graph.getConnectedLinks(this, { outbound: true });
                _.each(outboundLinks, function(link) {

                    if (removed[link.get('source').port]) link.remove();
                });
            }
        },

        /**
         * @returns {boolean}
         */
        hasPorts: function() {

            return this.prop('ports/items').length > 0;
        },

        /**
         * @param {string} id
         * @returns {boolean}
         */
        hasPort: function(id) {

            return this.getPortIndex(id) !== -1;
        },

        /**
         * @returns {Array<object>}
         */
        getPorts: function() {

            return _.cloneDeep(this.prop('ports/items')) || [];
        },

        /**
         * @param {string} id
         * @returns {object}
         */
        getPort: function(id) {

            return _.cloneDeep(_.find(this.prop('ports/items'), function(port) {
                return port.id && port.id === id;
            }));
        },

        /**
         * @param {string} groupName
         * @returns {Object<portId, {x: number, y: number, angle: number}>}
         */
        getPortsPositions: function(groupName) {

            var portsMetrics = this._portSettingsData.getGroupPortsMetrics(groupName, g.Rect(this.size()));

            return _.transform(portsMetrics, function(positions, metrics) {
                var transformation = metrics.portTransformation;
                positions[metrics.portId] = {
                    x: transformation.x,
                    y: transformation.y,
                    angle: transformation.angle
                };
            }, {});
        },

        /**
         * @param {string|Port} port port id or port
         * @returns {number} port index
         */
        getPortIndex: function(port) {

            var id = _.isObject(port) ? port.id : port;

            if (!this._isValidPortId(id)) {
                return -1;
            }

            return _.findIndex(this.prop('ports/items'), { id: id });
        },

        /**
         * @param {object} port
         * @param {object} [opt]
         * @returns {joint.dia.Element}
         */
        addPort: function(port, opt) {

            if (!_.isObject(port) || _.isArray(port)) {
                throw new Error('Element: addPort requires an object.');
            }

            var ports = _.clone(this.prop('ports/items')) || [];
            ports.push(port);
            this.prop('ports/items', ports, opt);

            return this;
        },

        /**
         * @param {string} portId
         * @param {string|object=} path
         * @param {*=} value
         * @param {object=} opt
         * @returns {joint.dia.Element}
         */
        portProp: function(portId, path, value, opt) {

            var index = this.getPortIndex(portId);

            if (index === -1) {
                throw new Error('Element: unable to find port with id ' + portId);
            }

            var args = Array.prototype.slice.call(arguments, 1);
            if (_.isArray(path)) {
                args[0] = ['ports', 'items', index].concat(path);
            } else if (_.isString(path)) {

                // Get/set an attribute by a special path syntax that delimits
                // nested objects by the colon character.
                args[0] = ['ports/items/', index, '/', path].join('');

            } else {

                args = ['ports/items/' + index];
                if (_.isPlainObject(path)) {
                    args.push(path);
                    args.push(value);
                }
            }

            return this.prop.apply(this, args);
        },

        _validatePorts: function() {

            var portsAttr = this.get('ports') || {};

            var errorMessages = [];
            portsAttr = portsAttr || {};
            var ports = portsAttr.items || [];

            _.each(ports, function(p) {
                if (!this._isValidPortId(p.id)) {
                    p.id = joint.util.uuid();
                }
            }, this);

            if (_.uniq(ports, 'id').length !== ports.length) {
                errorMessages.push('Element: found id duplicities in ports.');
            }

            return errorMessages;
        },

        /**
         * @param {string} id port id
         * @returns {boolean}
         * @private
         */
        _isValidPortId: function(id) {

            return !_.isNull(id) && !_.isUndefined(id) && !_.isObject(id);
        },

        addPorts: function(ports, opt) {

            if (ports.length) {
                this.prop('ports/items', (_.clone(this.prop('ports/items')) || []).concat(ports), opt);
            }

            return this;
        },

        removePort: function(port, opt) {

            var options = opt || {};
            var ports = _.clone(this.prop('ports/items'));

            var index = this.getPortIndex(port);

            if (index !== -1) {
                ports.splice(index, 1);
                options.rewrite = true;
                this.prop('ports/items', ports, options);
            }

            return this;
        },

        /**
         * @private
         */
        _createPortData: function() {

            var err = this._validatePorts();

            if (err.length > 0) {
                this.set('ports', this.previous('ports'));
                throw new Error(err.join(' '));
            }

            var prevPortData;

            if (this._portSettingsData) {

                prevPortData = this._portSettingsData.getPorts();
            }

            this._portSettingsData = new PortData(this.get('ports'));

            var curPortData = this._portSettingsData.getPorts();

            if (prevPortData) {

                // _.filter can be replaced with _.differenceBy in lodash 4
                var added = _.filter(curPortData, function(item) {
                    if (!_.find(prevPortData, 'id', item.id)) {
                        return item;
                    }
                });

                var removed = _.filter(prevPortData, function(item) {
                    if (!_.find(curPortData, 'id', item.id)) {
                        return item;
                    }
                });

                if (removed.length > 0) {
                    this.trigger('ports:remove', this, removed);
                }

                if (added.length > 0) {
                    this.trigger('ports:add', this, added);
                }
            }
        }
    });

    _.extend(joint.dia.ElementView.prototype, {

        portContainerMarkup: '<g class="joint-port"/>',
        portMarkup: '<circle class="joint-port-body" r="10" fill="#FFFFFF" stroke="#000000"/>',
        portLabelMarkup: '<text class="joint-port-label" fill="#000000"/>',
        /** @type {Object<string, {portElement: Vectorizer, portLabelElement: Vectorizer}>} */
        _portElementsCache: null,

        /**
         * @private
         */
        _initializePorts: function() {

            this._portElementsCache = {};

            this.listenTo(this.model, 'change:ports', function() {

                this._refreshPorts();
            });
        },

        /**
         * @typedef {Object} Port
         *
         * @property {string} id
         * @property {Object} position
         * @property {Object} label
         * @property {Object} attrs
         * @property {string} markup
         * @property {string} group
         */

        /**
         * @private
         */
        _refreshPorts: function() {

            this._removePorts();
            this._portElementsCache = {};

            this._renderPorts();
        },

        /**
         * @private
         */
        _renderPorts: function() {

            // references to rendered elements without z-index
            var elementReferences = [];
            var elem = this._getContainerElement();
            _.each(elem.node.childNodes, function(n) {
                elementReferences.push(n);
            });

            var portsGropsByZ = _.groupBy(this.model._portSettingsData.getPorts(), 'z');
            var withoutZKey = 'auto';

            // render non-z first
            _.each(portsGropsByZ[withoutZKey], function(port) {
                var portElement = this._getPortElement(port);
                elem.append(portElement);
                elementReferences.push(portElement);
            }, this);

            _.each(portsGropsByZ, function(groupPorts, groupName) {
                if (groupName !== withoutZKey) {
                    var z = parseInt(groupName, 10);
                    this._appendPorts(portsGropsByZ[groupName], z, elementReferences);
                }
            }, this);

            this._updatePorts();
        },

        /**
         * @returns {V}
         * @private
         */
        _getContainerElement: function() {

            return this.rotatableNode || this.vel;
        },

        /**
         * @param {Array<Port>}ports
         * @param {number} z
         * @param refs
         * @private
         */
        _appendPorts: function(ports, z, refs) {

            var containerElement = this._getContainerElement();
            var portElements = _.map(ports, this._getPortElement, this);

            if (refs[z] || z < 0) {
                V(refs[Math.max(z, 0)]).before(portElements);
            } else {
                containerElement.append(portElements);
            }
        },

        /**
         * Try to get element from cache,
         * @param port
         * @returns {*}
         * @private
         */
        _getPortElement: function(port) {

            if (this._portElementsCache[port.id]) {
                return this._portElementsCache[port.id].portElement;
            }
            return this._createPortElement(port);
        },

        /**
         * @private
         */
        _updatePorts: function() {

            // layout ports without group
            this._updatePortGroup(undefined);
            // layout ports with explicit group
            var groupsNames = _.keys(this.model._portSettingsData.groups);
            _.each(groupsNames, this._updatePortGroup, this);
        },

        /**
         * @private
         */
        _removePorts: function() {
            _.invoke(this._portElementsCache, 'portElement.remove');
        },

        /**
         * @param {Port} port
         * @returns {V}
         * @private
         */
        _createPortElement: function(port) {

            var portContentElement = V(this._getPortMarkup(port));
            var portLabelContentElement = V(this._getPortLabelMarkup(port.label));

            if (portContentElement && portContentElement.length > 1) {
                throw new Error('ElementView: Invalid port markup - multiple roots.');
            }

            portContentElement.attr({
                'port': port.id,
                'port-group': port.group
            });

            var portElement = V(this.portContainerMarkup)
                .append(portContentElement)
                .append(portLabelContentElement);

            this._portElementsCache[port.id] = {
                portElement: portElement,
                portLabelElement: portLabelContentElement
            };

            return portElement;
        },

        /**
         * @param {string=} groupName
         * @private
         */
        _updatePortGroup: function(groupName) {

            var elementBBox = g.Rect(this.model.size());
            var portsMetrics = this.model._portSettingsData.getGroupPortsMetrics(groupName, elementBBox);

            for (var i = 0, n = portsMetrics.length; i < n; i++) {
                var metrics = portsMetrics[i];
                var portId = metrics.portId;
                var cached = this._portElementsCache[portId] || {};
                var portTransformation = metrics.portTransformation;
                this.applyPortTransform(cached.portElement, portTransformation);
                this.updateDOMSubtreeAttributes(cached.portElement.node, metrics.portAttrs, {
                    rootBBox: g.Rect(metrics.portSize)
                });

                var labelTransformation = metrics.labelTransformation;
                if (labelTransformation) {
                    this.applyPortTransform(cached.portLabelElement, labelTransformation, (-portTransformation.angle || 0));
                    this.updateDOMSubtreeAttributes(cached.portLabelElement.node, labelTransformation.attrs, {
                        rootBBox: g.Rect(metrics.labelSize)
                    });
                }
            }
        },

        /**
         * @param {Vectorizer} element
         * @param {{dx:number, dy:number, angle: number, attrs: Object, x:number: y:number}} transformData
         * @param {number=} initialAngle
         * @constructor
         */
        applyPortTransform: function(element, transformData, initialAngle) {

            var matrix = V.createSVGMatrix()
                .rotate(initialAngle || 0)
                .translate(transformData.x || 0, transformData.y || 0)
                .rotate(transformData.angle || 0);

            element.transform(matrix, { absolute: true });
        },

        /**
         * @param {Port} port
         * @returns {string}
         * @private
         */
        _getPortMarkup: function(port) {

            return port.markup || this.model.get('portMarkup') || this.model.portMarkup || this.portMarkup;
        },

        /**
         * @param {Object} label
         * @returns {string}
         * @private
         */
        _getPortLabelMarkup: function(label) {

            return label.markup || this.model.get('portLabelMarkup') || this.model.portLabelMarkup || this.portLabelMarkup;
        }

    });
}(joint, _));


joint.shapes.basic = {};

joint.shapes.basic.Generic = joint.dia.Element.extend({

    defaults: _.defaultsDeep({

        type: 'basic.Generic',
        attrs: {
            '.': { fill: '#ffffff', stroke: 'none' }
        }

    }, joint.dia.Element.prototype.defaults)
});

joint.shapes.basic.Rect = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><rect/></g><text/></g>',

    defaults: _.defaultsDeep({

        type: 'basic.Rect',
        attrs: {
            'rect': {
                fill: '#ffffff',
                stroke: '#000000',
                width: 100,
                height: 60
            },
            'text': {
                fill: '#000000',
                text: '',
                'font-size': 14,
                'ref-x': .5,
                'ref-y': .5,
                'text-anchor': 'middle',
                'y-alignment': 'middle',
                'font-family': 'Arial, helvetica, sans-serif'
            }
        }

    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.basic.TextView = joint.dia.ElementView.extend({

    initialize: function() {
        joint.dia.ElementView.prototype.initialize.apply(this, arguments);
        // The element view is not automatically rescaled to fit the model size
        // when the attribute 'attrs' is changed.
        this.listenTo(this.model, 'change:attrs', this.resize);
    }
});

joint.shapes.basic.Text = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><text/></g></g>',

    defaults: _.defaultsDeep({

        type: 'basic.Text',
        attrs: {
            'text': {
                'font-size': 18,
                fill: '#000000'
            }
        }

    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.basic.Circle = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><circle/></g><text/></g>',

    defaults: _.defaultsDeep({

        type: 'basic.Circle',
        size: { width: 60, height: 60 },
        attrs: {
            'circle': {
                fill: '#ffffff',
                stroke: '#000000',
                r: 30,
                cx: 30,
                cy: 30
            },
            'text': {
                'font-size': 14,
                text: '',
                'text-anchor': 'middle',
                'ref-x': .5,
                'ref-y': .5,
                'y-alignment': 'middle',
                fill: '#000000',
                'font-family': 'Arial, helvetica, sans-serif'
            }
        }
    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.basic.Ellipse = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><ellipse/></g><text/></g>',

    defaults: _.defaultsDeep({

        type: 'basic.Ellipse',
        size: { width: 60, height: 40 },
        attrs: {
            'ellipse': {
                fill: '#ffffff',
                stroke: '#000000',
                rx: 30,
                ry: 20,
                cx: 30,
                cy: 20
            },
            'text': {
                'font-size': 14,
                text: '',
                'text-anchor': 'middle',
                'ref-x': .5,
                'ref-y': .5,
                'y-alignment': 'middle',
                fill: '#000000',
                'font-family': 'Arial, helvetica, sans-serif'
            }
        }
    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.basic.Polygon = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>',

    defaults: _.defaultsDeep({

        type: 'basic.Polygon',
        size: { width: 60, height: 40 },
        attrs: {
            'polygon': {
                fill: '#ffffff',
                stroke: '#000000'
            },
            'text': {
                'font-size': 14,
                text: '',
                'text-anchor': 'middle',
                'ref-x': .5,
                'ref-dy': 20,
                'y-alignment': 'middle',
                fill: '#000000',
                'font-family': 'Arial, helvetica, sans-serif'
            }
        }
    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.basic.Polyline = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><polyline/></g><text/></g>',

    defaults: _.defaultsDeep({

        type: 'basic.Polyline',
        size: { width: 60, height: 40 },
        attrs: {
            'polyline': {
                fill: '#ffffff',
                stroke: '#000000'
            },
            'text': {
                'font-size': 14,
                text: '',
                'text-anchor': 'middle',
                'ref-x': .5,
                'ref-dy': 20,
                'y-alignment': 'middle',
                fill: '#000000',
                'font-family': 'Arial, helvetica, sans-serif'
            }
        }
    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.basic.Image = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><image/></g><text/></g>',

    defaults: _.defaultsDeep({

        type: 'basic.Image',
        attrs: {
            'text': {
                'font-size': 14,
                text: '',
                'text-anchor': 'middle',
                'ref-x': .5,
                'ref-dy': 20,
                'y-alignment': 'middle',
                fill: '#000000',
                'font-family': 'Arial, helvetica, sans-serif'
            }
        }
    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.basic.Path = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><path/></g><text/></g>',

    defaults: _.defaultsDeep({

        type: 'basic.Path',
        size: { width: 60, height: 60 },
        attrs: {
            'path': {
                fill: '#ffffff',
                stroke: '#000000'
            },
            'text': {
                'font-size': 14,
                text: '',
                'text-anchor': 'middle',
                'ref': 'path',
                'ref-x': .5,
                'ref-dy': 10,
                fill: '#000000',
                'font-family': 'Arial, helvetica, sans-serif'
            }
        }
    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.basic.Rhombus = joint.shapes.basic.Path.extend({

    defaults: _.defaultsDeep({

        type: 'basic.Rhombus',
        attrs: {
            'path': {
                d: 'M 30 0 L 60 30 30 60 0 30 z'
            },
            'text': {
                'ref-y': .5,
                'ref-dy': null,
                'y-alignment': 'middle'
            }
        }

    }, joint.shapes.basic.Path.prototype.defaults)
});


// PortsModelInterface is a common interface for shapes that have ports. This interface makes it easy
// to create new shapes with ports functionality. It is assumed that the new shapes have
// `inPorts` and `outPorts` array properties. Only these properties should be used to set ports.
// In other words, using this interface, it is no longer recommended to set ports directly through the
// `attrs` object.

// Usage:
// joint.shapes.custom.MyElementWithPorts = joint.shapes.basic.Path.extend(_.extend({}, joint.shapes.basic.PortsModelInterface, {
//     getPortAttrs: function(portName, index, total, selector, type) {
//         var attrs = {};
//         var portClass = 'port' + index;
//         var portSelector = selector + '>.' + portClass;
//         var portTextSelector = portSelector + '>text';
//         var portBodySelector = portSelector + '>.port-body';
//
//         attrs[portTextSelector] = { text: portName };
//         attrs[portBodySelector] = { port: { id: portName || _.uniqueId(type) , type: type } };
//         attrs[portSelector] = { ref: 'rect', 'ref-y': (index + 0.5) * (1 / total) };
//
//         if (selector === '.outPorts') { attrs[portSelector]['ref-dx'] = 0; }
//
//         return attrs;
//     }
//}));
joint.shapes.basic.PortsModelInterface = {

    initialize: function() {

        this.updatePortsAttrs();
        this.on('change:inPorts change:outPorts', this.updatePortsAttrs, this);

        // Call the `initialize()` of the parent.
        this.constructor.__super__.constructor.__super__.initialize.apply(this, arguments);
    },

    updatePortsAttrs: function(eventName) {

        if (this._portSelectors) {

            var newAttrs = _.omit(this.get('attrs'), this._portSelectors);
            this.set('attrs', newAttrs, { silent: true });
        }

        // This holds keys to the `attrs` object for all the port specific attribute that
        // we set in this method. This is necessary in order to remove previously set
        // attributes for previous ports.
        this._portSelectors = [];

        var attrs = {};

        _.each(this.get('inPorts'), function(portName, index, ports) {
            var portAttributes = this.getPortAttrs(portName, index, ports.length, '.inPorts', 'in');
            this._portSelectors = this._portSelectors.concat(_.keys(portAttributes));
            _.extend(attrs, portAttributes);
        }, this);

        _.each(this.get('outPorts'), function(portName, index, ports) {
            var portAttributes = this.getPortAttrs(portName, index, ports.length, '.outPorts', 'out');
            this._portSelectors = this._portSelectors.concat(_.keys(portAttributes));
            _.extend(attrs, portAttributes);
        }, this);

        // Silently set `attrs` on the cell so that noone knows the attrs have changed. This makes sure
        // that, for example, command manager does not register `change:attrs` command but only
        // the important `change:inPorts`/`change:outPorts` command.
        this.attr(attrs, { silent: true });
        // Manually call the `processPorts()` method that is normally called on `change:attrs` (that we just made silent).
        this.processPorts();
        // Let the outside world (mainly the `ModelView`) know that we're done configuring the `attrs` object.
        this.trigger('process:ports');
    },

    getPortSelector: function(name) {

        var selector = '.inPorts';
        var index = this.get('inPorts').indexOf(name);

        if (index < 0) {
            selector = '.outPorts';
            index = this.get('outPorts').indexOf(name);

            if (index < 0) throw new Error("getPortSelector(): Port doesn't exist.");
        }

        return selector + '>g:nth-child(' + (index + 1) + ')>.port-body';
    }
};

joint.shapes.basic.PortsViewInterface = {

    initialize: function() {

        // `Model` emits the `process:ports` whenever it's done configuring the `attrs` object for ports.
        this.listenTo(this.model, 'process:ports', this.update);

        joint.dia.ElementView.prototype.initialize.apply(this, arguments);
    },

    update: function() {

        // First render ports so that `attrs` can be applied to those newly created DOM elements
        // in `ElementView.prototype.update()`.
        this.renderPorts();
        joint.dia.ElementView.prototype.update.apply(this, arguments);
    },

    renderPorts: function() {

        var $inPorts = this.$('.inPorts').empty();
        var $outPorts = this.$('.outPorts').empty();

        var portTemplate = joint.util.template(this.model.portMarkup);

        _.each(_.filter(this.model.ports, function(p) { return p.type === 'in'; }), function(port, index) {

            $inPorts.append(V(portTemplate({ id: index, port: port })).node);
        });

        _.each(_.filter(this.model.ports, function(p) { return p.type === 'out'; }), function(port, index) {

            $outPorts.append(V(portTemplate({ id: index, port: port })).node);
        });
    }
};

joint.shapes.basic.TextBlock = joint.shapes.basic.Generic.extend({

    markup: [
        '<g class="rotatable">',
        '<g class="scalable"><rect/></g>',
        joint.env.test('svgforeignobject') ? '<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>' : '<text class="content"/>',
        '</g>'
    ].join(''),

    defaults: _.defaultsDeep({

        type: 'basic.TextBlock',

        // see joint.css for more element styles
        attrs: {
            rect: {
                fill: '#ffffff',
                stroke: '#000000',
                width: 80,
                height: 100
            },
            text: {
                fill: '#000000',
                'font-size': 14,
                'font-family': 'Arial, helvetica, sans-serif'
            },
            '.content': {
                text: '',
                'ref-x': .5,
                'ref-y': .5,
                'y-alignment': 'middle',
                'x-alignment': 'middle'
            }
        },

        content: ''

    }, joint.shapes.basic.Generic.prototype.defaults),

    initialize: function() {

        this.listenTo(this, 'change:size', this.updateSize);
        this.listenTo(this, 'change:content', this.updateContent);
        this.updateSize(this, this.get('size'));
        this.updateContent(this, this.get('content'));
        joint.shapes.basic.Generic.prototype.initialize.apply(this, arguments);
    },

    updateSize: function(cell, size) {

        // Selector `foreignObject' doesn't work accross all browsers, we'r using class selector instead.
        // We have to clone size as we don't want attributes.div.style to be same object as attributes.size.
        this.attr({
            '.fobj': _.clone(size),
            div: {
                style: _.clone(size)
            }
        });
    },

    updateContent: function(cell, content) {

        if (joint.env.test('svgforeignobject')) {

            // Content element is a <div> element.
            this.attr({
                '.content': {
                    html: content
                }
            });

        } else {

            // Content element is a <text> element.
            // SVG elements don't have innerHTML attribute.
            this.attr({
                '.content': {
                    text: content
                }
            });
        }
    },

    // Here for backwards compatibility:
    setForeignObjectSize: function() {

        this.updateSize.apply(this, arguments);
    },

    // Here for backwards compatibility:
    setDivContent: function() {

        this.updateContent.apply(this, arguments);
    }

});

// TextBlockView implements the fallback for IE when no foreignObject exists and
// the text needs to be manually broken.
joint.shapes.basic.TextBlockView = joint.dia.ElementView.extend({

    initialize: function() {

        joint.dia.ElementView.prototype.initialize.apply(this, arguments);

        // Keep this for backwards compatibility:
        this.noSVGForeignObjectElement = !joint.env.test('svgforeignobject');

        if (!joint.env.test('svgforeignobject')) {

            this.listenTo(this.model, 'change:content change:size', function(cell) {
                // avoiding pass of extra paramters
                this.updateContent(cell);
            });
        }
    },

    update: function(cell, renderingOnlyAttrs) {

        var model = this.model;

        if (!joint.env.test('svgforeignobject')) {

            // Update everything but the content first.
            var noTextAttrs = _.omit(renderingOnlyAttrs || model.get('attrs'), '.content');
            joint.dia.ElementView.prototype.update.call(this, model, noTextAttrs);

            if (!renderingOnlyAttrs || _.has(renderingOnlyAttrs, '.content')) {
                // Update the content itself.
                this.updateContent(model, renderingOnlyAttrs);
            }

        } else {

            joint.dia.ElementView.prototype.update.call(this, model, renderingOnlyAttrs);
        }
    },

    updateContent: function(cell, renderingOnlyAttrs) {

        // Create copy of the text attributes
        var textAttrs = _.merge({}, (renderingOnlyAttrs || cell.get('attrs'))['.content']);

        textAttrs = _.omit(textAttrs, 'text');

        // Break the content to fit the element size taking into account the attributes
        // set on the model.
        var text = joint.util.breakText(cell.get('content'), cell.get('size'), textAttrs, {
            // measuring sandbox svg document
            svgDocument: this.paper.svg
        });

        // Create a new attrs with same structure as the model attrs { text: { *textAttributes* }}
        var attrs = joint.util.setByPath({}, '.content', textAttrs, '/');

        // Replace text attribute with the one we just processed.
        attrs['.content'].text = text;

        // Update the view using renderingOnlyAttributes parameter.
        joint.dia.ElementView.prototype.update.call(this, cell, attrs);
    }
});

joint.routers.manhattan = (function(g, _, joint) {

    'use strict';

    var config = {

        // size of the step to find a route
        step: 10,

        // use of the perpendicular linkView option to connect center of element with first vertex
        perpendicular: true,

        // should be source or target not to be consider as an obstacle
        excludeEnds: [], // 'source', 'target'

        // should be any element with a certain type not to be consider as an obstacle
        excludeTypes: ['basic.Text'],

        // if number of route finding loops exceed the maximum, stops searching and returns
        // fallback route
        maximumLoops: 2000,

        // possible starting directions from an element
        startDirections: ['left', 'right', 'top', 'bottom'],

        // possible ending directions to an element
        endDirections: ['left', 'right', 'top', 'bottom'],

        // specify directions above
        directionMap: {
            right: { x: 1, y: 0 },
            bottom: { x: 0, y: 1 },
            left: { x: -1, y: 0 },
            top: { x: 0, y: -1 }
        },

        // maximum change of the direction
        maxAllowedDirectionChange: 90,

        // padding applied on the element bounding boxes
        paddingBox: function() {

            var step = this.step;

            return {
                x: -step,
                y: -step,
                width: 2 * step,
                height: 2 * step
            };
        },

        // an array of directions to find next points on the route
        directions: function() {

            var step = this.step;

            return [
                { offsetX: step  , offsetY: 0     , cost: step },
                { offsetX: 0     , offsetY: step  , cost: step },
                { offsetX: -step , offsetY: 0     , cost: step },
                { offsetX: 0     , offsetY: -step , cost: step }
            ];
        },

        // a penalty received for direction change
        penalties: function() {

            return {
                0: 0,
                45: this.step / 2,
                90: this.step / 2
            };
        },

        // * Deprecated *
        // a simple route used in situations, when main routing method fails
        // (exceed loops, inaccessible).
        /* i.e.
          function(from, to, opts) {
            // Find an orthogonal route ignoring obstacles.
            var point = ((opts.previousDirAngle || 0) % 180 === 0)
                    ? g.point(from.x, to.y)
                    : g.point(to.x, from.y);
            return [point, to];
          },
        */
        fallbackRoute: _.constant(null),

        // if a function is provided, it's used to route the link while dragging an end
        // i.e. function(from, to, opts) { return []; }
        draggingRoute: null
    };

    // Map of obstacles
    // Helper structure to identify whether a point lies in an obstacle.
    function ObstacleMap(opt) {

        this.map = {};
        this.options = opt;
        // tells how to divide the paper when creating the elements map
        this.mapGridSize = 100;
    }

    ObstacleMap.prototype.build = function(graph, link) {

        var opt = this.options;

        // source or target element could be excluded from set of obstacles
        var excludedEnds = _.chain(opt.excludeEnds)
            .map(link.get, link)
            .pluck('id')
            .map(graph.getCell, graph).value();

        // Exclude any embedded elements from the source and the target element.
        var excludedAncestors = [];

        var source = graph.getCell(link.get('source').id);
        if (source) {
            excludedAncestors = _.union(excludedAncestors, _.map(source.getAncestors(), 'id'));
        }

        var target = graph.getCell(link.get('target').id);
        if (target) {
            excludedAncestors = _.union(excludedAncestors, _.map(target.getAncestors(), 'id'));
        }

        // builds a map of all elements for quicker obstacle queries (i.e. is a point contained
        // in any obstacle?) (a simplified grid search)
        // The paper is divided to smaller cells, where each of them holds an information which
        // elements belong to it. When we query whether a point is in an obstacle we don't need
        // to go through all obstacles, we check only those in a particular cell.
        var mapGridSize = this.mapGridSize;

        _.chain(graph.getElements())
            // remove source and target element if required
            .difference(excludedEnds)
            // remove all elements whose type is listed in excludedTypes array
            .reject(function(element) {
                // reject any element which is an ancestor of either source or target
                return _.contains(opt.excludeTypes, element.get('type')) || _.contains(excludedAncestors, element.id);
            })
            // change elements (models) to their bounding boxes
            .invoke('getBBox')
            // expand their boxes by specific padding
            .invoke('moveAndExpand', opt.paddingBox)
            // build the map
            .foldl(function(map, bbox) {

                var origin = bbox.origin().snapToGrid(mapGridSize);
                var corner = bbox.corner().snapToGrid(mapGridSize);

                for (var x = origin.x; x <= corner.x; x += mapGridSize) {
                    for (var y = origin.y; y <= corner.y; y += mapGridSize) {

                        var gridKey = x + '@' + y;

                        map[gridKey] = map[gridKey] || [];
                        map[gridKey].push(bbox);
                    }
                }

                return map;

            }, this.map).value();

        return this;
    };

    ObstacleMap.prototype.isPointAccessible = function(point) {

        var mapKey = point.clone().snapToGrid(this.mapGridSize).toString();

        return _.every(this.map[mapKey], function(obstacle) {
            return !obstacle.containsPoint(point);
        });
    };

    // Sorted Set
    // Set of items sorted by given value.
    function SortedSet() {
        this.items = [];
        this.hash = {};
        this.values = {};
        this.OPEN = 1;
        this.CLOSE = 2;
    }

    SortedSet.prototype.add = function(item, value) {

        if (this.hash[item]) {
            // item removal
            this.items.splice(this.items.indexOf(item), 1);
        } else {
            this.hash[item] = this.OPEN;
        }

        this.values[item] = value;

        var index = _.sortedIndex(this.items, item, function(i) {
            return this.values[i];
        }, this);

        this.items.splice(index, 0, item);
    };

    SortedSet.prototype.remove = function(item) {
        this.hash[item] = this.CLOSE;
    };

    SortedSet.prototype.isOpen = function(item) {
        return this.hash[item] === this.OPEN;
    };

    SortedSet.prototype.isClose = function(item) {
        return this.hash[item] === this.CLOSE;
    };

    SortedSet.prototype.isEmpty = function() {
        return this.items.length === 0;
    };

    SortedSet.prototype.pop = function() {
        var item =  this.items.shift();
        this.remove(item);
        return item;
    };

    function normalizePoint(point) {
        return g.point(
            point.x === 0 ? 0 : Math.abs(point.x) / point.x,
            point.y === 0 ? 0 : Math.abs(point.y) / point.y
        );
    }

    // reconstructs a route by concating points with their parents
    function reconstructRoute(parents, point, startCenter, endCenter) {

        var route = [];
        var prevDiff = normalizePoint(endCenter.difference(point));
        var current = point;
        var parent;

        while ((parent = parents[current])) {

            var diff = normalizePoint(current.difference(parent));

            if (!diff.equals(prevDiff)) {

                route.unshift(current);
                prevDiff = diff;
            }

            current = parent;
        }

        var startDiff = normalizePoint(g.point(current).difference(startCenter));
        if (!startDiff.equals(prevDiff)) {
            route.unshift(current);
        }

        return route;
    }

    // find points around the rectangle taking given directions in the account
    function getRectPoints(bbox, directionList, opt) {

        var step = opt.step;
        var center = bbox.center();
        var startPoints = _.chain(opt.directionMap).pick(directionList).map(function(direction) {

            var x = direction.x * bbox.width / 2;
            var y = direction.y * bbox.height / 2;

            var point = center.clone().offset(x, y);

            if (bbox.containsPoint(point)) {

                point.offset(direction.x * step, direction.y * step);
            }

            return point.snapToGrid(step);

        }).value();

        return startPoints;
    }

    // returns a direction index from start point to end point
    function getDirectionAngle(start, end, dirLen) {

        var q = 360 / dirLen;
        return Math.floor(g.normalizeAngle(start.theta(end) + q / 2) / q) * q;
    }

    function getDirectionChange(angle1, angle2) {

        var dirChange = Math.abs(angle1 - angle2);
        return dirChange > 180 ? 360 - dirChange : dirChange;
    }

    // heurestic method to determine the distance between two points
    function estimateCost(from, endPoints) {

        var min = Infinity;

        for (var i = 0, len = endPoints.length; i < len; i++) {
            var cost = from.manhattanDistance(endPoints[i]);
            if (cost < min) min = cost;
        }

        return min;
    }

    // finds the route between to points/rectangles implementing A* alghoritm
    function findRoute(start, end, map, opt) {

        var step = opt.step;
        var startPoints, endPoints;
        var startCenter, endCenter;

        // set of points we start pathfinding from
        if (start instanceof g.rect) {
            startPoints = getRectPoints(start, opt.startDirections, opt);
            startCenter = start.center().snapToGrid(step);
        } else {
            startCenter = start.clone().snapToGrid(step);
            startPoints = [startCenter];
        }

        // set of points we want the pathfinding to finish at
        if (end instanceof g.rect) {
            endPoints = getRectPoints(end, opt.endDirections, opt);
            endCenter = end.center().snapToGrid(step);
        } else {
            endCenter = end.clone().snapToGrid(step);
            endPoints = [endCenter];
        }

        // take into account only accessible end points
        startPoints = _.filter(startPoints, map.isPointAccessible, map);
        endPoints = _.filter(endPoints, map.isPointAccessible, map);

        // Check if there is a accessible end point.
        // We would have to use a fallback route otherwise.
        if (startPoints.length > 0 && endPoints.length >  0) {

            // The set of tentative points to be evaluated, initially containing the start points.
            var openSet = new SortedSet();
            // Keeps reference to a point that is immediate predecessor of given element.
            var parents = {};
            // Cost from start to a point along best known path.
            var costs = {};

            _.each(startPoints, function(point) {
                var key = point.toString();
                openSet.add(key, estimateCost(point, endPoints));
                costs[key] = 0;
            });

            // directions
            var dir, dirChange;
            var dirs = opt.directions;
            var dirLen = dirs.length;
            var loopsRemain = opt.maximumLoops;
            var endPointsKeys = _.invoke(endPoints, 'toString');

            // main route finding loop
            while (!openSet.isEmpty() && loopsRemain > 0) {

                // remove current from the open list
                var currentKey = openSet.pop();
                var currentPoint = g.point(currentKey);
                var currentDist = costs[currentKey];
                var previousDirAngle = currentDirAngle;
                var currentDirAngle = parents[currentKey]
                    ? getDirectionAngle(parents[currentKey], currentPoint, dirLen)
                    : opt.previousDirAngle != null ? opt.previousDirAngle : getDirectionAngle(startCenter, currentPoint, dirLen);

                // Check if we reached any endpoint
                if (endPointsKeys.indexOf(currentKey) >= 0) {
                    // We don't want to allow route to enter the end point in opposite direction.
                    dirChange = getDirectionChange(currentDirAngle, getDirectionAngle(currentPoint, endCenter, dirLen));
                    if (currentPoint.equals(endCenter) || dirChange < 180) {
                        opt.previousDirAngle = currentDirAngle;
                        return reconstructRoute(parents, currentPoint, startCenter, endCenter);
                    }
                }

                // Go over all possible directions and find neighbors.
                for (var i = 0; i < dirLen; i++) {

                    dir = dirs[i];
                    dirChange = getDirectionChange(currentDirAngle, dir.angle);
                    // if the direction changed rapidly don't use this point
                    // Note that check is relevant only for points with previousDirAngle i.e.
                    // any direction is allowed for starting points
                    if (previousDirAngle && dirChange > opt.maxAllowedDirectionChange) {
                        continue;
                    }

                    var neighborPoint = currentPoint.clone().offset(dir.offsetX, dir.offsetY);
                    var neighborKey = neighborPoint.toString();
                    // Closed points from the openSet were already evaluated.
                    if (openSet.isClose(neighborKey) || !map.isPointAccessible(neighborPoint)) {
                        continue;
                    }

                    // The current direction is ok to proccess.
                    var costFromStart = currentDist + dir.cost + opt.penalties[dirChange];

                    if (!openSet.isOpen(neighborKey) || costFromStart < costs[neighborKey]) {
                        // neighbor point has not been processed yet or the cost of the path
                        // from start is lesser than previously calcluated.
                        parents[neighborKey] = currentPoint;
                        costs[neighborKey] = costFromStart;
                        openSet.add(neighborKey, costFromStart + estimateCost(neighborPoint, endPoints));
                    }
                }

                loopsRemain--;
            }
        }

        // no route found ('to' point wasn't either accessible or finding route took
        // way to much calculations)
        return opt.fallbackRoute(startCenter, endCenter, opt);
    }

    // resolve some of the options
    function resolveOptions(opt) {

        opt.directions = _.result(opt, 'directions');
        opt.penalties = _.result(opt, 'penalties');
        opt.paddingBox = _.result(opt, 'paddingBox');

        _.each(opt.directions, function(direction) {

            var point1 = g.point(0, 0);
            var point2 = g.point(direction.offsetX, direction.offsetY);

            direction.angle = g.normalizeAngle(point1.theta(point2));
        });
    }

    // initiation of the route finding
    function router(vertices, opt) {

        resolveOptions(opt);

        // enable/disable linkView perpendicular option
        this.options.perpendicular = !!opt.perpendicular;

        // expand boxes by specific padding
        var sourceBBox = g.rect(this.sourceBBox).moveAndExpand(opt.paddingBox);
        var targetBBox = g.rect(this.targetBBox).moveAndExpand(opt.paddingBox);

        // pathfinding
        var map = (new ObstacleMap(opt)).build(this.paper.model, this.model);
        var oldVertices = _.map(vertices, g.point);
        var newVertices = [];
        var tailPoint = sourceBBox.center().snapToGrid(opt.step);

        // find a route by concating all partial routes (routes need to go through the vertices)
        // startElement -> vertex[1] -> ... -> vertex[n] -> endElement
        for (var i = 0, len = oldVertices.length; i <= len; i++) {

            var partialRoute = null;

            var from = to || sourceBBox;
            var to = oldVertices[i];

            if (!to) {

                to = targetBBox;

                // 'to' is not a vertex. If the target is a point (i.e. it's not an element), we
                // might use dragging route instead of main routing method if that is enabled.
                var endingAtPoint = !this.model.get('source').id || !this.model.get('target').id;

                if (endingAtPoint && _.isFunction(opt.draggingRoute)) {
                    // Make sure we passing points only (not rects).
                    var dragFrom = from instanceof g.rect ? from.center() : from;
                    partialRoute = opt.draggingRoute(dragFrom, to.origin(), opt);
                }
            }

            // if partial route has not been calculated yet use the main routing method to find one
            partialRoute = partialRoute || findRoute(from, to, map, opt);

            if (partialRoute === null) {
                // The partial route could not be found.
                // use orthogonal (do not avoid elements) route instead.
                if (!_.isFunction(joint.routers.orthogonal)) {
                    throw new Error('Manhattan requires the orthogonal router.');
                }
                return joint.routers.orthogonal(vertices, opt, this);
            }

            var leadPoint = _.first(partialRoute);

            if (leadPoint && leadPoint.equals(tailPoint)) {
                // remove the first point if the previous partial route had the same point as last
                partialRoute.shift();
            }

            tailPoint = _.last(partialRoute) || tailPoint;

            Array.prototype.push.apply(newVertices, partialRoute);
        }

        return newVertices;
    }

    // public function
    return function(vertices, opt, linkView) {

        return router.call(linkView, vertices, _.extend({}, config, opt));
    };

})(g, _, joint);

joint.routers.metro = (function() {

    if (!_.isFunction(joint.routers.manhattan)) {

        throw new Error('Metro requires the manhattan router.');
    }

    var config = {

        // cost of a diagonal step (calculated if not defined).
        diagonalCost: null,

        // an array of directions to find next points on the route
        directions: function() {

            var step = this.step;
            var diagonalCost = this.diagonalCost || Math.ceil(Math.sqrt(step * step << 1));

            return [
                { offsetX: step  , offsetY: 0     , cost: step },
                { offsetX: step  , offsetY: step  , cost: diagonalCost },
                { offsetX: 0     , offsetY: step  , cost: step },
                { offsetX: -step , offsetY: step  , cost: diagonalCost },
                { offsetX: -step , offsetY: 0     , cost: step },
                { offsetX: -step , offsetY: -step , cost: diagonalCost },
                { offsetX: 0     , offsetY: -step , cost: step },
                { offsetX: step  , offsetY: -step , cost: diagonalCost }
            ];
        },
        maxAllowedDirectionChange: 45,
        // a simple route used in situations, when main routing method fails
        // (exceed loops, inaccessible).
        fallbackRoute: function(from, to, opts) {

            // Find a route which breaks by 45 degrees ignoring all obstacles.

            var theta = from.theta(to);

            var a = { x: to.x, y: from.y };
            var b = { x: from.x, y: to.y };

            if (theta % 180 > 90) {
                var t = a;
                a = b;
                b = t;
            }

            var p1 = (theta % 90) < 45 ? a : b;

            var l1 = g.line(from, p1);

            var alpha = 90 * Math.ceil(theta / 90);

            var p2 = g.point.fromPolar(l1.squaredLength(), g.toRad(alpha + 135), p1);

            var l2 = g.line(to, p2);

            var point = l1.intersection(l2);

            return point ? [point.round(), to] : [to];
        }
    };

    // public function
    return function(vertices, opts, linkView) {

        return joint.routers.manhattan(vertices, _.extend({}, config, opts), linkView);
    };

})();

// Does not make any changes to vertices.
// Returns the arguments that are passed to it, unchanged.
joint.routers.normal = function(vertices, opt, linkView) {

    return vertices;
};

// Routes the link always to/from a certain side
//
// Arguments:
//   padding ... gap between the element and the first vertex. :: Default 40.
//   side ... 'left' | 'right' | 'top' | 'bottom' :: Default 'bottom'.
//
joint.routers.oneSide = function(vertices, opt, linkView) {

    var side = opt.side || 'bottom';
    var padding = opt.padding || 40;

    // LinkView contains cached source an target bboxes.
    // Note that those are Geometry rectangle objects.
    var sourceBBox = linkView.sourceBBox;
    var targetBBox = linkView.targetBBox;
    var sourcePoint = sourceBBox.center();
    var targetPoint = targetBBox.center();

    var coordinate, dimension, direction;

    switch (side) {
        case 'bottom':
            direction = 1;
            coordinate = 'y';
            dimension = 'height';
            break;
        case 'top':
            direction = -1;
            coordinate = 'y';
            dimension = 'height';
            break;
        case 'left':
            direction = -1;
            coordinate = 'x';
            dimension = 'width';
            break;
        case 'right':
            direction = 1;
            coordinate = 'x';
            dimension = 'width';
            break;
        default:
            throw new Error('Router: invalid side');
    }

    // move the points from the center of the element to outside of it.
    sourcePoint[coordinate] += direction * (sourceBBox[dimension] / 2 + padding);
    targetPoint[coordinate] += direction * (targetBBox[dimension] / 2 + padding);

    // make link orthogonal (at least the first and last vertex).
    if (direction * (sourcePoint[coordinate] - targetPoint[coordinate]) > 0) {
        targetPoint[coordinate] = sourcePoint[coordinate];
    } else {
        sourcePoint[coordinate] = targetPoint[coordinate];
    }

    return [sourcePoint].concat(vertices, targetPoint);
};

joint.routers.orthogonal = (function() {

    // bearing -> opposite bearing
    var opposite = {
        N: 'S',
        S: 'N',
        E: 'W',
        W: 'E'
    };

    // bearing -> radians
    var radians = {
        N: -Math.PI / 2 * 3,
        S: -Math.PI / 2,
        E: 0,
        W: Math.PI
    };

    // HELPERS //

    // simple bearing method (calculates only orthogonal cardinals)
    function bearing(from, to) {
        if (from.x == to.x) return from.y > to.y ? 'N' : 'S';
        if (from.y == to.y) return from.x > to.x ? 'W' : 'E';
        return null;
    }

    // returns either width or height of a bbox based on the given bearing
    function boxSize(bbox, brng) {
        return bbox[brng == 'W' || brng == 'E' ? 'width' : 'height'];
    }

    // expands a box by specific value
    function expand(bbox, val) {
        return g.rect(bbox).moveAndExpand({ x: -val, y: -val, width: 2 * val, height: 2 * val });
    }

    // transform point to a rect
    function pointBox(p) {
        return g.rect(p.x, p.y, 0, 0);
    }

    // returns a minimal rect which covers the given boxes
    function boundary(bbox1, bbox2) {

        var x1 = Math.min(bbox1.x, bbox2.x);
        var y1 = Math.min(bbox1.y, bbox2.y);
        var x2 = Math.max(bbox1.x + bbox1.width, bbox2.x + bbox2.width);
        var y2 = Math.max(bbox1.y + bbox1.height, bbox2.y + bbox2.height);

        return g.rect(x1, y1, x2 - x1, y2 - y1);
    }

    // returns a point `p` where lines p,p1 and p,p2 are perpendicular and p is not contained
    // in the given box
    function freeJoin(p1, p2, bbox) {

        var p = g.point(p1.x, p2.y);
        if (bbox.containsPoint(p)) p = g.point(p2.x, p1.y);
        // kept for reference
        // if (bbox.containsPoint(p)) p = null;
        return p;
    }

    // PARTIAL ROUTERS //

    function vertexVertex(from, to, brng) {

        var p1 = g.point(from.x, to.y);
        var p2 = g.point(to.x, from.y);
        var d1 = bearing(from, p1);
        var d2 = bearing(from, p2);
        var xBrng = opposite[brng];

        var p = (d1 == brng || (d1 != xBrng && (d2 == xBrng || d2 != brng))) ? p1 : p2;

        return { points: [p], direction: bearing(p, to) };
    }

    function elementVertex(from, to, fromBBox) {

        var p = freeJoin(from, to, fromBBox);

        return { points: [p], direction: bearing(p, to) };
    }

    function vertexElement(from, to, toBBox, brng) {

        var route = {};

        var pts = [g.point(from.x, to.y), g.point(to.x, from.y)];
        var freePts = _.filter(pts, function(pt) { return !toBBox.containsPoint(pt); });
        var freeBrngPts = _.filter(freePts, function(pt) { return bearing(pt, from) != brng; });

        var p;

        if (freeBrngPts.length > 0) {

            // try to pick a point which bears the same direction as the previous segment
            p = _.filter(freeBrngPts, function(pt) { return bearing(from, pt) == brng; }).pop();
            p = p || freeBrngPts[0];

            route.points = [p];
            route.direction = bearing(p, to);

        } else {

            // Here we found only points which are either contained in the element or they would create
            // a link segment going in opposite direction from the previous one.
            // We take the point inside element and move it outside the element in the direction the
            // route is going. Now we can join this point with the current end (using freeJoin).

            p = _.difference(pts, freePts)[0];

            var p2 = g.point(to).move(p, -boxSize(toBBox, brng) / 2);
            var p1 = freeJoin(p2, from, toBBox);

            route.points = [p1, p2];
            route.direction = bearing(p2, to);
        }

        return route;
    }

    function elementElement(from, to, fromBBox, toBBox) {

        var route = elementVertex(to, from, toBBox);
        var p1 = route.points[0];

        if (fromBBox.containsPoint(p1)) {

            route = elementVertex(from, to, fromBBox);
            var p2 = route.points[0];

            if (toBBox.containsPoint(p2)) {

                var fromBorder = g.point(from).move(p2, -boxSize(fromBBox, bearing(from, p2)) / 2);
                var toBorder = g.point(to).move(p1, -boxSize(toBBox, bearing(to, p1)) / 2);
                var mid = g.line(fromBorder, toBorder).midpoint();

                var startRoute = elementVertex(from, mid, fromBBox);
                var endRoute = vertexVertex(mid, to, startRoute.direction);

                route.points = [startRoute.points[0], endRoute.points[0]];
                route.direction = endRoute.direction;
            }
        }

        return route;
    }

    // Finds route for situations where one of end is inside the other.
    // Typically the route is conduct outside the outer element first and
    // let go back to the inner element.
    function insideElement(from, to, fromBBox, toBBox, brng) {

        var route = {};
        var bndry = expand(boundary(fromBBox, toBBox), 1);

        // start from the point which is closer to the boundary
        var reversed = bndry.center().distance(to) > bndry.center().distance(from);
        var start = reversed ? to : from;
        var end = reversed ? from : to;

        var p1, p2, p3;

        if (brng) {
            // Points on circle with radius equals 'W + H` are always outside the rectangle
            // with width W and height H if the center of that circle is the center of that rectangle.
            p1 = g.point.fromPolar(bndry.width + bndry.height, radians[brng], start);
            p1 = bndry.pointNearestToPoint(p1).move(p1, -1);
        } else {
            p1 = bndry.pointNearestToPoint(start).move(start, 1);
        }

        p2 = freeJoin(p1, end, bndry);

        if (p1.round().equals(p2.round())) {
            p2 = g.point.fromPolar(bndry.width + bndry.height, g.toRad(p1.theta(start)) + Math.PI / 2, end);
            p2 = bndry.pointNearestToPoint(p2).move(end, 1).round();
            p3 = freeJoin(p1, p2, bndry);
            route.points = reversed ? [p2, p3, p1] : [p1, p3, p2];
        } else {
            route.points = reversed ? [p2, p1] : [p1, p2];
        }

        route.direction = reversed ? bearing(p1, to) : bearing(p2, to);

        return route;
    }

    // MAIN ROUTER //

    // Return points that one needs to draw a connection through in order to have a orthogonal link
    // routing from source to target going through `vertices`.
    function findOrthogonalRoute(vertices, opt, linkView) {

        var padding = opt.elementPadding || 20;

        var orthogonalVertices = [];
        var sourceBBox = expand(linkView.sourceBBox, padding);
        var targetBBox = expand(linkView.targetBBox, padding);

        vertices = _.map(vertices, g.point);
        vertices.unshift(sourceBBox.center());
        vertices.push(targetBBox.center());

        var brng;

        for (var i = 0, max = vertices.length - 1; i < max; i++) {

            var route = null;
            var from = vertices[i];
            var to = vertices[i + 1];
            var isOrthogonal = !!bearing(from, to);

            if (i == 0) {

                if (i + 1 == max) { // route source -> target

                    // Expand one of elements by 1px so we detect also situations when they
                    // are positioned one next other with no gap between.
                    if (sourceBBox.intersect(expand(targetBBox, 1))) {
                        route = insideElement(from, to, sourceBBox, targetBBox);
                    } else if (!isOrthogonal) {
                        route = elementElement(from, to, sourceBBox, targetBBox);
                    }

                } else { // route source -> vertex

                    if (sourceBBox.containsPoint(to)) {
                        route = insideElement(from, to, sourceBBox, expand(pointBox(to), padding));
                    } else if (!isOrthogonal) {
                        route = elementVertex(from, to, sourceBBox);
                    }
                }

            } else if (i + 1 == max) { // route vertex -> target

                var orthogonalLoop = isOrthogonal && bearing(to, from) == brng;

                if (targetBBox.containsPoint(from) || orthogonalLoop) {
                    route = insideElement(from, to, expand(pointBox(from), padding), targetBBox, brng);
                } else if (!isOrthogonal) {
                    route = vertexElement(from, to, targetBBox, brng);
                }

            } else if (!isOrthogonal) { // route vertex -> vertex
                route = vertexVertex(from, to, brng);
            }

            if (route) {
                Array.prototype.push.apply(orthogonalVertices, route.points);
                brng = route.direction;
            } else {
                // orthogonal route and not looped
                brng = bearing(from, to);
            }

            if (i + 1 < max) {
                orthogonalVertices.push(to);
            }
        }

        return orthogonalVertices;
    }

    return findOrthogonalRoute;

})();

joint.connectors.normal = function(sourcePoint, targetPoint, vertices) {

    // Construct the `d` attribute of the `<path>` element.
    var d = ['M', sourcePoint.x, sourcePoint.y];

    _.each(vertices, function(vertex) {

        d.push(vertex.x, vertex.y);
    });

    d.push(targetPoint.x, targetPoint.y);

    return d.join(' ');
};

joint.connectors.rounded = function(sourcePoint, targetPoint, vertices, opts) {

    opts = opts || {};

    var offset = opts.radius || 10;

    var c1, c2, d1, d2, prev, next;

    // Construct the `d` attribute of the `<path>` element.
    var d = ['M', sourcePoint.x, sourcePoint.y];

    _.each(vertices, function(vertex, index) {

        // the closest vertices
        prev = vertices[index - 1] || sourcePoint;
        next = vertices[index + 1] || targetPoint;

        // a half distance to the closest vertex
        d1 = d2 || g.point(vertex).distance(prev) / 2;
        d2 = g.point(vertex).distance(next) / 2;

        // control points
        c1 = g.point(vertex).move(prev, -Math.min(offset, d1)).round();
        c2 = g.point(vertex).move(next, -Math.min(offset, d2)).round();

        d.push(c1.x, c1.y, 'S', vertex.x, vertex.y, c2.x, c2.y, 'L');
    });

    d.push(targetPoint.x, targetPoint.y);

    return d.join(' ');
};

joint.connectors.smooth = function(sourcePoint, targetPoint, vertices) {

    var d;

    if (vertices.length) {

        d = g.bezier.curveThroughPoints([sourcePoint].concat(vertices).concat([targetPoint]));

    } else {
        // if we have no vertices use a default cubic bezier curve, cubic bezier requires
        // two control points. The two control points are both defined with X as mid way
        // between the source and target points. SourceControlPoint Y is equal to sourcePoint Y
        // and targetControlPointY being equal to targetPointY.
        var controlPointX = (sourcePoint.x + targetPoint.x) / 2;

        d = [
            'M', sourcePoint.x, sourcePoint.y,
            'C', controlPointX, sourcePoint.y, controlPointX, targetPoint.y,
            targetPoint.x, targetPoint.y
        ];
    }

    return d.join(' ');
};

joint.connectors.jumpover = (function(_, g) {

    // default size of jump if not specified in options
    var JUMP_SIZE = 5;

    // available jump types
    var JUMP_TYPES = ['arc', 'gap', 'cubic'];

    // takes care of math. error for case when jump is too close to end of line
    var CLOSE_PROXIMITY_PADDING = 1;

    // list of connector types not to jump over.
    var IGNORED_CONNECTORS = ['smooth'];

    /**
     * Transform start/end and vertices into series of lines
     * @param {g.point} sourcePoint start point
     * @param {g.point} targetPoint end point
     * @param {g.point[]} vertices optional list of vertices
     * @return {g.line[]} [description]
     */
    function createLines(sourcePoint, targetPoint, vertices) {
        // make a flattened array of all points
        var points = [].concat(sourcePoint, vertices, targetPoint);
        return points.reduce(function(resultLines, point, idx) {
            // if there is a next point, make a line with it
            var nextPoint = points[idx + 1];
            if (nextPoint != null) {
                resultLines[idx] = g.line(point, nextPoint);
            }
            return resultLines;
        }, []);
    }

    function setupUpdating(jumpOverLinkView) {
        var updateList = jumpOverLinkView.paper._jumpOverUpdateList;

        // first time setup for this paper
        if (updateList == null) {
            updateList = jumpOverLinkView.paper._jumpOverUpdateList = [];
            jumpOverLinkView.paper.on('cell:pointerup', updateJumpOver);
            jumpOverLinkView.paper.model.on('reset', function() {
                updateList = jumpOverLinkView.paper._jumpOverUpdateList = [];
            });
        }

        // add this link to a list so it can be updated when some other link is updated
        if (updateList.indexOf(jumpOverLinkView) < 0) {
            updateList.push(jumpOverLinkView);

            // watch for change of connector type or removal of link itself
            // to remove the link from a list of jump over connectors
            jumpOverLinkView.listenToOnce(jumpOverLinkView.model, 'change:connector remove', function() {
                updateList.splice(updateList.indexOf(jumpOverLinkView), 1);
            });
        }
    }

    /**
     * Handler for a batch:stop event to force
     * update of all registered links with jump over connector
     * @param {object} batchEvent optional object with info about batch
     */
    function updateJumpOver() {
        var updateList = this._jumpOverUpdateList;
        for (var i = 0; i < updateList.length; i++) {
            updateList[i].update();
        }
    }

    /**
     * Utility function to collect all intersection poinst of a single
     * line against group of other lines.
     * @param {g.line} line where to find points
     * @param {g.line[]} crossCheckLines lines to cross
     * @return {g.point[]} list of intersection points
     */
    function findLineIntersections(line, crossCheckLines) {
        return _(crossCheckLines).map(function(crossCheckLine) {
            return line.intersection(crossCheckLine);
        }).compact().value();
    }

    /**
     * Sorting function for list of points by their distance.
     * @param {g.point} p1 first point
     * @param {g.point} p2 second point
     * @return {number} squared distance between points
     */
    function sortPoints(p1, p2) {
        return g.line(p1, p2).squaredLength();
    }

    /**
     * Split input line into multiple based on intersection points.
     * @param {g.line} line input line to split
     * @param {g.point[]} intersections poinst where to split the line
     * @param {number} jumpSize the size of jump arc (length empty spot on a line)
     * @return {g.line[]} list of lines being split
     */
    function createJumps(line, intersections, jumpSize) {
        return intersections.reduce(function(resultLines, point, idx) {
            // skipping points that were merged with the previous line
            // to make bigger arc over multiple lines that are close to each other
            if (point.skip === true) {
                return resultLines;
            }

            // always grab the last line from buffer and modify it
            var lastLine = resultLines.pop() || line;

            // calculate start and end of jump by moving by a given size of jump
            var jumpStart = g.point(point).move(lastLine.start, -(jumpSize));
            var jumpEnd = g.point(point).move(lastLine.start, +(jumpSize));

            // now try to look at the next intersection point
            var nextPoint = intersections[idx + 1];
            if (nextPoint != null) {
                var distance = jumpEnd.distance(nextPoint);
                if (distance <= jumpSize) {
                    // next point is close enough, move the jump end by this
                    // difference and mark the next point to be skipped
                    jumpEnd = nextPoint.move(lastLine.start, distance);
                    nextPoint.skip = true;
                }
            } else {
                // this block is inside of `else` as an optimization so the distance is
                // not calculated when we know there are no other intersection points
                var endDistance = jumpStart.distance(lastLine.end);
                // if the end is too close to possible jump, draw remaining line instead of a jump
                if (endDistance < jumpSize * 2 + CLOSE_PROXIMITY_PADDING) {
                    resultLines.push(lastLine);
                    return resultLines;
                }
            }

            var startDistance = jumpEnd.distance(lastLine.start);
            if (startDistance < jumpSize * 2 + CLOSE_PROXIMITY_PADDING) {
                // if the start of line is too close to jump, draw that line instead of a jump
                resultLines.push(lastLine);
                return resultLines;
            }

            // finally create a jump line
            var jumpLine = g.line(jumpStart, jumpEnd);
            // it's just simple line but with a `isJump` property
            jumpLine.isJump = true;

            resultLines.push(
                g.line(lastLine.start, jumpStart),
                jumpLine,
                g.line(jumpEnd, lastLine.end)
            );
            return resultLines;
        }, []);
    }

    /**
     * Assemble `D` attribute of a SVG path by iterating given lines.
     * @param {g.line[]} lines source lines to use
     * @param {number} jumpSize the size of jump arc (length empty spot on a line)
     * @return {string}
     */
    function buildPath(lines, jumpSize, jumpType) {
        // first move to the start of a first line
        var start = ['M', lines[0].start.x, lines[0].start.y];

        // make a paths from lines
        var paths = _(lines).map(function(line) {
            if (line.isJump) {
                var diff;
                if (jumpType === 'arc') {
                    diff = line.start.difference(line.end);
                    // determine rotation of arc based on difference between points
                    var xAxisRotate = Number(diff.x < 0 && diff.y < 0);
                    // for a jump line we create an arc instead
                    return ['A', jumpSize, jumpSize, 0, 0, xAxisRotate, line.end.x, line.end.y];
                } else if (jumpType === 'gap') {
                    return ['M', line.end.x, line.end.y];
                } else if (jumpType === 'cubic') {
                    diff = line.start.difference(line.end);
                    var angle = line.start.theta(line.end);
                    var xOffset = jumpSize * 0.6;
                    var yOffset = jumpSize * 1.35;
                    // determine rotation of curve based on difference between points
                    if (diff.x < 0 && diff.y < 0) {
                        yOffset *= -1;
                    }
                    var controlStartPoint = g.point(line.start.x + xOffset, line.start.y + yOffset).rotate(line.start, angle);
                    var controlEndPoint = g.point(line.end.x - xOffset, line.end.y + yOffset).rotate(line.end, angle);
                    // create a cubic bezier curve
                    return ['C', controlStartPoint.x, controlStartPoint.y, controlEndPoint.x, controlEndPoint.y, line.end.x, line.end.y];
                }
            }
            return ['L', line.end.x, line.end.y];
        }).flatten().value();

        return [].concat(start, paths).join(' ');
    }

    /**
     * Actual connector function that will be run on every update.
     * @param {g.point} sourcePoint start point of this link
     * @param {g.point} targetPoint end point of this link
     * @param {g.point[]} vertices of this link
     * @param {object} opts options
     * @property {number} size optional size of a jump arc
     * @return {string} created `D` attribute of SVG path
     */
    return function(sourcePoint, targetPoint, vertices, opts) { // eslint-disable-line max-params

        setupUpdating(this);

        var jumpSize = opts.size || JUMP_SIZE;
        var jumpType = opts.jump && ('' + opts.jump).toLowerCase();
        var ignoreConnectors = opts.ignoreConnectors || IGNORED_CONNECTORS;

        // grab the first jump type as a default if specified one is invalid
        if (JUMP_TYPES.indexOf(jumpType) === -1) {
            jumpType = JUMP_TYPES[0];
        }

        var paper = this.paper;
        var graph = paper.model;
        var allLinks = graph.getLinks();

        // there is just one link, draw it directly
        if (allLinks.length === 1) {
            return buildPath(
                createLines(sourcePoint, targetPoint, vertices),
                jumpSize, jumpType
            );
        }

        var thisModel = this.model;
        var thisIndex = allLinks.indexOf(thisModel);
        var defaultConnector = paper.options.defaultConnector || {};

        // not all links are meant to be jumped over.
        var links = allLinks.filter(function(link, idx) {

            var connector = link.get('connector') || defaultConnector;

            // avoid jumping over links with connector type listed in `ignored connectors`.
            if (_.contains(ignoreConnectors, connector.name)) {
                return false;
            }
            // filter out links that are above this one and  have the same connector type
            // otherwise there would double hoops for each intersection
            if (idx > thisIndex) {
                return connector.name !== 'jumpover';
            }
            return true;
        });

        // find views for all links
        var linkViews = links.map(function(link) {
            return paper.findViewByModel(link);
        });

        // create lines for this link
        var thisLines = createLines(
            sourcePoint,
            targetPoint,
            vertices
        );

        // create lines for all other links
        var linkLines = linkViews.map(function(linkView) {
            if (linkView == null) {
                return [];
            }
            if (linkView === this) {
                return thisLines;
            }
            return createLines(
                linkView.sourcePoint,
                linkView.targetPoint,
                linkView.route
            );
        }, this);

        // transform lines for this link by splitting with jump lines at
        // points of intersection with other links
        var jumpingLines = thisLines.reduce(function(resultLines, thisLine) {
            // iterate all links and grab the intersections with this line
            // these are then sorted by distance so the line can be split more easily
            var intersections = _(links).map(function(link, i) {
                // don't intersection with itself
                if (link === thisModel) {
                    return null;
                }
                return findLineIntersections(thisLine, linkLines[i]);
            }).flatten().compact().sortBy(_.partial(sortPoints, thisLine.start)).value();

            if (intersections.length > 0) {
                // split the line based on found intersection points
                resultLines.push.apply(resultLines, createJumps(thisLine, intersections, jumpSize));
            } else {
                // without any intersection the line goes uninterrupted
                resultLines.push(thisLine);
            }
            return resultLines;
        }, []);

        return buildPath(jumpingLines, jumpSize, jumpType);
    };
}(_, g));

(function(_, g, joint) {

    function portTransformAttrs(point, angle, opt) {

        var trans = point.toJSON();

        trans.angle = angle || 0;

        return _.defaults({}, opt, trans);
    }

    function lineLayout(ports, p1, p2) {
        return _.map(ports, function(port, index, ports) {
            var p = this.pointAt(((index + 0.5) / ports.length));
            // `dx`,`dy` per port offset option
            if (port.dx || port.dy) {
                p.offset(port.dx || 0, port.dy || 0);
            }

            return portTransformAttrs(p.round(), 0, port);
        }, g.line(p1, p2));
    }

    function ellipseLayout(ports, elBBox, startAngle, stepFn) {

        var center = elBBox.center();
        var ratio = elBBox.width / elBBox.height;
        var p1 = elBBox.topMiddle();

        var ellipse = g.Ellipse.fromRect(elBBox);

        return _.map(ports, function(port, index, ports) {

            var angle = startAngle + stepFn(index, ports.length);
            var p2 = p1.clone()
                .rotate(center, -angle)
                .scale(ratio, 1, center);

            var theta = port.compensateRotation ? -ellipse.tangentTheta(p2) : 0;

            // `dx`,`dy` per port offset option
            if (port.dx || port.dy) {
                p2.offset(port.dx || 0, port.dy || 0);
            }

            // `dr` delta radius option
            if (port.dr) {
                p2.move(center, port.dr);
            }

            return portTransformAttrs(p2.round(), theta, port);
        });
    }

    // Creates a point stored in arguments
    function argPoint(bbox, args) {

        var x = args.x;
        if (_.isString(x)) {
            x = parseFloat(x) / 100 * bbox.width;
        }

        var y = args.y;
        if (_.isString(y)) {
            y = parseFloat(y) / 100 * bbox.height;
        }

        return g.point(x || 0, y || 0);
    }

    joint.layout.Port = {

        /**
         * @param {Array<Object>} ports
         * @param {g.Rect} elBBox
         * @param {Object=} opt opt Group options
         * @returns {Array<g.Point>}
         */
        absolute: function(ports, elBBox, opt) {
            //TODO v.talas angle
            return _.map(ports, _.partial(argPoint, elBBox));
        },

        /**
         * @param {Array<Object>} ports
         * @param {g.Rect} elBBox
         * @param {Object=} opt opt Group options
         * @returns {Array<g.Point>}
         */
        fn: function(ports, elBBox, opt) {
            return opt.fn(ports, elBBox, opt);
        },

        /**
         * @param {Array<Object>} ports
         * @param {g.Rect} elBBox
         * @param {Object=} opt opt Group options
         * @returns {Array<g.Point>}
         */
        line: function(ports, elBBox, opt) {

            var start = argPoint(elBBox, opt.start || elBBox.origin());
            var end = argPoint(elBBox, opt.end || elBBox.corner());

            return lineLayout(ports, start, end);
        },

        /**
         * @param {Array<Object>} ports
         * @param {g.Rect} elBBox
         * @param {Object=} opt opt Group options
         * @returns {Array<g.Point>}
         */
        left: function(ports, elBBox, opt) {
            return lineLayout(ports, elBBox.origin(), elBBox.bottomLeft());
        },

        /**
         * @param {Array<Object>} ports
         * @param {g.Rect} elBBox
         * @param {Object=} opt opt Group options
         * @returns {Array<g.Point>}
         */
        right: function(ports, elBBox, opt) {
            return lineLayout(ports, elBBox.topRight(), elBBox.corner());
        },

        /**
         * @param {Array<Object>} ports
         * @param {g.Rect} elBBox
         * @param {Object=} opt opt Group options
         * @returns {Array<g.Point>}
         */
        top: function(ports, elBBox, opt) {
            return lineLayout(ports, elBBox.origin(), elBBox.topRight());
        },

        /**
         * @param {Array<Object>} ports
         * @param {g.Rect} elBBox
         * @param {Object=} opt opt Group options
         * @returns {Array<g.Point>}
         */
        bottom: function(ports, elBBox, opt) {
            return lineLayout(ports, elBBox.bottomLeft(), elBBox.corner());
        },

        /**
         * @param {Array<Object>} ports
         * @param {g.Rect} elBBox
         * @param {Object=} opt Group options
         * @returns {Array<g.Point>}
         */
        ellipseSpread: function(ports, elBBox, opt) {

            var startAngle = opt.startAngle || 0;
            var stepAngle = opt.step || 360 / ports.length;

            return ellipseLayout(ports, elBBox, startAngle, function(index) {
                return index * stepAngle;
            });
        },

        /**
         * @param {Array<Object>} ports
         * @param {g.Rect} elBBox
         * @param {Object=} opt Group options
         * @returns {Array<g.Point>}
         */
        ellipse: function(ports, elBBox, opt) {

            var startAngle = opt.startAngle || 0;
            var stepAngle = opt.step || 20;

            return ellipseLayout(ports, elBBox, startAngle, function(index, count) {
                return (index + 0.5 - count / 2) * stepAngle;
            });
        }
    };

})(_, g, joint);

(function(_, g, joint) {

    function labelAttributes(opt1, opt2) {

        return _.defaultsDeep({}, opt1, opt2, {
            x: 0,
            y: 0,
            angle: 0,
            attrs: {
                '.': {
                    y: '0',
                    'text-anchor': 'start'
                }
            }
        });

    }

    function outsideLayout(portPosition, elBBox, autoOrient, opt) {

        opt = _.defaults({}, opt, { offset: 15 });
        var angle = elBBox.center().theta(portPosition);
        var x = getBBoxAngles(elBBox);

        var tx, ty, y, textAnchor;
        var offset = opt.offset;
        var orientAngle = 0;

        if (angle < x[1] || angle > x[2]) {
            y = '.3em';
            tx = offset;
            ty = 0;
            textAnchor = 'start';
        } else if (angle < x[0]) {
            y = '0';
            tx = 0;
            ty = -offset;
            if (autoOrient) {
                orientAngle = -90;
                textAnchor = 'start';
            } else {
                textAnchor = 'middle';
            }
        } else if (angle < x[3]) {
            y = '.3em';
            tx = -offset;
            ty = 0;
            textAnchor = 'end';
        } else {
            y = '.6em';
            tx = 0;
            ty = offset;
            if (autoOrient) {
                orientAngle = 90;
                textAnchor = 'start';
            } else {
                textAnchor = 'middle';
            }
        }

        var round = Math.round;
        return labelAttributes({
            x: round(tx),
            y: round(ty),
            angle: orientAngle,
            attrs: {
                '.': {
                    y: y,
                    'text-anchor': textAnchor
                }
            }
        });
    }

    function getBBoxAngles(elBBox) {

        var center = elBBox.center();

        var tl = center.theta(elBBox.origin());
        var bl = center.theta(elBBox.bottomLeft());
        var br = center.theta(elBBox.corner());
        var tr = center.theta(elBBox.topRight());

        return [tl, tr, br, bl];
    }

    function insideLayout(portPosition, elBBox, autoOrient, opt) {

        var angle = elBBox.center().theta(portPosition);
        opt = _.defaults({}, opt, { offset: 15 });

        var tx, ty, y, textAnchor;
        var offset = opt.offset;
        var orientAngle = 0;

        var bBoxAngles = getBBoxAngles(elBBox);

        if (angle < bBoxAngles[1] || angle > bBoxAngles[2]) {
            y = '.3em';
            tx = -offset;
            ty = 0;
            textAnchor = 'end';
        } else if (angle < bBoxAngles[0]) {
            y = '.6em';
            tx = 0;
            ty = offset;
            if (autoOrient) {
                orientAngle = 90;
                textAnchor = 'start';
            } else {
                textAnchor = 'middle';
            }
        } else if (angle < bBoxAngles[3]) {
            y = '.3em';
            tx = offset;
            ty = 0;
            textAnchor = 'start';
        } else {
            y = '0em';
            tx = 0;
            ty = -offset;
            if (autoOrient) {
                orientAngle = -90;
                textAnchor = 'start';
            } else {
                textAnchor = 'middle';
            }
        }

        var round = Math.round;
        return labelAttributes({
            x: round(tx),
            y: round(ty),
            angle: orientAngle,
            attrs: {
                '.': {
                    y: y,
                    'text-anchor': textAnchor
                }
            }
        });
    }

    function radialLayout(portCenterOffset, autoOrient, opt) {

        opt = _.defaults({}, opt, { offset: 20 });

        var origin = g.point(0, 0);
        var angle = -portCenterOffset.theta(origin);
        var orientAngle = angle;
        var offset = portCenterOffset.clone()
            .move(origin, opt.offset)
            .difference(portCenterOffset)
            .round();

        var y = '.3em';
        var textAnchor;

        if ((angle + 90) % 180 === 0) {
            textAnchor = autoOrient ? 'end' : 'middle';
            if (!autoOrient && angle === -270) {
                y = '0em';
            }
        } else if (angle > -270 && angle < -90) {
            textAnchor = 'start';
            orientAngle = angle - 180;
        } else {
            textAnchor = 'end';
        }

        var round = Math.round;
        return labelAttributes({
            x: round(offset.x),
            y: round(offset.y),
            angle: autoOrient ? orientAngle : 0,
            attrs: {
                '.': {
                    y: y,
                    'text-anchor': textAnchor
                }
            }
        });
    }

    joint.layout.PortLabel = {

        manual: _.rearg(labelAttributes, 2),

        left: function(portPosition, elBBox, opt) {
            return labelAttributes(opt, { x: -15, attrs: { '.': { y: '.3em', 'text-anchor': 'end' } } });
        },

        right: function(portPosition, elBBox, opt) {
            return labelAttributes(opt, { x: 15, attrs: { '.': { y: '.3em', 'text-anchor': 'start' } } });
        },

        top: function(portPosition, elBBox, opt) {
            return labelAttributes(opt, { y: -15, attrs: { '.': { 'text-anchor': 'middle' } } });
        },

        bottom: function(portPosition, elBBox, opt) {
            return labelAttributes(opt, { y: 15, attrs: { '.': { y: '.6em', 'text-anchor': 'middle' } } });
        },

        outsideOriented: function(portPosition, elBBox, opt) {
            return outsideLayout(portPosition, elBBox, true, opt);
        },

        outside: function(portPosition, elBBox, opt) {
            return outsideLayout(portPosition, elBBox, false, opt);
        },

        insideOriented: function(portPosition, elBBox, opt) {
            return insideLayout(portPosition, elBBox, true, opt);
        },

        inside: function(portPosition, elBBox, opt) {
            return insideLayout(portPosition, elBBox, false, opt);
        },

        radial: function(portPosition, elBBox, opt) {
            return radialLayout(portPosition.difference(elBBox.center()), false, opt);
        },

        radialOriented: function(portPosition, elBBox, opt) {
            return radialLayout(portPosition.difference(elBBox.center()), true, opt);
        }
    };

})(_, g, joint);

joint.highlighters.addClass = {

    className: joint.util.addClassNamePrefix('highlighted'),

    /**
     * @param {joint.dia.CellView} cellView
     * @param {Element} magnetEl
     * @param {object=} opt
     */
    highlight: function(cellView, magnetEl, opt) {

        var options = opt || {};
        var className = options.className || this.className;
        V(magnetEl).addClass(className);
    },

    /**
     * @param {joint.dia.CellView} cellView
     * @param {Element} magnetEl
     * @param {object=} opt
     */
    unhighlight: function(cellView, magnetEl, opt) {

        var options = opt || {};
        var className = options.className || this.className;
        V(magnetEl).removeClass(className);
    }
};

joint.highlighters.opacity = {

    /**
     * @param {joint.dia.CellView} cellView
     * @param {Element} magnetEl
     */
    highlight: function(cellView, magnetEl) {

        V(magnetEl).addClass(joint.util.addClassNamePrefix('highlight-opacity'));
    },

    /**
     * @param {joint.dia.CellView} cellView
     * @param {Element} magnetEl
     */
    unhighlight: function(cellView, magnetEl) {

        V(magnetEl).removeClass(joint.util.addClassNamePrefix('highlight-opacity'));
    }
};

joint.highlighters.stroke = {

    defaultOptions: {
        padding: 3,
        rx: 0,
        ry: 0,
        attrs: {
            'stroke-width': 3,
            stroke: '#FEB663'
        }
    },

    _views: {},

    getHighlighterId: function(magnetEl, opt) {

        return magnetEl.id + JSON.stringify(opt);
    },

    removeHighlighter: function(id) {
        if (this._views[id]) {
            this._views[id].remove();
            this._views[id] = null;
        }
    },

    /**
     * @param {joint.dia.CellView} cellView
     * @param {Element} magnetEl
     * @param {object=} opt
     */
    highlight: function(cellView, magnetEl, opt) {

        var id = this.getHighlighterId(magnetEl, opt);

        // Only highlight once.
        if (this._views[id]) return;

        var options = _.defaults(opt || {}, this.defaultOptions);

        var magnetVel = V(magnetEl);
        var magnetBBox;

        try {

            var pathData = magnetVel.convertToPathData();

        } catch (error) {

            // Failed to get path data from magnet element.
            // Draw a rectangle around the entire cell view instead.
            magnetBBox = magnetVel.bbox(true/* without transforms */);
            pathData = V.rectToPath(_.extend({}, options, magnetBBox));
        }

        var highlightVel = V('path').attr({
            d: pathData,
            'pointer-events': 'none',
            'vector-effect': 'non-scaling-stroke',
            'fill': 'none'
        }).attr(options.attrs);

        highlightVel.transform(cellView.el.getCTM().inverse());
        highlightVel.transform(magnetEl.getCTM());

        var padding = options.padding;
        if (padding) {

            magnetBBox || (magnetBBox = magnetVel.bbox(true));
            // Add padding to the highlight element.
            var cx = magnetBBox.x + (magnetBBox.width / 2);
            var cy = magnetBBox.y + (magnetBBox.height / 2);
            var sx = (magnetBBox.width + padding) / magnetBBox.width;
            var sy = (magnetBBox.height + padding) / magnetBBox.height;
            highlightVel.transform({
                a: sx,
                b: 0,
                c: 0,
                d: sy,
                e: cx - sx * cx,
                f: cy - sy * cy
            });
        }

        // joint.mvc.View will handle the theme class name and joint class name prefix.
        var highlightView = this._views[id] = new joint.mvc.View({
            svgElement: true,
            className: 'highlight-stroke',
            el: highlightVel.node
        });

        // Remove the highlight view when the cell is removed from the graph.
        var removeHandler = _.bind(this.removeHighlighter, this, id);
        var cell = cellView.model;
        highlightView.listenTo(cell, 'remove', removeHandler);
        highlightView.listenTo(cell.graph, 'reset', removeHandler);

        cellView.vel.append(highlightVel);
    },

    /**
     * @param {joint.dia.CellView} cellView
     * @param {Element} magnetEl
     * @param {object=} opt
     */
    unhighlight: function(cellView, magnetEl, opt) {

        this.removeHighlighter(this.getHighlighterId(magnetEl, opt));
    }
};

joint.shapes.erd = {};

joint.shapes.erd.Entity = joint.dia.Element.extend({

    markup: '<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>',

    defaults: _.defaultsDeep({

        type: 'erd.Entity',
        size: { width: 150, height: 60 },
        attrs: {
            '.outer': {
                fill: '#2ECC71', stroke: '#27AE60', 'stroke-width': 2,
                points: '100,0 100,60 0,60 0,0'
            },
            '.inner': {
                fill: '#2ECC71', stroke: '#27AE60', 'stroke-width': 2,
                points: '95,5 95,55 5,55 5,5',
                display: 'none'
            },
            text: {
                text: 'Entity',
                'font-family': 'Arial', 'font-size': 14,
                'ref-x': .5, 'ref-y': .5,
                'y-alignment': 'middle', 'text-anchor': 'middle'
            }
        }

    }, joint.dia.Element.prototype.defaults)
});

joint.shapes.erd.WeakEntity = joint.shapes.erd.Entity.extend({

    defaults: _.defaultsDeep({

        type: 'erd.WeakEntity',

        attrs: {
            '.inner' : { display: 'auto' },
            text: { text: 'Weak Entity' }
        }

    }, joint.shapes.erd.Entity.prototype.defaults)
});

joint.shapes.erd.Relationship = joint.dia.Element.extend({

    markup: '<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>',

    defaults: _.defaultsDeep({

        type: 'erd.Relationship',
        size: { width: 80, height: 80 },
        attrs: {
            '.outer': {
                fill: '#3498DB', stroke: '#2980B9', 'stroke-width': 2,
                points: '40,0 80,40 40,80 0,40'
            },
            '.inner': {
                fill: '#3498DB', stroke: '#2980B9', 'stroke-width': 2,
                points: '40,5 75,40 40,75 5,40',
                display: 'none'
            },
            text: {
                text: 'Relationship',
                'font-family': 'Arial', 'font-size': 12,
                'ref-x': .5, 'ref-y': .5,
                'y-alignment': 'middle', 'text-anchor': 'middle'
            }
        }

    }, joint.dia.Element.prototype.defaults)
});

joint.shapes.erd.IdentifyingRelationship = joint.shapes.erd.Relationship.extend({

    defaults: _.defaultsDeep({

        type: 'erd.IdentifyingRelationship',

        attrs: {
            '.inner': { display: 'auto' },
            text: { text: 'Identifying' }
        }

    }, joint.shapes.erd.Relationship.prototype.defaults)
});

joint.shapes.erd.Attribute = joint.dia.Element.extend({

    markup: '<g class="rotatable"><g class="scalable"><ellipse class="outer"/><ellipse class="inner"/></g><text/></g>',

    defaults: _.defaultsDeep({

        type: 'erd.Attribute',
        size: { width: 100, height: 50 },
        attrs: {
            'ellipse': {
                transform: 'translate(50, 25)'
            },
            '.outer': {
                stroke: '#D35400', 'stroke-width': 2,
                cx: 0, cy: 0, rx: 50, ry: 25,
                fill: '#E67E22'
            },
            '.inner': {
                stroke: '#D35400', 'stroke-width': 2,
                cx: 0, cy: 0, rx: 45, ry: 20,
                fill: '#E67E22', display: 'none'
            },
            text: {
                'font-family': 'Arial', 'font-size': 14,
                'ref-x': .5, 'ref-y': .5,
                'y-alignment': 'middle', 'text-anchor': 'middle'
            }
        }

    }, joint.dia.Element.prototype.defaults)

});

joint.shapes.erd.Multivalued = joint.shapes.erd.Attribute.extend({

    defaults: _.defaultsDeep({

        type: 'erd.Multivalued',

        attrs: {
            '.inner': { display: 'block' },
            text: { text: 'multivalued' }
        }

    }, joint.shapes.erd.Attribute.prototype.defaults)
});

joint.shapes.erd.Derived = joint.shapes.erd.Attribute.extend({

    defaults: _.defaultsDeep({

        type: 'erd.Derived',

        attrs: {
            '.outer': { 'stroke-dasharray': '3,5' },
            text: { text: 'derived' }
        }

    }, joint.shapes.erd.Attribute.prototype.defaults)
});

joint.shapes.erd.Key = joint.shapes.erd.Attribute.extend({

    defaults: _.defaultsDeep({

        type: 'erd.Key',

        attrs: {
            ellipse: { 'stroke-width': 4 },
            text: { text: 'key', 'font-weight': '800', 'text-decoration': 'underline' }
        }

    }, joint.shapes.erd.Attribute.prototype.defaults)
});

joint.shapes.erd.Normal = joint.shapes.erd.Attribute.extend({

    defaults: _.defaultsDeep({

        type: 'erd.Normal',

        attrs: { text: { text: 'Normal' }}

    }, joint.shapes.erd.Attribute.prototype.defaults)
});

joint.shapes.erd.ISA = joint.dia.Element.extend({

    markup: '<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>',

    defaults: _.defaultsDeep({

        type: 'erd.ISA',
        size: { width: 100, height: 50 },
        attrs: {
            polygon: {
                points: '0,0 50,50 100,0',
                fill: '#F1C40F', stroke: '#F39C12', 'stroke-width': 2
            },
            text: {
                text: 'ISA', 'font-size': 18,
                'ref-x': .5, 'ref-y': .3,
                'y-alignment': 'middle', 'text-anchor': 'middle'
            }
        }

    }, joint.dia.Element.prototype.defaults)

});

joint.shapes.erd.Line = joint.dia.Link.extend({

    defaults: { type: 'erd.Line' },

    cardinality: function(value) {
        this.set('labels', [{ position: -20, attrs: { text: { dy: -8, text: value }}}]);
    }
});

joint.shapes.fsa = {};

joint.shapes.fsa.State = joint.shapes.basic.Circle.extend({
    defaults: _.defaultsDeep({
        type: 'fsa.State',
        attrs: {
            circle: { 'stroke-width': 3 },
            text: { 'font-weight': '800' }
        }
    }, joint.shapes.basic.Circle.prototype.defaults)
});

joint.shapes.fsa.StartState = joint.dia.Element.extend({

    markup: '<g class="rotatable"><g class="scalable"><circle/></g></g>',

    defaults: _.defaultsDeep({

        type: 'fsa.StartState',
        size: { width: 20, height: 20 },
        attrs: {
            circle: {
                transform: 'translate(10, 10)',
                r: 10,
                fill: '#000000'
            }
        }

    }, joint.dia.Element.prototype.defaults)
});

joint.shapes.fsa.EndState = joint.dia.Element.extend({

    markup: '<g class="rotatable"><g class="scalable"><circle class="outer"/><circle class="inner"/></g></g>',

    defaults: _.defaultsDeep({

        type: 'fsa.EndState',
        size: { width: 20, height: 20 },
        attrs: {
            '.outer': {
                transform: 'translate(10, 10)',
                r: 10,
                fill: '#ffffff',
                stroke: '#000000'
            },

            '.inner': {
                transform: 'translate(10, 10)',
                r: 6,
                fill: '#000000'
            }
        }

    }, joint.dia.Element.prototype.defaults)
});

joint.shapes.fsa.Arrow = joint.dia.Link.extend({

    defaults: _.defaultsDeep({
        type: 'fsa.Arrow',
        attrs: { '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' }},
        smooth: true
    }, joint.dia.Link.prototype.defaults)
});


joint.shapes.org = {};

joint.shapes.org.Member = joint.dia.Element.extend({

    markup: '<g class="rotatable"><g class="scalable"><rect class="card"/><image/></g><text class="rank"/><text class="name"/></g>',

    defaults: _.defaultsDeep({

        type: 'org.Member',
        size: { width: 180, height: 70 },
        attrs: {

            rect: { width: 170, height: 60 },

            '.card': {
                fill: '#FFFFFF', stroke: '#000000', 'stroke-width': 2,
                'pointer-events': 'visiblePainted', rx: 10, ry: 10
            },

            image: {
                width: 48, height: 48,
                ref: '.card', 'ref-x': 10, 'ref-y': 5
            },

            '.rank': {
                'text-decoration': 'underline',
                ref: '.card', 'ref-x': 0.9, 'ref-y': 0.2,
                'font-family': 'Courier New', 'font-size': 14,
                'text-anchor': 'end'
            },

            '.name': {
                'font-weight': '800',
                ref: '.card', 'ref-x': 0.9, 'ref-y': 0.6,
                'font-family': 'Courier New', 'font-size': 14,
                'text-anchor': 'end'
            }
        }
    }, joint.dia.Element.prototype.defaults)
});

joint.shapes.org.Arrow = joint.dia.Link.extend({

    defaults: {
        type: 'org.Arrow',
        source: { selector: '.card' }, target: { selector: '.card' },
        attrs: { '.connection': { stroke: '#585858', 'stroke-width': 3 }},
        z: -1
    }
});


joint.shapes.chess = {};

joint.shapes.chess.KingWhite = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><g style="fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;"><path      d="M 22.5,11.63 L 22.5,6"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path      d="M 20,8 L 25,8"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path      d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25"      style="fill:#ffffff; stroke:#000000; stroke-linecap:butt; stroke-linejoin:miter;" />    <path      d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z "      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 11.5,30 C 17,27 27,27 32.5,30"      style="fill:none; stroke:#000000;" />    <path      d="M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5"      style="fill:none; stroke:#000000;" />    <path      d="M 11.5,37 C 17,34 27,34 32.5,37"      style="fill:none; stroke:#000000;" />  </g></g></g>',

    defaults: _.defaultsDeep({

        type: 'chess.KingWhite',
        size: { width: 42, height: 38 }

    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.chess.KingBlack = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><g style="fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path       d="M 22.5,11.63 L 22.5,6"       style="fill:none; stroke:#000000; stroke-linejoin:miter;"       id="path6570" />    <path       d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25"       style="fill:#000000;fill-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;" />    <path       d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z "       style="fill:#000000; stroke:#000000;" />    <path       d="M 20,8 L 25,8"       style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path       d="M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.51,26.6 L 22.5,24.5 C 20,18 9.906,14 6.997,19.85 C 4.5,25.5 11.85,28.85 11.85,28.85"       style="fill:none; stroke:#ffffff;" />    <path       d="M 11.5,30 C 17,27 27,27 32.5,30 M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5 M 11.5,37 C 17,34 27,34 32.5,37"       style="fill:none; stroke:#ffffff;" />  </g></g></g>',

    defaults: _.defaultsDeep({

        type: 'chess.KingBlack',
        size: { width: 42, height: 38 }

    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.chess.QueenWhite = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(-1,-1)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(15.5,-5.5)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(32,-1)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(7,-4.5)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(24,-4)" />    <path      d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38,14 L 31,25 L 31,11 L 25.5,24.5 L 22.5,9.5 L 19.5,24.5 L 14,10.5 L 14,25 L 7,14 L 9,26 z "      style="stroke-linecap:butt;" />    <path      d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z "      style="stroke-linecap:butt;" />    <path      d="M 11.5,30 C 15,29 30,29 33.5,30"      style="fill:none;" />    <path      d="M 12,33.5 C 18,32.5 27,32.5 33,33.5"      style="fill:none;" />  </g></g></g>',

    defaults: _.defaultsDeep({

        type: 'chess.QueenWhite',
        size: { width: 42, height: 38 }

    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.chess.QueenBlack = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#000000; stroke:none;">      <circle cx="6"    cy="12" r="2.75" />      <circle cx="14"   cy="9"  r="2.75" />      <circle cx="22.5" cy="8"  r="2.75" />      <circle cx="31"   cy="9"  r="2.75" />      <circle cx="39"   cy="12" r="2.75" />    </g>    <path       d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"       style="stroke-linecap:butt; stroke:#000000;" />    <path       d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"       style="stroke-linecap:butt;" />    <path       d="M 11,38.5 A 35,35 1 0 0 34,38.5"       style="fill:none; stroke:#000000; stroke-linecap:butt;" />    <path       d="M 11,29 A 35,35 1 0 1 34,29"       style="fill:none; stroke:#ffffff;" />    <path       d="M 12.5,31.5 L 32.5,31.5"       style="fill:none; stroke:#ffffff;" />    <path       d="M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"       style="fill:none; stroke:#ffffff;" />    <path       d="M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"       style="fill:none; stroke:#ffffff;" />  </g></g></g>',

    defaults: _.defaultsDeep({

        type: 'chess.QueenBlack',
        size: { width: 42, height: 38 }

    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.chess.RookWhite = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "      style="stroke-linecap:butt;" />    <path      d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z "      style="stroke-linecap:butt;" />    <path      d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14"      style="stroke-linecap:butt;" />    <path      d="M 34,14 L 31,17 L 14,17 L 11,14" />    <path      d="M 31,17 L 31,29.5 L 14,29.5 L 14,17"      style="stroke-linecap:butt; stroke-linejoin:miter;" />    <path      d="M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5" />    <path      d="M 11,14 L 34,14"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />  </g></g></g>',

    defaults: _.defaultsDeep({

        type: 'chess.RookWhite',
        size: { width: 32, height: 34 }

    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.chess.RookBlack = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "      style="stroke-linecap:butt;" />    <path      d="M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z "      style="stroke-linecap:butt;" />    <path      d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z "      style="stroke-linecap:butt;" />    <path      d="M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z "      style="stroke-linecap:butt;stroke-linejoin:miter;" />    <path      d="M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z "      style="stroke-linecap:butt;" />    <path      d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z "      style="stroke-linecap:butt;" />    <path      d="M 12,35.5 L 33,35.5 L 33,35.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 13,31.5 L 32,31.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 14,29.5 L 31,29.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 14,16.5 L 31,16.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 11,14 L 34,14"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />  </g></g></g>',

    defaults: _.defaultsDeep({

        type: 'chess.RookBlack',
        size: { width: 32, height: 34 }

    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.chess.BishopWhite = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#ffffff; stroke:#000000; stroke-linecap:butt;">       <path        d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" />      <path        d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" />      <path        d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" />    </g>    <path      d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />  </g></g></g>',

    defaults: _.defaultsDeep({

        type: 'chess.BishopWhite',
        size: { width: 38, height: 38 }

    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.chess.BishopBlack = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#000000; stroke:#000000; stroke-linecap:butt;">       <path        d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" />      <path        d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" />      <path        d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" />    </g>    <path       d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"       style="fill:none; stroke:#ffffff; stroke-linejoin:miter;" />  </g></g></g>',

    defaults: _.defaultsDeep({

        type: 'chess.BishopBlack',
        size: { width: 38, height: 38 }

    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.chess.KnightWhite = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18"      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10"      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z"      style="fill:#000000; stroke:#000000;" />    <path      d="M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z"      transform="matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)"      style="fill:#000000; stroke:#000000;" />  </g></g></g>',

    defaults: _.defaultsDeep({

        type: 'chess.KnightWhite',
        size: { width: 38, height: 37 }

    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.chess.KnightBlack = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18"      style="fill:#000000; stroke:#000000;" />    <path      d="M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10"      style="fill:#000000; stroke:#000000;" />    <path      d="M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z"      style="fill:#ffffff; stroke:#ffffff;" />    <path      d="M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z"      transform="matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)"      style="fill:#ffffff; stroke:#ffffff;" />    <path      d="M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z "      style="fill:#ffffff; stroke:none;" />  </g></g></g>',

    defaults: _.defaultsDeep({

        type: 'chess.KnightBlack',
        size: { width: 38, height: 37 }

    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.chess.PawnWhite = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><path d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z "  style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;" /></g></g>',

    defaults: _.defaultsDeep({

        type: 'chess.PawnWhite',
        size: { width: 28, height: 33 }

    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.chess.PawnBlack = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><path d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z "  style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;" /></g></g>',

    defaults: _.defaultsDeep({

        type: 'chess.PawnBlack',
        size: { width: 28, height: 33 }

    }, joint.shapes.basic.Generic.prototype.defaults)
});


joint.shapes.pn = {};

joint.shapes.pn.Place = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><circle class="root"/><g class="tokens" /></g><text class="label"/></g>',

    defaults: _.defaultsDeep({

        type: 'pn.Place',
        size: { width: 50, height: 50 },
        attrs: {
            '.root': {
                r: 25,
                fill: '#ffffff',
                stroke: '#000000',
                transform: 'translate(25, 25)'
            },
            '.label': {
                'text-anchor': 'middle',
                'ref-x': .5,
                'ref-y': -20,
                ref: '.root',
                fill: '#000000',
                'font-size': 12
            },
            '.tokens > circle': {
                fill: '#000000',
                r: 5
            },
            '.tokens.one > circle': { transform: 'translate(25, 25)' },

            '.tokens.two > circle:nth-child(1)': { transform: 'translate(19, 25)' },
            '.tokens.two > circle:nth-child(2)': { transform: 'translate(31, 25)' },

            '.tokens.three > circle:nth-child(1)': { transform: 'translate(18, 29)' },
            '.tokens.three > circle:nth-child(2)': { transform: 'translate(25, 19)' },
            '.tokens.three > circle:nth-child(3)': { transform: 'translate(32, 29)' },

            '.tokens.alot > text': {
                transform: 'translate(25, 18)',
                'text-anchor': 'middle',
                fill: '#000000'
            }
        }

    }, joint.shapes.basic.Generic.prototype.defaults)
});


joint.shapes.pn.PlaceView = joint.dia.ElementView.extend({

    initialize: function() {

        joint.dia.ElementView.prototype.initialize.apply(this, arguments);

        this.model.on('change:tokens', function() {

            this.renderTokens();
            this.update();

        }, this);
    },

    render: function() {

        joint.dia.ElementView.prototype.render.apply(this, arguments);

        this.renderTokens();
        this.update();
    },

    renderTokens: function() {

        var $tokens = this.$('.tokens').empty();
        $tokens[0].className.baseVal = 'tokens';

        var tokens = this.model.get('tokens');

        if (!tokens) return;

        switch (tokens) {

            case 1:
                $tokens[0].className.baseVal += ' one';
                $tokens.append(V('<circle/>').node);
                break;

            case 2:
                $tokens[0].className.baseVal += ' two';
                $tokens.append(V('<circle/>').node, V('<circle/>').node);
                break;

            case 3:
                $tokens[0].className.baseVal += ' three';
                $tokens.append(V('<circle/>').node, V('<circle/>').node, V('<circle/>').node);
                break;

            default:
                $tokens[0].className.baseVal += ' alot';
                $tokens.append(V('<text/>').text(tokens + '' ).node);
                break;
        }
    }
});

joint.shapes.pn.Transition = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><rect class="root"/></g></g><text class="label"/>',

    defaults: _.defaultsDeep({

        type: 'pn.Transition',
        size: { width: 12, height: 50 },
        attrs: {
            'rect': {
                width: 12,
                height: 50,
                fill: '#000000',
                stroke: '#000000'
            },
            '.label': {
                'text-anchor': 'middle',
                'ref-x': .5,
                'ref-y': -20,
                ref: 'rect',
                fill: '#000000',
                'font-size': 12
            }
        }

    }, joint.shapes.basic.Generic.prototype.defaults)
});

joint.shapes.pn.Link = joint.dia.Link.extend({

    defaults: _.defaultsDeep({

        type: 'pn.Link',
        attrs: { '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' }}

    }, joint.dia.Link.prototype.defaults)
});

joint.shapes.devs = {};

joint.shapes.devs.Model = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><rect class="body"/><text class="label"/></g>',
    portMarkup: '<circle class="port-body"/>',
    portLabelMarkup: '<text class="port-label"/>',
    defaults: _.defaultsDeep({

        type: 'devs.Model',
        inPorts: [],
        outPorts: [],
        size: {
            width: 80,
            height: 80
        },
        attrs: {
            '.': {
                magnet: false
            },
            '.label': {
                text: 'Model',
                'ref-x': .5,
                'ref-y': 10,
                'font-size': 18,
                'text-anchor': 'middle',
                fill: '#000'
            },
            '.body': {
                'ref-width': '100%',
                'ref-height': '100%',
                stroke: '#000'
            }
        },
        ports: {
            groups: {
                'in': {
                    position: {
                        name: 'left'
                    },
                    attrs: {
                        '.port-label': {
                            fill: '#000'
                        },
                        '.port-body': {
                            fill: '#fff',
                            stroke: '#000',
                            r: 10,
                            magnet: true
                        }
                    },
                    label: {
                        position: {
                            name: 'left',
                            args: {
                                y: 10
                            }
                        }
                    }
                },
                'out': {
                    position: {
                        name: 'right'
                    },
                    attrs: {
                        '.port-label': {
                            fill: '#000'
                        },
                        '.port-body': {
                            fill: '#fff',
                            stroke: '#000',
                            r: 10,
                            magnet: true
                        }
                    },
                    label: {
                        position: {
                            name: 'right',
                            args: {
                                y: 10
                            }
                        }
                    }
                }
            }
        }
    }, joint.shapes.basic.Generic.prototype.defaults),

    initialize: function() {

        joint.shapes.basic.Generic.prototype.initialize.apply(this, arguments);

        this.on('change:inPorts change:outPorts', this.updatePortItems, this);
        this.updatePortItems();
    },

    updatePortItems: function(model, changed, opt) {

        // Make sure all ports are unique.
        var inPorts = _.uniq(this.get('inPorts'));
        var outPorts = _.difference(_.uniq(this.get('outPorts')), inPorts);

        var inPortItems = this.createPortItems('in', inPorts);
        var outPortItems = this.createPortItems('out', outPorts);

        this.prop('ports/items', inPortItems.concat(outPortItems), _.extend({ rewrite: true }, opt));
    },

    createPortItem: function(group, port) {

        return {
            id: port,
            group: group,
            attrs: {
                '.port-label': {
                    text: port
                }
            }
        };
    },

    createPortItems: function(group, ports) {

        return _.map(ports, _.bind(this.createPortItem, this, group));
    },

    _addGroupPort: function(port, group, opt) {

        var ports = this.get(group);
        return this.set(group, _.isArray(ports) ? ports.concat(port) : [port], opt);
    },

    addOutPort: function(port, opt) {

        return this._addGroupPort(port, 'outPorts', opt);
    },

    addInPort: function(port, opt) {

        return this._addGroupPort(port, 'inPorts', opt);
    },

    _removeGroupPort: function(port, group, opt) {

        return this.set(group, _.without(this.get(group), port), opt);
    },

    removeOutPort: function(port, opt) {

        return this._removeGroupPort(port, 'outPorts', opt);
    },

    removeInPort: function(port, opt) {

        return this._removeGroupPort(port, 'inPorts', opt);
    },

    _changeGroup: function(group, properties, opt) {
        
        return this.prop('ports/groups/' + group, _.isObject(properties) ? properties : {}, opt);
    },
    
    changeInGroup: function(properties, opt) {

        return this._changeGroup('in', properties, opt);
    },

    changeOutGroup: function(properties, opt) {

        return this._changeGroup('out', properties, opt);
    }
});

joint.shapes.devs.Atomic = joint.shapes.devs.Model.extend({

    defaults: _.defaultsDeep({

        type: 'devs.Atomic',
        size: {
            width: 80,
            height: 80
        },
        attrs: {
            '.label': {
                text: 'Atomic'
            }
        }
    }, joint.shapes.devs.Model.prototype.defaults)
});

joint.shapes.devs.Coupled = joint.shapes.devs.Model.extend({

    defaults: _.defaultsDeep({

        type: 'devs.Coupled',
        size: {
            width: 200,
            height: 300
        },
        attrs: {
            '.label': {
                text: 'Coupled'
            }
        }
    }, joint.shapes.devs.Model.prototype.defaults)
});

joint.shapes.devs.Link = joint.dia.Link.extend({

    defaults: {
        type: 'devs.Link',
        attrs: {
            '.connection': {
                'stroke-width': 2
            }
        }
    }
});

joint.shapes.uml = {};

joint.shapes.uml.Class = joint.shapes.basic.Generic.extend({

    markup: [
        '<g class="rotatable">',
        '<g class="scalable">',
        '<rect class="uml-class-name-rect"/><rect class="uml-class-attrs-rect"/><rect class="uml-class-methods-rect"/>',
        '</g>',
        '<text class="uml-class-name-text"/><text class="uml-class-attrs-text"/><text class="uml-class-methods-text"/>',
        '</g>'
    ].join(''),

    defaults: _.defaultsDeep({

        type: 'uml.Class',

        attrs: {
            rect: { 'width': 200 },

            '.uml-class-name-rect': { 'stroke': 'black', 'stroke-width': 2, 'fill': '#3498db' },
            '.uml-class-attrs-rect': { 'stroke': 'black', 'stroke-width': 2, 'fill': '#2980b9' },
            '.uml-class-methods-rect': { 'stroke': 'black', 'stroke-width': 2, 'fill': '#2980b9' },

            '.uml-class-name-text': {
                'ref': '.uml-class-name-rect', 'ref-y': .5, 'ref-x': .5, 'text-anchor': 'middle', 'y-alignment': 'middle', 'font-weight': 'bold',
                'fill': 'black', 'font-size': 12, 'font-family': 'Times New Roman'
            },
            '.uml-class-attrs-text': {
                'ref': '.uml-class-attrs-rect', 'ref-y': 5, 'ref-x': 5,
                'fill': 'black', 'font-size': 12, 'font-family': 'Times New Roman'
            },
            '.uml-class-methods-text': {
                'ref': '.uml-class-methods-rect', 'ref-y': 5, 'ref-x': 5,
                'fill': 'black', 'font-size': 12, 'font-family': 'Times New Roman'
            }
        },

        name: [],
        attributes: [],
        methods: []

    }, joint.shapes.basic.Generic.prototype.defaults),

    initialize: function() {

        this.on('change:name change:attributes change:methods', function() {
            this.updateRectangles();
            this.trigger('uml-update');
        }, this);

        this.updateRectangles();

        joint.shapes.basic.Generic.prototype.initialize.apply(this, arguments);
    },

    getClassName: function() {
        return this.get('name');
    },

    updateRectangles: function() {

        var attrs = this.get('attrs');

        var rects = [
            { type: 'name', text: this.getClassName() },
            { type: 'attrs', text: this.get('attributes') },
            { type: 'methods', text: this.get('methods') }
        ];

        var offsetY = 0;

        _.each(rects, function(rect) {

            var lines = _.isArray(rect.text) ? rect.text : [rect.text];
            var rectHeight = lines.length * 20 + 20;

            attrs['.uml-class-' + rect.type + '-text'].text = lines.join('\n');
            attrs['.uml-class-' + rect.type + '-rect'].height = rectHeight;
            attrs['.uml-class-' + rect.type + '-rect'].transform = 'translate(0,' + offsetY + ')';

            offsetY += rectHeight;
        });
    }

});

joint.shapes.uml.ClassView = joint.dia.ElementView.extend({

    initialize: function() {

        joint.dia.ElementView.prototype.initialize.apply(this, arguments);

        this.listenTo(this.model, 'uml-update', function() {
            this.update();
            this.resize();
        });
    }
});

joint.shapes.uml.Abstract = joint.shapes.uml.Class.extend({

    defaults: _.defaultsDeep({
        type: 'uml.Abstract',
        attrs: {
            '.uml-class-name-rect': { fill : '#e74c3c' },
            '.uml-class-attrs-rect': { fill : '#c0392b' },
            '.uml-class-methods-rect': { fill : '#c0392b' }
        }
    }, joint.shapes.uml.Class.prototype.defaults),

    getClassName: function() {
        return ['<<Abstract>>', this.get('name')];
    }

});
joint.shapes.uml.AbstractView = joint.shapes.uml.ClassView;

joint.shapes.uml.Interface = joint.shapes.uml.Class.extend({

    defaults: _.defaultsDeep({
        type: 'uml.Interface',
        attrs: {
            '.uml-class-name-rect': { fill : '#f1c40f' },
            '.uml-class-attrs-rect': { fill : '#f39c12' },
            '.uml-class-methods-rect': { fill : '#f39c12' }
        }
    }, joint.shapes.uml.Class.prototype.defaults),

    getClassName: function() {
        return ['<<Interface>>', this.get('name')];
    }

});
joint.shapes.uml.InterfaceView = joint.shapes.uml.ClassView;

joint.shapes.uml.Generalization = joint.dia.Link.extend({
    defaults: {
        type: 'uml.Generalization',
        attrs: { '.marker-target': { d: 'M 20 0 L 0 10 L 20 20 z', fill: 'white' }}
    }
});

joint.shapes.uml.Implementation = joint.dia.Link.extend({
    defaults: {
        type: 'uml.Implementation',
        attrs: {
            '.marker-target': { d: 'M 20 0 L 0 10 L 20 20 z', fill: 'white' },
            '.connection': { 'stroke-dasharray': '3,3' }
        }
    }
});

joint.shapes.uml.Aggregation = joint.dia.Link.extend({
    defaults: {
        type: 'uml.Aggregation',
        attrs: { '.marker-target': { d: 'M 40 10 L 20 20 L 0 10 L 20 0 z', fill: 'white' }}
    }
});

joint.shapes.uml.Composition = joint.dia.Link.extend({
    defaults: {
        type: 'uml.Composition',
        attrs: { '.marker-target': { d: 'M 40 10 L 20 20 L 0 10 L 20 0 z', fill: 'black' }}
    }
});

joint.shapes.uml.Association = joint.dia.Link.extend({
    defaults: { type: 'uml.Association' }
});

// Statechart

joint.shapes.uml.State = joint.shapes.basic.Generic.extend({

    markup: [
        '<g class="rotatable">',
        '<g class="scalable">',
        '<rect class="uml-state-body"/>',
        '</g>',
        '<path class="uml-state-separator"/>',
        '<text class="uml-state-name"/>',
        '<text class="uml-state-events"/>',
        '</g>'
    ].join(''),

    defaults: _.defaultsDeep({

        type: 'uml.State',

        attrs: {
            '.uml-state-body': {
                'width': 200, 'height': 200, 'rx': 10, 'ry': 10,
                'fill': '#ecf0f1', 'stroke': '#bdc3c7', 'stroke-width': 3
            },
            '.uml-state-separator': {
                'stroke': '#bdc3c7', 'stroke-width': 2
            },
            '.uml-state-name': {
                'ref': '.uml-state-body', 'ref-x': .5, 'ref-y': 5, 'text-anchor': 'middle',
                'fill': '#000000', 'font-family': 'Courier New', 'font-size': 14
            },
            '.uml-state-events': {
                'ref': '.uml-state-separator', 'ref-x': 5, 'ref-y': 5,
                'fill': '#000000', 'font-family': 'Courier New', 'font-size': 14
            }
        },

        name: 'State',
        events: []

    }, joint.shapes.basic.Generic.prototype.defaults),

    initialize: function() {

        this.on({
            'change:name': this.updateName,
            'change:events': this.updateEvents,
            'change:size': this.updatePath
        }, this);

        this.updateName();
        this.updateEvents();
        this.updatePath();

        joint.shapes.basic.Generic.prototype.initialize.apply(this, arguments);
    },

    updateName: function() {

        this.attr('.uml-state-name/text', this.get('name'));
    },

    updateEvents: function() {

        this.attr('.uml-state-events/text', this.get('events').join('\n'));
    },

    updatePath: function() {

        var d = 'M 0 20 L ' + this.get('size').width + ' 20';

        // We are using `silent: true` here because updatePath() is meant to be called
        // on resize and there's no need to to update the element twice (`change:size`
        // triggers also an update).
        this.attr('.uml-state-separator/d', d, { silent: true });
    }

});

joint.shapes.uml.StartState = joint.shapes.basic.Circle.extend({

    defaults: _.defaultsDeep({

        type: 'uml.StartState',
        attrs: { circle: { 'fill': '#34495e', 'stroke': '#2c3e50', 'stroke-width': 2, 'rx': 1 }}

    }, joint.shapes.basic.Circle.prototype.defaults)

});

joint.shapes.uml.EndState = joint.shapes.basic.Generic.extend({

    markup: '<g class="rotatable"><g class="scalable"><circle class="outer"/><circle class="inner"/></g></g>',

    defaults: _.defaultsDeep({

        type: 'uml.EndState',
        size: { width: 20, height: 20 },
        attrs: {
            'circle.outer': {
                transform: 'translate(10, 10)',
                r: 10,
                fill: '#ffffff',
                stroke: '#2c3e50'
            },

            'circle.inner': {
                transform: 'translate(10, 10)',
                r: 6,
                fill: '#34495e'
            }
        }

    }, joint.shapes.basic.Generic.prototype.defaults)

});

joint.shapes.uml.Transition = joint.dia.Link.extend({
    defaults: {
        type: 'uml.Transition',
        attrs: {
            '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z', fill: '#34495e', stroke: '#2c3e50' },
            '.connection': { stroke: '#2c3e50' }
        }
    }
});


joint.shapes.logic = {};

joint.shapes.logic.Gate = joint.shapes.basic.Generic.extend({

    defaults: _.defaultsDeep({

        type: 'logic.Gate',
        size: { width: 80, height: 40 },
        attrs: {
            '.': { magnet: false },
            '.body': { width: 100, height: 50 },
            circle: { r: 7, stroke: 'black', fill: 'transparent', 'stroke-width': 2 }
        }

    }, joint.shapes.basic.Generic.prototype.defaults),

    operation: function() { return true; }
});

joint.shapes.logic.IO = joint.shapes.logic.Gate.extend({

    markup: '<g class="rotatable"><g class="scalable"><rect class="body"/></g><path class="wire"/><circle/><text/></g>',

    defaults: _.defaultsDeep({

        type: 'logic.IO',
        size: { width: 60, height: 30 },
        attrs: {
            '.body': { fill: 'white', stroke: 'black', 'stroke-width': 2 },
            '.wire': { ref: '.body', 'ref-y': .5, stroke: 'black' },
            text: {
                fill: 'black',
                ref: '.body', 'ref-x': .5, 'ref-y': .5, 'y-alignment': 'middle',
                'text-anchor': 'middle',
                'font-weight': 'bold',
                'font-variant': 'small-caps',
                'text-transform': 'capitalize',
                'font-size': '14px'
            }
        }

    }, joint.shapes.logic.Gate.prototype.defaults)

});

joint.shapes.logic.Input = joint.shapes.logic.IO.extend({

    defaults: _.defaultsDeep({

        type: 'logic.Input',
        attrs: {
            '.wire': { 'ref-dx': 0, d: 'M 0 0 L 23 0' },
            circle: { ref: '.body', 'ref-dx': 30, 'ref-y': 0.5, magnet: true, 'class': 'output', port: 'out' },
            text: { text: 'input' }
        }

    }, joint.shapes.logic.IO.prototype.defaults)
});

joint.shapes.logic.Output = joint.shapes.logic.IO.extend({

    defaults: _.defaultsDeep({

        type: 'logic.Output',
        attrs: {
            '.wire': { 'ref-x': 0, d: 'M 0 0 L -23 0' },
            circle: { ref: '.body', 'ref-x': -30, 'ref-y': 0.5, magnet: 'passive', 'class': 'input', port: 'in' },
            text: { text: 'output' }
        }

    }, joint.shapes.logic.IO.prototype.defaults)

});


joint.shapes.logic.Gate11 = joint.shapes.logic.Gate.extend({

    markup: '<g class="rotatable"><g class="scalable"><image class="body"/></g><circle class="input"/><circle class="output"/></g>',

    defaults: _.defaultsDeep({

        type: 'logic.Gate11',
        attrs: {
            '.input': { ref: '.body', 'ref-x': -2, 'ref-y': 0.5, magnet: 'passive', port: 'in' },
            '.output': { ref: '.body', 'ref-dx': 2, 'ref-y': 0.5, magnet: true, port: 'out' }
        }

    }, joint.shapes.logic.Gate.prototype.defaults)
});

joint.shapes.logic.Gate21 = joint.shapes.logic.Gate.extend({

    markup: '<g class="rotatable"><g class="scalable"><image class="body"/></g><circle class="input input1"/><circle  class="input input2"/><circle class="output"/></g>',

    defaults: _.defaultsDeep({

        type: 'logic.Gate21',
        attrs: {
            '.input1': { ref: '.body', 'ref-x': -2, 'ref-y': 0.3, magnet: 'passive', port: 'in1' },
            '.input2': { ref: '.body', 'ref-x': -2, 'ref-y': 0.7, magnet: 'passive', port: 'in2' },
            '.output': { ref: '.body', 'ref-dx': 2, 'ref-y': 0.5, magnet: true, port: 'out' }
        }

    }, joint.shapes.logic.Gate.prototype.defaults)

});

joint.shapes.logic.Repeater = joint.shapes.logic.Gate11.extend({

    defaults: _.defaultsDeep({

        type: 'logic.Repeater',
        attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzIuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICA8L2c+Cjwvc3ZnPgo=' }}

    }, joint.shapes.logic.Gate11.prototype.defaults),

    operation: function(input) {
        return input;
    }

});

joint.shapes.logic.Not = joint.shapes.logic.Gate11.extend({

    defaults: _.defaultsDeep({

        type: 'logic.Not',
        attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzkuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDI2NzEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzYiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA4MCwyNSBBIDQsNCAwIDEgMSA3MiwyNSBBIDQsNCAwIDEgMSA4MCwyNSB6IgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEsMCkiIC8+CiAgPC9nPgo8L3N2Zz4K' }}

    }, joint.shapes.logic.Gate11.prototype.defaults),

    operation: function(input) {
        return !input;
    }

});

joint.shapes.logic.Or = joint.shapes.logic.Gate21.extend({

    defaults: _.defaultsDeep({

        type: 'logic.Or',
        attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik9SIEFOU0kuc3ZnIgogICBpbmtzY2FwZTpvdXRwdXRfZXh0ZW5zaW9uPSJvcmcuaW5rc2NhcGUub3V0cHV0LnN2Zy5pbmtzY2FwZSI+CiAgPGRlZnMKICAgICBpZD0iZGVmczQiPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTAgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjcxNCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iMSA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMC41IDogMC4zMzMzMzMzMyA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODA2IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODE5IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjM3Mi4wNDcyNCA6IDM1MC43ODczOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI3NDQuMDk0NDggOiA1MjYuMTgxMDkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzc3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49Ijc1IDogNDAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTUwIDogNjAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDYwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTMyNzUiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNTAgOiAzMy4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTAwIDogNTAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTU1MzMiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzIgOiAyMS4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNjQgOiAzMiA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMzIgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjU1NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDE2LjY2NjY2NyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDI1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAyNSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iNCIKICAgICBpbmtzY2FwZTpjeD0iMTEzLjAwMDM5IgogICAgIGlua3NjYXBlOmN5PSIxMi44OTM3MzEiCiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9InB4IgogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImcyNTYwIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTpncmlkLWJib3g9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1wb2ludHM9InRydWUiCiAgICAgZ3JpZHRvbGVyYW5jZT0iMTAwMDAiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxMzk5IgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9Ijg3NCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMzciCiAgICAgaW5rc2NhcGU6d2luZG93LXk9Ii00IgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Im0gNzAsMjUgYyAyMCwwIDI1LDAgMjUsMCIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMSwxNSA1LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzIsMzUgNSwzNSIKICAgICAgIGlkPSJwYXRoMzk0NCIgLz4KICAgIDxnCiAgICAgICBpZD0iZzI1NjAiCiAgICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2LjUsLTM5LjUpIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICA8L2c+Cjwvc3ZnPgo=' }}

    }, joint.shapes.logic.Gate21.prototype.defaults),

    operation: function(input1, input2) {
        return input1 || input2;
    }

});

joint.shapes.logic.And = joint.shapes.logic.Gate21.extend({

    defaults: _.defaultsDeep({

        type: 'logic.And',
        attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IkFORCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI4IgogICAgIGlua3NjYXBlOmN4PSI1Ni42OTgzNDgiCiAgICAgaW5rc2NhcGU6Y3k9IjI1LjMyNjg5OSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTptZWRpdW07Zm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDt0ZXh0LWluZGVudDowO3RleHQtYWxpZ246c3RhcnQ7dGV4dC1kZWNvcmF0aW9uOm5vbmU7bGluZS1oZWlnaHQ6bm9ybWFsO2xldHRlci1zcGFjaW5nOm5vcm1hbDt3b3JkLXNwYWNpbmc6bm9ybWFsO3RleHQtdHJhbnNmb3JtOm5vbmU7ZGlyZWN0aW9uOmx0cjtibG9jay1wcm9ncmVzc2lvbjp0Yjt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6c3RhcnQ7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDozO21hcmtlcjpub25lO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGU7Zm9udC1mYW1pbHk6Qml0c3RyZWFtIFZlcmEgU2FuczstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOkJpdHN0cmVhbSBWZXJhIFNhbnMiCiAgICAgICBkPSJNIDMwLDUgTCAzMCw2LjQyODU3MTQgTCAzMCw0My41NzE0MjkgTCAzMCw0NSBMIDMxLjQyODU3MSw0NSBMIDUwLjQ3NjE5LDQ1IEMgNjEuNzQ0MDk4LDQ1IDcwLjQ3NjE5LDM1Ljk5OTk1NSA3MC40NzYxOSwyNSBDIDcwLjQ3NjE5LDE0LjAwMDA0NSA2MS43NDQwOTksNS4wMDAwMDAyIDUwLjQ3NjE5LDUgQyA1MC40NzYxOSw1IDUwLjQ3NjE5LDUgMzEuNDI4NTcxLDUgTCAzMCw1IHogTSAzMi44NTcxNDMsNy44NTcxNDI5IEMgNDAuODM0MjY0LDcuODU3MTQyOSA0NS45MTgzNjgsNy44NTcxNDI5IDQ4LjA5NTIzOCw3Ljg1NzE0MjkgQyA0OS4yODU3MTQsNy44NTcxNDI5IDQ5Ljg4MDk1Miw3Ljg1NzE0MjkgNTAuMTc4NTcxLDcuODU3MTQyOSBDIDUwLjMyNzM4MSw3Ljg1NzE0MjkgNTAuNDA5MjI3LDcuODU3MTQyOSA1MC40NDY0MjksNy44NTcxNDI5IEMgNTAuNDY1MDI5LDcuODU3MTQyOSA1MC40NzE1NDMsNy44NTcxNDI5IDUwLjQ3NjE5LDcuODU3MTQyOSBDIDYwLjIzNjg1Myw3Ljg1NzE0MyA2Ny4xNDI4NTcsMTUuNDk3MDk4IDY3LjE0Mjg1NywyNSBDIDY3LjE0Mjg1NywzNC41MDI5MDIgNTkuNzYwNjYyLDQyLjE0Mjg1NyA1MCw0Mi4xNDI4NTcgTCAzMi44NTcxNDMsNDIuMTQyODU3IEwgMzIuODU3MTQzLDcuODU3MTQyOSB6IgogICAgICAgaWQ9InBhdGgyODg0IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2NjY2NzY2NjY3Nzc3NzY2NjIiAvPgogIDwvZz4KPC9zdmc+Cg==' }}

    }, joint.shapes.logic.Gate21.prototype.defaults),

    operation: function(input1, input2) {
        return input1 && input2;
    }

});

joint.shapes.logic.Nor = joint.shapes.logic.Gate21.extend({

    defaults: _.defaultsDeep({

        type: 'logic.Nor',
        attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjEiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjY3NzY0NCIKICAgICBpbmtzY2FwZTpjeT0iMjIuMTAyMzQ0IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjM3IgogICAgIGlua3NjYXBlOndpbmRvdy15PSItNCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc5LDI1IEMgOTksMjUgOTUsMjUgOTUsMjUiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHNvZGlwb2RpOnR5cGU9ImFyYyIKICAgICAgICAgc3R5bGU9ImZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgICBpZD0icGF0aDI2MDQiCiAgICAgICAgIHNvZGlwb2RpOmN4PSI3NSIKICAgICAgICAgc29kaXBvZGk6Y3k9IjI1IgogICAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgICAgc29kaXBvZGk6cnk9IjQiCiAgICAgICAgIGQ9Ik0gNzksMjUgQSA0LDQgMCAxIDEgNzEsMjUgQSA0LDQgMCAxIDEgNzksMjUgeiIKICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI2LjUsMzkuNSkiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K' }}

    }, joint.shapes.logic.Gate21.prototype.defaults),

    operation: function(input1, input2) {
        return !(input1 || input2);
    }

});

joint.shapes.logic.Nand = joint.shapes.logic.Gate21.extend({

    defaults: _.defaultsDeep({

        type: 'logic.Nand',
        attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5BTkQgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iMTYiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjI4MzMwNyIKICAgICBpbmtzY2FwZTpjeT0iMTYuNDQyODQzIgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzksMjUgQyA5MS44LDI1IDk1LDI1IDk1LDI1IgogICAgICAgaWQ9InBhdGgzMDU5IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMxLDE1IDUsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMiwzNSA1LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmb250LXNpemU6bWVkaXVtO2ZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7dGV4dC1pbmRlbnQ6MDt0ZXh0LWFsaWduOnN0YXJ0O3RleHQtZGVjb3JhdGlvbjpub25lO2xpbmUtaGVpZ2h0Om5vcm1hbDtsZXR0ZXItc3BhY2luZzpub3JtYWw7d29yZC1zcGFjaW5nOm5vcm1hbDt0ZXh0LXRyYW5zZm9ybTpub25lO2RpcmVjdGlvbjpsdHI7YmxvY2stcHJvZ3Jlc3Npb246dGI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOnN0YXJ0O2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MzttYXJrZXI6bm9uZTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlO2ZvbnQtZmFtaWx5OkJpdHN0cmVhbSBWZXJhIFNhbnM7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpCaXRzdHJlYW0gVmVyYSBTYW5zIgogICAgICAgZD0iTSAzMCw1IEwgMzAsNi40Mjg1NzE0IEwgMzAsNDMuNTcxNDI5IEwgMzAsNDUgTCAzMS40Mjg1NzEsNDUgTCA1MC40NzYxOSw0NSBDIDYxLjc0NDA5OCw0NSA3MC40NzYxOSwzNS45OTk5NTUgNzAuNDc2MTksMjUgQyA3MC40NzYxOSwxNC4wMDAwNDUgNjEuNzQ0MDk5LDUuMDAwMDAwMiA1MC40NzYxOSw1IEMgNTAuNDc2MTksNSA1MC40NzYxOSw1IDMxLjQyODU3MSw1IEwgMzAsNSB6IE0gMzIuODU3MTQzLDcuODU3MTQyOSBDIDQwLjgzNDI2NCw3Ljg1NzE0MjkgNDUuOTE4MzY4LDcuODU3MTQyOSA0OC4wOTUyMzgsNy44NTcxNDI5IEMgNDkuMjg1NzE0LDcuODU3MTQyOSA0OS44ODA5NTIsNy44NTcxNDI5IDUwLjE3ODU3MSw3Ljg1NzE0MjkgQyA1MC4zMjczODEsNy44NTcxNDI5IDUwLjQwOTIyNyw3Ljg1NzE0MjkgNTAuNDQ2NDI5LDcuODU3MTQyOSBDIDUwLjQ2NTAyOSw3Ljg1NzE0MjkgNTAuNDcxNTQzLDcuODU3MTQyOSA1MC40NzYxOSw3Ljg1NzE0MjkgQyA2MC4yMzY4NTMsNy44NTcxNDMgNjcuMTQyODU3LDE1LjQ5NzA5OCA2Ny4xNDI4NTcsMjUgQyA2Ny4xNDI4NTcsMzQuNTAyOTAyIDU5Ljc2MDY2Miw0Mi4xNDI4NTcgNTAsNDIuMTQyODU3IEwgMzIuODU3MTQzLDQyLjE0Mjg1NyBMIDMyLjg1NzE0Myw3Ljg1NzE0MjkgeiIKICAgICAgIGlkPSJwYXRoMjg4NCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2Njc2NjY2Nzc3Nzc2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDQwMDgiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg==' }}

    }, joint.shapes.logic.Gate21.prototype.defaults),

    operation: function(input1, input2) {
        return !(input1 && input2);
    }

});

joint.shapes.logic.Xor = joint.shapes.logic.Gate21.extend({

    defaults: _.defaultsDeep({

        type: 'logic.Xor',
        attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhPUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjUuNjU2ODU0MiIKICAgICBpbmtzY2FwZTpjeD0iMjUuOTM4MTE2IgogICAgIGlua3NjYXBlOmN5PSIxNy4yMzAwNSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzAuMzg1NzE3LDE1IEwgNC45OTk5OTk4LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5NzY7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEuMzYyMDkxLDM1IEwgNC45OTk5OTk4LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPGcKICAgICAgIGlkPSJnMjU2MCIKICAgICAgIGlua3NjYXBlOmxhYmVsPSJMYXllciAxIgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjYuNSwtMzkuNSkiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDM1MTYiCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi4yNSw4MS41MDAwMDUgQyAtMy44NDczNzQsODQuMTQ0NDA1IC00LjUsODQuNTAwMDA1IC00LjUsODQuNTAwMDA1IEwgLTguMTU2MjUsODQuNTAwMDA1IEwgLTYuMTU2MjUsODIuMDYyNTA1IEMgLTYuMTU2MjUsODIuMDYyNTA1IC0wLjUsNzUuMDYyNDUxIC0wLjUsNjQuNSBDIC0wLjUsNTMuOTM3NTQ5IC02LjE1NjI1LDQ2LjkzNzUgLTYuMTU2MjUsNDYuOTM3NSBMIC04LjE1NjI1LDQ0LjUgTCAtNC41LDQ0LjUgQyAtMy43MTg3NSw0NS40Mzc1IC0zLjA3ODEyNSw0Ni4xNTYyNSAtMi4yODEyNSw0Ny41IEMgLTAuNDA4NTMxLDUwLjU5OTgxNSAyLjUsNTYuNTI2NjQ2IDIuNSw2NC41IEMgMi41LDcyLjQ1MDY1IC0wLjM5NjY5Nyw3OC4zNzk0MjUgLTIuMjUsODEuNTAwMDA1IHoiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY3NjY2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K' }}

    }, joint.shapes.logic.Gate21.prototype.defaults),

    operation: function(input1, input2) {
        return (!input1 || input2) && (input1 || !input2);
    }

});

joint.shapes.logic.Xnor = joint.shapes.logic.Gate21.extend({

    defaults: _.defaultsDeep({

        type: 'logic.Xnor',
        attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhOT1IgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNTU3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTYuNjY2NjY3IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDI1IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI0IgogICAgIGlua3NjYXBlOmN4PSI5NS43MjM2NiIKICAgICBpbmtzY2FwZTpjeT0iLTI2Ljc3NTAyMyIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyLjAwMDAwMDI0O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc4LjMzMzMzMiwyNSBDIDkxLjY2NjY2NiwyNSA5NSwyNSA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMC4zODU3MTcsMTUgTCA0Ljk5OTk5OTgsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk3NjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMS4zNjIwOTEsMzUgTCA0Ljk5OTk5OTgsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoMzUxNiIKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjI1LDgxLjUwMDAwNSBDIC0zLjg0NzM3NCw4NC4xNDQ0MDUgLTQuNSw4NC41MDAwMDUgLTQuNSw4NC41MDAwMDUgTCAtOC4xNTYyNSw4NC41MDAwMDUgTCAtNi4xNTYyNSw4Mi4wNjI1MDUgQyAtNi4xNTYyNSw4Mi4wNjI1MDUgLTAuNSw3NS4wNjI0NTEgLTAuNSw2NC41IEMgLTAuNSw1My45Mzc1NDkgLTYuMTU2MjUsNDYuOTM3NSAtNi4xNTYyNSw0Ni45Mzc1IEwgLTguMTU2MjUsNDQuNSBMIC00LjUsNDQuNSBDIC0zLjcxODc1LDQ1LjQzNzUgLTMuMDc4MTI1LDQ2LjE1NjI1IC0yLjI4MTI1LDQ3LjUgQyAtMC40MDg1MzEsNTAuNTk5ODE1IDIuNSw1Ni41MjY2NDYgMi41LDY0LjUgQyAyLjUsNzIuNDUwNjUgLTAuMzk2Njk3LDc4LjM3OTQyNSAtMi4yNSw4MS41MDAwMDUgeiIKICAgICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2Njc2NjY2NzYyIgLz4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDM1NTEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg==' }}

    }, joint.shapes.logic.Gate21.prototype.defaults),

    operation: function(input1, input2) {
        return (!input1 || !input2) && (input1 || input2);
    }

});

joint.shapes.logic.Wire = joint.dia.Link.extend({

    arrowheadMarkup: [
        '<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">',
        '<circle class="marker-arrowhead" end="<%= end %>" r="7"/>',
        '</g>'
    ].join(''),

    vertexMarkup: [
        '<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">',
        '<circle class="marker-vertex" idx="<%= idx %>" r="10" />',
        '<g class="marker-vertex-remove-group">',
        '<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>',
        '<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',
        '<title>Remove vertex.</title>',
        '</path>',
        '</g>',
        '</g>'
    ].join(''),

    defaults: _.defaultsDeep({

        type: 'logic.Wire',

        attrs: {
            '.connection': { 'stroke-width': 2 },
            '.marker-vertex': { r: 7 }
        },

        router: { name: 'orthogonal' },
        connector: { name: 'rounded', args: { radius: 10 }}

    }, joint.dia.Link.prototype.defaults)

});

if (typeof exports === 'object') {

    var graphlib = require('graphlib');
    var dagre = require('dagre');
}

// In the browser, these variables are set to undefined because of JavaScript hoisting.
// In that case, should grab them from the window object.
graphlib = graphlib || (typeof window !== 'undefined' && window.graphlib);
dagre = dagre || (typeof window !== 'undefined' && window.dagre);

joint.layout.DirectedGraph = {

    layout: function(graphOrCells, opt) {

        var graph;

        if (graphOrCells instanceof joint.dia.Graph) {
            graph = graphOrCells;
        } else {
            // Reset cells in dry mode so the graph reference is not stored on the cells.
            graph = (new joint.dia.Graph()).resetCells(graphOrCells, { dry: true });
        }

        // This is not needed anymore.
        graphOrCells = null;

        opt = _.defaults(opt || {}, {
            resizeClusters: true,
            clusterPadding: 10
        });

        // create a graphlib.Graph that represents the joint.dia.Graph
        var glGraph = graph.toGraphLib({
            directed: true,
            // We are about to use edge naming feature.
            multigraph: true,
            // We are able to layout graphs with embeds.
            compound: true,
            setNodeLabel: function(element) {
                return {
                    width: element.get('size').width,
                    height: element.get('size').height,
                    rank: element.get('rank')
                };
            },
            setEdgeLabel: function(link) {
                return {
                    minLen: link.get('minLen') || 1
                };
            },
            setEdgeName: function(link) {
                // Graphlib edges have no ids. We use edge name property
                // to store and retrieve ids instead.
                return link.id;
            }
        });

        var glLabel = {};
        var marginX = opt.marginX || 0;
        var marginY = opt.marginY || 0;

        // Dagre layout accepts options as lower case.
        // Direction for rank nodes. Can be TB, BT, LR, or RL
        if (opt.rankDir) glLabel.rankdir = opt.rankDir;
        // Alignment for rank nodes. Can be UL, UR, DL, or DR
        if (opt.align) glLabel.align = opt.align;
        // Number of pixels that separate nodes horizontally in the layout.
        if (opt.nodeSep) glLabel.nodesep = opt.nodeSep;
        // Number of pixels that separate edges horizontally in the layout.
        if (opt.edgeSep) glLabel.edgesep = opt.edgeSep;
        // Number of pixels between each rank in the layout.
        if (opt.rankSep) glLabel.ranksep = opt.rankSep;
        // Number of pixels to use as a margin around the left and right of the graph.
        if (marginX) glLabel.marginx = marginX;
        // Number of pixels to use as a margin around the top and bottom of the graph.
        if (marginY) glLabel.marginy = marginY;

        // Set the option object for the graph label.
        glGraph.setGraph(glLabel);

        // Executes the layout.
        dagre.layout(glGraph, { debugTiming: !!opt.debugTiming });

        // Wrap all graph changes into a batch.
        graph.startBatch('layout');

        // Update the graph.
        graph.fromGraphLib(glGraph, {
            importNode: function(v, gl) {

                var element = this.getCell(v);
                var glNode = gl.node(v);

                if (opt.setPosition) {
                    opt.setPosition(element, glNode);
                } else {
                    element.set('position', {
                        x: glNode.x - glNode.width / 2,
                        y: glNode.y - glNode.height / 2
                    });
                }
            },
            importEdge: function(edgeObj, gl) {

                var link = this.getCell(edgeObj.name);
                var glEdge = gl.edge(edgeObj);
                var points = glEdge.points || [];

                if (opt.setLinkVertices) {
                    if (opt.setVertices) {
                        opt.setVertices(link, points);
                    } else {
                        // Remove the first and last point from points array.
                        // Those are source/target element connection points
                        // ie. they lies on the edge of connected elements.
                        link.set('vertices', points.slice(1, points.length - 1));
                    }
                }
            }
        });

        if (opt.resizeClusters) {
            // Resize and reposition cluster elements (parents of other elements)
            // to fit their children.
            // 1. filter clusters only
            // 2. map id on cells
            // 3. sort cells by their depth (the deepest first)
            // 4. resize cell to fit their direct children only.
            _.chain(glGraph.nodes())
                .filter(function(v) { return glGraph.children(v).length > 0; })
                .map(graph.getCell, graph)
                .sortBy(function(cluster) { return -cluster.getAncestors().length; })
                .invoke('fitEmbeds', { padding: opt.clusterPadding })
                .value();
        }

        graph.stopBatch('layout');

        // Width and height of the graph extended by margins.
        var glSize = glGraph.graph();
        // Return the bounding box of the graph after the layout.
        return g.Rect(
            marginX,
            marginY,
            Math.abs(glSize.width - 2 * marginX),
            Math.abs(glSize.height - 2 * marginY)
        );
    },

    fromGraphLib: function(glGraph, opt) {

        opt = opt || {};

        var importNode = opt.importNode || _.noop;
        var importEdge = opt.importEdge || _.noop;
        var graph = (this instanceof joint.dia.Graph) ? this : new joint.dia.Graph;

        // Import all nodes.
        glGraph.nodes().forEach(function(node) {
            importNode.call(graph, node, glGraph, graph, opt);
        });

        // Import all edges.
        glGraph.edges().forEach(function(edge) {
            importEdge.call(graph, edge, glGraph, graph, opt);
        });

        return graph;
    },

    // Create new graphlib graph from existing JointJS graph.
    toGraphLib: function(graph, opt) {

        opt = opt || {};

        var glGraphType = _.pick(opt, 'directed', 'compound', 'multigraph');
        var glGraph = new graphlib.Graph(glGraphType);
        var setNodeLabel = opt.setNodeLabel || _.noop;
        var setEdgeLabel = opt.setEdgeLabel || _.noop;
        var setEdgeName = opt.setEdgeName || _.noop;

        graph.get('cells').each(function(cell) {

            if (cell.isLink()) {

                var source = cell.get('source');
                var target = cell.get('target');

                // Links that end at a point are ignored.
                if (!source.id || !target.id) return;

                // Note that if we are creating a multigraph we can name the edges. If
                // we try to name edges on a non-multigraph an exception is thrown.
                glGraph.setEdge(source.id, target.id, setEdgeLabel(cell), setEdgeName(cell));

            } else {

                glGraph.setNode(cell.id, setNodeLabel(cell));

                // For the compound graphs we have to take embeds into account.
                if (glGraph.isCompound() && cell.has('parent')) {
                    glGraph.setParent(cell.id, cell.get('parent'));
                }
            }
        });

        return glGraph;
    }
};

joint.dia.Graph.prototype.toGraphLib = function(opt) {

    return joint.layout.DirectedGraph.toGraphLib(this, opt);
};

joint.dia.Graph.prototype.fromGraphLib = function(glGraph, opt) {

    return joint.layout.DirectedGraph.fromGraphLib.call(this, glGraph, opt);
};


    joint.g = g;
    joint.V = joint.Vectorizer = V;

    return joint;

}));

(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.libphonenumber = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var COMPILED = !0, goog = goog || {};
goog.global = this;
goog.isDef = function(a) {
  return void 0 !== a;
};
goog.exportPath_ = function(a, b, c) {
  a = a.split(".");
  c = c || goog.global;
  a[0] in c || !c.execScript || c.execScript("var " + a[0]);
  for (var d;a.length && (d = a.shift());) {
    !a.length && goog.isDef(b) ? c[d] = b : c = c[d] ? c[d] : c[d] = {};
  }
};
goog.define = function(a, b) {
  var c = b;
  COMPILED || (goog.global.CLOSURE_UNCOMPILED_DEFINES && Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES, a) ? c = goog.global.CLOSURE_UNCOMPILED_DEFINES[a] : goog.global.CLOSURE_DEFINES && Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES, a) && (c = goog.global.CLOSURE_DEFINES[a]));
  goog.exportPath_(a, c);
};
goog.DEBUG = !0;
goog.LOCALE = "en";
goog.TRUSTED_SITE = !0;
goog.STRICT_MODE_COMPATIBLE = !1;
goog.DISALLOW_TEST_ONLY_CODE = COMPILED && !goog.DEBUG;
goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING = !1;
goog.provide = function(a) {
  if (goog.isInModuleLoader_()) {
    throw Error("goog.provide can not be used within a goog.module.");
  }
  if (!COMPILED && goog.isProvided_(a)) {
    throw Error('Namespace "' + a + '" already declared.');
  }
  goog.constructNamespace_(a);
};
goog.constructNamespace_ = function(a, b) {
  if (!COMPILED) {
    delete goog.implicitNamespaces_[a];
    for (var c = a;(c = c.substring(0, c.lastIndexOf("."))) && !goog.getObjectByName(c);) {
      goog.implicitNamespaces_[c] = !0;
    }
  }
  goog.exportPath_(a, b);
};
goog.VALID_MODULE_RE_ = /^[a-zA-Z_$][a-zA-Z0-9._$]*$/;
goog.module = function(a) {
  if (!goog.isString(a) || !a || -1 == a.search(goog.VALID_MODULE_RE_)) {
    throw Error("Invalid module identifier");
  }
  if (!goog.isInModuleLoader_()) {
    throw Error("Module " + a + " has been loaded incorrectly.");
  }
  if (goog.moduleLoaderState_.moduleName) {
    throw Error("goog.module may only be called once per module.");
  }
  goog.moduleLoaderState_.moduleName = a;
  if (!COMPILED) {
    if (goog.isProvided_(a)) {
      throw Error('Namespace "' + a + '" already declared.');
    }
    delete goog.implicitNamespaces_[a];
  }
};
goog.module.get = function(a) {
  return goog.module.getInternal_(a);
};
goog.module.getInternal_ = function(a) {
  if (!COMPILED) {
    return goog.isProvided_(a) ? a in goog.loadedModules_ ? goog.loadedModules_[a] : goog.getObjectByName(a) : null;
  }
};
goog.moduleLoaderState_ = null;
goog.isInModuleLoader_ = function() {
  return null != goog.moduleLoaderState_;
};
goog.module.declareLegacyNamespace = function() {
  if (!COMPILED && !goog.isInModuleLoader_()) {
    throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");
  }
  if (!COMPILED && !goog.moduleLoaderState_.moduleName) {
    throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");
  }
  goog.moduleLoaderState_.declareLegacyNamespace = !0;
};
goog.setTestOnly = function(a) {
  if (goog.DISALLOW_TEST_ONLY_CODE) {
    throw a = a || "", Error("Importing test-only code into non-debug environment" + (a ? ": " + a : "."));
  }
};
goog.forwardDeclare = function(a) {
};
COMPILED || (goog.isProvided_ = function(a) {
  return a in goog.loadedModules_ || !goog.implicitNamespaces_[a] && goog.isDefAndNotNull(goog.getObjectByName(a));
}, goog.implicitNamespaces_ = {"goog.module":!0});
goog.getObjectByName = function(a, b) {
  for (var c = a.split("."), d = b || goog.global, e;e = c.shift();) {
    if (goog.isDefAndNotNull(d[e])) {
      d = d[e];
    } else {
      return null;
    }
  }
  return d;
};
goog.globalize = function(a, b) {
  var c = b || goog.global, d;
  for (d in a) {
    c[d] = a[d];
  }
};
goog.addDependency = function(a, b, c, d) {
  if (goog.DEPENDENCIES_ENABLED) {
    var e;
    a = a.replace(/\\/g, "/");
    var f = goog.dependencies_;
    d && "boolean" !== typeof d || (d = d ? {module:"goog"} : {});
    for (var g = 0;e = b[g];g++) {
      f.nameToPath[e] = a, f.loadFlags[a] = d;
    }
    for (d = 0;b = c[d];d++) {
      a in f.requires || (f.requires[a] = {}), f.requires[a][b] = !0;
    }
  }
};
goog.ENABLE_DEBUG_LOADER = !0;
goog.logToConsole_ = function(a) {
  goog.global.console && goog.global.console.error(a);
};
goog.require = function(a) {
  if (!COMPILED) {
    goog.ENABLE_DEBUG_LOADER && goog.IS_OLD_IE_ && goog.maybeProcessDeferredDep_(a);
    if (goog.isProvided_(a)) {
      return goog.isInModuleLoader_() ? goog.module.getInternal_(a) : null;
    }
    if (goog.ENABLE_DEBUG_LOADER) {
      var b = goog.getPathFromDeps_(a);
      if (b) {
        return goog.writeScripts_(b), null;
      }
    }
    a = "goog.require could not find: " + a;
    goog.logToConsole_(a);
    throw Error(a);
  }
};
goog.basePath = "";
goog.nullFunction = function() {
};
goog.abstractMethod = function() {
  throw Error("unimplemented abstract method");
};
goog.addSingletonGetter = function(a) {
  a.getInstance = function() {
    if (a.instance_) {
      return a.instance_;
    }
    goog.DEBUG && (goog.instantiatedSingletons_[goog.instantiatedSingletons_.length] = a);
    return a.instance_ = new a;
  };
};
goog.instantiatedSingletons_ = [];
goog.LOAD_MODULE_USING_EVAL = !0;
goog.SEAL_MODULE_EXPORTS = goog.DEBUG;
goog.loadedModules_ = {};
goog.DEPENDENCIES_ENABLED = !COMPILED && goog.ENABLE_DEBUG_LOADER;
goog.TRANSPILE = "detect";
goog.TRANSPILER = "transpile.js";
goog.DEPENDENCIES_ENABLED && (goog.dependencies_ = {loadFlags:{}, nameToPath:{}, requires:{}, visited:{}, written:{}, deferred:{}}, goog.inHtmlDocument_ = function() {
  var a = goog.global.document;
  return null != a && "write" in a;
}, goog.findBasePath_ = function() {
  if (goog.isDef(goog.global.CLOSURE_BASE_PATH)) {
    goog.basePath = goog.global.CLOSURE_BASE_PATH;
  } else {
    if (goog.inHtmlDocument_()) {
      for (var a = goog.global.document.getElementsByTagName("SCRIPT"), b = a.length - 1;0 <= b;--b) {
        var c = a[b].src, d = c.lastIndexOf("?"), d = -1 == d ? c.length : d;
        if ("base.js" == c.substr(d - 7, 7)) {
          goog.basePath = c.substr(0, d - 7);
          break;
        }
      }
    }
  }
}, goog.importScript_ = function(a, b) {
  (goog.global.CLOSURE_IMPORT_SCRIPT || goog.writeScriptTag_)(a, b) && (goog.dependencies_.written[a] = !0);
}, goog.IS_OLD_IE_ = !(goog.global.atob || !goog.global.document || !goog.global.document.all), goog.importProcessedScript_ = function(a, b, c) {
  goog.importScript_("", 'goog.retrieveAndExec_("' + a + '", ' + b + ", " + c + ");");
}, goog.queuedModules_ = [], goog.wrapModule_ = function(a, b) {
  return goog.LOAD_MODULE_USING_EVAL && goog.isDef(goog.global.JSON) ? "goog.loadModule(" + goog.global.JSON.stringify(b + "\n//# sourceURL=" + a + "\n") + ");" : 'goog.loadModule(function(exports) {"use strict";' + b + "\n;return exports});\n//# sourceURL=" + a + "\n";
}, goog.loadQueuedModules_ = function() {
  var a = goog.queuedModules_.length;
  if (0 < a) {
    var b = goog.queuedModules_;
    goog.queuedModules_ = [];
    for (var c = 0;c < a;c++) {
      goog.maybeProcessDeferredPath_(b[c]);
    }
  }
}, goog.maybeProcessDeferredDep_ = function(a) {
  goog.isDeferredModule_(a) && goog.allDepsAreAvailable_(a) && (a = goog.getPathFromDeps_(a), goog.maybeProcessDeferredPath_(goog.basePath + a));
}, goog.isDeferredModule_ = function(a) {
  var b = (a = goog.getPathFromDeps_(a)) && goog.dependencies_.loadFlags[a] || {};
  return a && ("goog" == b.module || goog.needsTranspile_(b.lang)) ? goog.basePath + a in goog.dependencies_.deferred : !1;
}, goog.allDepsAreAvailable_ = function(a) {
  if ((a = goog.getPathFromDeps_(a)) && a in goog.dependencies_.requires) {
    for (var b in goog.dependencies_.requires[a]) {
      if (!goog.isProvided_(b) && !goog.isDeferredModule_(b)) {
        return !1;
      }
    }
  }
  return !0;
}, goog.maybeProcessDeferredPath_ = function(a) {
  if (a in goog.dependencies_.deferred) {
    var b = goog.dependencies_.deferred[a];
    delete goog.dependencies_.deferred[a];
    goog.globalEval(b);
  }
}, goog.loadModuleFromUrl = function(a) {
  goog.retrieveAndExec_(a, !0, !1);
}, goog.writeScriptSrcNode_ = function(a) {
  goog.global.document.write('<script type="text/javascript" src="' + a + '">\x3c/script>');
}, goog.appendScriptSrcNode_ = function(a) {
  var b = goog.global.document, c = b.createElement("script");
  c.type = "text/javascript";
  c.src = a;
  c.defer = !1;
  c.async = !1;
  b.head.appendChild(c);
}, goog.writeScriptTag_ = function(a, b) {
  if (goog.inHtmlDocument_()) {
    var c = goog.global.document;
    if (!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING && "complete" == c.readyState) {
      if (/\bdeps.js$/.test(a)) {
        return !1;
      }
      throw Error('Cannot write "' + a + '" after document load');
    }
    if (void 0 === b) {
      if (goog.IS_OLD_IE_) {
        var d = " onreadystatechange='goog.onScriptLoad_(this, " + ++goog.lastNonModuleScriptIndex_ + ")' ";
        c.write('<script type="text/javascript" src="' + a + '"' + d + ">\x3c/script>");
      } else {
        goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING ? goog.appendScriptSrcNode_(a) : goog.writeScriptSrcNode_(a);
      }
    } else {
      c.write('<script type="text/javascript">' + b + "\x3c/script>");
    }
    return !0;
  }
  return !1;
}, goog.needsTranspile_ = function(a) {
  if ("always" == goog.TRANSPILE) {
    return !0;
  }
  if ("never" == goog.TRANSPILE) {
    return !1;
  }
  if (!goog.transpiledLanguages_) {
    goog.transpiledLanguages_ = {es5:!0, es6:!0, "es6-impl":!0};
    try {
      goog.transpiledLanguages_.es5 = eval("[1,].length!=1"), eval('(()=>{"use strict";let a={};const X=class{constructor(){}x(z){return new Map([...arguments]).get(z[0])==3}};return new X().x([a,3])})()') && (goog.transpiledLanguages_["es6-impl"] = !1), eval('(()=>{"use strict";class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}})()') && 
      (goog.transpiledLanguages_.es6 = !1);
    } catch (b) {
    }
  }
  return !!goog.transpiledLanguages_[a];
}, goog.transpiledLanguages_ = null, goog.lastNonModuleScriptIndex_ = 0, goog.onScriptLoad_ = function(a, b) {
  "complete" == a.readyState && goog.lastNonModuleScriptIndex_ == b && goog.loadQueuedModules_();
  return !0;
}, goog.writeScripts_ = function(a) {
  function b(a) {
    if (!(a in e.written || a in e.visited)) {
      e.visited[a] = !0;
      if (a in e.requires) {
        for (var f in e.requires[a]) {
          if (!goog.isProvided_(f)) {
            if (f in e.nameToPath) {
              b(e.nameToPath[f]);
            } else {
              throw Error("Undefined nameToPath for " + f);
            }
          }
        }
      }
      a in d || (d[a] = !0, c.push(a));
    }
  }
  var c = [], d = {}, e = goog.dependencies_;
  b(a);
  for (a = 0;a < c.length;a++) {
    var f = c[a];
    goog.dependencies_.written[f] = !0;
  }
  var g = goog.moduleLoaderState_;
  goog.moduleLoaderState_ = null;
  for (a = 0;a < c.length;a++) {
    if (f = c[a]) {
      var h = e.loadFlags[f] || {}, k = goog.needsTranspile_(h.lang);
      "goog" == h.module || k ? goog.importProcessedScript_(goog.basePath + f, "goog" == h.module, k) : goog.importScript_(goog.basePath + f);
    } else {
      throw goog.moduleLoaderState_ = g, Error("Undefined script input");
    }
  }
  goog.moduleLoaderState_ = g;
}, goog.getPathFromDeps_ = function(a) {
  return a in goog.dependencies_.nameToPath ? goog.dependencies_.nameToPath[a] : null;
}, goog.findBasePath_(), goog.global.CLOSURE_NO_DEPS || goog.importScript_(goog.basePath + "deps.js"));
goog.loadModule = function(a) {
  var b = goog.moduleLoaderState_;
  try {
    goog.moduleLoaderState_ = {moduleName:void 0, declareLegacyNamespace:!1};
    var c;
    if (goog.isFunction(a)) {
      c = a.call(void 0, {});
    } else {
      if (goog.isString(a)) {
        c = goog.loadModuleFromSource_.call(void 0, a);
      } else {
        throw Error("Invalid module definition");
      }
    }
    var d = goog.moduleLoaderState_.moduleName;
    if (!goog.isString(d) || !d) {
      throw Error('Invalid module name "' + d + '"');
    }
    goog.moduleLoaderState_.declareLegacyNamespace ? goog.constructNamespace_(d, c) : goog.SEAL_MODULE_EXPORTS && Object.seal && Object.seal(c);
    goog.loadedModules_[d] = c;
  } finally {
    goog.moduleLoaderState_ = b;
  }
};
goog.loadModuleFromSource_ = function(a) {
  eval(a);
  return {};
};
goog.normalizePath_ = function(a) {
  a = a.split("/");
  for (var b = 0;b < a.length;) {
    "." == a[b] ? a.splice(b, 1) : b && ".." == a[b] && a[b - 1] && ".." != a[b - 1] ? a.splice(--b, 2) : b++;
  }
  return a.join("/");
};
goog.loadFileSync_ = function(a) {
  if (goog.global.CLOSURE_LOAD_FILE_SYNC) {
    return goog.global.CLOSURE_LOAD_FILE_SYNC(a);
  }
  try {
    var b = new goog.global.XMLHttpRequest;
    b.open("get", a, !1);
    b.send();
    return 0 == b.status || 200 == b.status ? b.responseText : null;
  } catch (c) {
    return null;
  }
};
goog.retrieveAndExec_ = function(a, b, c) {
  if (!COMPILED) {
    var d = a;
    a = goog.normalizePath_(a);
    var e = goog.global.CLOSURE_IMPORT_SCRIPT || goog.writeScriptTag_, f = goog.loadFileSync_(a);
    if (null == f) {
      throw Error('Load of "' + a + '" failed');
    }
    c && (f = goog.transpile_.call(goog.global, f, a));
    f = b ? goog.wrapModule_(a, f) : f + ("\n//# sourceURL=" + a);
    goog.IS_OLD_IE_ ? (goog.dependencies_.deferred[d] = f, goog.queuedModules_.push(d)) : e(a, f);
  }
};
goog.transpile_ = function(a, b) {
  var c = goog.global.$jscomp;
  c || (goog.global.$jscomp = c = {});
  var d = c.transpile;
  if (!d) {
    var e = goog.basePath + goog.TRANSPILER, f = goog.loadFileSync_(e);
    f && (eval(f + "\n//# sourceURL=" + e), c = goog.global.$jscomp, d = c.transpile);
  }
  d || (d = c.transpile = function(a, b) {
    goog.logToConsole_(b + " requires transpilation but no transpiler was found.");
    return a;
  });
  return d(a, b);
};
goog.typeOf = function(a) {
  var b = typeof a;
  if ("object" == b) {
    if (a) {
      if (a instanceof Array) {
        return "array";
      }
      if (a instanceof Object) {
        return b;
      }
      var c = Object.prototype.toString.call(a);
      if ("[object Window]" == c) {
        return "object";
      }
      if ("[object Array]" == c || "number" == typeof a.length && "undefined" != typeof a.splice && "undefined" != typeof a.propertyIsEnumerable && !a.propertyIsEnumerable("splice")) {
        return "array";
      }
      if ("[object Function]" == c || "undefined" != typeof a.call && "undefined" != typeof a.propertyIsEnumerable && !a.propertyIsEnumerable("call")) {
        return "function";
      }
    } else {
      return "null";
    }
  } else {
    if ("function" == b && "undefined" == typeof a.call) {
      return "object";
    }
  }
  return b;
};
goog.isNull = function(a) {
  return null === a;
};
goog.isDefAndNotNull = function(a) {
  return null != a;
};
goog.isArray = function(a) {
  return "array" == goog.typeOf(a);
};
goog.isArrayLike = function(a) {
  var b = goog.typeOf(a);
  return "array" == b || "object" == b && "number" == typeof a.length;
};
goog.isDateLike = function(a) {
  return goog.isObject(a) && "function" == typeof a.getFullYear;
};
goog.isString = function(a) {
  return "string" == typeof a;
};
goog.isBoolean = function(a) {
  return "boolean" == typeof a;
};
goog.isNumber = function(a) {
  return "number" == typeof a;
};
goog.isFunction = function(a) {
  return "function" == goog.typeOf(a);
};
goog.isObject = function(a) {
  var b = typeof a;
  return "object" == b && null != a || "function" == b;
};
goog.getUid = function(a) {
  return a[goog.UID_PROPERTY_] || (a[goog.UID_PROPERTY_] = ++goog.uidCounter_);
};
goog.hasUid = function(a) {
  return !!a[goog.UID_PROPERTY_];
};
goog.removeUid = function(a) {
  null !== a && "removeAttribute" in a && a.removeAttribute(goog.UID_PROPERTY_);
  try {
    delete a[goog.UID_PROPERTY_];
  } catch (b) {
  }
};
goog.UID_PROPERTY_ = "closure_uid_" + (1E9 * Math.random() >>> 0);
goog.uidCounter_ = 0;
goog.getHashCode = goog.getUid;
goog.removeHashCode = goog.removeUid;
goog.cloneObject = function(a) {
  var b = goog.typeOf(a);
  if ("object" == b || "array" == b) {
    if (a.clone) {
      return a.clone();
    }
    var b = "array" == b ? [] : {}, c;
    for (c in a) {
      b[c] = goog.cloneObject(a[c]);
    }
    return b;
  }
  return a;
};
goog.bindNative_ = function(a, b, c) {
  return a.call.apply(a.bind, arguments);
};
goog.bindJs_ = function(a, b, c) {
  if (!a) {
    throw Error();
  }
  if (2 < arguments.length) {
    var d = Array.prototype.slice.call(arguments, 2);
    return function() {
      var c = Array.prototype.slice.call(arguments);
      Array.prototype.unshift.apply(c, d);
      return a.apply(b, c);
    };
  }
  return function() {
    return a.apply(b, arguments);
  };
};
goog.bind = function(a, b, c) {
  Function.prototype.bind && -1 != Function.prototype.bind.toString().indexOf("native code") ? goog.bind = goog.bindNative_ : goog.bind = goog.bindJs_;
  return goog.bind.apply(null, arguments);
};
goog.partial = function(a, b) {
  var c = Array.prototype.slice.call(arguments, 1);
  return function() {
    var b = c.slice();
    b.push.apply(b, arguments);
    return a.apply(this, b);
  };
};
goog.mixin = function(a, b) {
  for (var c in b) {
    a[c] = b[c];
  }
};
goog.now = goog.TRUSTED_SITE && Date.now || function() {
  return +new Date;
};
goog.globalEval = function(a) {
  if (goog.global.execScript) {
    goog.global.execScript(a, "JavaScript");
  } else {
    if (goog.global.eval) {
      if (null == goog.evalWorksForGlobals_) {
        if (goog.global.eval("var _evalTest_ = 1;"), "undefined" != typeof goog.global._evalTest_) {
          try {
            delete goog.global._evalTest_;
          } catch (d) {
          }
          goog.evalWorksForGlobals_ = !0;
        } else {
          goog.evalWorksForGlobals_ = !1;
        }
      }
      if (goog.evalWorksForGlobals_) {
        goog.global.eval(a);
      } else {
        var b = goog.global.document, c = b.createElement("SCRIPT");
        c.type = "text/javascript";
        c.defer = !1;
        c.appendChild(b.createTextNode(a));
        b.body.appendChild(c);
        b.body.removeChild(c);
      }
    } else {
      throw Error("goog.globalEval not available");
    }
  }
};
goog.evalWorksForGlobals_ = null;
goog.getCssName = function(a, b) {
  var c = function(a) {
    return goog.cssNameMapping_[a] || a;
  }, d = function(a) {
    a = a.split("-");
    for (var b = [], d = 0;d < a.length;d++) {
      b.push(c(a[d]));
    }
    return b.join("-");
  }, d = goog.cssNameMapping_ ? "BY_WHOLE" == goog.cssNameMappingStyle_ ? c : d : function(a) {
    return a;
  };
  return b ? a + "-" + d(b) : d(a);
};
goog.setCssNameMapping = function(a, b) {
  goog.cssNameMapping_ = a;
  goog.cssNameMappingStyle_ = b;
};
!COMPILED && goog.global.CLOSURE_CSS_NAME_MAPPING && (goog.cssNameMapping_ = goog.global.CLOSURE_CSS_NAME_MAPPING);
goog.getMsg = function(a, b) {
  b && (a = a.replace(/\{\$([^}]+)}/g, function(a, d) {
    return null != b && d in b ? b[d] : a;
  }));
  return a;
};
goog.getMsgWithFallback = function(a, b) {
  return a;
};
goog.exportSymbol = function(a, b, c) {
  goog.exportPath_(a, b, c);
};
goog.exportProperty = function(a, b, c) {
  a[b] = c;
};
goog.inherits = function(a, b) {
  function c() {
  }
  c.prototype = b.prototype;
  a.superClass_ = b.prototype;
  a.prototype = new c;
  a.prototype.constructor = a;
  a.base = function(a, c, f) {
    for (var g = Array(arguments.length - 2), h = 2;h < arguments.length;h++) {
      g[h - 2] = arguments[h];
    }
    return b.prototype[c].apply(a, g);
  };
};
goog.base = function(a, b, c) {
  var d = arguments.callee.caller;
  if (goog.STRICT_MODE_COMPATIBLE || goog.DEBUG && !d) {
    throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");
  }
  if (d.superClass_) {
    for (var e = Array(arguments.length - 1), f = 1;f < arguments.length;f++) {
      e[f - 1] = arguments[f];
    }
    return d.superClass_.constructor.apply(a, e);
  }
  e = Array(arguments.length - 2);
  for (f = 2;f < arguments.length;f++) {
    e[f - 2] = arguments[f];
  }
  for (var f = !1, g = a.constructor;g;g = g.superClass_ && g.superClass_.constructor) {
    if (g.prototype[b] === d) {
      f = !0;
    } else {
      if (f) {
        return g.prototype[b].apply(a, e);
      }
    }
  }
  if (a[b] === d) {
    return a.constructor.prototype[b].apply(a, e);
  }
  throw Error("goog.base called from a method of one name to a method of a different name");
};
goog.scope = function(a) {
  if (goog.isInModuleLoader_()) {
    throw Error("goog.scope is not supported within a goog.module.");
  }
  a.call(goog.global);
};
COMPILED || (goog.global.COMPILED = COMPILED);
goog.defineClass = function(a, b) {
  var c = b.constructor, d = b.statics;
  c && c != Object.prototype.constructor || (c = function() {
    throw Error("cannot instantiate an interface (no constructor defined).");
  });
  c = goog.defineClass.createSealingConstructor_(c, a);
  a && goog.inherits(c, a);
  delete b.constructor;
  delete b.statics;
  goog.defineClass.applyProperties_(c.prototype, b);
  null != d && (d instanceof Function ? d(c) : goog.defineClass.applyProperties_(c, d));
  return c;
};
goog.defineClass.SEAL_CLASS_INSTANCES = goog.DEBUG;
goog.defineClass.createSealingConstructor_ = function(a, b) {
  if (!goog.defineClass.SEAL_CLASS_INSTANCES) {
    return a;
  }
  var c = !goog.defineClass.isUnsealable_(b), d = function() {
    var b = a.apply(this, arguments) || this;
    b[goog.UID_PROPERTY_] = b[goog.UID_PROPERTY_];
    this.constructor === d && c && Object.seal instanceof Function && Object.seal(b);
    return b;
  };
  return d;
};
goog.defineClass.isUnsealable_ = function(a) {
  return a && a.prototype && a.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_];
};
goog.defineClass.OBJECT_PROTOTYPE_FIELDS_ = "constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.defineClass.applyProperties_ = function(a, b) {
  for (var c in b) {
    Object.prototype.hasOwnProperty.call(b, c) && (a[c] = b[c]);
  }
  for (var d = 0;d < goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;d++) {
    c = goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[d], Object.prototype.hasOwnProperty.call(b, c) && (a[c] = b[c]);
  }
};
goog.tagUnsealableClass = function(a) {
  !COMPILED && goog.defineClass.SEAL_CLASS_INSTANCES && (a.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_] = !0);
};
goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_ = "goog_defineClass_legacy_unsealable";
goog.string = {};
goog.string.StringBuffer = function(a, b) {
  null != a && this.append.apply(this, arguments);
};
goog.string.StringBuffer.prototype.buffer_ = "";
goog.string.StringBuffer.prototype.set = function(a) {
  this.buffer_ = "" + a;
};
goog.string.StringBuffer.prototype.append = function(a, b, c) {
  this.buffer_ += String(a);
  if (null != b) {
    for (var d = 1;d < arguments.length;d++) {
      this.buffer_ += arguments[d];
    }
  }
  return this;
};
goog.string.StringBuffer.prototype.clear = function() {
  this.buffer_ = "";
};
goog.string.StringBuffer.prototype.getLength = function() {
  return this.buffer_.length;
};
goog.string.StringBuffer.prototype.toString = function() {
  return this.buffer_;
};
goog.debug = {};
goog.debug.Error = function(a) {
  if (Error.captureStackTrace) {
    Error.captureStackTrace(this, goog.debug.Error);
  } else {
    var b = Error().stack;
    b && (this.stack = b);
  }
  a && (this.message = String(a));
  this.reportErrorToServer = !0;
};
goog.inherits(goog.debug.Error, Error);
goog.debug.Error.prototype.name = "CustomError";
goog.dom = {};
goog.dom.NodeType = {ELEMENT:1, ATTRIBUTE:2, TEXT:3, CDATA_SECTION:4, ENTITY_REFERENCE:5, ENTITY:6, PROCESSING_INSTRUCTION:7, COMMENT:8, DOCUMENT:9, DOCUMENT_TYPE:10, DOCUMENT_FRAGMENT:11, NOTATION:12};
goog.string.DETECT_DOUBLE_ESCAPING = !1;
goog.string.FORCE_NON_DOM_HTML_UNESCAPING = !1;
goog.string.Unicode = {NBSP:"\u00a0"};
goog.string.startsWith = function(a, b) {
  return 0 == a.lastIndexOf(b, 0);
};
goog.string.endsWith = function(a, b) {
  var c = a.length - b.length;
  return 0 <= c && a.indexOf(b, c) == c;
};
goog.string.caseInsensitiveStartsWith = function(a, b) {
  return 0 == goog.string.caseInsensitiveCompare(b, a.substr(0, b.length));
};
goog.string.caseInsensitiveEndsWith = function(a, b) {
  return 0 == goog.string.caseInsensitiveCompare(b, a.substr(a.length - b.length, b.length));
};
goog.string.caseInsensitiveEquals = function(a, b) {
  return a.toLowerCase() == b.toLowerCase();
};
goog.string.subs = function(a, b) {
  for (var c = a.split("%s"), d = "", e = Array.prototype.slice.call(arguments, 1);e.length && 1 < c.length;) {
    d += c.shift() + e.shift();
  }
  return d + c.join("%s");
};
goog.string.collapseWhitespace = function(a) {
  return a.replace(/[\s\xa0]+/g, " ").replace(/^\s+|\s+$/g, "");
};
goog.string.isEmptyOrWhitespace = function(a) {
  return /^[\s\xa0]*$/.test(a);
};
goog.string.isEmptyString = function(a) {
  return 0 == a.length;
};
goog.string.isEmpty = goog.string.isEmptyOrWhitespace;
goog.string.isEmptyOrWhitespaceSafe = function(a) {
  return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(a));
};
goog.string.isEmptySafe = goog.string.isEmptyOrWhitespaceSafe;
goog.string.isBreakingWhitespace = function(a) {
  return !/[^\t\n\r ]/.test(a);
};
goog.string.isAlpha = function(a) {
  return !/[^a-zA-Z]/.test(a);
};
goog.string.isNumeric = function(a) {
  return !/[^0-9]/.test(a);
};
goog.string.isAlphaNumeric = function(a) {
  return !/[^a-zA-Z0-9]/.test(a);
};
goog.string.isSpace = function(a) {
  return " " == a;
};
goog.string.isUnicodeChar = function(a) {
  return 1 == a.length && " " <= a && "~" >= a || "\u0080" <= a && "\ufffd" >= a;
};
goog.string.stripNewlines = function(a) {
  return a.replace(/(\r\n|\r|\n)+/g, " ");
};
goog.string.canonicalizeNewlines = function(a) {
  return a.replace(/(\r\n|\r|\n)/g, "\n");
};
goog.string.normalizeWhitespace = function(a) {
  return a.replace(/\xa0|\s/g, " ");
};
goog.string.normalizeSpaces = function(a) {
  return a.replace(/\xa0|[ \t]+/g, " ");
};
goog.string.collapseBreakingSpaces = function(a) {
  return a.replace(/[\t\r\n ]+/g, " ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g, "");
};
goog.string.trim = goog.TRUSTED_SITE && String.prototype.trim ? function(a) {
  return a.trim();
} : function(a) {
  return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g, "");
};
goog.string.trimLeft = function(a) {
  return a.replace(/^[\s\xa0]+/, "");
};
goog.string.trimRight = function(a) {
  return a.replace(/[\s\xa0]+$/, "");
};
goog.string.caseInsensitiveCompare = function(a, b) {
  var c = String(a).toLowerCase(), d = String(b).toLowerCase();
  return c < d ? -1 : c == d ? 0 : 1;
};
goog.string.numberAwareCompare_ = function(a, b, c) {
  if (a == b) {
    return 0;
  }
  if (!a) {
    return -1;
  }
  if (!b) {
    return 1;
  }
  for (var d = a.toLowerCase().match(c), e = b.toLowerCase().match(c), f = Math.min(d.length, e.length), g = 0;g < f;g++) {
    c = d[g];
    var h = e[g];
    if (c != h) {
      return a = parseInt(c, 10), !isNaN(a) && (b = parseInt(h, 10), !isNaN(b) && a - b) ? a - b : c < h ? -1 : 1;
    }
  }
  return d.length != e.length ? d.length - e.length : a < b ? -1 : 1;
};
goog.string.intAwareCompare = function(a, b) {
  return goog.string.numberAwareCompare_(a, b, /\d+|\D+/g);
};
goog.string.floatAwareCompare = function(a, b) {
  return goog.string.numberAwareCompare_(a, b, /\d+|\.\d+|\D+/g);
};
goog.string.numerateCompare = goog.string.floatAwareCompare;
goog.string.urlEncode = function(a) {
  return encodeURIComponent(String(a));
};
goog.string.urlDecode = function(a) {
  return decodeURIComponent(a.replace(/\+/g, " "));
};
goog.string.newLineToBr = function(a, b) {
  return a.replace(/(\r\n|\r|\n)/g, b ? "<br />" : "<br>");
};
goog.string.htmlEscape = function(a, b) {
  if (b) {
    a = a.replace(goog.string.AMP_RE_, "&amp;").replace(goog.string.LT_RE_, "&lt;").replace(goog.string.GT_RE_, "&gt;").replace(goog.string.QUOT_RE_, "&quot;").replace(goog.string.SINGLE_QUOTE_RE_, "&#39;").replace(goog.string.NULL_RE_, "&#0;"), goog.string.DETECT_DOUBLE_ESCAPING && (a = a.replace(goog.string.E_RE_, "&#101;"));
  } else {
    if (!goog.string.ALL_RE_.test(a)) {
      return a;
    }
    -1 != a.indexOf("&") && (a = a.replace(goog.string.AMP_RE_, "&amp;"));
    -1 != a.indexOf("<") && (a = a.replace(goog.string.LT_RE_, "&lt;"));
    -1 != a.indexOf(">") && (a = a.replace(goog.string.GT_RE_, "&gt;"));
    -1 != a.indexOf('"') && (a = a.replace(goog.string.QUOT_RE_, "&quot;"));
    -1 != a.indexOf("'") && (a = a.replace(goog.string.SINGLE_QUOTE_RE_, "&#39;"));
    -1 != a.indexOf("\x00") && (a = a.replace(goog.string.NULL_RE_, "&#0;"));
    goog.string.DETECT_DOUBLE_ESCAPING && -1 != a.indexOf("e") && (a = a.replace(goog.string.E_RE_, "&#101;"));
  }
  return a;
};
goog.string.AMP_RE_ = /&/g;
goog.string.LT_RE_ = /</g;
goog.string.GT_RE_ = />/g;
goog.string.QUOT_RE_ = /"/g;
goog.string.SINGLE_QUOTE_RE_ = /'/g;
goog.string.NULL_RE_ = /\x00/g;
goog.string.E_RE_ = /e/g;
goog.string.ALL_RE_ = goog.string.DETECT_DOUBLE_ESCAPING ? /[\x00&<>"'e]/ : /[\x00&<>"']/;
goog.string.unescapeEntities = function(a) {
  return goog.string.contains(a, "&") ? !goog.string.FORCE_NON_DOM_HTML_UNESCAPING && "document" in goog.global ? goog.string.unescapeEntitiesUsingDom_(a) : goog.string.unescapePureXmlEntities_(a) : a;
};
goog.string.unescapeEntitiesWithDocument = function(a, b) {
  return goog.string.contains(a, "&") ? goog.string.unescapeEntitiesUsingDom_(a, b) : a;
};
goog.string.unescapeEntitiesUsingDom_ = function(a, b) {
  var c = {"&amp;":"&", "&lt;":"<", "&gt;":">", "&quot;":'"'}, d;
  d = b ? b.createElement("div") : goog.global.document.createElement("div");
  return a.replace(goog.string.HTML_ENTITY_PATTERN_, function(a, b) {
    var g = c[a];
    if (g) {
      return g;
    }
    if ("#" == b.charAt(0)) {
      var h = Number("0" + b.substr(1));
      isNaN(h) || (g = String.fromCharCode(h));
    }
    g || (d.innerHTML = a + " ", g = d.firstChild.nodeValue.slice(0, -1));
    return c[a] = g;
  });
};
goog.string.unescapePureXmlEntities_ = function(a) {
  return a.replace(/&([^;]+);/g, function(a, c) {
    switch(c) {
      case "amp":
        return "&";
      case "lt":
        return "<";
      case "gt":
        return ">";
      case "quot":
        return '"';
      default:
        if ("#" == c.charAt(0)) {
          var d = Number("0" + c.substr(1));
          if (!isNaN(d)) {
            return String.fromCharCode(d);
          }
        }
        return a;
    }
  });
};
goog.string.HTML_ENTITY_PATTERN_ = /&([^;\s<&]+);?/g;
goog.string.whitespaceEscape = function(a, b) {
  return goog.string.newLineToBr(a.replace(/  /g, " &#160;"), b);
};
goog.string.preserveSpaces = function(a) {
  return a.replace(/(^|[\n ]) /g, "$1" + goog.string.Unicode.NBSP);
};
goog.string.stripQuotes = function(a, b) {
  for (var c = b.length, d = 0;d < c;d++) {
    var e = 1 == c ? b : b.charAt(d);
    if (a.charAt(0) == e && a.charAt(a.length - 1) == e) {
      return a.substring(1, a.length - 1);
    }
  }
  return a;
};
goog.string.truncate = function(a, b, c) {
  c && (a = goog.string.unescapeEntities(a));
  a.length > b && (a = a.substring(0, b - 3) + "...");
  c && (a = goog.string.htmlEscape(a));
  return a;
};
goog.string.truncateMiddle = function(a, b, c, d) {
  c && (a = goog.string.unescapeEntities(a));
  if (d && a.length > b) {
    d > b && (d = b);
    var e = a.length - d;
    a = a.substring(0, b - d) + "..." + a.substring(e);
  } else {
    a.length > b && (d = Math.floor(b / 2), e = a.length - d, a = a.substring(0, d + b % 2) + "..." + a.substring(e));
  }
  c && (a = goog.string.htmlEscape(a));
  return a;
};
goog.string.specialEscapeChars_ = {"\x00":"\\0", "\b":"\\b", "\f":"\\f", "\n":"\\n", "\r":"\\r", "\t":"\\t", "\x0B":"\\x0B", '"':'\\"', "\\":"\\\\", "<":"<"};
goog.string.jsEscapeCache_ = {"'":"\\'"};
goog.string.quote = function(a) {
  a = String(a);
  for (var b = ['"'], c = 0;c < a.length;c++) {
    var d = a.charAt(c), e = d.charCodeAt(0);
    b[c + 1] = goog.string.specialEscapeChars_[d] || (31 < e && 127 > e ? d : goog.string.escapeChar(d));
  }
  b.push('"');
  return b.join("");
};
goog.string.escapeString = function(a) {
  for (var b = [], c = 0;c < a.length;c++) {
    b[c] = goog.string.escapeChar(a.charAt(c));
  }
  return b.join("");
};
goog.string.escapeChar = function(a) {
  if (a in goog.string.jsEscapeCache_) {
    return goog.string.jsEscapeCache_[a];
  }
  if (a in goog.string.specialEscapeChars_) {
    return goog.string.jsEscapeCache_[a] = goog.string.specialEscapeChars_[a];
  }
  var b, c = a.charCodeAt(0);
  if (31 < c && 127 > c) {
    b = a;
  } else {
    if (256 > c) {
      if (b = "\\x", 16 > c || 256 < c) {
        b += "0";
      }
    } else {
      b = "\\u", 4096 > c && (b += "0");
    }
    b += c.toString(16).toUpperCase();
  }
  return goog.string.jsEscapeCache_[a] = b;
};
goog.string.contains = function(a, b) {
  return -1 != a.indexOf(b);
};
goog.string.caseInsensitiveContains = function(a, b) {
  return goog.string.contains(a.toLowerCase(), b.toLowerCase());
};
goog.string.countOf = function(a, b) {
  return a && b ? a.split(b).length - 1 : 0;
};
goog.string.removeAt = function(a, b, c) {
  var d = a;
  0 <= b && b < a.length && 0 < c && (d = a.substr(0, b) + a.substr(b + c, a.length - b - c));
  return d;
};
goog.string.remove = function(a, b) {
  var c = new RegExp(goog.string.regExpEscape(b), "");
  return a.replace(c, "");
};
goog.string.removeAll = function(a, b) {
  var c = new RegExp(goog.string.regExpEscape(b), "g");
  return a.replace(c, "");
};
goog.string.regExpEscape = function(a) {
  return String(a).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g, "\\$1").replace(/\x08/g, "\\x08");
};
goog.string.repeat = String.prototype.repeat ? function(a, b) {
  return a.repeat(b);
} : function(a, b) {
  return Array(b + 1).join(a);
};
goog.string.padNumber = function(a, b, c) {
  a = goog.isDef(c) ? a.toFixed(c) : String(a);
  c = a.indexOf(".");
  -1 == c && (c = a.length);
  return goog.string.repeat("0", Math.max(0, b - c)) + a;
};
goog.string.makeSafe = function(a) {
  return null == a ? "" : String(a);
};
goog.string.buildString = function(a) {
  return Array.prototype.join.call(arguments, "");
};
goog.string.getRandomString = function() {
  return Math.floor(2147483648 * Math.random()).toString(36) + Math.abs(Math.floor(2147483648 * Math.random()) ^ goog.now()).toString(36);
};
goog.string.compareVersions = function(a, b) {
  for (var c = 0, d = goog.string.trim(String(a)).split("."), e = goog.string.trim(String(b)).split("."), f = Math.max(d.length, e.length), g = 0;0 == c && g < f;g++) {
    var h = d[g] || "", k = e[g] || "", l = RegExp("(\\d*)(\\D*)", "g"), p = RegExp("(\\d*)(\\D*)", "g");
    do {
      var m = l.exec(h) || ["", "", ""], n = p.exec(k) || ["", "", ""];
      if (0 == m[0].length && 0 == n[0].length) {
        break;
      }
      var c = 0 == m[1].length ? 0 : parseInt(m[1], 10), q = 0 == n[1].length ? 0 : parseInt(n[1], 10), c = goog.string.compareElements_(c, q) || goog.string.compareElements_(0 == m[2].length, 0 == n[2].length) || goog.string.compareElements_(m[2], n[2]);
    } while (0 == c);
  }
  return c;
};
goog.string.compareElements_ = function(a, b) {
  return a < b ? -1 : a > b ? 1 : 0;
};
goog.string.hashCode = function(a) {
  for (var b = 0, c = 0;c < a.length;++c) {
    b = 31 * b + a.charCodeAt(c) >>> 0;
  }
  return b;
};
goog.string.uniqueStringCounter_ = 2147483648 * Math.random() | 0;
goog.string.createUniqueString = function() {
  return "goog_" + goog.string.uniqueStringCounter_++;
};
goog.string.toNumber = function(a) {
  var b = Number(a);
  return 0 == b && goog.string.isEmptyOrWhitespace(a) ? NaN : b;
};
goog.string.isLowerCamelCase = function(a) {
  return /^[a-z]+([A-Z][a-z]*)*$/.test(a);
};
goog.string.isUpperCamelCase = function(a) {
  return /^([A-Z][a-z]*)+$/.test(a);
};
goog.string.toCamelCase = function(a) {
  return String(a).replace(/\-([a-z])/g, function(a, c) {
    return c.toUpperCase();
  });
};
goog.string.toSelectorCase = function(a) {
  return String(a).replace(/([A-Z])/g, "-$1").toLowerCase();
};
goog.string.toTitleCase = function(a, b) {
  var c = goog.isString(b) ? goog.string.regExpEscape(b) : "\\s";
  return a.replace(new RegExp("(^" + (c ? "|[" + c + "]+" : "") + ")([a-z])", "g"), function(a, b, c) {
    return b + c.toUpperCase();
  });
};
goog.string.capitalize = function(a) {
  return String(a.charAt(0)).toUpperCase() + String(a.substr(1)).toLowerCase();
};
goog.string.parseInt = function(a) {
  isFinite(a) && (a = String(a));
  return goog.isString(a) ? /^\s*-?0x/i.test(a) ? parseInt(a, 16) : parseInt(a, 10) : NaN;
};
goog.string.splitLimit = function(a, b, c) {
  a = a.split(b);
  for (var d = [];0 < c && a.length;) {
    d.push(a.shift()), c--;
  }
  a.length && d.push(a.join(b));
  return d;
};
goog.string.lastComponent = function(a, b) {
  if (b) {
    "string" == typeof b && (b = [b]);
  } else {
    return a;
  }
  for (var c = -1, d = 0;d < b.length;d++) {
    if ("" != b[d]) {
      var e = a.lastIndexOf(b[d]);
      e > c && (c = e);
    }
  }
  return -1 == c ? a : a.slice(c + 1);
};
goog.string.editDistance = function(a, b) {
  var c = [], d = [];
  if (a == b) {
    return 0;
  }
  if (!a.length || !b.length) {
    return Math.max(a.length, b.length);
  }
  for (var e = 0;e < b.length + 1;e++) {
    c[e] = e;
  }
  for (e = 0;e < a.length;e++) {
    d[0] = e + 1;
    for (var f = 0;f < b.length;f++) {
      d[f + 1] = Math.min(d[f] + 1, c[f + 1] + 1, c[f] + Number(a[e] != b[f]));
    }
    for (f = 0;f < c.length;f++) {
      c[f] = d[f];
    }
  }
  return d[b.length];
};
goog.asserts = {};
goog.asserts.ENABLE_ASSERTS = goog.DEBUG;
goog.asserts.AssertionError = function(a, b) {
  b.unshift(a);
  goog.debug.Error.call(this, goog.string.subs.apply(null, b));
  b.shift();
  this.messagePattern = a;
};
goog.inherits(goog.asserts.AssertionError, goog.debug.Error);
goog.asserts.AssertionError.prototype.name = "AssertionError";
goog.asserts.DEFAULT_ERROR_HANDLER = function(a) {
  throw a;
};
goog.asserts.errorHandler_ = goog.asserts.DEFAULT_ERROR_HANDLER;
goog.asserts.doAssertFailure_ = function(a, b, c, d) {
  var e = "Assertion failed";
  if (c) {
    var e = e + (": " + c), f = d
  } else {
    a && (e += ": " + a, f = b);
  }
  a = new goog.asserts.AssertionError("" + e, f || []);
  goog.asserts.errorHandler_(a);
};
goog.asserts.setErrorHandler = function(a) {
  goog.asserts.ENABLE_ASSERTS && (goog.asserts.errorHandler_ = a);
};
goog.asserts.assert = function(a, b, c) {
  goog.asserts.ENABLE_ASSERTS && !a && goog.asserts.doAssertFailure_("", null, b, Array.prototype.slice.call(arguments, 2));
  return a;
};
goog.asserts.fail = function(a, b) {
  goog.asserts.ENABLE_ASSERTS && goog.asserts.errorHandler_(new goog.asserts.AssertionError("Failure" + (a ? ": " + a : ""), Array.prototype.slice.call(arguments, 1)));
};
goog.asserts.assertNumber = function(a, b, c) {
  goog.asserts.ENABLE_ASSERTS && !goog.isNumber(a) && goog.asserts.doAssertFailure_("Expected number but got %s: %s.", [goog.typeOf(a), a], b, Array.prototype.slice.call(arguments, 2));
  return a;
};
goog.asserts.assertString = function(a, b, c) {
  goog.asserts.ENABLE_ASSERTS && !goog.isString(a) && goog.asserts.doAssertFailure_("Expected string but got %s: %s.", [goog.typeOf(a), a], b, Array.prototype.slice.call(arguments, 2));
  return a;
};
goog.asserts.assertFunction = function(a, b, c) {
  goog.asserts.ENABLE_ASSERTS && !goog.isFunction(a) && goog.asserts.doAssertFailure_("Expected function but got %s: %s.", [goog.typeOf(a), a], b, Array.prototype.slice.call(arguments, 2));
  return a;
};
goog.asserts.assertObject = function(a, b, c) {
  goog.asserts.ENABLE_ASSERTS && !goog.isObject(a) && goog.asserts.doAssertFailure_("Expected object but got %s: %s.", [goog.typeOf(a), a], b, Array.prototype.slice.call(arguments, 2));
  return a;
};
goog.asserts.assertArray = function(a, b, c) {
  goog.asserts.ENABLE_ASSERTS && !goog.isArray(a) && goog.asserts.doAssertFailure_("Expected array but got %s: %s.", [goog.typeOf(a), a], b, Array.prototype.slice.call(arguments, 2));
  return a;
};
goog.asserts.assertBoolean = function(a, b, c) {
  goog.asserts.ENABLE_ASSERTS && !goog.isBoolean(a) && goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.", [goog.typeOf(a), a], b, Array.prototype.slice.call(arguments, 2));
  return a;
};
goog.asserts.assertElement = function(a, b, c) {
  !goog.asserts.ENABLE_ASSERTS || goog.isObject(a) && a.nodeType == goog.dom.NodeType.ELEMENT || goog.asserts.doAssertFailure_("Expected Element but got %s: %s.", [goog.typeOf(a), a], b, Array.prototype.slice.call(arguments, 2));
  return a;
};
goog.asserts.assertInstanceof = function(a, b, c, d) {
  !goog.asserts.ENABLE_ASSERTS || a instanceof b || goog.asserts.doAssertFailure_("Expected instanceof %s but got %s.", [goog.asserts.getType_(b), goog.asserts.getType_(a)], c, Array.prototype.slice.call(arguments, 3));
  return a;
};
goog.asserts.assertObjectPrototypeIsIntact = function() {
  for (var a in Object.prototype) {
    goog.asserts.fail(a + " should not be enumerable in Object.prototype.");
  }
};
goog.asserts.getType_ = function(a) {
  return a instanceof Function ? a.displayName || a.name || "unknown type name" : a instanceof Object ? a.constructor.displayName || a.constructor.name || Object.prototype.toString.call(a) : null === a ? "null" : typeof a;
};
goog.array = {};
goog.NATIVE_ARRAY_PROTOTYPES = goog.TRUSTED_SITE;
goog.array.ASSUME_NATIVE_FUNCTIONS = !1;
goog.array.peek = function(a) {
  return a[a.length - 1];
};
goog.array.last = goog.array.peek;
goog.array.indexOf = goog.NATIVE_ARRAY_PROTOTYPES && (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.indexOf) ? function(a, b, c) {
  goog.asserts.assert(null != a.length);
  return Array.prototype.indexOf.call(a, b, c);
} : function(a, b, c) {
  c = null == c ? 0 : 0 > c ? Math.max(0, a.length + c) : c;
  if (goog.isString(a)) {
    return goog.isString(b) && 1 == b.length ? a.indexOf(b, c) : -1;
  }
  for (;c < a.length;c++) {
    if (c in a && a[c] === b) {
      return c;
    }
  }
  return -1;
};
goog.array.lastIndexOf = goog.NATIVE_ARRAY_PROTOTYPES && (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.lastIndexOf) ? function(a, b, c) {
  goog.asserts.assert(null != a.length);
  return Array.prototype.lastIndexOf.call(a, b, null == c ? a.length - 1 : c);
} : function(a, b, c) {
  c = null == c ? a.length - 1 : c;
  0 > c && (c = Math.max(0, a.length + c));
  if (goog.isString(a)) {
    return goog.isString(b) && 1 == b.length ? a.lastIndexOf(b, c) : -1;
  }
  for (;0 <= c;c--) {
    if (c in a && a[c] === b) {
      return c;
    }
  }
  return -1;
};
goog.array.forEach = goog.NATIVE_ARRAY_PROTOTYPES && (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.forEach) ? function(a, b, c) {
  goog.asserts.assert(null != a.length);
  Array.prototype.forEach.call(a, b, c);
} : function(a, b, c) {
  for (var d = a.length, e = goog.isString(a) ? a.split("") : a, f = 0;f < d;f++) {
    f in e && b.call(c, e[f], f, a);
  }
};
goog.array.forEachRight = function(a, b, c) {
  for (var d = a.length, e = goog.isString(a) ? a.split("") : a, d = d - 1;0 <= d;--d) {
    d in e && b.call(c, e[d], d, a);
  }
};
goog.array.filter = goog.NATIVE_ARRAY_PROTOTYPES && (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.filter) ? function(a, b, c) {
  goog.asserts.assert(null != a.length);
  return Array.prototype.filter.call(a, b, c);
} : function(a, b, c) {
  for (var d = a.length, e = [], f = 0, g = goog.isString(a) ? a.split("") : a, h = 0;h < d;h++) {
    if (h in g) {
      var k = g[h];
      b.call(c, k, h, a) && (e[f++] = k);
    }
  }
  return e;
};
goog.array.map = goog.NATIVE_ARRAY_PROTOTYPES && (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.map) ? function(a, b, c) {
  goog.asserts.assert(null != a.length);
  return Array.prototype.map.call(a, b, c);
} : function(a, b, c) {
  for (var d = a.length, e = Array(d), f = goog.isString(a) ? a.split("") : a, g = 0;g < d;g++) {
    g in f && (e[g] = b.call(c, f[g], g, a));
  }
  return e;
};
goog.array.reduce = goog.NATIVE_ARRAY_PROTOTYPES && (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.reduce) ? function(a, b, c, d) {
  goog.asserts.assert(null != a.length);
  d && (b = goog.bind(b, d));
  return Array.prototype.reduce.call(a, b, c);
} : function(a, b, c, d) {
  var e = c;
  goog.array.forEach(a, function(c, g) {
    e = b.call(d, e, c, g, a);
  });
  return e;
};
goog.array.reduceRight = goog.NATIVE_ARRAY_PROTOTYPES && (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.reduceRight) ? function(a, b, c, d) {
  goog.asserts.assert(null != a.length);
  goog.asserts.assert(null != b);
  d && (b = goog.bind(b, d));
  return Array.prototype.reduceRight.call(a, b, c);
} : function(a, b, c, d) {
  var e = c;
  goog.array.forEachRight(a, function(c, g) {
    e = b.call(d, e, c, g, a);
  });
  return e;
};
goog.array.some = goog.NATIVE_ARRAY_PROTOTYPES && (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.some) ? function(a, b, c) {
  goog.asserts.assert(null != a.length);
  return Array.prototype.some.call(a, b, c);
} : function(a, b, c) {
  for (var d = a.length, e = goog.isString(a) ? a.split("") : a, f = 0;f < d;f++) {
    if (f in e && b.call(c, e[f], f, a)) {
      return !0;
    }
  }
  return !1;
};
goog.array.every = goog.NATIVE_ARRAY_PROTOTYPES && (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.every) ? function(a, b, c) {
  goog.asserts.assert(null != a.length);
  return Array.prototype.every.call(a, b, c);
} : function(a, b, c) {
  for (var d = a.length, e = goog.isString(a) ? a.split("") : a, f = 0;f < d;f++) {
    if (f in e && !b.call(c, e[f], f, a)) {
      return !1;
    }
  }
  return !0;
};
goog.array.count = function(a, b, c) {
  var d = 0;
  goog.array.forEach(a, function(a, f, g) {
    b.call(c, a, f, g) && ++d;
  }, c);
  return d;
};
goog.array.find = function(a, b, c) {
  b = goog.array.findIndex(a, b, c);
  return 0 > b ? null : goog.isString(a) ? a.charAt(b) : a[b];
};
goog.array.findIndex = function(a, b, c) {
  for (var d = a.length, e = goog.isString(a) ? a.split("") : a, f = 0;f < d;f++) {
    if (f in e && b.call(c, e[f], f, a)) {
      return f;
    }
  }
  return -1;
};
goog.array.findRight = function(a, b, c) {
  b = goog.array.findIndexRight(a, b, c);
  return 0 > b ? null : goog.isString(a) ? a.charAt(b) : a[b];
};
goog.array.findIndexRight = function(a, b, c) {
  for (var d = a.length, e = goog.isString(a) ? a.split("") : a, d = d - 1;0 <= d;d--) {
    if (d in e && b.call(c, e[d], d, a)) {
      return d;
    }
  }
  return -1;
};
goog.array.contains = function(a, b) {
  return 0 <= goog.array.indexOf(a, b);
};
goog.array.isEmpty = function(a) {
  return 0 == a.length;
};
goog.array.clear = function(a) {
  if (!goog.isArray(a)) {
    for (var b = a.length - 1;0 <= b;b--) {
      delete a[b];
    }
  }
  a.length = 0;
};
goog.array.insert = function(a, b) {
  goog.array.contains(a, b) || a.push(b);
};
goog.array.insertAt = function(a, b, c) {
  goog.array.splice(a, c, 0, b);
};
goog.array.insertArrayAt = function(a, b, c) {
  goog.partial(goog.array.splice, a, c, 0).apply(null, b);
};
goog.array.insertBefore = function(a, b, c) {
  var d;
  2 == arguments.length || 0 > (d = goog.array.indexOf(a, c)) ? a.push(b) : goog.array.insertAt(a, b, d);
};
goog.array.remove = function(a, b) {
  var c = goog.array.indexOf(a, b), d;
  (d = 0 <= c) && goog.array.removeAt(a, c);
  return d;
};
goog.array.removeLast = function(a, b) {
  var c = goog.array.lastIndexOf(a, b);
  return 0 <= c ? (goog.array.removeAt(a, c), !0) : !1;
};
goog.array.removeAt = function(a, b) {
  goog.asserts.assert(null != a.length);
  return 1 == Array.prototype.splice.call(a, b, 1).length;
};
goog.array.removeIf = function(a, b, c) {
  b = goog.array.findIndex(a, b, c);
  return 0 <= b ? (goog.array.removeAt(a, b), !0) : !1;
};
goog.array.removeAllIf = function(a, b, c) {
  var d = 0;
  goog.array.forEachRight(a, function(e, f) {
    b.call(c, e, f, a) && goog.array.removeAt(a, f) && d++;
  });
  return d;
};
goog.array.concat = function(a) {
  return Array.prototype.concat.apply(Array.prototype, arguments);
};
goog.array.join = function(a) {
  return Array.prototype.concat.apply(Array.prototype, arguments);
};
goog.array.toArray = function(a) {
  var b = a.length;
  if (0 < b) {
    for (var c = Array(b), d = 0;d < b;d++) {
      c[d] = a[d];
    }
    return c;
  }
  return [];
};
goog.array.clone = goog.array.toArray;
goog.array.extend = function(a, b) {
  for (var c = 1;c < arguments.length;c++) {
    var d = arguments[c];
    if (goog.isArrayLike(d)) {
      var e = a.length || 0, f = d.length || 0;
      a.length = e + f;
      for (var g = 0;g < f;g++) {
        a[e + g] = d[g];
      }
    } else {
      a.push(d);
    }
  }
};
goog.array.splice = function(a, b, c, d) {
  goog.asserts.assert(null != a.length);
  return Array.prototype.splice.apply(a, goog.array.slice(arguments, 1));
};
goog.array.slice = function(a, b, c) {
  goog.asserts.assert(null != a.length);
  return 2 >= arguments.length ? Array.prototype.slice.call(a, b) : Array.prototype.slice.call(a, b, c);
};
goog.array.removeDuplicates = function(a, b, c) {
  b = b || a;
  var d = function(a) {
    return goog.isObject(a) ? "o" + goog.getUid(a) : (typeof a).charAt(0) + a;
  };
  c = c || d;
  for (var d = {}, e = 0, f = 0;f < a.length;) {
    var g = a[f++], h = c(g);
    Object.prototype.hasOwnProperty.call(d, h) || (d[h] = !0, b[e++] = g);
  }
  b.length = e;
};
goog.array.binarySearch = function(a, b, c) {
  return goog.array.binarySearch_(a, c || goog.array.defaultCompare, !1, b);
};
goog.array.binarySelect = function(a, b, c) {
  return goog.array.binarySearch_(a, b, !0, void 0, c);
};
goog.array.binarySearch_ = function(a, b, c, d, e) {
  for (var f = 0, g = a.length, h;f < g;) {
    var k = f + g >> 1, l;
    l = c ? b.call(e, a[k], k, a) : b(d, a[k]);
    0 < l ? f = k + 1 : (g = k, h = !l);
  }
  return h ? f : ~f;
};
goog.array.sort = function(a, b) {
  a.sort(b || goog.array.defaultCompare);
};
goog.array.stableSort = function(a, b) {
  for (var c = Array(a.length), d = 0;d < a.length;d++) {
    c[d] = {index:d, value:a[d]};
  }
  var e = b || goog.array.defaultCompare;
  goog.array.sort(c, function(a, b) {
    return e(a.value, b.value) || a.index - b.index;
  });
  for (d = 0;d < a.length;d++) {
    a[d] = c[d].value;
  }
};
goog.array.sortByKey = function(a, b, c) {
  var d = c || goog.array.defaultCompare;
  goog.array.sort(a, function(a, c) {
    return d(b(a), b(c));
  });
};
goog.array.sortObjectsByKey = function(a, b, c) {
  goog.array.sortByKey(a, function(a) {
    return a[b];
  }, c);
};
goog.array.isSorted = function(a, b, c) {
  b = b || goog.array.defaultCompare;
  for (var d = 1;d < a.length;d++) {
    var e = b(a[d - 1], a[d]);
    if (0 < e || 0 == e && c) {
      return !1;
    }
  }
  return !0;
};
goog.array.equals = function(a, b, c) {
  if (!goog.isArrayLike(a) || !goog.isArrayLike(b) || a.length != b.length) {
    return !1;
  }
  var d = a.length;
  c = c || goog.array.defaultCompareEquality;
  for (var e = 0;e < d;e++) {
    if (!c(a[e], b[e])) {
      return !1;
    }
  }
  return !0;
};
goog.array.compare3 = function(a, b, c) {
  c = c || goog.array.defaultCompare;
  for (var d = Math.min(a.length, b.length), e = 0;e < d;e++) {
    var f = c(a[e], b[e]);
    if (0 != f) {
      return f;
    }
  }
  return goog.array.defaultCompare(a.length, b.length);
};
goog.array.defaultCompare = function(a, b) {
  return a > b ? 1 : a < b ? -1 : 0;
};
goog.array.inverseDefaultCompare = function(a, b) {
  return -goog.array.defaultCompare(a, b);
};
goog.array.defaultCompareEquality = function(a, b) {
  return a === b;
};
goog.array.binaryInsert = function(a, b, c) {
  c = goog.array.binarySearch(a, b, c);
  return 0 > c ? (goog.array.insertAt(a, b, -(c + 1)), !0) : !1;
};
goog.array.binaryRemove = function(a, b, c) {
  b = goog.array.binarySearch(a, b, c);
  return 0 <= b ? goog.array.removeAt(a, b) : !1;
};
goog.array.bucket = function(a, b, c) {
  for (var d = {}, e = 0;e < a.length;e++) {
    var f = a[e], g = b.call(c, f, e, a);
    goog.isDef(g) && (d[g] || (d[g] = [])).push(f);
  }
  return d;
};
goog.array.toObject = function(a, b, c) {
  var d = {};
  goog.array.forEach(a, function(e, f) {
    d[b.call(c, e, f, a)] = e;
  });
  return d;
};
goog.array.range = function(a, b, c) {
  var d = [], e = 0, f = a;
  c = c || 1;
  void 0 !== b && (e = a, f = b);
  if (0 > c * (f - e)) {
    return [];
  }
  if (0 < c) {
    for (a = e;a < f;a += c) {
      d.push(a);
    }
  } else {
    for (a = e;a > f;a += c) {
      d.push(a);
    }
  }
  return d;
};
goog.array.repeat = function(a, b) {
  for (var c = [], d = 0;d < b;d++) {
    c[d] = a;
  }
  return c;
};
goog.array.flatten = function(a) {
  for (var b = [], c = 0;c < arguments.length;c++) {
    var d = arguments[c];
    if (goog.isArray(d)) {
      for (var e = 0;e < d.length;e += 8192) {
        for (var f = goog.array.slice(d, e, e + 8192), f = goog.array.flatten.apply(null, f), g = 0;g < f.length;g++) {
          b.push(f[g]);
        }
      }
    } else {
      b.push(d);
    }
  }
  return b;
};
goog.array.rotate = function(a, b) {
  goog.asserts.assert(null != a.length);
  a.length && (b %= a.length, 0 < b ? Array.prototype.unshift.apply(a, a.splice(-b, b)) : 0 > b && Array.prototype.push.apply(a, a.splice(0, -b)));
  return a;
};
goog.array.moveItem = function(a, b, c) {
  goog.asserts.assert(0 <= b && b < a.length);
  goog.asserts.assert(0 <= c && c < a.length);
  b = Array.prototype.splice.call(a, b, 1);
  Array.prototype.splice.call(a, c, 0, b[0]);
};
goog.array.zip = function(a) {
  if (!arguments.length) {
    return [];
  }
  for (var b = [], c = arguments[0].length, d = 1;d < arguments.length;d++) {
    arguments[d].length < c && (c = arguments[d].length);
  }
  for (d = 0;d < c;d++) {
    for (var e = [], f = 0;f < arguments.length;f++) {
      e.push(arguments[f][d]);
    }
    b.push(e);
  }
  return b;
};
goog.array.shuffle = function(a, b) {
  for (var c = b || Math.random, d = a.length - 1;0 < d;d--) {
    var e = Math.floor(c() * (d + 1)), f = a[d];
    a[d] = a[e];
    a[e] = f;
  }
};
goog.array.copyByIndex = function(a, b) {
  var c = [];
  goog.array.forEach(b, function(b) {
    c.push(a[b]);
  });
  return c;
};
goog.array.concatMap = function(a, b, c) {
  return goog.array.concat.apply([], goog.array.map(a, b, c));
};
goog.proto2 = {};
goog.proto2.FieldDescriptor = function(a, b, c) {
  this.parent_ = a;
  goog.asserts.assert(goog.string.isNumeric(b));
  this.tag_ = b;
  this.name_ = c.name;
  this.isPacked_ = !!c.packed;
  this.isRepeated_ = !!c.repeated;
  this.isRequired_ = !!c.required;
  this.fieldType_ = c.fieldType;
  this.nativeType_ = c.type;
  this.deserializationConversionPermitted_ = !1;
  switch(this.fieldType_) {
    case goog.proto2.FieldDescriptor.FieldType.INT64:
    ;
    case goog.proto2.FieldDescriptor.FieldType.UINT64:
    ;
    case goog.proto2.FieldDescriptor.FieldType.FIXED64:
    ;
    case goog.proto2.FieldDescriptor.FieldType.SFIXED64:
    ;
    case goog.proto2.FieldDescriptor.FieldType.SINT64:
    ;
    case goog.proto2.FieldDescriptor.FieldType.FLOAT:
    ;
    case goog.proto2.FieldDescriptor.FieldType.DOUBLE:
      this.deserializationConversionPermitted_ = !0;
  }
  this.defaultValue_ = c.defaultValue;
};
goog.proto2.FieldDescriptor.FieldType = {DOUBLE:1, FLOAT:2, INT64:3, UINT64:4, INT32:5, FIXED64:6, FIXED32:7, BOOL:8, STRING:9, GROUP:10, MESSAGE:11, BYTES:12, UINT32:13, ENUM:14, SFIXED32:15, SFIXED64:16, SINT32:17, SINT64:18};
goog.proto2.FieldDescriptor.prototype.getTag = function() {
  return this.tag_;
};
goog.proto2.FieldDescriptor.prototype.getContainingType = function() {
  return this.parent_.prototype.getDescriptor();
};
goog.proto2.FieldDescriptor.prototype.getName = function() {
  return this.name_;
};
goog.proto2.FieldDescriptor.prototype.getDefaultValue = function() {
  if (void 0 === this.defaultValue_) {
    var a = this.nativeType_;
    if (a === Boolean) {
      this.defaultValue_ = !1;
    } else {
      if (a === Number) {
        this.defaultValue_ = 0;
      } else {
        if (a === String) {
          this.defaultValue_ = this.deserializationConversionPermitted_ ? "0" : "";
        } else {
          return new a;
        }
      }
    }
  }
  return this.defaultValue_;
};
goog.proto2.FieldDescriptor.prototype.getFieldType = function() {
  return this.fieldType_;
};
goog.proto2.FieldDescriptor.prototype.getNativeType = function() {
  return this.nativeType_;
};
goog.proto2.FieldDescriptor.prototype.deserializationConversionPermitted = function() {
  return this.deserializationConversionPermitted_;
};
goog.proto2.FieldDescriptor.prototype.getFieldMessageType = function() {
  return this.nativeType_.prototype.getDescriptor();
};
goog.proto2.FieldDescriptor.prototype.isCompositeType = function() {
  return this.fieldType_ == goog.proto2.FieldDescriptor.FieldType.MESSAGE || this.fieldType_ == goog.proto2.FieldDescriptor.FieldType.GROUP;
};
goog.proto2.FieldDescriptor.prototype.isPacked = function() {
  return this.isPacked_;
};
goog.proto2.FieldDescriptor.prototype.isRepeated = function() {
  return this.isRepeated_;
};
goog.proto2.FieldDescriptor.prototype.isRequired = function() {
  return this.isRequired_;
};
goog.proto2.FieldDescriptor.prototype.isOptional = function() {
  return !this.isRepeated_ && !this.isRequired_;
};
goog.object = {};
goog.object.is = function(a, b) {
  return a === b ? 0 !== a || 1 / a === 1 / b : a !== a && b !== b;
};
goog.object.forEach = function(a, b, c) {
  for (var d in a) {
    b.call(c, a[d], d, a);
  }
};
goog.object.filter = function(a, b, c) {
  var d = {}, e;
  for (e in a) {
    b.call(c, a[e], e, a) && (d[e] = a[e]);
  }
  return d;
};
goog.object.map = function(a, b, c) {
  var d = {}, e;
  for (e in a) {
    d[e] = b.call(c, a[e], e, a);
  }
  return d;
};
goog.object.some = function(a, b, c) {
  for (var d in a) {
    if (b.call(c, a[d], d, a)) {
      return !0;
    }
  }
  return !1;
};
goog.object.every = function(a, b, c) {
  for (var d in a) {
    if (!b.call(c, a[d], d, a)) {
      return !1;
    }
  }
  return !0;
};
goog.object.getCount = function(a) {
  var b = 0, c;
  for (c in a) {
    b++;
  }
  return b;
};
goog.object.getAnyKey = function(a) {
  for (var b in a) {
    return b;
  }
};
goog.object.getAnyValue = function(a) {
  for (var b in a) {
    return a[b];
  }
};
goog.object.contains = function(a, b) {
  return goog.object.containsValue(a, b);
};
goog.object.getValues = function(a) {
  var b = [], c = 0, d;
  for (d in a) {
    b[c++] = a[d];
  }
  return b;
};
goog.object.getKeys = function(a) {
  var b = [], c = 0, d;
  for (d in a) {
    b[c++] = d;
  }
  return b;
};
goog.object.getValueByKeys = function(a, b) {
  for (var c = goog.isArrayLike(b), d = c ? b : arguments, c = c ? 0 : 1;c < d.length && (a = a[d[c]], goog.isDef(a));c++) {
  }
  return a;
};
goog.object.containsKey = function(a, b) {
  return null !== a && b in a;
};
goog.object.containsValue = function(a, b) {
  for (var c in a) {
    if (a[c] == b) {
      return !0;
    }
  }
  return !1;
};
goog.object.findKey = function(a, b, c) {
  for (var d in a) {
    if (b.call(c, a[d], d, a)) {
      return d;
    }
  }
};
goog.object.findValue = function(a, b, c) {
  return (b = goog.object.findKey(a, b, c)) && a[b];
};
goog.object.isEmpty = function(a) {
  for (var b in a) {
    return !1;
  }
  return !0;
};
goog.object.clear = function(a) {
  for (var b in a) {
    delete a[b];
  }
};
goog.object.remove = function(a, b) {
  var c;
  (c = b in a) && delete a[b];
  return c;
};
goog.object.add = function(a, b, c) {
  if (null !== a && b in a) {
    throw Error('The object already contains the key "' + b + '"');
  }
  goog.object.set(a, b, c);
};
goog.object.get = function(a, b, c) {
  return null !== a && b in a ? a[b] : c;
};
goog.object.set = function(a, b, c) {
  a[b] = c;
};
goog.object.setIfUndefined = function(a, b, c) {
  return b in a ? a[b] : a[b] = c;
};
goog.object.setWithReturnValueIfNotSet = function(a, b, c) {
  if (b in a) {
    return a[b];
  }
  c = c();
  return a[b] = c;
};
goog.object.equals = function(a, b) {
  for (var c in a) {
    if (!(c in b) || a[c] !== b[c]) {
      return !1;
    }
  }
  for (c in b) {
    if (!(c in a)) {
      return !1;
    }
  }
  return !0;
};
goog.object.clone = function(a) {
  var b = {}, c;
  for (c in a) {
    b[c] = a[c];
  }
  return b;
};
goog.object.unsafeClone = function(a) {
  var b = goog.typeOf(a);
  if ("object" == b || "array" == b) {
    if (goog.isFunction(a.clone)) {
      return a.clone();
    }
    var b = "array" == b ? [] : {}, c;
    for (c in a) {
      b[c] = goog.object.unsafeClone(a[c]);
    }
    return b;
  }
  return a;
};
goog.object.transpose = function(a) {
  var b = {}, c;
  for (c in a) {
    b[a[c]] = c;
  }
  return b;
};
goog.object.PROTOTYPE_FIELDS_ = "constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.object.extend = function(a, b) {
  for (var c, d, e = 1;e < arguments.length;e++) {
    d = arguments[e];
    for (c in d) {
      a[c] = d[c];
    }
    for (var f = 0;f < goog.object.PROTOTYPE_FIELDS_.length;f++) {
      c = goog.object.PROTOTYPE_FIELDS_[f], Object.prototype.hasOwnProperty.call(d, c) && (a[c] = d[c]);
    }
  }
};
goog.object.create = function(a) {
  var b = arguments.length;
  if (1 == b && goog.isArray(arguments[0])) {
    return goog.object.create.apply(null, arguments[0]);
  }
  if (b % 2) {
    throw Error("Uneven number of arguments");
  }
  for (var c = {}, d = 0;d < b;d += 2) {
    c[arguments[d]] = arguments[d + 1];
  }
  return c;
};
goog.object.createSet = function(a) {
  var b = arguments.length;
  if (1 == b && goog.isArray(arguments[0])) {
    return goog.object.createSet.apply(null, arguments[0]);
  }
  for (var c = {}, d = 0;d < b;d++) {
    c[arguments[d]] = !0;
  }
  return c;
};
goog.object.createImmutableView = function(a) {
  var b = a;
  Object.isFrozen && !Object.isFrozen(a) && (b = Object.create(a), Object.freeze(b));
  return b;
};
goog.object.isImmutableView = function(a) {
  return !!Object.isFrozen && Object.isFrozen(a);
};
goog.proto2.Descriptor = function(a, b, c) {
  this.messageType_ = a;
  this.name_ = b.name || null;
  this.fullName_ = b.fullName || null;
  this.containingType_ = b.containingType;
  this.fields_ = {};
  for (a = 0;a < c.length;a++) {
    b = c[a], this.fields_[b.getTag()] = b;
  }
};
goog.proto2.Descriptor.prototype.getName = function() {
  return this.name_;
};
goog.proto2.Descriptor.prototype.getFullName = function() {
  return this.fullName_;
};
goog.proto2.Descriptor.prototype.getContainingType = function() {
  return this.containingType_ ? this.containingType_.getDescriptor() : null;
};
goog.proto2.Descriptor.prototype.getFields = function() {
  var a = goog.object.getValues(this.fields_);
  goog.array.sort(a, function(a, c) {
    return a.getTag() - c.getTag();
  });
  return a;
};
goog.proto2.Descriptor.prototype.getFieldsMap = function() {
  return this.fields_;
};
goog.proto2.Descriptor.prototype.findFieldByName = function(a) {
  return goog.object.findValue(this.fields_, function(b, c, d) {
    return b.getName() == a;
  }) || null;
};
goog.proto2.Descriptor.prototype.findFieldByTag = function(a) {
  goog.asserts.assert(goog.string.isNumeric(a));
  return this.fields_[parseInt(a, 10)] || null;
};
goog.proto2.Descriptor.prototype.createMessageInstance = function() {
  return new this.messageType_;
};
goog.proto2.Message = function() {
  this.values_ = {};
  this.fields_ = this.getDescriptor().getFieldsMap();
  this.deserializedFields_ = this.lazyDeserializer_ = null;
};
goog.proto2.Message.FieldType = {DOUBLE:1, FLOAT:2, INT64:3, UINT64:4, INT32:5, FIXED64:6, FIXED32:7, BOOL:8, STRING:9, GROUP:10, MESSAGE:11, BYTES:12, UINT32:13, ENUM:14, SFIXED32:15, SFIXED64:16, SINT32:17, SINT64:18};
goog.proto2.Message.prototype.initializeForLazyDeserializer = function(a, b) {
  this.lazyDeserializer_ = a;
  this.values_ = b;
  this.deserializedFields_ = {};
};
goog.proto2.Message.prototype.setUnknown = function(a, b) {
  goog.asserts.assert(!this.fields_[a], "Field is not unknown in this message");
  goog.asserts.assert(1 <= a, "Tag " + a + ' has value "' + b + '" in descriptor ' + this.getDescriptor().getName());
  goog.asserts.assert(null !== b, "Value cannot be null");
  this.values_[a] = b;
  this.deserializedFields_ && delete this.deserializedFields_[a];
};
goog.proto2.Message.prototype.forEachUnknown = function(a, b) {
  var c = b || this, d;
  for (d in this.values_) {
    var e = Number(d);
    this.fields_[e] || a.call(c, e, this.values_[d]);
  }
};
goog.proto2.Message.prototype.has = function(a) {
  goog.asserts.assert(a.getContainingType() == this.getDescriptor(), "The current message does not contain the given field");
  return this.has$Value(a.getTag());
};
goog.proto2.Message.prototype.arrayOf = function(a) {
  goog.asserts.assert(a.getContainingType() == this.getDescriptor(), "The current message does not contain the given field");
  return this.array$Values(a.getTag());
};
goog.proto2.Message.prototype.countOf = function(a) {
  goog.asserts.assert(a.getContainingType() == this.getDescriptor(), "The current message does not contain the given field");
  return this.count$Values(a.getTag());
};
goog.proto2.Message.prototype.get = function(a, b) {
  goog.asserts.assert(a.getContainingType() == this.getDescriptor(), "The current message does not contain the given field");
  return this.get$Value(a.getTag(), b);
};
goog.proto2.Message.prototype.getOrDefault = function(a, b) {
  goog.asserts.assert(a.getContainingType() == this.getDescriptor(), "The current message does not contain the given field");
  return this.get$ValueOrDefault(a.getTag(), b);
};
goog.proto2.Message.prototype.set = function(a, b) {
  goog.asserts.assert(a.getContainingType() == this.getDescriptor(), "The current message does not contain the given field");
  this.set$Value(a.getTag(), b);
};
goog.proto2.Message.prototype.add = function(a, b) {
  goog.asserts.assert(a.getContainingType() == this.getDescriptor(), "The current message does not contain the given field");
  this.add$Value(a.getTag(), b);
};
goog.proto2.Message.prototype.clear = function(a) {
  goog.asserts.assert(a.getContainingType() == this.getDescriptor(), "The current message does not contain the given field");
  this.clear$Field(a.getTag());
};
goog.proto2.Message.prototype.equals = function(a) {
  if (!a || this.constructor != a.constructor) {
    return !1;
  }
  for (var b = this.getDescriptor().getFields(), c = 0;c < b.length;c++) {
    var d = b[c], e = d.getTag();
    if (this.has$Value(e) != a.has$Value(e)) {
      return !1;
    }
    if (this.has$Value(e)) {
      var f = d.isCompositeType(), g = this.getValueForTag_(e), e = a.getValueForTag_(e);
      if (d.isRepeated()) {
        if (g.length != e.length) {
          return !1;
        }
        for (d = 0;d < g.length;d++) {
          var h = g[d], k = e[d];
          if (f ? !h.equals(k) : h != k) {
            return !1;
          }
        }
      } else {
        if (f ? !g.equals(e) : g != e) {
          return !1;
        }
      }
    }
  }
  return !0;
};
goog.proto2.Message.prototype.copyFrom = function(a) {
  goog.asserts.assert(this.constructor == a.constructor, "The source message must have the same type.");
  this != a && (this.values_ = {}, this.deserializedFields_ && (this.deserializedFields_ = {}), this.mergeFrom(a));
};
goog.proto2.Message.prototype.mergeFrom = function(a) {
  goog.asserts.assert(this.constructor == a.constructor, "The source message must have the same type.");
  for (var b = this.getDescriptor().getFields(), c = 0;c < b.length;c++) {
    var d = b[c], e = d.getTag();
    if (a.has$Value(e)) {
      this.deserializedFields_ && delete this.deserializedFields_[d.getTag()];
      var f = d.isCompositeType();
      if (d.isRepeated()) {
        for (var d = a.array$Values(e), g = 0;g < d.length;g++) {
          this.add$Value(e, f ? d[g].clone() : d[g]);
        }
      } else {
        d = a.getValueForTag_(e), f ? (f = this.getValueForTag_(e)) ? f.mergeFrom(d) : this.set$Value(e, d.clone()) : this.set$Value(e, d);
      }
    }
  }
};
goog.proto2.Message.prototype.clone = function() {
  var a = new this.constructor;
  a.copyFrom(this);
  return a;
};
goog.proto2.Message.prototype.initDefaults = function(a) {
  for (var b = this.getDescriptor().getFields(), c = 0;c < b.length;c++) {
    var d = b[c], e = d.getTag(), f = d.isCompositeType();
    this.has$Value(e) || d.isRepeated() || (f ? this.values_[e] = new (d.getNativeType()) : a && (this.values_[e] = d.getDefaultValue()));
    if (f) {
      if (d.isRepeated()) {
        for (d = this.array$Values(e), e = 0;e < d.length;e++) {
          d[e].initDefaults(a);
        }
      } else {
        this.get$Value(e).initDefaults(a);
      }
    }
  }
};
goog.proto2.Message.prototype.has$Value = function(a) {
  return null != this.values_[a];
};
goog.proto2.Message.prototype.getValueForTag_ = function(a) {
  var b = this.values_[a];
  return goog.isDefAndNotNull(b) ? this.lazyDeserializer_ ? a in this.deserializedFields_ ? this.deserializedFields_[a] : (b = this.lazyDeserializer_.deserializeField(this, this.fields_[a], b), this.deserializedFields_[a] = b) : b : null;
};
goog.proto2.Message.prototype.get$Value = function(a, b) {
  var c = this.getValueForTag_(a);
  if (this.fields_[a].isRepeated()) {
    var d = b || 0;
    goog.asserts.assert(0 <= d && d < c.length, "Given index %s is out of bounds.  Repeated field length: %s", d, c.length);
    return c[d];
  }
  return c;
};
goog.proto2.Message.prototype.get$ValueOrDefault = function(a, b) {
  return this.has$Value(a) ? this.get$Value(a, b) : this.fields_[a].getDefaultValue();
};
goog.proto2.Message.prototype.array$Values = function(a) {
  return this.getValueForTag_(a) || [];
};
goog.proto2.Message.prototype.count$Values = function(a) {
  return this.fields_[a].isRepeated() ? this.has$Value(a) ? this.values_[a].length : 0 : this.has$Value(a) ? 1 : 0;
};
goog.proto2.Message.prototype.set$Value = function(a, b) {
  goog.asserts.ENABLE_ASSERTS && this.checkFieldType_(this.fields_[a], b);
  this.values_[a] = b;
  this.deserializedFields_ && (this.deserializedFields_[a] = b);
};
goog.proto2.Message.prototype.add$Value = function(a, b) {
  goog.asserts.ENABLE_ASSERTS && this.checkFieldType_(this.fields_[a], b);
  this.values_[a] || (this.values_[a] = []);
  this.values_[a].push(b);
  this.deserializedFields_ && delete this.deserializedFields_[a];
};
goog.proto2.Message.prototype.checkFieldType_ = function(a, b) {
  a.getFieldType() == goog.proto2.FieldDescriptor.FieldType.ENUM ? goog.asserts.assertNumber(b) : goog.asserts.assert(Object(b).constructor == a.getNativeType());
};
goog.proto2.Message.prototype.clear$Field = function(a) {
  delete this.values_[a];
  this.deserializedFields_ && delete this.deserializedFields_[a];
};
goog.proto2.Message.createDescriptor = function(a, b) {
  var c = [], d = b[0], e;
  for (e in b) {
    0 != e && c.push(new goog.proto2.FieldDescriptor(a, e, b[e]));
  }
  return new goog.proto2.Descriptor(a, d, c);
};
goog.proto2.Serializer = function() {
};
goog.proto2.Serializer.DECODE_SYMBOLIC_ENUMS = !1;
goog.proto2.Serializer.prototype.getSerializedValue = function(a, b) {
  return a.isCompositeType() ? this.serialize(b) : goog.isNumber(b) && !isFinite(b) ? b.toString() : b;
};
goog.proto2.Serializer.prototype.deserialize = function(a, b) {
  var c = a.createMessageInstance();
  this.deserializeTo(c, b);
  goog.asserts.assert(c instanceof goog.proto2.Message);
  return c;
};
goog.proto2.Serializer.prototype.getDeserializedValue = function(a, b) {
  if (a.isCompositeType()) {
    return b instanceof goog.proto2.Message ? b : this.deserialize(a.getFieldMessageType(), b);
  }
  if (a.getFieldType() == goog.proto2.FieldDescriptor.FieldType.ENUM) {
    if (goog.proto2.Serializer.DECODE_SYMBOLIC_ENUMS && goog.isString(b)) {
      var c = a.getNativeType();
      if (c.hasOwnProperty(b)) {
        return c[b];
      }
    }
    return goog.isString(b) && goog.proto2.Serializer.INTEGER_REGEX.test(b) && (c = Number(b), 0 < c) ? c : b;
  }
  if (!a.deserializationConversionPermitted()) {
    return b;
  }
  c = a.getNativeType();
  if (c === String) {
    if (goog.isNumber(b)) {
      return String(b);
    }
  } else {
    if (c === Number && goog.isString(b) && ("Infinity" === b || "-Infinity" === b || "NaN" === b || goog.proto2.Serializer.INTEGER_REGEX.test(b))) {
      return Number(b);
    }
  }
  return b;
};
goog.proto2.Serializer.INTEGER_REGEX = /^-?[0-9]+$/;
goog.proto2.LazyDeserializer = function() {
};
goog.inherits(goog.proto2.LazyDeserializer, goog.proto2.Serializer);
goog.proto2.LazyDeserializer.prototype.deserialize = function(a, b) {
  var c = a.createMessageInstance();
  c.initializeForLazyDeserializer(this, b);
  goog.asserts.assert(c instanceof goog.proto2.Message);
  return c;
};
goog.proto2.LazyDeserializer.prototype.deserializeTo = function(a, b) {
  throw Error("Unimplemented");
};
goog.proto2.PbLiteSerializer = function() {
};
goog.inherits(goog.proto2.PbLiteSerializer, goog.proto2.LazyDeserializer);
goog.proto2.PbLiteSerializer.prototype.zeroIndexing_ = !1;
goog.proto2.PbLiteSerializer.prototype.setZeroIndexed = function(a) {
  this.zeroIndexing_ = a;
};
goog.proto2.PbLiteSerializer.prototype.serialize = function(a) {
  for (var b = a.getDescriptor().getFields(), c = [], d = this.zeroIndexing_, e = 0;e < b.length;e++) {
    var f = b[e];
    if (a.has(f)) {
      var g = f.getTag(), g = d ? g - 1 : g;
      if (f.isRepeated()) {
        c[g] = [];
        for (var h = 0;h < a.countOf(f);h++) {
          c[g][h] = this.getSerializedValue(f, a.get(f, h));
        }
      } else {
        c[g] = this.getSerializedValue(f, a.get(f));
      }
    }
  }
  a.forEachUnknown(function(a, b) {
    c[d ? a - 1 : a] = b;
  });
  return c;
};
goog.proto2.PbLiteSerializer.prototype.deserializeField = function(a, b, c) {
  if (null == c) {
    return c;
  }
  if (b.isRepeated()) {
    a = [];
    goog.asserts.assert(goog.isArray(c), "Value must be array: %s", c);
    for (var d = 0;d < c.length;d++) {
      a[d] = this.getDeserializedValue(b, c[d]);
    }
    return a;
  }
  return this.getDeserializedValue(b, c);
};
goog.proto2.PbLiteSerializer.prototype.getSerializedValue = function(a, b) {
  return a.getFieldType() == goog.proto2.FieldDescriptor.FieldType.BOOL ? b ? 1 : 0 : goog.proto2.Serializer.prototype.getSerializedValue.apply(this, arguments);
};
goog.proto2.PbLiteSerializer.prototype.getDeserializedValue = function(a, b) {
  return a.getFieldType() == goog.proto2.FieldDescriptor.FieldType.BOOL ? (goog.asserts.assert(goog.isNumber(b) || goog.isBoolean(b), "Value is expected to be a number or boolean"), !!b) : goog.proto2.Serializer.prototype.getDeserializedValue.apply(this, arguments);
};
goog.proto2.PbLiteSerializer.prototype.deserialize = function(a, b) {
  var c = b;
  if (this.zeroIndexing_) {
    var c = [], d;
    for (d in b) {
      c[parseInt(d, 10) + 1] = b[d];
    }
  }
  return goog.proto2.PbLiteSerializer.superClass_.deserialize.call(this, a, c);
};
/*

 Protocol Buffer 2 Copyright 2008 Google Inc.
 All other code copyright its respective owners.
 Copyright (C) 2010 The Libphonenumber Authors

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
var i18n = {phonenumbers:{}};
i18n.phonenumbers.NumberFormat = function() {
  goog.proto2.Message.call(this);
};
goog.inherits(i18n.phonenumbers.NumberFormat, goog.proto2.Message);
i18n.phonenumbers.NumberFormat.prototype.getPattern = function() {
  return this.get$Value(1);
};
i18n.phonenumbers.NumberFormat.prototype.getPatternOrDefault = function() {
  return this.get$ValueOrDefault(1);
};
i18n.phonenumbers.NumberFormat.prototype.setPattern = function(a) {
  this.set$Value(1, a);
};
i18n.phonenumbers.NumberFormat.prototype.hasPattern = function() {
  return this.has$Value(1);
};
i18n.phonenumbers.NumberFormat.prototype.patternCount = function() {
  return this.count$Values(1);
};
i18n.phonenumbers.NumberFormat.prototype.clearPattern = function() {
  this.clear$Field(1);
};
i18n.phonenumbers.NumberFormat.prototype.getFormat = function() {
  return this.get$Value(2);
};
i18n.phonenumbers.NumberFormat.prototype.getFormatOrDefault = function() {
  return this.get$ValueOrDefault(2);
};
i18n.phonenumbers.NumberFormat.prototype.setFormat = function(a) {
  this.set$Value(2, a);
};
i18n.phonenumbers.NumberFormat.prototype.hasFormat = function() {
  return this.has$Value(2);
};
i18n.phonenumbers.NumberFormat.prototype.formatCount = function() {
  return this.count$Values(2);
};
i18n.phonenumbers.NumberFormat.prototype.clearFormat = function() {
  this.clear$Field(2);
};
i18n.phonenumbers.NumberFormat.prototype.getLeadingDigitsPattern = function(a) {
  return this.get$Value(3, a);
};
i18n.phonenumbers.NumberFormat.prototype.getLeadingDigitsPatternOrDefault = function(a) {
  return this.get$ValueOrDefault(3, a);
};
i18n.phonenumbers.NumberFormat.prototype.addLeadingDigitsPattern = function(a) {
  this.add$Value(3, a);
};
i18n.phonenumbers.NumberFormat.prototype.leadingDigitsPatternArray = function() {
  return this.array$Values(3);
};
i18n.phonenumbers.NumberFormat.prototype.hasLeadingDigitsPattern = function() {
  return this.has$Value(3);
};
i18n.phonenumbers.NumberFormat.prototype.leadingDigitsPatternCount = function() {
  return this.count$Values(3);
};
i18n.phonenumbers.NumberFormat.prototype.clearLeadingDigitsPattern = function() {
  this.clear$Field(3);
};
i18n.phonenumbers.NumberFormat.prototype.getNationalPrefixFormattingRule = function() {
  return this.get$Value(4);
};
i18n.phonenumbers.NumberFormat.prototype.getNationalPrefixFormattingRuleOrDefault = function() {
  return this.get$ValueOrDefault(4);
};
i18n.phonenumbers.NumberFormat.prototype.setNationalPrefixFormattingRule = function(a) {
  this.set$Value(4, a);
};
i18n.phonenumbers.NumberFormat.prototype.hasNationalPrefixFormattingRule = function() {
  return this.has$Value(4);
};
i18n.phonenumbers.NumberFormat.prototype.nationalPrefixFormattingRuleCount = function() {
  return this.count$Values(4);
};
i18n.phonenumbers.NumberFormat.prototype.clearNationalPrefixFormattingRule = function() {
  this.clear$Field(4);
};
i18n.phonenumbers.NumberFormat.prototype.getNationalPrefixOptionalWhenFormatting = function() {
  return this.get$Value(6);
};
i18n.phonenumbers.NumberFormat.prototype.getNationalPrefixOptionalWhenFormattingOrDefault = function() {
  return this.get$ValueOrDefault(6);
};
i18n.phonenumbers.NumberFormat.prototype.setNationalPrefixOptionalWhenFormatting = function(a) {
  this.set$Value(6, a);
};
i18n.phonenumbers.NumberFormat.prototype.hasNationalPrefixOptionalWhenFormatting = function() {
  return this.has$Value(6);
};
i18n.phonenumbers.NumberFormat.prototype.nationalPrefixOptionalWhenFormattingCount = function() {
  return this.count$Values(6);
};
i18n.phonenumbers.NumberFormat.prototype.clearNationalPrefixOptionalWhenFormatting = function() {
  this.clear$Field(6);
};
i18n.phonenumbers.NumberFormat.prototype.getDomesticCarrierCodeFormattingRule = function() {
  return this.get$Value(5);
};
i18n.phonenumbers.NumberFormat.prototype.getDomesticCarrierCodeFormattingRuleOrDefault = function() {
  return this.get$ValueOrDefault(5);
};
i18n.phonenumbers.NumberFormat.prototype.setDomesticCarrierCodeFormattingRule = function(a) {
  this.set$Value(5, a);
};
i18n.phonenumbers.NumberFormat.prototype.hasDomesticCarrierCodeFormattingRule = function() {
  return this.has$Value(5);
};
i18n.phonenumbers.NumberFormat.prototype.domesticCarrierCodeFormattingRuleCount = function() {
  return this.count$Values(5);
};
i18n.phonenumbers.NumberFormat.prototype.clearDomesticCarrierCodeFormattingRule = function() {
  this.clear$Field(5);
};
i18n.phonenumbers.PhoneNumberDesc = function() {
  goog.proto2.Message.call(this);
};
goog.inherits(i18n.phonenumbers.PhoneNumberDesc, goog.proto2.Message);
i18n.phonenumbers.PhoneNumberDesc.prototype.getNationalNumberPattern = function() {
  return this.get$Value(2);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.getNationalNumberPatternOrDefault = function() {
  return this.get$ValueOrDefault(2);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.setNationalNumberPattern = function(a) {
  this.set$Value(2, a);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.hasNationalNumberPattern = function() {
  return this.has$Value(2);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.nationalNumberPatternCount = function() {
  return this.count$Values(2);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.clearNationalNumberPattern = function() {
  this.clear$Field(2);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.getPossibleNumberPattern = function() {
  return this.get$Value(3);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.getPossibleNumberPatternOrDefault = function() {
  return this.get$ValueOrDefault(3);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.setPossibleNumberPattern = function(a) {
  this.set$Value(3, a);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.hasPossibleNumberPattern = function() {
  return this.has$Value(3);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.possibleNumberPatternCount = function() {
  return this.count$Values(3);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.clearPossibleNumberPattern = function() {
  this.clear$Field(3);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.getExampleNumber = function() {
  return this.get$Value(6);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.getExampleNumberOrDefault = function() {
  return this.get$ValueOrDefault(6);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.setExampleNumber = function(a) {
  this.set$Value(6, a);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.hasExampleNumber = function() {
  return this.has$Value(6);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.exampleNumberCount = function() {
  return this.count$Values(6);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.clearExampleNumber = function() {
  this.clear$Field(6);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.getNationalNumberMatcherData = function() {
  return this.get$Value(7);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.getNationalNumberMatcherDataOrDefault = function() {
  return this.get$ValueOrDefault(7);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.setNationalNumberMatcherData = function(a) {
  this.set$Value(7, a);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.hasNationalNumberMatcherData = function() {
  return this.has$Value(7);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.nationalNumberMatcherDataCount = function() {
  return this.count$Values(7);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.clearNationalNumberMatcherData = function() {
  this.clear$Field(7);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.getPossibleNumberMatcherData = function() {
  return this.get$Value(8);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.getPossibleNumberMatcherDataOrDefault = function() {
  return this.get$ValueOrDefault(8);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.setPossibleNumberMatcherData = function(a) {
  this.set$Value(8, a);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.hasPossibleNumberMatcherData = function() {
  return this.has$Value(8);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.possibleNumberMatcherDataCount = function() {
  return this.count$Values(8);
};
i18n.phonenumbers.PhoneNumberDesc.prototype.clearPossibleNumberMatcherData = function() {
  this.clear$Field(8);
};
i18n.phonenumbers.PhoneMetadata = function() {
  goog.proto2.Message.call(this);
};
goog.inherits(i18n.phonenumbers.PhoneMetadata, goog.proto2.Message);
i18n.phonenumbers.PhoneMetadata.prototype.getGeneralDesc = function() {
  return this.get$Value(1);
};
i18n.phonenumbers.PhoneMetadata.prototype.getGeneralDescOrDefault = function() {
  return this.get$ValueOrDefault(1);
};
i18n.phonenumbers.PhoneMetadata.prototype.setGeneralDesc = function(a) {
  this.set$Value(1, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasGeneralDesc = function() {
  return this.has$Value(1);
};
i18n.phonenumbers.PhoneMetadata.prototype.generalDescCount = function() {
  return this.count$Values(1);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearGeneralDesc = function() {
  this.clear$Field(1);
};
i18n.phonenumbers.PhoneMetadata.prototype.getFixedLine = function() {
  return this.get$Value(2);
};
i18n.phonenumbers.PhoneMetadata.prototype.getFixedLineOrDefault = function() {
  return this.get$ValueOrDefault(2);
};
i18n.phonenumbers.PhoneMetadata.prototype.setFixedLine = function(a) {
  this.set$Value(2, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasFixedLine = function() {
  return this.has$Value(2);
};
i18n.phonenumbers.PhoneMetadata.prototype.fixedLineCount = function() {
  return this.count$Values(2);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearFixedLine = function() {
  this.clear$Field(2);
};
i18n.phonenumbers.PhoneMetadata.prototype.getMobile = function() {
  return this.get$Value(3);
};
i18n.phonenumbers.PhoneMetadata.prototype.getMobileOrDefault = function() {
  return this.get$ValueOrDefault(3);
};
i18n.phonenumbers.PhoneMetadata.prototype.setMobile = function(a) {
  this.set$Value(3, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasMobile = function() {
  return this.has$Value(3);
};
i18n.phonenumbers.PhoneMetadata.prototype.mobileCount = function() {
  return this.count$Values(3);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearMobile = function() {
  this.clear$Field(3);
};
i18n.phonenumbers.PhoneMetadata.prototype.getTollFree = function() {
  return this.get$Value(4);
};
i18n.phonenumbers.PhoneMetadata.prototype.getTollFreeOrDefault = function() {
  return this.get$ValueOrDefault(4);
};
i18n.phonenumbers.PhoneMetadata.prototype.setTollFree = function(a) {
  this.set$Value(4, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasTollFree = function() {
  return this.has$Value(4);
};
i18n.phonenumbers.PhoneMetadata.prototype.tollFreeCount = function() {
  return this.count$Values(4);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearTollFree = function() {
  this.clear$Field(4);
};
i18n.phonenumbers.PhoneMetadata.prototype.getPremiumRate = function() {
  return this.get$Value(5);
};
i18n.phonenumbers.PhoneMetadata.prototype.getPremiumRateOrDefault = function() {
  return this.get$ValueOrDefault(5);
};
i18n.phonenumbers.PhoneMetadata.prototype.setPremiumRate = function(a) {
  this.set$Value(5, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasPremiumRate = function() {
  return this.has$Value(5);
};
i18n.phonenumbers.PhoneMetadata.prototype.premiumRateCount = function() {
  return this.count$Values(5);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearPremiumRate = function() {
  this.clear$Field(5);
};
i18n.phonenumbers.PhoneMetadata.prototype.getSharedCost = function() {
  return this.get$Value(6);
};
i18n.phonenumbers.PhoneMetadata.prototype.getSharedCostOrDefault = function() {
  return this.get$ValueOrDefault(6);
};
i18n.phonenumbers.PhoneMetadata.prototype.setSharedCost = function(a) {
  this.set$Value(6, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasSharedCost = function() {
  return this.has$Value(6);
};
i18n.phonenumbers.PhoneMetadata.prototype.sharedCostCount = function() {
  return this.count$Values(6);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearSharedCost = function() {
  this.clear$Field(6);
};
i18n.phonenumbers.PhoneMetadata.prototype.getPersonalNumber = function() {
  return this.get$Value(7);
};
i18n.phonenumbers.PhoneMetadata.prototype.getPersonalNumberOrDefault = function() {
  return this.get$ValueOrDefault(7);
};
i18n.phonenumbers.PhoneMetadata.prototype.setPersonalNumber = function(a) {
  this.set$Value(7, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasPersonalNumber = function() {
  return this.has$Value(7);
};
i18n.phonenumbers.PhoneMetadata.prototype.personalNumberCount = function() {
  return this.count$Values(7);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearPersonalNumber = function() {
  this.clear$Field(7);
};
i18n.phonenumbers.PhoneMetadata.prototype.getVoip = function() {
  return this.get$Value(8);
};
i18n.phonenumbers.PhoneMetadata.prototype.getVoipOrDefault = function() {
  return this.get$ValueOrDefault(8);
};
i18n.phonenumbers.PhoneMetadata.prototype.setVoip = function(a) {
  this.set$Value(8, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasVoip = function() {
  return this.has$Value(8);
};
i18n.phonenumbers.PhoneMetadata.prototype.voipCount = function() {
  return this.count$Values(8);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearVoip = function() {
  this.clear$Field(8);
};
i18n.phonenumbers.PhoneMetadata.prototype.getPager = function() {
  return this.get$Value(21);
};
i18n.phonenumbers.PhoneMetadata.prototype.getPagerOrDefault = function() {
  return this.get$ValueOrDefault(21);
};
i18n.phonenumbers.PhoneMetadata.prototype.setPager = function(a) {
  this.set$Value(21, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasPager = function() {
  return this.has$Value(21);
};
i18n.phonenumbers.PhoneMetadata.prototype.pagerCount = function() {
  return this.count$Values(21);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearPager = function() {
  this.clear$Field(21);
};
i18n.phonenumbers.PhoneMetadata.prototype.getUan = function() {
  return this.get$Value(25);
};
i18n.phonenumbers.PhoneMetadata.prototype.getUanOrDefault = function() {
  return this.get$ValueOrDefault(25);
};
i18n.phonenumbers.PhoneMetadata.prototype.setUan = function(a) {
  this.set$Value(25, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasUan = function() {
  return this.has$Value(25);
};
i18n.phonenumbers.PhoneMetadata.prototype.uanCount = function() {
  return this.count$Values(25);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearUan = function() {
  this.clear$Field(25);
};
i18n.phonenumbers.PhoneMetadata.prototype.getEmergency = function() {
  return this.get$Value(27);
};
i18n.phonenumbers.PhoneMetadata.prototype.getEmergencyOrDefault = function() {
  return this.get$ValueOrDefault(27);
};
i18n.phonenumbers.PhoneMetadata.prototype.setEmergency = function(a) {
  this.set$Value(27, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasEmergency = function() {
  return this.has$Value(27);
};
i18n.phonenumbers.PhoneMetadata.prototype.emergencyCount = function() {
  return this.count$Values(27);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearEmergency = function() {
  this.clear$Field(27);
};
i18n.phonenumbers.PhoneMetadata.prototype.getVoicemail = function() {
  return this.get$Value(28);
};
i18n.phonenumbers.PhoneMetadata.prototype.getVoicemailOrDefault = function() {
  return this.get$ValueOrDefault(28);
};
i18n.phonenumbers.PhoneMetadata.prototype.setVoicemail = function(a) {
  this.set$Value(28, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasVoicemail = function() {
  return this.has$Value(28);
};
i18n.phonenumbers.PhoneMetadata.prototype.voicemailCount = function() {
  return this.count$Values(28);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearVoicemail = function() {
  this.clear$Field(28);
};
i18n.phonenumbers.PhoneMetadata.prototype.getNoInternationalDialling = function() {
  return this.get$Value(24);
};
i18n.phonenumbers.PhoneMetadata.prototype.getNoInternationalDiallingOrDefault = function() {
  return this.get$ValueOrDefault(24);
};
i18n.phonenumbers.PhoneMetadata.prototype.setNoInternationalDialling = function(a) {
  this.set$Value(24, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasNoInternationalDialling = function() {
  return this.has$Value(24);
};
i18n.phonenumbers.PhoneMetadata.prototype.noInternationalDiallingCount = function() {
  return this.count$Values(24);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearNoInternationalDialling = function() {
  this.clear$Field(24);
};
i18n.phonenumbers.PhoneMetadata.prototype.getId = function() {
  return this.get$Value(9);
};
i18n.phonenumbers.PhoneMetadata.prototype.getIdOrDefault = function() {
  return this.get$ValueOrDefault(9);
};
i18n.phonenumbers.PhoneMetadata.prototype.setId = function(a) {
  this.set$Value(9, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasId = function() {
  return this.has$Value(9);
};
i18n.phonenumbers.PhoneMetadata.prototype.idCount = function() {
  return this.count$Values(9);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearId = function() {
  this.clear$Field(9);
};
i18n.phonenumbers.PhoneMetadata.prototype.getCountryCode = function() {
  return this.get$Value(10);
};
i18n.phonenumbers.PhoneMetadata.prototype.getCountryCodeOrDefault = function() {
  return this.get$ValueOrDefault(10);
};
i18n.phonenumbers.PhoneMetadata.prototype.setCountryCode = function(a) {
  this.set$Value(10, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasCountryCode = function() {
  return this.has$Value(10);
};
i18n.phonenumbers.PhoneMetadata.prototype.countryCodeCount = function() {
  return this.count$Values(10);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearCountryCode = function() {
  this.clear$Field(10);
};
i18n.phonenumbers.PhoneMetadata.prototype.getInternationalPrefix = function() {
  return this.get$Value(11);
};
i18n.phonenumbers.PhoneMetadata.prototype.getInternationalPrefixOrDefault = function() {
  return this.get$ValueOrDefault(11);
};
i18n.phonenumbers.PhoneMetadata.prototype.setInternationalPrefix = function(a) {
  this.set$Value(11, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasInternationalPrefix = function() {
  return this.has$Value(11);
};
i18n.phonenumbers.PhoneMetadata.prototype.internationalPrefixCount = function() {
  return this.count$Values(11);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearInternationalPrefix = function() {
  this.clear$Field(11);
};
i18n.phonenumbers.PhoneMetadata.prototype.getPreferredInternationalPrefix = function() {
  return this.get$Value(17);
};
i18n.phonenumbers.PhoneMetadata.prototype.getPreferredInternationalPrefixOrDefault = function() {
  return this.get$ValueOrDefault(17);
};
i18n.phonenumbers.PhoneMetadata.prototype.setPreferredInternationalPrefix = function(a) {
  this.set$Value(17, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasPreferredInternationalPrefix = function() {
  return this.has$Value(17);
};
i18n.phonenumbers.PhoneMetadata.prototype.preferredInternationalPrefixCount = function() {
  return this.count$Values(17);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearPreferredInternationalPrefix = function() {
  this.clear$Field(17);
};
i18n.phonenumbers.PhoneMetadata.prototype.getNationalPrefix = function() {
  return this.get$Value(12);
};
i18n.phonenumbers.PhoneMetadata.prototype.getNationalPrefixOrDefault = function() {
  return this.get$ValueOrDefault(12);
};
i18n.phonenumbers.PhoneMetadata.prototype.setNationalPrefix = function(a) {
  this.set$Value(12, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasNationalPrefix = function() {
  return this.has$Value(12);
};
i18n.phonenumbers.PhoneMetadata.prototype.nationalPrefixCount = function() {
  return this.count$Values(12);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearNationalPrefix = function() {
  this.clear$Field(12);
};
i18n.phonenumbers.PhoneMetadata.prototype.getPreferredExtnPrefix = function() {
  return this.get$Value(13);
};
i18n.phonenumbers.PhoneMetadata.prototype.getPreferredExtnPrefixOrDefault = function() {
  return this.get$ValueOrDefault(13);
};
i18n.phonenumbers.PhoneMetadata.prototype.setPreferredExtnPrefix = function(a) {
  this.set$Value(13, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasPreferredExtnPrefix = function() {
  return this.has$Value(13);
};
i18n.phonenumbers.PhoneMetadata.prototype.preferredExtnPrefixCount = function() {
  return this.count$Values(13);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearPreferredExtnPrefix = function() {
  this.clear$Field(13);
};
i18n.phonenumbers.PhoneMetadata.prototype.getNationalPrefixForParsing = function() {
  return this.get$Value(15);
};
i18n.phonenumbers.PhoneMetadata.prototype.getNationalPrefixForParsingOrDefault = function() {
  return this.get$ValueOrDefault(15);
};
i18n.phonenumbers.PhoneMetadata.prototype.setNationalPrefixForParsing = function(a) {
  this.set$Value(15, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasNationalPrefixForParsing = function() {
  return this.has$Value(15);
};
i18n.phonenumbers.PhoneMetadata.prototype.nationalPrefixForParsingCount = function() {
  return this.count$Values(15);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearNationalPrefixForParsing = function() {
  this.clear$Field(15);
};
i18n.phonenumbers.PhoneMetadata.prototype.getNationalPrefixTransformRule = function() {
  return this.get$Value(16);
};
i18n.phonenumbers.PhoneMetadata.prototype.getNationalPrefixTransformRuleOrDefault = function() {
  return this.get$ValueOrDefault(16);
};
i18n.phonenumbers.PhoneMetadata.prototype.setNationalPrefixTransformRule = function(a) {
  this.set$Value(16, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasNationalPrefixTransformRule = function() {
  return this.has$Value(16);
};
i18n.phonenumbers.PhoneMetadata.prototype.nationalPrefixTransformRuleCount = function() {
  return this.count$Values(16);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearNationalPrefixTransformRule = function() {
  this.clear$Field(16);
};
i18n.phonenumbers.PhoneMetadata.prototype.getSameMobileAndFixedLinePattern = function() {
  return this.get$Value(18);
};
i18n.phonenumbers.PhoneMetadata.prototype.getSameMobileAndFixedLinePatternOrDefault = function() {
  return this.get$ValueOrDefault(18);
};
i18n.phonenumbers.PhoneMetadata.prototype.setSameMobileAndFixedLinePattern = function(a) {
  this.set$Value(18, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasSameMobileAndFixedLinePattern = function() {
  return this.has$Value(18);
};
i18n.phonenumbers.PhoneMetadata.prototype.sameMobileAndFixedLinePatternCount = function() {
  return this.count$Values(18);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearSameMobileAndFixedLinePattern = function() {
  this.clear$Field(18);
};
i18n.phonenumbers.PhoneMetadata.prototype.getNumberFormat = function(a) {
  return this.get$Value(19, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.getNumberFormatOrDefault = function(a) {
  return this.get$ValueOrDefault(19, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.addNumberFormat = function(a) {
  this.add$Value(19, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.numberFormatArray = function() {
  return this.array$Values(19);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasNumberFormat = function() {
  return this.has$Value(19);
};
i18n.phonenumbers.PhoneMetadata.prototype.numberFormatCount = function() {
  return this.count$Values(19);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearNumberFormat = function() {
  this.clear$Field(19);
};
i18n.phonenumbers.PhoneMetadata.prototype.getIntlNumberFormat = function(a) {
  return this.get$Value(20, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.getIntlNumberFormatOrDefault = function(a) {
  return this.get$ValueOrDefault(20, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.addIntlNumberFormat = function(a) {
  this.add$Value(20, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.intlNumberFormatArray = function() {
  return this.array$Values(20);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasIntlNumberFormat = function() {
  return this.has$Value(20);
};
i18n.phonenumbers.PhoneMetadata.prototype.intlNumberFormatCount = function() {
  return this.count$Values(20);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearIntlNumberFormat = function() {
  this.clear$Field(20);
};
i18n.phonenumbers.PhoneMetadata.prototype.getMainCountryForCode = function() {
  return this.get$Value(22);
};
i18n.phonenumbers.PhoneMetadata.prototype.getMainCountryForCodeOrDefault = function() {
  return this.get$ValueOrDefault(22);
};
i18n.phonenumbers.PhoneMetadata.prototype.setMainCountryForCode = function(a) {
  this.set$Value(22, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasMainCountryForCode = function() {
  return this.has$Value(22);
};
i18n.phonenumbers.PhoneMetadata.prototype.mainCountryForCodeCount = function() {
  return this.count$Values(22);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearMainCountryForCode = function() {
  this.clear$Field(22);
};
i18n.phonenumbers.PhoneMetadata.prototype.getLeadingDigits = function() {
  return this.get$Value(23);
};
i18n.phonenumbers.PhoneMetadata.prototype.getLeadingDigitsOrDefault = function() {
  return this.get$ValueOrDefault(23);
};
i18n.phonenumbers.PhoneMetadata.prototype.setLeadingDigits = function(a) {
  this.set$Value(23, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasLeadingDigits = function() {
  return this.has$Value(23);
};
i18n.phonenumbers.PhoneMetadata.prototype.leadingDigitsCount = function() {
  return this.count$Values(23);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearLeadingDigits = function() {
  this.clear$Field(23);
};
i18n.phonenumbers.PhoneMetadata.prototype.getLeadingZeroPossible = function() {
  return this.get$Value(26);
};
i18n.phonenumbers.PhoneMetadata.prototype.getLeadingZeroPossibleOrDefault = function() {
  return this.get$ValueOrDefault(26);
};
i18n.phonenumbers.PhoneMetadata.prototype.setLeadingZeroPossible = function(a) {
  this.set$Value(26, a);
};
i18n.phonenumbers.PhoneMetadata.prototype.hasLeadingZeroPossible = function() {
  return this.has$Value(26);
};
i18n.phonenumbers.PhoneMetadata.prototype.leadingZeroPossibleCount = function() {
  return this.count$Values(26);
};
i18n.phonenumbers.PhoneMetadata.prototype.clearLeadingZeroPossible = function() {
  this.clear$Field(26);
};
i18n.phonenumbers.PhoneMetadataCollection = function() {
  goog.proto2.Message.call(this);
};
goog.inherits(i18n.phonenumbers.PhoneMetadataCollection, goog.proto2.Message);
i18n.phonenumbers.PhoneMetadataCollection.prototype.getMetadata = function(a) {
  return this.get$Value(1, a);
};
i18n.phonenumbers.PhoneMetadataCollection.prototype.getMetadataOrDefault = function(a) {
  return this.get$ValueOrDefault(1, a);
};
i18n.phonenumbers.PhoneMetadataCollection.prototype.addMetadata = function(a) {
  this.add$Value(1, a);
};
i18n.phonenumbers.PhoneMetadataCollection.prototype.metadataArray = function() {
  return this.array$Values(1);
};
i18n.phonenumbers.PhoneMetadataCollection.prototype.hasMetadata = function() {
  return this.has$Value(1);
};
i18n.phonenumbers.PhoneMetadataCollection.prototype.metadataCount = function() {
  return this.count$Values(1);
};
i18n.phonenumbers.PhoneMetadataCollection.prototype.clearMetadata = function() {
  this.clear$Field(1);
};
i18n.phonenumbers.NumberFormat.prototype.getDescriptor = function() {
  i18n.phonenumbers.NumberFormat.descriptor_ || (i18n.phonenumbers.NumberFormat.descriptor_ = goog.proto2.Message.createDescriptor(i18n.phonenumbers.NumberFormat, {0:{name:"NumberFormat", fullName:"i18n.phonenumbers.NumberFormat"}, 1:{name:"pattern", required:!0, fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 2:{name:"format", required:!0, fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 3:{name:"leading_digits_pattern", repeated:!0, fieldType:goog.proto2.Message.FieldType.STRING, 
  type:String}, 4:{name:"national_prefix_formatting_rule", fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 6:{name:"national_prefix_optional_when_formatting", fieldType:goog.proto2.Message.FieldType.BOOL, type:Boolean}, 5:{name:"domestic_carrier_code_formatting_rule", fieldType:goog.proto2.Message.FieldType.STRING, type:String}}));
  return i18n.phonenumbers.NumberFormat.descriptor_;
};
i18n.phonenumbers.NumberFormat.ctor = i18n.phonenumbers.NumberFormat;
i18n.phonenumbers.NumberFormat.ctor.getDescriptor = i18n.phonenumbers.NumberFormat.prototype.getDescriptor;
i18n.phonenumbers.PhoneNumberDesc.prototype.getDescriptor = function() {
  i18n.phonenumbers.PhoneNumberDesc.descriptor_ || (i18n.phonenumbers.PhoneNumberDesc.descriptor_ = goog.proto2.Message.createDescriptor(i18n.phonenumbers.PhoneNumberDesc, {0:{name:"PhoneNumberDesc", fullName:"i18n.phonenumbers.PhoneNumberDesc"}, 2:{name:"national_number_pattern", fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 3:{name:"possible_number_pattern", fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 6:{name:"example_number", fieldType:goog.proto2.Message.FieldType.STRING, 
  type:String}, 7:{name:"national_number_matcher_data", fieldType:goog.proto2.Message.FieldType.BYTES, type:String}, 8:{name:"possible_number_matcher_data", fieldType:goog.proto2.Message.FieldType.BYTES, type:String}}));
  return i18n.phonenumbers.PhoneNumberDesc.descriptor_;
};
i18n.phonenumbers.PhoneNumberDesc.ctor = i18n.phonenumbers.PhoneNumberDesc;
i18n.phonenumbers.PhoneNumberDesc.ctor.getDescriptor = i18n.phonenumbers.PhoneNumberDesc.prototype.getDescriptor;
i18n.phonenumbers.PhoneMetadata.prototype.getDescriptor = function() {
  i18n.phonenumbers.PhoneMetadata.descriptor_ || (i18n.phonenumbers.PhoneMetadata.descriptor_ = goog.proto2.Message.createDescriptor(i18n.phonenumbers.PhoneMetadata, {0:{name:"PhoneMetadata", fullName:"i18n.phonenumbers.PhoneMetadata"}, 1:{name:"general_desc", fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.PhoneNumberDesc}, 2:{name:"fixed_line", fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.PhoneNumberDesc}, 3:{name:"mobile", fieldType:goog.proto2.Message.FieldType.MESSAGE, 
  type:i18n.phonenumbers.PhoneNumberDesc}, 4:{name:"toll_free", fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.PhoneNumberDesc}, 5:{name:"premium_rate", fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.PhoneNumberDesc}, 6:{name:"shared_cost", fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.PhoneNumberDesc}, 7:{name:"personal_number", fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.PhoneNumberDesc}, 8:{name:"voip", 
  fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.PhoneNumberDesc}, 21:{name:"pager", fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.PhoneNumberDesc}, 25:{name:"uan", fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.PhoneNumberDesc}, 27:{name:"emergency", fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.PhoneNumberDesc}, 28:{name:"voicemail", fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.PhoneNumberDesc}, 
  24:{name:"no_international_dialling", fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.PhoneNumberDesc}, 9:{name:"id", required:!0, fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 10:{name:"country_code", fieldType:goog.proto2.Message.FieldType.INT32, type:Number}, 11:{name:"international_prefix", fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 17:{name:"preferred_international_prefix", fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 
  12:{name:"national_prefix", fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 13:{name:"preferred_extn_prefix", fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 15:{name:"national_prefix_for_parsing", fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 16:{name:"national_prefix_transform_rule", fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 18:{name:"same_mobile_and_fixed_line_pattern", fieldType:goog.proto2.Message.FieldType.BOOL, defaultValue:!1, 
  type:Boolean}, 19:{name:"number_format", repeated:!0, fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.NumberFormat}, 20:{name:"intl_number_format", repeated:!0, fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.NumberFormat}, 22:{name:"main_country_for_code", fieldType:goog.proto2.Message.FieldType.BOOL, defaultValue:!1, type:Boolean}, 23:{name:"leading_digits", fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 26:{name:"leading_zero_possible", 
  fieldType:goog.proto2.Message.FieldType.BOOL, defaultValue:!1, type:Boolean}}));
  return i18n.phonenumbers.PhoneMetadata.descriptor_;
};
i18n.phonenumbers.PhoneMetadata.ctor = i18n.phonenumbers.PhoneMetadata;
i18n.phonenumbers.PhoneMetadata.ctor.getDescriptor = i18n.phonenumbers.PhoneMetadata.prototype.getDescriptor;
i18n.phonenumbers.PhoneMetadataCollection.prototype.getDescriptor = function() {
  i18n.phonenumbers.PhoneMetadataCollection.descriptor_ || (i18n.phonenumbers.PhoneMetadataCollection.descriptor_ = goog.proto2.Message.createDescriptor(i18n.phonenumbers.PhoneMetadataCollection, {0:{name:"PhoneMetadataCollection", fullName:"i18n.phonenumbers.PhoneMetadataCollection"}, 1:{name:"metadata", repeated:!0, fieldType:goog.proto2.Message.FieldType.MESSAGE, type:i18n.phonenumbers.PhoneMetadata}}));
  return i18n.phonenumbers.PhoneMetadataCollection.descriptor_;
};
i18n.phonenumbers.PhoneMetadataCollection.ctor = i18n.phonenumbers.PhoneMetadataCollection;
i18n.phonenumbers.PhoneMetadataCollection.ctor.getDescriptor = i18n.phonenumbers.PhoneMetadataCollection.prototype.getDescriptor;
i18n.phonenumbers.PhoneNumber = function() {
  goog.proto2.Message.call(this);
};
goog.inherits(i18n.phonenumbers.PhoneNumber, goog.proto2.Message);
i18n.phonenumbers.PhoneNumber.prototype.getCountryCode = function() {
  return this.get$Value(1);
};
i18n.phonenumbers.PhoneNumber.prototype.getCountryCodeOrDefault = function() {
  return this.get$ValueOrDefault(1);
};
i18n.phonenumbers.PhoneNumber.prototype.setCountryCode = function(a) {
  this.set$Value(1, a);
};
i18n.phonenumbers.PhoneNumber.prototype.hasCountryCode = function() {
  return this.has$Value(1);
};
i18n.phonenumbers.PhoneNumber.prototype.countryCodeCount = function() {
  return this.count$Values(1);
};
i18n.phonenumbers.PhoneNumber.prototype.clearCountryCode = function() {
  this.clear$Field(1);
};
i18n.phonenumbers.PhoneNumber.prototype.getNationalNumber = function() {
  return this.get$Value(2);
};
i18n.phonenumbers.PhoneNumber.prototype.getNationalNumberOrDefault = function() {
  return this.get$ValueOrDefault(2);
};
i18n.phonenumbers.PhoneNumber.prototype.setNationalNumber = function(a) {
  this.set$Value(2, a);
};
i18n.phonenumbers.PhoneNumber.prototype.hasNationalNumber = function() {
  return this.has$Value(2);
};
i18n.phonenumbers.PhoneNumber.prototype.nationalNumberCount = function() {
  return this.count$Values(2);
};
i18n.phonenumbers.PhoneNumber.prototype.clearNationalNumber = function() {
  this.clear$Field(2);
};
i18n.phonenumbers.PhoneNumber.prototype.getExtension = function() {
  return this.get$Value(3);
};
i18n.phonenumbers.PhoneNumber.prototype.getExtensionOrDefault = function() {
  return this.get$ValueOrDefault(3);
};
i18n.phonenumbers.PhoneNumber.prototype.setExtension = function(a) {
  this.set$Value(3, a);
};
i18n.phonenumbers.PhoneNumber.prototype.hasExtension = function() {
  return this.has$Value(3);
};
i18n.phonenumbers.PhoneNumber.prototype.extensionCount = function() {
  return this.count$Values(3);
};
i18n.phonenumbers.PhoneNumber.prototype.clearExtension = function() {
  this.clear$Field(3);
};
i18n.phonenumbers.PhoneNumber.prototype.getItalianLeadingZero = function() {
  return this.get$Value(4);
};
i18n.phonenumbers.PhoneNumber.prototype.getItalianLeadingZeroOrDefault = function() {
  return this.get$ValueOrDefault(4);
};
i18n.phonenumbers.PhoneNumber.prototype.setItalianLeadingZero = function(a) {
  this.set$Value(4, a);
};
i18n.phonenumbers.PhoneNumber.prototype.hasItalianLeadingZero = function() {
  return this.has$Value(4);
};
i18n.phonenumbers.PhoneNumber.prototype.italianLeadingZeroCount = function() {
  return this.count$Values(4);
};
i18n.phonenumbers.PhoneNumber.prototype.clearItalianLeadingZero = function() {
  this.clear$Field(4);
};
i18n.phonenumbers.PhoneNumber.prototype.getNumberOfLeadingZeros = function() {
  return this.get$Value(8);
};
i18n.phonenumbers.PhoneNumber.prototype.getNumberOfLeadingZerosOrDefault = function() {
  return this.get$ValueOrDefault(8);
};
i18n.phonenumbers.PhoneNumber.prototype.setNumberOfLeadingZeros = function(a) {
  this.set$Value(8, a);
};
i18n.phonenumbers.PhoneNumber.prototype.hasNumberOfLeadingZeros = function() {
  return this.has$Value(8);
};
i18n.phonenumbers.PhoneNumber.prototype.numberOfLeadingZerosCount = function() {
  return this.count$Values(8);
};
i18n.phonenumbers.PhoneNumber.prototype.clearNumberOfLeadingZeros = function() {
  this.clear$Field(8);
};
i18n.phonenumbers.PhoneNumber.prototype.getRawInput = function() {
  return this.get$Value(5);
};
i18n.phonenumbers.PhoneNumber.prototype.getRawInputOrDefault = function() {
  return this.get$ValueOrDefault(5);
};
i18n.phonenumbers.PhoneNumber.prototype.setRawInput = function(a) {
  this.set$Value(5, a);
};
i18n.phonenumbers.PhoneNumber.prototype.hasRawInput = function() {
  return this.has$Value(5);
};
i18n.phonenumbers.PhoneNumber.prototype.rawInputCount = function() {
  return this.count$Values(5);
};
i18n.phonenumbers.PhoneNumber.prototype.clearRawInput = function() {
  this.clear$Field(5);
};
i18n.phonenumbers.PhoneNumber.prototype.getCountryCodeSource = function() {
  return this.get$Value(6);
};
i18n.phonenumbers.PhoneNumber.prototype.getCountryCodeSourceOrDefault = function() {
  return this.get$ValueOrDefault(6);
};
i18n.phonenumbers.PhoneNumber.prototype.setCountryCodeSource = function(a) {
  this.set$Value(6, a);
};
i18n.phonenumbers.PhoneNumber.prototype.hasCountryCodeSource = function() {
  return this.has$Value(6);
};
i18n.phonenumbers.PhoneNumber.prototype.countryCodeSourceCount = function() {
  return this.count$Values(6);
};
i18n.phonenumbers.PhoneNumber.prototype.clearCountryCodeSource = function() {
  this.clear$Field(6);
};
i18n.phonenumbers.PhoneNumber.prototype.getPreferredDomesticCarrierCode = function() {
  return this.get$Value(7);
};
i18n.phonenumbers.PhoneNumber.prototype.getPreferredDomesticCarrierCodeOrDefault = function() {
  return this.get$ValueOrDefault(7);
};
i18n.phonenumbers.PhoneNumber.prototype.setPreferredDomesticCarrierCode = function(a) {
  this.set$Value(7, a);
};
i18n.phonenumbers.PhoneNumber.prototype.hasPreferredDomesticCarrierCode = function() {
  return this.has$Value(7);
};
i18n.phonenumbers.PhoneNumber.prototype.preferredDomesticCarrierCodeCount = function() {
  return this.count$Values(7);
};
i18n.phonenumbers.PhoneNumber.prototype.clearPreferredDomesticCarrierCode = function() {
  this.clear$Field(7);
};
i18n.phonenumbers.PhoneNumber.CountryCodeSource = {FROM_NUMBER_WITH_PLUS_SIGN:1, FROM_NUMBER_WITH_IDD:5, FROM_NUMBER_WITHOUT_PLUS_SIGN:10, FROM_DEFAULT_COUNTRY:20};
i18n.phonenumbers.PhoneNumber.prototype.getDescriptor = function() {
  i18n.phonenumbers.PhoneNumber.descriptor_ || (i18n.phonenumbers.PhoneNumber.descriptor_ = goog.proto2.Message.createDescriptor(i18n.phonenumbers.PhoneNumber, {0:{name:"PhoneNumber", fullName:"i18n.phonenumbers.PhoneNumber"}, 1:{name:"country_code", required:!0, fieldType:goog.proto2.Message.FieldType.INT32, type:Number}, 2:{name:"national_number", required:!0, fieldType:goog.proto2.Message.FieldType.UINT64, type:Number}, 3:{name:"extension", fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 
  4:{name:"italian_leading_zero", fieldType:goog.proto2.Message.FieldType.BOOL, type:Boolean}, 8:{name:"number_of_leading_zeros", fieldType:goog.proto2.Message.FieldType.INT32, defaultValue:1, type:Number}, 5:{name:"raw_input", fieldType:goog.proto2.Message.FieldType.STRING, type:String}, 6:{name:"country_code_source", fieldType:goog.proto2.Message.FieldType.ENUM, defaultValue:i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_NUMBER_WITH_PLUS_SIGN, type:i18n.phonenumbers.PhoneNumber.CountryCodeSource}, 
  7:{name:"preferred_domestic_carrier_code", fieldType:goog.proto2.Message.FieldType.STRING, type:String}}));
  return i18n.phonenumbers.PhoneNumber.descriptor_;
};
i18n.phonenumbers.PhoneNumber.ctor = i18n.phonenumbers.PhoneNumber;
i18n.phonenumbers.PhoneNumber.ctor.getDescriptor = i18n.phonenumbers.PhoneNumber.prototype.getDescriptor;
/*

 Copyright (C) 2010 The Libphonenumber Authors

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
i18n.phonenumbers.metadata = {};
i18n.phonenumbers.metadata.countryCodeToRegionCodeMap = {1:"US AG AI AS BB BM BS CA DM DO GD GU JM KN KY LC MP MS PR SX TC TT VC VG VI".split(" "), 7:["RU", "KZ"], 20:["EG"], 27:["ZA"], 30:["GR"], 31:["NL"], 32:["BE"], 33:["FR"], 34:["ES"], 36:["HU"], 39:["IT", "VA"], 40:["RO"], 41:["CH"], 43:["AT"], 44:["GB", "GG", "IM", "JE"], 45:["DK"], 46:["SE"], 47:["NO", "SJ"], 48:["PL"], 49:["DE"], 51:["PE"], 52:["MX"], 53:["CU"], 54:["AR"], 55:["BR"], 56:["CL"], 57:["CO"], 58:["VE"], 60:["MY"], 61:["AU", 
"CC", "CX"], 62:["ID"], 63:["PH"], 64:["NZ"], 65:["SG"], 66:["TH"], 81:["JP"], 82:["KR"], 84:["VN"], 86:["CN"], 90:["TR"], 91:["IN"], 92:["PK"], 93:["AF"], 94:["LK"], 95:["MM"], 98:["IR"], 211:["SS"], 212:["MA", "EH"], 213:["DZ"], 216:["TN"], 218:["LY"], 220:["GM"], 221:["SN"], 222:["MR"], 223:["ML"], 224:["GN"], 225:["CI"], 226:["BF"], 227:["NE"], 228:["TG"], 229:["BJ"], 230:["MU"], 231:["LR"], 232:["SL"], 233:["GH"], 234:["NG"], 235:["TD"], 236:["CF"], 237:["CM"], 238:["CV"], 239:["ST"], 240:["GQ"], 
241:["GA"], 242:["CG"], 243:["CD"], 244:["AO"], 245:["GW"], 246:["IO"], 247:["AC"], 248:["SC"], 249:["SD"], 250:["RW"], 251:["ET"], 252:["SO"], 253:["DJ"], 254:["KE"], 255:["TZ"], 256:["UG"], 257:["BI"], 258:["MZ"], 260:["ZM"], 261:["MG"], 262:["RE", "YT"], 263:["ZW"], 264:["NA"], 265:["MW"], 266:["LS"], 267:["BW"], 268:["SZ"], 269:["KM"], 290:["SH", "TA"], 291:["ER"], 297:["AW"], 298:["FO"], 299:["GL"], 350:["GI"], 351:["PT"], 352:["LU"], 353:["IE"], 354:["IS"], 355:["AL"], 356:["MT"], 357:["CY"], 
358:["FI", "AX"], 359:["BG"], 370:["LT"], 371:["LV"], 372:["EE"], 373:["MD"], 374:["AM"], 375:["BY"], 376:["AD"], 377:["MC"], 378:["SM"], 380:["UA"], 381:["RS"], 382:["ME"], 385:["HR"], 386:["SI"], 387:["BA"], 389:["MK"], 420:["CZ"], 421:["SK"], 423:["LI"], 500:["FK"], 501:["BZ"], 502:["GT"], 503:["SV"], 504:["HN"], 505:["NI"], 506:["CR"], 507:["PA"], 508:["PM"], 509:["HT"], 590:["GP", "BL", "MF"], 591:["BO"], 592:["GY"], 593:["EC"], 594:["GF"], 595:["PY"], 596:["MQ"], 597:["SR"], 598:["UY"], 599:["CW", 
"BQ"], 670:["TL"], 672:["NF"], 673:["BN"], 674:["NR"], 675:["PG"], 676:["TO"], 677:["SB"], 678:["VU"], 679:["FJ"], 680:["PW"], 681:["WF"], 682:["CK"], 683:["NU"], 685:["WS"], 686:["KI"], 687:["NC"], 688:["TV"], 689:["PF"], 690:["TK"], 691:["FM"], 692:["MH"], 800:["001"], 808:["001"], 850:["KP"], 852:["HK"], 853:["MO"], 855:["KH"], 856:["LA"], 870:["001"], 878:["001"], 880:["BD"], 881:["001"], 882:["001"], 883:["001"], 886:["TW"], 888:["001"], 960:["MV"], 961:["LB"], 962:["JO"], 963:["SY"], 964:["IQ"], 
965:["KW"], 966:["SA"], 967:["YE"], 968:["OM"], 970:["PS"], 971:["AE"], 972:["IL"], 973:["BH"], 974:["QA"], 975:["BT"], 976:["MN"], 977:["NP"], 979:["001"], 992:["TJ"], 993:["TM"], 994:["AZ"], 995:["GE"], 996:["KG"], 998:["UZ"]};
i18n.phonenumbers.metadata.countryToMetadata = {AC:[, [, , "[46]\\d{4}|[01589]\\d{5}", "\\d{5,6}"], [, , "6[2-467]\\d{3}", "\\d{5}", , , "62889"], [, , "4\\d{4}", "\\d{5}", , , "40123"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "AC", 247, "00", , , , , , , , , , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "[01589]\\d{5}", "\\d{6}", , , "542011"], , , [, , "NA", "NA"]], AD:[, [, , "(?:[346-9]|180)\\d{5}", "\\d{6,8}"], [, , "[78]\\d{5}", "\\d{6}", , 
, "712345"], [, , "[346]\\d{5}", "\\d{6}", , , "312345"], [, , "180[02]\\d{4}", "\\d{8}", , , "18001234"], [, , "9\\d{5}", "\\d{6}", , , "912345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "AD", 376, "00", , , , , , , , [[, "(\\d{3})(\\d{3})", "$1 $2", ["[346-9]"]], [, "(180[02])(\\d{4})", "$1 $2", ["1"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], AE:[, [, , "[2-79]\\d{7,8}|800\\d{2,9}", "\\d{5,12}"], [, , "[2-4679][2-8]\\d{6}", "\\d{7,8}", , 
, "22345678"], [, , "5[024-6]\\d{7}", "\\d{9}", , , "501234567"], [, , "400\\d{6}|800\\d{2,9}", "\\d{5,12}", , , "800123456"], [, , "900[02]\\d{5}", "\\d{9}", , , "900234567"], [, , "700[05]\\d{5}", "\\d{9}", , , "700012345"], [, , "NA", "NA"], [, , "NA", "NA"], "AE", 971, "00", "0", , , "0", , , , [[, "([2-4679])(\\d{3})(\\d{4})", "$1 $2 $3", ["[2-4679][2-8]"], "0$1"], [, "(5\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["5"], "0$1"], [, "([479]00)(\\d)(\\d{5})", "$1 $2 $3", ["[479]0"], "$1"], [, "([68]00)(\\d{2,9})", 
"$1 $2", ["60|8"], "$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "600[25]\\d{5}", "\\d{9}", , , "600212345"], , , [, , "NA", "NA"]], AF:[, [, , "[2-7]\\d{8}", "\\d{7,9}"], [, , "(?:[25][0-8]|[34][0-4]|6[0-5])[2-9]\\d{6}", "\\d{7,9}", , , "234567890"], [, , "7(?:[014-9]\\d{7}|2[89]\\d{6})", "\\d{9}", , , "701234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "AF", 93, "00", "0", , , "0", , , , [[, "([2-7]\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["[2-7]"], 
"0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], AG:[, [, , "[2589]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "268(?:4(?:6[0-38]|84)|56[0-2])\\d{4}", "\\d{7}(?:\\d{3})?", , , "2684601234"], [, , "268(?:464|7(?:2[0-9]|64|7[0-689]|8[02-68]))\\d{4}", "\\d{10}", , , "2684641234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002123456"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", 
, , "5002345678"], [, , "26848[01]\\d{4}", "\\d{10}", , , "2684801234"], "AG", 1, "011", "1", , , "1", , , , , , [, , "26840[69]\\d{4}", "\\d{10}", , , "2684061234"], , "268", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], AI:[, [, , "[2589]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "2644(?:6[12]|9[78])\\d{4}", "\\d{7}(?:\\d{3})?", , , "2644612345"], [, , "264(?:235|476|5(?:3[6-9]|8[1-4])|7(?:29|72))\\d{4}", "\\d{10}", , , "2642351234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , 
, "8002123456"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "AI", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "264", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], AL:[, [, , "[2-57]\\d{7}|6\\d{8}|8\\d{5,7}|9\\d{5}", "\\d{5,9}"], [, , "(?:2(?:[168][1-9]|[247]\\d|9[1-7])|3(?:1[1-3]|[2-6]\\d|[79][1-8]|8[1-9])|4\\d{2}|5(?:1[1-4]|[2-578]\\d|6[1-5]|9[1-7])|8(?:[19][1-5]|[2-6]\\d|[78][1-7]))\\d{5}", 
"\\d{5,8}", , , "22345678"], [, , "6[6-9]\\d{7}", "\\d{9}", , , "661234567"], [, , "800\\d{4}", "\\d{7}", , , "8001234"], [, , "900\\d{3}", "\\d{6}", , , "900123"], [, , "808\\d{3}", "\\d{6}", , , "808123"], [, , "700\\d{5}", "\\d{8}", , , "70012345"], [, , "NA", "NA"], "AL", 355, "00", "0", , , "0", , , , [[, "(4)(\\d{3})(\\d{4})", "$1 $2 $3", ["4[0-6]"], "0$1"], [, "(6[6-9])(\\d{3})(\\d{4})", "$1 $2 $3", ["6"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["[2358][2-5]|4[7-9]"], "0$1"], [, 
"(\\d{3})(\\d{3,5})", "$1 $2", ["[235][16-9]|8[016-9]|[79]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], AM:[, [, , "[1-9]\\d{7}", "\\d{5,8}"], [, , "(?:1[01]\\d|2(?:2[2-46]|3[1-8]|4[2-69]|5[2-7]|6[1-9]|8[1-7])|3[12]2|47\\d)\\d{5}", "\\d{5,8}", , , "10123456"], [, , "(?:4[139]|55|77|9[1-9])\\d{6}", "\\d{8}", , , "77123456"], [, , "800\\d{5}", "\\d{8}", , , "80012345"], [, , "90[016]\\d{5}", "\\d{8}", , , "90012345"], [, , "80[1-4]\\d{5}", "\\d{8}", 
, , "80112345"], [, , "NA", "NA"], [, , "60[2-6]\\d{5}", "\\d{8}", , , "60271234"], "AM", 374, "00", "0", , , "0", , , , [[, "(\\d{2})(\\d{6})", "$1 $2", ["1|47"], "(0$1)"], [, "(\\d{2})(\\d{6})", "$1 $2", ["4[139]|[5-7]|9[1-9]"], "0$1"], [, "(\\d{3})(\\d{5})", "$1 $2", ["[23]"], "(0$1)"], [, "(\\d{3})(\\d{2})(\\d{3})", "$1 $2 $3", ["8|90"], "0 $1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], AO:[, [, , "[29]\\d{8}", "\\d{9}"], [, , "2\\d(?:[26-9]\\d|\\d[26-9])\\d{5}", 
"\\d{9}", , , "222123456"], [, , "9[1-49]\\d{7}", "\\d{9}", , , "923123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "AO", 244, "00", , , , , , , , [[, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], AR:[, [, , "11\\d{8}|[2368]\\d{9}|9\\d{10}", "\\d{6,11}"], [, , "11\\d{8}|(?:2(?:2(?:[013]\\d|2[13-79]|4[1-6]|5[2457]|6[124-8]|7[1-4]|8[13-6]|9[1267])|3(?:1[467]|2[03-6]|3[13-8]|[49][2-6]|5[2-8]|[067]\\d)|4(?:7[3-8]|9\\d)|6(?:[01346]\\d|2[24-6]|5[15-8])|80\\d|9(?:[0124789]\\d|3[1-6]|5[234]|6[2-46]))|3(?:3(?:2[79]|6\\d|8[2578])|4(?:[78]\\d|0[0124-9]|[1-35]\\d|4[24-7]|6[02-9]|9[123678])|5(?:[138]\\d|2[1245]|4[1-9]|6[2-4]|7[1-6])|6[24]\\d|7(?:[0469]\\d|1[1568]|2[013-9]|3[145]|5[14-8]|7[2-57]|8[0-24-9])|8(?:[013578]\\d|2[15-7]|4[13-6]|6[1-357-9]|9[124]))|670\\d)\\d{6}", 
"\\d{6,10}", , , "1123456789"], [, , "675\\d{7}|9(?:11[2-9]\\d{7}|(?:2(?:2[013]|3[067]|49|6[01346]|80|9[147-9])|3(?:36|4[12358]|5[138]|6[24]|7[069]|8[013578]))[2-9]\\d{6}|\\d{4}[2-9]\\d{5})", "\\d{6,11}", , , "91123456789"], [, , "800\\d{7}", "\\d{10}", , , "8001234567"], [, , "60[04579]\\d{7}", "\\d{10}", , , "6001234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "AR", 54, "00", "0", , , "0?(?:(11|2(?:2(?:02?|[13]|2[13-79]|4[1-6]|5[2457]|6[124-8]|7[1-4]|8[13-6]|9[1267])|3(?:02?|1[467]|2[03-6]|3[13-8]|[49][2-6]|5[2-8]|[67])|4(?:7[3-578]|9)|6(?:[0136]|2[24-6]|4[6-8]?|5[15-8])|80|9(?:0[1-3]|[19]|2\\d|3[1-6]|4[02568]?|5[2-4]|6[2-46]|72?|8[23]?))|3(?:3(?:2[79]|6|8[2578])|4(?:0[0-24-9]|[12]|3[5-8]?|4[24-7]|5[4-68]?|6[02-9]|7[126]|8[2379]?|9[1-36-8])|5(?:1|2[1245]|3[237]?|4[1-46-9]|6[2-4]|7[1-6]|8[2-5]?)|6[24]|7(?:[069]|1[1568]|2[15]|3[145]|4[13]|5[14-8]|7[2-57]|8[126])|8(?:[01]|2[15-7]|3[2578]?|4[13-6]|5[4-8]?|6[1-357-9]|7[36-8]?|8[5-8]?|9[124])))?15)?", 
"9$1", , , [[, "([68]\\d{2})(\\d{3})(\\d{4})", "$1-$2-$3", ["[68]"], "0$1"], [, "(\\d{2})(\\d{4})", "$1-$2", ["[2-9]"], "$1"], [, "(\\d{3})(\\d{4})", "$1-$2", ["[2-9]"], "$1"], [, "(\\d{4})(\\d{4})", "$1-$2", ["[2-9]"], "$1"], [, "(9)(11)(\\d{4})(\\d{4})", "$2 15-$3-$4", ["911"], "0$1"], [, "(9)(\\d{3})(\\d{3})(\\d{4})", "$2 15-$3-$4", ["9(?:2[234689]|3[3-8])", "9(?:2(?:2[013]|3[067]|49|6[01346]|80|9[147-9])|3(?:36|4[1-358]|5[138]|6[24]|7[069]|8[013578]))", "9(?:2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3[456]|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45])))", 
"9(?:2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3(?:4|5[014]|6[1239])|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45])))"], "0$1"], [, "(9)(\\d{4})(\\d{2})(\\d{4})", "$2 15-$3-$4", ["9[23]"], "0$1"], [, "(11)(\\d{4})(\\d{4})", "$1 $2-$3", ["1"], "0$1", , 1], [, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2-$3", ["2(?:2[013]|3[067]|49|6[01346]|80|9[147-9])|3(?:36|4[1-358]|5[138]|6[24]|7[069]|8[013578])", "2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3[456]|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45]))", 
"2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3(?:4|5[014]|6[1239])|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45]))"], "0$1", , 1], [, "(\\d{4})(\\d{2})(\\d{4})", "$1 $2-$3", ["[23]"], "0$1", , 1], [, "(\\d{3})", "$1", ["1[012]|911"], "$1"]], [[, "([68]\\d{2})(\\d{3})(\\d{4})", "$1-$2-$3", ["[68]"], "0$1"], [, "(9)(11)(\\d{4})(\\d{4})", "$1 $2 $3-$4", ["911"]], [, "(9)(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3-$4", ["9(?:2[234689]|3[3-8])", 
"9(?:2(?:2[013]|3[067]|49|6[01346]|80|9[147-9])|3(?:36|4[1-358]|5[138]|6[24]|7[069]|8[013578]))", "9(?:2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3[456]|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45])))", "9(?:2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3(?:4|5[014]|6[1239])|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45])))"]], [, 
"(9)(\\d{4})(\\d{2})(\\d{4})", "$1 $2 $3-$4", ["9[23]"]], [, "(11)(\\d{4})(\\d{4})", "$1 $2-$3", ["1"], "0$1", , 1], [, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2-$3", ["2(?:2[013]|3[067]|49|6[01346]|80|9[147-9])|3(?:36|4[1-358]|5[138]|6[24]|7[069]|8[013578])", "2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3[456]|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45]))", "2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3(?:4|5[014]|6[1239])|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45]))"], 
"0$1", , 1], [, "(\\d{4})(\\d{2})(\\d{4})", "$1 $2-$3", ["[23]"], "0$1", , 1]], [, , "NA", "NA"], , , [, , "810\\d{7}", "\\d{10}", , , "8101234567"], [, , "810\\d{7}", "\\d{10}", , , "8101234567"], , , [, , "NA", "NA"]], AS:[, [, , "[5689]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "6846(?:22|33|44|55|77|88|9[19])\\d{4}", "\\d{7}(?:\\d{3})?", , , "6846221234"], [, , "684(?:2(?:5[2468]|72)|7(?:3[13]|70))\\d{4}", "\\d{10}", , , "6847331234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002123456"], 
[, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "AS", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "684", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], AT:[, [, , "[1-9]\\d{3,12}", "\\d{3,13}"], [, , "1\\d{3,12}|(?:2(?:1[467]|2[13-8]|5[2357]|6[1-46-8]|7[1-8]|8[124-7]|9[1458])|3(?:1[1-8]|3[23568]|4[5-7]|5[1378]|6[1-38]|8[3-68])|4(?:2[1-8]|35|63|7[1368]|8[2457])|5(?:12|2[1-8]|3[357]|4[147]|5[12578]|6[37])|6(?:13|2[1-47]|4[1-35-8]|5[468]|62)|7(?:2[1-8]|3[25]|4[13478]|5[68]|6[16-8]|7[1-6]|9[45]))\\d{3,10}", 
"\\d{3,13}", , , "1234567890"], [, , "6(?:5[0-3579]|6[013-9]|[7-9]\\d)\\d{4,10}", "\\d{7,13}", , , "664123456"], [, , "800\\d{6,10}", "\\d{9,13}", , , "800123456"], [, , "(?:9(?:0[01]|3[019]))\\d{6,10}", "\\d{9,13}", , , "900123456"], [, , "8(?:10\\d|2(?:[01]\\d|8\\d?))\\d{5,9}", "\\d{8,13}", , , "810123456"], [, , "NA", "NA"], [, , "780\\d{6,10}", "\\d{9,13}", , , "780123456"], "AT", 43, "00", "0", , , "0", , , , [[, "(116\\d{3})", "$1", ["116"], "$1"], [, "(1)(\\d{3,12})", "$1 $2", ["1"], "0$1"], 
[, "(5\\d)(\\d{3,5})", "$1 $2", ["5[079]"], "0$1"], [, "(5\\d)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["5[079]"], "0$1"], [, "(5\\d)(\\d{4})(\\d{4,7})", "$1 $2 $3", ["5[079]"], "0$1"], [, "(\\d{3})(\\d{3,10})", "$1 $2", ["316|46|51|732|6(?:5[0-3579]|[6-9])|7(?:[28]0)|[89]"], "0$1"], [, "(\\d{4})(\\d{3,9})", "$1 $2", ["2|3(?:1[1-578]|[3-8])|4[2378]|5[2-6]|6(?:[12]|4[1-9]|5[468])|7(?:2[1-8]|35|4[1-8]|[5-79])"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "5(?:(?:0[1-9]|17)\\d{2,10}|[79]\\d{3,11})|720\\d{6,10}", 
"\\d{5,13}", , , "50123"], , , [, , "NA", "NA"]], AU:[, [, , "[1-578]\\d{5,9}", "\\d{6,10}"], [, , "[237]\\d{8}|8(?:[6-8]\\d{3}|9(?:[02-9]\\d{2}|1(?:[0-57-9]\\d|6[0135-9])))\\d{4}", "\\d{8,9}", , , "212345678"], [, , "14(?:5\\d|71)\\d{5}|4(?:[0-3]\\d|4[47-9]|5[0-25-9]|6[6-9]|7[02-9]|8[147-9]|9[017-9])\\d{6}", "\\d{9}", , , "412345678"], [, , "180(?:0\\d{3}|2)\\d{3}", "\\d{7,10}", , , "1800123456"], [, , "19(?:0[0126]\\d|[679])\\d{5}", "\\d{8,10}", , , "1900123456"], [, , "13(?:00\\d{3}|45[0-4]|\\d)\\d{3}", 
"\\d{6,10}", , , "1300123456"], [, , "500\\d{6}", "\\d{9}", , , "500123456"], [, , "550\\d{6}", "\\d{9}", , , "550123456"], "AU", 61, "(?:14(?:1[14]|34|4[17]|[56]6|7[47]|88))?001[14-689]", "0", , , "0", , "0011", , [[, "([2378])(\\d{4})(\\d{4})", "$1 $2 $3", ["[2378]"], "(0$1)"], [, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3", ["[45]|14"], "0$1"], [, "(16)(\\d{3})(\\d{2,4})", "$1 $2 $3", ["16"], "0$1"], [, "(1[389]\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["1(?:[38]0|90)", "1(?:[38]00|90)"], "$1"], [, "(180)(2\\d{3})", 
"$1 $2", ["180", "1802"], "$1"], [, "(19\\d)(\\d{3})", "$1 $2", ["19[13]"], "$1"], [, "(19\\d{2})(\\d{4})", "$1 $2", ["19[679]"], "$1"], [, "(13)(\\d{2})(\\d{2})", "$1 $2 $3", ["13[1-9]"], "$1"]], , [, , "16\\d{3,7}", "\\d{5,9}", , , "1612345"], 1, , [, , "1(?:3(?:00\\d{3}|45[0-4]|\\d)\\d{3}|80(?:0\\d{6}|2\\d{3}))", "\\d{6,10}", , , "1300123456"], [, , "NA", "NA"], , , [, , "NA", "NA"]], AW:[, [, , "[25-9]\\d{6}", "\\d{7}"], [, , "5(?:2\\d|8[1-9])\\d{4}", "\\d{7}", , , "5212345"], [, , "(?:5(?:6\\d|9[2-478])|6(?:[039]0|22|4[01]|6[0-2])|7[34]\\d|9(?:6[45]|9[4-8]))\\d{4}", 
"\\d{7}", , , "5601234"], [, , "800\\d{4}", "\\d{7}", , , "8001234"], [, , "900\\d{4}", "\\d{7}", , , "9001234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "28\\d{5}|501\\d{4}", "\\d{7}", , , "5011234"], "AW", 297, "00", , , , , , , , [[, "(\\d{3})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], AX:[, [, , "[135]\\d{5,9}|[27]\\d{4,9}|4\\d{5,10}|6\\d{7,8}|8\\d{6,9}", "\\d{5,12}"], [, , "18[1-8]\\d{3,9}", "\\d{6,12}", , , "1812345678"], [, , "4\\d{5,10}|50\\d{4,8}", 
"\\d{6,11}", , , "412345678"], [, , "800\\d{4,7}", "\\d{7,10}", , , "8001234567"], [, , "[67]00\\d{5,6}", "\\d{8,9}", , , "600123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "AX", 358, "00|99[049]", "0", , , "0", , , , , , [, , "NA", "NA"], , , [, , "[13]00\\d{3,7}|2(?:0(?:0\\d{3,7}|2[023]\\d{1,6}|9[89]\\d{1,6}))|60(?:[12]\\d{5,6}|6\\d{7})|7(?:1\\d{7}|3\\d{8}|5[03-9]\\d{2,7})", "\\d{5,10}", , , "100123"], [, , "[13]0\\d{4,8}|2(?:0(?:[016-8]\\d{3,7}|[2-59]\\d{2,7})|9\\d{4,8})|60(?:[12]\\d{5,6}|6\\d{7})|7(?:1\\d{7}|3\\d{8}|5[03-9]\\d{2,7})", 
"\\d{5,10}", , , "10112345"], , , [, , "NA", "NA"]], AZ:[, [, , "[1-9]\\d{8}", "\\d{7,9}"], [, , "(?:1[28]\\d{3}|2(?:02|1[24]|2[2-4]|33|[45]2|6[23])\\d{2}|365(?:[0-46-9]\\d|5[0-35-9]))\\d{4}", "\\d{7,9}", , , "123123456"], [, , "(?:36554|(?:4[04]|5[015]|60|7[07])\\d{3})\\d{4}", "\\d{9}", , , "401234567"], [, , "88\\d{7}", "\\d{9}", , , "881234567"], [, , "900200\\d{3}", "\\d{9}", , , "900200123"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "AZ", 994, "00", "0", , , "0", , , , [[, "(\\d{2})(\\d{3})(\\d{2})(\\d{2})", 
"$1 $2 $3 $4", ["(?:1[28]|2(?:[45]2|[0-36])|365)"], "(0$1)"], [, "(\\d{2})(\\d{3})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[4-8]"], "0$1"], [, "(\\d{3})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["9"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], BA:[, [, , "[3-9]\\d{7,8}", "\\d{6,9}"], [, , "(?:[35]\\d|49)\\d{6}", "\\d{6,8}", , , "30123456"], [, , "6(?:03|44|71|[1-356])\\d{6}", "\\d{8,9}", , , "61123456"], [, , "8[08]\\d{6}", "\\d{8}", , , "80123456"], [, 
, "9[0246]\\d{6}", "\\d{8}", , , "90123456"], [, , "8[12]\\d{6}", "\\d{8}", , , "82123456"], [, , "NA", "NA"], [, , "NA", "NA"], "BA", 387, "00", "0", , , "0", , , , [[, "(\\d{2})(\\d{3})(\\d{3})", "$1 $2-$3", ["[3-5]"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["6[1-356]|[7-9]"], "0$1"], [, "(\\d{2})(\\d{2})(\\d{2})(\\d{3})", "$1 $2 $3 $4", ["6[047]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "70[23]\\d{5}", "\\d{8}", , , "70223456"], , , [, , "NA", "NA"]], BB:[, [, , "[2589]\\d{9}", 
"\\d{7}(?:\\d{3})?"], [, , "246(?:2(?:2[78]|7[0-4])|4(?:1[024-6]|2\\d|3[2-9])|5(?:20|[34]\\d|54|7[1-3])|6(?:2\\d|38)|7(?:37|57)|9(?:1[89]|63))\\d{4}", "\\d{7}(?:\\d{3})?", , , "2464123456"], [, , "246(?:2(?:[356]\\d|4[0-57-9]|8[0-79])|45\\d|8(?:[2-5]\\d|83))\\d{4}", "\\d{10}", , , "2462501234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002123456"], [, , "900\\d{7}|246976\\d{4}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", 
, , "5002345678"], [, , "24631\\d{5}", "\\d{10}", , , "2463101234"], "BB", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "246", [, , "NA", "NA"], [, , "246(?:292|41[7-9]|43[01])\\d{4}", "\\d{10}", , , "2464301234"], , , [, , "NA", "NA"]], BD:[, [, , "[2-79]\\d{5,9}|1\\d{9}|8[0-7]\\d{4,8}", "\\d{6,10}"], [, , "2(?:550\\d|7(?:1[0-267]|2[0-289]|3[0-29]|[46][01]|5[1-3]|7[017]|91)|8(?:0[125]|[139][1-6]|2[0157-9]|6[1-35]|7[1-5]|8[1-8]|90)|9(?:0[0-2]|1[0-4]|2[568]|3[3-6]|5[5-7]|6[0167]|7[15]|8[0146-8]))\\d{4}|3(?:12?[5-7]\\d{2}|0(?:2(?:[025-79]\\d|[348]\\d{1,2})|3(?:[2-4]\\d|[56]\\d?))|2(?:1\\d{2}|2(?:[12]\\d|[35]\\d{1,2}|4\\d?))|3(?:1\\d{2}|2(?:[2356]\\d|4\\d{1,2}))|4(?:1\\d{2}|2(?:2\\d{1,2}|[47]|5\\d{2}))|5(?:1\\d{2}|29)|[67]1\\d{2}|8(?:1\\d{2}|2(?:2\\d{2}|3|4\\d)))\\d{3}|4(?:0(?:2(?:[09]\\d|7)|33\\d{2})|1\\d{3}|2(?:1\\d{2}|2(?:[25]\\d?|[348]\\d|[67]\\d{1,2}))|3(?:1\\d{2}(?:\\d{2})?|2(?:[045]\\d|[236-9]\\d{1,2})|32\\d{2})|4(?:[18]\\d{2}|2(?:[2-46]\\d{2}|3)|5[25]\\d{2})|5(?:1\\d{2}|2(?:3\\d|5))|6(?:[18]\\d{2}|2(?:3(?:\\d{2})?|[46]\\d{1,2}|5\\d{2}|7\\d)|5(?:3\\d?|4\\d|[57]\\d{1,2}|6\\d{2}|8))|71\\d{2}|8(?:[18]\\d{2}|23\\d{2}|54\\d{2})|9(?:[18]\\d{2}|2[2-5]\\d{2}|53\\d{1,2}))\\d{3}|5(?:02[03489]\\d{2}|1\\d{2}|2(?:1\\d{2}|2(?:2(?:\\d{2})?|[457]\\d{2}))|3(?:1\\d{2}|2(?:[37](?:\\d{2})?|[569]\\d{2}))|4(?:1\\d{2}|2[46]\\d{2})|5(?:1\\d{2}|26\\d{1,2})|6(?:[18]\\d{2}|2|53\\d{2})|7(?:1|24)\\d{2}|8(?:1|26)\\d{2}|91\\d{2})\\d{3}|6(?:0(?:1\\d{2}|2(?:3\\d{2}|4\\d{1,2}))|2(?:2[2-5]\\d{2}|5(?:[3-5]\\d{2}|7)|8\\d{2})|3(?:1|2[3478])\\d{2}|4(?:1|2[34])\\d{2}|5(?:1|2[47])\\d{2}|6(?:[18]\\d{2}|6(?:2(?:2\\d|[34]\\d{2})|5(?:[24]\\d{2}|3\\d|5\\d{1,2})))|72[2-5]\\d{2}|8(?:1\\d{2}|2[2-5]\\d{2})|9(?:1\\d{2}|2[2-6]\\d{2}))\\d{3}|7(?:(?:02|[3-589]1|6[12]|72[24])\\d{2}|21\\d{3}|32)\\d{3}|8(?:(?:4[12]|[5-7]2|1\\d?)|(?:0|3[12]|[5-7]1|217)\\d)\\d{4}|9(?:[35]1|(?:[024]2|81)\\d|(?:1|[24]1)\\d{2})\\d{3}", 
"\\d{6,9}", , , "27111234"], [, , "(?:1[13-9]\\d|(?:3[78]|44)[02-9]|6(?:44|6[02-9]))\\d{7}", "\\d{10}", , , "1812345678"], [, , "80[03]\\d{7}", "\\d{10}", , , "8001234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "96(?:0[49]|1[0-4]|6[69])\\d{6}", "\\d{10}", , , "9604123456"], "BD", 880, "00", "0", , , "0", , , , [[, "(2)(\\d{7,8})", "$1-$2", ["2"], "0$1"], [, "(\\d{2})(\\d{4,6})", "$1-$2", ["[3-79]1"], "0$1"], [, "(\\d{4})(\\d{3,6})", "$1-$2", ["1|3(?:0|[2-58]2)|4(?:0|[25]2|3[23]|[4689][25])|5(?:[02-578]2|6[25])|6(?:[0347-9]2|[26][25])|7[02-9]2|8(?:[023][23]|[4-7]2)|9(?:[02][23]|[458]2|6[016])"], 
"0$1"], [, "(\\d{3})(\\d{3,7})", "$1-$2", ["[3-79][2-9]|8"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], BE:[, [, , "[1-9]\\d{7,8}", "\\d{8,9}"], [, , "(?:1[0-69]|[23][2-8]|4[23]|5\\d|6[013-57-9]|71|8[1-79]|9[2-4])\\d{6}|80[2-8]\\d{5}", "\\d{8}", , , "12345678"], [, , "4(?:6[0135-8]|[79]\\d|8[3-9])\\d{6}", "\\d{9}", , , "470123456"], [, , "800\\d{5}", "\\d{8}", , , "80012345"], [, , "(?:70[2-467]|90[0-79])\\d{5}", "\\d{8}", , , "90123456"], [, , "NA", 
"NA"], [, , "NA", "NA"], [, , "NA", "NA"], "BE", 32, "00", "0", , , "0", , , , [[, "(\\d{3})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["4[6-9]"], "0$1"], [, "(\\d)(\\d{3})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[23]|4[23]|9[2-4]"], "0$1"], [, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[156]|7[018]|8(?:0[1-9]|[1-79])"], "0$1"], [, "(\\d{3})(\\d{2})(\\d{3})", "$1 $2 $3", ["(?:80|9)0"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "78\\d{6}", "\\d{8}", , , "78123456"], , , [, , "NA", 
"NA"]], BF:[, [, , "[267]\\d{7}", "\\d{8}"], [, , "2(?:0(?:49|5[23]|9[016-9])|4(?:4[569]|5[4-6]|7[0179])|5(?:[34]\\d|50))\\d{4}", "\\d{8}", , , "20491234"], [, , "6(?:[0-689]\\d|7[0-5])\\d{5}|7\\d{7}", "\\d{8}", , , "70123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "BF", 226, "00", , , , , , , , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], BG:[, [, , 
"[23567]\\d{5,7}|[489]\\d{6,8}", "\\d{5,9}"], [, , "2\\d{5,7}|(?:[36]\\d|5[1-9]|8[1-6]|9[1-7])\\d{5,6}|(?:4(?:[124-7]\\d|3[1-6])|7(?:0[1-9]|[1-9]\\d))\\d{4,5}", "\\d{5,8}", , , "2123456"], [, , "(?:8[7-9]\\d|9(?:8\\d|99))\\d{6}|4(?:3[0789]|8\\d)\\d{5}", "\\d{8,9}", , , "48123456"], [, , "800\\d{5}", "\\d{8}", , , "80012345"], [, , "90\\d{6}", "\\d{8}", , , "90123456"], [, , "NA", "NA"], [, , "700\\d{5}", "\\d{5,9}", , , "70012345"], [, , "NA", "NA"], "BG", 359, "00", "0", , , "0", , , , [[, "(2)(\\d)(\\d{2})(\\d{2})", 
"$1 $2 $3 $4", ["2"], "0$1"], [, "(2)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["2"], "0$1"], [, "(\\d{3})(\\d{4})", "$1 $2", ["43[124-7]|70[1-9]"], "0$1"], [, "(\\d{3})(\\d{3})(\\d{2})", "$1 $2 $3", ["43[124-7]|70[1-9]"], "0$1"], [, "(\\d{3})(\\d{2})(\\d{3})", "$1 $2 $3", ["[78]00"], "0$1"], [, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3", ["999"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{2,3})", "$1 $2 $3", ["[356]|4[124-7]|7[1-9]|8[1-6]|9[1-7]"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{3,4})", "$1 $2 $3", ["48|8[7-9]|9[08]"], 
"0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], BH:[, [, , "[136-9]\\d{7}", "\\d{8}"], [, , "(?:1(?:3[1356]|6[0156]|7\\d)\\d|6(?:1[16]\\d|500|6(?:0\\d|3[12]|44|7[7-9])|9[69][69])|7(?:1(?:11|78)|7\\d{2}))\\d{4}", "\\d{8}", , , "17001234"], [, , "(?:3(?:[1-4679]\\d|5[013-69]|8[0-47-9])\\d|6(?:3(?:00|33|6[16])|6(?:[69]\\d|3[03-9]|7[0-6])))\\d{4}", "\\d{8}", , , "36001234"], [, , "80\\d{6}", "\\d{8}", , , "80123456"], [, , "(?:87|9[014578])\\d{6}", "\\d{8}", 
, , "90123456"], [, , "84\\d{6}", "\\d{8}", , , "84123456"], [, , "NA", "NA"], [, , "NA", "NA"], "BH", 973, "00", , , , , , , , [[, "(\\d{4})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], BI:[, [, , "[267]\\d{7}", "\\d{8}"], [, , "22\\d{6}", "\\d{8}", , , "22201234"], [, , "(?:29|6[189]|7[124-9])\\d{6}", "\\d{8}", , , "79561234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "BI", 257, "00", , , 
, , , , , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], BJ:[, [, , "[2689]\\d{7}|7\\d{3}", "\\d{4,8}"], [, , "2(?:02|1[037]|2[45]|3[68])\\d{5}", "\\d{8}", , , "20211234"], [, , "(?:6[1-8]|9[03-9])\\d{6}", "\\d{8}", , , "90011234"], [, , "7[3-5]\\d{2}", "\\d{4}", , , "7312"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "857[58]\\d{4}", "\\d{8}", , , "85751234"], "BJ", 229, "00", , , , , , , 
, [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "81\\d{6}", "\\d{8}", , , "81123456"], , , [, , "NA", "NA"]], BL:[, [, , "[56]\\d{8}", "\\d{9}"], [, , "590(?:2[7-9]|5[12]|87)\\d{4}", "\\d{9}", , , "590271234"], [, , "690(?:0[0-7]|[1-9]\\d)\\d{4}", "\\d{9}", , , "690301234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "BL", 590, "00", "0", , , "0", , , , , , [, , "NA", "NA"], , , [, , "NA", "NA"], 
[, , "NA", "NA"], , , [, , "NA", "NA"]], BM:[, [, , "[4589]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "441(?:2(?:02|23|61|[3479]\\d)|[46]\\d{2}|5(?:4\\d|60|89)|824)\\d{4}", "\\d{7}(?:\\d{3})?", , , "4412345678"], [, , "441(?:[37]\\d|5[0-39])\\d{5}", "\\d{10}", , , "4413701234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002123456"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], 
"BM", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "441", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], BN:[, [, , "[2-578]\\d{6}", "\\d{7}"], [, , "2(?:[013-9]\\d|2[0-7])\\d{4}|[3-5]\\d{6}", "\\d{7}", , , "2345678"], [, , "22[89]\\d{4}|[78]\\d{6}", "\\d{7}", , , "7123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "BN", 673, "00", , , , , , , , [[, "([2-578]\\d{2})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], 
[, , "NA", "NA"], , , [, , "NA", "NA"]], BO:[, [, , "[23467]\\d{7}", "\\d{7,8}"], [, , "(?:2(?:2\\d{2}|5(?:11|[258]\\d|9[67])|6(?:12|2\\d|9[34])|8(?:2[34]|39|62))|3(?:3\\d{2}|4(?:6\\d|8[24])|8(?:25|42|5[257]|86|9[25])|9(?:2\\d|3[234]|4[248]|5[24]|6[2-6]|7\\d))|4(?:4\\d{2}|6(?:11|[24689]\\d|72)))\\d{4}", "\\d{7,8}", , , "22123456"], [, , "[67]\\d{7}", "\\d{8}", , , "71234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "BO", 591, "00(1\\d)?", "0", , 
, "0(1\\d)?", , , , [[, "([234])(\\d{7})", "$1 $2", ["[234]"], , "0$CC $1"], [, "([67]\\d{7})", "$1", ["[67]"], , "0$CC $1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], BQ:[, [, , "[347]\\d{6}", "\\d{7}"], [, , "(?:318[023]|416[023]|7(?:1[578]|50)\\d)\\d{3}", "\\d{7}", , , "7151234"], [, , "(?:318[14-68]|416[15-9]|7(?:0[01]|7[07]|[89]\\d)\\d)\\d{3}", "\\d{7}", , , "3181234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", 
"NA"], "BQ", 599, "00", , , , , , , , , , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], BR:[, [, , "[1-46-9]\\d{7,10}|5\\d{8,9}", "\\d{8,11}"], [, , "(?:[14689][1-9]|2[12478]|3[1-578]|5[1-5]|7[13-579])[2-5]\\d{7}", "\\d{8,11}", , , "1123456789"], [, , "1[1-9](?:7|9\\d)\\d{7}|(?:2[12478]|3[1-578]|[689][1-9]|7[13-579])(?:[6-8]|9\\d?)\\d{7}|(?:4[1-9]|5[1-5])[6-9]\\d{7}", "\\d{10,11}", , , "11961234567"], [, , "800\\d{6,7}", "\\d{8,11}", , , "800123456"], [, , "(?:300|[59]00\\d?)\\d{6}", 
"\\d{8,11}", , , "300123456"], [, , "(?:300\\d(?:\\d{2})?|40(?:0\\d|20))\\d{4}", "\\d{8,10}", , , "40041234"], [, , "NA", "NA"], [, , "NA", "NA"], "BR", 55, "00(?:1[245]|2[1-35]|31|4[13]|[56]5|99)", "0", , , "0(?:(1[245]|2[1-35]|31|4[13]|[56]5|99)(\\d{10,11}))?", "$2", , , [[, "(\\d{4})(\\d{4})", "$1-$2", ["[2-9](?:[1-9]|0[1-9])"], "$1"], [, "(\\d{5})(\\d{4})", "$1-$2", ["9(?:[1-9]|0[1-9])"], "$1"], [, "(\\d{3,5})", "$1", ["1[125689]"], "$1"], [, "(\\d{2})(\\d{5})(\\d{4})", "$1 $2-$3", ["(?:[1689][1-9]|2[12478]|3[1-578]|7[13-579])9"], 
"($1)", "0 $CC ($1)"], [, "(\\d{2})(\\d{4})(\\d{4})", "$1 $2-$3", ["[1-9][1-9]"], "($1)", "0 $CC ($1)"], [, "(\\d{4})(\\d{4})", "$1-$2", ["(?:300|40(?:0|20))"]], [, "([3589]00)(\\d{2,3})(\\d{4})", "$1 $2 $3", ["[3589]00"], "0$1"]], [[, "(\\d{2})(\\d{5})(\\d{4})", "$1 $2-$3", ["(?:[1689][1-9]|2[12478]|3[1-578]|7[13-579])9"], "($1)", "0 $CC ($1)"], [, "(\\d{2})(\\d{4})(\\d{4})", "$1 $2-$3", ["[1-9][1-9]"], "($1)", "0 $CC ($1)"], [, "(\\d{4})(\\d{4})", "$1-$2", ["(?:300|40(?:0|20))"]], [, "([3589]00)(\\d{2,3})(\\d{4})", 
"$1 $2 $3", ["[3589]00"], "0$1"]], [, , "NA", "NA"], , , [, , "(?:300\\d|40(?:0\\d|20))\\d{4}", "\\d{8}", , , "40041234"], [, , "NA", "NA"], , , [, , "NA", "NA"]], BS:[, [, , "[2589]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "242(?:3(?:02|[236][1-9]|4[0-24-9]|5[0-68]|7[3467]|8[0-4]|9[2-467])|461|502|6(?:0[1-3]|12|7[67]|8[78]|9[89])|7(?:02|88))\\d{4}", "\\d{7}(?:\\d{3})?", , , "2423456789"], [, , "242(?:3(?:5[79]|[79]5)|4(?:[2-4][1-9]|5[1-8]|6[2-8]|7\\d|81)|5(?:2[45]|3[35]|44|5[1-9]|65|77)|6[34]6|727)\\d{4}", 
"\\d{10}", , , "2423591234"], [, , "242300\\d{4}|8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002123456"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "BS", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "242", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], BT:[, [, , "[1-8]\\d{6,7}", "\\d{6,8}"], [, , "(?:2[3-6]|[34][5-7]|5[236]|6[2-46]|7[246]|8[2-4])\\d{5}", 
"\\d{6,7}", , , "2345678"], [, , "(?:1[67]|77)\\d{6}", "\\d{8}", , , "17123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "BT", 975, "00", , , , , , , , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["1|77"]], [, "([2-8])(\\d{3})(\\d{3})", "$1 $2 $3", ["[2-68]|7[246]"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], BW:[, [, , "[2-79]\\d{6,7}", "\\d{7,8}"], [, , "(?:2(?:4[0-48]|6[0-24]|9[0578])|3(?:1[0235-9]|55|[69]\\d|7[01])|4(?:6[03]|7[1267]|9[0-5])|5(?:3[0389]|4[0489]|7[1-47]|88|9[0-49])|6(?:2[1-35]|5[149]|8[067]))\\d{4}", 
"\\d{7}", , , "2401234"], [, , "7(?:[1-6]\\d|7[014-8])\\d{5}", "\\d{8}", , , "71123456"], [, , "NA", "NA"], [, , "90\\d{5}", "\\d{7}", , , "9012345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "79[12][01]\\d{4}", "\\d{8}", , , "79101234"], "BW", 267, "00", , , , , , , , [[, "(\\d{3})(\\d{4})", "$1 $2", ["[2-6]"]], [, "(7\\d)(\\d{3})(\\d{3})", "$1 $2 $3", ["7"]], [, "(90)(\\d{5})", "$1 $2", ["9"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], BY:[, [, , "[1-4]\\d{8}|800\\d{3,7}|[89]\\d{9,10}", 
"\\d{6,11}"], [, , "(?:1(?:5(?:1[1-5]|[24]\\d|6[2-4]|9[1-7])|6(?:[235]\\d|4[1-7])|7\\d{2})|2(?:1(?:[246]\\d|3[0-35-9]|5[1-9])|2(?:[235]\\d|4[0-8])|3(?:[26]\\d|3[02-79]|4[024-7]|5[03-7])))\\d{5}", "\\d{6,11}", , , "152450911"], [, , "(?:2(?:5[5679]|9[1-9])|33\\d|44\\d)\\d{6}", "\\d{9}", , , "294911911"], [, , "8(?:0[13]|20\\d)\\d{7}|800\\d{3,7}", "\\d{6,11}", , , "8011234567"], [, , "(?:810|902)\\d{7}", "\\d{10}", , , "9021234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "249\\d{6}", "\\d{9}", , 
, "249123456"], "BY", 375, "810", "8", , , "8?0?", , "8~10", , [[, "(\\d{2})(\\d{3})(\\d{2})(\\d{2})", "$1 $2-$3-$4", ["17[0-3589]|2[4-9]|[34]", "17(?:[02358]|1[0-2]|9[0189])|2[4-9]|[34]"], "8 0$1"], [, "(\\d{3})(\\d{2})(\\d{2})(\\d{2})", "$1 $2-$3-$4", ["1(?:5[24]|6[235]|7[467])|2(?:1[246]|2[25]|3[26])", "1(?:5[24]|6(?:2|3[04-9]|5[0346-9])|7(?:[46]|7[37-9]))|2(?:1[246]|2[25]|3[26])"], "8 0$1"], [, "(\\d{4})(\\d{2})(\\d{3})", "$1 $2-$3", ["1(?:5[169]|6[3-5]|7[179])|2(?:1[35]|2[34]|3[3-5])", "1(?:5[169]|6(?:3[1-3]|4|5[125])|7(?:1[3-9]|7[0-24-6]|9[2-7]))|2(?:1[35]|2[34]|3[3-5])"], 
"8 0$1"], [, "([89]\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["8[01]|9"], "8 $1"], [, "(82\\d)(\\d{4})(\\d{4})", "$1 $2 $3", ["82"], "8 $1"], [, "(800)(\\d{3})", "$1 $2", ["800"], "8 $1"], [, "(800)(\\d{2})(\\d{2,4})", "$1 $2 $3", ["800"], "8 $1"]], , [, , "NA", "NA"], , , [, , "8(?:[013]|[12]0)\\d{8}|800\\d{3,7}|902\\d{7}", "\\d{6,11}", , , "82012345678"], [, , "NA", "NA"], , , [, , "NA", "NA"]], BZ:[, [, , "[2-8]\\d{6}|0\\d{10}", "\\d{7}(?:\\d{4})?"], [, , "(?:[23458][02]\\d|7(?:[02]\\d|32))\\d{4}", 
"\\d{7}", , , "2221234"], [, , "6[0-35-7]\\d{5}", "\\d{7}", , , "6221234"], [, , "0800\\d{7}", "\\d{11}", , , "08001234123"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "BZ", 501, "00", , , , , , , , [[, "(\\d{3})(\\d{4})", "$1-$2", ["[2-8]"]], [, "(0)(800)(\\d{4})(\\d{3})", "$1-$2-$3-$4", ["0"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]], CA:[, [, , "[2-9]\\d{9}|3\\d{6}", "\\d{7}(?:\\d{3})?"], [, , "(?:2(?:04|[23]6|[48]9|50)|3(?:06|43|65)|4(?:03|1[68]|3[178]|50)|5(?:06|1[49]|48|79|8[17])|6(?:0[04]|13|22|39|47)|7(?:0[59]|78|8[02])|8(?:[06]7|19|25|73)|90[25])[2-9]\\d{6}|310\\d{4}", 
"\\d{7}(?:\\d{3})?", , , "2042345678"], [, , "(?:2(?:04|[23]6|[48]9|50)|3(?:06|43|65)|4(?:03|1[68]|3[178]|50)|5(?:06|1[49]|48|79|8[17])|6(?:0[04]|13|22|39|47)|7(?:0[59]|78|8[02])|8(?:[06]7|19|25|73)|90[25])[2-9]\\d{6}", "\\d{7}(?:\\d{3})?", , , "2042345678"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}|310\\d{4}", "\\d{7}(?:\\d{3})?", , , "8002123456"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", 
"NA"], "CA", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], CC:[, [, , "[1458]\\d{5,9}", "\\d{6,10}"], [, , "89162\\d{4}", "\\d{8,9}", , , "891621234"], [, , "14(?:5\\d|71)\\d{5}|4(?:[0-2]\\d|3[0-57-9]|4[47-9]|5[0-25-9]|6[6-9]|7[02-9]|8[147-9]|9[017-9])\\d{6}", "\\d{9}", , , "412345678"], [, , "180(?:0\\d{3}|2)\\d{3}", "\\d{7,10}", , , "1800123456"], [, , "190[0126]\\d{6}", "\\d{10}", , , "1900123456"], [, , "13(?:00\\d{2})?\\d{4}", 
"\\d{6,10}", , , "1300123456"], [, , "500\\d{6}", "\\d{9}", , , "500123456"], [, , "550\\d{6}", "\\d{9}", , , "550123456"], "CC", 61, "(?:14(?:1[14]|34|4[17]|[56]6|7[47]|88))?001[14-689]", "0", , , "0", , "0011", , , , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], CD:[, [, , "[2-6]\\d{6}|[18]\\d{6,8}|9\\d{8}", "\\d{7,9}"], [, , "1(?:2\\d{7}|\\d{6})|[2-6]\\d{6}", "\\d{7,9}", , , "1234567"], [, , "8(?:[0-2459]\\d{2}|8)\\d{5}|9[7-9]\\d{7}", "\\d{7,9}", , , "991234567"], 
[, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "CD", 243, "00", "0", , , "0", , , , [[, "(\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["12"], "0$1"], [, "([89]\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["8[0-2459]|9"], "0$1"], [, "(\\d{2})(\\d{2})(\\d{3})", "$1 $2 $3", ["88"], "0$1"], [, "(\\d{2})(\\d{5})", "$1 $2", ["[1-6]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], CF:[, [, , "[278]\\d{7}", "\\d{8}"], [, , "2[12]\\d{6}", 
"\\d{8}", , , "21612345"], [, , "7[0257]\\d{6}", "\\d{8}", , , "70012345"], [, , "NA", "NA"], [, , "8776\\d{4}", "\\d{8}", , , "87761234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "CF", 236, "00", , , , , , , , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], CG:[, [, , "[028]\\d{8}", "\\d{9}"], [, , "222[1-589]\\d{5}", "\\d{9}", , , "222123456"], [, , "0[14-6]\\d{7}", "\\d{9}", , , "061234567"], 
[, , "NA", "NA"], [, , "800\\d{6}", "\\d{9}", , , "800123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "CG", 242, "00", , , , , , , , [[, "(\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["[02]"]], [, "(\\d)(\\d{4})(\\d{4})", "$1 $2 $3", ["8"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]], CH:[, [, , "[2-9]\\d{8}|860\\d{9}", "\\d{9}(?:\\d{3})?"], [, , "(?:2[12467]|3[1-4]|4[134]|5[256]|6[12]|[7-9]1)\\d{7}", "\\d{9}", , , "212345678"], [, , "7[5-9]\\d{7}", 
"\\d{9}", , , "781234567"], [, , "800\\d{6}", "\\d{9}", , , "800123456"], [, , "90[016]\\d{6}", "\\d{9}", , , "900123456"], [, , "84[0248]\\d{6}", "\\d{9}", , , "840123456"], [, , "878\\d{6}", "\\d{9}", , , "878123456"], [, , "NA", "NA"], "CH", 41, "00", "0", , , "0", , , , [[, "([2-9]\\d)(\\d{3})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[2-7]|[89]1"], "0$1"], [, "([89]\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["8[047]|90"], "0$1"], [, "(\\d{3})(\\d{2})(\\d{3})(\\d{2})(\\d{2})", "$1 $2 $3 $4 $5", ["860"], 
"0$1"]], , [, , "74[0248]\\d{6}", "\\d{9}", , , "740123456"], , , [, , "NA", "NA"], [, , "5[18]\\d{7}", "\\d{9}", , , "581234567"], , , [, , "860\\d{9}", "\\d{12}", , , "860123456789"]], CI:[, [, , "[02-8]\\d{7}", "\\d{8}"], [, , "(?:2(?:0[023]|1[02357]|[23][045]|4[03-5])|3(?:0[06]|1[069]|[2-4][07]|5[09]|6[08]))\\d{5}", "\\d{8}", , , "21234567"], [, , "(?:0[1-9]|4\\d|5[14-9]|6[015-79]|7[578]|8[79])\\d{6}", "\\d{8}", , , "01234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", 
"NA"], [, , "NA", "NA"], "CI", 225, "00", , , , , , , , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]], CK:[, [, , "[2-8]\\d{4}", "\\d{5}"], [, , "(?:2\\d|3[13-7]|4[1-5])\\d{3}", "\\d{5}", , , "21234"], [, , "[5-8]\\d{4}", "\\d{5}", , , "71234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "CK", 682, "00", , , , , , , , [[, "(\\d{2})(\\d{3})", "$1 $2"]], , [, 
, "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], CL:[, [, , "(?:[2-9]|600|123)\\d{7,8}", "\\d{7,11}"], [, , "2(?:1962\\d{4}|2\\d{7}|32[0-2]\\d{5})|(?:3[2-5]|[47][1-35]|5[1-3578]|6[13-57])\\d{7}", "\\d{7,9}", , , "221234567"], [, , "9[4-9]\\d{7}", "\\d{8,9}", , , "961234567"], [, , "800\\d{6}|1230\\d{7}", "\\d{9,11}", , , "800123456"], [, , "NA", "NA"], [, , "600\\d{7,8}", "\\d{10,11}", , , "6001234567"], [, , "NA", "NA"], [, , "44\\d{7}", "\\d{9}", , , "441234567"], "CL", 
56, "(?:0|1(?:1[0-69]|2[0-57]|5[13-58]|69|7[0167]|8[018]))0", "0", , , "0|(1(?:1[0-69]|2[0-57]|5[13-58]|69|7[0167]|8[018]))", , , , [[, "(\\d)(\\d{4})(\\d{4})", "$1 $2 $3", ["2[23]"], "($1)", "$CC ($1)"], [, "(\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["[357]|4[1-35]|6[13-57]"], "($1)", "$CC ($1)"], [, "(9)(\\d{4})(\\d{4})", "$1 $2 $3", ["9"], "0$1"], [, "(44)(\\d{3})(\\d{4})", "$1 $2 $3", ["44"], "0$1"], [, "([68]00)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["60|8"], "$1"], [, "(600)(\\d{3})(\\d{2})(\\d{3})", 
"$1 $2 $3 $4", ["60"], "$1"], [, "(1230)(\\d{3})(\\d{4})", "$1 $2 $3", ["1"], "$1"], [, "(\\d{5})(\\d{4})", "$1 $2", ["219"], "($1)", "$CC ($1)"], [, "(\\d{4,5})", "$1", ["[1-9]"], "$1"]], [[, "(\\d)(\\d{4})(\\d{4})", "$1 $2 $3", ["2[23]"], "($1)", "$CC ($1)"], [, "(\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["[357]|4[1-35]|6[13-57]"], "($1)", "$CC ($1)"], [, "(9)(\\d{4})(\\d{4})", "$1 $2 $3", ["9"], "0$1"], [, "(44)(\\d{3})(\\d{4})", "$1 $2 $3", ["44"], "0$1"], [, "([68]00)(\\d{3})(\\d{3,4})", "$1 $2 $3", 
["60|8"], "$1"], [, "(600)(\\d{3})(\\d{2})(\\d{3})", "$1 $2 $3 $4", ["60"], "$1"], [, "(1230)(\\d{3})(\\d{4})", "$1 $2 $3", ["1"], "$1"], [, "(\\d{5})(\\d{4})", "$1 $2", ["219"], "($1)", "$CC ($1)"]], [, , "NA", "NA"], , , [, , "600\\d{7,8}", "\\d{10,11}", , , "6001234567"], [, , "NA", "NA"], , , [, , "NA", "NA"]], CM:[, [, , "[2368]\\d{7,8}", "\\d{8,9}"], [, , "2(?:22|33|4[23])\\d{6}", "\\d{9}", , , "222123456"], [, , "6[5-9]\\d{7}", "\\d{9}", , , "671234567"], [, , "800\\d{5}", "\\d{8}", , , "80012345"], 
[, , "88\\d{6}", "\\d{8}", , , "88012345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "CM", 237, "00", , , , , , , , [[, "([26])(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4 $5", ["[26]"]], [, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[23]|88"]], [, "(800)(\\d{2})(\\d{3})", "$1 $2 $3", ["80"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], CN:[, [, , "[1-7]\\d{6,11}|8[0-357-9]\\d{6,9}|9\\d{7,10}", "\\d{4,12}"], [, , "21(?:100\\d{2}|95\\d{3,4}|\\d{8,10})|(?:10|2[02-57-9]|3(?:11|7[179])|4(?:[15]1|3[1-35])|5(?:1\\d|2[37]|3[12]|51|7[13-79]|9[15])|7(?:31|5[457]|6[09]|91)|8(?:[57]1|98))(?:100\\d{2}|95\\d{3,4}|\\d{8})|(?:3(?:1[02-9]|35|49|5\\d|7[02-68]|9[1-68])|4(?:1[02-9]|2[179]|3[3-9]|5[2-9]|6[4789]|7\\d|8[23])|5(?:3[03-9]|4[36]|5[02-9]|6[1-46]|7[028]|80|9[2-46-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[17]\\d|2[248]|3[04-9]|4[3-6]|5[0-4689]|6[2368]|9[02-9])|8(?:078|1[236-8]|2[5-7]|3\\d|5[1-9]|7[02-9]|8[3678]|9[1-7])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))(?:100\\d{2}|95\\d{3,4}|\\d{7})|80(?:29|6[03578]|7[018]|81)\\d{4}", 
"\\d{4,12}", , , "1012345678"], [, , "1(?:[38]\\d|4[57]|5[0-35-9]|7[0136-8])\\d{8}", "\\d{11}", , , "13123456789"], [, , "(?:10)?800\\d{7}", "\\d{10,12}", , , "8001234567"], [, , "16[08]\\d{5}", "\\d{8}", , , "16812345"], [, , "400\\d{7}|950\\d{7,8}|(?:10|2[0-57-9]|3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[4789]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[14-9]|8[3678]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))96\\d{3,4}", 
"\\d{7,11}", , , "4001234567"], [, , "NA", "NA"], [, , "NA", "NA"], "CN", 86, "(1(?:[129]\\d{3}|79\\d{2}))?00", "0", , , "(1(?:[129]\\d{3}|79\\d{2}))|0", , "00", , [[, "(80\\d{2})(\\d{4})", "$1 $2", ["80[2678]"], "0$1", "$CC $1", 1], [, "([48]00)(\\d{3})(\\d{4})", "$1 $2 $3", ["[48]00"]], [, "(\\d{5,6})", "$1", ["100|95"]], [, "(\\d{2})(\\d{5,6})", "$1 $2", ["(?:10|2\\d)[19]", "(?:10|2\\d)(?:10|9[56])", "(?:10|2\\d)(?:100|9[56])"], "0$1", "$CC $1"], [, "(\\d{3})(\\d{5,6})", "$1 $2", ["[3-9]", "[3-9]\\d{2}[19]", 
"[3-9]\\d{2}(?:10|9[56])"], "0$1", "$CC $1"], [, "(\\d{3,4})(\\d{4})", "$1 $2", ["[2-9]"]], [, "(21)(\\d{4})(\\d{4,6})", "$1 $2 $3", ["21"], "0$1", "$CC $1", 1], [, "([12]\\d)(\\d{4})(\\d{4})", "$1 $2 $3", ["10[1-9]|2[02-9]", "10[1-9]|2[02-9]", "10(?:[1-79]|8(?:[1-9]|0[1-9]))|2[02-9]"], "0$1", "$CC $1", 1], [, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["3(?:1[02-9]|35|49|5|7[02-68]|9[1-68])|4(?:1[02-9]|2[179]|[35][2-9]|6[4789]|7\\d|8[23])|5(?:3[03-9]|4[36]|5[02-9]|6[1-46]|7[028]|80|9[2-46-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]|2[248]|3[04-9]|4[3-6]|6[2368])|8(?:1[236-8]|2[5-7]|3|5[1-9]|7[02-9]|8[3678]|9[1-7])|9(?:0[1-3689]|1[1-79]|[379]|4[13]|5[1-5])"], 
"0$1", "$CC $1", 1], [, "(\\d{3})(\\d{4})(\\d{4})", "$1 $2 $3", ["3(?:11|7[179])|4(?:[15]1|3[1-35])|5(?:1|2[37]|3[12]|51|7[13-79]|9[15])|7(?:31|5[457]|6[09]|91)|8(?:[57]1|98)"], "0$1", "$CC $1", 1], [, "(\\d{4})(\\d{3})(\\d{4})", "$1 $2 $3", ["807", "8078"], "0$1", "$CC $1", 1], [, "(\\d{3})(\\d{4})(\\d{4})", "$1 $2 $3", ["1[3-578]"], , "$CC $1"], [, "(10800)(\\d{3})(\\d{4})", "$1 $2 $3", ["108", "1080", "10800"]], [, "(\\d{3})(\\d{7,8})", "$1 $2", ["950"]]], [[, "(80\\d{2})(\\d{4})", "$1 $2", ["80[2678]"], 
"0$1", "$CC $1", 1], [, "([48]00)(\\d{3})(\\d{4})", "$1 $2 $3", ["[48]00"]], [, "(\\d{2})(\\d{5,6})", "$1 $2", ["(?:10|2\\d)[19]", "(?:10|2\\d)(?:10|9[56])", "(?:10|2\\d)(?:100|9[56])"], "0$1", "$CC $1"], [, "(\\d{3})(\\d{5,6})", "$1 $2", ["[3-9]", "[3-9]\\d{2}[19]", "[3-9]\\d{2}(?:10|9[56])"], "0$1", "$CC $1"], [, "(21)(\\d{4})(\\d{4,6})", "$1 $2 $3", ["21"], "0$1", "$CC $1", 1], [, "([12]\\d)(\\d{4})(\\d{4})", "$1 $2 $3", ["10[1-9]|2[02-9]", "10[1-9]|2[02-9]", "10(?:[1-79]|8(?:[1-9]|0[1-9]))|2[02-9]"], 
"0$1", "$CC $1", 1], [, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["3(?:1[02-9]|35|49|5|7[02-68]|9[1-68])|4(?:1[02-9]|2[179]|[35][2-9]|6[4789]|7\\d|8[23])|5(?:3[03-9]|4[36]|5[02-9]|6[1-46]|7[028]|80|9[2-46-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]|2[248]|3[04-9]|4[3-6]|6[2368])|8(?:1[236-8]|2[5-7]|3|5[1-9]|7[02-9]|8[3678]|9[1-7])|9(?:0[1-3689]|1[1-79]|[379]|4[13]|5[1-5])"], "0$1", "$CC $1", 1], [, "(\\d{3})(\\d{4})(\\d{4})", "$1 $2 $3", ["3(?:11|7[179])|4(?:[15]1|3[1-35])|5(?:1|2[37]|3[12]|51|7[13-79]|9[15])|7(?:31|5[457]|6[09]|91)|8(?:[57]1|98)"], 
"0$1", "$CC $1", 1], [, "(\\d{4})(\\d{3})(\\d{4})", "$1 $2 $3", ["807", "8078"], "0$1", "$CC $1", 1], [, "(\\d{3})(\\d{4})(\\d{4})", "$1 $2 $3", ["1[3-578]"], , "$CC $1"], [, "(10800)(\\d{3})(\\d{4})", "$1 $2 $3", ["108", "1080", "10800"]], [, "(\\d{3})(\\d{7,8})", "$1 $2", ["950"]]], [, , "NA", "NA"], , , [, , "(?:4|(?:10)?8)00\\d{7}|950\\d{7,8}", "\\d{10,12}", , , "4001234567"], [, , "NA", "NA"], , , [, , "NA", "NA"]], CO:[, [, , "(?:[13]\\d{0,3}|[24-8])\\d{7}", "\\d{7,11}"], [, , "[124-8][2-9]\\d{6}", 
"\\d{8}", , , "12345678"], [, , "3(?:0[0-5]|1\\d|2[0-3]|5[01])\\d{7}", "\\d{10}", , , "3211234567"], [, , "1800\\d{7}", "\\d{11}", , , "18001234567"], [, , "19(?:0[01]|4[78])\\d{7}", "\\d{11}", , , "19001234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "CO", 57, "00(?:4(?:[14]4|56)|[579])", "0", , , "0([3579]|4(?:44|56))?", , , , [[, "(\\d)(\\d{7})", "$1 $2", ["1(?:8[2-9]|9[0-3]|[2-7])|[24-8]", "1(?:8[2-9]|9(?:09|[1-3])|[2-7])|[24-8]"], "($1)", "0$CC $1"], [, "(\\d{3})(\\d{7})", "$1 $2", 
["3"], , "0$CC $1"], [, "(1)(\\d{3})(\\d{7})", "$1-$2-$3", ["1(?:80|9[04])", "1(?:800|9(?:0[01]|4[78]))"], "0$1"]], [[, "(\\d)(\\d{7})", "$1 $2", ["1(?:8[2-9]|9[0-3]|[2-7])|[24-8]", "1(?:8[2-9]|9(?:09|[1-3])|[2-7])|[24-8]"], "($1)", "0$CC $1"], [, "(\\d{3})(\\d{7})", "$1 $2", ["3"], , "0$CC $1"], [, "(1)(\\d{3})(\\d{7})", "$1 $2 $3", ["1(?:80|9[04])", "1(?:800|9(?:0[01]|4[78]))"]]], [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], CR:[, [, , "[24-9]\\d{7,9}", "\\d{8,10}"], 
[, , "2[0-24-7]\\d{6}", "\\d{8}", , , "22123456"], [, , "5(?:0[01]|7[0-3])\\d{5}|(?:[67][0-3]|8[3-9])\\d{6}", "\\d{8}", , , "83123456"], [, , "800\\d{7}", "\\d{10}", , , "8001234567"], [, , "90[059]\\d{7}", "\\d{10}", , , "9001234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "210[0-6]\\d{4}|4\\d{7}|5100\\d{4}", "\\d{8}", , , "40001234"], "CR", 506, "00", , , , "(19(?:0[012468]|1[09]|20|66|77|99))", , , , [[, "(\\d{4})(\\d{4})", "$1 $2", ["[24-7]|8[3-9]"], , "$CC $1"], [, "(\\d{3})(\\d{3})(\\d{4})", 
"$1-$2-$3", ["[89]0"], , "$CC $1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], CU:[, [, , "[2-57]\\d{5,7}", "\\d{4,8}"], [, , "2[1-4]\\d{5,6}|3(?:1\\d{6}|[23]\\d{4,6})|4(?:[125]\\d{5,6}|[36]\\d{6}|[78]\\d{4,6})|7\\d{6,7}", "\\d{4,8}", , , "71234567"], [, , "5\\d{7}", "\\d{8}", , , "51234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "CU", 53, "119", "0", , , "0", , , , [[, "(\\d)(\\d{6,7})", "$1 $2", ["7"], 
"(0$1)"], [, "(\\d{2})(\\d{4,6})", "$1 $2", ["[2-4]"], "(0$1)"], [, "(\\d)(\\d{7})", "$1 $2", ["5"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], CV:[, [, , "[259]\\d{6}", "\\d{7}"], [, , "2(?:2[1-7]|3[0-8]|4[12]|5[1256]|6\\d|7[1-3]|8[1-5])\\d{4}", "\\d{7}", , , "2211234"], [, , "(?:9\\d|59)\\d{5}", "\\d{7}", , , "9911234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "CV", 238, "0", , , , , , , , [[, "(\\d{3})(\\d{2})(\\d{2})", 
"$1 $2 $3"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], CW:[, [, , "[169]\\d{6,7}", "\\d{7,8}"], [, , "9(?:[48]\\d{2}|50\\d|7(?:2[0-24]|[34]\\d|6[35-7]|77|8[7-9]))\\d{4}", "\\d{7,8}", , , "94151234"], [, , "9(?:5(?:[12467]\\d|3[01])|6(?:[15-9]\\d|3[01]))\\d{4}", "\\d{7,8}", , , "95181234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "60[0-2]\\d{4}", "\\d{7}", , , "6001234"], [, , "NA", "NA"], [, , "NA", "NA"], "CW", 599, "00", , , , , , , , [[, "(\\d{3})(\\d{4})", 
"$1 $2", ["[13-7]"]], [, "(9)(\\d{3})(\\d{4})", "$1 $2 $3", ["9"]]], , [, , "955\\d{5}", "\\d{7,8}", , , "95581234"], 1, , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], CX:[, [, , "[1458]\\d{5,9}", "\\d{6,10}"], [, , "89164\\d{4}", "\\d{8,9}", , , "891641234"], [, , "14(?:5\\d|71)\\d{5}|4(?:[0-2]\\d|3[0-57-9]|4[47-9]|5[0-25-9]|6[6-9]|7[02-9]|8[147-9]|9[017-9])\\d{6}", "\\d{9}", , , "412345678"], [, , "180(?:0\\d{3}|2)\\d{3}", "\\d{7,10}", , , "1800123456"], [, , "190[0126]\\d{6}", "\\d{10}", 
, , "1900123456"], [, , "13(?:00\\d{2})?\\d{4}", "\\d{6,10}", , , "1300123456"], [, , "500\\d{6}", "\\d{9}", , , "500123456"], [, , "550\\d{6}", "\\d{9}", , , "550123456"], "CX", 61, "(?:14(?:1[14]|34|4[17]|[56]6|7[47]|88))?001[14-689]", "0", , , "0", , "0011", , , , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], CY:[, [, , "[257-9]\\d{7}", "\\d{8}"], [, , "2[2-6]\\d{6}", "\\d{8}", , , "22345678"], [, , "9[4-79]\\d{6}", "\\d{8}", , , "96123456"], [, , "800\\d{5}", 
"\\d{8}", , , "80001234"], [, , "90[09]\\d{5}", "\\d{8}", , , "90012345"], [, , "80[1-9]\\d{5}", "\\d{8}", , , "80112345"], [, , "700\\d{5}", "\\d{8}", , , "70012345"], [, , "NA", "NA"], "CY", 357, "00", , , , , , , , [[, "(\\d{2})(\\d{6})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "(?:50|77)\\d{6}", "\\d{8}", , , "77123456"], , , [, , "NA", "NA"]], CZ:[, [, , "[2-8]\\d{8}|9\\d{8,11}", "\\d{9,12}"], [, , "2\\d{8}|(?:3[1257-9]|4[16-9]|5[13-9])\\d{7}", "\\d{9,12}", , , "212345678"], 
[, , "(?:60[1-8]|7(?:0[2-5]|[2379]\\d))\\d{6}", "\\d{9,12}", , , "601123456"], [, , "800\\d{6}", "\\d{9,12}", , , "800123456"], [, , "9(?:0[05689]|76)\\d{6}", "\\d{9,12}", , , "900123456"], [, , "8[134]\\d{7}", "\\d{9,12}", , , "811234567"], [, , "70[01]\\d{6}", "\\d{9,12}", , , "700123456"], [, , "9[17]0\\d{6}", "\\d{9,12}", , , "910123456"], "CZ", 420, "00", , , , , , , , [[, "([2-9]\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["[2-8]|9[015-7]"]], [, "(96\\d)(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3 $4", ["96"]], 
[, "(9\\d)(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3 $4", ["9[36]"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "9(?:5\\d|7[234])\\d{6}", "\\d{9,12}", , , "972123456"], , , [, , "9(?:3\\d{9}|6\\d{7,10})", "\\d{9,12}", , , "93123456789"]], DE:[, [, , "[1-35-9]\\d{3,14}|4(?:[0-8]\\d{4,12}|9(?:[0-37]\\d|4(?:[1-35-8]|4\\d?)|5\\d{1,2}|6[1-8]\\d?)\\d{2,8})", "\\d{2,15}"], [, , "[246]\\d{5,13}|3(?:0\\d{3,13}|2\\d{9}|[3-9]\\d{4,13})|5(?:0[2-8]|[1256]\\d|[38][0-8]|4\\d{0,2}|[79][0-7])\\d{3,11}|7(?:0[2-8]|[1-9]\\d)\\d{3,10}|8(?:0[2-9]|[1-9]\\d)\\d{3,10}|9(?:0[6-9]\\d{3,10}|1\\d{4,12}|[2-9]\\d{4,11})", 
"\\d{2,15}", , , "30123456"], [, , "1(?:5[0-25-9]\\d{8}|6[023]\\d{7,8}|7(?:[0-57-9]\\d?|6\\d)\\d{7})", "\\d{10,11}", , , "15123456789"], [, , "800\\d{7,12}", "\\d{10,15}", , , "8001234567890"], [, , "137[7-9]\\d{6}|900(?:[135]\\d{6}|9\\d{7})", "\\d{10,11}", , , "9001234567"], [, , "1(?:3(?:7[1-6]\\d{6}|8\\d{4})|80\\d{5,11})", "\\d{7,14}", , , "18012345"], [, , "700\\d{8}", "\\d{11}", , , "70012345678"], [, , "NA", "NA"], "DE", 49, "00", "0", , , "0", , , , [[, "(1\\d{2})(\\d{7,8})", "$1 $2", ["1[67]"], 
"0$1"], [, "(15\\d{3})(\\d{6})", "$1 $2", ["15[0568]"], "0$1"], [, "(1\\d{3})(\\d{7})", "$1 $2", ["15"], "0$1"], [, "(\\d{2})(\\d{3,11})", "$1 $2", ["3[02]|40|[68]9"], "0$1"], [, "(\\d{3})(\\d{3,11})", "$1 $2", ["2(?:\\d1|0[2389]|1[24]|28|34)|3(?:[3-9][15]|40)|[4-8][1-9]1|9(?:06|[1-9]1)"], "0$1"], [, "(\\d{4})(\\d{2,11})", "$1 $2", ["[24-6]|[7-9](?:\\d[1-9]|[1-9]\\d)|3(?:[3569][02-46-9]|4[2-4679]|7[2-467]|8[2-46-8])", "[24-6]|[7-9](?:\\d[1-9]|[1-9]\\d)|3(?:3(?:0[1-467]|2[127-9]|3[124578]|[46][1246]|7[1257-9]|8[1256]|9[145])|4(?:2[135]|3[1357]|4[13578]|6[1246]|7[1356]|9[1346])|5(?:0[14]|2[1-3589]|3[1357]|4[1246]|6[1-4]|7[1346]|8[13568]|9[1246])|6(?:0[356]|2[1-489]|3[124-6]|4[1347]|6[13]|7[12579]|8[1-356]|9[135])|7(?:2[1-7]|3[1357]|4[145]|6[1-5]|7[1-4])|8(?:21|3[1468]|4[1347]|6[0135-9]|7[1467]|8[136])|9(?:0[12479]|2[1358]|3[1357]|4[134679]|6[1-9]|7[136]|8[147]|9[1468]))"], 
"0$1"], [, "(3\\d{4})(\\d{1,10})", "$1 $2", ["3"], "0$1"], [, "(800)(\\d{7,12})", "$1 $2", ["800"], "0$1"], [, "(\\d{3})(\\d)(\\d{4,10})", "$1 $2 $3", ["(?:18|90)0|137", "1(?:37|80)|900[1359]"], "0$1"], [, "(1\\d{2})(\\d{5,11})", "$1 $2", ["181"], "0$1"], [, "(18\\d{3})(\\d{6})", "$1 $2", ["185", "1850", "18500"], "0$1"], [, "(18\\d{2})(\\d{7})", "$1 $2", ["18[68]"], "0$1"], [, "(18\\d)(\\d{8})", "$1 $2", ["18[2-579]"], "0$1"], [, "(700)(\\d{4})(\\d{4})", "$1 $2 $3", ["700"], "0$1"], [, "(138)(\\d{4})", 
"$1 $2", ["138"], "0$1"], [, "(15[013-68])(\\d{2})(\\d{8})", "$1 $2 $3", ["15[013-68]"], "0$1"], [, "(15[279]\\d)(\\d{2})(\\d{7})", "$1 $2 $3", ["15[279]"], "0$1"], [, "(1[67]\\d)(\\d{2})(\\d{7,8})", "$1 $2 $3", ["1(?:6[023]|7)"], "0$1"]], , [, , "16(?:4\\d{1,10}|[89]\\d{1,11})", "\\d{4,14}", , , "16412345"], , , [, , "NA", "NA"], [, , "18(?:1\\d{5,11}|[2-9]\\d{8})", "\\d{8,14}", , , "18500123456"], , , [, , "1(?:5(?:(?:2\\d55|7\\d99|9\\d33)\\d{7}|(?:[034568]00|113)\\d{8})|6(?:013|255|399)\\d{7,8}|7(?:[015]13|[234]55|[69]33|[78]99)\\d{7,8})", 
"\\d{12,13}", , , "177991234567"]], DJ:[, [, , "[27]\\d{7}", "\\d{8}"], [, , "2(?:1[2-5]|7[45])\\d{5}", "\\d{8}", , , "21360003"], [, , "77[0-26-8]\\d{5}", "\\d{8}", , , "77831001"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "DJ", 253, "00", , , , , , , , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], DK:[, [, , "[2-9]\\d{7}", "\\d{8}"], [, , "(?:[2-7]\\d|8[126-9]|9[1-36-9])\\d{6}", 
"\\d{8}", , , "32123456"], [, , "(?:[2-7]\\d|8[126-9]|9[1-36-9])\\d{6}", "\\d{8}", , , "20123456"], [, , "80\\d{6}", "\\d{8}", , , "80123456"], [, , "90\\d{6}", "\\d{8}", , , "90123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "DK", 45, "00", , , , , , , 1, [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], DM:[, [, , "[57-9]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "767(?:2(?:55|66)|4(?:2[01]|4[0-25-9])|50[0-4]|70[1-3])\\d{4}", 
"\\d{7}(?:\\d{3})?", , , "7674201234"], [, , "767(?:2(?:[234689]5|7[5-7])|31[5-7]|61[2-7])\\d{4}", "\\d{10}", , , "7672251234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002123456"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "DM", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "767", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], DO:[, [, , "[589]\\d{9}", 
"\\d{7}(?:\\d{3})?"], [, , "8(?:[04]9[2-9]\\d{6}|29(?:2(?:[0-59]\\d|6[04-9]|7[0-27]|8[0237-9])|3(?:[0-35-9]\\d|4[7-9])|[45]\\d{2}|6(?:[0-27-9]\\d|[3-5][1-9]|6[0135-8])|7(?:0[013-9]|[1-37]\\d|4[1-35689]|5[1-4689]|6[1-57-9]|8[1-79]|9[1-8])|8(?:0[146-9]|1[0-48]|[248]\\d|3[1-79]|5[01589]|6[013-68]|7[124-8]|9[0-8])|9(?:[0-24]\\d|3[02-46-9]|5[0-79]|60|7[0169]|8[57-9]|9[02-9]))\\d{4})", "\\d{7}(?:\\d{3})?", , , "8092345678"], [, , "8[024]9[2-9]\\d{6}", "\\d{7}(?:\\d{3})?", , , "8092345678"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", 
"\\d{10}", , , "8002123456"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "DO", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "8[024]9", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], DZ:[, [, , "(?:[1-4]|[5-9]\\d)\\d{7}", "\\d{8,9}"], [, , "(?:1\\d|2[013-79]|3[0-8]|4[0135689])\\d{6}|9619\\d{5}", "\\d{8,9}", , , "12345678"], [, , "(?:5[4-6]|7[7-9])\\d{7}|6(?:[569]\\d|7[0-6])\\d{6}", 
"\\d{9}", , , "551234567"], [, , "800\\d{6}", "\\d{9}", , , "800123456"], [, , "80[3-689]1\\d{5}", "\\d{9}", , , "808123456"], [, , "80[12]1\\d{5}", "\\d{9}", , , "801123456"], [, , "NA", "NA"], [, , "98[23]\\d{6}", "\\d{9}", , , "983123456"], "DZ", 213, "00", "0", , , "0", , , , [[, "([1-4]\\d)(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[1-4]"], "0$1"], [, "([5-8]\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[5-8]"], "0$1"], [, "(9\\d)(\\d{3})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["9"], "0$1"]], 
, [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], EC:[, [, , "1\\d{9,10}|[2-8]\\d{7}|9\\d{8}", "\\d{7,11}"], [, , "[2-7][2-7]\\d{6}", "\\d{7,8}", , , "22123456"], [, , "9(?:39|[45][89]|[67][7-9]|[89]\\d)\\d{6}", "\\d{9}", , , "991234567"], [, , "1800\\d{6,7}", "\\d{10,11}", , , "18001234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "[2-7]890\\d{4}", "\\d{8}", , , "28901234"], "EC", 593, "00", "0", , , "0", , , , [[, "(\\d)(\\d{3})(\\d{4})", "$1 $2-$3", 
["[247]|[356][2-8]"], "(0$1)"], [, "(\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["9"], "0$1"], [, "(1800)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["1"], "$1"]], [[, "(\\d)(\\d{3})(\\d{4})", "$1-$2-$3", ["[247]|[356][2-8]"]], [, "(\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["9"], "0$1"], [, "(1800)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["1"], "$1"]], [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], EE:[, [, , "1\\d{3,4}|[3-9]\\d{6,7}|800\\d{6,7}", "\\d{4,10}"], [, , "(?:3[23589]|4[3-8]|6\\d|7[1-9]|88)\\d{5}", 
"\\d{7}", , , "3212345"], [, , "(?:5\\d|8[1-5])\\d{6}|5(?:[02]\\d{2}|1(?:[0-8]\\d|95)|5[0-478]\\d|64[0-4]|65[1-589])\\d{3}", "\\d{7,8}", , , "51234567"], [, , "800(?:0\\d{3}|1\\d|[2-9])\\d{3}", "\\d{7,10}", , , "80012345"], [, , "(?:40\\d{2}|900)\\d{4}", "\\d{7,8}", , , "9001234"], [, , "NA", "NA"], [, , "70[0-2]\\d{5}", "\\d{8}", , , "70012345"], [, , "NA", "NA"], "EE", 372, "00", , , , , , , , [[, "([3-79]\\d{2})(\\d{4})", "$1 $2", ["[369]|4[3-8]|5(?:[0-2]|5[0-478]|6[45])|7[1-9]", "[369]|4[3-8]|5(?:[02]|1(?:[0-8]|95)|5[0-478]|6(?:4[0-4]|5[1-589]))|7[1-9]"]], 
[, "(70)(\\d{2})(\\d{4})", "$1 $2 $3", ["70"]], [, "(8000)(\\d{3})(\\d{3})", "$1 $2 $3", ["800", "8000"]], [, "([458]\\d{3})(\\d{3,4})", "$1 $2", ["40|5|8(?:00|[1-5])", "40|5|8(?:00[1-9]|[1-5])"]]], , [, , "NA", "NA"], , , [, , "1\\d{3,4}|800[2-9]\\d{3}", "\\d{4,7}", , , "8002123"], [, , "1(?:2[01245]|3[0-6]|4[1-489]|5[0-59]|6[1-46-9]|7[0-27-9]|8[189]|9[012])\\d{1,2}", "\\d{4,5}", , , "12123"], , , [, , "NA", "NA"]], EG:[, [, , "1\\d{4,9}|[2456]\\d{8}|3\\d{7}|[89]\\d{8,9}", "\\d{5,10}"], [, , "(?:1(?:3[23]\\d|5(?:[23]|9\\d))|2[2-4]\\d{2}|3\\d{2}|4(?:0[2-5]|[578][23]|64)\\d|5(?:0[2-7]|[57][23])\\d|6[24-689]3\\d|8(?:2[2-57]|4[26]|6[237]|8[2-4])\\d|9(?:2[27]|3[24]|52|6[2356]|7[2-4])\\d)\\d{5}|1[69]\\d{3}", 
"\\d{5,9}", , , "234567890"], [, , "1(?:0[0-269]|1[0-245]|2[0-278])\\d{7}", "\\d{10}", , , "1001234567"], [, , "800\\d{7}", "\\d{10}", , , "8001234567"], [, , "900\\d{7}", "\\d{10}", , , "9001234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "EG", 20, "00", "0", , , "0", , , , [[, "(\\d)(\\d{7,8})", "$1 $2", ["[23]"], "0$1"], [, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["1[012]|[89]00"], "0$1"], [, "(\\d{2})(\\d{6,7})", "$1 $2", ["1[35]|[4-6]|[89][2-9]"], "0$1"]], , [, , "NA", "NA"], 
, , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], EH:[, [, , "[5689]\\d{8}", "\\d{9}"], [, , "528[89]\\d{5}", "\\d{9}", , , "528812345"], [, , "6(?:0[0-8]|[12-79]\\d|8[017])\\d{6}", "\\d{9}", , , "650123456"], [, , "80\\d{7}", "\\d{9}", , , "801234567"], [, , "89\\d{7}", "\\d{9}", , , "891234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "EH", 212, "00", "0", , , "0", , , , , , [, , "NA", "NA"], , "528[89]", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], ER:[, 
[, , "[178]\\d{6}", "\\d{6,7}"], [, , "1(?:1[12568]|20|40|55|6[146])\\d{4}|8\\d{6}", "\\d{6,7}", , , "8370362"], [, , "17[1-3]\\d{4}|7\\d{6}", "\\d{7}", , , "7123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "ER", 291, "00", "0", , , "0", , , , [[, "(\\d)(\\d{3})(\\d{3})", "$1 $2 $3", , "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], ES:[, [, , "[5-9]\\d{8}", "\\d{9}"], [, , "8(?:[13]0|[28][0-8]|[47][1-9]|5[01346-9]|6[0457-9])\\d{6}|9(?:[1238][0-8]\\d{6}|4[1-9]\\d{6}|5\\d{7}|6(?:[0-8]\\d{6}|9(?:0(?:[0-57-9]\\d{4}|6(?:0[0-8]|1[1-9]|[2-9]\\d)\\d{2})|[1-9]\\d{5}))|7(?:[124-9]\\d{2}|3(?:[0-8]\\d|9[1-9]))\\d{4})", 
"\\d{9}", , , "810123456"], [, , "(?:6\\d{6}|7[1-4]\\d{5}|9(?:6906(?:09|10)|7390\\d{2}))\\d{2}", "\\d{9}", , , "612345678"], [, , "[89]00\\d{6}", "\\d{9}", , , "800123456"], [, , "80[367]\\d{6}", "\\d{9}", , , "803123456"], [, , "90[12]\\d{6}", "\\d{9}", , , "901123456"], [, , "70\\d{7}", "\\d{9}", , , "701234567"], [, , "NA", "NA"], "ES", 34, "00", , , , , , , , [[, "([89]00)(\\d{3})(\\d{3})", "$1 $2 $3", ["[89]00"]], [, "([5-9]\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[568]|[79][0-8]"]]], 
, [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "51\\d{7}", "\\d{9}", , , "511234567"], , , [, , "NA", "NA"]], ET:[, [, , "[1-59]\\d{8}", "\\d{7,9}"], [, , "(?:11(?:1(?:1[124]|2[2-57]|3[1-5]|5[5-8]|8[6-8])|2(?:13|3[6-8]|5[89]|7[05-9]|8[2-6])|3(?:2[01]|3[0-289]|4[1289]|7[1-4]|87)|4(?:1[69]|3[2-49]|4[0-3]|6[5-8])|5(?:1[578]|44|5[0-4])|6(?:18|2[69]|4[5-7]|5[1-5]|6[0-59]|8[015-8]))|2(?:2(?:11[1-9]|22[0-7]|33\\d|44[1467]|66[1-68])|5(?:11[124-6]|33[2-8]|44[1467]|55[14]|66[1-3679]|77[124-79]|880))|3(?:3(?:11[0-46-8]|22[0-6]|33[0134689]|44[04]|55[0-6]|66[01467])|4(?:44[0-8]|55[0-69]|66[0-3]|77[1-5]))|4(?:6(?:22[0-24-7]|33[1-5]|44[13-69]|55[14-689]|660|88[1-4])|7(?:11[1-9]|22[1-9]|33[13-7]|44[13-6]|55[1-689]))|5(?:7(?:227|55[05]|(?:66|77)[14-8])|8(?:11[149]|22[013-79]|33[0-68]|44[013-8]|550|66[1-5]|77\\d)))\\d{4}", 
"\\d{7,9}", , , "111112345"], [, , "9(?:[1-46]\\d|5[89])\\d{6}", "\\d{9}", , , "911234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "ET", 251, "00", "0", , , "0", , , , [[, "([1-59]\\d)(\\d{3})(\\d{4})", "$1 $2 $3", , "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], FI:[, [, , "1\\d{4,11}|[2-9]\\d{4,10}", "\\d{5,12}"], [, , "1(?:[3569][1-8]\\d{3,9}|[47]\\d{5,10})|2[1-8]\\d{3,9}|3(?:[1-8]\\d{3,9}|9\\d{4,8})|[5689][1-8]\\d{3,9}", 
"\\d{5,12}", , , "1312345678"], [, , "4\\d{5,10}|50\\d{4,8}", "\\d{6,11}", , , "412345678"], [, , "800\\d{4,7}", "\\d{7,10}", , , "8001234567"], [, , "[67]00\\d{5,6}", "\\d{8,9}", , , "600123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "FI", 358, "00|99[049]", "0", , , "0", , , , [[, "(\\d{3})(\\d{3,7})", "$1 $2", ["(?:[1-3]00|[6-8]0)"], "0$1"], [, "(116\\d{3})", "$1", ["116"], "$1"], [, "(\\d{2})(\\d{4,10})", "$1 $2", ["[14]|2[09]|50|7[135]"], "0$1"], [, "(\\d)(\\d{4,11})", "$1 $2", 
["[25689][1-8]|3"], "0$1"]], , [, , "NA", "NA"], 1, , [, , "[13]00\\d{3,7}|2(?:0(?:0\\d{3,7}|2[023]\\d{1,6}|9[89]\\d{1,6}))|60(?:[12]\\d{5,6}|6\\d{7})|7(?:1\\d{7}|3\\d{8}|5[03-9]\\d{2,7})", "\\d{5,10}", , , "100123"], [, , "[13]0\\d{4,8}|2(?:0(?:[016-8]\\d{3,7}|[2-59]\\d{2,7})|9\\d{4,8})|60(?:[12]\\d{5,6}|6\\d{7})|7(?:1\\d{7}|3\\d{8}|5[03-9]\\d{2,7})", "\\d{5,10}", , , "10112345"], , , [, , "NA", "NA"]], FJ:[, [, , "[36-9]\\d{6}|0\\d{10}", "\\d{7}(?:\\d{4})?"], [, , "(?:3[0-5]|6[25-7]|8[58])\\d{5}", 
"\\d{7}", , , "3212345"], [, , "(?:7[0-8]|8[034679]|9\\d)\\d{5}", "\\d{7}", , , "7012345"], [, , "0800\\d{7}", "\\d{11}", , , "08001234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "FJ", 679, "0(?:0|52)", , , , , , "00", , [[, "(\\d{3})(\\d{4})", "$1 $2", ["[36-9]"]], [, "(\\d{4})(\\d{3})(\\d{4})", "$1 $2 $3", ["0"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]], FK:[, [, , "[2-7]\\d{4}", "\\d{5}"], [, , "[2-47]\\d{4}", "\\d{5}", 
, , "31234"], [, , "[56]\\d{4}", "\\d{5}", , , "51234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "FK", 500, "00", , , , , , , , , , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], FM:[, [, , "[39]\\d{6}", "\\d{7}"], [, , "3[2357]0[1-9]\\d{3}|9[2-6]\\d{5}", "\\d{7}", , , "3201234"], [, , "3[2357]0[1-9]\\d{3}|9[2-7]\\d{5}", "\\d{7}", , , "3501234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], 
[, , "NA", "NA"], "FM", 691, "00", , , , , , , , [[, "(\\d{3})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], FO:[, [, , "[2-9]\\d{5}", "\\d{6}"], [, , "(?:20|[3-4]\\d|8[19])\\d{4}", "\\d{6}", , , "201234"], [, , "(?:[27][1-9]|5\\d)\\d{4}", "\\d{6}", , , "211234"], [, , "80[257-9]\\d{3}", "\\d{6}", , , "802123"], [, , "90(?:[1345][15-7]|2[125-7]|99)\\d{2}", "\\d{6}", , , "901123"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "(?:6[0-36]|88)\\d{4}", 
"\\d{6}", , , "601234"], "FO", 298, "00", , , , "(10(?:01|[12]0|88))", , , , [[, "(\\d{6})", "$1", , , "$CC $1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], FR:[, [, , "[1-9]\\d{8}", "\\d{9}"], [, , "[1-5]\\d{8}", "\\d{9}", , , "123456789"], [, , "6\\d{8}|7(?:00\\d{6}|[3-9]\\d{7})", "\\d{9}", , , "612345678"], [, , "80[0-5]\\d{6}", "\\d{9}", , , "801234567"], [, , "89[1-37-9]\\d{6}", "\\d{9}", , , "891123456"], [, , "8(?:1[019]|2[0156]|84|90)\\d{6}", "\\d{9}", 
, , "810123456"], [, , "NA", "NA"], [, , "9\\d{8}", "\\d{9}", , , "912345678"], "FR", 33, "00", "0", , , "0", , , , [[, "([1-79])(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4 $5", ["[1-79]"], "0$1"], [, "(1\\d{2})(\\d{3})", "$1 $2", ["11"], "$1"], [, "(8\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["8"], "0 $1"]], [[, "([1-79])(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4 $5", ["[1-79]"], "0$1"], [, "(8\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["8"], "0 $1"]], [, , "NA", "NA"], , , 
[, , "NA", "NA"], [, , "80[6-9]\\d{6}", "\\d{9}", , , "806123456"], , , [, , "NA", "NA"]], GA:[, [, , "0?\\d{7}", "\\d{7,8}"], [, , "01\\d{6}", "\\d{8}", , , "01441234"], [, , "0?[2-7]\\d{6}", "\\d{7,8}", , , "06031234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "GA", 241, "00", , , , , , , , [[, "(\\d)(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[2-7]"], "0$1"], [, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["0"]]], , [, , "NA", "NA"], , , 
[, , "NA", "NA"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]], GB:[, [, , "\\d{7,10}", "\\d{4,10}"], [, , "2(?:0[01378]|3[0189]|4[017]|8[0-46-9]|9[012])\\d{7}|1(?:(?:1(?:3[0-48]|[46][0-4]|5[012789]|7[0-49]|8[01349])|21[0-7]|31[0-8]|[459]1\\d|61[0-46-9]))\\d{6}|1(?:2(?:0[024-9]|2[3-9]|3[3-79]|4[1-689]|[58][02-9]|6[0-4789]|7[013-9]|9\\d)|3(?:0\\d|[25][02-9]|3[02-579]|[468][0-46-9]|7[1235679]|9[24578])|4(?:0[03-9]|[28][02-5789]|[37]\\d|4[02-69]|5[0-8]|[69][0-79])|5(?:0[1235-9]|2[024-9]|3[015689]|4[02-9]|5[03-9]|6\\d|7[0-35-9]|8[0-468]|9[0-5789])|6(?:0[034689]|2[0-35689]|[38][013-9]|4[1-467]|5[0-69]|6[13-9]|7[0-8]|9[0124578])|7(?:0[0246-9]|2\\d|3[023678]|4[03-9]|5[0-46-9]|6[013-9]|7[0-35-9]|8[024-9]|9[02-9])|8(?:0[35-9]|2[1-5789]|3[02-578]|4[0-578]|5[124-9]|6[2-69]|7\\d|8[02-9]|9[02569])|9(?:0[02-589]|2[02-689]|3[1-5789]|4[2-9]|5[0-579]|6[234789]|7[0124578]|8\\d|9[2-57]))\\d{6}|1(?:2(?:0(?:46[1-4]|87[2-9])|545[1-79]|76(?:2\\d|3[1-8]|6[1-6])|9(?:7(?:2[0-4]|3[2-5])|8(?:2[2-8]|7[0-4789]|8[345])))|3(?:638[2-5]|647[23]|8(?:47[04-9]|64[015789]))|4(?:044[1-7]|20(?:2[23]|8\\d)|6(?:0(?:30|5[2-57]|6[1-8]|7[2-8])|140)|8(?:052|87[123]))|5(?:24(?:3[2-79]|6\\d)|276\\d|6(?:26[06-9]|686))|6(?:06(?:4\\d|7[4-79])|295[567]|35[34]\\d|47(?:24|61)|59(?:5[08]|6[67]|74)|955[0-4])|7(?:26(?:6[13-9]|7[0-7])|442\\d|50(?:2[0-3]|[3-68]2|76))|8(?:27[56]\\d|37(?:5[2-5]|8[239])|84(?:3[2-58]))|9(?:0(?:0(?:6[1-8]|85)|52\\d)|3583|4(?:66[1-8]|9(?:2[01]|81))|63(?:23|3[1-4])|9561))\\d{3}|176888[234678]\\d{2}|16977[23]\\d{3}", 
"\\d{4,10}", , , "1212345678"], [, , "7(?:[1-4]\\d\\d|5(?:0[0-8]|[13-9]\\d|2[0-35-9])|7(?:0[1-9]|[1-7]\\d|8[02-9]|9[0-689])|8(?:[014-9]\\d|[23][0-8])|9(?:[04-9]\\d|1[02-9]|2[0-35-9]|3[0-689]))\\d{6}", "\\d{10}", , , "7400123456"], [, , "80(?:0(?:1111|\\d{6,7})|8\\d{7})|500\\d{6}", "\\d{7}(?:\\d{2,3})?", , , "8001234567"], [, , "(?:87[123]|9(?:[01]\\d|8[2349]))\\d{7}", "\\d{10}", , , "9012345678"], [, , "8(?:4(?:5464\\d|[2-5]\\d{7})|70\\d{7})", "\\d{7}(?:\\d{3})?", , , "8431234567"], [, , "70\\d{8}", 
"\\d{10}", , , "7012345678"], [, , "56\\d{8}", "\\d{10}", , , "5612345678"], "GB", 44, "00", "0", " x", , "0", , , , [[, "(\\d{2})(\\d{4})(\\d{4})", "$1 $2 $3", ["2|5[56]|7(?:0|6[013-9])", "2|5[56]|7(?:0|6(?:[013-9]|2[0-35-9]))"], "0$1"], [, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["1(?:1|\\d1)|3|9[018]"], "0$1"], [, "(\\d{5})(\\d{4,5})", "$1 $2", ["1(?:38|5[23]|69|76|94)", "1(?:387|5(?:24|39)|697|768|946)", "1(?:3873|5(?:242|39[456])|697[347]|768[347]|9467)"], "0$1"], [, "(1\\d{3})(\\d{5,6})", "$1 $2", 
["1"], "0$1"], [, "(7\\d{3})(\\d{6})", "$1 $2", ["7(?:[1-5789]|62)", "7(?:[1-5789]|624)"], "0$1"], [, "(800)(\\d{4})", "$1 $2", ["800", "8001", "80011", "800111", "8001111"], "0$1"], [, "(845)(46)(4\\d)", "$1 $2 $3", ["845", "8454", "84546", "845464"], "0$1"], [, "(8\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["8(?:4[2-5]|7[0-3])"], "0$1"], [, "(80\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["80"], "0$1"], [, "([58]00)(\\d{6})", "$1 $2", ["[58]00"], "0$1"]], , [, , "76(?:0[012]|2[356]|4[0134]|5[49]|6[0-369]|77|81|9[39])\\d{6}", 
"\\d{10}", , , "7640123456"], 1, , [, , "NA", "NA"], [, , "(?:3[0347]|55)\\d{8}", "\\d{10}", , , "5512345678"], , , [, , "NA", "NA"]], GD:[, [, , "[4589]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "473(?:2(?:3[0-2]|69)|3(?:2[89]|86)|4(?:[06]8|3[5-9]|4[0-49]|5[5-79]|68|73|90)|63[68]|7(?:58|84)|800|938)\\d{4}", "\\d{7}(?:\\d{3})?", , , "4732691234"], [, , "473(?:4(?:0[2-79]|1[04-9]|20|58)|5(?:2[01]|3[3-8])|901)\\d{4}", "\\d{10}", , , "4734031234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002123456"], 
[, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "GD", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "473", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], GE:[, [, , "[34578]\\d{8}", "\\d{6,9}"], [, , "(?:3(?:[256]\\d|4[124-9]|7[0-4])|4(?:1\\d|2[2-7]|3[1-79]|4[2-8]|7[239]|9[1-7]))\\d{6}", "\\d{6,9}", , , "322123456"], [, , "5(?:14|5[01578]|68|7[0147-9]|9[0-35-9])\\d{6}", 
"\\d{9}", , , "555123456"], [, , "800\\d{6}", "\\d{9}", , , "800123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "706\\d{6}", "\\d{9}", , , "706123456"], "GE", 995, "00", "0", , , "0", , , , [[, "(\\d{3})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[348]"], "0$1"], [, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3", ["7"], "0$1"], [, "(\\d{3})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["5"], "$1"]], , [, , "NA", "NA"], , , [, , "706\\d{6}", "\\d{9}", , , "706123456"], [, , "NA", "NA"], , 
, [, , "NA", "NA"]], GF:[, [, , "[56]\\d{8}", "\\d{9}"], [, , "594(?:10|2[012457-9]|3[0-57-9]|4[3-9]|5[7-9]|6[0-3]|9[014])\\d{4}", "\\d{9}", , , "594101234"], [, , "694(?:[04][0-7]|1[0-5]|3[018]|[29]\\d)\\d{4}", "\\d{9}", , , "694201234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "GF", 594, "00", "0", , , "0", , , , [[, "(\\d{3})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", , "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , 
"NA", "NA"]], GG:[, [, , "[135789]\\d{6,9}", "\\d{6,10}"], [, , "1481\\d{6}", "\\d{6,10}", , , "1481456789"], [, , "7(?:781|839|911)\\d{6}", "\\d{10}", , , "7781123456"], [, , "80(?:0(?:1111|\\d{6,7})|8\\d{7})|500\\d{6}", "\\d{7}(?:\\d{2,3})?", , , "8001234567"], [, , "(?:87[123]|9(?:[01]\\d|8[0-3]))\\d{7}", "\\d{10}", , , "9012345678"], [, , "8(?:4(?:5464\\d|[2-5]\\d{7})|70\\d{7})", "\\d{7}(?:\\d{3})?", , , "8431234567"], [, , "70\\d{8}", "\\d{10}", , , "7012345678"], [, , "56\\d{8}", "\\d{10}", 
, , "5612345678"], "GG", 44, "00", "0", " x", , "0", , , , , , [, , "76(?:0[012]|2[356]|4[0134]|5[49]|6[0-369]|77|81|9[39])\\d{6}", "\\d{10}", , , "7640123456"], , , [, , "NA", "NA"], [, , "(?:3[0347]|55)\\d{8}", "\\d{10}", , , "5512345678"], , , [, , "NA", "NA"]], GH:[, [, , "[235]\\d{8}|8\\d{7}", "\\d{7,9}"], [, , "3(?:0[237]\\d|[167](?:2[0-6]|7\\d)|2(?:2[0-5]|7\\d)|3(?:2[0-3]|7\\d)|4(?:2[013-9]|3[01]|7\\d)|5(?:2[0-7]|7\\d)|8(?:2[0-2]|7\\d)|9(?:20|7\\d))\\d{5}", "\\d{7,9}", , , "302345678"], [, 
, "(?:2[034678]\\d|5(?:[047]\\d|5[3-6]|6[01]))\\d{6}", "\\d{9}", , , "231234567"], [, , "800\\d{5}", "\\d{8}", , , "80012345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "GH", 233, "00", "0", , , "0", , , , [[, "(\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["[235]"], "0$1"], [, "(\\d{3})(\\d{5})", "$1 $2", ["8"], "0$1"]], , [, , "NA", "NA"], , , [, , "800\\d{5}", "\\d{8}", , , "80012345"], [, , "NA", "NA"], , , [, , "NA", "NA"]], GI:[, [, , "[2568]\\d{7}", "\\d{8}"], [, , 
"2(?:00\\d|1(?:6[24-7]|9\\d)|2(?:00|2[2457]))\\d{4}", "\\d{8}", , , "20012345"], [, , "(?:5[46-8]|62)\\d{6}", "\\d{8}", , , "57123456"], [, , "80\\d{6}", "\\d{8}", , , "80123456"], [, , "8[1-689]\\d{6}", "\\d{8}", , , "88123456"], [, , "87\\d{6}", "\\d{8}", , , "87123456"], [, , "NA", "NA"], [, , "NA", "NA"], "GI", 350, "00", , , , , , , , [[, "(\\d{3})(\\d{5})", "$1 $2", ["2"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], GL:[, [, , "[1-689]\\d{5}", "\\d{6}"], 
[, , "(?:19|3[1-6]|6[14689]|8[14-79]|9\\d)\\d{4}", "\\d{6}", , , "321000"], [, , "[245][2-9]\\d{4}", "\\d{6}", , , "221234"], [, , "80\\d{4}", "\\d{6}", , , "801234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "3[89]\\d{4}", "\\d{6}", , , "381234"], "GL", 299, "00", , , , , , , , [[, "(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], GM:[, [, , "[2-9]\\d{6}", "\\d{7}"], [, , "(?:4(?:[23]\\d{2}|4(?:1[024679]|[6-9]\\d))|5(?:54[0-7]|6(?:[67]\\d)|7(?:1[04]|2[035]|3[58]|48))|8\\d{3})\\d{3}", 
"\\d{7}", , , "5661234"], [, , "[23679]\\d{6}", "\\d{7}", , , "3012345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "GM", 220, "00", , , , , , , , [[, "(\\d{3})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], GN:[, [, , "[367]\\d{7,8}", "\\d{8,9}"], [, , "30(?:24|3[12]|4[1-35-7]|5[13]|6[189]|[78]1|9[1478])\\d{4}", "\\d{8}", , , "30241234"], [, , "6[02356]\\d{7}", "\\d{9}", , , "601123456"], [, 
, "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "722\\d{6}", "\\d{9}", , , "722123456"], "GN", 224, "00", , , , , , , , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["3"]], [, "(\\d{3})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[67]"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], GP:[, [, , "[56]\\d{8}", "\\d{9}"], [, , "590(?:0[13468]|1[012]|2[0-68]|3[28]|4[0-8]|5[579]|6[0189]|70|8[0-689]|9\\d)\\d{4}", "\\d{9}", , , "590201234"], 
[, , "690(?:0[0-7]|[1-9]\\d)\\d{4}", "\\d{9}", , , "690301234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "GP", 590, "00", "0", , , "0", , , , [[, "([56]90)(\\d{2})(\\d{4})", "$1 $2-$3", , "0$1"]], , [, , "NA", "NA"], 1, , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], GQ:[, [, , "[23589]\\d{8}", "\\d{9}"], [, , "3(?:3(?:3\\d[7-9]|[0-24-9]\\d[46])|5\\d{2}[7-9])\\d{4}", "\\d{9}", , , "333091234"], [, , "(?:222|55[15])\\d{6}", "\\d{9}", , 
, "222123456"], [, , "80\\d[1-9]\\d{5}", "\\d{9}", , , "800123456"], [, , "90\\d[1-9]\\d{5}", "\\d{9}", , , "900123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "GQ", 240, "00", , , , , , , , [[, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3", ["[235]"]], [, "(\\d{3})(\\d{6})", "$1 $2", ["[89]"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], GR:[, [, , "[26-9]\\d{9}", "\\d{10}"], [, , "2(?:1\\d{2}|2(?:2[1-46-9]|3[1-8]|4[1-7]|5[1-4]|6[1-8]|7[1-5]|[89][1-9])|3(?:1\\d|2[1-57]|[35][1-3]|4[13]|7[1-7]|8[124-6]|9[1-79])|4(?:1\\d|2[1-8]|3[1-4]|4[13-5]|6[1-578]|9[1-5])|5(?:1\\d|[29][1-4]|3[1-5]|4[124]|5[1-6])|6(?:1\\d|3[1245]|4[1-7]|5[13-9]|[269][1-6]|7[14]|8[1-5])|7(?:1\\d|2[1-5]|3[1-6]|4[1-7]|5[1-57]|6[135]|9[125-7])|8(?:1\\d|2[1-5]|[34][1-4]|9[1-57]))\\d{6}", 
"\\d{10}", , , "2123456789"], [, , "69\\d{8}", "\\d{10}", , , "6912345678"], [, , "800\\d{7}", "\\d{10}", , , "8001234567"], [, , "90[19]\\d{7}", "\\d{10}", , , "9091234567"], [, , "8(?:0[16]|12|25)\\d{7}", "\\d{10}", , , "8011234567"], [, , "70\\d{8}", "\\d{10}", , , "7012345678"], [, , "NA", "NA"], "GR", 30, "00", , , , , , , , [[, "([27]\\d)(\\d{4})(\\d{4})", "$1 $2 $3", ["21|7"]], [, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["2[2-9]1|[689]"]], [, "(2\\d{3})(\\d{6})", "$1 $2", ["2[2-9][02-9]"]]], 
, [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], GT:[, [, , "[2-7]\\d{7}|1[89]\\d{9}", "\\d{8}(?:\\d{3})?"], [, , "[267][2-9]\\d{6}", "\\d{8}", , , "22456789"], [, , "[345]\\d{7}", "\\d{8}", , , "51234567"], [, , "18[01]\\d{8}", "\\d{11}", , , "18001112222"], [, , "19\\d{9}", "\\d{11}", , , "19001112222"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "GT", 502, "00", , , , , , , , [[, "(\\d{4})(\\d{4})", "$1 $2", ["[2-7]"]], [, "(\\d{4})(\\d{3})(\\d{4})", 
"$1 $2 $3", ["1"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], GU:[, [, , "[5689]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "671(?:3(?:00|3[39]|4[349]|55|6[26])|4(?:56|7[1-9]|8[236-9])|5(?:55|6[2-5]|88)|6(?:3[2-578]|4[24-9]|5[34]|78|8[5-9])|7(?:[079]7|2[0167]|3[45]|47|8[789])|8(?:[2-5789]8|6[48])|9(?:2[29]|6[79]|7[179]|8[789]|9[78]))\\d{4}", "\\d{7}(?:\\d{3})?", , , "6713001234"], [, , "671(?:3(?:00|3[39]|4[349]|55|6[26])|4(?:56|7[1-9]|8[236-9])|5(?:55|6[2-5]|88)|6(?:3[2-578]|4[24-9]|5[34]|78|8[5-9])|7(?:[079]7|2[0167]|3[45]|47|8[789])|8(?:[2-5789]8|6[48])|9(?:2[29]|6[79]|7[179]|8[789]|9[78]))\\d{4}", 
"\\d{7}(?:\\d{3})?", , , "6713001234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002123456"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "GU", 1, "011", "1", , , "1", , , 1, , , [, , "NA", "NA"], , "671", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], GW:[, [, , "(?:4(?:0\\d{5}|4\\d{7})|9\\d{8})", "\\d{7,9}"], [, , "443(?:2[0125]|3[1245]|4[12]|5[1-4]|70|9[1-467])\\d{4}", 
"\\d{7,9}", , , "443201234"], [, , "9(?:55\\d|6(?:6\\d|9[012])|77\\d)\\d{5}", "\\d{7,9}", , , "955012345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "40\\d{5}", "\\d{7,9}", , , "4012345"], "GW", 245, "00", , , , , , , , [[, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3", ["44|9[567]"]], [, "(\\d{3})(\\d{4})", "$1 $2", ["40"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], GY:[, [, , "[2-4679]\\d{6}", "\\d{7}"], [, , "(?:2(?:1[6-9]|2[0-35-9]|3[1-4]|5[3-9]|6\\d|7[0-24-79])|3(?:2[25-9]|3\\d)|4(?:4[0-24]|5[56])|77[1-57])\\d{4}", 
"\\d{7}", , , "2201234"], [, , "6\\d{6}", "\\d{7}", , , "6091234"], [, , "(?:289|862)\\d{4}", "\\d{7}", , , "2891234"], [, , "9008\\d{3}", "\\d{7}", , , "9008123"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "GY", 592, "001", , , , , , , , [[, "(\\d{3})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], HK:[, [, , "[235-7]\\d{7}|8\\d{7,8}|9\\d{4,10}", "\\d{5,11}"], [, , "(?:[23]\\d|58)\\d{6}", "\\d{8}", , , "21234567"], [, , "(?:5[1-79]\\d|6\\d{2}|8[4-79]\\d|9(?:0[1-9]|[1-8]\\d))\\d{5}", 
"\\d{8}", , , "51234567"], [, , "800\\d{6}", "\\d{9}", , , "800123456"], [, , "900(?:[0-24-9]\\d{7}|3\\d{1,4})", "\\d{5,11}", , , "90012345678"], [, , "NA", "NA"], [, , "8[1-3]\\d{6}", "\\d{8}", , , "81123456"], [, , "NA", "NA"], "HK", 852, "00(?:[126-9]|30|5[09])?", , , , , , "00", , [[, "(\\d{4})(\\d{4})", "$1 $2", ["[235-7]|[89](?:0[1-9]|[1-9])"]], [, "(800)(\\d{3})(\\d{3})", "$1 $2 $3", ["800"]], [, "(900)(\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3 $4", ["900"]], [, "(900)(\\d{2,5})", "$1 $2", ["900"]]], 
, [, , "7\\d{7}", "\\d{8}", , , "71234567"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], HN:[, [, , "[237-9]\\d{7}", "\\d{8}"], [, , "2(?:2(?:0[019]|1[1-36]|[23]\\d|4[056]|5[57]|7[01389]|8[0146-9]|9[012])|4(?:07|2[3-59]|3[13-689]|4[0-68]|5[1-35])|5(?:16|4[3-5]|5\\d|6[4-6]|74)|6(?:[056]\\d|17|3[04]|4[0-378]|[78][0-8]|9[01])|7(?:6[46-9]|7[02-9]|8[034])|8(?:79|8[0-35789]|9[1-57-9]))\\d{4}", "\\d{8}", , , "22123456"], [, , "[37-9]\\d{7}", "\\d{8}", , , "91234567"], [, , "NA", "NA"], 
[, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "HN", 504, "00", , , , , , , , [[, "(\\d{4})(\\d{4})", "$1-$2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], HR:[, [, , "[1-7]\\d{5,8}|[89]\\d{6,11}", "\\d{6,12}"], [, , "1\\d{7}|(?:2[0-3]|3[1-5]|4[02-47-9]|5[1-3])\\d{6,7}", "\\d{6,9}", , , "12345678"], [, , "9(?:[1-9]\\d{6,10}|01\\d{6,9})", "\\d{8,12}", , , "912345678"], [, , "80[01]\\d{4,7}", "\\d{7,10}", , , "8001234567"], [, , "6(?:[01459]\\d{4,7})", 
"\\d{6,9}", , , "611234"], [, , "NA", "NA"], [, , "7[45]\\d{4,7}", "\\d{6,9}", , , "741234567"], [, , "NA", "NA"], "HR", 385, "00", "0", , , "0", , , , [[, "(1)(\\d{4})(\\d{3})", "$1 $2 $3", ["1"], "0$1"], [, "(6[09])(\\d{4})(\\d{3})", "$1 $2 $3", ["6[09]"], "0$1"], [, "([67]2)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["[67]2"], "0$1"], [, "([2-5]\\d)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["[2-5]"], "0$1"], [, "(9\\d)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["9"], "0$1"], [, "(9\\d)(\\d{4})(\\d{4})", "$1 $2 $3", ["9"], 
"0$1"], [, "(9\\d)(\\d{3,4})(\\d{3})(\\d{3})", "$1 $2 $3 $4", ["9"], "0$1"], [, "(\\d{2})(\\d{2})(\\d{2,3})", "$1 $2 $3", ["6[0145]|7"], "0$1"], [, "(\\d{2})(\\d{3,4})(\\d{3})", "$1 $2 $3", ["6[0145]|7"], "0$1"], [, "(80[01])(\\d{2})(\\d{2,3})", "$1 $2 $3", ["8"], "0$1"], [, "(80[01])(\\d{3,4})(\\d{3})", "$1 $2 $3", ["8"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "[76]2\\d{6,7}", "\\d{8,9}", , , "62123456"], , , [, , "NA", "NA"]], HT:[, [, , "[2-489]\\d{7}", "\\d{8}"], [, , "2(?:[248]\\d|5[1-5]|94)\\d{5}", 
"\\d{8}", , , "22453300"], [, , "(?:3[1-9]\\d|4\\d{2}|9(?:8[0-35]|9[5-9]))\\d{5}", "\\d{8}", , , "34101234"], [, , "8\\d{7}", "\\d{8}", , , "80012345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "98[89]\\d{5}", "\\d{8}", , , "98901234"], "HT", 509, "00", , , , , , , , [[, "(\\d{2})(\\d{2})(\\d{4})", "$1 $2 $3"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], HU:[, [, , "[1-9]\\d{7,8}", "\\d{6,9}"], [, , "(?:1\\d|2(?:1\\d|[2-9])|3(?:[2-7]|8\\d)|4[24-9]|5[2-79]|6[23689]|7(?:1\\d|[2-9])|8[2-57-9]|9[2-69])\\d{6}", 
"\\d{6,9}", , , "12345678"], [, , "(?:[257]0|3[01])\\d{7}", "\\d{9}", , , "201234567"], [, , "80\\d{6}", "\\d{8}", , , "80123456"], [, , "9[01]\\d{6}", "\\d{8}", , , "90123456"], [, , "40\\d{6}", "\\d{8}", , , "40123456"], [, , "NA", "NA"], [, , "NA", "NA"], "HU", 36, "00", "06", , , "06", , , , [[, "(1)(\\d{3})(\\d{4})", "$1 $2 $3", ["1"], "($1)"], [, "(\\d{2})(\\d{3})(\\d{3,4})", "$1 $2 $3", ["[2-9]"], "($1)"]], , [, , "NA", "NA"], , , [, , "[48]0\\d{6}", "\\d{8}", , , "80123456"], [, , "NA", "NA"], 
, , [, , "NA", "NA"]], ID:[, [, , "(?:[1-79]\\d{6,10}|8\\d{7,11})", "\\d{5,12}"], [, , "2(?:1(?:14\\d{3}|[0-8]\\d{6,7}|500\\d{3}|9\\d{6})|2\\d{6,8}|4\\d{7,8})|(?:2(?:[35][1-4]|6[0-8]|7[1-6]|8\\d|9[1-8])|3(?:1|[25][1-8]|3[1-68]|4[1-3]|6[1-3568]|7[0-469]|8\\d)|4(?:0[1-589]|1[01347-9]|2[0-36-8]|3[0-24-68]|43|5[1-378]|6[1-5]|7[134]|8[1245])|5(?:1[1-35-9]|2[25-8]|3[124-9]|4[1-3589]|5[1-46]|6[1-8])|6(?:19?|[25]\\d|3[1-69]|4[1-6])|7(?:02|[125][1-9]|[36]\\d|4[1-8]|7[0-36-9])|9(?:0[12]|1[013-8]|2[0-479]|5[125-8]|6[23679]|7[159]|8[01346]))\\d{5,8}", 
"\\d{5,11}", , , "612345678"], [, , "(?:2(?:1(?:3[145]|4[01]|5[1-469]|60|8[0359]|9\\d)|2(?:88|9[1256])|3[1-4]9|4(?:36|91)|5(?:1[349]|[2-4]9)|6[0-7]9|7(?:[1-36]9|4[39])|8[1-5]9|9[1-48]9)|3(?:19[1-3]|2[12]9|3[13]9|4(?:1[69]|39)|5[14]9|6(?:1[69]|2[89])|709)|4[13]19|5(?:1(?:19|8[39])|4[129]9|6[12]9)|6(?:19[12]|2(?:[23]9|77))|7(?:1[13]9|2[15]9|419|5(?:1[89]|29)|6[15]9|7[178]9))\\d{5,6}|8[1-35-9]\\d{7,10}", "\\d{9,12}", , , "812345678"], [, , "177\\d{6,8}|800\\d{5,7}", "\\d{8,11}", , , "8001234567"], [, 
, "809\\d{7}", "\\d{10}", , , "8091234567"], [, , "804\\d{7}", "\\d{10}", , , "8041234567"], [, , "NA", "NA"], [, , "NA", "NA"], "ID", 62, "0(?:0[1789]|10(?:00|1[67]))", "0", , , "0", , , , [[, "(\\d{2})(\\d{5,8})", "$1 $2", ["2[124]|[36]1"], "(0$1)"], [, "(\\d{3})(\\d{5,8})", "$1 $2", ["[4579]|2[035-9]|[36][02-9]"], "(0$1)"], [, "(8\\d{2})(\\d{3,4})(\\d{3,5})", "$1-$2-$3", ["8[1-35-9]"], "0$1"], [, "(1)(500)(\\d{3})", "$1 $2 $3", ["15"], "$1"], [, "(177)(\\d{6,8})", "$1 $2", ["17"], "0$1"], [, "(800)(\\d{5,7})", 
"$1 $2", ["800"], "0$1"], [, "(804)(\\d{3})(\\d{4})", "$1 $2 $3", ["804"], "0$1"], [, "(80\\d)(\\d)(\\d{3})(\\d{3})", "$1 $2 $3 $4", ["80[79]"], "0$1"]], , [, , "NA", "NA"], , , [, , "8071\\d{6}", "\\d{10}", , , "8071123456"], [, , "1500\\d{3}|8071\\d{6}", "\\d{7,10}", , , "8071123456"], , , [, , "NA", "NA"]], IE:[, [, , "[124-9]\\d{6,9}", "\\d{5,10}"], [, , "1\\d{7,8}|2(?:1\\d{6,7}|3\\d{7}|[24-9]\\d{5})|4(?:0[24]\\d{5}|[1-469]\\d{7}|5\\d{6}|7\\d{5}|8[0-46-9]\\d{7})|5(?:0[45]\\d{5}|1\\d{6}|[23679]\\d{7}|8\\d{5})|6(?:1\\d{6}|[237-9]\\d{5}|[4-6]\\d{7})|7[14]\\d{7}|9(?:1\\d{6}|[04]\\d{7}|[35-9]\\d{5})", 
"\\d{5,10}", , , "2212345"], [, , "8(?:22\\d{6}|[35-9]\\d{7})", "\\d{9}", , , "850123456"], [, , "1800\\d{6}", "\\d{10}", , , "1800123456"], [, , "15(?:1[2-8]|[2-8]0|9[089])\\d{6}", "\\d{10}", , , "1520123456"], [, , "18[59]0\\d{6}", "\\d{10}", , , "1850123456"], [, , "700\\d{6}", "\\d{9}", , , "700123456"], [, , "76\\d{7}", "\\d{9}", , , "761234567"], "IE", 353, "00", "0", , , "0", , , , [[, "(1)(\\d{3,4})(\\d{4})", "$1 $2 $3", ["1"], "(0$1)"], [, "(\\d{2})(\\d{5})", "$1 $2", ["2[24-9]|47|58|6[237-9]|9[35-9]"], 
"(0$1)"], [, "(\\d{3})(\\d{5})", "$1 $2", ["40[24]|50[45]"], "(0$1)"], [, "(48)(\\d{4})(\\d{4})", "$1 $2 $3", ["48"], "(0$1)"], [, "(818)(\\d{3})(\\d{3})", "$1 $2 $3", ["81"], "(0$1)"], [, "(\\d{2})(\\d{3})(\\d{3,4})", "$1 $2 $3", ["[24-69]|7[14]"], "(0$1)"], [, "([78]\\d)(\\d{3,4})(\\d{4})", "$1 $2 $3", ["76|8[35-9]"], "0$1"], [, "(700)(\\d{3})(\\d{3})", "$1 $2 $3", ["70"], "0$1"], [, "(\\d{4})(\\d{3})(\\d{3})", "$1 $2 $3", ["1(?:8[059]|5)", "1(?:8[059]0|5)"], "$1"]], , [, , "NA", "NA"], , , [, 
, "18[59]0\\d{6}", "\\d{10}", , , "1850123456"], [, , "818\\d{6}", "\\d{9}", , , "818123456"], , , [, , "8[35-9]\\d{8}", "\\d{10}", , , "8501234567"]], IL:[, [, , "[17]\\d{6,9}|[2-589]\\d{3}(?:\\d{3,6})?|6\\d{3}", "\\d{4,10}"], [, , "[2-489]\\d{7}", "\\d{7,8}", , , "21234567"], [, , "5(?:[02-47-9]\\d{2}|5(?:01|2[23]|3[2-4]|4[45]|5[5689]|6[67]|7[0178]|8[6-9]|9[4-9])|6[2-9]\\d)\\d{5}", "\\d{9}", , , "501234567"], [, , "1(?:80[019]\\d{3}|255)\\d{3}", "\\d{7,10}", , , "1800123456"], [, , "1(?:212|(?:9(?:0[01]|19)|200)\\d{2})\\d{4}", 
"\\d{8,10}", , , "1919123456"], [, , "1700\\d{6}", "\\d{10}", , , "1700123456"], [, , "NA", "NA"], [, , "7(?:18\\d|2[23]\\d|3[237]\\d|47\\d|6(?:5\\d|8[0168])|7\\d{2}|8(?:2\\d|33|55|77|81)|9[29]\\d)\\d{5}", "\\d{9}", , , "771234567"], "IL", 972, "0(?:0|1[2-9])", "0", , , "0", , , , [[, "([2-489])(\\d{3})(\\d{4})", "$1-$2-$3", ["[2-489]"], "0$1"], [, "([57]\\d)(\\d{3})(\\d{4})", "$1-$2-$3", ["[57]"], "0$1"], [, "(1)([7-9]\\d{2})(\\d{3})(\\d{3})", "$1-$2-$3-$4", ["1[7-9]"], "$1"], [, "(1255)(\\d{3})", 
"$1-$2", ["125"], "$1"], [, "(1200)(\\d{3})(\\d{3})", "$1-$2-$3", ["120"], "$1"], [, "(1212)(\\d{2})(\\d{2})", "$1-$2-$3", ["121"], "$1"], [, "(1599)(\\d{6})", "$1-$2", ["15"], "$1"], [, "(\\d{4})", "*$1", ["[2-689]"], "$1"]], , [, , "NA", "NA"], , , [, , "1700\\d{6}|[2-689]\\d{3}", "\\d{4,10}", , , "1700123456"], [, , "[2-689]\\d{3}|1599\\d{6}", "\\d{4}(?:\\d{6})?", , , "1599123456"], , , [, , "NA", "NA"]], IM:[, [, , "[135789]\\d{6,9}", "\\d{6,10}"], [, , "1624\\d{6}", "\\d{6,10}", , , "1624456789"], 
[, , "7[569]24\\d{6}", "\\d{10}", , , "7924123456"], [, , "808162\\d{4}", "\\d{10}", , , "8081624567"], [, , "(?:872299|90[0167]624)\\d{4}", "\\d{10}", , , "9016247890"], [, , "8(?:4(?:40[49]06|5624\\d)|70624\\d)\\d{3}", "\\d{10}", , , "8456247890"], [, , "70\\d{8}", "\\d{10}", , , "7012345678"], [, , "56\\d{8}", "\\d{10}", , , "5612345678"], "IM", 44, "00", "0", " x", , "0", , , , , , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "3(?:08162\\d|3\\d{5}|4(?:40[49]06|5624\\d)|7(?:0624\\d|2299\\d))\\d{3}|55\\d{8}", 
"\\d{10}", , , "5512345678"], , , [, , "NA", "NA"]], IN:[, [, , "008\\d{9}|1\\d{7,12}|[2-9]\\d{9,10}", "\\d{6,13}"], [, , "(?:11|2[02]|33|4[04]|79)[2-7]\\d{7}|80[2-467]\\d{7}|(?:1(?:2[0-249]|3[0-25]|4[145]|[59][14]|6[014]|7[1257]|8[01346])|2(?:1[257]|3[013]|4[01]|5[0137]|6[0158]|78|8[1568]|9[14])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|[36][25]|22|4[28]|5[12]|[78]1|9[15])|6(?:12|[2345]1|57|6[13]|7[14]|80)|7(?:12|2[14]|3[134]|4[47]|5[15]|[67]1|88)|8(?:16|2[014]|3[126]|6[136]|7[078]|8[34]|91))[2-7]\\d{6}|(?:(?:1(?:2[35-8]|3[346-9]|4[236-9]|[59][0235-9]|6[235-9]|7[34689]|8[257-9])|2(?:1[134689]|3[24-8]|4[2-8]|5[25689]|6[2-4679]|7[13-79]|8[2-479]|9[235-9])|3(?:01|1[79]|2[1-5]|4[25-8]|5[125689]|6[235-7]|7[157-9]|8[2-467])|4(?:1[14578]|2[5689]|3[2-467]|5[4-7]|6[35]|73|8[2689]|9[2389])|5(?:[16][146-9]|2[14-8]|3[1346]|4[14-69]|5[46]|7[2-4]|8[2-8]|9[246])|6(?:1[1358]|2[2457]|3[2-4]|4[235-7]|[57][2-689]|6[24-578]|8[1-6])|8(?:1[1357-9]|2[235-8]|3[03-57-9]|4[0-24-9]|5\\d|6[2457-9]|7[1-6]|8[1256]|9[2-4]))\\d|7(?:(?:1[013-9]|2[0235-9]|3[2679]|4[1-35689]|5[2-46-9]|[67][02-9]|9\\d)\\d|8(?:2[0-6]|[013-8]\\d)))[2-7]\\d{5}", 
"\\d{6,10}", , , "1123456789"], [, , "(?:7(?:0\\d{3}|2(?:[0235679]\\d{2}|[14][017-9]\\d|8(?:[0-59]\\d|6[089]|78)|9[389]\\d)|3(?:[05-8]\\d{2}|1(?:[089]\\d|7[5-8])|2(?:[5-8]\\d|[01][089])|3[17-9]\\d|4(?:[07-9]\\d|11)|9(?:[01689]\\d|59))|4(?:0[1-9]\\d|1(?:[015-9]\\d|4[08])|2(?:09|[1-7][089]|[89]\\d)|3(?:[0-8][089]|9\\d)|4(?:[089]\\d|11|7[02-8])|5(?:0[089]|[59]9)|7(?:0[3-9]|11|7[02-8]|[89]\\d)|8(?:[0-24-7][089]|[389]\\d)|9(?:[0-6][089]|7[08]|[89]\\d))|5(?:[034678]\\d|2[03-9]|5[017-9]|9[7-9])\\d|6(?:0[0-47]|1[0-257-9]|2[0-4]|3[19]|5[4589]|[6-9]\\d)\\d|7(?:0[2-9]|[1-79]\\d|8[1-9])\\d|8(?:[0-79]\\d{2}|88[01])|99[4-9]\\d)|8(?:0(?:[01589]\\d|6[67])|1(?:[02-57-9]\\d|1[0135-9])|2(?:[236-9]\\d|5[1-9])|3(?:[0357-9]\\d|4[1-9])|[45]\\d{2}|6[02457-9]\\d|7(?:07|[1-69]\\d)|8(?:[0-26-9]\\d|44|5[2-9])|9(?:[035-9]\\d|2[2-9]|4[0-8]))\\d|9\\d{4})\\d{5}", 
"\\d{10}", , , "9987654321"], [, , "00800\\d{7}|1(?:600\\d{6}|80(?:0\\d{4,9}|3\\d{9}))", "\\d{8,13}", , , "1800123456"], [, , "186[12]\\d{9}", "\\d{13}", , , "1861123456789"], [, , "1860\\d{7}", "\\d{11}", , , "18603451234"], [, , "NA", "NA"], [, , "NA", "NA"], "IN", 91, "00", "0", , , "0", , , , [[, "(\\d{5})(\\d{5})", "$1 $2", ["7(?:[023578]|4[0-57-9]|6[0-35-9]|99)|8(?:0[015689]|1[0-57-9]|2[2356-9]|3[0-57-9]|[45]|6[02457-9]|7[01-69]|8[0-24-9]|9[02-9])|9", "7(?:[08]|2(?:[0235679]|[14][017-9]|8[0-79]|9[389])|3(?:[05-8]|1[07-9]|2[015-8]|3[17-9]|4[017-9]|9[015689])|4(?:0[1-9]|1[014-9]|[2389]|[47][017-9]|5[059])|5(?:[034678]|2[03-9]|5[017-9]|9[7-9])|6(?:0[0-47]|1[0-257-9]|2[0-4]|3[19]|5[4589]|[6-9])|7(?:0[2-9]|[1-79]|8[1-9])|99[4-9])|8(?:0(?:[01589]|6[67])|1(?:[02-57-9]|1[0135-9])|2(?:[236-9]|5[1-9])|3(?:[0357-9]|4[1-9])|[45]|6[02457-9]|7(?:07|[1-69])|8(?:[0-26-9]|44|5[2-9])|9(?:[035-9]|2[2-9]|4[0-8]))|9", 
"7(?:0|2(?:[0235679]|[14][017-9]|8(?:[0-569]|78)|9[389])|3(?:[05-8]|1(?:[089]|7[5-9])|2(?:[5-8]|[01][089])|3[17-9]|4(?:[07-9]|11)|9(?:[01689]|59))|4(?:0[1-9]|1(?:[015-9]|4[08])|2(?:09|[1-7][089]|[89])|3(?:[0-8][089]|9)|4(?:[089]|11|7[02-8])|5(?:0[089]|[59]9)|7(?:0[3-9]|11|7[02-8]|[89])|8(?:[0-24-7][089]|[389])|9(?:[0-6][089]|7[08]|[89]))|5(?:[034678]|2[03-9]|5[017-9]|9[7-9])|6(?:0[0-47]|1[0-257-9]|2[0-4]|3[19]|5[4589]|[6-9])|7(?:0[2-9]|[1-79]|8[1-9])|8(?:[0-79]|88[01])|99[4-9])|8(?:0(?:[01589]|6[67])|1(?:[02-57-9]|1[0135-9])|2(?:[236-9]|5[1-9])|3(?:[0357-9]|4[1-9])|[45]|6[02457-9]|7(?:07|[1-69])|8(?:[0-26-9]|44|5[2-9])|9(?:[035-9]|2[2-9]|4[0-8]))|9"], 
"0$1", , 1], [, "(\\d{2})(\\d{4})(\\d{4})", "$1 $2 $3", ["11|2[02]|33|4[04]|79|80[2-46]"], "0$1", , 1], [, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["1(?:2[0-249]|3[0-25]|4[145]|[569][14]|7[1257]|8[1346]|[68][1-9])|2(?:1[257]|3[013]|4[01]|5[0137]|6[0158]|78|8[1568]|9[14])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|[36][25]|22|4[28]|5[12]|[78]1|9[15])|6(?:12|[2345]1|57|6[13]|7[14]|80)"], "0$1", , 1], [, "(\\d{3})(\\d{3})(\\d{4})", 
"$1 $2 $3", ["7(?:12|2[14]|3[134]|4[47]|5[15]|[67]1|88)", "7(?:12|2[14]|3[134]|4[47]|5(?:1|5[2-6])|[67]1|88)"], "0$1", , 1], [, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["8(?:16|2[014]|3[126]|6[136]|7[078]|8[34]|91)"], "0$1", , 1], [, "(\\d{4})(\\d{3})(\\d{3})", "$1 $2 $3", ["1(?:[23579]|[468][1-9])|[2-8]"], "0$1", , 1], [, "(\\d{2})(\\d{3})(\\d{4})(\\d{3})", "$1 $2 $3 $4", ["008"], "0$1", , 1], [, "(1600)(\\d{2})(\\d{4})", "$1 $2 $3", ["160", "1600"], "$1", , 1], [, "(1800)(\\d{4,5})", "$1 $2", ["180", 
"1800"], "$1", , 1], [, "(18[06]0)(\\d{2,4})(\\d{4})", "$1 $2 $3", ["18[06]", "18[06]0"], "$1", , 1], [, "(140)(\\d{3})(\\d{4})", "$1 $2 $3", ["140"], "$1", , 1], [, "(\\d{4})(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3 $4", ["18[06]", "18(?:0[03]|6[12])"], "$1", , 1]], , [, , "NA", "NA"], , , [, , "00800\\d{7}|1(?:600\\d{6}|8(?:0(?:0\\d{4,9}|3\\d{9})|6(?:0\\d{7}|[12]\\d{9})))", "\\d{8,13}", , , "1800123456"], [, , "140\\d{7}", "\\d{10}", , , "1409305260"], 1, , [, , "NA", "NA"]], IO:[, [, , "3\\d{6}", "\\d{7}"], 
[, , "37\\d{5}", "\\d{7}", , , "3709100"], [, , "38\\d{5}", "\\d{7}", , , "3801234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "IO", 246, "00", , , , , , , , [[, "(\\d{3})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], IQ:[, [, , "[1-7]\\d{7,9}", "\\d{6,10}"], [, , "1\\d{7}|(?:2[13-5]|3[02367]|4[023]|5[03]|6[026])\\d{6,7}", "\\d{6,9}", , , "12345678"], [, , "7[3-9]\\d{8}", "\\d{10}", , , "7912345678"], 
[, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "IQ", 964, "00", "0", , , "0", , , , [[, "(1)(\\d{3})(\\d{4})", "$1 $2 $3", ["1"], "0$1"], [, "([2-6]\\d)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["[2-6]"], "0$1"], [, "(7\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["7"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], IR:[, [, , "[1-8]\\d{9}|9(?:[0-4]\\d{8}|9\\d{2,8})", "\\d{4,10}"], [, , "(?:1[137]|2[13-68]|3[1458]|4[145]|5[146-8]|6[146]|7[1467]|8[13467])\\d{8}", 
"\\d{10}", , , "2123456789"], [, , "9(?:0[1-3]|[13]\\d|2[0-2]|90)\\d{7}", "\\d{10}", , , "9123456789"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "(?:[2-6]0\\d|993)\\d{7}", "\\d{10}", , , "9932123456"], "IR", 98, "00", "0", , , "0", , , , [[, "(21)(\\d{3,5})", "$1 $2", ["21"], "0$1"], [, "(\\d{2})(\\d{4})(\\d{4})", "$1 $2 $3", ["[1-8]"], "0$1"], [, "(\\d{3})(\\d{3})(\\d{3,4})", "$1 $2 $3", ["9"], "0$1"], [, "(\\d{3})(\\d{2})(\\d{2,3})", "$1 $2 $3", ["9"], "0$1"], 
[, "(\\d{3})(\\d{3})", "$1 $2", ["9"], "0$1"]], , [, , "943\\d{7}", "\\d{10}", , , "9432123456"], , , [, , "NA", "NA"], [, , "9990\\d{0,6}", "\\d{4,10}", , , "9990123456"], , , [, , "NA", "NA"]], IS:[, [, , "[4-9]\\d{6}|38\\d{7}", "\\d{7,9}"], [, , "(?:4(?:1[0-24-6]|2[0-7]|[37][0-8]|4[0-245]|5[0-68]|6\\d|8[0-36-8])|5(?:05|[156]\\d|2[02578]|3[013-79]|4[03-7]|7[0-2578]|8[0-35-9]|9[013-689])|87[23])\\d{4}", "\\d{7}", , , "4101234"], [, , "38[589]\\d{6}|(?:6(?:1[1-8]|2[056]|3[089]|4[0167]|5[0159]|[67][0-69]|9\\d)|7(?:5[057]|6[0-2]|[78]\\d)|8(?:2[0-59]|3[0-4]|[469]\\d|5[1-9]))\\d{4}", 
"\\d{7,9}", , , "6111234"], [, , "800\\d{4}", "\\d{7}", , , "8001234"], [, , "90\\d{5}", "\\d{7}", , , "9011234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "49\\d{5}", "\\d{7}", , , "4921234"], "IS", 354, "1(?:0(?:01|10|20)|100)|00", , , , , , "00", , [[, "(\\d{3})(\\d{4})", "$1 $2", ["[4-9]"]], [, "(3\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["3"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "809\\d{4}", "\\d{7}", , , "8091234"], , , [, , "(?:6(?:2[1-478]|49|8\\d)|8(?:7[0189]|80)|95[48])\\d{4}", 
"\\d{7}", , , "6211234"]], IT:[, [, , "[01589]\\d{5,10}|3(?:[12457-9]\\d{8}|[36]\\d{7,9})", "\\d{6,11}"], [, , "0(?:[26]\\d{4,9}|(?:1(?:[0159]\\d|[27][1-5]|31|4[1-4]|6[1356]|8[2-57])|3(?:[0159]\\d|2[1-4]|3[12]|[48][1-6]|6[2-59]|7[1-7])|4(?:[0159]\\d|[23][1-9]|4[245]|6[1-5]|7[1-4]|81)|5(?:[0159]\\d|2[1-5]|3[2-6]|4[1-79]|6[4-6]|7[1-578]|8[3-8])|7(?:[0159]\\d|2[12]|3[1-7]|4[2346]|6[13569]|7[13-6]|8[1-59])|8(?:[0159]\\d|2[34578]|3[1-356]|[6-8][1-5])|9(?:[0159]\\d|[238][1-5]|4[12]|6[1-8]|7[1-6]))\\d{2,7})", 
"\\d{6,11}", , , "0212345678"], [, , "3(?:[12457-9]\\d{8}|6\\d{7,8}|3\\d{7,9})", "\\d{9,11}", , , "3123456789"], [, , "80(?:0\\d{6}|3\\d{3})", "\\d{6,9}", , , "800123456"], [, , "0878\\d{5}|1(?:44|6[346])\\d{6}|89(?:2\\d{3}|4(?:[0-4]\\d{2}|[5-9]\\d{4})|5(?:[0-4]\\d{2}|[5-9]\\d{6})|9\\d{6})", "\\d{6,10}", , , "899123456"], [, , "84(?:[08]\\d{6}|[17]\\d{3})", "\\d{6,9}", , , "848123456"], [, , "1(?:78\\d|99)\\d{6}", "\\d{9,10}", , , "1781234567"], [, , "55\\d{8}", "\\d{10}", , , "5512345678"], "IT", 
39, "00", , , , , , , , [[, "(\\d{2})(\\d{3,4})(\\d{4})", "$1 $2 $3", ["0[26]|55"]], [, "(0[26])(\\d{4})(\\d{5})", "$1 $2 $3", ["0[26]"]], [, "(0[26])(\\d{4,6})", "$1 $2", ["0[26]"]], [, "(0\\d{2})(\\d{3,4})(\\d{4})", "$1 $2 $3", ["0[13-57-9][0159]"]], [, "(\\d{3})(\\d{3,6})", "$1 $2", ["0[13-57-9][0159]|8(?:03|4[17]|9[245])", "0[13-57-9][0159]|8(?:03|4[17]|9(?:2|[45][0-4]))"]], [, "(0\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["0[13-57-9][2-46-8]"]], [, "(0\\d{3})(\\d{2,6})", "$1 $2", ["0[13-57-9][2-46-8]"]], 
[, "(\\d{3})(\\d{3})(\\d{3,4})", "$1 $2 $3", ["[13]|8(?:00|4[08]|9[59])", "[13]|8(?:00|4[08]|9(?:5[5-9]|9))"]], [, "(\\d{4})(\\d{4})", "$1 $2", ["894", "894[5-9]"]], [, "(\\d{3})(\\d{4})(\\d{4})", "$1 $2 $3", ["3"]]], , [, , "NA", "NA"], 1, , [, , "848\\d{6}", "\\d{9}", , , "848123456"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]], JE:[, [, , "[135789]\\d{6,9}", "\\d{6,10}"], [, , "1534\\d{6}", "\\d{6,10}", , , "1534456789"], [, , "7(?:509|7(?:00|97)|829|937)\\d{6}", "\\d{10}", , , "7797123456"], [, 
, "80(?:07(?:35|81)|8901)\\d{4}", "\\d{10}", , , "8007354567"], [, , "(?:871206|90(?:066[59]|1810|71(?:07|55)))\\d{4}", "\\d{10}", , , "9018105678"], [, , "8(?:4(?:4(?:4(?:05|42|69)|703)|5(?:041|800))|70002)\\d{4}", "\\d{10}", , , "8447034567"], [, , "701511\\d{4}", "\\d{10}", , , "7015115678"], [, , "56\\d{8}", "\\d{10}", , , "5612345678"], "JE", 44, "00", "0", " x", , "0", , , , , , [, , "76(?:0[012]|2[356]|4[0134]|5[49]|6[0-369]|77|81|9[39])\\d{6}", "\\d{10}", , , "7640123456"], , , [, , "NA", 
"NA"], [, , "3(?:0(?:07(?:35|81)|8901)|3\\d{4}|4(?:4(?:4(?:05|42|69)|703)|5(?:041|800))|7(?:0002|1206))\\d{4}|55\\d{8}", "\\d{10}", , , "5512345678"], , , [, , "NA", "NA"]], JM:[, [, , "[589]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "876(?:5(?:0[12]|1[0-468]|2[35]|63)|6(?:0[1-3579]|1[027-9]|[23]\\d|40|5[06]|6[2-589]|7[05]|8[04]|9[4-9])|7(?:0[2-689]|[1-6]\\d|8[056]|9[45])|9(?:0[1-8]|1[02378]|[2-8]\\d|9[2-468]))\\d{4}", "\\d{7}(?:\\d{3})?", , , "8765123456"], [, , "876(?:2[16-9]\\d|[348]\\d{2}|5(?:0[3-9]|27|6[0-24-9]|[3-578]\\d)|7(?:0[07]|7\\d|8[1-47-9]|9[0-36-9])|9(?:[01]9|9[0579]))\\d{4}", 
"\\d{10}", , , "8762101234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002123456"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "JM", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "876", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], JO:[, [, , "[235-9]\\d{7,8}", "\\d{8,9}"], [, , "(?:2(?:6(?:2[0-35-9]|3[0-57-8]|4[24-7]|5[0-24-8]|[6-8][023]|9[0-3])|7(?:0[1-79]|10|2[014-7]|3[0-689]|4[019]|5[0-3578]))|32(?:0[1-69]|1[1-35-7]|2[024-7]|3\\d|4[0-3]|[57][023]|6[03])|53(?:0[0-3]|[13][023]|2[0-59]|49|5[0-35-9]|6[15]|7[45]|8[1-6]|9[0-36-9])|6(?:2[50]0|3(?:00|33)|4(?:0[0125]|1[2-7]|2[0569]|[38][07-9]|4[025689]|6[0-589]|7\\d|9[0-2])|5(?:[01][056]|2[034]|3[0-57-9]|4[17-8]|5[0-69]|6[0-35-9]|7[1-379]|8[0-68]|9[02-39]))|87(?:[02]0|7[08]|90))\\d{4}", 
"\\d{8}", , , "62001234"], [, , "7(?:55|7[025-9]|8[015-9]|9[0-25-9])\\d{6}", "\\d{9}", , , "790123456"], [, , "80\\d{6}", "\\d{8}", , , "80012345"], [, , "900\\d{5}", "\\d{8}", , , "90012345"], [, , "85\\d{6}", "\\d{8}", , , "85012345"], [, , "70\\d{7}", "\\d{9}", , , "700123456"], [, , "NA", "NA"], "JO", 962, "00", "0", , , "0", , , , [[, "(\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["[2356]|87"], "(0$1)"], [, "(7)(\\d{4})(\\d{4})", "$1 $2 $3", ["7[457-9]"], "0$1"], [, "(\\d{3})(\\d{5,6})", "$1 $2", ["70|8[0158]|9"], 
"0$1"]], , [, , "74(?:66|77)\\d{5}", "\\d{9}", , , "746612345"], , , [, , "NA", "NA"], [, , "8(?:10|8\\d)\\d{5}", "\\d{8}", , , "88101234"], , , [, , "NA", "NA"]], JP:[, [, , "[1-9]\\d{8,9}|00(?:[36]\\d{7,14}|7\\d{5,7}|8\\d{7})", "\\d{8,17}"], [, , "(?:1(?:1[235-8]|2[3-6]|3[3-9]|4[2-6]|[58][2-8]|6[2-7]|7[2-9]|9[1-9])|2[2-9]\\d|[36][1-9]\\d|4(?:6[02-8]|[2-578]\\d|9[2-59])|5(?:6[1-9]|7[2-8]|[2-589]\\d)|7(?:3[4-9]|4[02-9]|[25-9]\\d)|8(?:3[2-9]|4[5-9]|5[1-9]|8[03-9]|[2679]\\d)|9(?:[679][1-9]|[2-58]\\d))\\d{6}", 
"\\d{9}", , , "312345678"], [, , "[7-9]0[1-9]\\d{7}", "\\d{10}", , , "9012345678"], [, , "120\\d{6}|800\\d{7}|00(?:37\\d{6,13}|66\\d{6,13}|777(?:[01]\\d{2}|5\\d{3}|8\\d{4})|882[1245]\\d{4})", "\\d{8,17}", , , "120123456"], [, , "990\\d{6}", "\\d{9}", , , "990123456"], [, , "NA", "NA"], [, , "60\\d{7}", "\\d{9}", , , "601234567"], [, , "50[1-9]\\d{7}", "\\d{10}", , , "5012345678"], "JP", 81, "010", "0", , , "0", , , , [[, "(\\d{3})(\\d{3})(\\d{3})", "$1-$2-$3", ["(?:12|57|99)0"], "0$1"], [, "(\\d{3})(\\d{3})(\\d{4})", 
"$1-$2-$3", ["800"], "0$1"], [, "(\\d{4})(\\d{4})", "$1-$2", ["0077"], "$1"], [, "(\\d{4})(\\d{2})(\\d{3,4})", "$1-$2-$3", ["0077"], "$1"], [, "(\\d{4})(\\d{2})(\\d{4})", "$1-$2-$3", ["0088"], "$1"], [, "(\\d{4})(\\d{3})(\\d{3,4})", "$1-$2-$3", ["00(?:37|66)"], "$1"], [, "(\\d{4})(\\d{4})(\\d{4,5})", "$1-$2-$3", ["00(?:37|66)"], "$1"], [, "(\\d{4})(\\d{5})(\\d{5,6})", "$1-$2-$3", ["00(?:37|66)"], "$1"], [, "(\\d{4})(\\d{6})(\\d{6,7})", "$1-$2-$3", ["00(?:37|66)"], "$1"], [, "(\\d{2})(\\d{4})(\\d{4})", 
"$1-$2-$3", ["[2579]0|80[1-9]"], "0$1"], [, "(\\d{4})(\\d)(\\d{4})", "$1-$2-$3", ["1(?:26|3[79]|4[56]|5[4-68]|6[3-5])|5(?:76|97)|499|746|8(?:3[89]|63|47|51)|9(?:49|80|9[16])", "1(?:267|3(?:7[247]|9[278])|4(?:5[67]|66)|5(?:47|58|64|8[67])|6(?:3[245]|48|5[4-68]))|5(?:76|97)9|499[2468]|7468|8(?:3(?:8[78]|96)|636|477|51[24])|9(?:496|802|9(?:1[23]|69))", "1(?:267|3(?:7[247]|9[278])|4(?:5[67]|66)|5(?:47|58|64|8[67])|6(?:3[245]|48|5[4-68]))|5(?:769|979[2-69])|499[2468]|7468|8(?:3(?:8[78]|96[2457-9])|636[2-57-9]|477|51[24])|9(?:496|802|9(?:1[23]|69))"], 
"0$1"], [, "(\\d{3})(\\d{2})(\\d{4})", "$1-$2-$3", ["1(?:2[3-6]|3[3-9]|4[2-6]|5[2-8]|[68][2-7]|7[2-689]|9[1-578])|2(?:2[03-689]|3[3-58]|4[0-468]|5[04-8]|6[013-8]|7[06-9]|8[02-57-9]|9[13])|4(?:2[28]|3[689]|6[035-7]|7[05689]|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9[4-9])|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9[014-9])|8(?:2[49]|3[3-8]|4[5-8]|5[2-9]|6[35-9]|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9[3-7])", "1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9[2-8])|3(?:7[2-6]|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5[4-7]|6[2-9]|8[2-8]|9[236-9])|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3[34]|[4-7]))", 
"1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9(?:[3578]|20|4[04-9]|6[56]))|3(?:7(?:[2-5]|6[0-59])|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5(?:[467]|5[014-9])|6(?:[2-8]|9[02-69])|8[2-8]|9(?:[236-8]|9[23]))|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3(?:3[02-9]|4[0-24689])|4[2-69]|[5-7]))", 
"1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9(?:[3578]|20|4[04-9]|6(?:5[25]|60)))|3(?:7(?:[2-5]|6[0-59])|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5(?:[467]|5[014-9])|6(?:[2-8]|9[02-69])|8[2-8]|9(?:[236-8]|9[23]))|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3(?:3[02-9]|4[0-24689])|4[2-69]|[5-7]))"], 
"0$1"], [, "(\\d{2})(\\d{3})(\\d{4})", "$1-$2-$3", ["1|2(?:2[37]|5[5-9]|64|78|8[39]|91)|4(?:2[2689]|64|7[347])|5(?:[2-589]|39)|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93)", "1|2(?:2[37]|5(?:[57]|[68]0|9[19])|64|78|8[39]|917)|4(?:2(?:[68]|20|9[178])|64|7[347])|5(?:[2-589]|39[67])|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93[34])", "1|2(?:2[37]|5(?:[57]|[68]0|9(?:17|99))|64|78|8[39]|917)|4(?:2(?:[68]|20|9[178])|64|7[347])|5(?:[2-589]|39[67])|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93(?:31|4))"], 
"0$1"], [, "(\\d{3})(\\d{2})(\\d{4})", "$1-$2-$3", ["2(?:9[14-79]|74|[34]7|[56]9)|82|993"], "0$1"], [, "(\\d)(\\d{4})(\\d{4})", "$1-$2-$3", ["3|4(?:2[09]|7[01])|6[1-9]"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{4})", "$1-$2-$3", ["[2479][1-9]"], "0$1"]], [[, "(\\d{3})(\\d{3})(\\d{3})", "$1-$2-$3", ["(?:12|57|99)0"], "0$1"], [, "(\\d{3})(\\d{3})(\\d{4})", "$1-$2-$3", ["800"], "0$1"], [, "(\\d{2})(\\d{4})(\\d{4})", "$1-$2-$3", ["[2579]0|80[1-9]"], "0$1"], [, "(\\d{4})(\\d)(\\d{4})", "$1-$2-$3", ["1(?:26|3[79]|4[56]|5[4-68]|6[3-5])|5(?:76|97)|499|746|8(?:3[89]|63|47|51)|9(?:49|80|9[16])", 
"1(?:267|3(?:7[247]|9[278])|4(?:5[67]|66)|5(?:47|58|64|8[67])|6(?:3[245]|48|5[4-68]))|5(?:76|97)9|499[2468]|7468|8(?:3(?:8[78]|96)|636|477|51[24])|9(?:496|802|9(?:1[23]|69))", "1(?:267|3(?:7[247]|9[278])|4(?:5[67]|66)|5(?:47|58|64|8[67])|6(?:3[245]|48|5[4-68]))|5(?:769|979[2-69])|499[2468]|7468|8(?:3(?:8[78]|96[2457-9])|636[2-57-9]|477|51[24])|9(?:496|802|9(?:1[23]|69))"], "0$1"], [, "(\\d{3})(\\d{2})(\\d{4})", "$1-$2-$3", ["1(?:2[3-6]|3[3-9]|4[2-6]|5[2-8]|[68][2-7]|7[2-689]|9[1-578])|2(?:2[03-689]|3[3-58]|4[0-468]|5[04-8]|6[013-8]|7[06-9]|8[02-57-9]|9[13])|4(?:2[28]|3[689]|6[035-7]|7[05689]|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9[4-9])|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9[014-9])|8(?:2[49]|3[3-8]|4[5-8]|5[2-9]|6[35-9]|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9[3-7])", 
"1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9[2-8])|3(?:7[2-6]|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5[4-7]|6[2-9]|8[2-8]|9[236-9])|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3[34]|[4-7]))", 
"1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9(?:[3578]|20|4[04-9]|6[56]))|3(?:7(?:[2-5]|6[0-59])|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5(?:[467]|5[014-9])|6(?:[2-8]|9[02-69])|8[2-8]|9(?:[236-8]|9[23]))|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3(?:3[02-9]|4[0-24689])|4[2-69]|[5-7]))", 
"1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9(?:[3578]|20|4[04-9]|6(?:5[25]|60)))|3(?:7(?:[2-5]|6[0-59])|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5(?:[467]|5[014-9])|6(?:[2-8]|9[02-69])|8[2-8]|9(?:[236-8]|9[23]))|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3(?:3[02-9]|4[0-24689])|4[2-69]|[5-7]))"], 
"0$1"], [, "(\\d{2})(\\d{3})(\\d{4})", "$1-$2-$3", ["1|2(?:2[37]|5[5-9]|64|78|8[39]|91)|4(?:2[2689]|64|7[347])|5(?:[2-589]|39)|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93)", "1|2(?:2[37]|5(?:[57]|[68]0|9[19])|64|78|8[39]|917)|4(?:2(?:[68]|20|9[178])|64|7[347])|5(?:[2-589]|39[67])|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93[34])", "1|2(?:2[37]|5(?:[57]|[68]0|9(?:17|99))|64|78|8[39]|917)|4(?:2(?:[68]|20|9[178])|64|7[347])|5(?:[2-589]|39[67])|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93(?:31|4))"], 
"0$1"], [, "(\\d{3})(\\d{2})(\\d{4})", "$1-$2-$3", ["2(?:9[14-79]|74|[34]7|[56]9)|82|993"], "0$1"], [, "(\\d)(\\d{4})(\\d{4})", "$1-$2-$3", ["3|4(?:2[09]|7[01])|6[1-9]"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{4})", "$1-$2-$3", ["[2479][1-9]"], "0$1"]], [, , "20\\d{8}", "\\d{10}", , , "2012345678"], , , [, , "00(?:37\\d{6,13}|66\\d{6,13}|777(?:[01]\\d{2}|5\\d{3}|8\\d{4})|882[1245]\\d{4})", "\\d{8,17}", , , "00777012"], [, , "570\\d{6}", "\\d{9}", , , "570123456"], 1, , [, , "NA", "NA"]], KE:[, [, , "20\\d{6,7}|[4-9]\\d{6,9}", 
"\\d{7,10}"], [, , "20\\d{6,7}|4(?:[0136]\\d{7}|[245]\\d{5,7})|5(?:[08]\\d{7}|[1-79]\\d{5,7})|6(?:[01457-9]\\d{5,7}|[26]\\d{7})", "\\d{7,9}", , , "202012345"], [, , "7(?:[0-36]\\d|5[0-6]|[79][0-7]|8[0-25-9])\\d{6}", "\\d{9}", , , "712123456"], [, , "800[24-8]\\d{5,6}", "\\d{9,10}", , , "800223456"], [, , "900[02-9]\\d{5}", "\\d{9}", , , "900223456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "KE", 254, "000", "0", , , "005|0", , , , [[, "(\\d{2})(\\d{5,7})", "$1 $2", ["[24-6]"], "0$1"], 
[, "(\\d{3})(\\d{6})", "$1 $2", ["7"], "0$1"], [, "(\\d{3})(\\d{3})(\\d{3,4})", "$1 $2 $3", ["[89]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], KG:[, [, , "[235-8]\\d{8,9}", "\\d{5,10}"], [, , "(?:3(?:1(?:[256]\\d|3[1-9]|47)|2(?:22|3[0-479]|6[0-7])|4(?:22|5[6-9]|6\\d)|5(?:22|3[4-7]|59|6\\d)|6(?:22|5[35-7]|6\\d)|7(?:22|3[468]|4[1-9]|59|[67]\\d)|9(?:22|4[1-8]|6\\d))|6(?:09|12|2[2-4])\\d)\\d{5}", "\\d{5,10}", , , "312123456"], [, , "(?:20[0-35]|5[124-7]\\d|7[07]\\d)\\d{6}", 
"\\d{9}", , , "700123456"], [, , "800\\d{6,7}", "\\d{9,10}", , , "800123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "KG", 996, "00", "0", , , "0", , , , [[, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3", ["[25-7]|31[25]"], "0$1"], [, "(\\d{4})(\\d{5})", "$1 $2", ["3(?:1[36]|[2-9])"], "0$1"], [, "(\\d{3})(\\d{3})(\\d)(\\d{3})", "$1 $2 $3 $4", ["8"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], KH:[, [, , "[1-9]\\d{7,9}", "\\d{6,10}"], 
[, , "(?:2[3-6]|3[2-6]|4[2-4]|[5-7][2-5])(?:[237-9]|4[56]|5\\d|6\\d?)\\d{5}|23(?:4[234]|8\\d{2})\\d{4}", "\\d{6,9}", , , "23756789"], [, , "(?:1(?:[013-79]\\d|[28]\\d{1,2})|2[3-6]48|3(?:[18]\\d{2}|[2-6]48)|4[2-4]48|5[2-5]48|6(?:[016-9]\\d|[2-5]48)|7(?:[07-9]\\d|[16]\\d{2}|[2-5]48)|8(?:[013-79]\\d|8\\d{2})|9(?:6\\d{2}|7\\d{1,2}|[0-589]\\d))\\d{5}", "\\d{8,9}", , , "91234567"], [, , "1800(?:1\\d|2[019])\\d{4}", "\\d{10}", , , "1800123456"], [, , "1900(?:1\\d|2[09])\\d{4}", "\\d{10}", , , "1900123456"], 
[, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "KH", 855, "00[14-9]", "0", , , "0", , , , [[, "(\\d{2})(\\d{3})(\\d{3,4})", "$1 $2 $3", ["1\\d[1-9]|[2-9]"], "0$1"], [, "(1[89]00)(\\d{3})(\\d{3})", "$1 $2 $3", ["1[89]0"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], KI:[, [, , "[2458]\\d{4}|3\\d{4,7}|7\\d{7}", "\\d{5,8}"], [, , "(?:[24]\\d|3[1-9]|50|8[0-5])\\d{3}", "\\d{5}", , , "31234"], [, , "7\\d{7}", "\\d{8}", , , "72012345"], [, , "NA", "NA"], [, 
, "3001\\d{4}", "\\d{5,8}", , , "30010000"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "KI", 686, "00", , , , "0", , , , , , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], KM:[, [, , "[379]\\d{6}", "\\d{7}"], [, , "7(?:6[0-37-9]|7[0-57-9])\\d{4}", "\\d{7}", , , "7712345"], [, , "3[234]\\d{5}", "\\d{7}", , , "3212345"], [, , "NA", "NA"], [, , "(?:39[01]|9[01]0)\\d{4}", "\\d{7}", , , "9001234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "KM", 
269, "00", , , , , , , , [[, "(\\d{3})(\\d{2})(\\d{2})", "$1 $2 $3"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], KN:[, [, , "[589]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "869(?:2(?:29|36)|302|4(?:6[015-9]|70))\\d{4}", "\\d{7}(?:\\d{3})?", , , "8692361234"], [, , "869(?:5(?:5[6-8]|6[5-7])|66\\d|76[02-7])\\d{4}", "\\d{10}", , , "8697652917"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002123456"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], 
[, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "KN", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "869", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], KP:[, [, , "1\\d{9}|[28]\\d{7}", "\\d{6,8}|\\d{10}"], [, , "2\\d{7}|85\\d{6}", "\\d{6,8}", , , "21234567"], [, , "19[123]\\d{7}", "\\d{10}", , , "1921234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "KP", 850, "00|99", 
"0", , , "0", , , , [[, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["1"], "0$1"], [, "(\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["2"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["8"], "0$1"]], , [, , "NA", "NA"], , , [, , "2(?:[0-24-9]\\d{2}|3(?:[0-79]\\d|8[02-9]))\\d{4}", "\\d{8}", , , "23821234"], [, , "NA", "NA"], , , [, , "NA", "NA"]], KR:[, [, , "007\\d{9,11}|[1-7]\\d{3,9}|8\\d{8}", "\\d{4,14}"], [, , "(?:2|3[1-3]|[46][1-4]|5[1-5])(?:1\\d{2,3}|[1-9]\\d{6,7})", "\\d{4,10}", , , "22123456"], [, 
, "1[0-26-9]\\d{7,8}", "\\d{9,10}", , , "1000000000"], [, , "(?:00798\\d{0,2}|80)\\d{7}", "\\d{9,14}", , , "801234567"], [, , "60[2-9]\\d{6}", "\\d{9}", , , "602345678"], [, , "NA", "NA"], [, , "50\\d{8}", "\\d{10}", , , "5012345678"], [, , "70\\d{8}", "\\d{10}", , , "7012345678"], "KR", 82, "00(?:[124-68]|3\\d{2}|7(?:[0-8]\\d|9[0-79]))", "0", , , "0(8[1-46-8]|85\\d{2})?", , , , [[, "(\\d{5})(\\d{3,4})(\\d{4})", "$1 $2 $3", ["00798"], "$1", "0$CC-$1"], [, "(\\d{5})(\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3 $4", 
["00798"], "$1", "0$CC-$1"], [, "(\\d{2})(\\d{4})(\\d{4})", "$1-$2-$3", ["1(?:0|1[19]|[69]9|5[458])|[57]0", "1(?:0|1[19]|[69]9|5(?:44|59|8))|[57]0"], "0$1", "0$CC-$1"], [, "(\\d{2})(\\d{3,4})(\\d{4})", "$1-$2-$3", ["1(?:[01]|5[1-4]|6[2-8]|[7-9])|[68]0|[3-6][1-9][1-9]", "1(?:[01]|5(?:[1-3]|4[56])|6[2-8]|[7-9])|[68]0|[3-6][1-9][1-9]"], "0$1", "0$CC-$1"], [, "(\\d{3})(\\d)(\\d{4})", "$1-$2-$3", ["131", "1312"], "0$1", "0$CC-$1"], [, "(\\d{3})(\\d{2})(\\d{4})", "$1-$2-$3", ["131", "131[13-9]"], "0$1", 
"0$CC-$1"], [, "(\\d{3})(\\d{3})(\\d{4})", "$1-$2-$3", ["13[2-9]"], "0$1", "0$CC-$1"], [, "(\\d{2})(\\d{2})(\\d{3})(\\d{4})", "$1-$2-$3-$4", ["30"], "0$1", "0$CC-$1"], [, "(\\d)(\\d{3,4})(\\d{4})", "$1-$2-$3", ["2[1-9]"], "0$1", "0$CC-$1"], [, "(\\d)(\\d{3,4})", "$1-$2", ["21[0-46-9]"], "0$1", "0$CC-$1"], [, "(\\d{2})(\\d{3,4})", "$1-$2", ["[3-6][1-9]1", "[3-6][1-9]1(?:[0-46-9])"], "0$1", "0$CC-$1"], [, "(\\d{4})(\\d{4})", "$1-$2", ["1(?:5[46-9]|6[04678]|8[03579])", "1(?:5(?:44|66|77|88|99)|6(?:00|44|6[16]|70|88)|8(?:00|33|55|77|99))"], 
"$1", "0$CC-$1"]], [[, "(\\d{2})(\\d{4})(\\d{4})", "$1-$2-$3", ["1(?:0|1[19]|[69]9|5[458])|[57]0", "1(?:0|1[19]|[69]9|5(?:44|59|8))|[57]0"], "0$1", "0$CC-$1"], [, "(\\d{2})(\\d{3,4})(\\d{4})", "$1-$2-$3", ["1(?:[01]|5[1-4]|6[2-8]|[7-9])|[68]0|[3-6][1-9][1-9]", "1(?:[01]|5(?:[1-3]|4[56])|6[2-8]|[7-9])|[68]0|[3-6][1-9][1-9]"], "0$1", "0$CC-$1"], [, "(\\d{3})(\\d)(\\d{4})", "$1-$2-$3", ["131", "1312"], "0$1", "0$CC-$1"], [, "(\\d{3})(\\d{2})(\\d{4})", "$1-$2-$3", ["131", "131[13-9]"], "0$1", "0$CC-$1"], 
[, "(\\d{3})(\\d{3})(\\d{4})", "$1-$2-$3", ["13[2-9]"], "0$1", "0$CC-$1"], [, "(\\d{2})(\\d{2})(\\d{3})(\\d{4})", "$1-$2-$3-$4", ["30"], "0$1", "0$CC-$1"], [, "(\\d)(\\d{3,4})(\\d{4})", "$1-$2-$3", ["2[1-9]"], "0$1", "0$CC-$1"], [, "(\\d)(\\d{3,4})", "$1-$2", ["21[0-46-9]"], "0$1", "0$CC-$1"], [, "(\\d{2})(\\d{3,4})", "$1-$2", ["[3-6][1-9]1", "[3-6][1-9]1(?:[0-46-9])"], "0$1", "0$CC-$1"], [, "(\\d{4})(\\d{4})", "$1-$2", ["1(?:5[46-9]|6[04678]|8[03579])", "1(?:5(?:44|66|77|88|99)|6(?:00|44|6[16]|70|88)|8(?:00|33|55|77|99))"], 
"$1", "0$CC-$1"]], [, , "15\\d{7,8}", "\\d{9,10}", , , "1523456789"], , , [, , "00798\\d{7,9}", "\\d{12,14}", , , "007981234567"], [, , "1(?:5(?:44|66|77|88|99)|6(?:00|44|6[16]|70|88)|8(?:00|33|55|77|99))\\d{4}", "\\d{8}", , , "15441234"], , , [, , "NA", "NA"]], KW:[, [, , "[12569]\\d{6,7}", "\\d{7,8}"], [, , "(?:18\\d|2(?:[23]\\d{2}|4(?:[1-35-9]\\d|44)|5(?:0[034]|[2-46]\\d|5[1-3]|7[1-7])))\\d{4}", "\\d{7,8}", , , "22345678"], [, , "(?:5(?:[05]\\d{2}|1[0-7]\\d|2(?:22|5[25])|66\\d)|6(?:0[034679]\\d|222|5[015-9]\\d|6\\d{2}|7[067]\\d|9[0369]\\d)|9(?:0[09]\\d|22\\d|4[01479]\\d|55\\d|6[0679]\\d|[79]\\d{2}|8[057-9]\\d))\\d{4}", 
"\\d{8}", , , "50012345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "KW", 965, "00", , , , , , , , [[, "(\\d{4})(\\d{3,4})", "$1 $2", ["[16]|2(?:[0-35-9]|4[0-35-9])|9[024-9]|52[25]"]], [, "(\\d{3})(\\d{5})", "$1 $2", ["244|5(?:[015]|66)"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], KY:[, [, , "[3589]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "345(?:2(?:22|44)|444|6(?:23|38|40)|7(?:4[35-79]|6[6-9]|77)|8(?:00|1[45]|25|[48]8)|9(?:14|4[035-9]))\\d{4}", 
"\\d{7}(?:\\d{3})?", , , "3452221234"], [, , "345(?:32[1-9]|5(?:1[67]|2[5-7]|4[6-8]|76)|9(?:1[67]|2[2-9]|3[689]))\\d{4}", "\\d{10}", , , "3453231234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002345678"], [, , "900[2-9]\\d{6}|345976\\d{4}", "\\d{10}", , , "9002345678"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "KY", 1, "011", "1", , , "1", , , , , , [, , "345849\\d{4}", "\\d{10}", , , "3458491234"], , "345", [, 
, "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], KZ:[, [, , "(?:33\\d|7\\d{2}|80[09])\\d{7}", "\\d{10}"], [, , "33622\\d{5}|7(?:1(?:0(?:[23]\\d|4[023]|59|63)|1(?:[23]\\d|4[0-79]|59)|2(?:[23]\\d|59)|3(?:2\\d|3[1-79]|4[0-35-9]|59)|4(?:2\\d|3[013-79]|4[0-8]|5[1-79])|5(?:2\\d|3[1-8]|4[1-7]|59)|6(?:[234]\\d|5[19]|61)|72\\d|8(?:[27]\\d|3[1-46-9]|4[0-5]))|2(?:1(?:[23]\\d|4[46-9]|5[3469])|2(?:2\\d|3[0679]|46|5[12679])|3(?:[234]\\d|5[139])|4(?:2\\d|3[1235-9]|59)|5(?:[23]\\d|4[01246-8]|59|61)|6(?:2\\d|3[1-9]|4[0-4]|59)|7(?:[237]\\d|40|5[279])|8(?:[23]\\d|4[0-3]|59)|9(?:2\\d|3[124578]|59)))\\d{5}", 
"\\d{10}", , , "7123456789"], [, , "7(?:0[012578]|47|6[02-4]|7[15-8]|85)\\d{7}", "\\d{10}", , , "7710009998"], [, , "800\\d{7}", "\\d{10}", , , "8001234567"], [, , "809\\d{7}", "\\d{10}", , , "8091234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "751\\d{7}", "\\d{10}", , , "7511234567"], "KZ", 7, "810", "8", , , "8", , "8~10", , , , [, , "NA", "NA"], , , [, , "751\\d{7}", "\\d{10}", , , "7511234567"], [, , "NA", "NA"], , , [, , "NA", "NA"]], LA:[, [, , "[2-8]\\d{7,9}", "\\d{6,10}"], [, , "(?:2[13]|3(?:0\\d|[14])|[5-7][14]|41|8[1468])\\d{6}", 
"\\d{6,9}", , , "21212862"], [, , "20(?:2[2389]|5[4-689]|7[6-8]|9[15-9])\\d{6}", "\\d{10}", , , "2023123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "LA", 856, "00", "0", , , "0", , , , [[, "(20)(\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3 $4", ["20"], "0$1"], [, "([2-8]\\d)(\\d{3})(\\d{3})", "$1 $2 $3", ["2[13]|3[14]|[4-8]"], "0$1"], [, "(30)(\\d{2})(\\d{2})(\\d{3})", "$1 $2 $3 $4", ["30"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", 
"NA"], , , [, , "NA", "NA"]], LB:[, [, , "[13-9]\\d{6,7}", "\\d{7,8}"], [, , "(?:[14-6]\\d{2}|7(?:[2-57]\\d|62|8[0-7]|9[04-9])|8[02-9]\\d|9\\d{2})\\d{4}", "\\d{7}", , , "1123456"], [, , "(?:3\\d|7(?:[01]\\d|6[013-9]|8[89]|9[1-3])|81\\d)\\d{5}", "\\d{7,8}", , , "71123456"], [, , "NA", "NA"], [, , "9[01]\\d{6}", "\\d{8}", , , "90123456"], [, , "80\\d{6}", "\\d{8}", , , "80123456"], [, , "NA", "NA"], [, , "NA", "NA"], "LB", 961, "00", "0", , , "0", , , , [[, "(\\d)(\\d{3})(\\d{3})", "$1 $2 $3", ["[13-6]|7(?:[2-57]|62|8[0-7]|9[04-9])|8[02-9]|9"], 
"0$1"], [, "([7-9]\\d)(\\d{3})(\\d{3})", "$1 $2 $3", ["[89][01]|7(?:[01]|6[013-9]|8[89]|9[1-3])"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], LC:[, [, , "[5789]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "758(?:4(?:30|5[0-9]|6[2-9]|8[0-2])|57[0-2]|638)\\d{4}", "\\d{7}(?:\\d{3})?", , , "7584305678"], [, , "758(?:28[4-7]|384|4(?:6[01]|8[4-9])|5(?:1[89]|20|84)|7(?:1[2-9]|2[0-8]))\\d{4}", "\\d{10}", , , "7582845678"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", 
, , "8002123456"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "LC", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "758", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], LI:[, [, , "6\\d{8}|[23789]\\d{6}", "\\d{7,9}"], [, , "(?:2(?:01|1[27]|3\\d|6[02-578]|96)|3(?:7[0135-7]|8[048]|9[0269]))\\d{4}", "\\d{7}", , , "2345678"], [, , "6(?:51[01]|6(?:0[0-6]|2[016-9]|39))\\d{5}|7(?:[37-9]\\d|42|56)\\d{4}", 
"\\d{7,9}", , , "660234567"], [, , "80(?:02[28]|9\\d{2})\\d{2}", "\\d{7}", , , "8002222"], [, , "90(?:02[258]|1(?:23|3[14])|66[136])\\d{2}", "\\d{7}", , , "9002222"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "LI", 423, "00", "0", , , "0", , , , [[, "(\\d{3})(\\d{2})(\\d{2})", "$1 $2 $3", ["[23789]"]], [, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3", ["6[56]"]], [, "(69)(7\\d{2})(\\d{4})", "$1 $2 $3", ["697"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "870(?:28|87)\\d{2}", "\\d{7}", 
, , "8702812"], , , [, , "697(?:42|56|[7-9]\\d)\\d{4}", "\\d{9}", , , "697861234"]], LK:[, [, , "[1-9]\\d{8}", "\\d{7,9}"], [, , "(?:[189]1|2[13-7]|3[1-8]|4[157]|5[12457]|6[35-7])[2-57]\\d{6}", "\\d{7,9}", , , "112345678"], [, , "7[0125-8]\\d{7}", "\\d{9}", , , "712345678"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "LK", 94, "00", "0", , , "0", , , , [[, "(\\d{2})(\\d{1})(\\d{6})", "$1 $2 $3", ["[1-689]"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", 
["7"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], LR:[, [, , "2\\d{7,8}|[37-9]\\d{8}|4\\d{6}|5\\d{6,8}", "\\d{7,9}"], [, , "2\\d{7}", "\\d{8}", , , "21234567"], [, , "(?:330\\d|4[67]|5\\d|77\\d{2}|88\\d{2}|994\\d)\\d{5}|(?:20\\d{3}|33(?:0\\d{2}|2(?:02|5\\d))|555\\d{2}|77[0567]\\d{2}|88[068]\\d{2}|994\\d{2})\\d{4}", "\\d{7,9}", , , "770123456"], [, , "NA", "NA"], [, , "90[03]\\d{6}", "\\d{9}", , , "900123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, 
, "332(?:0[02]|5\\d)\\d{4}", "\\d{9}", , , "332001234"], "LR", 231, "00", "0", , , "0", , , , [[, "(2\\d)(\\d{3})(\\d{3})", "$1 $2 $3", ["2"], "0$1"], [, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3", ["[2579]"], "0$1"], [, "([4-6])(\\d{3})(\\d{3})", "$1 $2 $3", ["[4-6]"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["[38]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], LS:[, [, , "[2568]\\d{7}", "\\d{8}"], [, , "2\\d{7}", "\\d{8}", , , "22123456"], 
[, , "[56]\\d{7}", "\\d{8}", , , "50123456"], [, , "800[256]\\d{4}", "\\d{8}", , , "80021234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "LS", 266, "00", , , , , , , , [[, "(\\d{4})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], LT:[, [, , "[3-9]\\d{7}", "\\d{8}"], [, , "(?:3[1478]|4[124-6]|52)\\d{6}", "\\d{8}", , , "31234567"], [, , "6\\d{7}", "\\d{8}", , , "61234567"], [, , "800\\d{5}", "\\d{8}", , , "80012345"], 
[, , "9(?:0[0239]|10)\\d{5}", "\\d{8}", , , "90012345"], [, , "808\\d{5}", "\\d{8}", , , "80812345"], [, , "700\\d{5}", "\\d{8}", , , "70012345"], [, , "NA", "NA"], "LT", 370, "00", "8", , , "[08]", , , , [[, "([34]\\d)(\\d{6})", "$1 $2", ["37|4(?:1|5[45]|6[2-4])"], "(8-$1)", , 1], [, "([3-6]\\d{2})(\\d{5})", "$1 $2", ["3[148]|4(?:[24]|6[09])|528|6"], "(8-$1)", , 1], [, "([7-9]\\d{2})(\\d{2})(\\d{3})", "$1 $2 $3", ["[7-9]"], "8 $1", , 1], [, "(5)(2\\d{2})(\\d{4})", "$1 $2 $3", ["52[0-79]"], "(8-$1)", 
, 1]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "70[67]\\d{5}", "\\d{8}", , , "70712345"], , , [, , "NA", "NA"]], LU:[, [, , "[24-9]\\d{3,10}|3(?:[0-46-9]\\d{2,9}|5[013-9]\\d{1,8})", "\\d{4,11}"], [, , "(?:2[2-9]\\d{2,9}|(?:[3457]\\d{2}|8(?:0[2-9]|[13-9]\\d)|9(?:0[89]|[2-579]\\d))\\d{1,8})", "\\d{4,11}", , , "27123456"], [, , "6[2679][18]\\d{6}", "\\d{9}", , , "628123456"], [, , "800\\d{5}", "\\d{8}", , , "80012345"], [, , "90[015]\\d{5}", "\\d{8}", , , "90012345"], [, , "801\\d{5}", "\\d{8}", 
, , "80112345"], [, , "70\\d{6}", "\\d{8}", , , "70123456"], [, , "20(?:1\\d{5}|[2-689]\\d{1,7})", "\\d{4,10}", , , "20201234"], "LU", 352, "00", , , , "(15(?:0[06]|1[12]|35|4[04]|55|6[26]|77|88|99)\\d)", , , , [[, "(\\d{2})(\\d{3})", "$1 $2", ["[2-5]|7[1-9]|[89](?:[1-9]|0[2-9])"], , "$CC $1"], [, "(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3", ["[2-5]|7[1-9]|[89](?:[1-9]|0[2-9])"], , "$CC $1"], [, "(\\d{2})(\\d{2})(\\d{3})", "$1 $2 $3", ["20"], , "$CC $1"], [, "(\\d{2})(\\d{2})(\\d{2})(\\d{1,2})", "$1 $2 $3 $4", 
["2(?:[0367]|4[3-8])"], , "$CC $1"], [, "(\\d{2})(\\d{2})(\\d{2})(\\d{3})", "$1 $2 $3 $4", ["20"], , "$CC $1"], [, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{1,2})", "$1 $2 $3 $4 $5", ["2(?:[0367]|4[3-8])"], , "$CC $1"], [, "(\\d{2})(\\d{2})(\\d{2})(\\d{1,4})", "$1 $2 $3 $4", ["2(?:[12589]|4[12])|[3-5]|7[1-9]|8(?:[1-9]|0[2-9])|9(?:[1-9]|0[2-46-9])"], , "$CC $1"], [, "(\\d{3})(\\d{2})(\\d{3})", "$1 $2 $3", ["70|80[01]|90[015]"], , "$CC $1"], [, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3", ["6"], , "$CC $1"]], 
, [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], LV:[, [, , "[2689]\\d{7}", "\\d{8}"], [, , "6\\d{7}", "\\d{8}", , , "63123456"], [, , "2\\d{7}", "\\d{8}", , , "21234567"], [, , "80\\d{6}", "\\d{8}", , , "80123456"], [, , "90\\d{6}", "\\d{8}", , , "90123456"], [, , "81\\d{6}", "\\d{8}", , , "81123456"], [, , "NA", "NA"], [, , "NA", "NA"], "LV", 371, "00", , , , , , , , [[, "([2689]\\d)(\\d{3})(\\d{3})", "$1 $2 $3"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , 
"NA", "NA"], , , [, , "NA", "NA"]], LY:[, [, , "[25679]\\d{8}", "\\d{7,9}"], [, , "(?:2[1345]|5[1347]|6[123479]|71)\\d{7}", "\\d{7,9}", , , "212345678"], [, , "9[1-6]\\d{7}", "\\d{9}", , , "912345678"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "LY", 218, "00", "0", , , "0", , , , [[, "([25679]\\d)(\\d{7})", "$1-$2", , "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], MA:[, [, , "[5689]\\d{8}", "\\d{9}"], [, 
, "5(?:2(?:(?:[015-7]\\d|2[02-9]|3[2-57]|4[2-8]|8[235-7])\\d|9(?:0\\d|[89]0))|3(?:(?:[0-4]\\d|[57][2-9]|6[235-8]|9[3-9])\\d|8(?:0\\d|[89]0)))\\d{4}", "\\d{9}", , , "520123456"], [, , "6(?:0[0-8]|[12-79]\\d|8[017])\\d{6}", "\\d{9}", , , "650123456"], [, , "80\\d{7}", "\\d{9}", , , "801234567"], [, , "89\\d{7}", "\\d{9}", , , "891234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "MA", 212, "00", "0", , , "0", , , , [[, "([56]\\d{2})(\\d{6})", "$1-$2", ["5(?:2[015-7]|3[0-4])|6"], "0$1"], 
[, "([58]\\d{3})(\\d{5})", "$1-$2", ["5(?:2[2-489]|3[5-9])|892", "5(?:2(?:[2-48]|90)|3(?:[5-79]|80))|892"], "0$1"], [, "(5\\d{4})(\\d{4})", "$1-$2", ["5(?:29|38)", "5(?:29|38)[89]"], "0$1"], [, "(8[09])(\\d{7})", "$1-$2", ["8(?:0|9[013-9])"], "0$1"]], , [, , "NA", "NA"], 1, , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], MC:[, [, , "[4689]\\d{7,8}", "\\d{8,9}"], [, , "870\\d{5}|9[2-47-9]\\d{6}", "\\d{8}", , , "99123456"], [, , "6\\d{8}|4(?:4\\d|5[1-9])\\d{5}", "\\d{8,9}", , , "612345678"], 
[, , "90\\d{6}", "\\d{8}", , , "90123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "MC", 377, "00", "0", , , "0", , , , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["9"], "$1"], [, "(\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["4"], "0$1"], [, "(6)(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4 $5", ["6"], "0$1"], [, "(\\d{3})(\\d{3})(\\d{2})", "$1 $2 $3", ["8"], "$1"]], , [, , "NA", "NA"], , , [, , "8\\d{7}", "\\d{8}"], [, , "NA", "NA"], , , [, , "NA", "NA"]], 
MD:[, [, , "[235-9]\\d{7}", "\\d{8}"], [, , "(?:2(?:1[0569]|2\\d|3[015-7]|4[1-46-9]|5[0-24689]|6[2-589]|7[1-37]|9[1347-9])|5(?:33|5[257]))\\d{5}", "\\d{8}", , , "22212345"], [, , "(?:562\\d|6(?:[089]\\d{2}|[12][01]\\d|7(?:[1-6]\\d|7[0-4]))|7(?:6[07]|7[457-9]|[89]\\d)\\d)\\d{4}", "\\d{8}", , , "62112345"], [, , "800\\d{5}", "\\d{8}", , , "80012345"], [, , "90[056]\\d{5}", "\\d{8}", , , "90012345"], [, , "808\\d{5}", "\\d{8}", , , "80812345"], [, , "NA", "NA"], [, , "3[08]\\d{6}", "\\d{8}", , , "30123456"], 
"MD", 373, "00", "0", , , "0", , , , [[, "(\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["22|3"], "0$1"], [, "([25-7]\\d{2})(\\d{2})(\\d{3})", "$1 $2 $3", ["2[13-79]|[5-7]"], "0$1"], [, "([89]\\d{2})(\\d{5})", "$1 $2", ["[89]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "8(?:03|14)\\d{5}", "\\d{8}", , , "80312345"], , , [, , "NA", "NA"]], ME:[, [, , "[2-9]\\d{7,8}", "\\d{6,9}"], [, , "(?:20[2-8]|3(?:0[2-7]|[12][35-7]|3[4-7])|4(?:0[2367]|1[267])|5(?:0[467]|1[267]|2[367]))\\d{5}", "\\d{6,8}", 
, , "30234567"], [, , "6(?:00\\d|3[24]\\d|61\\d|7(?:[0-8]\\d|9(?:[3-9]|[0-2]\\d))|[89]\\d{2})\\d{4}", "\\d{8,9}", , , "67622901"], [, , "80\\d{6}", "\\d{8}", , , "80080002"], [, , "(?:9(?:4[1568]|5[178]))\\d{5}", "\\d{8}", , , "94515151"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "78[1-9]\\d{5}", "\\d{8}", , , "78108780"], "ME", 382, "00", "0", , , "0", , , , [[, "(\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["[2-57-9]|6[036-9]", "[2-57-9]|6(?:[03689]|7(?:[0-8]|9[3-9]))"], "0$1"], [, "(67)(9)(\\d{3})(\\d{3})", 
"$1 $2 $3 $4", ["679", "679[0-2]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "77\\d{6}", "\\d{8}", , , "77273012"], , , [, , "NA", "NA"]], MF:[, [, , "[56]\\d{8}", "\\d{9}"], [, , "590(?:[02][79]|13|5[0-268]|[78]7)\\d{4}", "\\d{9}", , , "590271234"], [, , "690(?:0[0-7]|[1-9]\\d)\\d{4}", "\\d{9}", , , "690301234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "MF", 590, "00", "0", , , "0", , , , , , [, , "NA", "NA"], , , [, , "NA", "NA"], 
[, , "NA", "NA"], , , [, , "NA", "NA"]], MG:[, [, , "[23]\\d{8}", "\\d{7,9}"], [, , "20(?:2\\d{2}|4[47]\\d|5[3467]\\d|6[279]\\d|7(?:2[29]|[35]\\d)|8[268]\\d|9[245]\\d)\\d{4}", "\\d{7,9}", , , "202123456"], [, , "3[2-49]\\d{7}", "\\d{9}", , , "321234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "22\\d{7}", "\\d{9}", , , "221234567"], "MG", 261, "00", "0", , , "0", , , , [[, "([23]\\d)(\\d{2})(\\d{3})(\\d{2})", "$1 $2 $3 $4", , "0$1"]], , [, , "NA", "NA"], , , 
[, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], MH:[, [, , "[2-6]\\d{6}", "\\d{7}"], [, , "(?:247|528|625)\\d{4}", "\\d{7}", , , "2471234"], [, , "(?:235|329|45[56]|545)\\d{4}", "\\d{7}", , , "2351234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "635\\d{4}", "\\d{7}", , , "6351234"], "MH", 692, "011", "1", , , "1", , , , [[, "(\\d{3})(\\d{4})", "$1-$2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], MK:[, [, , "[2-578]\\d{7}", 
"\\d{8}"], [, , "(?:2(?:[23]\\d|5[124578]|6[01])|3(?:1[3-6]|[23][2-6]|4[2356])|4(?:[23][2-6]|4[3-6]|5[256]|6[25-8]|7[24-6]|8[4-6]))\\d{5}", "\\d{6,8}", , , "22212345"], [, , "7(?:[0-25-8]\\d{2}|32\\d|421)\\d{4}", "\\d{8}", , , "72345678"], [, , "800\\d{5}", "\\d{8}", , , "80012345"], [, , "5[02-9]\\d{6}", "\\d{8}", , , "50012345"], [, , "8(?:0[1-9]|[1-9]\\d)\\d{5}", "\\d{8}", , , "80123456"], [, , "NA", "NA"], [, , "NA", "NA"], "MK", 389, "00", "0", , , "0", , , , [[, "(2)(\\d{3})(\\d{4})", "$1 $2 $3", 
["2"], "0$1"], [, "([347]\\d)(\\d{3})(\\d{3})", "$1 $2 $3", ["[347]"], "0$1"], [, "([58]\\d{2})(\\d)(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[58]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], ML:[, [, , "[246-9]\\d{7}", "\\d{8}"], [, , "(?:2(?:0(?:2\\d|7[0-8])|1(?:2[5-7]|[3-689]\\d))|44[1239]\\d)\\d{4}", "\\d{8}", , , "20212345"], [, , "(?:2(?:079|17\\d)|[679]\\d{3}|8[239]\\d{2})\\d{4}", "\\d{8}", , , "65012345"], [, , "80\\d{6}", "\\d{8}", , , "80012345"], 
[, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "ML", 223, "00", , , , , , , , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[246-9]"]], [, "(\\d{4})", "$1", ["67|74"]]], [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[246-9]"]]], [, , "NA", "NA"], , , [, , "80\\d{6}", "\\d{8}", , , "80012345"], [, , "NA", "NA"], , , [, , "NA", "NA"]], MM:[, [, , "[14578]\\d{5,7}|[26]\\d{5,8}|9(?:2\\d{0,2}|[58]|3\\d|4\\d{1,2}|6\\d?|[79]\\d{0,2})\\d{6}", "\\d{5,10}"], [, 
, "1(?:2\\d{1,2}|[3-5]\\d|6\\d?|[89][0-6]\\d)\\d{4}|2(?:2(?:000\\d{3}|\\d{4})|3\\d{4}|4(?:0\\d{5}|\\d{4})|5(?:1\\d{3,6}|[02-9]\\d{3,5})|[6-9]\\d{4})|4(?:2[245-8]|[346][2-6]|5[3-5])\\d{4}|5(?:2(?:20?|[3-8])|3[2-68]|4(?:21?|[4-8])|5[23]|6[2-4]|7[2-8]|8[24-7]|9[2-7])\\d{4}|6(?:0[23]|1[2356]|[24][2-6]|3[24-6]|5[2-4]|6[2-8]|7(?:[2367]|4\\d|5\\d?|8[145]\\d)|8[245]|9[24])\\d{4}|7(?:[04][24-8]|[15][2-7]|22|3[2-4])\\d{4}|8(?:1(?:2\\d{1,2}|[3-689]\\d)|2(?:2\\d|3(?:\\d|20)|[4-8]\\d)|3[24]\\d|4[24-7]\\d|5[245]\\d|6[23]\\d)\\d{3}", 
"\\d{5,9}", , , "1234567"], [, , "17[01]\\d{4}|9(?:2(?:[0-4]|5\\d{2}|6[0-5]\\d)|3[0-36]\\d|4(?:0[0-4]\\d|[1379]\\d|2\\d{2}|4[0-589]\\d|5\\d{2}|88)|5[0-6]|61?\\d|7(?:3\\d|[789]\\d{2})|8\\d|9(?:1\\d|[67]\\d{2}|[089]))\\d{5}", "\\d{7,10}", , , "92123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "1333\\d{4}", "\\d{8}", , , "13331234"], "MM", 95, "00", "0", , , "0", , , , [[, "(\\d)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["1|2[245]"], "0$1"], [, "(2)(\\d{4})(\\d{4})", "$1 $2 $3", 
["251"], "0$1"], [, "(\\d)(\\d{2})(\\d{3})", "$1 $2 $3", ["16|2"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{3,4})", "$1 $2 $3", ["67|81"], "0$1"], [, "(\\d{2})(\\d{2})(\\d{3,4})", "$1 $2 $3", ["[4-8]"], "0$1"], [, "(9)(\\d{3})(\\d{4,6})", "$1 $2 $3", ["9(?:2[0-4]|[35-9]|4[137-9])"], "0$1"], [, "(9)([34]\\d{4})(\\d{4})", "$1 $2 $3", ["9(?:3[0-36]|4[0-57-9])"], "0$1"], [, "(9)(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3 $4", ["92[56]"], "0$1"], [, "(9)(\\d{3})(\\d{3})(\\d{2})", "$1 $2 $3 $4", ["93"], "0$1"]], , [, 
, "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], MN:[, [, , "[12]\\d{7,9}|[57-9]\\d{7}", "\\d{6,10}"], [, , "[12](?:1\\d|2(?:[1-3]\\d?|7\\d)|3[2-8]\\d{1,2}|4[2-68]\\d{1,2}|5[1-4689]\\d{1,2})\\d{5}|5[0568]\\d{6}", "\\d{6,10}", , , "50123456"], [, , "(?:8(?:[05689]\\d|3[01])|9[013-9]\\d)\\d{5}", "\\d{8}", , , "88123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "7[05-8]\\d{6}", "\\d{8}", , , "75123456"], "MN", 976, "001", "0", , , "0", 
, , , [[, "([12]\\d)(\\d{2})(\\d{4})", "$1 $2 $3", ["[12]1"], "0$1"], [, "([12]2\\d)(\\d{5,6})", "$1 $2", ["[12]2[1-3]"], "0$1"], [, "([12]\\d{3})(\\d{5})", "$1 $2", ["[12](?:27|[3-5])", "[12](?:27|[3-5]\\d)2"], "0$1"], [, "(\\d{4})(\\d{4})", "$1 $2", ["[57-9]"], "$1"], [, "([12]\\d{4})(\\d{4,5})", "$1 $2", ["[12](?:27|[3-5])", "[12](?:27|[3-5]\\d)[4-9]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], MO:[, [, , "[268]\\d{7}", "\\d{8}"], [, , "(?:28[2-57-9]|8[2-57-9]\\d)\\d{5}", 
"\\d{8}", , , "28212345"], [, , "6(?:[2356]\\d|8[158])\\d{5}", "\\d{8}", , , "66123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "MO", 853, "00", , , , , , , , [[, "([268]\\d{3})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], MP:[, [, , "[5689]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "670(?:2(?:3[3-7]|56|8[5-8])|32[1238]|4(?:33|8[348])|5(?:32|55|88)|6(?:64|70|82)|78[589]|8[3-9]8|989)\\d{4}", "\\d{7}(?:\\d{3})?", 
, , "6702345678"], [, , "670(?:2(?:3[3-7]|56|8[5-8])|32[1238]|4(?:33|8[348])|5(?:32|55|88)|6(?:64|70|82)|78[589]|8[3-9]8|989)\\d{4}", "\\d{7}(?:\\d{3})?", , , "6702345678"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002123456"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "MP", 1, "011", "1", , , "1", , , 1, , , [, , "NA", "NA"], , "670", [, , "NA", "NA"], [, , "NA", 
"NA"], , , [, , "NA", "NA"]], MQ:[, [, , "[56]\\d{8}", "\\d{9}"], [, , "596(?:0[2-5]|[12]0|3[05-9]|4[024-8]|[5-7]\\d|89|9[4-8])\\d{4}", "\\d{9}", , , "596301234"], [, , "696(?:[0-479]\\d|5[01]|8[0-689])\\d{4}", "\\d{9}", , , "696201234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "MQ", 596, "00", "0", , , "0", , , , [[, "(\\d{3})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", , "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , 
"NA", "NA"]], MR:[, [, , "[2-48]\\d{7}", "\\d{8}"], [, , "25[08]\\d{5}|35\\d{6}|45[1-7]\\d{5}", "\\d{8}", , , "35123456"], [, , "[234][0-46-9]\\d{6}", "\\d{8}", , , "22123456"], [, , "800\\d{5}", "\\d{8}", , , "80012345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "MR", 222, "00", , , , , , , , [[, "([2-48]\\d)(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], MS:[, [, , "[5689]\\d{9}", "\\d{7}(?:\\d{3})?"], 
[, , "664491\\d{4}", "\\d{7}(?:\\d{3})?", , , "6644912345"], [, , "66449[2-6]\\d{4}", "\\d{10}", , , "6644923456"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002123456"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "MS", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "664", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], MT:[, [, , "[2357-9]\\d{7}", 
"\\d{8}"], [, , "2(?:0(?:1[0-6]|3[1-4]|[69]\\d)|[1-357]\\d{2})\\d{4}", "\\d{8}", , , "21001234"], [, , "(?:7(?:210|[79]\\d{2})|9(?:2(?:1[01]|31)|696|8(?:1[1-3]|89|97)|9\\d{2}))\\d{4}", "\\d{8}", , , "96961234"], [, , "800[3467]\\d{4}", "\\d{8}", , , "80071234"], [, , "5(?:0(?:0(?:37|43)|6\\d{2}|70\\d|9[0168])|[12]\\d0[1-5])\\d{3}", "\\d{8}", , , "50037123"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "3550\\d{4}", "\\d{8}", , , "35501234"], "MT", 356, "00", , , , , , , , [[, "(\\d{4})(\\d{4})", "$1 $2"]], 
, [, , "7117\\d{4}", "\\d{8}", , , "71171234"], , , [, , "NA", "NA"], [, , "501\\d{5}", "\\d{8}", , , "50112345"], , , [, , "NA", "NA"]], MU:[, [, , "[2-9]\\d{6,7}", "\\d{7,8}"], [, , "(?:2(?:[03478]\\d|1[0-7]|6[1-69])|4(?:[013568]\\d|2[4-7])|5(?:44\\d|471)|6\\d{2}|8(?:14|3[129]))\\d{4}", "\\d{7,8}", , , "2012345"], [, , "5(?:2[59]\\d|4(?:2[1-389]|4\\d|7[1-9]|9\\d)|7\\d{2}|8(?:[0-2568]\\d|7[15-8])|9[0-8]\\d)\\d{4}", "\\d{8}", , , "52512345"], [, , "80[012]\\d{4}", "\\d{7}", , , "8001234"], [, , "30\\d{5}", 
"\\d{7}", , , "3012345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "3(?:20|9\\d)\\d{4}", "\\d{7}", , , "3201234"], "MU", 230, "0(?:0|[2-7]0|33)", , , , , , "020", , [[, "([2-46-9]\\d{2})(\\d{4})", "$1 $2", ["[2-46-9]"]], [, "(5\\d{3})(\\d{4})", "$1 $2", ["5"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], MV:[, [, , "[3467]\\d{6}|9(?:00\\d{7}|\\d{6})", "\\d{7,10}"], [, , "(?:3(?:0[01]|3[0-59])|6(?:[567][02468]|8[024689]|90))\\d{4}", "\\d{7}", , , "6701234"], 
[, , "(?:46[46]|7[3-9]\\d|9[15-9]\\d)\\d{4}", "\\d{7}", , , "7712345"], [, , "NA", "NA"], [, , "900\\d{7}", "\\d{10}", , , "9001234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "MV", 960, "0(?:0|19)", , , , , , "00", , [[, "(\\d{3})(\\d{4})", "$1-$2", ["[3467]|9(?:[1-9]|0[1-9])"]], [, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["900"]]], , [, , "781\\d{4}", "\\d{7}", , , "7812345"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], MW:[, [, , "(?:1(?:\\d{2})?|[2789]\\d{2})\\d{6}", 
"\\d{7,9}"], [, , "(?:1[2-9]|21\\d{2})\\d{5}", "\\d{7,9}", , , "1234567"], [, , "(?:111|77\\d|88\\d|99\\d)\\d{6}", "\\d{9}", , , "991234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "MW", 265, "00", "0", , , "0", , , , [[, "(\\d)(\\d{3})(\\d{3})", "$1 $2 $3", ["1"], "0$1"], [, "(2\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["2"], "0$1"], [, "(\\d{3})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[1789]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], 
[, , "NA", "NA"], , , [, , "NA", "NA"]], MX:[, [, , "[1-9]\\d{9,10}", "\\d{7,11}"], [, , "(?:33|55|81)\\d{8}|(?:2(?:0[01]|2[2-9]|3[1-35-8]|4[13-9]|7[1-689]|8[1-578]|9[467])|3(?:1[1-79]|[2458][1-9]|7[1-8]|9[1-5])|4(?:1[1-57-9]|[24-6][1-9]|[37][1-8]|8[1-35-9]|9[2-689])|5(?:88|9[1-79])|6(?:1[2-68]|[234][1-9]|5[1-3689]|6[12457-9]|7[1-7]|8[67]|9[4-8])|7(?:[13467][1-9]|2[1-8]|5[13-9]|8[1-69]|9[17])|8(?:2[13-689]|3[1-6]|4[124-6]|6[1246-9]|7[1-378]|9[12479])|9(?:1[346-9]|2[1-4]|3[2-46-8]|5[1348]|[69][1-9]|7[12]|8[1-8]))\\d{7}", 
"\\d{7,10}", , , "2221234567"], [, , "1(?:(?:33|55|81)\\d{8}|(?:2(?:2[2-9]|3[1-35-8]|4[13-9]|7[1-689]|8[1-578]|9[467])|3(?:1[1-79]|[2458][1-9]|7[1-8]|9[1-5])|4(?:1[1-57-9]|[24-6][1-9]|[37][1-8]|8[1-35-9]|9[2-689])|5(?:88|9[1-79])|6(?:1[2-68]|[2-4][1-9]|5[1-3689]|6[12457-9]|7[1-7]|8[67]|9[4-8])|7(?:[13467][1-9]|2[1-8]|5[13-9]|8[1-69]|9[17])|8(?:2[13-689]|3[1-6]|4[124-6]|6[1246-9]|7[1-378]|9[12479])|9(?:1[346-9]|2[1-4]|3[2-46-8]|5[1348]|[69][1-9]|7[12]|8[1-8]))\\d{7})", "\\d{11}", , , "12221234567"], 
[, , "8(?:00|88)\\d{7}", "\\d{10}", , , "8001234567"], [, , "900\\d{7}", "\\d{10}", , , "9001234567"], [, , "300\\d{7}", "\\d{10}", , , "3001234567"], [, , "500\\d{7}", "\\d{10}", , , "5001234567"], [, , "NA", "NA"], "MX", 52, "0[09]", "01", , , "0[12]|04[45](\\d{10})", "1$1", , , [[, "([358]\\d)(\\d{4})(\\d{4})", "$1 $2 $3", ["33|55|81"], "01 $1", , 1], [, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["[2467]|3[0-2457-9]|5[089]|8[02-9]|9[0-35-9]"], "01 $1", , 1], [, "(1)([358]\\d)(\\d{4})(\\d{4})", "044 $2 $3 $4", 
["1(?:33|55|81)"], "$1", , 1], [, "(1)(\\d{3})(\\d{3})(\\d{4})", "044 $2 $3 $4", ["1(?:[2467]|3[0-2457-9]|5[089]|8[2-9]|9[1-35-9])"], "$1", , 1]], [[, "([358]\\d)(\\d{4})(\\d{4})", "$1 $2 $3", ["33|55|81"], "01 $1", , 1], [, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["[2467]|3[0-2457-9]|5[089]|8[02-9]|9[0-35-9]"], "01 $1", , 1], [, "(1)([358]\\d)(\\d{4})(\\d{4})", "$1 $2 $3 $4", ["1(?:33|55|81)"]], [, "(1)(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3 $4", ["1(?:[2467]|3[0-2457-9]|5[089]|8[2-9]|9[1-35-9])"]]], 
[, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]], MY:[, [, , "[13-9]\\d{7,9}", "\\d{6,10}"], [, , "(?:3[2-9]\\d|[4-9][2-9])\\d{6}", "\\d{6,9}", , , "323456789"], [, , "1(?:1[1-5]\\d{2}|[02-4679][2-9]\\d|59\\d{2}|8(?:1[23]|[2-9]\\d))\\d{5}", "\\d{9,10}", , , "123456789"], [, , "1[378]00\\d{6}", "\\d{10}", , , "1300123456"], [, , "1600\\d{6}", "\\d{10}", , , "1600123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "154\\d{7}", "\\d{10}", , , "1541234567"], "MY", 60, "00", 
"0", , , "0", , , , [[, "([4-79])(\\d{3})(\\d{4})", "$1-$2 $3", ["[4-79]"], "0$1"], [, "(3)(\\d{4})(\\d{4})", "$1-$2 $3", ["3"], "0$1"], [, "([18]\\d)(\\d{3})(\\d{3,4})", "$1-$2 $3", ["1[02-46-9][1-9]|8"], "0$1"], [, "(1)([36-8]00)(\\d{2})(\\d{4})", "$1-$2-$3-$4", ["1[36-8]0"]], [, "(11)(\\d{4})(\\d{4})", "$1-$2 $3", ["11"], "0$1"], [, "(15[49])(\\d{3})(\\d{4})", "$1-$2 $3", ["15"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], MZ:[, [, , "[28]\\d{7,8}", 
"\\d{8,9}"], [, , "2(?:[1346]\\d|5[0-2]|[78][12]|93)\\d{5}", "\\d{8}", , , "21123456"], [, , "8[23467]\\d{7}", "\\d{9}", , , "821234567"], [, , "800\\d{6}", "\\d{9}", , , "800123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "MZ", 258, "00", , , , , , , , [[, "([28]\\d)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["2|8[2-7]"]], [, "(80\\d)(\\d{3})(\\d{3})", "$1 $2 $3", ["80"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], NA:[, [, , "[68]\\d{7,8}", 
"\\d{8,9}"], [, , "6(?:1(?:17|2(?:[0189]\\d|[2-6]|7\\d?)|3(?:[01378]|2\\d)|4(?:[024]|10?|3[15]?)|69|7[014])|2(?:17|5(?:[0-36-8]|4\\d?)|69|70)|3(?:17|2(?:[0237]\\d?|[14-689])|34|6[289]|7[01]|81)|4(?:17|2(?:[012]|7?)|4(?:[06]|1\\d?)|5(?:[01357]|[25]\\d?)|69|7[01])|5(?:17|2(?:[0459]|[23678]\\d?)|69|7[01])|6(?:17|2(?:5|6\\d?)|38|42|69|7[01])|7(?:17|2(?:[569]|[234]\\d?)|3(?:0\\d?|[13])|69|7[01]))\\d{4}", "\\d{8,9}", , , "61221234"], [, , "(?:60|8[125])\\d{7}", "\\d{9}", , , "811234567"], [, , "NA", "NA"], 
[, , "8701\\d{5}", "\\d{9}", , , "870123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "8(?:3\\d{2}|86)\\d{5}", "\\d{8,9}", , , "88612345"], "NA", 264, "00", "0", , , "0", , , , [[, "(8\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["8[1235]"], "0$1"], [, "(6\\d)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["6"], "0$1"], [, "(88)(\\d{3})(\\d{3})", "$1 $2 $3", ["88"], "0$1"], [, "(870)(\\d{3})(\\d{3})", "$1 $2 $3", ["870"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], NC:[, 
[, , "[2-57-9]\\d{5}", "\\d{6}"], [, , "(?:2[03-9]|3[0-5]|4[1-7]|88)\\d{4}", "\\d{6}", , , "201234"], [, , "(?:5[0-4]|[79]\\d|8[0-79])\\d{4}", "\\d{6}", , , "751234"], [, , "NA", "NA"], [, , "36\\d{4}", "\\d{6}", , , "366711"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "NC", 687, "00", , , , , , , , [[, "(\\d{2})(\\d{2})(\\d{2})", "$1.$2.$3", ["[2-46-9]|5[0-4]"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], NE:[, [, , "[0289]\\d{7}", "\\d{8}"], 
[, , "2(?:0(?:20|3[1-7]|4[134]|5[14]|6[14578]|7[1-578])|1(?:4[145]|5[14]|6[14-68]|7[169]|88))\\d{4}", "\\d{8}", , , "20201234"], [, , "(?:8[089]|9\\d)\\d{6}", "\\d{8}", , , "93123456"], [, , "08\\d{6}", "\\d{8}", , , "08123456"], [, , "09\\d{6}", "\\d{8}", , , "09123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "NE", 227, "00", , , , , , , , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[289]|09"]], [, "(08)(\\d{3})(\\d{3})", "$1 $2 $3", ["08"]]], , [, , "NA", "NA"], , , 
[, , "NA", "NA"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]], NF:[, [, , "[13]\\d{5}", "\\d{5,6}"], [, , "(?:1(?:06|17|28|39)|3[012]\\d)\\d{3}", "\\d{5,6}", , , "106609"], [, , "3[58]\\d{4}", "\\d{5,6}", , , "381234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "NF", 672, "00", , , , , , , , [[, "(\\d{2})(\\d{4})", "$1 $2", ["1"]], [, "(\\d)(\\d{5})", "$1 $2", ["3"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], NG:[, 
[, , "[1-6]\\d{5,8}|9\\d{5,9}|[78]\\d{5,13}", "\\d{5,14}"], [, , "[12]\\d{6,7}|9(?:0[3-9]|[1-9]\\d)\\d{5}|(?:3\\d|4[023568]|5[02368]|6[02-469]|7[4-69]|8[2-9])\\d{6}|(?:4[47]|5[14579]|6[1578]|7[0-357])\\d{5,6}|(?:78|41)\\d{5}", "\\d{5,9}", , , "12345678"], [, , "(?:1(?:7[34]\\d|8(?:04|[124579]\\d|8[0-3])|95\\d)|287[0-7]|3(?:18[1-8]|88[0-7]|9(?:8[5-9]|6[1-5]))|4(?:28[0-2]|6(?:7[1-9]|8[02-47])|88[0-2])|5(?:2(?:7[7-9]|8\\d)|38[1-79]|48[0-7]|68[4-7])|6(?:2(?:7[7-9]|8\\d)|4(?:3[7-9]|[68][129]|7[04-69]|9[1-8])|58[0-2]|98[7-9])|7(?:38[0-7]|69[1-8]|78[2-4])|8(?:28[3-9]|38[0-2]|4(?:2[12]|3[147-9]|5[346]|7[4-9]|8[014-689]|90)|58[1-8]|78[2-9]|88[5-7])|98[07]\\d)\\d{4}|(?:70[1-689]\\d|8(?:0(?:1[01]|[2-9]\\d)|1(?:[0-8]\\d|9[01]))|90[23589]\\d)\\d{6}", 
"\\d{8,10}", , , "8021234567"], [, , "800\\d{7,11}", "\\d{10,14}", , , "80017591759"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "NG", 234, "009", "0", , , "0", , , , [[, "(\\d{3})(\\d{3})(\\d{3,4})", "$1 $2 $3", ["70|8[01]|90[23589]"], "0$1"], [, "(\\d)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["[12]|9(?:0[3-9]|[1-9])"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{2,3})", "$1 $2 $3", ["[3-6]|7(?:[1-79]|0[1-9])|8[2-9]"], "0$1"], [, "([78]00)(\\d{4})(\\d{4,5})", "$1 $2 $3", ["[78]00"], "0$1"], 
[, "([78]00)(\\d{5})(\\d{5,6})", "$1 $2 $3", ["[78]00"], "0$1"], [, "(78)(\\d{2})(\\d{3})", "$1 $2 $3", ["78"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "700\\d{7,11}", "\\d{10,14}", , , "7001234567"], , , [, , "NA", "NA"]], NI:[, [, , "[12578]\\d{7}", "\\d{8}"], [, , "2\\d{7}", "\\d{8}", , , "21234567"], [, , "5(?:5[0-7]\\d{5}|[78]\\d{6})|7[5-8]\\d{6}|8\\d{7}", "\\d{8}", , , "81234567"], [, , "1800\\d{4}", "\\d{8}", , , "18001234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], 
[, , "NA", "NA"], "NI", 505, "00", , , , , , , , [[, "(\\d{4})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], NL:[, [, , "1\\d{4,8}|[2-7]\\d{8}|[89]\\d{6,9}", "\\d{5,10}"], [, , "(?:1[0135-8]|2[02-69]|3[0-68]|4[0135-9]|[57]\\d|8[478])\\d{7}", "\\d{9}", , , "101234567"], [, , "6[1-58]\\d{7}", "\\d{9}", , , "612345678"], [, , "800\\d{4,7}", "\\d{7,10}", , , "8001234"], [, , "90[069]\\d{4,7}", "\\d{7,10}", , , "9061234"], [, , "NA", "NA"], [, 
, "NA", "NA"], [, , "85\\d{7}", "\\d{9}", , , "851234567"], "NL", 31, "00", "0", , , "0", , , , [[, "([1-578]\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["1[035]|2[0346]|3[03568]|4[0356]|5[0358]|7|8[4578]"], "0$1"], [, "([1-5]\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["1[16-8]|2[259]|3[124]|4[17-9]|5[124679]"], "0$1"], [, "(6)(\\d{8})", "$1 $2", ["6[0-57-9]"], "0$1"], [, "(66)(\\d{7})", "$1 $2", ["66"], "0$1"], [, "(14)(\\d{3,4})", "$1 $2", ["14"], "$1"], [, "([89]0\\d)(\\d{4,7})", "$1 $2", ["80|9"], "0$1"]], 
, [, , "66\\d{7}", "\\d{9}", , , "662345678"], , , [, , "14\\d{3,4}", "\\d{5,6}"], [, , "140(?:1(?:[035]|[16-8]\\d)|2(?:[0346]|[259]\\d)|3(?:[03568]|[124]\\d)|4(?:[0356]|[17-9]\\d)|5(?:[0358]|[124679]\\d)|7\\d|8[458])", "\\d{5,6}", , , "14020"], , , [, , "NA", "NA"]], NO:[, [, , "0\\d{4}|[2-9]\\d{7}", "\\d{5}(?:\\d{3})?"], [, , "(?:2[1-4]|3[1-3578]|5[1-35-7]|6[1-4679]|7[0-8])\\d{6}", "\\d{8}", , , "21234567"], [, , "(?:4[015-8]|5[89]|87|9\\d)\\d{6}", "\\d{8}", , , "40612345"], [, , "80[01]\\d{5}", 
"\\d{8}", , , "80012345"], [, , "82[09]\\d{5}", "\\d{8}", , , "82012345"], [, , "810(?:0[0-6]|[2-8]\\d)\\d{3}", "\\d{8}", , , "81021234"], [, , "880\\d{5}", "\\d{8}", , , "88012345"], [, , "85[0-5]\\d{5}", "\\d{8}", , , "85012345"], "NO", 47, "00", , , , , , , , [[, "([489]\\d{2})(\\d{2})(\\d{3})", "$1 $2 $3", ["[489]"]], [, "([235-7]\\d)(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[235-7]"]]], , [, , "NA", "NA"], 1, , [, , "NA", "NA"], [, , "0\\d{4}|81(?:0(?:0[7-9]|1\\d)|5\\d{2})\\d{3}", "\\d{5}(?:\\d{3})?", 
, , "01234"], 1, , [, , "81[23]\\d{5}", "\\d{8}", , , "81212345"]], NP:[, [, , "[1-8]\\d{7}|9(?:[1-69]\\d{6,8}|7[2-6]\\d{5,7}|8\\d{8})", "\\d{6,10}"], [, , "(?:1[0-6]\\d|2[13-79][2-6]|3[135-8][2-6]|4[146-9][2-6]|5[135-7][2-6]|6[13-9][2-6]|7[15-9][2-6]|8[1-46-9][2-6]|9[1-79][2-6])\\d{5}", "\\d{6,8}", , , "14567890"], [, , "9(?:6[013]|7[245]|8[0-24-6])\\d{7}", "\\d{10}", , , "9841234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "NP", 977, "00", "0", 
, , "0", , , , [[, "(1)(\\d{7})", "$1-$2", ["1[2-6]"], "0$1"], [, "(\\d{2})(\\d{6})", "$1-$2", ["1[01]|[2-8]|9(?:[1-69]|7[15-9])"], "0$1"], [, "(9\\d{2})(\\d{7})", "$1-$2", ["9(?:6[013]|7[245]|8)"], "$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], NR:[, [, , "[458]\\d{6}", "\\d{7}"], [, , "(?:444|888)\\d{4}", "\\d{7}", , , "4441234"], [, , "55[5-9]\\d{4}", "\\d{7}", , , "5551234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, 
, "NA", "NA"], "NR", 674, "00", , , , , , , , [[, "(\\d{3})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], NU:[, [, , "[1-5]\\d{3}", "\\d{4}"], [, , "[34]\\d{3}", "\\d{4}", , , "4002"], [, , "[125]\\d{3}", "\\d{4}", , , "1234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "NU", 683, "00", , , , , , , , , , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], NZ:[, [, 
, "6[235-9]\\d{6}|[2-57-9]\\d{7,10}", "\\d{7,11}"], [, , "(?:3[2-79]|[49][2-9]|6[235-9]|7[2-57-9])\\d{6}|24099\\d{3}", "\\d{7,8}", , , "32345678"], [, , "2(?:[028]\\d{7,8}|1(?:[03]\\d{5,7}|[12457]\\d{5,6}|[689]\\d{5})|[79]\\d{7})", "\\d{8,10}", , , "211234567"], [, , "508\\d{6,7}|80\\d{6,8}", "\\d{8,10}", , , "800123456"], [, , "90\\d{7,9}", "\\d{9,11}", , , "900123456"], [, , "NA", "NA"], [, , "70\\d{7}", "\\d{9}", , , "701234567"], [, , "NA", "NA"], "NZ", 64, "0(?:0|161)", "0", , , "0", , "00", 
, [[, "([34679])(\\d{3})(\\d{4})", "$1-$2 $3", ["[346]|7[2-57-9]|9[1-9]"], "0$1"], [, "(24099)(\\d{3})", "$1 $2", ["240", "2409", "24099"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["21"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{3,5})", "$1 $2 $3", ["2(?:1[1-9]|[69]|7[0-35-9])|70|86"], "0$1"], [, "(2\\d)(\\d{3,4})(\\d{4})", "$1 $2 $3", ["2[028]"], "0$1"], [, "(\\d{3})(\\d{3})(\\d{3,4})", "$1 $2 $3", ["2(?:10|74)|5|[89]0"], "0$1"]], , [, , "[28]6\\d{6,7}", "\\d{8,9}", , , "26123456"], , , [, , 
"NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], OM:[, [, , "(?:5|[279]\\d)\\d{6}|800\\d{5,6}", "\\d{7,9}"], [, , "2[2-6]\\d{6}", "\\d{8}", , , "23123456"], [, , "7[19]\\d{6}|9(?:0[1-9]|[1-9]\\d)\\d{5}", "\\d{8}", , , "92123456"], [, , "8007\\d{4,5}|500\\d{4}", "\\d{7,9}", , , "80071234"], [, , "900\\d{5}", "\\d{8}", , , "90012345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "OM", 968, "00", , , , , , , , [[, "(2\\d)(\\d{6})", "$1 $2", ["2"]], [, "([79]\\d{3})(\\d{4})", "$1 $2", 
["[79]"]], [, "([58]00)(\\d{4,6})", "$1 $2", ["[58]"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], PA:[, [, , "[1-9]\\d{6,7}", "\\d{7,8}"], [, , "(?:1(?:0[0-8]|1[49]|2[37]|3[0137]|4[147]|5[05]|6[58]|7[0167]|8[58]|9[139])|2(?:[0235679]\\d|1[0-7]|4[04-9]|8[028])|3(?:[09]\\d|1[014-7]|2[0-3]|3[03]|4[03-57]|55|6[068]|7[06-8]|8[06-9])|4(?:3[013-69]|4\\d|7[0-589])|5(?:[01]\\d|2[0-7]|[56]0|79)|7(?:0[09]|2[0-267]|3[06]|[469]0|5[06-9]|7[0-24-79]|8[7-9])|8(?:09|[34]\\d|5[0134]|8[02])|9(?:0[6-9]|1[016-8]|2[036-8]|3[3679]|40|5[0489]|6[06-9]|7[046-9]|8[36-8]|9[1-9]))\\d{4}", 
"\\d{7}", , , "2001234"], [, , "(?:1[16]1|21[89]|8(?:1[01]|7[23]))\\d{4}|6(?:[024-9]\\d|1[0-5]|3[0-24-9])\\d{5}", "\\d{7,8}", , , "60012345"], [, , "80[09]\\d{4}", "\\d{7}", , , "8001234"], [, , "(?:779|8(?:55|60|7[78])|9(?:00|81))\\d{4}", "\\d{7}", , , "8601234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "PA", 507, "00", , , , , , , , [[, "(\\d{3})(\\d{4})", "$1-$2", ["[1-57-9]"]], [, "(\\d{4})(\\d{4})", "$1-$2", ["6"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , 
, [, , "NA", "NA"]], PE:[, [, , "[14-9]\\d{7,8}", "\\d{6,9}"], [, , "(?:1\\d|4[1-4]|5[1-46]|6[1-7]|7[2-46]|8[2-4])\\d{6}", "\\d{6,8}", , , "11234567"], [, , "9\\d{8}", "\\d{9}", , , "912345678"], [, , "800\\d{5}", "\\d{8}", , , "80012345"], [, , "805\\d{5}", "\\d{8}", , , "80512345"], [, , "801\\d{5}", "\\d{8}", , , "80112345"], [, , "80[24]\\d{5}", "\\d{8}", , , "80212345"], [, , "NA", "NA"], "PE", 51, "19(?:1[124]|77|90)00", "0", " Anexo ", , "0", , , , [[, "(1)(\\d{7})", "$1 $2", ["1"], "(0$1)"], 
[, "([4-8]\\d)(\\d{6})", "$1 $2", ["[4-7]|8[2-4]"], "(0$1)"], [, "(\\d{3})(\\d{5})", "$1 $2", ["80"], "(0$1)"], [, "(9\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["9"], "$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], PF:[, [, , "4\\d{5,7}|8\\d{7}", "\\d{6}(?:\\d{2})?"], [, , "4(?:[09][45689]\\d|4)\\d{4}", "\\d{6}(?:\\d{2})?", , , "40412345"], [, , "8[79]\\d{6}", "\\d{8}", , , "87123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], 
[, , "NA", "NA"], "PF", 689, "00", , , , , , , , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["4[09]|8[79]"]], [, "(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3", ["44"]]], , [, , "NA", "NA"], , , [, , "44\\d{4}", "\\d{6}", , , "441234"], [, , "NA", "NA"], , , [, , "NA", "NA"]], PG:[, [, , "[1-9]\\d{6,7}", "\\d{7,8}"], [, , "(?:3[0-2]\\d|4[25]\\d|5[34]\\d|64[1-9]|77(?:[0-24]\\d|30)|85[02-46-9]|9[78]\\d)\\d{4}", "\\d{7}", , , "3123456"], [, , "(?:20150|68\\d{2}|7(?:[0-689]\\d|75)\\d{2})\\d{3}", 
"\\d{7,8}", , , "6812345"], [, , "180\\d{4}", "\\d{7}", , , "1801234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "275\\d{4}", "\\d{7}", , , "2751234"], "PG", 675, "00", , , , , , , , [[, "(\\d{3})(\\d{4})", "$1 $2", ["[13-689]|27"]], [, "(\\d{4})(\\d{4})", "$1 $2", ["20|7"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], PH:[, [, , "2\\d{5,7}|[3-9]\\d{7,9}|1800\\d{7,9}", "\\d{5,13}"], [, , "2\\d{5}(?:\\d{2})?|(?:3[2-68]|4[2-9]|5[2-6]|6[2-58]|7[24578]|8[2-8])\\d{7}|88(?:22\\d{6}|42\\d{4})", 
"\\d{5,10}", , , "21234567"], [, , "(?:81[37]|9(?:0[5-9]|1[024-9]|2[0-35-9]|3[02-9]|4[236-9]|50|7[34-79]|89|9[4-9]))\\d{7}", "\\d{10}", , , "9051234567"], [, , "1800\\d{7,9}", "\\d{11,13}", , , "180012345678"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "PH", 63, "00", "0", , , "0", , , , [[, "(2)(\\d{3})(\\d{4})", "$1 $2 $3", ["2"], "(0$1)"], [, "(2)(\\d{5})", "$1 $2", ["2"], "(0$1)"], [, "(\\d{4})(\\d{4,6})", "$1 $2", ["3(?:23|39|46)|4(?:2[3-6]|[35]9|4[26]|76)|5(?:22|44)|642|8(?:62|8[245])", 
"3(?:230|397|461)|4(?:2(?:35|[46]4|51)|396|4(?:22|63)|59[347]|76[15])|5(?:221|446)|642[23]|8(?:622|8(?:[24]2|5[13]))"], "(0$1)"], [, "(\\d{5})(\\d{4})", "$1 $2", ["346|4(?:27|9[35])|883", "3469|4(?:279|9(?:30|56))|8834"], "(0$1)"], [, "([3-8]\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["[3-8]"], "(0$1)"], [, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["81|9"], "0$1"], [, "(1800)(\\d{3})(\\d{4})", "$1 $2 $3", ["1"]], [, "(1800)(\\d{1,2})(\\d{3})(\\d{4})", "$1 $2 $3 $4", ["1"]]], , [, , "NA", "NA"], , , [, , "NA", 
"NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], PK:[, [, , "1\\d{8}|[2-8]\\d{5,11}|9(?:[013-9]\\d{4,9}|2\\d(?:111\\d{6}|\\d{3,7}))", "\\d{6,12}"], [, , "(?:21|42)[2-9]\\d{7}|(?:2[25]|4[0146-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)[2-9]\\d{6}|(?:2(?:3[2358]|4[2-4]|9[2-8])|45[3479]|54[2-467]|60[468]|72[236]|8(?:2[2-689]|3[23578]|4[3478]|5[2356])|9(?:1|2[2-8]|3[27-9]|4[2-6]|6[3569]|9[25-8]))[2-9]\\d{5,6}|58[126]\\d{7}", "\\d{6,10}", , , "2123456789"], [, , "3(?:0\\d|1[0-6]|2[0-5]|3[0-7]|4[0-8]|55|64)\\d{7}", 
"\\d{10}", , , "3012345678"], [, , "800\\d{5}", "\\d{8}", , , "80012345"], [, , "900\\d{5}", "\\d{8}", , , "90012345"], [, , "NA", "NA"], [, , "122\\d{6}", "\\d{9}", , , "122044444"], [, , "NA", "NA"], "PK", 92, "00", "0", , , "0", , , , [[, "(\\d{2})(111)(\\d{3})(\\d{3})", "$1 $2 $3 $4", ["(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)1", "(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)11", "(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)111"], "(0$1)"], [, "(\\d{3})(111)(\\d{3})(\\d{3})", 
"$1 $2 $3 $4", ["2[349]|45|54|60|72|8[2-5]|9[2-9]", "(?:2[349]|45|54|60|72|8[2-5]|9[2-9])\\d1", "(?:2[349]|45|54|60|72|8[2-5]|9[2-9])\\d11", "(?:2[349]|45|54|60|72|8[2-5]|9[2-9])\\d111"], "(0$1)"], [, "(\\d{2})(\\d{7,8})", "$1 $2", ["(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)[2-9]"], "(0$1)"], [, "(\\d{3})(\\d{6,7})", "$1 $2", ["2[349]|45|54|60|72|8[2-5]|9[2-9]", "(?:2[349]|45|54|60|72|8[2-5]|9[2-9])\\d[2-9]"], "(0$1)"], [, "(3\\d{2})(\\d{7})", "$1 $2", ["3"], "0$1"], [, "([15]\\d{3})(\\d{5,6})", 
"$1 $2", ["58[12]|1"], "(0$1)"], [, "(586\\d{2})(\\d{5})", "$1 $2", ["586"], "(0$1)"], [, "([89]00)(\\d{3})(\\d{2})", "$1 $2 $3", ["[89]00"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "(?:2(?:[125]|3[2358]|4[2-4]|9[2-8])|4(?:[0-246-9]|5[3479])|5(?:[1-35-7]|4[2-467])|6(?:[1-8]|0[468])|7(?:[14]|2[236])|8(?:[16]|2[2-689]|3[23578]|4[3478]|5[2356])|9(?:1|22|3[27-9]|4[2-6]|6[3569]|9[2-7]))111\\d{6}", "\\d{11,12}", , , "21111825888"], , , [, , "NA", "NA"]], PL:[, [, , "[12]\\d{6,8}|[3-57-9]\\d{8}|6\\d{5,8}", 
"\\d{6,9}"], [, , "(?:1[2-8]|2[2-69]|3[2-4]|4[1-468]|5[24-689]|6[1-3578]|7[14-7]|8[1-79]|9[145])\\d{7}|[12]2\\d{5}", "\\d{6,9}", , , "123456789"], [, , "(?:5[0137]|6[069]|7[2389]|88)\\d{7}", "\\d{9}", , , "512345678"], [, , "800\\d{6}", "\\d{9}", , , "800123456"], [, , "70\\d{7}", "\\d{9}", , , "701234567"], [, , "801\\d{6}", "\\d{9}", , , "801234567"], [, , "NA", "NA"], [, , "39\\d{7}", "\\d{9}", , , "391234567"], "PL", 48, "00", , , , , , , , [[, "(\\d{2})(\\d{3})(\\d{2})(\\d{2})", "$1 $2 $3 $4", 
["[14]|2[0-57-9]|3[2-4]|5[24-689]|6[1-3578]|7[14-7]|8[1-79]|9[145]"]], [, "(\\d{2})(\\d{1})(\\d{4})", "$1 $2 $3", ["[12]2"]], [, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3", ["26|39|5[0137]|6[0469]|7[02389]|8[08]"]], [, "(\\d{3})(\\d{2})(\\d{2,3})", "$1 $2 $3", ["64"]], [, "(\\d{3})(\\d{3})", "$1 $2", ["64"]]], , [, , "64\\d{4,7}", "\\d{6,9}", , , "641234567"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], PM:[, [, , "[45]\\d{5}", "\\d{6}"], [, , "41\\d{4}", "\\d{6}", , , "411234"], [, 
, "55\\d{4}", "\\d{6}", , , "551234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "PM", 508, "00", "0", , , "0", , , , [[, "([45]\\d)(\\d{2})(\\d{2})", "$1 $2 $3", , "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], PR:[, [, , "[5789]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "(?:787|939)[2-9]\\d{6}", "\\d{7}(?:\\d{3})?", , , "7872345678"], [, , "(?:787|939)[2-9]\\d{6}", "\\d{7}(?:\\d{3})?", , , "7872345678"], [, , 
"8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002345678"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002345678"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "PR", 1, "011", "1", , , "1", , , 1, , , [, , "NA", "NA"], , "787|939", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], PS:[, [, , "[24589]\\d{7,8}|1(?:[78]\\d{8}|[49]\\d{2,3})", "\\d{4,10}"], [, , "(?:22[234789]|42[45]|82[01458]|92[369])\\d{5}", "\\d{7,8}", , , 
"22234567"], [, , "5[69]\\d{7}", "\\d{9}", , , "599123456"], [, , "1800\\d{6}", "\\d{10}", , , "1800123456"], [, , "1(?:4|9\\d)\\d{2}", "\\d{4,5}", , , "19123"], [, , "1700\\d{6}", "\\d{10}", , , "1700123456"], [, , "NA", "NA"], [, , "NA", "NA"], "PS", 970, "00", "0", , , "0", , , , [[, "([2489])(2\\d{2})(\\d{4})", "$1 $2 $3", ["[2489]"], "0$1"], [, "(5[69]\\d)(\\d{3})(\\d{3})", "$1 $2 $3", ["5"], "0$1"], [, "(1[78]00)(\\d{3})(\\d{3})", "$1 $2 $3", ["1[78]"], "$1"]], , [, , "NA", "NA"], , , [, , 
"NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], PT:[, [, , "[2-46-9]\\d{8}", "\\d{9}"], [, , "2(?:[12]\\d|[35][1-689]|4[1-59]|6[1-35689]|7[1-9]|8[1-69]|9[1256])\\d{6}", "\\d{9}", , , "212345678"], [, , "9(?:[1236]\\d{2}|480)\\d{5}", "\\d{9}", , , "912345678"], [, , "80[02]\\d{6}", "\\d{9}", , , "800123456"], [, , "6(?:0[178]|4[68])\\d{6}|76(?:0[1-57]|1[2-47]|2[237])\\d{5}", "\\d{9}", , , "760123456"], [, , "80(?:8\\d|9[1579])\\d{5}", "\\d{9}", , , "808123456"], [, , "884[0-4689]\\d{5}", "\\d{9}", 
, , "884123456"], [, , "30\\d{7}", "\\d{9}", , , "301234567"], "PT", 351, "00", , , , , , , , [[, "(2\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["2[12]"]], [, "([2-46-9]\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["2[3-9]|[346-9]"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "7(?:0(?:7\\d|8[17]))\\d{5}", "\\d{9}", , , "707123456"], , , [, , "600\\d{6}", "\\d{9}", , , "600110000"]], PW:[, [, , "[2-8]\\d{6}", "\\d{7}"], [, , "2552255|(?:277|345|488|5(?:35|44|87)|6(?:22|54|79)|7(?:33|47)|8(?:24|55|76))\\d{4}", 
"\\d{7}", , , "2771234"], [, , "(?:6[234689]0|77[45789])\\d{4}", "\\d{7}", , , "6201234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "PW", 680, "01[12]", , , , , , , , [[, "(\\d{3})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], PY:[, [, , "5[0-5]\\d{4,7}|[2-46-9]\\d{5,8}", "\\d{5,9}"], [, , "(?:[26]1|3[289]|4[124678]|7[123]|8[1236])\\d{5,7}|(?:2(?:2[4568]|7[15]|9[1-5])|3(?:18|3[167]|4[2357]|51)|4(?:18|2[45]|3[12]|5[13]|64|71|9[1-47])|5(?:[1-4]\\d|5[0234])|6(?:3[1-3]|44|7[1-4678])|7(?:17|4[0-4]|6[1-578]|75|8[0-8])|858)\\d{5,6}", 
"\\d{5,9}", , , "212345678"], [, , "9(?:6[12]|[78][1-6]|9[1-5])\\d{6}", "\\d{9}", , , "961456789"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "8700[0-4]\\d{4}", "\\d{9}", , , "870012345"], "PY", 595, "00", "0", , , "0", , , , [[, "(\\d{2})(\\d{5})", "$1 $2", ["(?:[26]1|3[289]|4[124678]|7[123]|8[1236])"], "(0$1)"], [, "(\\d{2})(\\d{3})(\\d{3,4})", "$1 $2 $3", ["(?:[26]1|3[289]|4[124678]|7[123]|8[1236])"], "(0$1)"], [, "(\\d{3})(\\d{3,6})", "$1 $2", ["[2-9]0"], "0$1"], 
[, "(\\d{3})(\\d{6})", "$1 $2", ["9[1-9]"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["8700"]], [, "(\\d{3})(\\d{4,5})", "$1 $2", ["[2-8][1-9]"], "(0$1)"], [, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3", ["[2-8][1-9]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "[2-9]0\\d{4,7}", "\\d{6,9}", , , "201234567"], , , [, , "NA", "NA"]], QA:[, [, , "[2-8]\\d{6,7}", "\\d{7,8}"], [, , "4[04]\\d{6}", "\\d{7,8}", , , "44123456"], [, , "[3567]\\d{7}", "\\d{7,8}", , , "33123456"], [, , "800\\d{4}", 
"\\d{7,8}", , , "8001234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "QA", 974, "00", , , , , , , , [[, "([28]\\d{2})(\\d{4})", "$1 $2", ["[28]"]], [, "([3-7]\\d{3})(\\d{4})", "$1 $2", ["[3-7]"]]], , [, , "2(?:[12]\\d|61)\\d{4}", "\\d{7}", , , "2123456"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], RE:[, [, , "[268]\\d{8}", "\\d{9}"], [, , "262\\d{6}", "\\d{9}", , , "262161234"], [, , "6(?:9[23]|47)\\d{6}", "\\d{9}", , , "692123456"], [, , "80\\d{7}", 
"\\d{9}", , , "801234567"], [, , "89[1-37-9]\\d{6}", "\\d{9}", , , "891123456"], [, , "8(?:1[019]|2[0156]|84|90)\\d{6}", "\\d{9}", , , "810123456"], [, , "NA", "NA"], [, , "NA", "NA"], "RE", 262, "00", "0", , , "0", , , , [[, "([268]\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", , "0$1"]], , [, , "NA", "NA"], 1, "262|6[49]|8", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], RO:[, [, , "2\\d{5,8}|[37-9]\\d{8}", "\\d{6,9}"], [, , "2(?:1(?:\\d{7}|9\\d{3})|[3-6](?:\\d{7}|\\d9\\d{2}))|3[13-6]\\d{7}", 
"\\d{6,9}", , , "211234567"], [, , "7(?:[0-8]\\d{2}|99\\d)\\d{5}", "\\d{9}", , , "712345678"], [, , "800\\d{6}", "\\d{9}", , , "800123456"], [, , "90[036]\\d{6}", "\\d{9}", , , "900123456"], [, , "801\\d{6}", "\\d{9}", , , "801123456"], [, , "802\\d{6}", "\\d{9}", , , "802123456"], [, , "NA", "NA"], "RO", 40, "00", "0", " int ", , "0", , , , [[, "(\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["[23]1"], "0$1"], [, "(21)(\\d{4})", "$1 $2", ["21"], "0$1"], [, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3", ["[23][3-7]|[7-9]"], 
"0$1"], [, "(2\\d{2})(\\d{3})", "$1 $2", ["2[3-6]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "37\\d{7}", "\\d{9}", , , "372123456"], , , [, , "NA", "NA"]], RS:[, [, , "[126-9]\\d{4,11}|3(?:[0-79]\\d{3,10}|8[2-9]\\d{2,9})", "\\d{5,12}"], [, , "(?:1(?:[02-9][2-9]|1[1-9])\\d|2(?:[0-24-7][2-9]\\d|[389](?:0[2-9]|[2-9]\\d))|3(?:[0-8][2-9]\\d|9(?:[2-9]\\d|0[2-9])))\\d{3,8}", "\\d{5,12}", , , "10234567"], [, , "6(?:[0-689]|7\\d)\\d{6,7}", "\\d{8,10}", , , "601234567"], [, , "800\\d{3,9}", 
"\\d{6,12}", , , "80012345"], [, , "(?:90[0169]|78\\d)\\d{3,7}", "\\d{6,12}", , , "90012345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "RS", 381, "00", "0", , , "0", , , , [[, "([23]\\d{2})(\\d{4,9})", "$1 $2", ["(?:2[389]|39)0"], "0$1"], [, "([1-3]\\d)(\\d{5,10})", "$1 $2", ["1|2(?:[0-24-7]|[389][1-9])|3(?:[0-8]|9[1-9])"], "0$1"], [, "(6\\d)(\\d{6,8})", "$1 $2", ["6"], "0$1"], [, "([89]\\d{2})(\\d{3,9})", "$1 $2", ["[89]"], "0$1"], [, "(7[26])(\\d{4,9})", "$1 $2", ["7[26]"], "0$1"], 
[, "(7[08]\\d)(\\d{4,9})", "$1 $2", ["7[08]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "7[06]\\d{4,10}", "\\d{6,12}", , , "700123456"], , , [, , "NA", "NA"]], RU:[, [, , "[3489]\\d{9}", "\\d{10}"], [, , "(?:3(?:0[12]|4[1-35-79]|5[1-3]|65|8[1-58]|9[0145])|4(?:01|1[1356]|2[13467]|7[1-5]|8[1-7]|9[1-689])|8(?:1[1-8]|2[01]|3[13-6]|4[0-8]|5[15]|6[1-35-79]|7[1-37-9]))\\d{7}", "\\d{10}", , , "3011234567"], [, , "9\\d{9}", "\\d{10}", , , "9123456789"], [, , "80[04]\\d{7}", "\\d{10}", , , "8001234567"], 
[, , "80[39]\\d{7}", "\\d{10}", , , "8091234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "RU", 7, "810", "8", , , "8", , "8~10", , [[, "(\\d{3})(\\d{2})(\\d{2})", "$1-$2-$3", ["[1-79]"], "$1", , 1], [, "([3489]\\d{2})(\\d{3})(\\d{2})(\\d{2})", "$1 $2-$3-$4", ["[34689]"], "8 ($1)", , 1], [, "(7\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["7"], "8 ($1)", , 1]], [[, "([3489]\\d{2})(\\d{3})(\\d{2})(\\d{2})", "$1 $2-$3-$4", ["[34689]"], "8 ($1)", , 1], [, "(7\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", 
["7"], "8 ($1)", , 1]], [, , "NA", "NA"], 1, , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], RW:[, [, , "[027-9]\\d{7,8}", "\\d{8,9}"], [, , "2[258]\\d{7}|06\\d{6}", "\\d{8,9}", , , "250123456"], [, , "7[238]\\d{7}", "\\d{9}", , , "720123456"], [, , "800\\d{6}", "\\d{9}", , , "800123456"], [, , "900\\d{6}", "\\d{9}", , , "900123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "RW", 250, "00", "0", , , "0", , , , [[, "(2\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["2"], "$1"], [, 
"([7-9]\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["[7-9]"], "0$1"], [, "(0\\d)(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["0"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]], SA:[, [, , "1\\d{7,8}|(?:[2-467]|92)\\d{7}|5\\d{8}|8\\d{9}", "\\d{7,10}"], [, , "11\\d{7}|1?(?:2[24-8]|3[35-8]|4[3-68]|6[2-5]|7[235-7])\\d{6}", "\\d{7,9}", , , "112345678"], [, , "(?:5(?:[013-689]\\d|7[0-26-8])|811\\d)\\d{6}", "\\d{9,10}", , , "512345678"], [, , "800\\d{7}", "\\d{10}", , , "8001234567"], 
[, , "NA", "NA"], [, , "92[05]\\d{6}", "\\d{9}", , , "920012345"], [, , "NA", "NA"], [, , "NA", "NA"], "SA", 966, "00", "0", , , "0", , , , [[, "([1-467])(\\d{3})(\\d{4})", "$1 $2 $3", ["[1-467]"], "0$1"], [, "(1\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["1[1-467]"], "0$1"], [, "(5\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["5"], "0$1"], [, "(92\\d{2})(\\d{5})", "$1 $2", ["92"], "$1"], [, "(800)(\\d{3})(\\d{4})", "$1 $2 $3", ["80"], "$1"], [, "(811)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["81"], "0$1"]], , [, , "NA", 
"NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], SB:[, [, , "[1-9]\\d{4,6}", "\\d{5,7}"], [, , "(?:1[4-79]|[23]\\d|4[0-2]|5[03]|6[0-37])\\d{3}", "\\d{5}", , , "40123"], [, , "48\\d{3}|7(?:30|[46-8]\\d|5[025-9]|9[0-5])\\d{4}|8[4-9]\\d{5}|9(?:1[2-9]|2[013-9]|3[0-2]|[46]\\d|5[0-46-9]|7[0-689]|8[0-79]|9[0-8])\\d{4}", "\\d{5,7}", , , "7421234"], [, , "1[38]\\d{3}", "\\d{5}", , , "18123"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "5[12]\\d{3}", "\\d{5}", , , "51123"], 
"SB", 677, "0[01]", , , , , , , , [[, "(\\d{2})(\\d{5})", "$1 $2", ["[7-9]"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], SC:[, [, , "[2468]\\d{5,6}", "\\d{6,7}"], [, , "4[2-46]\\d{5}", "\\d{7}", , , "4217123"], [, , "2[5-8]\\d{5}", "\\d{7}", , , "2510123"], [, , "8000\\d{2}", "\\d{6}", , , "800000"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "64\\d{5}", "\\d{7}", , , "6412345"], "SC", 248, "0[0-2]", , , , , , "00", , [[, "(\\d{3})(\\d{3})", 
"$1 $2", ["8"]], [, "(\\d)(\\d{3})(\\d{3})", "$1 $2 $3", ["[246]"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], SD:[, [, , "[19]\\d{8}", "\\d{9}"], [, , "1(?:[125]\\d|8[3567])\\d{6}", "\\d{9}", , , "121231234"], [, , "9[0-3569]\\d{7}", "\\d{9}", , , "911231234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "SD", 249, "00", "0", , , "0", , , , [[, "(\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", , "0$1"]], , [, , "NA", "NA"], 
, , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], SE:[, [, , "[1-35-9]\\d{5,11}|4\\d{6,8}", "\\d{6,12}"], [, , "1(?:0[1-8]\\d{6}|[136]\\d{5,7}|(?:2[0-35]|4[0-4]|5[0-25-9]|7[13-6]|[89]\\d)\\d{5,6})|2(?:[136]\\d{5,7}|(?:2[0-7]|4[0136-8]|5[0138]|7[018]|8[01]|9[0-57])\\d{5,6})|3(?:[356]\\d{5,7}|(?:0[0-4]|1\\d|2[0-25]|4[056]|7[0-2]|8[0-3]|9[023])\\d{5,6})|4(?:[0246]\\d{5,7}|(?:1[013-8]|3[0135]|5[14-79]|7[0-246-9]|8[0156]|9[0-689])\\d{5,6})|5(?:0[0-6]|[15][0-5]|2[0-68]|3[0-4]|4\\d|6[03-5]|7[013]|8[0-79]|9[01])\\d{5,6}|6(?:[03]\\d{5,7}|(?:1[1-3]|2[0-4]|4[02-57]|5[0-37]|6[0-3]|7[0-2]|8[0247]|9[0-356])\\d{5,6})|8\\d{6,8}|9(?:0[1-9]\\d{4,6}|(?:1[0-68]|2\\d|3[02-5]|4[0-3]|5[0-4]|[68][01]|7[0135-8])\\d{5,6})", 
"\\d{7,9}", , , "8123456"], [, , "7[02369]\\d{7}", "\\d{9}", , , "701234567"], [, , "20\\d{4,7}", "\\d{6,9}", , , "20123456"], [, , "649\\d{6}|9(?:00|39|44)[1-8]\\d{3,6}", "\\d{7,10}", , , "9001234567"], [, , "77(?:0\\d{3}(?:\\d{3})?|[1-7]\\d{6})", "\\d{6}(?:\\d{3})?", , , "771234567"], [, , "75[1-8]\\d{6}", "\\d{9}", , , "751234567"], [, , "NA", "NA"], "SE", 46, "00", "0", , , "0", , , , [[, "(8)(\\d{2,3})(\\d{2,3})(\\d{2})", "$1-$2 $3 $4", ["8"], "0$1"], [, "([1-69]\\d)(\\d{2,3})(\\d{2})(\\d{2})", 
"$1-$2 $3 $4", ["1[013689]|2[0136]|3[1356]|4[0246]|54|6[03]|90"], "0$1"], [, "([1-469]\\d)(\\d{3})(\\d{2})", "$1-$2 $3", ["1[136]|2[136]|3[356]|4[0246]|6[03]|90"], "0$1"], [, "(\\d{3})(\\d{2})(\\d{2})(\\d{2})", "$1-$2 $3 $4", ["1[2457]|2(?:[247-9]|5[0138])|3[0247-9]|4[1357-9]|5[0-35-9]|6(?:[124-689]|7[0-2])|9(?:[125-8]|3[0-5]|4[0-3])"], "0$1"], [, "(\\d{3})(\\d{2,3})(\\d{2})", "$1-$2 $3", ["1[2457]|2(?:[247-9]|5[0138])|3[0247-9]|4[1357-9]|5[0-35-9]|6(?:[124-689]|7[0-2])|9(?:[125-8]|3[0-5]|4[0-3])"], 
"0$1"], [, "(7\\d)(\\d{3})(\\d{2})(\\d{2})", "$1-$2 $3 $4", ["7"], "0$1"], [, "(77)(\\d{2})(\\d{2})", "$1-$2$3", ["7"], "0$1"], [, "(20)(\\d{2,3})(\\d{2})", "$1-$2 $3", ["20"], "0$1"], [, "(9[034]\\d)(\\d{2})(\\d{2})(\\d{3})", "$1-$2 $3 $4", ["9[034]"], "0$1"], [, "(9[034]\\d)(\\d{4})", "$1-$2", ["9[034]"], "0$1"], [, "(\\d{3})(\\d{2})(\\d{3})(\\d{2})(\\d{2})", "$1-$2 $3 $4 $5", ["25[245]|67[3-6]"], "0$1"]], [[, "(8)(\\d{2,3})(\\d{2,3})(\\d{2})", "$1 $2 $3 $4", ["8"]], [, "([1-69]\\d)(\\d{2,3})(\\d{2})(\\d{2})", 
"$1 $2 $3 $4", ["1[013689]|2[0136]|3[1356]|4[0246]|54|6[03]|90"]], [, "([1-469]\\d)(\\d{3})(\\d{2})", "$1 $2 $3", ["1[136]|2[136]|3[356]|4[0246]|6[03]|90"]], [, "(\\d{3})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["1[2457]|2(?:[247-9]|5[0138])|3[0247-9]|4[1357-9]|5[0-35-9]|6(?:[124-689]|7[0-2])|9(?:[125-8]|3[0-5]|4[0-3])"]], [, "(\\d{3})(\\d{2,3})(\\d{2})", "$1 $2 $3", ["1[2457]|2(?:[247-9]|5[0138])|3[0247-9]|4[1357-9]|5[0-35-9]|6(?:[124-689]|7[0-2])|9(?:[125-8]|3[0-5]|4[0-3])"]], [, "(7\\d)(\\d{3})(\\d{2})(\\d{2})", 
"$1 $2 $3 $4", ["7"]], [, "(77)(\\d{2})(\\d{2})", "$1 $2 $3", ["7"]], [, "(20)(\\d{2,3})(\\d{2})", "$1 $2 $3", ["20"]], [, "(9[034]\\d)(\\d{2})(\\d{2})(\\d{3})", "$1 $2 $3 $4", ["9[034]"]], [, "(9[034]\\d)(\\d{4})", "$1 $2", ["9[034]"]], [, "(\\d{3})(\\d{2})(\\d{3})(\\d{2})(\\d{2})", "$1 $2 $3 $4 $5", ["25[245]|67[3-6]"]]], [, , "74[02-9]\\d{6}", "\\d{9}", , , "740123456"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "(?:25[245]|67[3-6])\\d{9}", "\\d{12}", , , "254123456789"]], SG:[, [, , "[36]\\d{7}|[17-9]\\d{7,10}", 
"\\d{8,11}"], [, , "6[1-9]\\d{6}", "\\d{8}", , , "61234567"], [, , "(?:8[1-8]|9[0-8])\\d{6}", "\\d{8}", , , "81234567"], [, , "1?800\\d{7}", "\\d{10,11}", , , "18001234567"], [, , "1900\\d{7}", "\\d{11}", , , "19001234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "3[12]\\d{6}", "\\d{8}", , , "31234567"], "SG", 65, "0[0-3]\\d", , , , , , , , [[, "([3689]\\d{3})(\\d{4})", "$1 $2", ["[369]|8[1-9]"]], [, "(1[89]00)(\\d{3})(\\d{4})", "$1 $2 $3", ["1[89]"]], [, "(7000)(\\d{4})(\\d{3})", "$1 $2 $3", ["70"]], 
[, "(800)(\\d{3})(\\d{4})", "$1 $2 $3", ["80"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "7000\\d{7}", "\\d{11}", , , "70001234567"], , , [, , "NA", "NA"]], SH:[, [, , "[256]\\d{4}", "\\d{4,5}"], [, , "2(?:[0-57-9]\\d|6[4-9])\\d{2}", "\\d{5}", , , "22158"], [, , "[56]\\d{4}", "\\d{5}"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "262\\d{2}", "\\d{5}"], "SH", 290, "00", , , , , , , , , , [, , "NA", "NA"], 1, , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", 
"NA"]], SI:[, [, , "[1-7]\\d{6,7}|[89]\\d{4,7}", "\\d{5,8}"], [, , "(?:1\\d|[25][2-8]|3[24-8]|4[24-8]|7[3-8])\\d{6}", "\\d{7,8}", , , "11234567"], [, , "(?:[37][01]|4[0139]|51|6[48])\\d{6}", "\\d{8}", , , "31234567"], [, , "80\\d{4,6}", "\\d{6,8}", , , "80123456"], [, , "90\\d{4,6}|89[1-3]\\d{2,5}", "\\d{5,8}", , , "90123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "(?:59|8[1-3])\\d{6}", "\\d{8}", , , "59012345"], "SI", 386, "00", "0", , , "0", , , , [[, "(\\d)(\\d{3})(\\d{2})(\\d{2})", "$1 $2 $3 $4", 
["[12]|3[24-8]|4[24-8]|5[2-8]|7[3-8]"], "(0$1)"], [, "([3-7]\\d)(\\d{3})(\\d{3})", "$1 $2 $3", ["[37][01]|4[0139]|51|6"], "0$1"], [, "([89][09])(\\d{3,6})", "$1 $2", ["[89][09]"], "0$1"], [, "([58]\\d{2})(\\d{5})", "$1 $2", ["59|8[1-3]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], SJ:[, [, , "0\\d{4}|[4789]\\d{7}", "\\d{5}(?:\\d{3})?"], [, , "79\\d{6}", "\\d{8}", , , "79123456"], [, , "(?:4[015-8]|5[89]|9\\d)\\d{6}", "\\d{8}", , , "41234567"], [, , 
"80[01]\\d{5}", "\\d{8}", , , "80012345"], [, , "82[09]\\d{5}", "\\d{8}", , , "82012345"], [, , "810(?:0[0-6]|[2-8]\\d)\\d{3}", "\\d{8}", , , "81021234"], [, , "880\\d{5}", "\\d{8}", , , "88012345"], [, , "85[0-5]\\d{5}", "\\d{8}", , , "85012345"], "SJ", 47, "00", , , , , , , , , , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "0\\d{4}|81(?:0(?:0[7-9]|1\\d)|5\\d{2})\\d{3}", "\\d{5}(?:\\d{3})?", , , "01234"], 1, , [, , "81[23]\\d{5}", "\\d{8}", , , "81212345"]], SK:[, [, , "(?:[2-68]\\d{5,8}|9\\d{6,8})", 
"\\d{6,9}"], [, , "2(?:16\\d{3,4}|\\d{8})|[3-5](?:[1-8]16\\d{2,3}|\\d{8})", "\\d{6,9}", , , "212345678"], [, , "9(?:0(?:[1-8]\\d|9[1-9])|(?:1[0-24-9]|4[0489]|50)\\d)\\d{5}", "\\d{9}", , , "912123456"], [, , "800\\d{6}", "\\d{9}", , , "800123456"], [, , "9(?:[78]\\d{7}|00\\d{6})", "\\d{9}", , , "900123456"], [, , "8[5-9]\\d{7}", "\\d{9}", , , "850123456"], [, , "NA", "NA"], [, , "6(?:02|5[0-4]|9[0-6])\\d{6}", "\\d{9}", , , "690123456"], "SK", 421, "00", "0", , , "0", , , , [[, "(2)(16)(\\d{3,4})", 
"$1 $2 $3", ["216"], "0$1"], [, "([3-5]\\d)(16)(\\d{2,3})", "$1 $2 $3", ["[3-5]"], "0$1"], [, "(2)(\\d{3})(\\d{3})(\\d{2})", "$1/$2 $3 $4", ["2"], "0$1"], [, "([3-5]\\d)(\\d{3})(\\d{2})(\\d{2})", "$1/$2 $3 $4", ["[3-5]"], "0$1"], [, "([689]\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["[689]"], "0$1"], [, "(9090)(\\d{3})", "$1 $2", ["9090"], "0$1"]], , [, , "9090\\d{3}", "\\d{7}", , , "9090123"], , , [, , "(?:602|8(?:00|[5-9]\\d)|9(?:00|[78]\\d))\\d{6}|9090\\d{3}", "\\d{7,9}", , , "800123456"], [, , "96\\d{7}", 
"\\d{9}", , , "961234567"], , , [, , "NA", "NA"]], SL:[, [, , "[2-9]\\d{7}", "\\d{6,8}"], [, , "[235]2[2-4][2-9]\\d{4}", "\\d{6,8}", , , "22221234"], [, , "(?:2[15]|3[03-5]|4[04]|5[05]|66|7[6-9]|88|99)\\d{6}", "\\d{6,8}", , , "25123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "SL", 232, "00", "0", , , "0", , , , [[, "(\\d{2})(\\d{6})", "$1 $2", , "(0$1)"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], SM:[, 
[, , "[05-7]\\d{7,9}", "\\d{6,10}"], [, , "0549(?:8[0157-9]|9\\d)\\d{4}", "\\d{6,10}", , , "0549886377"], [, , "6[16]\\d{6}", "\\d{8}", , , "66661212"], [, , "NA", "NA"], [, , "7[178]\\d{6}", "\\d{8}", , , "71123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "5[158]\\d{6}", "\\d{8}", , , "58001110"], "SM", 378, "00", , , , "(?:0549)?([89]\\d{5})", "0549$1", , , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[5-7]"]], [, "(0549)(\\d{6})", "$1 $2", ["0"]], [, "(\\d{6})", "0549 $1", ["[89]"]]], 
[[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[5-7]"]], [, "(0549)(\\d{6})", "($1) $2", ["0"]], [, "(\\d{6})", "(0549) $1", ["[89]"]]], [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]], SN:[, [, , "[3789]\\d{8}", "\\d{9}"], [, , "3(?:0(?:1[0-2]|80)|282|3(?:8[1-9]|9[3-9])|611|90[1-5])\\d{5}", "\\d{9}", , , "301012345"], [, , "7(?:[067]\\d|21|8[0-46]|90)\\d{6}", "\\d{9}", , , "701234567"], [, , "800\\d{6}", "\\d{9}", , , "800123456"], [, , "88[4689]\\d{6}", 
"\\d{9}", , , "884123456"], [, , "81[02468]\\d{6}", "\\d{9}", , , "810123456"], [, , "NA", "NA"], [, , "3392\\d{5}|93330\\d{4}", "\\d{9}", , , "933301234"], "SN", 221, "00", , , , , , , , [[, "(\\d{2})(\\d{3})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["[379]"]], [, "(\\d{3})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["8"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], SO:[, [, , "[1-79]\\d{6,8}", "\\d{7,9}"], [, , "(?:1\\d|2[0-79]|3[0-46-8]|4[0-7]|59)\\d{5}", "\\d{7}", 
, , "4012345"], [, , "(?:15\\d|2(?:4\\d|8)|6[1-35-9]?\\d{2}|7(?:[1-8]\\d|99?\\d)|9(?:0[67]|[2-9])\\d)\\d{5}", "\\d{7,9}", , , "71123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "SO", 252, "00", "0", , , "0", , , , [[, "(\\d)(\\d{6})", "$1 $2", ["2[0-79]|[13-5]"]], [, "(\\d)(\\d{7})", "$1 $2", ["24|[67]"]], [, "(\\d{2})(\\d{5,7})", "$1 $2", ["15|28|6[1-35-9]|799|9[2-9]"]], [, "(90\\d)(\\d{3})(\\d{3})", "$1 $2 $3", ["90"]]], , [, , "NA", "NA"], , 
, [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], SR:[, [, , "[2-8]\\d{5,6}", "\\d{6,7}"], [, , "(?:2[1-3]|3[0-7]|4\\d|5[2-58]|68\\d)\\d{4}", "\\d{6,7}", , , "211234"], [, , "(?:7[124-7]|8[1-9])\\d{5}", "\\d{7}", , , "7412345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "5(?:6\\d{4}|90[0-4]\\d{3})", "\\d{6,7}", , , "561234"], "SR", 597, "00", , , , , , , , [[, "(\\d{3})(\\d{3})", "$1-$2", ["[2-4]|5[2-58]"]], [, "(\\d{2})(\\d{2})(\\d{2})", "$1-$2-$3", 
["56"]], [, "(\\d{3})(\\d{4})", "$1-$2", ["59|[6-8]"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], SS:[, [, , "[19]\\d{8}", "\\d{9}"], [, , "18\\d{7}", "\\d{9}", , , "181234567"], [, , "(?:12|9[1257])\\d{7}", "\\d{9}", , , "977123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "SS", 211, "00", "0", , , "0", , , , [[, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3", , "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], 
[, , "NA", "NA"], , , [, , "NA", "NA"]], ST:[, [, , "[29]\\d{6}", "\\d{7}"], [, , "22\\d{5}", "\\d{7}", , , "2221234"], [, , "9(?:0(?:0[5-9]|[1-9]\\d)|[89]\\d{2})\\d{3}", "\\d{7}", , , "9812345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "ST", 239, "00", , , , , , , , [[, "(\\d{3})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], SV:[, [, , "[267]\\d{7}|[89]\\d{6}(?:\\d{4})?", "\\d{7,8}|\\d{11}"], 
[, , "2[1-6]\\d{6}", "\\d{8}", , , "21234567"], [, , "[67]\\d{7}", "\\d{8}", , , "70123456"], [, , "800\\d{4}(?:\\d{4})?", "\\d{7}(?:\\d{4})?", , , "8001234"], [, , "900\\d{4}(?:\\d{4})?", "\\d{7}(?:\\d{4})?", , , "9001234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "SV", 503, "00", , , , , , , , [[, "(\\d{4})(\\d{4})", "$1 $2", ["[267]"]], [, "(\\d{3})(\\d{4})", "$1 $2", ["[89]"]], [, "(\\d{3})(\\d{4})(\\d{4})", "$1 $2 $3", ["[89]"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , 
"NA", "NA"], , , [, , "NA", "NA"]], SX:[, [, , "[5789]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "7215(?:4[2-8]|8[239]|9[056])\\d{4}", "\\d{7}(?:\\d{3})?", , , "7215425678"], [, , "7215(?:1[02]|2\\d|5[034679]|8[014-8])\\d{4}", "\\d{10}", , , "7215205678"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002123456"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002123456"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "SX", 1, "011", "1", 
, , "1", , , , , , [, , "NA", "NA"], , "721", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], SY:[, [, , "[1-59]\\d{7,8}", "\\d{6,9}"], [, , "(?:1(?:1\\d?|4\\d|[2356])|2(?:1\\d?|[235])|3(?:[13]\\d|4)|4[13]|5[1-3])\\d{6}", "\\d{6,9}", , , "112345678"], [, , "9(?:22|[35][0-8]|4\\d|6[024-9]|88|9[0-489])\\d{6}", "\\d{9}", , , "944567890"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "SY", 963, "00", "0", , , "0", , , , [[, "(\\d{2})(\\d{3})(\\d{3,4})", 
"$1 $2 $3", ["[1-5]"], "0$1", , 1], [, "(9\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["9"], "0$1", , 1]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], SZ:[, [, , "[027]\\d{7}", "\\d{8}"], [, , "2[2-5]\\d{6}", "\\d{8}", , , "22171234"], [, , "7[6-8]\\d{6}", "\\d{8}", , , "76123456"], [, , "0800\\d{4}", "\\d{8}", , , "08001234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "SZ", 268, "00", , , , , , , , [[, "(\\d{4})(\\d{4})", "$1 $2", ["[027]"]]], 
, [, , "NA", "NA"], , , [, , "0800\\d{4}", "\\d{8}", , , "08001234"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]], TA:[, [, , "8\\d{3}", "\\d{4}"], [, , "8\\d{3}", "\\d{4}", , , "8999"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "TA", 290, "00", , , , , , , , , , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], TC:[, [, , "[5689]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "649(?:712|9(?:4\\d|50))\\d{4}", "\\d{7}(?:\\d{3})?", 
, , "6497121234"], [, , "649(?:2(?:3[129]|4[1-7])|3(?:3[1-389]|4[1-8])|4[34][1-3])\\d{4}", "\\d{10}", , , "6492311234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002345678"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002345678"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "64971[01]\\d{4}", "\\d{10}", , , "6497101234"], "TC", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "649", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , 
"NA", "NA"]], TD:[, [, , "[2679]\\d{7}", "\\d{8}"], [, , "22(?:[3789]0|5[0-5]|6[89])\\d{4}", "\\d{8}", , , "22501234"], [, , "(?:6[023568]\\d|77\\d|9\\d{2})\\d{5}", "\\d{8}", , , "63012345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "TD", 235, "00|16", , , , , , "00", , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], TG:[, [, , "[29]\\d{7}", "\\d{8}"], [, , 
"2(?:2[2-7]|3[23]|44|55|66|77)\\d{5}", "\\d{8}", , , "22212345"], [, , "9[0-389]\\d{6}", "\\d{8}", , , "90112345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "TG", 228, "00", , , , , , , , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3 $4"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], TH:[, [, , "[2-9]\\d{7,8}|1\\d{3}(?:\\d{5,6})?", "\\d{4}|\\d{8,10}"], [, , "(?:2\\d|3[2-9]|4[2-5]|5[2-6]|7[3-7])\\d{6}", "\\d{8}", 
, , "21234567"], [, , "(?:14|6[1-4]|[89]\\d)\\d{7}", "\\d{9}", , , "812345678"], [, , "1800\\d{6}", "\\d{10}", , , "1800123456"], [, , "1900\\d{6}", "\\d{10}", , , "1900123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "6[08]\\d{7}", "\\d{9}", , , "601234567"], "TH", 66, "00", "0", , , "0", , , , [[, "(2)(\\d{3})(\\d{4})", "$1 $2 $3", ["2"], "0$1"], [, "([13-9]\\d)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["14|[3-9]"], "0$1"], [, "(1[89]00)(\\d{3})(\\d{3})", "$1 $2 $3", ["1"], "$1"]], , [, , "NA", "NA"], 
, , [, , "1\\d{3}", "\\d{4}", , , "1100"], [, , "1\\d{3}", "\\d{4}", , , "1100"], , , [, , "NA", "NA"]], TJ:[, [, , "[3-589]\\d{8}", "\\d{3,9}"], [, , "(?:3(?:1[3-5]|2[245]|3[12]|4[24-7]|5[25]|72)|4(?:46|74|87))\\d{6}", "\\d{3,9}", , , "372123456"], [, , "(?:41[18]|5(?:0[125]|5\\d)|88\\d|9[0-35-9]\\d)\\d{6}", "\\d{9}", , , "917123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "TJ", 992, "810", "8", , , "8", , "8~10", , [[, "([349]\\d{2})(\\d{2})(\\d{4})", 
"$1 $2 $3", ["[34]7|91[78]"], "(8) $1", , 1], [, "([4589]\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["4[148]|[58]|9(?:1[59]|[0235-9])"], "(8) $1", , 1], [, "(331700)(\\d)(\\d{2})", "$1 $2 $3", ["331", "3317", "33170", "331700"], "(8) $1", , 1], [, "(\\d{4})(\\d)(\\d{4})", "$1 $2 $3", ["3[1-5]", "3(?:[1245]|3(?:[02-9]|1[0-589]))"], "(8) $1", , 1]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], TK:[, [, , "[2-47]\\d{3,6}", "\\d{4,7}"], [, , "(?:2[2-4]|[34]\\d)\\d{2,5}", 
"\\d{4,7}", , , "3101"], [, , "7[2-4]\\d{2,5}", "\\d{4,7}", , , "7290"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "TK", 690, "00", , , , , , , , , , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], TL:[, [, , "[2-489]\\d{6}|7\\d{6,7}", "\\d{7,8}"], [, , "(?:2[1-5]|3[1-9]|4[1-4])\\d{5}", "\\d{7}", , , "2112345"], [, , "7[3-8]\\d{6}", "\\d{8}", , , "77212345"], [, , "80\\d{5}", "\\d{7}", , , "8012345"], [, , "90\\d{5}", 
"\\d{7}", , , "9012345"], [, , "NA", "NA"], [, , "70\\d{5}", "\\d{7}", , , "7012345"], [, , "NA", "NA"], "TL", 670, "00", , , , , , , , [[, "(\\d{3})(\\d{4})", "$1 $2", ["[2-489]"]], [, "(\\d{4})(\\d{4})", "$1 $2", ["7"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], TM:[, [, , "[1-6]\\d{7}", "\\d{8}"], [, , "(?:1(?:2\\d|3[1-9])|2(?:22|4[0-35-8])|3(?:22|4[03-9])|4(?:22|3[128]|4\\d|6[15])|5(?:22|5[7-9]|6[014-689]))\\d{5}", "\\d{8}", , , "12345678"], [, , "6[1-9]\\d{6}", 
"\\d{8}", , , "66123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "TM", 993, "810", "8", , , "8", , "8~10", , [[, "(\\d{2})(\\d{2})(\\d{2})(\\d{2})", "$1 $2-$3-$4", ["12"], "(8 $1)"], [, "(\\d{2})(\\d{6})", "$1 $2", ["6"], "8 $1"], [, "(\\d{3})(\\d)(\\d{2})(\\d{2})", "$1 $2-$3-$4", ["13|[2-5]"], "(8 $1)"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], TN:[, [, , "[2-57-9]\\d{7}", "\\d{8}"], [, , "3(?:[012]\\d|6[0-4]|91)\\d{5}|7\\d{7}|81200\\d{3}", 
"\\d{8}", , , "71234567"], [, , "(?:[259]\\d|4[0-6])\\d{6}", "\\d{8}", , , "20123456"], [, , "8010\\d{4}", "\\d{8}", , , "80101234"], [, , "88\\d{6}", "\\d{8}", , , "88123456"], [, , "8[12]10\\d{4}", "\\d{8}", , , "81101234"], [, , "NA", "NA"], [, , "NA", "NA"], "TN", 216, "00", , , , , , , , [[, "(\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], TO:[, [, , "[02-8]\\d{4,6}", "\\d{5,7}"], [, , "(?:2\\d|3[1-8]|4[1-4]|[56]0|7[0149]|8[05])\\d{3}", 
"\\d{5}", , , "20123"], [, , "(?:7[578]|8[47-9])\\d{5}", "\\d{7}", , , "7715123"], [, , "0800\\d{3}", "\\d{7}", , , "0800222"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "TO", 676, "00", , , , , , , , [[, "(\\d{2})(\\d{3})", "$1-$2", ["[1-6]|7[0-4]|8[05]"]], [, "(\\d{3})(\\d{4})", "$1 $2", ["7[5-9]|8[47-9]"]], [, "(\\d{4})(\\d{3})", "$1 $2", ["0"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]], TR:[, [, , "[2-589]\\d{9}|444\\d{4}", 
"\\d{7,10}"], [, , "(?:2(?:[13][26]|[28][2468]|[45][268]|[67][246])|3(?:[13][28]|[24-6][2468]|[78][02468]|92)|4(?:[16][246]|[23578][2468]|4[26]))\\d{7}", "\\d{10}", , , "2123456789"], [, , "5(?:0[1-7]|22|[34]\\d|5[1-59]|9[246])\\d{7}", "\\d{10}", , , "5012345678"], [, , "800\\d{7}", "\\d{10}", , , "8001234567"], [, , "900\\d{7}", "\\d{10}", , , "9001234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "TR", 90, "00", "0", , , "0", , , , [[, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["[23]|4(?:[0-35-9]|4[0-35-9])"], 
"(0$1)", , 1], [, "(\\d{3})(\\d{3})(\\d{4})", "$1 $2 $3", ["[589]"], "0$1", , 1], [, "(444)(\\d{1})(\\d{3})", "$1 $2 $3", ["444"]]], , [, , "512\\d{7}", "\\d{10}", , , "5123456789"], , , [, , "444\\d{4}", "\\d{7}", , , "4441444"], [, , "444\\d{4}|850\\d{7}", "\\d{7,10}", , , "4441444"], , , [, , "NA", "NA"]], TT:[, [, , "[589]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "868(?:2(?:01|2[1-6]|3[1-5])|6(?:0[79]|1[02-8]|2[1-9]|[3-69]\\d|7[0-79])|82[124])\\d{4}", "\\d{7}(?:\\d{3})?", , , "8682211234"], [, , "868(?:2(?:[789]\\d)|3(?:0[1-9]|1[02-9]|[2-9]\\d)|4[6-9]\\d|6(?:20|78|8\\d)|7(?:0[1-9]|1[02-9]|[2-9]\\d))\\d{4}", 
"\\d{10}", , , "8682911234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002345678"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002345678"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "TT", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "868", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "868619\\d{4}", "\\d{10}"]], TV:[, [, , "[279]\\d{4,6}", "\\d{5,7}"], [, , "2[02-9]\\d{3}", "\\d{5}", , , "20123"], [, , "(?:70\\d|90)\\d{4}", 
"\\d{6,7}", , , "901234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "TV", 688, "00", , , , , , , , , , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], TW:[, [, , "[2-689]\\d{7,8}|7\\d{7,9}", "\\d{8,10}"], [, , "[2-8]\\d{7,8}", "\\d{8,9}", , , "21234567"], [, , "9\\d{8}", "\\d{9}", , , "912345678"], [, , "800\\d{6}", "\\d{9}", , , "800123456"], [, , "900\\d{6}", "\\d{9}", , , "900123456"], [, , "NA", "NA"], [, , "NA", 
"NA"], [, , "70\\d{8}", "\\d{10}", , , "7012345678"], "TW", 886, "0(?:0[25679]|19)", "0", "#", , "0", , , , [[, "([2-8])(\\d{3,4})(\\d{4})", "$1 $2 $3", ["[2-6]|[78][1-9]"], "0$1"], [, "([89]\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["80|9"], "0$1"], [, "(70)(\\d{4})(\\d{4})", "$1 $2 $3", ["70"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], TZ:[, [, , "\\d{9}", "\\d{7,9}"], [, , "2[2-8]\\d{7}", "\\d{7,9}", , , "222345678"], [, , "(?:6[125-9]|7[1-9])\\d{7}", 
"\\d{9}", , , "621234567"], [, , "80[08]\\d{6}", "\\d{9}", , , "800123456"], [, , "90\\d{7}", "\\d{9}", , , "900123456"], [, , "8(?:40|6[01])\\d{6}", "\\d{9}", , , "840123456"], [, , "NA", "NA"], [, , "41\\d{7}", "\\d{9}", , , "412345678"], "TZ", 255, "00[056]", "0", , , "0", , , , [[, "([24]\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["[24]"], "0$1"], [, "([67]\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["[67]"], "0$1"], [, "([89]\\d{2})(\\d{2})(\\d{4})", "$1 $2 $3", ["[89]"], "0$1"]], , [, , "NA", "NA"], , , 
[, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], UA:[, [, , "[3-9]\\d{8}", "\\d{5,9}"], [, , "(?:3[1-8]|4[13-8]|5[1-7]|6[12459])\\d{7}", "\\d{5,9}", , , "311234567"], [, , "(?:39|50|6[36-8]|73|9[1-9])\\d{7}", "\\d{9}", , , "391234567"], [, , "800\\d{6}", "\\d{9}", , , "800123456"], [, , "900\\d{6}", "\\d{9}", , , "900123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "89\\d{7}", "\\d{9}", , , "891234567"], "UA", 380, "00", "0", , , "0", , "0~0", , [[, "([3-9]\\d)(\\d{3})(\\d{4})", "$1 $2 $3", 
["[38]9|4(?:[45][0-5]|87)|5(?:0|6[37]|7[37])|6[36-8]|73|9[1-9]", "[38]9|4(?:[45][0-5]|87)|5(?:0|6(?:3[14-7]|7)|7[37])|6[36-8]|73|9[1-9]"], "0$1"], [, "([3-689]\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["3[1-8]2|4[13678]2|5(?:[12457]2|6[24])|6(?:[49]2|[12][29]|5[24])|8[0-8]|90", "3(?:[1-46-8]2[013-9]|52)|4(?:[1378]2|62[013-9])|5(?:[12457]2|6[24])|6(?:[49]2|[12][29]|5[24])|8[0-8]|90"], "0$1"], [, "([3-6]\\d{3})(\\d{5})", "$1 $2", ["3(?:5[013-9]|[1-46-8])|4(?:[137][013-9]|6|[45][6-9]|8[4-6])|5(?:[1245][013-9]|6[0135-9]|3|7[4-6])|6(?:[49][013-9]|5[0135-9]|[12][13-8])", 
"3(?:5[013-9]|[1-46-8](?:22|[013-9]))|4(?:[137][013-9]|6(?:[013-9]|22)|[45][6-9]|8[4-6])|5(?:[1245][013-9]|6(?:3[02389]|[015689])|3|7[4-6])|6(?:[49][013-9]|5[0135-9]|[12][13-8])"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], UG:[, [, , "\\d{9}", "\\d{5,9}"], [, , "20(?:[0147]\\d{2}|2(?:40|[5-9]\\d)|3[23]\\d|5[0-4]\\d|6[03]\\d|8[0-2]\\d)\\d{4}|[34]\\d{8}", "\\d{5,9}", , , "312345678"], [, , "2030\\d{5}|7(?:0[0-7]|[15789]\\d|2[03]|30|[46][0-4])\\d{6}", 
"\\d{9}", , , "712345678"], [, , "800[123]\\d{5}", "\\d{9}", , , "800123456"], [, , "90[123]\\d{6}", "\\d{9}", , , "901123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "UG", 256, "00[057]", "0", , , "0", , , , [[, "(\\d{3})(\\d{6})", "$1 $2", ["[7-9]|20(?:[013-8]|2[5-9])|4(?:6[45]|[7-9])"], "0$1"], [, "(\\d{2})(\\d{7})", "$1 $2", ["3|4(?:[1-5]|6[0-36-9])"], "0$1"], [, "(2024)(\\d{5})", "$1 $2", ["2024"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , 
"NA", "NA"]], US:[, [, , "[2-9]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "(?:2(?:0[1-35-9]|1[02-9]|2[04589]|3[149]|4[08]|5[1-46]|6[0279]|7[026]|8[13])|3(?:0[1-57-9]|1[02-9]|2[0135]|3[014679]|4[67]|5[12]|6[014]|8[056])|4(?:0[124-9]|1[02-579]|2[3-5]|3[0245]|4[0235]|58|69|7[0589]|8[04])|5(?:0[1-57-9]|1[0235-8]|20|3[0149]|4[01]|5[19]|6[1-37]|7[013-5]|8[056])|6(?:0[1-35-9]|1[024-9]|2[03689]|3[016]|4[16]|5[017]|6[0-279]|78|8[12])|7(?:0[1-46-8]|1[02-9]|2[0457]|3[1247]|4[037]|5[47]|6[02359]|7[02-59]|8[156])|8(?:0[1-68]|1[02-8]|28|3[0-25]|4[3578]|5[046-9]|6[02-5]|7[028])|9(?:0[1346-9]|1[02-9]|2[0589]|3[014678]|4[0179]|5[12469]|7[0-3589]|8[0459]))[2-9]\\d{6}", 
"\\d{7}(?:\\d{3})?", , , "2015550123"], [, , "(?:2(?:0[1-35-9]|1[02-9]|2[04589]|3[149]|4[08]|5[1-46]|6[0279]|7[026]|8[13])|3(?:0[1-57-9]|1[02-9]|2[0135]|3[014679]|4[67]|5[12]|6[014]|8[056])|4(?:0[124-9]|1[02-579]|2[3-5]|3[0245]|4[0235]|58|69|7[0589]|8[04])|5(?:0[1-57-9]|1[0235-8]|20|3[0149]|4[01]|5[19]|6[1-37]|7[013-5]|8[056])|6(?:0[1-35-9]|1[024-9]|2[03689]|3[016]|4[16]|5[017]|6[0-279]|78|8[12])|7(?:0[1-46-8]|1[02-9]|2[0457]|3[1247]|4[037]|5[47]|6[02359]|7[02-59]|8[156])|8(?:0[1-68]|1[02-8]|28|3[0-25]|4[3578]|5[046-9]|6[02-5]|7[028])|9(?:0[1346-9]|1[02-9]|2[0589]|3[014678]|4[0179]|5[12469]|7[0-3589]|8[0459]))[2-9]\\d{6}", 
"\\d{7}(?:\\d{3})?", , , "2015550123"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002345678"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002345678"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "US", 1, "011", "1", , , "1", , , 1, [[, "(\\d{3})(\\d{4})", "$1-$2", , , , 1], [, "(\\d{3})(\\d{3})(\\d{4})", "($1) $2-$3", , , , 1]], [[, "(\\d{3})(\\d{3})(\\d{4})", "$1-$2-$3"]], [, , "NA", "NA"], 1, , [, , "NA", "NA"], [, , 
"NA", "NA"], , , [, , "NA", "NA"]], UY:[, [, , "[2489]\\d{6,7}", "\\d{7,8}"], [, , "2\\d{7}|4[2-7]\\d{6}", "\\d{7,8}", , , "21231234"], [, , "9[1-9]\\d{6}", "\\d{8}", , , "94231234"], [, , "80[05]\\d{4}", "\\d{7}", , , "8001234"], [, , "90[0-8]\\d{4}", "\\d{7}", , , "9001234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "UY", 598, "0(?:1[3-9]\\d|0)", "0", " int. ", , "0", , "00", , [[, "(\\d{4})(\\d{4})", "$1 $2", ["[24]"]], [, "(\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["9[1-9]"], "0$1"], 
[, "(\\d{3})(\\d{4})", "$1 $2", ["[89]0"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], UZ:[, [, , "[679]\\d{8}", "\\d{7,9}"], [, , "(?:6(?:1(?:22|3[124]|4[1-4]|5[123578]|64)|2(?:22|3[0-57-9]|41)|5(?:22|3[3-7]|5[024-8])|6\\d{2}|7(?:[23]\\d|7[69])|9(?:22|4[1-8]|6[135]))|7(?:0(?:5[4-9]|6[0146]|7[12456]|9[135-8])|1[12]\\d|2(?:22|3[1345789]|4[123579]|5[14])|3(?:2\\d|3[1578]|4[1-35-7]|5[1-57]|61)|4(?:2\\d|3[1-579]|7[1-79])|5(?:22|5[1-9]|6[1457])|6(?:22|3[12457]|4[13-8])|9(?:22|5[1-9])))\\d{5}", 
"\\d{7,9}", , , "662345678"], [, , "6(?:1(?:2(?:98|2[01])|35[0-4]|50\\d|61[23]|7(?:[01][017]|4\\d|55|9[5-9]))|2(?:11\\d|2(?:[12]1|9[01379])|5(?:[126]\\d|3[0-4])|7\\d{2})|5(?:19[01]|2(?:27|9[26])|30\\d|59\\d|7\\d{2})|6(?:2(?:1[5-9]|2[0367]|38|41|52|60)|3[79]\\d|4(?:56|83)|7(?:[07]\\d|1[017]|3[07]|4[047]|5[057]|67|8[0178]|9[79])|9[0-3]\\d)|7(?:2(?:24|3[237]|4[5-9]|7[15-8])|5(?:7[12]|8[0589])|7(?:0\\d|[39][07])|9(?:0\\d|7[079]))|9(?:2(?:1[1267]|5\\d|3[01]|7[0-4])|5[67]\\d|6(?:2[0-26]|8\\d)|7\\d{2}))\\d{4}|7(?:0\\d{3}|1(?:13[01]|6(?:0[47]|1[67]|66)|71[3-69]|98\\d)|2(?:2(?:2[79]|95)|3(?:2[5-9]|6[0-6])|57\\d|7(?:0\\d|1[17]|2[27]|3[37]|44|5[057]|66|88))|3(?:2(?:1[0-6]|21|3[469]|7[159])|33\\d|5(?:0[0-4]|5[579]|9\\d)|7(?:[0-3579]\\d|4[0467]|6[67]|8[078])|9[4-6]\\d)|4(?:2(?:29|5[0257]|6[0-7]|7[1-57])|5(?:1[0-4]|8\\d|9[5-9])|7(?:0\\d|1[024589]|2[0127]|3[0137]|[46][07]|5[01]|7[5-9]|9[079])|9(?:7[015-9]|[89]\\d))|5(?:112|2(?:0\\d|2[29]|[49]4)|3[1568]\\d|52[6-9]|7(?:0[01578]|1[017]|[23]7|4[047]|[5-7]\\d|8[78]|9[079]))|6(?:2(?:2[1245]|4[2-4])|39\\d|41[179]|5(?:[349]\\d|5[0-2])|7(?:0[017]|[13]\\d|22|44|55|67|88))|9(?:22[128]|3(?:2[0-4]|7\\d)|57[05629]|7(?:2[05-9]|3[37]|4\\d|60|7[2579]|87|9[07])))\\d{4}|9[0-57-9]\\d{7}", 
"\\d{7,9}", , , "912345678"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "UZ", 998, "810", "8", , , "8", , "8~10", , [[, "([679]\\d)(\\d{3})(\\d{2})(\\d{2})", "$1 $2 $3 $4", , "8 $1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], VA:[, [, , "(?:0(?:878\\d{5}|6698\\d{5})|[1589]\\d{5,10}|3(?:[12457-9]\\d{8}|[36]\\d{7,9}))", "\\d{6,11}"], [, , "06698\\d{5}", "\\d{10}", , , "0669812345"], [, , "3(?:[12457-9]\\d{8}|6\\d{7,8}|3\\d{7,9})", 
"\\d{9,11}", , , "3123456789"], [, , "80(?:0\\d{6}|3\\d{3})", "\\d{6,9}", , , "800123456"], [, , "0878\\d{5}|1(?:44|6[346])\\d{6}|89(?:2\\d{3}|4(?:[0-4]\\d{2}|[5-9]\\d{4})|5(?:[0-4]\\d{2}|[5-9]\\d{6})|9\\d{6})", "\\d{6,10}", , , "899123456"], [, , "84(?:[08]\\d{6}|[17]\\d{3})", "\\d{6,9}", , , "848123456"], [, , "1(?:78\\d|99)\\d{6}", "\\d{9,10}", , , "1781234567"], [, , "55\\d{8}", "\\d{10}", , , "5512345678"], "VA", 39, "00", , , , , , , , , , [, , "NA", "NA"], , , [, , "848\\d{6}", "\\d{9}", , 
, "848123456"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]], VC:[, [, , "[5789]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "784(?:266|3(?:6[6-9]|7\\d|8[0-24-6])|4(?:38|5[0-36-8]|8[0-8])|5(?:55|7[0-2]|93)|638|784)\\d{4}", "\\d{7}(?:\\d{3})?", , , "7842661234"], [, , "784(?:4(?:3[0-4]|5[45]|89|9[0-58])|5(?:2[6-9]|3[0-4]))\\d{4}", "\\d{10}", , , "7844301234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002345678"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002345678"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", 
"\\d{10}", , , "5002345678"], [, , "NA", "NA"], "VC", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "784", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], VE:[, [, , "[24589]\\d{9}", "\\d{7,10}"], [, , "(?:2(?:12|3[457-9]|[58][1-9]|[467]\\d|9[1-6])|50[01])\\d{7}", "\\d{7,10}", , , "2121234567"], [, , "4(?:1[24-8]|2[46])\\d{7}", "\\d{10}", , , "4121234567"], [, , "800\\d{7}", "\\d{10}", , , "8001234567"], [, , "900\\d{7}", "\\d{10}", , , "9001234567"], [, , "NA", "NA"], [, , "NA", 
"NA"], [, , "NA", "NA"], "VE", 58, "00", "0", , , "0", , , , [[, "(\\d{3})(\\d{7})", "$1-$2", , "0$1", "$CC $1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], VG:[, [, , "[2589]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "284(?:(?:229|4(?:22|9[45])|774|8(?:52|6[459]))\\d{4}|496[0-5]\\d{3})", "\\d{7}(?:\\d{3})?", , , "2842291234"], [, , "284(?:(?:3(?:0[0-3]|4[0-367]|94)|4(?:4[0-6]|68|99)|54[0-57])\\d{4}|496[6-9]\\d{3})", "\\d{10}", , , "2843001234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", 
"\\d{10}", , , "8002345678"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002345678"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "VG", 1, "011", "1", , , "1", , , , , , [, , "NA", "NA"], , "284", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], VI:[, [, , "[3589]\\d{9}", "\\d{7}(?:\\d{3})?"], [, , "340(?:2(?:01|2[0678]|44|77)|3(?:32|44)|4(?:22|7[34])|5(?:1[34]|55)|6(?:26|4[23]|77|9[023])|7(?:1[2-589]|27|7\\d)|884|998)\\d{4}", 
"\\d{7}(?:\\d{3})?", , , "3406421234"], [, , "340(?:2(?:01|2[0678]|44|77)|3(?:32|44)|4(?:22|7[34])|5(?:1[34]|55)|6(?:26|4[23]|77|9[023])|7(?:1[2-589]|27|7\\d)|884|998)\\d{4}", "\\d{7}(?:\\d{3})?", , , "3406421234"], [, , "8(?:00|44|55|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "8002345678"], [, , "900[2-9]\\d{6}", "\\d{10}", , , "9002345678"], [, , "NA", "NA"], [, , "5(?:00|33|44|66|77|88)[2-9]\\d{6}", "\\d{10}", , , "5002345678"], [, , "NA", "NA"], "VI", 1, "011", "1", , , "1", , , 1, , , [, , "NA", 
"NA"], , "340", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], VN:[, [, , "[17]\\d{6,9}|[2-69]\\d{7,9}|8\\d{6,8}", "\\d{7,10}"], [, , "(?:2(?:[025-79]|1[0189]|[348][01])|3(?:[0136-9]|[25][01])|4\\d|5(?:[01][01]|[2-9])|6(?:[0-46-8]|5[01])|7(?:[02-79]|[18][01]))\\d{7}|8(?:[1-57]\\d|[689][0-79])\\d{6}", "\\d{9,10}", , , "2101234567"], [, , "(?:9\\d|1(?:2\\d|6[2-9]|8[68]|99))\\d{7}|8[689]8\\d{6}", "\\d{9,10}", , , "912345678"], [, , "1800\\d{4,6}", "\\d{8,10}", , , "1800123456"], [, , "1900\\d{4,6}", 
"\\d{8,10}", , , "1900123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "VN", 84, "00", "0", , , "0", , , , [[, "([17]99)(\\d{4})", "$1 $2", ["[17]99"], "0$1", , 1], [, "([48])(\\d{4})(\\d{4})", "$1 $2 $3", ["4|8(?:[1-57]|[689][0-79])"], "0$1", , 1], [, "([235-7]\\d)(\\d{4})(\\d{3})", "$1 $2 $3", ["2[025-79]|3[0136-9]|5[2-9]|6[0-46-8]|7[02-79]"], "0$1", , 1], [, "(80)(\\d{5})", "$1 $2", ["80"], "0$1", , 1], [, "(69\\d)(\\d{4,5})", "$1 $2", ["69"], "0$1", , 1], [, "([235-7]\\d{2})(\\d{4})(\\d{3})", 
"$1 $2 $3", ["2[1348]|3[25]|5[01]|65|7[18]"], "0$1", , 1], [, "([89]\\d)(\\d{3})(\\d{2})(\\d{2})", "$1 $2 $3 $4", ["8[689]8|9"], "0$1", , 1], [, "(1[2689]\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["1(?:[26]|8[68]|99)"], "0$1", , 1], [, "(1[89]00)(\\d{4,6})", "$1 $2", ["1[89]0"], "$1", , 1]], , [, , "NA", "NA"], , , [, , "[17]99\\d{4}|69\\d{5,6}", "\\d{7,8}", , , "1992000"], [, , "[17]99\\d{4}|69\\d{5,6}|80\\d{5}", "\\d{7,8}", , , "1992000"], , , [, , "NA", "NA"]], VU:[, [, , "[2-57-9]\\d{4,6}", "\\d{5,7}"], 
[, , "(?:2[02-9]\\d|3(?:[5-7]\\d|8[0-8])|48[4-9]|88\\d)\\d{2}", "\\d{5}", , , "22123"], [, , "(?:5(?:7[2-5]|[0-689]\\d)|7[013-7]\\d)\\d{4}", "\\d{7}", , , "5912345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "VU", 678, "00", , , , , , , , [[, "(\\d{3})(\\d{4})", "$1 $2", ["[579]"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "3[03]\\d{3}|900\\d{4}", "\\d{5,7}", , , "30123"], , , [, , "NA", "NA"]], WF:[, [, , "[4-8]\\d{5}", "\\d{6}"], [, , "(?:50|68|72)\\d{4}", 
"\\d{6}", , , "501234"], [, , "(?:50|68|72|8[23])\\d{4}", "\\d{6}", , , "501234"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "WF", 681, "00", , , , , , , , [[, "(\\d{2})(\\d{2})(\\d{2})", "$1 $2 $3"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "[48]0\\d{4}", "\\d{6}", , , "401234"]], WS:[, [, , "[2-8]\\d{4,6}", "\\d{5,7}"], [, , "(?:[2-5]\\d|6[1-9]|84\\d{2})\\d{3}", "\\d{5,7}", , , "22123"], [, , "(?:60|7[25-7]\\d)\\d{4}", 
"\\d{6,7}", , , "601234"], [, , "800\\d{3}", "\\d{6}", , , "800123"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "WS", 685, "0", , , , , , , , [[, "(8\\d{2})(\\d{3,4})", "$1 $2", ["8"]], [, "(7\\d)(\\d{5})", "$1 $2", ["7"]], [, "(\\d{5})", "$1", ["[2-6]"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], YE:[, [, , "[1-7]\\d{6,8}", "\\d{6,9}"], [, , "(?:1(?:7\\d|[2-68])|2[2-68]|3[2358]|4[2-58]|5[2-6]|6[3-58]|7[24-68])\\d{5}", "\\d{6,8}", 
, , "1234567"], [, , "7[0137]\\d{7}", "\\d{9}", , , "712345678"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "YE", 967, "00", "0", , , "0", , , , [[, "([1-7])(\\d{3})(\\d{3,4})", "$1 $2 $3", ["[1-6]|7[24-68]"], "0$1"], [, "(7\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["7[0137]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], YT:[, [, , "[268]\\d{8}", "\\d{9}"], [, , "269(?:6[0-4]|50)\\d{4}", "\\d{9}", , , "269601234"], 
[, , "639\\d{6}", "\\d{9}", , , "639123456"], [, , "80\\d{7}", "\\d{9}", , , "801234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "YT", 262, "00", "0", , , "0", , , , , , [, , "NA", "NA"], , "269|63", [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], ZA:[, [, , "[1-79]\\d{8}|8(?:[067]\\d{7}|[1-4]\\d{3,7})", "\\d{5,9}"], [, , "(?:1[0-8]|2[0-378]|3[1-69]|4\\d|5[1346-8])\\d{7}", "\\d{9}", , , "101234567"], [, , "(?:6[0-5]|7[0-46-9])\\d{7}|8[1-4]\\d{3,7}", "\\d{5,9}", 
, , "711234567"], [, , "80\\d{7}", "\\d{9}", , , "801234567"], [, , "86[2-9]\\d{6}|90\\d{7}", "\\d{9}", , , "862345678"], [, , "860\\d{6}", "\\d{9}", , , "860123456"], [, , "NA", "NA"], [, , "87\\d{7}", "\\d{9}", , , "871234567"], "ZA", 27, "00", "0", , , "0", , , , [[, "(860)(\\d{3})(\\d{3})", "$1 $2 $3", ["860"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{4})", "$1 $2 $3", ["[1-79]|8(?:[0-47]|6[1-9])"], "0$1"], [, "(\\d{2})(\\d{3,4})", "$1 $2", ["8[1-4]"], "0$1"], [, "(\\d{2})(\\d{3})(\\d{2,3})", "$1 $2 $3", 
["8[1-4]"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "861\\d{6}", "\\d{9}", , , "861123456"], , , [, , "NA", "NA"]], ZM:[, [, , "[289]\\d{8}", "\\d{9}"], [, , "21[1-8]\\d{6}", "\\d{9}", , , "211234567"], [, , "9(?:5[05]|6\\d|7[1-9])\\d{6}", "\\d{9}", , , "955123456"], [, , "800\\d{6}", "\\d{9}", , , "800123456"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "ZM", 260, "00", "0", , , "0", , , , [[, "([29]\\d)(\\d{7})", "$1 $2", ["[29]"], "0$1"], [, "(800)(\\d{3})(\\d{3})", 
"$1 $2 $3", ["8"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], ZW:[, [, , "2(?:[012457-9]\\d{3,8}|6(?:[14]\\d{7}|\\d{4}))|[13-79]\\d{4,9}|8[06]\\d{8}", "\\d{3,10}"], [, , "(?:2(?:0(?:4\\d|5\\d{2})|2[278]\\d|48\\d|7(?:[1-7]\\d|[089]\\d{2})|8(?:[2-57-9]|[146]\\d{2})|98)|3(?:08|17|3[78]|7(?:[19]|[56]\\d)|8[37]|98)|5[15][78]|6(?:28\\d{2}|[36]7|75\\d|[69]8|8(?:7\\d|8)))\\d{3}|(?:2(?:1[39]|2[0157]|6[14]|7[35]|84)|329)\\d{7}|(?:1(?:3\\d{2}|9\\d|[4-8])|2(?:0\\d{2}|[569]\\d)|3(?:[26]|[013459]\\d)|5(?:0|5\\d{2}|[689]\\d)|6(?:[39]|[01246]\\d|[78]\\d{2}))\\d{3}|(?:29\\d|39|54)\\d{6}|(?:(?:25|54)83|2582\\d)\\d{3}|(?:4\\d{6,7}|9[2-9]\\d{4,5})", 
"\\d{3,10}", , , "1312345"], [, , "7[1378]\\d{7}", "\\d{9}", , , "711234567"], [, , "800\\d{7}", "\\d{10}", , , "8001234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "86(?:1[12]|30|44|55|77|8[367]|99)\\d{6}", "\\d{10}", , , "8686123456"], "ZW", 263, "00", "0", , , "0", , , , [[, "([49])(\\d{3})(\\d{2,4})", "$1 $2 $3", ["4|9[2-9]"], "0$1"], [, "(7\\d)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["7"], "0$1"], [, "(86\\d{2})(\\d{3})(\\d{3})", "$1 $2 $3", ["86[24]"], "0$1"], [, "([2356]\\d{2})(\\d{3,5})", 
"$1 $2", ["2(?:0[45]|2[278]|[49]8|[78])|3(?:08|17|3[78]|7[1569]|8[37]|98)|5[15][78]|6(?:[29]8|[38]7|6[78]|75|[89]8)"], "0$1"], [, "(\\d{3})(\\d{3})(\\d{3,4})", "$1 $2 $3", ["2(?:1[39]|2[0157]|6[14]|7[35]|84)|329"], "0$1"], [, "([1-356]\\d)(\\d{3,5})", "$1 $2", ["1[3-9]|2[0569]|3[0-69]|5[05689]|6[0-46-9]"], "0$1"], [, "([235]\\d)(\\d{3})(\\d{3,4})", "$1 $2 $3", ["[23]9|54"], "0$1"], [, "([25]\\d{3})(\\d{3,5})", "$1 $2", ["(?:25|54)8", "258[23]|5483"], "0$1"], [, "(8\\d{3})(\\d{6})", "$1 $2", ["86"], 
"0$1"], [, "(80\\d)(\\d{3})(\\d{4})", "$1 $2 $3", ["80"], "0$1"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], 800:[, [, , "\\d{8}", "\\d{8}", , , "12345678"], [, , "NA", "NA", , , "12345678"], [, , "NA", "NA", , , "12345678"], [, , "\\d{8}", "\\d{8}", , , "12345678"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "001", 800, , , , , , , , 1, [[, "(\\d{4})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], 
1, , [, , "NA", "NA"]], 808:[, [, , "\\d{8}", "\\d{8}", , , "12345678"], [, , "NA", "NA", , , "12345678"], [, , "NA", "NA", , , "12345678"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "\\d{8}", "\\d{8}", , , "12345678"], [, , "NA", "NA"], [, , "NA", "NA"], "001", 808, , , , , , , , 1, [[, "(\\d{4})(\\d{4})", "$1 $2"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]], 870:[, [, , "[35-7]\\d{8}", "\\d{9}", , , "301234567"], [, , "NA", "NA", , , "301234567"], [, , "(?:[356]\\d|7[6-8])\\d{7}", 
"\\d{9}", , , "301234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "001", 870, , , , , , , , , [[, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], 878:[, [, , "1\\d{11}", "\\d{12}", , , "101234567890"], [, , "NA", "NA", , , "101234567890"], [, , "NA", "NA", , , "101234567890"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "10\\d{10}", "\\d{12}", 
, , "101234567890"], "001", 878, , , , , , , , 1, [[, "(\\d{2})(\\d{5})(\\d{5})", "$1 $2 $3"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], 881:[, [, , "[67]\\d{8}", "\\d{9}", , , "612345678"], [, , "NA", "NA", , , "612345678"], [, , "[67]\\d{8}", "\\d{9}", , , "612345678"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "001", 881, , , , , , , , , [[, "(\\d)(\\d{3})(\\d{5})", "$1 $2 $3", ["[67]"]]], , [, , "NA", "NA"], 
, , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "NA", "NA"]], 882:[, [, , "[13]\\d{6,11}", "\\d{7,12}", , , "3451234567"], [, , "NA", "NA", , , "3451234567"], [, , "3(?:2\\d{3}|37\\d{2}|4(?:2|7\\d{3}))\\d{4}", "\\d{7,10}", , , "3451234567"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "1(?:3(?:0[0347]|[13][0139]|2[035]|4[013568]|6[0459]|7[06]|8[15678]|9[0689])\\d{4}|6\\d{5,10})|345\\d{7}", "\\d{7,12}", , , "3451234567"], "001", 882, , , , , , , , , [[, "(\\d{2})(\\d{4})(\\d{3})", 
"$1 $2 $3", ["3[23]"]], [, "(\\d{2})(\\d{5})", "$1 $2", ["16|342"]], [, "(\\d{2})(\\d{4})(\\d{4})", "$1 $2 $3", ["34[57]"]], [, "(\\d{3})(\\d{4})(\\d{4})", "$1 $2 $3", ["348"]], [, "(\\d{2})(\\d{2})(\\d{4})", "$1 $2 $3", ["1"]], [, "(\\d{2})(\\d{3,4})(\\d{4})", "$1 $2 $3", ["16"]], [, "(\\d{2})(\\d{4,5})(\\d{5})", "$1 $2 $3", ["16"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], , , [, , "348[57]\\d{7}", "\\d{11}", , , "3451234567"]], 883:[, [, , "51\\d{7}(?:\\d{3})?", "\\d{9}(?:\\d{3})?", 
, , "510012345"], [, , "NA", "NA", , , "510012345"], [, , "NA", "NA", , , "510012345"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "51(?:00\\d{5}(?:\\d{3})?|[13]0\\d{8})", "\\d{9}(?:\\d{3})?", , , "510012345"], "001", 883, , , , , , , , 1, [[, "(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3", ["510"]], [, "(\\d{3})(\\d{3})(\\d{3})(\\d{3})", "$1 $2 $3 $4", ["510"]], [, "(\\d{4})(\\d{4})(\\d{4})", "$1 $2 $3", ["51[13]"]]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", 
"NA"], , , [, , "NA", "NA"]], 888:[, [, , "\\d{11}", "\\d{11}", , , "12345678901"], [, , "NA", "NA", , , "12345678901"], [, , "NA", "NA", , , "12345678901"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "001", 888, , , , , , , , 1, [[, "(\\d{3})(\\d{3})(\\d{5})", "$1 $2 $3"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "\\d{11}", "\\d{11}", , , "12345678901"], 1, , [, , "NA", "NA"]], 979:[, [, , "\\d{9}", "\\d{9}", , , "123456789"], [, , "NA", "NA", 
, , "123456789"], [, , "NA", "NA", , , "123456789"], [, , "NA", "NA"], [, , "\\d{9}", "\\d{9}", , , "123456789"], [, , "NA", "NA"], [, , "NA", "NA"], [, , "NA", "NA"], "001", 979, , , , , , , , 1, [[, "(\\d)(\\d{4})(\\d{4})", "$1 $2 $3"]], , [, , "NA", "NA"], , , [, , "NA", "NA"], [, , "NA", "NA"], 1, , [, , "NA", "NA"]]};
/*

 Copyright (C) 2010 The Libphonenumber Authors.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
i18n.phonenumbers.PhoneNumberUtil = function() {
  this.regionToMetadataMap = {};
};
goog.addSingletonGetter(i18n.phonenumbers.PhoneNumberUtil);
i18n.phonenumbers.Error = {INVALID_COUNTRY_CODE:"Invalid country calling code", NOT_A_NUMBER:"The string supplied did not seem to be a phone number", TOO_SHORT_AFTER_IDD:"Phone number too short after IDD", TOO_SHORT_NSN:"The string supplied is too short to be a phone number", TOO_LONG:"The string supplied is too long to be a phone number"};
i18n.phonenumbers.PhoneNumberUtil.NANPA_COUNTRY_CODE_ = 1;
i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_FOR_NSN_ = 2;
i18n.phonenumbers.PhoneNumberUtil.MAX_LENGTH_FOR_NSN_ = 17;
i18n.phonenumbers.PhoneNumberUtil.MAX_LENGTH_COUNTRY_CODE_ = 3;
i18n.phonenumbers.PhoneNumberUtil.MAX_INPUT_STRING_LENGTH_ = 250;
i18n.phonenumbers.PhoneNumberUtil.UNKNOWN_REGION_ = "ZZ";
i18n.phonenumbers.PhoneNumberUtil.COLOMBIA_MOBILE_TO_FIXED_LINE_PREFIX_ = "3";
i18n.phonenumbers.PhoneNumberUtil.MOBILE_TOKEN_MAPPINGS_ = {52:"1", 54:"9"};
i18n.phonenumbers.PhoneNumberUtil.GEO_MOBILE_COUNTRIES_ = [52, 54, 55];
i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN = "+";
i18n.phonenumbers.PhoneNumberUtil.STAR_SIGN_ = "*";
i18n.phonenumbers.PhoneNumberUtil.RFC3966_EXTN_PREFIX_ = ";ext=";
i18n.phonenumbers.PhoneNumberUtil.RFC3966_PREFIX_ = "tel:";
i18n.phonenumbers.PhoneNumberUtil.RFC3966_PHONE_CONTEXT_ = ";phone-context=";
i18n.phonenumbers.PhoneNumberUtil.RFC3966_ISDN_SUBADDRESS_ = ";isub=";
i18n.phonenumbers.PhoneNumberUtil.DIGIT_MAPPINGS = {0:"0", 1:"1", 2:"2", 3:"3", 4:"4", 5:"5", 6:"6", 7:"7", 8:"8", 9:"9", "\uff10":"0", "\uff11":"1", "\uff12":"2", "\uff13":"3", "\uff14":"4", "\uff15":"5", "\uff16":"6", "\uff17":"7", "\uff18":"8", "\uff19":"9", "\u0660":"0", "\u0661":"1", "\u0662":"2", "\u0663":"3", "\u0664":"4", "\u0665":"5", "\u0666":"6", "\u0667":"7", "\u0668":"8", "\u0669":"9", "\u06f0":"0", "\u06f1":"1", "\u06f2":"2", "\u06f3":"3", "\u06f4":"4", "\u06f5":"5", "\u06f6":"6", "\u06f7":"7", 
"\u06f8":"8", "\u06f9":"9"};
i18n.phonenumbers.PhoneNumberUtil.DIALLABLE_CHAR_MAPPINGS_ = {0:"0", 1:"1", 2:"2", 3:"3", 4:"4", 5:"5", 6:"6", 7:"7", 8:"8", 9:"9", "+":i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN, "*":"*"};
i18n.phonenumbers.PhoneNumberUtil.ALPHA_MAPPINGS_ = {A:"2", B:"2", C:"2", D:"3", E:"3", F:"3", G:"4", H:"4", I:"4", J:"5", K:"5", L:"5", M:"6", N:"6", O:"6", P:"7", Q:"7", R:"7", S:"7", T:"8", U:"8", V:"8", W:"9", X:"9", Y:"9", Z:"9"};
i18n.phonenumbers.PhoneNumberUtil.ALL_NORMALIZATION_MAPPINGS_ = {0:"0", 1:"1", 2:"2", 3:"3", 4:"4", 5:"5", 6:"6", 7:"7", 8:"8", 9:"9", "\uff10":"0", "\uff11":"1", "\uff12":"2", "\uff13":"3", "\uff14":"4", "\uff15":"5", "\uff16":"6", "\uff17":"7", "\uff18":"8", "\uff19":"9", "\u0660":"0", "\u0661":"1", "\u0662":"2", "\u0663":"3", "\u0664":"4", "\u0665":"5", "\u0666":"6", "\u0667":"7", "\u0668":"8", "\u0669":"9", "\u06f0":"0", "\u06f1":"1", "\u06f2":"2", "\u06f3":"3", "\u06f4":"4", "\u06f5":"5", "\u06f6":"6", 
"\u06f7":"7", "\u06f8":"8", "\u06f9":"9", A:"2", B:"2", C:"2", D:"3", E:"3", F:"3", G:"4", H:"4", I:"4", J:"5", K:"5", L:"5", M:"6", N:"6", O:"6", P:"7", Q:"7", R:"7", S:"7", T:"8", U:"8", V:"8", W:"9", X:"9", Y:"9", Z:"9"};
i18n.phonenumbers.PhoneNumberUtil.ALL_PLUS_NUMBER_GROUPING_SYMBOLS_ = {0:"0", 1:"1", 2:"2", 3:"3", 4:"4", 5:"5", 6:"6", 7:"7", 8:"8", 9:"9", A:"A", B:"B", C:"C", D:"D", E:"E", F:"F", G:"G", H:"H", I:"I", J:"J", K:"K", L:"L", M:"M", N:"N", O:"O", P:"P", Q:"Q", R:"R", S:"S", T:"T", U:"U", V:"V", W:"W", X:"X", Y:"Y", Z:"Z", a:"A", b:"B", c:"C", d:"D", e:"E", f:"F", g:"G", h:"H", i:"I", j:"J", k:"K", l:"L", m:"M", n:"N", o:"O", p:"P", q:"Q", r:"R", s:"S", t:"T", u:"U", v:"V", w:"W", x:"X", y:"Y", z:"Z", 
"-":"-", "\uff0d":"-", "\u2010":"-", "\u2011":"-", "\u2012":"-", "\u2013":"-", "\u2014":"-", "\u2015":"-", "\u2212":"-", "/":"/", "\uff0f":"/", " ":" ", "\u3000":" ", "\u2060":" ", ".":".", "\uff0e":"."};
i18n.phonenumbers.PhoneNumberUtil.UNIQUE_INTERNATIONAL_PREFIX_ = /[\d]+(?:[~\u2053\u223C\uFF5E][\d]+)?/;
i18n.phonenumbers.PhoneNumberUtil.VALID_PUNCTUATION = "-x\u2010-\u2015\u2212\u30fc\uff0d-\uff0f \u00a0\u00ad\u200b\u2060\u3000()\uff08\uff09\uff3b\uff3d.\\[\\]/~\u2053\u223c\uff5e";
i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_ = "0-9\uff10-\uff19\u0660-\u0669\u06f0-\u06f9";
i18n.phonenumbers.PhoneNumberUtil.VALID_ALPHA_ = "A-Za-z";
i18n.phonenumbers.PhoneNumberUtil.PLUS_CHARS_ = "+\uff0b";
i18n.phonenumbers.PhoneNumberUtil.PLUS_CHARS_PATTERN = new RegExp("[" + i18n.phonenumbers.PhoneNumberUtil.PLUS_CHARS_ + "]+");
i18n.phonenumbers.PhoneNumberUtil.LEADING_PLUS_CHARS_PATTERN_ = new RegExp("^[" + i18n.phonenumbers.PhoneNumberUtil.PLUS_CHARS_ + "]+");
i18n.phonenumbers.PhoneNumberUtil.SEPARATOR_PATTERN_ = "[" + i18n.phonenumbers.PhoneNumberUtil.VALID_PUNCTUATION + "]+";
i18n.phonenumbers.PhoneNumberUtil.CAPTURING_DIGIT_PATTERN = new RegExp("([" + i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_ + "])");
i18n.phonenumbers.PhoneNumberUtil.VALID_START_CHAR_PATTERN_ = new RegExp("[" + i18n.phonenumbers.PhoneNumberUtil.PLUS_CHARS_ + i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_ + "]");
i18n.phonenumbers.PhoneNumberUtil.SECOND_NUMBER_START_PATTERN_ = /[\\\/] *x/;
i18n.phonenumbers.PhoneNumberUtil.UNWANTED_END_CHAR_PATTERN_ = new RegExp("[^" + i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_ + i18n.phonenumbers.PhoneNumberUtil.VALID_ALPHA_ + "#]+$");
i18n.phonenumbers.PhoneNumberUtil.VALID_ALPHA_PHONE_PATTERN_ = /(?:.*?[A-Za-z]){3}.*/;
i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_PHONE_NUMBER_PATTERN_ = "[" + i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_ + "]{" + i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_FOR_NSN_ + "}";
i18n.phonenumbers.PhoneNumberUtil.VALID_PHONE_NUMBER_ = "[" + i18n.phonenumbers.PhoneNumberUtil.PLUS_CHARS_ + "]*(?:[" + i18n.phonenumbers.PhoneNumberUtil.VALID_PUNCTUATION + i18n.phonenumbers.PhoneNumberUtil.STAR_SIGN_ + "]*[" + i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_ + "]){3,}[" + i18n.phonenumbers.PhoneNumberUtil.VALID_PUNCTUATION + i18n.phonenumbers.PhoneNumberUtil.STAR_SIGN_ + i18n.phonenumbers.PhoneNumberUtil.VALID_ALPHA_ + i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_ + "]*";
i18n.phonenumbers.PhoneNumberUtil.DEFAULT_EXTN_PREFIX_ = " ext. ";
i18n.phonenumbers.PhoneNumberUtil.CAPTURING_EXTN_DIGITS_ = "([" + i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_ + "]{1,7})";
i18n.phonenumbers.PhoneNumberUtil.EXTN_PATTERNS_FOR_PARSING_ = i18n.phonenumbers.PhoneNumberUtil.RFC3966_EXTN_PREFIX_ + i18n.phonenumbers.PhoneNumberUtil.CAPTURING_EXTN_DIGITS_ + "|[ \u00a0\\t,]*(?:e?xt(?:ensi(?:o\u0301?|\u00f3))?n?|\uff45?\uff58\uff54\uff4e?|[,x\uff58#\uff03~\uff5e]|int|anexo|\uff49\uff4e\uff54)[:\\.\uff0e]?[ \u00a0\\t,-]*" + i18n.phonenumbers.PhoneNumberUtil.CAPTURING_EXTN_DIGITS_ + "#?|[- ]+([" + i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_ + "]{1,5})#";
i18n.phonenumbers.PhoneNumberUtil.EXTN_PATTERN_ = new RegExp("(?:" + i18n.phonenumbers.PhoneNumberUtil.EXTN_PATTERNS_FOR_PARSING_ + ")$", "i");
i18n.phonenumbers.PhoneNumberUtil.VALID_PHONE_NUMBER_PATTERN_ = new RegExp("^" + i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_PHONE_NUMBER_PATTERN_ + "$|^" + i18n.phonenumbers.PhoneNumberUtil.VALID_PHONE_NUMBER_ + "(?:" + i18n.phonenumbers.PhoneNumberUtil.EXTN_PATTERNS_FOR_PARSING_ + ")?$", "i");
i18n.phonenumbers.PhoneNumberUtil.NON_DIGITS_PATTERN_ = /\D+/;
i18n.phonenumbers.PhoneNumberUtil.FIRST_GROUP_PATTERN_ = /(\$\d)/;
i18n.phonenumbers.PhoneNumberUtil.NP_PATTERN_ = /\$NP/;
i18n.phonenumbers.PhoneNumberUtil.FG_PATTERN_ = /\$FG/;
i18n.phonenumbers.PhoneNumberUtil.CC_PATTERN_ = /\$CC/;
i18n.phonenumbers.PhoneNumberUtil.FIRST_GROUP_ONLY_PREFIX_PATTERN_ = /^\(?\$1\)?$/;
i18n.phonenumbers.PhoneNumberUtil.REGION_CODE_FOR_NON_GEO_ENTITY = "001";
i18n.phonenumbers.PhoneNumberFormat = {E164:0, INTERNATIONAL:1, NATIONAL:2, RFC3966:3};
i18n.phonenumbers.PhoneNumberType = {FIXED_LINE:0, MOBILE:1, FIXED_LINE_OR_MOBILE:2, TOLL_FREE:3, PREMIUM_RATE:4, SHARED_COST:5, VOIP:6, PERSONAL_NUMBER:7, PAGER:8, UAN:9, VOICEMAIL:10, UNKNOWN:-1};
i18n.phonenumbers.PhoneNumberUtil.MatchType = {NOT_A_NUMBER:0, NO_MATCH:1, SHORT_NSN_MATCH:2, NSN_MATCH:3, EXACT_MATCH:4};
i18n.phonenumbers.PhoneNumberUtil.ValidationResult = {IS_POSSIBLE:0, INVALID_COUNTRY_CODE:1, TOO_SHORT:2, TOO_LONG:3};
i18n.phonenumbers.PhoneNumberUtil.extractPossibleNumber = function(a) {
  var b = a.search(i18n.phonenumbers.PhoneNumberUtil.VALID_START_CHAR_PATTERN_);
  0 <= b ? (a = a.substring(b), a = a.replace(i18n.phonenumbers.PhoneNumberUtil.UNWANTED_END_CHAR_PATTERN_, ""), b = a.search(i18n.phonenumbers.PhoneNumberUtil.SECOND_NUMBER_START_PATTERN_), 0 <= b && (a = a.substring(0, b))) : a = "";
  return a;
};
i18n.phonenumbers.PhoneNumberUtil.isViablePhoneNumber = function(a) {
  return a.length < i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_FOR_NSN_ ? !1 : i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(i18n.phonenumbers.PhoneNumberUtil.VALID_PHONE_NUMBER_PATTERN_, a);
};
i18n.phonenumbers.PhoneNumberUtil.normalize = function(a) {
  return i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(i18n.phonenumbers.PhoneNumberUtil.VALID_ALPHA_PHONE_PATTERN_, a) ? i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_(a, i18n.phonenumbers.PhoneNumberUtil.ALL_NORMALIZATION_MAPPINGS_, !0) : i18n.phonenumbers.PhoneNumberUtil.normalizeDigitsOnly(a);
};
i18n.phonenumbers.PhoneNumberUtil.normalizeSB_ = function(a) {
  var b = i18n.phonenumbers.PhoneNumberUtil.normalize(a.toString());
  a.clear();
  a.append(b);
};
i18n.phonenumbers.PhoneNumberUtil.normalizeDigitsOnly = function(a) {
  return i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_(a, i18n.phonenumbers.PhoneNumberUtil.DIGIT_MAPPINGS, !0);
};
i18n.phonenumbers.PhoneNumberUtil.convertAlphaCharactersInNumber = function(a) {
  return i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_(a, i18n.phonenumbers.PhoneNumberUtil.ALL_NORMALIZATION_MAPPINGS_, !1);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getLengthOfGeographicalAreaCode = function(a) {
  var b = this.getMetadataForRegion(this.getRegionCodeForNumber(a));
  return null != b && (b.hasNationalPrefix() || a.hasItalianLeadingZero()) && this.isNumberGeographical(a) ? this.getLengthOfNationalDestinationCode(a) : 0;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getLengthOfNationalDestinationCode = function(a) {
  var b;
  a.hasExtension() ? (b = a.clone(), b.clearExtension()) : b = a;
  b = this.format(b, i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL).split(i18n.phonenumbers.PhoneNumberUtil.NON_DIGITS_PATTERN_);
  0 == b[0].length && b.shift();
  return 2 >= b.length ? 0 : this.getNumberType(a) == i18n.phonenumbers.PhoneNumberType.MOBILE && (a = i18n.phonenumbers.PhoneNumberUtil.getCountryMobileToken(a.getCountryCodeOrDefault()), "" != a) ? b[2].length + a.length : b[1].length;
};
i18n.phonenumbers.PhoneNumberUtil.getCountryMobileToken = function(a) {
  return i18n.phonenumbers.PhoneNumberUtil.MOBILE_TOKEN_MAPPINGS_[a] || "";
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getSupportedRegions = function() {
  return goog.array.filter(Object.keys(i18n.phonenumbers.metadata.countryToMetadata), function(a) {
    return isNaN(a);
  });
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getSupportedGlobalNetworkCallingCodes = function() {
  var a = goog.array.filter(Object.keys(i18n.phonenumbers.metadata.countryToMetadata), function(a) {
    return !isNaN(a);
  });
  return goog.array.map(a, function(a) {
    return parseInt(a, 10);
  });
};
i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_ = function(a, b, c) {
  for (var d = new goog.string.StringBuffer, e, f, g = a.length, h = 0;h < g;++h) {
    e = a.charAt(h), f = b[e.toUpperCase()], null != f ? d.append(f) : c || d.append(e);
  }
  return d.toString();
};
i18n.phonenumbers.PhoneNumberUtil.prototype.formattingRuleHasFirstGroupOnly = function(a) {
  return 0 == a.length || i18n.phonenumbers.PhoneNumberUtil.FIRST_GROUP_ONLY_PREFIX_PATTERN_.test(a);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.isNumberGeographical = function(a) {
  var b = this.getNumberType(a);
  return b == i18n.phonenumbers.PhoneNumberType.FIXED_LINE || b == i18n.phonenumbers.PhoneNumberType.FIXED_LINE_OR_MOBILE || goog.array.contains(i18n.phonenumbers.PhoneNumberUtil.GEO_MOBILE_COUNTRIES_, a.getCountryCodeOrDefault()) && b == i18n.phonenumbers.PhoneNumberType.MOBILE;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.isValidRegionCode_ = function(a) {
  return null != a && isNaN(a) && a.toUpperCase() in i18n.phonenumbers.metadata.countryToMetadata;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.hasValidCountryCallingCode_ = function(a) {
  return a in i18n.phonenumbers.metadata.countryCodeToRegionCodeMap;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.format = function(a, b) {
  if (0 == a.getNationalNumber() && a.hasRawInput()) {
    var c = a.getRawInputOrDefault();
    if (0 < c.length) {
      return c;
    }
  }
  var c = a.getCountryCodeOrDefault(), d = this.getNationalSignificantNumber(a);
  if (b == i18n.phonenumbers.PhoneNumberFormat.E164) {
    return this.prefixNumberWithCountryCallingCode_(c, i18n.phonenumbers.PhoneNumberFormat.E164, d, "");
  }
  if (!this.hasValidCountryCallingCode_(c)) {
    return d;
  }
  var e = this.getRegionCodeForCountryCode(c), f = this.getMetadataForRegionOrCallingCode_(c, e), e = this.maybeGetFormattedExtension_(a, f, b), d = this.formatNsn_(d, f, b);
  return this.prefixNumberWithCountryCallingCode_(c, b, d, e);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.formatByPattern = function(a, b, c) {
  var d = a.getCountryCodeOrDefault(), e = this.getNationalSignificantNumber(a);
  if (!this.hasValidCountryCallingCode_(d)) {
    return e;
  }
  var f = this.getRegionCodeForCountryCode(d), f = this.getMetadataForRegionOrCallingCode_(d, f), g = this.chooseFormattingPatternForNumber_(c, e);
  if (null != g) {
    c = g.clone();
    g = g.getNationalPrefixFormattingRuleOrDefault();
    if (0 < g.length) {
      var h = f.getNationalPrefixOrDefault();
      0 < h.length ? (g = g.replace(i18n.phonenumbers.PhoneNumberUtil.NP_PATTERN_, h).replace(i18n.phonenumbers.PhoneNumberUtil.FG_PATTERN_, "$1"), c.setNationalPrefixFormattingRule(g)) : c.clearNationalPrefixFormattingRule();
    }
    e = this.formatNsnUsingPattern_(e, c, b);
  }
  a = this.maybeGetFormattedExtension_(a, f, b);
  return this.prefixNumberWithCountryCallingCode_(d, b, e, a);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.formatNationalNumberWithCarrierCode = function(a, b) {
  var c = a.getCountryCodeOrDefault(), d = this.getNationalSignificantNumber(a);
  if (!this.hasValidCountryCallingCode_(c)) {
    return d;
  }
  var e = this.getRegionCodeForCountryCode(c), f = this.getMetadataForRegionOrCallingCode_(c, e), e = this.maybeGetFormattedExtension_(a, f, i18n.phonenumbers.PhoneNumberFormat.NATIONAL), d = this.formatNsn_(d, f, i18n.phonenumbers.PhoneNumberFormat.NATIONAL, b);
  return this.prefixNumberWithCountryCallingCode_(c, i18n.phonenumbers.PhoneNumberFormat.NATIONAL, d, e);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getMetadataForRegionOrCallingCode_ = function(a, b) {
  return i18n.phonenumbers.PhoneNumberUtil.REGION_CODE_FOR_NON_GEO_ENTITY == b ? this.getMetadataForNonGeographicalRegion(a) : this.getMetadataForRegion(b);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.formatNationalNumberWithPreferredCarrierCode = function(a, b) {
  return this.formatNationalNumberWithCarrierCode(a, a.hasPreferredDomesticCarrierCode() ? a.getPreferredDomesticCarrierCodeOrDefault() : b);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.formatNumberForMobileDialing = function(a, b, c) {
  var d = a.getCountryCodeOrDefault();
  if (!this.hasValidCountryCallingCode_(d)) {
    return a.hasRawInput() ? a.getRawInputOrDefault() : "";
  }
  var e = "";
  a = a.clone();
  a.clearExtension();
  var f = this.getRegionCodeForCountryCode(d), g = this.getNumberType(a), h = g != i18n.phonenumbers.PhoneNumberType.UNKNOWN;
  if (b == f) {
    e = g == i18n.phonenumbers.PhoneNumberType.FIXED_LINE || g == i18n.phonenumbers.PhoneNumberType.MOBILE || g == i18n.phonenumbers.PhoneNumberType.FIXED_LINE_OR_MOBILE, "CO" == f && g == i18n.phonenumbers.PhoneNumberType.FIXED_LINE ? e = this.formatNationalNumberWithCarrierCode(a, i18n.phonenumbers.PhoneNumberUtil.COLOMBIA_MOBILE_TO_FIXED_LINE_PREFIX_) : "BR" == f && e ? e = a.hasPreferredDomesticCarrierCode() ? this.formatNationalNumberWithPreferredCarrierCode(a, "") : "" : h && "HU" == f ? e = 
    this.getNddPrefixForRegion(f, !0) + " " + this.format(a, i18n.phonenumbers.PhoneNumberFormat.NATIONAL) : d == i18n.phonenumbers.PhoneNumberUtil.NANPA_COUNTRY_CODE_ ? (b = this.getMetadataForRegion(b), e = this.canBeInternationallyDialled(a) && !this.isShorterThanPossibleNormalNumber_(b, this.getNationalSignificantNumber(a)) ? this.format(a, i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL) : this.format(a, i18n.phonenumbers.PhoneNumberFormat.NATIONAL)) : e = (f == i18n.phonenumbers.PhoneNumberUtil.REGION_CODE_FOR_NON_GEO_ENTITY || 
    ("MX" == f || "CL" == f) && e) && this.canBeInternationallyDialled(a) ? this.format(a, i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL) : this.format(a, i18n.phonenumbers.PhoneNumberFormat.NATIONAL);
  } else {
    if (h && this.canBeInternationallyDialled(a)) {
      return c ? this.format(a, i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL) : this.format(a, i18n.phonenumbers.PhoneNumberFormat.E164);
    }
  }
  return c ? e : i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_(e, i18n.phonenumbers.PhoneNumberUtil.DIALLABLE_CHAR_MAPPINGS_, !0);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.formatOutOfCountryCallingNumber = function(a, b) {
  if (!this.isValidRegionCode_(b)) {
    return this.format(a, i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL);
  }
  var c = a.getCountryCodeOrDefault(), d = this.getNationalSignificantNumber(a);
  if (!this.hasValidCountryCallingCode_(c)) {
    return d;
  }
  if (c == i18n.phonenumbers.PhoneNumberUtil.NANPA_COUNTRY_CODE_) {
    if (this.isNANPACountry(b)) {
      return c + " " + this.format(a, i18n.phonenumbers.PhoneNumberFormat.NATIONAL);
    }
  } else {
    if (c == this.getCountryCodeForValidRegion_(b)) {
      return this.format(a, i18n.phonenumbers.PhoneNumberFormat.NATIONAL);
    }
  }
  var e = this.getMetadataForRegion(b), f = e.getInternationalPrefixOrDefault(), g = "";
  i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(i18n.phonenumbers.PhoneNumberUtil.UNIQUE_INTERNATIONAL_PREFIX_, f) ? g = f : e.hasPreferredInternationalPrefix() && (g = e.getPreferredInternationalPrefixOrDefault());
  e = this.getRegionCodeForCountryCode(c);
  e = this.getMetadataForRegionOrCallingCode_(c, e);
  d = this.formatNsn_(d, e, i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL);
  e = this.maybeGetFormattedExtension_(a, e, i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL);
  return 0 < g.length ? g + " " + c + " " + d + e : this.prefixNumberWithCountryCallingCode_(c, i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL, d, e);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.formatInOriginalFormat = function(a, b) {
  if (a.hasRawInput() && (this.hasUnexpectedItalianLeadingZero_(a) || !this.hasFormattingPatternForNumber_(a))) {
    return a.getRawInputOrDefault();
  }
  if (!a.hasCountryCodeSource()) {
    return this.format(a, i18n.phonenumbers.PhoneNumberFormat.NATIONAL);
  }
  var c;
  switch(a.getCountryCodeSource()) {
    case i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_NUMBER_WITH_PLUS_SIGN:
      c = this.format(a, i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL);
      break;
    case i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_NUMBER_WITH_IDD:
      c = this.formatOutOfCountryCallingNumber(a, b);
      break;
    case i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_NUMBER_WITHOUT_PLUS_SIGN:
      c = this.format(a, i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL).substring(1);
      break;
    default:
      var d = this.getRegionCodeForCountryCode(a.getCountryCodeOrDefault()), e = this.getNddPrefixForRegion(d, !0);
      c = this.format(a, i18n.phonenumbers.PhoneNumberFormat.NATIONAL);
      if (null != e && 0 != e.length && !this.rawInputContainsNationalPrefix_(a.getRawInputOrDefault(), e, d) && (d = this.getMetadataForRegion(d), e = this.getNationalSignificantNumber(a), d = this.chooseFormattingPatternForNumber_(d.numberFormatArray(), e), null != d)) {
        var e = d.getNationalPrefixFormattingRuleOrDefault(), f = e.indexOf("$1");
        0 >= f || (e = e.substring(0, f), e = i18n.phonenumbers.PhoneNumberUtil.normalizeDigitsOnly(e), 0 != e.length && (c = d.clone(), c.clearNationalPrefixFormattingRule(), c = this.formatByPattern(a, i18n.phonenumbers.PhoneNumberFormat.NATIONAL, [c])));
      }
    ;
  }
  d = a.getRawInputOrDefault();
  null != c && 0 < d.length && (e = i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_(c, i18n.phonenumbers.PhoneNumberUtil.DIALLABLE_CHAR_MAPPINGS_, !0), f = i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_(d, i18n.phonenumbers.PhoneNumberUtil.DIALLABLE_CHAR_MAPPINGS_, !0), e != f && (c = d));
  return c;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.rawInputContainsNationalPrefix_ = function(a, b, c) {
  a = i18n.phonenumbers.PhoneNumberUtil.normalizeDigitsOnly(a);
  if (goog.string.startsWith(a, b)) {
    try {
      return this.isValidNumber(this.parse(a.substring(b.length), c));
    } catch (d) {
    }
  }
  return !1;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.hasUnexpectedItalianLeadingZero_ = function(a) {
  return a.hasItalianLeadingZero() && !this.isLeadingZeroPossible(a.getCountryCodeOrDefault());
};
i18n.phonenumbers.PhoneNumberUtil.prototype.hasFormattingPatternForNumber_ = function(a) {
  var b = a.getCountryCodeOrDefault(), c = this.getRegionCodeForCountryCode(b), b = this.getMetadataForRegionOrCallingCode_(b, c);
  if (null == b) {
    return !1;
  }
  a = this.getNationalSignificantNumber(a);
  return null != this.chooseFormattingPatternForNumber_(b.numberFormatArray(), a);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.formatOutOfCountryKeepingAlphaChars = function(a, b) {
  var c = a.getRawInputOrDefault();
  if (0 == c.length) {
    return this.formatOutOfCountryCallingNumber(a, b);
  }
  var d = a.getCountryCodeOrDefault();
  if (!this.hasValidCountryCallingCode_(d)) {
    return c;
  }
  var c = i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_(c, i18n.phonenumbers.PhoneNumberUtil.ALL_PLUS_NUMBER_GROUPING_SYMBOLS_, !0), e = this.getNationalSignificantNumber(a);
  if (3 < e.length) {
    var f = c.indexOf(e.substring(0, 3));
    -1 != f && (c = c.substring(f));
  }
  f = this.getMetadataForRegion(b);
  if (d == i18n.phonenumbers.PhoneNumberUtil.NANPA_COUNTRY_CODE_) {
    if (this.isNANPACountry(b)) {
      return d + " " + c;
    }
  } else {
    if (null != f && d == this.getCountryCodeForValidRegion_(b)) {
      d = this.chooseFormattingPatternForNumber_(f.numberFormatArray(), e);
      if (null == d) {
        return c;
      }
      d = d.clone();
      d.setPattern("(\\d+)(.*)");
      d.setFormat("$1$2");
      return this.formatNsnUsingPattern_(c, d, i18n.phonenumbers.PhoneNumberFormat.NATIONAL);
    }
  }
  e = "";
  null != f && (e = f.getInternationalPrefixOrDefault(), e = i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(i18n.phonenumbers.PhoneNumberUtil.UNIQUE_INTERNATIONAL_PREFIX_, e) ? e : f.getPreferredInternationalPrefixOrDefault());
  f = this.getRegionCodeForCountryCode(d);
  f = this.getMetadataForRegionOrCallingCode_(d, f);
  f = this.maybeGetFormattedExtension_(a, f, i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL);
  return 0 < e.length ? e + " " + d + " " + c + f : this.prefixNumberWithCountryCallingCode_(d, i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL, c, f);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getNationalSignificantNumber = function(a) {
  var b = "" + a.getNationalNumber();
  return a.hasItalianLeadingZero() && a.getItalianLeadingZero() ? Array(a.getNumberOfLeadingZerosOrDefault() + 1).join("0") + b : b;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.prefixNumberWithCountryCallingCode_ = function(a, b, c, d) {
  switch(b) {
    case i18n.phonenumbers.PhoneNumberFormat.E164:
      return i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN + a + c + d;
    case i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL:
      return i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN + a + " " + c + d;
    case i18n.phonenumbers.PhoneNumberFormat.RFC3966:
      return i18n.phonenumbers.PhoneNumberUtil.RFC3966_PREFIX_ + i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN + a + "-" + c + d;
    default:
      return c + d;
  }
};
i18n.phonenumbers.PhoneNumberUtil.prototype.formatNsn_ = function(a, b, c, d) {
  b = 0 == b.intlNumberFormatArray().length || c == i18n.phonenumbers.PhoneNumberFormat.NATIONAL ? b.numberFormatArray() : b.intlNumberFormatArray();
  b = this.chooseFormattingPatternForNumber_(b, a);
  return null == b ? a : this.formatNsnUsingPattern_(a, b, c, d);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.chooseFormattingPatternForNumber_ = function(a, b) {
  for (var c, d = a.length, e = 0;e < d;++e) {
    c = a[e];
    var f = c.leadingDigitsPatternCount();
    if (0 == f || 0 == b.search(c.getLeadingDigitsPattern(f - 1))) {
      if (f = new RegExp(c.getPattern()), i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(f, b)) {
        return c;
      }
    }
  }
  return null;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.formatNsnUsingPattern_ = function(a, b, c, d) {
  var e = b.getFormatOrDefault(), f = new RegExp(b.getPattern()), g = b.getDomesticCarrierCodeFormattingRuleOrDefault();
  c == i18n.phonenumbers.PhoneNumberFormat.NATIONAL && null != d && 0 < d.length && 0 < g.length ? (b = g.replace(i18n.phonenumbers.PhoneNumberUtil.CC_PATTERN_, d), e = e.replace(i18n.phonenumbers.PhoneNumberUtil.FIRST_GROUP_PATTERN_, b), a = a.replace(f, e)) : (b = b.getNationalPrefixFormattingRuleOrDefault(), a = c == i18n.phonenumbers.PhoneNumberFormat.NATIONAL && null != b && 0 < b.length ? a.replace(f, e.replace(i18n.phonenumbers.PhoneNumberUtil.FIRST_GROUP_PATTERN_, b)) : a.replace(f, e));
  c == i18n.phonenumbers.PhoneNumberFormat.RFC3966 && (a = a.replace(new RegExp("^" + i18n.phonenumbers.PhoneNumberUtil.SEPARATOR_PATTERN_), ""), a = a.replace(new RegExp(i18n.phonenumbers.PhoneNumberUtil.SEPARATOR_PATTERN_, "g"), "-"));
  return a;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getExampleNumber = function(a) {
  return this.getExampleNumberForType(a, i18n.phonenumbers.PhoneNumberType.FIXED_LINE);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getExampleNumberForType = function(a, b) {
  if (!this.isValidRegionCode_(a)) {
    return null;
  }
  var c = this.getNumberDescByType_(this.getMetadataForRegion(a), b);
  try {
    if (c.hasExampleNumber()) {
      return this.parse(c.getExampleNumberOrDefault(), a);
    }
  } catch (d) {
  }
  return null;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getExampleNumberForNonGeoEntity = function(a) {
  var b = this.getMetadataForNonGeographicalRegion(a);
  if (null != b) {
    b = b.getGeneralDesc();
    try {
      if (b.hasExampleNumber()) {
        return this.parse("+" + a + b.getExampleNumber(), "ZZ");
      }
    } catch (c) {
    }
  }
  return null;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.maybeGetFormattedExtension_ = function(a, b, c) {
  return a.hasExtension() && 0 != a.getExtension().length ? c == i18n.phonenumbers.PhoneNumberFormat.RFC3966 ? i18n.phonenumbers.PhoneNumberUtil.RFC3966_EXTN_PREFIX_ + a.getExtension() : b.hasPreferredExtnPrefix() ? b.getPreferredExtnPrefix() + a.getExtensionOrDefault() : i18n.phonenumbers.PhoneNumberUtil.DEFAULT_EXTN_PREFIX_ + a.getExtensionOrDefault() : "";
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getNumberDescByType_ = function(a, b) {
  switch(b) {
    case i18n.phonenumbers.PhoneNumberType.PREMIUM_RATE:
      return a.getPremiumRate();
    case i18n.phonenumbers.PhoneNumberType.TOLL_FREE:
      return a.getTollFree();
    case i18n.phonenumbers.PhoneNumberType.MOBILE:
      return a.getMobile();
    case i18n.phonenumbers.PhoneNumberType.FIXED_LINE:
    ;
    case i18n.phonenumbers.PhoneNumberType.FIXED_LINE_OR_MOBILE:
      return a.getFixedLine();
    case i18n.phonenumbers.PhoneNumberType.SHARED_COST:
      return a.getSharedCost();
    case i18n.phonenumbers.PhoneNumberType.VOIP:
      return a.getVoip();
    case i18n.phonenumbers.PhoneNumberType.PERSONAL_NUMBER:
      return a.getPersonalNumber();
    case i18n.phonenumbers.PhoneNumberType.PAGER:
      return a.getPager();
    case i18n.phonenumbers.PhoneNumberType.UAN:
      return a.getUan();
    case i18n.phonenumbers.PhoneNumberType.VOICEMAIL:
      return a.getVoicemail();
    default:
      return a.getGeneralDesc();
  }
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getNumberType = function(a) {
  var b = this.getRegionCodeForNumber(a), b = this.getMetadataForRegionOrCallingCode_(a.getCountryCodeOrDefault(), b);
  if (null == b) {
    return i18n.phonenumbers.PhoneNumberType.UNKNOWN;
  }
  a = this.getNationalSignificantNumber(a);
  return this.getNumberTypeHelper_(a, b);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getNumberTypeHelper_ = function(a, b) {
  return this.isNumberMatchingDesc_(a, b.getGeneralDesc()) ? this.isNumberMatchingDesc_(a, b.getPremiumRate()) ? i18n.phonenumbers.PhoneNumberType.PREMIUM_RATE : this.isNumberMatchingDesc_(a, b.getTollFree()) ? i18n.phonenumbers.PhoneNumberType.TOLL_FREE : this.isNumberMatchingDesc_(a, b.getSharedCost()) ? i18n.phonenumbers.PhoneNumberType.SHARED_COST : this.isNumberMatchingDesc_(a, b.getVoip()) ? i18n.phonenumbers.PhoneNumberType.VOIP : this.isNumberMatchingDesc_(a, b.getPersonalNumber()) ? i18n.phonenumbers.PhoneNumberType.PERSONAL_NUMBER : 
  this.isNumberMatchingDesc_(a, b.getPager()) ? i18n.phonenumbers.PhoneNumberType.PAGER : this.isNumberMatchingDesc_(a, b.getUan()) ? i18n.phonenumbers.PhoneNumberType.UAN : this.isNumberMatchingDesc_(a, b.getVoicemail()) ? i18n.phonenumbers.PhoneNumberType.VOICEMAIL : this.isNumberMatchingDesc_(a, b.getFixedLine()) ? b.getSameMobileAndFixedLinePattern() || this.isNumberMatchingDesc_(a, b.getMobile()) ? i18n.phonenumbers.PhoneNumberType.FIXED_LINE_OR_MOBILE : i18n.phonenumbers.PhoneNumberType.FIXED_LINE : 
  !b.getSameMobileAndFixedLinePattern() && this.isNumberMatchingDesc_(a, b.getMobile()) ? i18n.phonenumbers.PhoneNumberType.MOBILE : i18n.phonenumbers.PhoneNumberType.UNKNOWN : i18n.phonenumbers.PhoneNumberType.UNKNOWN;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getMetadataForRegion = function(a) {
  if (null == a) {
    return null;
  }
  a = a.toUpperCase();
  var b = this.regionToMetadataMap[a];
  if (null == b) {
    var b = new goog.proto2.PbLiteSerializer, c = i18n.phonenumbers.metadata.countryToMetadata[a];
    if (null == c) {
      return null;
    }
    b = b.deserialize(i18n.phonenumbers.PhoneMetadata.getDescriptor(), c);
    this.regionToMetadataMap[a] = b;
  }
  return b;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getMetadataForNonGeographicalRegion = function(a) {
  return this.getMetadataForRegion("" + a);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.isNumberMatchingDesc_ = function(a, b) {
  return i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(b.getPossibleNumberPatternOrDefault(), a) && i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(b.getNationalNumberPatternOrDefault(), a);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.isValidNumber = function(a) {
  var b = this.getRegionCodeForNumber(a);
  return this.isValidNumberForRegion(a, b);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.isValidNumberForRegion = function(a, b) {
  var c = a.getCountryCodeOrDefault(), d = this.getMetadataForRegionOrCallingCode_(c, b);
  if (null == d || i18n.phonenumbers.PhoneNumberUtil.REGION_CODE_FOR_NON_GEO_ENTITY != b && c != this.getCountryCodeForValidRegion_(b)) {
    return !1;
  }
  c = this.getNationalSignificantNumber(a);
  return this.getNumberTypeHelper_(c, d) != i18n.phonenumbers.PhoneNumberType.UNKNOWN;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getRegionCodeForNumber = function(a) {
  if (null == a) {
    return null;
  }
  var b = a.getCountryCodeOrDefault(), b = i18n.phonenumbers.metadata.countryCodeToRegionCodeMap[b];
  return null == b ? null : 1 == b.length ? b[0] : this.getRegionCodeForNumberFromRegionList_(a, b);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getRegionCodeForNumberFromRegionList_ = function(a, b) {
  for (var c = this.getNationalSignificantNumber(a), d, e = b.length, f = 0;f < e;f++) {
    d = b[f];
    var g = this.getMetadataForRegion(d);
    if (g.hasLeadingDigits()) {
      if (0 == c.search(g.getLeadingDigits())) {
        return d;
      }
    } else {
      if (this.getNumberTypeHelper_(c, g) != i18n.phonenumbers.PhoneNumberType.UNKNOWN) {
        return d;
      }
    }
  }
  return null;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getRegionCodeForCountryCode = function(a) {
  a = i18n.phonenumbers.metadata.countryCodeToRegionCodeMap[a];
  return null == a ? i18n.phonenumbers.PhoneNumberUtil.UNKNOWN_REGION_ : a[0];
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getRegionCodesForCountryCode = function(a) {
  a = i18n.phonenumbers.metadata.countryCodeToRegionCodeMap[a];
  return null == a ? [] : a;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getCountryCodeForRegion = function(a) {
  return this.isValidRegionCode_(a) ? this.getCountryCodeForValidRegion_(a) : 0;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getCountryCodeForValidRegion_ = function(a) {
  var b = this.getMetadataForRegion(a);
  if (null == b) {
    throw Error("Invalid region code: " + a);
  }
  return b.getCountryCodeOrDefault();
};
i18n.phonenumbers.PhoneNumberUtil.prototype.getNddPrefixForRegion = function(a, b) {
  var c = this.getMetadataForRegion(a);
  if (null == c) {
    return null;
  }
  c = c.getNationalPrefixOrDefault();
  if (0 == c.length) {
    return null;
  }
  b && (c = c.replace("~", ""));
  return c;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.isNANPACountry = function(a) {
  return null != a && goog.array.contains(i18n.phonenumbers.metadata.countryCodeToRegionCodeMap[i18n.phonenumbers.PhoneNumberUtil.NANPA_COUNTRY_CODE_], a.toUpperCase());
};
i18n.phonenumbers.PhoneNumberUtil.prototype.isLeadingZeroPossible = function(a) {
  a = this.getMetadataForRegionOrCallingCode_(a, this.getRegionCodeForCountryCode(a));
  return null != a && a.getLeadingZeroPossibleOrDefault();
};
i18n.phonenumbers.PhoneNumberUtil.prototype.isAlphaNumber = function(a) {
  if (!i18n.phonenumbers.PhoneNumberUtil.isViablePhoneNumber(a)) {
    return !1;
  }
  a = new goog.string.StringBuffer(a);
  this.maybeStripExtension(a);
  return i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(i18n.phonenumbers.PhoneNumberUtil.VALID_ALPHA_PHONE_PATTERN_, a.toString());
};
i18n.phonenumbers.PhoneNumberUtil.prototype.isPossibleNumber = function(a) {
  return this.isPossibleNumberWithReason(a) == i18n.phonenumbers.PhoneNumberUtil.ValidationResult.IS_POSSIBLE;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.testNumberLengthAgainstPattern_ = function(a, b) {
  return i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(a, b) ? i18n.phonenumbers.PhoneNumberUtil.ValidationResult.IS_POSSIBLE : 0 == b.search(a) ? i18n.phonenumbers.PhoneNumberUtil.ValidationResult.TOO_LONG : i18n.phonenumbers.PhoneNumberUtil.ValidationResult.TOO_SHORT;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.isShorterThanPossibleNormalNumber_ = function(a, b) {
  var c = a.getGeneralDesc().getPossibleNumberPatternOrDefault();
  return this.testNumberLengthAgainstPattern_(c, b) == i18n.phonenumbers.PhoneNumberUtil.ValidationResult.TOO_SHORT;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.isPossibleNumberWithReason = function(a) {
  var b = this.getNationalSignificantNumber(a);
  a = a.getCountryCodeOrDefault();
  if (!this.hasValidCountryCallingCode_(a)) {
    return i18n.phonenumbers.PhoneNumberUtil.ValidationResult.INVALID_COUNTRY_CODE;
  }
  var c = this.getRegionCodeForCountryCode(a);
  a = this.getMetadataForRegionOrCallingCode_(a, c).getGeneralDesc().getPossibleNumberPatternOrDefault();
  return this.testNumberLengthAgainstPattern_(a, b);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.isPossibleNumberString = function(a, b) {
  try {
    return this.isPossibleNumber(this.parse(a, b));
  } catch (c) {
    return !1;
  }
};
i18n.phonenumbers.PhoneNumberUtil.prototype.truncateTooLongNumber = function(a) {
  if (this.isValidNumber(a)) {
    return !0;
  }
  var b = a.clone(), c = a.getNationalNumberOrDefault();
  do {
    if (c = Math.floor(c / 10), b.setNationalNumber(c), 0 == c || this.isPossibleNumberWithReason(b) == i18n.phonenumbers.PhoneNumberUtil.ValidationResult.TOO_SHORT) {
      return !1;
    }
  } while (!this.isValidNumber(b));
  a.setNationalNumber(c);
  return !0;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.extractCountryCode = function(a, b) {
  var c = a.toString();
  if (0 == c.length || "0" == c.charAt(0)) {
    return 0;
  }
  for (var d, e = c.length, f = 1;f <= i18n.phonenumbers.PhoneNumberUtil.MAX_LENGTH_COUNTRY_CODE_ && f <= e;++f) {
    if (d = parseInt(c.substring(0, f), 10), d in i18n.phonenumbers.metadata.countryCodeToRegionCodeMap) {
      return b.append(c.substring(f)), d;
    }
  }
  return 0;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.maybeExtractCountryCode = function(a, b, c, d, e) {
  if (0 == a.length) {
    return 0;
  }
  a = new goog.string.StringBuffer(a);
  var f;
  null != b && (f = b.getInternationalPrefix());
  null == f && (f = "NonMatch");
  f = this.maybeStripInternationalPrefixAndNormalize(a, f);
  d && e.setCountryCodeSource(f);
  if (f != i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_DEFAULT_COUNTRY) {
    if (a.getLength() <= i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_FOR_NSN_) {
      throw Error(i18n.phonenumbers.Error.TOO_SHORT_AFTER_IDD);
    }
    c = this.extractCountryCode(a, c);
    if (0 != c) {
      return e.setCountryCode(c), c;
    }
    throw Error(i18n.phonenumbers.Error.INVALID_COUNTRY_CODE);
  }
  if (null != b) {
    f = b.getCountryCodeOrDefault();
    var g = "" + f, h = a.toString();
    if (goog.string.startsWith(h, g)) {
      var k = new goog.string.StringBuffer(h.substring(g.length)), h = b.getGeneralDesc(), g = new RegExp(h.getNationalNumberPatternOrDefault());
      this.maybeStripNationalPrefixAndCarrierCode(k, b, null);
      b = k.toString();
      h = h.getPossibleNumberPatternOrDefault();
      if (!i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(g, a.toString()) && i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(g, b) || this.testNumberLengthAgainstPattern_(h, a.toString()) == i18n.phonenumbers.PhoneNumberUtil.ValidationResult.TOO_LONG) {
        return c.append(b), d && e.setCountryCodeSource(i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_NUMBER_WITHOUT_PLUS_SIGN), e.setCountryCode(f), f;
      }
    }
  }
  e.setCountryCode(0);
  return 0;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.parsePrefixAsIdd_ = function(a, b) {
  var c = b.toString();
  if (0 == c.search(a)) {
    var d = c.match(a)[0].length, e = c.substring(d).match(i18n.phonenumbers.PhoneNumberUtil.CAPTURING_DIGIT_PATTERN);
    if (e && null != e[1] && 0 < e[1].length && "0" == i18n.phonenumbers.PhoneNumberUtil.normalizeDigitsOnly(e[1])) {
      return !1;
    }
    b.clear();
    b.append(c.substring(d));
    return !0;
  }
  return !1;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.maybeStripInternationalPrefixAndNormalize = function(a, b) {
  var c = a.toString();
  if (0 == c.length) {
    return i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_DEFAULT_COUNTRY;
  }
  if (i18n.phonenumbers.PhoneNumberUtil.LEADING_PLUS_CHARS_PATTERN_.test(c)) {
    return c = c.replace(i18n.phonenumbers.PhoneNumberUtil.LEADING_PLUS_CHARS_PATTERN_, ""), a.clear(), a.append(i18n.phonenumbers.PhoneNumberUtil.normalize(c)), i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_NUMBER_WITH_PLUS_SIGN;
  }
  c = new RegExp(b);
  i18n.phonenumbers.PhoneNumberUtil.normalizeSB_(a);
  return this.parsePrefixAsIdd_(c, a) ? i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_NUMBER_WITH_IDD : i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_DEFAULT_COUNTRY;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.maybeStripNationalPrefixAndCarrierCode = function(a, b, c) {
  var d = a.toString(), e = d.length, f = b.getNationalPrefixForParsing();
  if (0 == e || null == f || 0 == f.length) {
    return !1;
  }
  var g = new RegExp("^(?:" + f + ")");
  if (e = g.exec(d)) {
    var f = new RegExp(b.getGeneralDesc().getNationalNumberPatternOrDefault()), h = i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(f, d), k = e.length - 1;
    b = b.getNationalPrefixTransformRule();
    if (null == b || 0 == b.length || null == e[k] || 0 == e[k].length) {
      if (h && !i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(f, d.substring(e[0].length))) {
        return !1;
      }
      null != c && 0 < k && null != e[k] && c.append(e[1]);
      a.set(d.substring(e[0].length));
    } else {
      d = d.replace(g, b);
      if (h && !i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(f, d)) {
        return !1;
      }
      null != c && 0 < k && c.append(e[1]);
      a.set(d);
    }
    return !0;
  }
  return !1;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.maybeStripExtension = function(a) {
  var b = a.toString(), c = b.search(i18n.phonenumbers.PhoneNumberUtil.EXTN_PATTERN_);
  if (0 <= c && i18n.phonenumbers.PhoneNumberUtil.isViablePhoneNumber(b.substring(0, c))) {
    for (var d = b.match(i18n.phonenumbers.PhoneNumberUtil.EXTN_PATTERN_), e = d.length, f = 1;f < e;++f) {
      if (null != d[f] && 0 < d[f].length) {
        return a.clear(), a.append(b.substring(0, c)), d[f];
      }
    }
  }
  return "";
};
i18n.phonenumbers.PhoneNumberUtil.prototype.checkRegionForParsing_ = function(a, b) {
  return this.isValidRegionCode_(b) || null != a && 0 < a.length && i18n.phonenumbers.PhoneNumberUtil.LEADING_PLUS_CHARS_PATTERN_.test(a);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.parse = function(a, b) {
  return this.parseHelper_(a, b, !1, !0);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.parseAndKeepRawInput = function(a, b) {
  if (!this.isValidRegionCode_(b) && 0 < a.length && a.charAt(0) != i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN) {
    throw Error(i18n.phonenumbers.Error.INVALID_COUNTRY_CODE);
  }
  return this.parseHelper_(a, b, !0, !0);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.setItalianLeadingZerosForPhoneNumber_ = function(a, b) {
  if (1 < a.length && "0" == a.charAt(0)) {
    b.setItalianLeadingZero(!0);
    for (var c = 1;c < a.length - 1 && "0" == a.charAt(c);) {
      c++;
    }
    1 != c && b.setNumberOfLeadingZeros(c);
  }
};
i18n.phonenumbers.PhoneNumberUtil.prototype.parseHelper_ = function(a, b, c, d) {
  if (null == a) {
    throw Error(i18n.phonenumbers.Error.NOT_A_NUMBER);
  }
  if (a.length > i18n.phonenumbers.PhoneNumberUtil.MAX_INPUT_STRING_LENGTH_) {
    throw Error(i18n.phonenumbers.Error.TOO_LONG);
  }
  var e = new goog.string.StringBuffer;
  this.buildNationalNumberForParsing_(a, e);
  if (!i18n.phonenumbers.PhoneNumberUtil.isViablePhoneNumber(e.toString())) {
    throw Error(i18n.phonenumbers.Error.NOT_A_NUMBER);
  }
  if (d && !this.checkRegionForParsing_(e.toString(), b)) {
    throw Error(i18n.phonenumbers.Error.INVALID_COUNTRY_CODE);
  }
  d = new i18n.phonenumbers.PhoneNumber;
  c && d.setRawInput(a);
  a = this.maybeStripExtension(e);
  0 < a.length && d.setExtension(a);
  a = this.getMetadataForRegion(b);
  var f = new goog.string.StringBuffer, g = 0, h = e.toString();
  try {
    g = this.maybeExtractCountryCode(h, a, f, c, d);
  } catch (k) {
    if (k.message == i18n.phonenumbers.Error.INVALID_COUNTRY_CODE && i18n.phonenumbers.PhoneNumberUtil.LEADING_PLUS_CHARS_PATTERN_.test(h)) {
      if (h = h.replace(i18n.phonenumbers.PhoneNumberUtil.LEADING_PLUS_CHARS_PATTERN_, ""), g = this.maybeExtractCountryCode(h, a, f, c, d), 0 == g) {
        throw k;
      }
    } else {
      throw k;
    }
  }
  0 != g ? (e = this.getRegionCodeForCountryCode(g), e != b && (a = this.getMetadataForRegionOrCallingCode_(g, e))) : (i18n.phonenumbers.PhoneNumberUtil.normalizeSB_(e), f.append(e.toString()), null != b ? (g = a.getCountryCodeOrDefault(), d.setCountryCode(g)) : c && d.clearCountryCodeSource());
  if (f.getLength() < i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_FOR_NSN_) {
    throw Error(i18n.phonenumbers.Error.TOO_SHORT_NSN);
  }
  null != a && (b = new goog.string.StringBuffer, e = new goog.string.StringBuffer(f.toString()), this.maybeStripNationalPrefixAndCarrierCode(e, a, b), this.isShorterThanPossibleNormalNumber_(a, e.toString()) || (f = e, c && d.setPreferredDomesticCarrierCode(b.toString())));
  c = f.toString();
  b = c.length;
  if (b < i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_FOR_NSN_) {
    throw Error(i18n.phonenumbers.Error.TOO_SHORT_NSN);
  }
  if (b > i18n.phonenumbers.PhoneNumberUtil.MAX_LENGTH_FOR_NSN_) {
    throw Error(i18n.phonenumbers.Error.TOO_LONG);
  }
  this.setItalianLeadingZerosForPhoneNumber_(c, d);
  d.setNationalNumber(parseInt(c, 10));
  return d;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.buildNationalNumberForParsing_ = function(a, b) {
  var c = a.indexOf(i18n.phonenumbers.PhoneNumberUtil.RFC3966_PHONE_CONTEXT_);
  if (0 < c) {
    var d = c + i18n.phonenumbers.PhoneNumberUtil.RFC3966_PHONE_CONTEXT_.length;
    if (a.charAt(d) == i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN) {
      var e = a.indexOf(";", d);
      0 < e ? b.append(a.substring(d, e)) : b.append(a.substring(d));
    }
    d = a.indexOf(i18n.phonenumbers.PhoneNumberUtil.RFC3966_PREFIX_);
    b.append(a.substring(0 <= d ? d + i18n.phonenumbers.PhoneNumberUtil.RFC3966_PREFIX_.length : 0, c));
  } else {
    b.append(i18n.phonenumbers.PhoneNumberUtil.extractPossibleNumber(a));
  }
  c = b.toString();
  d = c.indexOf(i18n.phonenumbers.PhoneNumberUtil.RFC3966_ISDN_SUBADDRESS_);
  0 < d && (b.clear(), b.append(c.substring(0, d)));
};
i18n.phonenumbers.PhoneNumberUtil.prototype.isNumberMatch = function(a, b) {
  var c, d;
  if ("string" == typeof a) {
    try {
      c = this.parse(a, i18n.phonenumbers.PhoneNumberUtil.UNKNOWN_REGION_);
    } catch (g) {
      if (g.message != i18n.phonenumbers.Error.INVALID_COUNTRY_CODE) {
        return i18n.phonenumbers.PhoneNumberUtil.MatchType.NOT_A_NUMBER;
      }
      if ("string" != typeof b) {
        var e = this.getRegionCodeForCountryCode(b.getCountryCodeOrDefault());
        if (e != i18n.phonenumbers.PhoneNumberUtil.UNKNOWN_REGION_) {
          try {
            c = this.parse(a, e);
          } catch (h) {
            return i18n.phonenumbers.PhoneNumberUtil.MatchType.NOT_A_NUMBER;
          }
          c = this.isNumberMatch(c, b);
          return c == i18n.phonenumbers.PhoneNumberUtil.MatchType.EXACT_MATCH ? i18n.phonenumbers.PhoneNumberUtil.MatchType.NSN_MATCH : c;
        }
      }
      try {
        c = this.parseHelper_(a, null, !1, !1);
      } catch (h) {
        return i18n.phonenumbers.PhoneNumberUtil.MatchType.NOT_A_NUMBER;
      }
    }
  } else {
    c = a.clone();
  }
  if ("string" == typeof b) {
    try {
      return d = this.parse(b, i18n.phonenumbers.PhoneNumberUtil.UNKNOWN_REGION_), this.isNumberMatch(a, d);
    } catch (g) {
      return g.message != i18n.phonenumbers.Error.INVALID_COUNTRY_CODE ? i18n.phonenumbers.PhoneNumberUtil.MatchType.NOT_A_NUMBER : this.isNumberMatch(b, c);
    }
  } else {
    d = b.clone();
  }
  c.clearRawInput();
  c.clearCountryCodeSource();
  c.clearPreferredDomesticCarrierCode();
  d.clearRawInput();
  d.clearCountryCodeSource();
  d.clearPreferredDomesticCarrierCode();
  c.hasExtension() && 0 == c.getExtension().length && c.clearExtension();
  d.hasExtension() && 0 == d.getExtension().length && d.clearExtension();
  if (c.hasExtension() && d.hasExtension() && c.getExtension() != d.getExtension()) {
    return i18n.phonenumbers.PhoneNumberUtil.MatchType.NO_MATCH;
  }
  var e = c.getCountryCodeOrDefault(), f = d.getCountryCodeOrDefault();
  if (0 != e && 0 != f) {
    return c.equals(d) ? i18n.phonenumbers.PhoneNumberUtil.MatchType.EXACT_MATCH : e == f && this.isNationalNumberSuffixOfTheOther_(c, d) ? i18n.phonenumbers.PhoneNumberUtil.MatchType.SHORT_NSN_MATCH : i18n.phonenumbers.PhoneNumberUtil.MatchType.NO_MATCH;
  }
  c.setCountryCode(0);
  d.setCountryCode(0);
  return c.equals(d) ? i18n.phonenumbers.PhoneNumberUtil.MatchType.NSN_MATCH : this.isNationalNumberSuffixOfTheOther_(c, d) ? i18n.phonenumbers.PhoneNumberUtil.MatchType.SHORT_NSN_MATCH : i18n.phonenumbers.PhoneNumberUtil.MatchType.NO_MATCH;
};
i18n.phonenumbers.PhoneNumberUtil.prototype.isNationalNumberSuffixOfTheOther_ = function(a, b) {
  var c = "" + a.getNationalNumber(), d = "" + b.getNationalNumber();
  return goog.string.endsWith(c, d) || goog.string.endsWith(d, c);
};
i18n.phonenumbers.PhoneNumberUtil.prototype.canBeInternationallyDialled = function(a) {
  var b = this.getMetadataForRegion(this.getRegionCodeForNumber(a));
  if (null == b) {
    return !0;
  }
  a = this.getNationalSignificantNumber(a);
  return !this.isNumberMatchingDesc_(a, b.getNoInternationalDialling());
};
i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_ = function(a, b) {
  var c = "string" == typeof a ? b.match("^(?:" + a + ")$") : b.match(a);
  return c && c[0].length == b.length ? !0 : !1;
};
i18n.phonenumbers.AsYouTypeFormatter = function(a) {
  this.DIGIT_PLACEHOLDER_ = "\u2008";
  this.DIGIT_PATTERN_ = new RegExp(this.DIGIT_PLACEHOLDER_);
  this.currentOutput_ = "";
  this.formattingTemplate_ = new goog.string.StringBuffer;
  this.currentFormattingPattern_ = "";
  this.accruedInput_ = new goog.string.StringBuffer;
  this.accruedInputWithoutFormatting_ = new goog.string.StringBuffer;
  this.ableToFormat_ = !0;
  this.isExpectingCountryCallingCode_ = this.isCompleteNumber_ = this.inputHasFormatting_ = !1;
  this.phoneUtil_ = i18n.phonenumbers.PhoneNumberUtil.getInstance();
  this.positionToRemember_ = this.originalPosition_ = this.lastMatchPosition_ = 0;
  this.prefixBeforeNationalNumber_ = new goog.string.StringBuffer;
  this.shouldAddSpaceAfterNationalPrefix_ = !1;
  this.extractedNationalPrefix_ = "";
  this.nationalNumber_ = new goog.string.StringBuffer;
  this.possibleFormats_ = [];
  this.defaultCountry_ = a;
  this.defaultMetadata_ = this.currentMetadata_ = this.getMetadataForRegion_(this.defaultCountry_);
};
i18n.phonenumbers.AsYouTypeFormatter.SEPARATOR_BEFORE_NATIONAL_NUMBER_ = " ";
i18n.phonenumbers.AsYouTypeFormatter.EMPTY_METADATA_ = new i18n.phonenumbers.PhoneMetadata;
i18n.phonenumbers.AsYouTypeFormatter.EMPTY_METADATA_.setInternationalPrefix("NA");
i18n.phonenumbers.AsYouTypeFormatter.CHARACTER_CLASS_PATTERN_ = /\[([^\[\]])*\]/g;
i18n.phonenumbers.AsYouTypeFormatter.STANDALONE_DIGIT_PATTERN_ = /\d(?=[^,}][^,}])/g;
i18n.phonenumbers.AsYouTypeFormatter.ELIGIBLE_FORMAT_PATTERN_ = new RegExp("^[" + i18n.phonenumbers.PhoneNumberUtil.VALID_PUNCTUATION + "]*(\\$\\d[" + i18n.phonenumbers.PhoneNumberUtil.VALID_PUNCTUATION + "]*)+$");
i18n.phonenumbers.AsYouTypeFormatter.NATIONAL_PREFIX_SEPARATORS_PATTERN_ = /[- ]/;
i18n.phonenumbers.AsYouTypeFormatter.MIN_LEADING_DIGITS_LENGTH_ = 3;
i18n.phonenumbers.AsYouTypeFormatter.prototype.getMetadataForRegion_ = function(a) {
  a = this.phoneUtil_.getCountryCodeForRegion(a);
  a = this.phoneUtil_.getRegionCodeForCountryCode(a);
  a = this.phoneUtil_.getMetadataForRegion(a);
  return null != a ? a : i18n.phonenumbers.AsYouTypeFormatter.EMPTY_METADATA_;
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.maybeCreateNewTemplate_ = function() {
  for (var a = this.possibleFormats_.length, b = 0;b < a;++b) {
    var c = this.possibleFormats_[b], d = c.getPatternOrDefault();
    if (this.currentFormattingPattern_ == d) {
      return !1;
    }
    if (this.createFormattingTemplate_(c)) {
      return this.currentFormattingPattern_ = d, this.shouldAddSpaceAfterNationalPrefix_ = i18n.phonenumbers.AsYouTypeFormatter.NATIONAL_PREFIX_SEPARATORS_PATTERN_.test(c.getNationalPrefixFormattingRule()), this.lastMatchPosition_ = 0, !0;
    }
  }
  return this.ableToFormat_ = !1;
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.getAvailableFormats_ = function(a) {
  for (var b = this.isCompleteNumber_ && 0 < this.currentMetadata_.intlNumberFormatCount() ? this.currentMetadata_.intlNumberFormatArray() : this.currentMetadata_.numberFormatArray(), c = b.length, d = 0;d < c;++d) {
    var e = b[d];
    (!this.currentMetadata_.hasNationalPrefix() || this.isCompleteNumber_ || e.getNationalPrefixOptionalWhenFormatting() || this.phoneUtil_.formattingRuleHasFirstGroupOnly(e.getNationalPrefixFormattingRuleOrDefault())) && this.isFormatEligible_(e.getFormatOrDefault()) && this.possibleFormats_.push(e);
  }
  this.narrowDownPossibleFormats_(a);
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.isFormatEligible_ = function(a) {
  return i18n.phonenumbers.AsYouTypeFormatter.ELIGIBLE_FORMAT_PATTERN_.test(a);
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.narrowDownPossibleFormats_ = function(a) {
  for (var b = [], c = a.length - i18n.phonenumbers.AsYouTypeFormatter.MIN_LEADING_DIGITS_LENGTH_, d = this.possibleFormats_.length, e = 0;e < d;++e) {
    var f = this.possibleFormats_[e];
    if (0 == f.leadingDigitsPatternCount()) {
      b.push(this.possibleFormats_[e]);
    } else {
      var g = Math.min(c, f.leadingDigitsPatternCount() - 1), f = f.getLeadingDigitsPattern(g);
      0 == a.search(f) && b.push(this.possibleFormats_[e]);
    }
  }
  this.possibleFormats_ = b;
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.createFormattingTemplate_ = function(a) {
  var b = a.getPatternOrDefault();
  if (-1 != b.indexOf("|")) {
    return !1;
  }
  b = b.replace(i18n.phonenumbers.AsYouTypeFormatter.CHARACTER_CLASS_PATTERN_, "\\d");
  b = b.replace(i18n.phonenumbers.AsYouTypeFormatter.STANDALONE_DIGIT_PATTERN_, "\\d");
  this.formattingTemplate_.clear();
  a = this.getFormattingTemplate_(b, a.getFormatOrDefault());
  return 0 < a.length ? (this.formattingTemplate_.append(a), !0) : !1;
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.getFormattingTemplate_ = function(a, b) {
  var c = "999999999999999".match(a)[0];
  if (c.length < this.nationalNumber_.getLength()) {
    return "";
  }
  c = c.replace(new RegExp(a, "g"), b);
  return c = c.replace(RegExp("9", "g"), this.DIGIT_PLACEHOLDER_);
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.clear = function() {
  this.currentOutput_ = "";
  this.accruedInput_.clear();
  this.accruedInputWithoutFormatting_.clear();
  this.formattingTemplate_.clear();
  this.lastMatchPosition_ = 0;
  this.currentFormattingPattern_ = "";
  this.prefixBeforeNationalNumber_.clear();
  this.extractedNationalPrefix_ = "";
  this.nationalNumber_.clear();
  this.ableToFormat_ = !0;
  this.inputHasFormatting_ = !1;
  this.originalPosition_ = this.positionToRemember_ = 0;
  this.isExpectingCountryCallingCode_ = this.isCompleteNumber_ = !1;
  this.possibleFormats_ = [];
  this.shouldAddSpaceAfterNationalPrefix_ = !1;
  this.currentMetadata_ != this.defaultMetadata_ && (this.currentMetadata_ = this.getMetadataForRegion_(this.defaultCountry_));
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.inputDigit = function(a) {
  return this.currentOutput_ = this.inputDigitWithOptionToRememberPosition_(a, !1);
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.inputDigitAndRememberPosition = function(a) {
  return this.currentOutput_ = this.inputDigitWithOptionToRememberPosition_(a, !0);
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.inputDigitWithOptionToRememberPosition_ = function(a, b) {
  this.accruedInput_.append(a);
  b && (this.originalPosition_ = this.accruedInput_.getLength());
  this.isDigitOrLeadingPlusSign_(a) ? a = this.normalizeAndAccrueDigitsAndPlusSign_(a, b) : (this.ableToFormat_ = !1, this.inputHasFormatting_ = !0);
  if (!this.ableToFormat_) {
    if (!this.inputHasFormatting_) {
      if (this.attemptToExtractIdd_()) {
        if (this.attemptToExtractCountryCallingCode_()) {
          return this.attemptToChoosePatternWithPrefixExtracted_();
        }
      } else {
        if (this.ableToExtractLongerNdd_()) {
          return this.prefixBeforeNationalNumber_.append(i18n.phonenumbers.AsYouTypeFormatter.SEPARATOR_BEFORE_NATIONAL_NUMBER_), this.attemptToChoosePatternWithPrefixExtracted_();
        }
      }
    }
    return this.accruedInput_.toString();
  }
  switch(this.accruedInputWithoutFormatting_.getLength()) {
    case 0:
    ;
    case 1:
    ;
    case 2:
      return this.accruedInput_.toString();
    case 3:
      if (this.attemptToExtractIdd_()) {
        this.isExpectingCountryCallingCode_ = !0;
      } else {
        return this.extractedNationalPrefix_ = this.removeNationalPrefixFromNationalNumber_(), this.attemptToChooseFormattingPattern_();
      }
    ;
    default:
      if (this.isExpectingCountryCallingCode_) {
        return this.attemptToExtractCountryCallingCode_() && (this.isExpectingCountryCallingCode_ = !1), this.prefixBeforeNationalNumber_.toString() + this.nationalNumber_.toString();
      }
      if (0 < this.possibleFormats_.length) {
        var c = this.inputDigitHelper_(a), d = this.attemptToFormatAccruedDigits_();
        if (0 < d.length) {
          return d;
        }
        this.narrowDownPossibleFormats_(this.nationalNumber_.toString());
        return this.maybeCreateNewTemplate_() ? this.inputAccruedNationalNumber_() : this.ableToFormat_ ? this.appendNationalNumber_(c) : this.accruedInput_.toString();
      }
      return this.attemptToChooseFormattingPattern_();
  }
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.attemptToChoosePatternWithPrefixExtracted_ = function() {
  this.ableToFormat_ = !0;
  this.isExpectingCountryCallingCode_ = !1;
  this.possibleFormats_ = [];
  this.lastMatchPosition_ = 0;
  this.formattingTemplate_.clear();
  this.currentFormattingPattern_ = "";
  return this.attemptToChooseFormattingPattern_();
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.getExtractedNationalPrefix_ = function() {
  return this.extractedNationalPrefix_;
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.ableToExtractLongerNdd_ = function() {
  if (0 < this.extractedNationalPrefix_.length) {
    var a = this.nationalNumber_.toString();
    this.nationalNumber_.clear();
    this.nationalNumber_.append(this.extractedNationalPrefix_);
    this.nationalNumber_.append(a);
    var a = this.prefixBeforeNationalNumber_.toString(), b = a.lastIndexOf(this.extractedNationalPrefix_);
    this.prefixBeforeNationalNumber_.clear();
    this.prefixBeforeNationalNumber_.append(a.substring(0, b));
  }
  return this.extractedNationalPrefix_ != this.removeNationalPrefixFromNationalNumber_();
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.isDigitOrLeadingPlusSign_ = function(a) {
  return i18n.phonenumbers.PhoneNumberUtil.CAPTURING_DIGIT_PATTERN.test(a) || 1 == this.accruedInput_.getLength() && i18n.phonenumbers.PhoneNumberUtil.PLUS_CHARS_PATTERN.test(a);
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.attemptToFormatAccruedDigits_ = function() {
  for (var a = this.nationalNumber_.toString(), b = this.possibleFormats_.length, c = 0;c < b;++c) {
    var d = this.possibleFormats_[c], e = d.getPatternOrDefault();
    if ((new RegExp("^(?:" + e + ")$")).test(a)) {
      return this.shouldAddSpaceAfterNationalPrefix_ = i18n.phonenumbers.AsYouTypeFormatter.NATIONAL_PREFIX_SEPARATORS_PATTERN_.test(d.getNationalPrefixFormattingRule()), a = a.replace(new RegExp(e, "g"), d.getFormat()), this.appendNationalNumber_(a);
    }
  }
  return "";
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.appendNationalNumber_ = function(a) {
  var b = this.prefixBeforeNationalNumber_.getLength();
  return this.shouldAddSpaceAfterNationalPrefix_ && 0 < b && this.prefixBeforeNationalNumber_.toString().charAt(b - 1) != i18n.phonenumbers.AsYouTypeFormatter.SEPARATOR_BEFORE_NATIONAL_NUMBER_ ? this.prefixBeforeNationalNumber_ + i18n.phonenumbers.AsYouTypeFormatter.SEPARATOR_BEFORE_NATIONAL_NUMBER_ + a : this.prefixBeforeNationalNumber_ + a;
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.getRememberedPosition = function() {
  if (!this.ableToFormat_) {
    return this.originalPosition_;
  }
  for (var a = 0, b = 0, c = this.accruedInputWithoutFormatting_.toString(), d = this.currentOutput_.toString();a < this.positionToRemember_ && b < d.length;) {
    c.charAt(a) == d.charAt(b) && a++, b++;
  }
  return b;
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.attemptToChooseFormattingPattern_ = function() {
  var a = this.nationalNumber_.toString();
  return a.length >= i18n.phonenumbers.AsYouTypeFormatter.MIN_LEADING_DIGITS_LENGTH_ ? (this.getAvailableFormats_(a), a = this.attemptToFormatAccruedDigits_(), 0 < a.length ? a : this.maybeCreateNewTemplate_() ? this.inputAccruedNationalNumber_() : this.accruedInput_.toString()) : this.appendNationalNumber_(a);
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.inputAccruedNationalNumber_ = function() {
  var a = this.nationalNumber_.toString(), b = a.length;
  if (0 < b) {
    for (var c = "", d = 0;d < b;d++) {
      c = this.inputDigitHelper_(a.charAt(d));
    }
    return this.ableToFormat_ ? this.appendNationalNumber_(c) : this.accruedInput_.toString();
  }
  return this.prefixBeforeNationalNumber_.toString();
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.isNanpaNumberWithNationalPrefix_ = function() {
  if (1 != this.currentMetadata_.getCountryCode()) {
    return !1;
  }
  var a = this.nationalNumber_.toString();
  return "1" == a.charAt(0) && "0" != a.charAt(1) && "1" != a.charAt(1);
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.removeNationalPrefixFromNationalNumber_ = function() {
  var a = this.nationalNumber_.toString(), b = 0;
  if (this.isNanpaNumberWithNationalPrefix_()) {
    b = 1, this.prefixBeforeNationalNumber_.append("1").append(i18n.phonenumbers.AsYouTypeFormatter.SEPARATOR_BEFORE_NATIONAL_NUMBER_), this.isCompleteNumber_ = !0;
  } else {
    if (this.currentMetadata_.hasNationalPrefixForParsing()) {
      var c = new RegExp("^(?:" + this.currentMetadata_.getNationalPrefixForParsing() + ")"), c = a.match(c);
      null != c && null != c[0] && 0 < c[0].length && (this.isCompleteNumber_ = !0, b = c[0].length, this.prefixBeforeNationalNumber_.append(a.substring(0, b)));
    }
  }
  this.nationalNumber_.clear();
  this.nationalNumber_.append(a.substring(b));
  return a.substring(0, b);
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.attemptToExtractIdd_ = function() {
  var a = this.accruedInputWithoutFormatting_.toString(), b = new RegExp("^(?:\\" + i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN + "|" + this.currentMetadata_.getInternationalPrefix() + ")"), b = a.match(b);
  return null != b && null != b[0] && 0 < b[0].length ? (this.isCompleteNumber_ = !0, b = b[0].length, this.nationalNumber_.clear(), this.nationalNumber_.append(a.substring(b)), this.prefixBeforeNationalNumber_.clear(), this.prefixBeforeNationalNumber_.append(a.substring(0, b)), a.charAt(0) != i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN && this.prefixBeforeNationalNumber_.append(i18n.phonenumbers.AsYouTypeFormatter.SEPARATOR_BEFORE_NATIONAL_NUMBER_), !0) : !1;
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.attemptToExtractCountryCallingCode_ = function() {
  if (0 == this.nationalNumber_.getLength()) {
    return !1;
  }
  var a = new goog.string.StringBuffer, b = this.phoneUtil_.extractCountryCode(this.nationalNumber_, a);
  if (0 == b) {
    return !1;
  }
  this.nationalNumber_.clear();
  this.nationalNumber_.append(a.toString());
  a = this.phoneUtil_.getRegionCodeForCountryCode(b);
  i18n.phonenumbers.PhoneNumberUtil.REGION_CODE_FOR_NON_GEO_ENTITY == a ? this.currentMetadata_ = this.phoneUtil_.getMetadataForNonGeographicalRegion(b) : a != this.defaultCountry_ && (this.currentMetadata_ = this.getMetadataForRegion_(a));
  this.prefixBeforeNationalNumber_.append("" + b).append(i18n.phonenumbers.AsYouTypeFormatter.SEPARATOR_BEFORE_NATIONAL_NUMBER_);
  this.extractedNationalPrefix_ = "";
  return !0;
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.normalizeAndAccrueDigitsAndPlusSign_ = function(a, b) {
  var c;
  a == i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN ? (c = a, this.accruedInputWithoutFormatting_.append(a)) : (c = i18n.phonenumbers.PhoneNumberUtil.DIGIT_MAPPINGS[a], this.accruedInputWithoutFormatting_.append(c), this.nationalNumber_.append(c));
  b && (this.positionToRemember_ = this.accruedInputWithoutFormatting_.getLength());
  return c;
};
i18n.phonenumbers.AsYouTypeFormatter.prototype.inputDigitHelper_ = function(a) {
  var b = this.formattingTemplate_.toString();
  if (0 <= b.substring(this.lastMatchPosition_).search(this.DIGIT_PATTERN_)) {
    var c = b.search(this.DIGIT_PATTERN_);
    a = b.replace(this.DIGIT_PATTERN_, a);
    this.formattingTemplate_.clear();
    this.formattingTemplate_.append(a);
    this.lastMatchPosition_ = c;
    return a.substring(0, this.lastMatchPosition_ + 1);
  }
  1 == this.possibleFormats_.length && (this.ableToFormat_ = !1);
  this.currentFormattingPattern_ = "";
  return this.accruedInput_.toString();
};
module.exports = i18n.phonenumbers["default"] = i18n.phonenumbers.libphonenumber = i18n.phonenumbers;


},{}]},{},[1])(1)
});(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.libphonenumber = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function (global){
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.libphonenumber=e()}}(function(){var define,module,exports;return function e(t,o,n){function r(i,a){if(!o[i]){if(!t[i]){var N="function"==typeof require&&require;if(!a&&N)return N(i,!0);if(d)return d(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var s=o[i]={exports:{}};t[i][0].call(s.exports,function(e){var o=t[i][1][e];return r(o?o:e)},s,s.exports,e,t,o,n)}return o[i].exports}for(var d="function"==typeof require&&require,i=0;i<n.length;i++)r(n[i]);return r}({1:[function(require,module,exports){var COMPILED=!0,goog=goog||{};goog.global=this,goog.isDef=function(e){return void 0!==e},goog.exportPath_=function(e,t,o){e=e.split("."),o=o||goog.global,e[0]in o||!o.execScript||o.execScript("var "+e[0]);for(var n;e.length&&(n=e.shift());)!e.length&&goog.isDef(t)?o[n]=t:o=o[n]?o[n]:o[n]={}},goog.define=function(e,t){var o=t;COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,e)?o=goog.global.CLOSURE_UNCOMPILED_DEFINES[e]:goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,e)&&(o=goog.global.CLOSURE_DEFINES[e])),goog.exportPath_(e,o)},goog.DEBUG=!0,goog.LOCALE="en",goog.TRUSTED_SITE=!0,goog.STRICT_MODE_COMPATIBLE=!1,goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG,goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1,goog.provide=function(e){if(goog.isInModuleLoader_())throw Error("goog.provide can not be used within a goog.module.");if(!COMPILED&&goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');goog.constructNamespace_(e)},goog.constructNamespace_=function(e,t){if(!COMPILED){delete goog.implicitNamespaces_[e];for(var o=e;(o=o.substring(0,o.lastIndexOf(".")))&&!goog.getObjectByName(o);)goog.implicitNamespaces_[o]=!0}goog.exportPath_(e,t)},goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/,goog.module=function(e){if(!goog.isString(e)||!e||-1==e.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+e+" has been loaded incorrectly.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");if(goog.moduleLoaderState_.moduleName=e,!COMPILED){if(goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');delete goog.implicitNamespaces_[e]}},goog.module.get=function(e){return goog.module.getInternal_(e)},goog.module.getInternal_=function(e){if(!COMPILED)return goog.isProvided_(e)?e in goog.loadedModules_?goog.loadedModules_[e]:goog.getObjectByName(e):null},goog.moduleLoaderState_=null,goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_},goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0},goog.setTestOnly=function(e){if(goog.DISALLOW_TEST_ONLY_CODE)throw e=e||"",Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))},goog.forwardDeclare=function(e){},COMPILED||(goog.isProvided_=function(e){return e in goog.loadedModules_||!goog.implicitNamespaces_[e]&&goog.isDefAndNotNull(goog.getObjectByName(e))},goog.implicitNamespaces_={"goog.module":!0}),goog.getObjectByName=function(e,t){for(var o,n=e.split("."),r=t||goog.global;o=n.shift();){if(!goog.isDefAndNotNull(r[o]))return null;r=r[o]}return r},goog.globalize=function(e,t){var o,n=t||goog.global;for(o in e)n[o]=e[o]},goog.addDependency=function(e,t,o,n){if(goog.DEPENDENCIES_ENABLED){var r;e=e.replace(/\\/g,"/");var d=goog.dependencies_;n&&"boolean"!=typeof n||(n=n?{module:"goog"}:{});for(var i=0;r=t[i];i++)d.nameToPath[r]=e,d.loadFlags[e]=n;for(n=0;t=o[n];n++)e in d.requires||(d.requires[e]={}),d.requires[e][t]=!0}},goog.ENABLE_DEBUG_LOADER=!0,goog.logToConsole_=function(e){goog.global.console&&goog.global.console.error(e)},goog.require=function(e){if(!COMPILED){if(goog.ENABLE_DEBUG_LOADER&&goog.IS_OLD_IE_&&goog.maybeProcessDeferredDep_(e),goog.isProvided_(e))return goog.isInModuleLoader_()?goog.module.getInternal_(e):null;if(goog.ENABLE_DEBUG_LOADER){var t=goog.getPathFromDeps_(e);if(t)return goog.writeScripts_(t),null}throw e="goog.require could not find: "+e,goog.logToConsole_(e),Error(e)}},goog.basePath="",goog.nullFunction=function(){},goog.abstractMethod=function(){throw Error("unimplemented abstract method")},goog.addSingletonGetter=function(e){e.getInstance=function(){return e.instance_?e.instance_:(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=e),e.instance_=new e)}},goog.instantiatedSingletons_=[],goog.LOAD_MODULE_USING_EVAL=!0,goog.SEAL_MODULE_EXPORTS=goog.DEBUG,goog.loadedModules_={},goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER,goog.TRANSPILE="detect",goog.TRANSPILER="transpile.js",goog.DEPENDENCIES_ENABLED&&(goog.dependencies_={loadFlags:{},nameToPath:{},requires:{},visited:{},written:{},deferred:{}},goog.inHtmlDocument_=function(){var e=goog.global.document;return null!=e&&"write"in e},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH))goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var e=goog.global.document.getElementsByTagName("SCRIPT"),t=e.length-1;0<=t;--t){var o=e[t].src,n=o.lastIndexOf("?"),n=-1==n?o.length:n;if("base.js"==o.substr(n-7,7)){goog.basePath=o.substr(0,n-7);break}}},goog.importScript_=function(e,t){(goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_)(e,t)&&(goog.dependencies_.written[e]=!0)},goog.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.importProcessedScript_=function(e,t,o){goog.importScript_("",'goog.retrieveAndExec_("'+e+'", '+t+", "+o+");")},goog.queuedModules_=[],goog.wrapModule_=function(e,t){return goog.LOAD_MODULE_USING_EVAL&&goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(t+"\n//# sourceURL="+e+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+t+"\n;return exports});\n//# sourceURL="+e+"\n"},goog.loadQueuedModules_=function(){var e=goog.queuedModules_.length;if(0<e){var t=goog.queuedModules_;goog.queuedModules_=[];for(var o=0;o<e;o++)goog.maybeProcessDeferredPath_(t[o])}},goog.maybeProcessDeferredDep_=function(e){goog.isDeferredModule_(e)&&goog.allDepsAreAvailable_(e)&&(e=goog.getPathFromDeps_(e),goog.maybeProcessDeferredPath_(goog.basePath+e))},goog.isDeferredModule_=function(e){var t=(e=goog.getPathFromDeps_(e))&&goog.dependencies_.loadFlags[e]||{};return!(!e||"goog"!=t.module&&!goog.needsTranspile_(t.lang))&&goog.basePath+e in goog.dependencies_.deferred},goog.allDepsAreAvailable_=function(e){if((e=goog.getPathFromDeps_(e))&&e in goog.dependencies_.requires)for(var t in goog.dependencies_.requires[e])if(!goog.isProvided_(t)&&!goog.isDeferredModule_(t))return!1;return!0},goog.maybeProcessDeferredPath_=function(e){if(e in goog.dependencies_.deferred){var t=goog.dependencies_.deferred[e];delete goog.dependencies_.deferred[e],goog.globalEval(t)}},goog.loadModuleFromUrl=function(e){goog.retrieveAndExec_(e,!0,!1)},goog.writeScriptSrcNode_=function(e){goog.global.document.write('<script type="text/javascript" src="'+e+'"></script>')},goog.appendScriptSrcNode_=function(e){var t=goog.global.document,o=t.createElement("script");o.type="text/javascript",o.src=e,o.defer=!1,o.async=!1,t.head.appendChild(o)},goog.writeScriptTag_=function(e,t){if(goog.inHtmlDocument_()){var o=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&"complete"==o.readyState){if(/\bdeps.js$/.test(e))return!1;throw Error('Cannot write "'+e+'" after document load')}if(void 0===t)if(goog.IS_OLD_IE_){var n=" onreadystatechange='goog.onScriptLoad_(this, "+ ++goog.lastNonModuleScriptIndex_+")' ";o.write('<script type="text/javascript" src="'+e+'"'+n+"></script>")}else goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?goog.appendScriptSrcNode_(e):goog.writeScriptSrcNode_(e);else o.write('<script type="text/javascript">'+t+"</script>");return!0}return!1},goog.needsTranspile_=function(a){if("always"==goog.TRANSPILE)return!0;if("never"==goog.TRANSPILE)return!1;if(!goog.transpiledLanguages_){goog.transpiledLanguages_={es5:!0,es6:!0,"es6-impl":!0};try{goog.transpiledLanguages_.es5=eval("[1,].length!=1"),eval('(()=>{"use strict";let a={};const X=class{constructor(){}x(z){return new Map([...arguments]).get(z[0])==3}};return new X().x([a,3])})()')&&(goog.transpiledLanguages_["es6-impl"]=!1),eval('(()=>{"use strict";class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}})()')&&(goog.transpiledLanguages_.es6=!1)}catch(e){}}return!!goog.transpiledLanguages_[a]},goog.transpiledLanguages_=null,goog.lastNonModuleScriptIndex_=0,goog.onScriptLoad_=function(e,t){return"complete"==e.readyState&&goog.lastNonModuleScriptIndex_==t&&goog.loadQueuedModules_(),!0},goog.writeScripts_=function(e){function t(e){if(!(e in r.written||e in r.visited)){if(r.visited[e]=!0,e in r.requires)for(var d in r.requires[e])if(!goog.isProvided_(d)){if(!(d in r.nameToPath))throw Error("Undefined nameToPath for "+d);t(r.nameToPath[d])}e in n||(n[e]=!0,o.push(e))}}var o=[],n={},r=goog.dependencies_;for(t(e),e=0;e<o.length;e++){var d=o[e];goog.dependencies_.written[d]=!0}var i=goog.moduleLoaderState_;for(goog.moduleLoaderState_=null,e=0;e<o.length;e++){if(!(d=o[e]))throw goog.moduleLoaderState_=i,Error("Undefined script input");var a=r.loadFlags[d]||{},N=goog.needsTranspile_(a.lang);"goog"==a.module||N?goog.importProcessedScript_(goog.basePath+d,"goog"==a.module,N):goog.importScript_(goog.basePath+d)}goog.moduleLoaderState_=i},goog.getPathFromDeps_=function(e){return e in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[e]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js")),goog.loadModule=function(e){var t=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:void 0,declareLegacyNamespace:!1};var o;if(goog.isFunction(e))o=e.call(void 0,{});else{if(!goog.isString(e))throw Error("Invalid module definition");o=goog.loadModuleFromSource_.call(void 0,e)}var n=goog.moduleLoaderState_.moduleName;if(!goog.isString(n)||!n)throw Error('Invalid module name "'+n+'"');goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(n,o):goog.SEAL_MODULE_EXPORTS&&Object.seal&&Object.seal(o),goog.loadedModules_[n]=o}finally{goog.moduleLoaderState_=t}},goog.loadModuleFromSource_=function(a){return eval(a),{}},goog.normalizePath_=function(e){e=e.split("/");for(var t=0;t<e.length;)"."==e[t]?e.splice(t,1):t&&".."==e[t]&&e[t-1]&&".."!=e[t-1]?e.splice(--t,2):t++;return e.join("/")},goog.loadFileSync_=function(e){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(e);try{var t=new goog.global.XMLHttpRequest;return t.open("get",e,!1),t.send(),0==t.status||200==t.status?t.responseText:null}catch(e){return null}},goog.retrieveAndExec_=function(e,t,o){if(!COMPILED){var n=e;e=goog.normalizePath_(e);var r=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_,d=goog.loadFileSync_(e);if(null==d)throw Error('Load of "'+e+'" failed');o&&(d=goog.transpile_.call(goog.global,d,e)),d=t?goog.wrapModule_(e,d):d+("\n//# sourceURL="+e),goog.IS_OLD_IE_?(goog.dependencies_.deferred[n]=d,goog.queuedModules_.push(n)):r(e,d)}},goog.transpile_=function(a,b){var c=goog.global.$jscomp;c||(goog.global.$jscomp=c={});var d=c.transpile;if(!d){var e=goog.basePath+goog.TRANSPILER,f=goog.loadFileSync_(e);f&&(eval(f+"\n//# sourceURL="+e),c=goog.global.$jscomp,d=c.transpile)}return d||(d=c.transpile=function(e,t){return goog.logToConsole_(t+" requires transpilation but no transpiler was found."),e}),d(a,b)},goog.typeOf=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var o=Object.prototype.toString.call(e);if("[object Window]"==o)return"object";if("[object Array]"==o||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==o||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&"undefined"==typeof e.call)return"object";return t},goog.isNull=function(e){return null===e},goog.isDefAndNotNull=function(e){return null!=e},goog.isArray=function(e){return"array"==goog.typeOf(e)},goog.isArrayLike=function(e){var t=goog.typeOf(e);return"array"==t||"object"==t&&"number"==typeof e.length},goog.isDateLike=function(e){return goog.isObject(e)&&"function"==typeof e.getFullYear},goog.isString=function(e){return"string"==typeof e},goog.isBoolean=function(e){return"boolean"==typeof e},goog.isNumber=function(e){return"number"==typeof e},goog.isFunction=function(e){return"function"==goog.typeOf(e)},goog.isObject=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},goog.getUid=function(e){return e[goog.UID_PROPERTY_]||(e[goog.UID_PROPERTY_]=++goog.uidCounter_)},goog.hasUid=function(e){return!!e[goog.UID_PROPERTY_]},goog.removeUid=function(e){null!==e&&"removeAttribute"in e&&e.removeAttribute(goog.UID_PROPERTY_);try{delete e[goog.UID_PROPERTY_]}catch(e){}},goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0),goog.uidCounter_=0,goog.getHashCode=goog.getUid,goog.removeHashCode=goog.removeUid,goog.cloneObject=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if(e.clone)return e.clone();var o,t="array"==t?[]:{};for(o in e)t[o]=goog.cloneObject(e[o]);return t}return e},goog.bindNative_=function(e,t,o){return e.call.apply(e.bind,arguments)},goog.bindJs_=function(e,t,o){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var o=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(o,n),e.apply(t,o)}}return function(){return e.apply(t,arguments)}},goog.bind=function(e,t,o){return Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_,goog.bind.apply(null,arguments)},goog.partial=function(e,t){var o=Array.prototype.slice.call(arguments,1);return function(){var t=o.slice();return t.push.apply(t,arguments),e.apply(this,t)}},goog.mixin=function(e,t){for(var o in t)e[o]=t[o]},goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date},goog.globalEval=function(e){if(goog.global.execScript)goog.global.execScript(e,"JavaScript");else{if(!goog.global.eval)throw Error("goog.globalEval not available");if(null==goog.evalWorksForGlobals_)if(goog.global.eval("var _evalTest_ = 1;"),"undefined"!=typeof goog.global._evalTest_){try{delete goog.global._evalTest_}catch(e){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1;if(goog.evalWorksForGlobals_)goog.global.eval(e);else{var t=goog.global.document,o=t.createElement("SCRIPT");o.type="text/javascript",o.defer=!1,o.appendChild(t.createTextNode(e)),t.body.appendChild(o),t.body.removeChild(o)}}},goog.evalWorksForGlobals_=null,goog.getCssName=function(e,t){var o=function(e){return goog.cssNameMapping_[e]||e},n=function(e){e=e.split("-");for(var t=[],n=0;n<e.length;n++)t.push(o(e[n]));return t.join("-")},n=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?o:n:function(e){return e};return t?e+"-"+n(t):n(e)},goog.setCssNameMapping=function(e,t){goog.cssNameMapping_=e,goog.cssNameMappingStyle_=t},!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING),goog.getMsg=function(e,t){return t&&(e=e.replace(/\{\$([^}]+)}/g,function(e,o){return null!=t&&o in t?t[o]:e})),e},goog.getMsgWithFallback=function(e,t){return e},goog.exportSymbol=function(e,t,o){goog.exportPath_(e,t,o)},goog.exportProperty=function(e,t,o){e[t]=o},goog.inherits=function(e,t){function o(){}o.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new o,e.prototype.constructor=e,e.base=function(e,o,n){for(var r=Array(arguments.length-2),d=2;d<arguments.length;d++)r[d-2]=arguments[d];return t.prototype[o].apply(e,r)}},goog.base=function(e,t,o){var n=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!n)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(n.superClass_){for(var r=Array(arguments.length-1),d=1;d<arguments.length;d++)r[d-1]=arguments[d];return n.superClass_.constructor.apply(e,r)}for(r=Array(arguments.length-2),d=2;d<arguments.length;d++)r[d-2]=arguments[d];for(var d=!1,i=e.constructor;i;i=i.superClass_&&i.superClass_.constructor)if(i.prototype[t]===n)d=!0;else if(d)return i.prototype[t].apply(e,r);if(e[t]===n)return e.constructor.prototype[t].apply(e,r);throw Error("goog.base called from a method of one name to a method of a different name")},goog.scope=function(e){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a goog.module.");e.call(goog.global)},COMPILED||(goog.global.COMPILED=COMPILED),goog.defineClass=function(e,t){var o=t.constructor,n=t.statics;return o&&o!=Object.prototype.constructor||(o=function(){throw Error("cannot instantiate an interface (no constructor defined).")}),o=goog.defineClass.createSealingConstructor_(o,e),e&&goog.inherits(o,e),delete t.constructor,delete t.statics,goog.defineClass.applyProperties_(o.prototype,t),null!=n&&(n instanceof Function?n(o):goog.defineClass.applyProperties_(o,n)),o},goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG,goog.defineClass.createSealingConstructor_=function(e,t){if(!goog.defineClass.SEAL_CLASS_INSTANCES)return e;var o=!goog.defineClass.isUnsealable_(t),n=function(){var t=e.apply(this,arguments)||this;return t[goog.UID_PROPERTY_]=t[goog.UID_PROPERTY_],this.constructor===n&&o&&Object.seal instanceof Function&&Object.seal(t),t};return n},goog.defineClass.isUnsealable_=function(e){return e&&e.prototype&&e.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]},goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.defineClass.applyProperties_=function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);for(var n=0;n<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;n++)o=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[n],Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},goog.tagUnsealableClass=function(e){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(e.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)},goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable",goog.string={},goog.string.StringBuffer=function(e,t){null!=e&&this.append.apply(this,arguments)},goog.string.StringBuffer.prototype.buffer_="",goog.string.StringBuffer.prototype.set=function(e){this.buffer_=""+e},goog.string.StringBuffer.prototype.append=function(e,t,o){if(this.buffer_+=String(e),null!=t)for(var n=1;n<arguments.length;n++)this.buffer_+=arguments[n];return this},goog.string.StringBuffer.prototype.clear=function(){this.buffer_=""},goog.string.StringBuffer.prototype.getLength=function(){return this.buffer_.length},goog.string.StringBuffer.prototype.toString=function(){return this.buffer_},goog.debug={},goog.debug.Error=function(e){if(Error.captureStackTrace)Error.captureStackTrace(this,goog.debug.Error);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e)),this.reportErrorToServer=!0},goog.inherits(goog.debug.Error,Error),goog.debug.Error.prototype.name="CustomError",goog.dom={},goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},goog.string.DETECT_DOUBLE_ESCAPING=!1,goog.string.FORCE_NON_DOM_HTML_UNESCAPING=!1,goog.string.Unicode={NBSP:" "},goog.string.startsWith=function(e,t){return 0==e.lastIndexOf(t,0)},goog.string.endsWith=function(e,t){var o=e.length-t.length;return 0<=o&&e.indexOf(t,o)==o},goog.string.caseInsensitiveStartsWith=function(e,t){return 0==goog.string.caseInsensitiveCompare(t,e.substr(0,t.length))},goog.string.caseInsensitiveEndsWith=function(e,t){return 0==goog.string.caseInsensitiveCompare(t,e.substr(e.length-t.length,t.length))},goog.string.caseInsensitiveEquals=function(e,t){return e.toLowerCase()==t.toLowerCase()},goog.string.subs=function(e,t){for(var o=e.split("%s"),n="",r=Array.prototype.slice.call(arguments,1);r.length&&1<o.length;)n+=o.shift()+r.shift();return n+o.join("%s")},goog.string.collapseWhitespace=function(e){return e.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")},goog.string.isEmptyOrWhitespace=function(e){return/^[\s\xa0]*$/.test(e)},goog.string.isEmptyString=function(e){return 0==e.length},goog.string.isEmpty=goog.string.isEmptyOrWhitespace,goog.string.isEmptyOrWhitespaceSafe=function(e){return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(e))},goog.string.isEmptySafe=goog.string.isEmptyOrWhitespaceSafe,goog.string.isBreakingWhitespace=function(e){return!/[^\t\n\r ]/.test(e)},goog.string.isAlpha=function(e){return!/[^a-zA-Z]/.test(e)},goog.string.isNumeric=function(e){return!/[^0-9]/.test(e)},goog.string.isAlphaNumeric=function(e){return!/[^a-zA-Z0-9]/.test(e)},goog.string.isSpace=function(e){return" "==e},goog.string.isUnicodeChar=function(e){return 1==e.length&&" "<=e&&"~">=e||""<=e&&"�">=e},goog.string.stripNewlines=function(e){return e.replace(/(\r\n|\r|\n)+/g," ")},goog.string.canonicalizeNewlines=function(e){return e.replace(/(\r\n|\r|\n)/g,"\n")},goog.string.normalizeWhitespace=function(e){return e.replace(/\xa0|\s/g," ")},goog.string.normalizeSpaces=function(e){return e.replace(/\xa0|[ \t]+/g," ")},goog.string.collapseBreakingSpaces=function(e){return e.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")},goog.string.trim=goog.TRUSTED_SITE&&String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},goog.string.trimLeft=function(e){return e.replace(/^[\s\xa0]+/,"")},goog.string.trimRight=function(e){return e.replace(/[\s\xa0]+$/,"")},goog.string.caseInsensitiveCompare=function(e,t){var o=String(e).toLowerCase(),n=String(t).toLowerCase();return o<n?-1:o==n?0:1},goog.string.numberAwareCompare_=function(e,t,o){if(e==t)return 0;if(!e)return-1;if(!t)return 1;for(var n=e.toLowerCase().match(o),r=t.toLowerCase().match(o),d=Math.min(n.length,r.length),i=0;i<d;i++){o=n[i];var a=r[i];if(o!=a)return e=parseInt(o,10),!isNaN(e)&&(t=parseInt(a,10),!isNaN(t)&&e-t)?e-t:o<a?-1:1}return n.length!=r.length?n.length-r.length:e<t?-1:1},goog.string.intAwareCompare=function(e,t){return goog.string.numberAwareCompare_(e,t,/\d+|\D+/g)},goog.string.floatAwareCompare=function(e,t){return goog.string.numberAwareCompare_(e,t,/\d+|\.\d+|\D+/g)},goog.string.numerateCompare=goog.string.floatAwareCompare,goog.string.urlEncode=function(e){return encodeURIComponent(String(e))},goog.string.urlDecode=function(e){return decodeURIComponent(e.replace(/\+/g," "))},goog.string.newLineToBr=function(e,t){return e.replace(/(\r\n|\r|\n)/g,t?"<br />":"<br>")},goog.string.htmlEscape=function(e,t){if(t)e=e.replace(goog.string.AMP_RE_,"&amp;").replace(goog.string.LT_RE_,"&lt;").replace(goog.string.GT_RE_,"&gt;").replace(goog.string.QUOT_RE_,"&quot;").replace(goog.string.SINGLE_QUOTE_RE_,"&#39;").replace(goog.string.NULL_RE_,"&#0;"),goog.string.DETECT_DOUBLE_ESCAPING&&(e=e.replace(goog.string.E_RE_,"&#101;"));else{if(!goog.string.ALL_RE_.test(e))return e;-1!=e.indexOf("&")&&(e=e.replace(goog.string.AMP_RE_,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(goog.string.LT_RE_,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(goog.string.GT_RE_,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(goog.string.QUOT_RE_,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(goog.string.SINGLE_QUOTE_RE_,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(goog.string.NULL_RE_,"&#0;")),goog.string.DETECT_DOUBLE_ESCAPING&&-1!=e.indexOf("e")&&(e=e.replace(goog.string.E_RE_,"&#101;"))}return e},goog.string.AMP_RE_=/&/g,goog.string.LT_RE_=/</g,goog.string.GT_RE_=/>/g,goog.string.QUOT_RE_=/"/g,goog.string.SINGLE_QUOTE_RE_=/'/g,goog.string.NULL_RE_=/\x00/g,goog.string.E_RE_=/e/g,goog.string.ALL_RE_=goog.string.DETECT_DOUBLE_ESCAPING?/[\x00&<>"'e]/:/[\x00&<>"']/,goog.string.unescapeEntities=function(e){return goog.string.contains(e,"&")?!goog.string.FORCE_NON_DOM_HTML_UNESCAPING&&"document"in goog.global?goog.string.unescapeEntitiesUsingDom_(e):goog.string.unescapePureXmlEntities_(e):e},goog.string.unescapeEntitiesWithDocument=function(e,t){return goog.string.contains(e,"&")?goog.string.unescapeEntitiesUsingDom_(e,t):e},goog.string.unescapeEntitiesUsingDom_=function(e,t){var o,n={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'};return o=t?t.createElement("div"):goog.global.document.createElement("div"),e.replace(goog.string.HTML_ENTITY_PATTERN_,function(e,t){var r=n[e];if(r)return r;if("#"==t.charAt(0)){var d=Number("0"+t.substr(1));isNaN(d)||(r=String.fromCharCode(d))}return r||(o.innerHTML=e+" ",r=o.firstChild.nodeValue.slice(0,-1)),n[e]=r})},goog.string.unescapePureXmlEntities_=function(e){return e.replace(/&([^;]+);/g,function(e,t){switch(t){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:if("#"==t.charAt(0)){var o=Number("0"+t.substr(1));if(!isNaN(o))return String.fromCharCode(o)}return e}})},goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g,goog.string.whitespaceEscape=function(e,t){return goog.string.newLineToBr(e.replace(/  /g," &#160;"),t)},goog.string.preserveSpaces=function(e){return e.replace(/(^|[\n ]) /g,"$1"+goog.string.Unicode.NBSP)},goog.string.stripQuotes=function(e,t){for(var o=t.length,n=0;n<o;n++){var r=1==o?t:t.charAt(n);if(e.charAt(0)==r&&e.charAt(e.length-1)==r)return e.substring(1,e.length-1)}return e},goog.string.truncate=function(e,t,o){return o&&(e=goog.string.unescapeEntities(e)),e.length>t&&(e=e.substring(0,t-3)+"..."),o&&(e=goog.string.htmlEscape(e)),e},goog.string.truncateMiddle=function(e,t,o,n){if(o&&(e=goog.string.unescapeEntities(e)),n&&e.length>t){n>t&&(n=t);var r=e.length-n;e=e.substring(0,t-n)+"..."+e.substring(r)}else e.length>t&&(n=Math.floor(t/2),r=e.length-n,e=e.substring(0,n+t%2)+"..."+e.substring(r));return o&&(e=goog.string.htmlEscape(e)),e},goog.string.specialEscapeChars_={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\x0B",'"':'\\"',"\\":"\\\\","<":"<"},goog.string.jsEscapeCache_={"'":"\\'"},goog.string.quote=function(e){e=String(e);for(var t=['"'],o=0;o<e.length;o++){var n=e.charAt(o),r=n.charCodeAt(0);t[o+1]=goog.string.specialEscapeChars_[n]||(31<r&&127>r?n:goog.string.escapeChar(n))}return t.push('"'),t.join("")},goog.string.escapeString=function(e){for(var t=[],o=0;o<e.length;o++)t[o]=goog.string.escapeChar(e.charAt(o));return t.join("")},goog.string.escapeChar=function(e){if(e in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[e];if(e in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[e]=goog.string.specialEscapeChars_[e];var t,o=e.charCodeAt(0);return 31<o&&127>o?t=e:(256>o?(t="\\x",(16>o||256<o)&&(t+="0")):(t="\\u",4096>o&&(t+="0")),t+=o.toString(16).toUpperCase()),goog.string.jsEscapeCache_[e]=t},goog.string.contains=function(e,t){return-1!=e.indexOf(t)},goog.string.caseInsensitiveContains=function(e,t){return goog.string.contains(e.toLowerCase(),t.toLowerCase())},goog.string.countOf=function(e,t){return e&&t?e.split(t).length-1:0},goog.string.removeAt=function(e,t,o){var n=e;return 0<=t&&t<e.length&&0<o&&(n=e.substr(0,t)+e.substr(t+o,e.length-t-o)),n},goog.string.remove=function(e,t){var o=new RegExp(goog.string.regExpEscape(t),"");return e.replace(o,"")},goog.string.removeAll=function(e,t){var o=new RegExp(goog.string.regExpEscape(t),"g");return e.replace(o,"")},goog.string.regExpEscape=function(e){return String(e).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},goog.string.repeat=String.prototype.repeat?function(e,t){return e.repeat(t)}:function(e,t){return Array(t+1).join(e)},goog.string.padNumber=function(e,t,o){return e=goog.isDef(o)?e.toFixed(o):String(e),o=e.indexOf("."),-1==o&&(o=e.length),goog.string.repeat("0",Math.max(0,t-o))+e},goog.string.makeSafe=function(e){return null==e?"":String(e)},goog.string.buildString=function(e){return Array.prototype.join.call(arguments,"")},goog.string.getRandomString=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^goog.now()).toString(36)},goog.string.compareVersions=function(e,t){for(var o=0,n=goog.string.trim(String(e)).split("."),r=goog.string.trim(String(t)).split("."),d=Math.max(n.length,r.length),i=0;0==o&&i<d;i++){var a=n[i]||"",N=r[i]||"",u=RegExp("(\\d*)(\\D*)","g"),s=RegExp("(\\d*)(\\D*)","g");do{var A=u.exec(a)||["","",""],g=s.exec(N)||["","",""];if(0==A[0].length&&0==g[0].length)break;var o=0==A[1].length?0:parseInt(A[1],10),l=0==g[1].length?0:parseInt(g[1],10),o=goog.string.compareElements_(o,l)||goog.string.compareElements_(0==A[2].length,0==g[2].length)||goog.string.compareElements_(A[2],g[2])}while(0==o)}return o},goog.string.compareElements_=function(e,t){return e<t?-1:e>t?1:0},goog.string.hashCode=function(e){for(var t=0,o=0;o<e.length;++o)t=31*t+e.charCodeAt(o)>>>0;return t},goog.string.uniqueStringCounter_=2147483648*Math.random()|0,goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++},goog.string.toNumber=function(e){var t=Number(e);return 0==t&&goog.string.isEmptyOrWhitespace(e)?NaN:t},goog.string.isLowerCamelCase=function(e){return/^[a-z]+([A-Z][a-z]*)*$/.test(e)},goog.string.isUpperCamelCase=function(e){return/^([A-Z][a-z]*)+$/.test(e)},goog.string.toCamelCase=function(e){return String(e).replace(/\-([a-z])/g,function(e,t){return t.toUpperCase()})},goog.string.toSelectorCase=function(e){return String(e).replace(/([A-Z])/g,"-$1").toLowerCase()},goog.string.toTitleCase=function(e,t){var o=goog.isString(t)?goog.string.regExpEscape(t):"\\s";return e.replace(new RegExp("(^"+(o?"|["+o+"]+":"")+")([a-z])","g"),function(e,t,o){return t+o.toUpperCase()})},goog.string.capitalize=function(e){return String(e.charAt(0)).toUpperCase()+String(e.substr(1)).toLowerCase()},goog.string.parseInt=function(e){return isFinite(e)&&(e=String(e)),goog.isString(e)?/^\s*-?0x/i.test(e)?parseInt(e,16):parseInt(e,10):NaN},goog.string.splitLimit=function(e,t,o){e=e.split(t);for(var n=[];0<o&&e.length;)n.push(e.shift()),o--;return e.length&&n.push(e.join(t)),n},goog.string.lastComponent=function(e,t){if(!t)return e;"string"==typeof t&&(t=[t]);for(var o=-1,n=0;n<t.length;n++)if(""!=t[n]){var r=e.lastIndexOf(t[n]);r>o&&(o=r)}return-1==o?e:e.slice(o+1)},goog.string.editDistance=function(e,t){var o=[],n=[];if(e==t)return 0;if(!e.length||!t.length)return Math.max(e.length,t.length);for(var r=0;r<t.length+1;r++)o[r]=r;for(r=0;r<e.length;r++){n[0]=r+1;for(var d=0;d<t.length;d++)n[d+1]=Math.min(n[d]+1,o[d+1]+1,o[d]+Number(e[r]!=t[d]));for(d=0;d<o.length;d++)o[d]=n[d]}return n[t.length]},goog.asserts={},goog.asserts.ENABLE_ASSERTS=goog.DEBUG,goog.asserts.AssertionError=function(e,t){t.unshift(e),goog.debug.Error.call(this,goog.string.subs.apply(null,t)),t.shift(),this.messagePattern=e},goog.inherits(goog.asserts.AssertionError,goog.debug.Error),goog.asserts.AssertionError.prototype.name="AssertionError";goog.asserts.DEFAULT_ERROR_HANDLER=function(e){throw e;
};goog.asserts.errorHandler_=goog.asserts.DEFAULT_ERROR_HANDLER,goog.asserts.doAssertFailure_=function(e,t,o,n){var r="Assertion failed";if(o)var r=r+(": "+o),d=n;else e&&(r+=": "+e,d=t);e=new goog.asserts.AssertionError(""+r,d||[]),goog.asserts.errorHandler_(e)},goog.asserts.setErrorHandler=function(e){goog.asserts.ENABLE_ASSERTS&&(goog.asserts.errorHandler_=e)},goog.asserts.assert=function(e,t,o){return goog.asserts.ENABLE_ASSERTS&&!e&&goog.asserts.doAssertFailure_("",null,t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.fail=function(e,t){goog.asserts.ENABLE_ASSERTS&&goog.asserts.errorHandler_(new goog.asserts.AssertionError("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1)))},goog.asserts.assertNumber=function(e,t,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(e)&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertString=function(e,t,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isString(e)&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertFunction=function(e,t,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(e)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertObject=function(e,t,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isObject(e)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertArray=function(e,t,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isArray(e)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertBoolean=function(e,t,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(e)&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertElement=function(e,t,o){return!goog.asserts.ENABLE_ASSERTS||goog.isObject(e)&&e.nodeType==goog.dom.NodeType.ELEMENT||goog.asserts.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertInstanceof=function(e,t,o,n){return!goog.asserts.ENABLE_ASSERTS||e instanceof t||goog.asserts.doAssertFailure_("Expected instanceof %s but got %s.",[goog.asserts.getType_(t),goog.asserts.getType_(e)],o,Array.prototype.slice.call(arguments,3)),e},goog.asserts.assertObjectPrototypeIsIntact=function(){for(var e in Object.prototype)goog.asserts.fail(e+" should not be enumerable in Object.prototype.")},goog.asserts.getType_=function(e){return e instanceof Function?e.displayName||e.name||"unknown type name":e instanceof Object?e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e):null===e?"null":typeof e},goog.array={},goog.NATIVE_ARRAY_PROTOTYPES=goog.TRUSTED_SITE,goog.array.ASSUME_NATIVE_FUNCTIONS=!1,goog.array.peek=function(e){return e[e.length-1]},goog.array.last=goog.array.peek,goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.indexOf)?function(e,t,o){return goog.asserts.assert(null!=e.length),Array.prototype.indexOf.call(e,t,o)}:function(e,t,o){if(o=null==o?0:0>o?Math.max(0,e.length+o):o,goog.isString(e))return goog.isString(t)&&1==t.length?e.indexOf(t,o):-1;for(;o<e.length;o++)if(o in e&&e[o]===t)return o;return-1},goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.lastIndexOf)?function(e,t,o){return goog.asserts.assert(null!=e.length),Array.prototype.lastIndexOf.call(e,t,null==o?e.length-1:o)}:function(e,t,o){if(o=null==o?e.length-1:o,0>o&&(o=Math.max(0,e.length+o)),goog.isString(e))return goog.isString(t)&&1==t.length?e.lastIndexOf(t,o):-1;for(;0<=o;o--)if(o in e&&e[o]===t)return o;return-1},goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.forEach)?function(e,t,o){goog.asserts.assert(null!=e.length),Array.prototype.forEach.call(e,t,o)}:function(e,t,o){for(var n=e.length,r=goog.isString(e)?e.split(""):e,d=0;d<n;d++)d in r&&t.call(o,r[d],d,e)},goog.array.forEachRight=function(e,t,o){for(var n=e.length,r=goog.isString(e)?e.split(""):e,n=n-1;0<=n;--n)n in r&&t.call(o,r[n],n,e)},goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.filter)?function(e,t,o){return goog.asserts.assert(null!=e.length),Array.prototype.filter.call(e,t,o)}:function(e,t,o){for(var n=e.length,r=[],d=0,i=goog.isString(e)?e.split(""):e,a=0;a<n;a++)if(a in i){var N=i[a];t.call(o,N,a,e)&&(r[d++]=N)}return r},goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.map)?function(e,t,o){return goog.asserts.assert(null!=e.length),Array.prototype.map.call(e,t,o)}:function(e,t,o){for(var n=e.length,r=Array(n),d=goog.isString(e)?e.split(""):e,i=0;i<n;i++)i in d&&(r[i]=t.call(o,d[i],i,e));return r},goog.array.reduce=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduce)?function(e,t,o,n){return goog.asserts.assert(null!=e.length),n&&(t=goog.bind(t,n)),Array.prototype.reduce.call(e,t,o)}:function(e,t,o,n){var r=o;return goog.array.forEach(e,function(o,d){r=t.call(n,r,o,d,e)}),r},goog.array.reduceRight=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduceRight)?function(e,t,o,n){return goog.asserts.assert(null!=e.length),goog.asserts.assert(null!=t),n&&(t=goog.bind(t,n)),Array.prototype.reduceRight.call(e,t,o)}:function(e,t,o,n){var r=o;return goog.array.forEachRight(e,function(o,d){r=t.call(n,r,o,d,e)}),r},goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.some)?function(e,t,o){return goog.asserts.assert(null!=e.length),Array.prototype.some.call(e,t,o)}:function(e,t,o){for(var n=e.length,r=goog.isString(e)?e.split(""):e,d=0;d<n;d++)if(d in r&&t.call(o,r[d],d,e))return!0;return!1},goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.every)?function(e,t,o){return goog.asserts.assert(null!=e.length),Array.prototype.every.call(e,t,o)}:function(e,t,o){for(var n=e.length,r=goog.isString(e)?e.split(""):e,d=0;d<n;d++)if(d in r&&!t.call(o,r[d],d,e))return!1;return!0},goog.array.count=function(e,t,o){var n=0;return goog.array.forEach(e,function(e,r,d){t.call(o,e,r,d)&&++n},o),n},goog.array.find=function(e,t,o){return t=goog.array.findIndex(e,t,o),0>t?null:goog.isString(e)?e.charAt(t):e[t]},goog.array.findIndex=function(e,t,o){for(var n=e.length,r=goog.isString(e)?e.split(""):e,d=0;d<n;d++)if(d in r&&t.call(o,r[d],d,e))return d;return-1},goog.array.findRight=function(e,t,o){return t=goog.array.findIndexRight(e,t,o),0>t?null:goog.isString(e)?e.charAt(t):e[t]},goog.array.findIndexRight=function(e,t,o){for(var n=e.length,r=goog.isString(e)?e.split(""):e,n=n-1;0<=n;n--)if(n in r&&t.call(o,r[n],n,e))return n;return-1},goog.array.contains=function(e,t){return 0<=goog.array.indexOf(e,t)},goog.array.isEmpty=function(e){return 0==e.length},goog.array.clear=function(e){if(!goog.isArray(e))for(var t=e.length-1;0<=t;t--)delete e[t];e.length=0},goog.array.insert=function(e,t){goog.array.contains(e,t)||e.push(t)},goog.array.insertAt=function(e,t,o){goog.array.splice(e,o,0,t)},goog.array.insertArrayAt=function(e,t,o){goog.partial(goog.array.splice,e,o,0).apply(null,t)},goog.array.insertBefore=function(e,t,o){var n;2==arguments.length||0>(n=goog.array.indexOf(e,o))?e.push(t):goog.array.insertAt(e,t,n)},goog.array.remove=function(e,t){var o,n=goog.array.indexOf(e,t);return(o=0<=n)&&goog.array.removeAt(e,n),o},goog.array.removeLast=function(e,t){var o=goog.array.lastIndexOf(e,t);return 0<=o&&(goog.array.removeAt(e,o),!0)},goog.array.removeAt=function(e,t){return goog.asserts.assert(null!=e.length),1==Array.prototype.splice.call(e,t,1).length},goog.array.removeIf=function(e,t,o){return t=goog.array.findIndex(e,t,o),0<=t&&(goog.array.removeAt(e,t),!0)},goog.array.removeAllIf=function(e,t,o){var n=0;return goog.array.forEachRight(e,function(r,d){t.call(o,r,d,e)&&goog.array.removeAt(e,d)&&n++}),n},goog.array.concat=function(e){return Array.prototype.concat.apply(Array.prototype,arguments)},goog.array.join=function(e){return Array.prototype.concat.apply(Array.prototype,arguments)},goog.array.toArray=function(e){var t=e.length;if(0<t){for(var o=Array(t),n=0;n<t;n++)o[n]=e[n];return o}return[]},goog.array.clone=goog.array.toArray,goog.array.extend=function(e,t){for(var o=1;o<arguments.length;o++){var n=arguments[o];if(goog.isArrayLike(n)){var r=e.length||0,d=n.length||0;e.length=r+d;for(var i=0;i<d;i++)e[r+i]=n[i]}else e.push(n)}},goog.array.splice=function(e,t,o,n){return goog.asserts.assert(null!=e.length),Array.prototype.splice.apply(e,goog.array.slice(arguments,1))},goog.array.slice=function(e,t,o){return goog.asserts.assert(null!=e.length),2>=arguments.length?Array.prototype.slice.call(e,t):Array.prototype.slice.call(e,t,o)},goog.array.removeDuplicates=function(e,t,o){t=t||e;var n=function(e){return goog.isObject(e)?"o"+goog.getUid(e):(typeof e).charAt(0)+e};o=o||n;for(var n={},r=0,d=0;d<e.length;){var i=e[d++],a=o(i);Object.prototype.hasOwnProperty.call(n,a)||(n[a]=!0,t[r++]=i)}t.length=r},goog.array.binarySearch=function(e,t,o){return goog.array.binarySearch_(e,o||goog.array.defaultCompare,!1,t)},goog.array.binarySelect=function(e,t,o){return goog.array.binarySearch_(e,t,!0,void 0,o)},goog.array.binarySearch_=function(e,t,o,n,r){for(var d,i=0,a=e.length;i<a;){var N,u=i+a>>1;N=o?t.call(r,e[u],u,e):t(n,e[u]),0<N?i=u+1:(a=u,d=!N)}return d?i:~i},goog.array.sort=function(e,t){e.sort(t||goog.array.defaultCompare)},goog.array.stableSort=function(e,t){for(var o=Array(e.length),n=0;n<e.length;n++)o[n]={index:n,value:e[n]};var r=t||goog.array.defaultCompare;for(goog.array.sort(o,function(e,t){return r(e.value,t.value)||e.index-t.index}),n=0;n<e.length;n++)e[n]=o[n].value},goog.array.sortByKey=function(e,t,o){var n=o||goog.array.defaultCompare;goog.array.sort(e,function(e,o){return n(t(e),t(o))})},goog.array.sortObjectsByKey=function(e,t,o){goog.array.sortByKey(e,function(e){return e[t]},o)},goog.array.isSorted=function(e,t,o){t=t||goog.array.defaultCompare;for(var n=1;n<e.length;n++){var r=t(e[n-1],e[n]);if(0<r||0==r&&o)return!1}return!0},goog.array.equals=function(e,t,o){if(!goog.isArrayLike(e)||!goog.isArrayLike(t)||e.length!=t.length)return!1;var n=e.length;o=o||goog.array.defaultCompareEquality;for(var r=0;r<n;r++)if(!o(e[r],t[r]))return!1;return!0},goog.array.compare3=function(e,t,o){o=o||goog.array.defaultCompare;for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var d=o(e[r],t[r]);if(0!=d)return d}return goog.array.defaultCompare(e.length,t.length)},goog.array.defaultCompare=function(e,t){return e>t?1:e<t?-1:0},goog.array.inverseDefaultCompare=function(e,t){return-goog.array.defaultCompare(e,t)},goog.array.defaultCompareEquality=function(e,t){return e===t},goog.array.binaryInsert=function(e,t,o){return o=goog.array.binarySearch(e,t,o),0>o&&(goog.array.insertAt(e,t,-(o+1)),!0)},goog.array.binaryRemove=function(e,t,o){return t=goog.array.binarySearch(e,t,o),0<=t&&goog.array.removeAt(e,t)},goog.array.bucket=function(e,t,o){for(var n={},r=0;r<e.length;r++){var d=e[r],i=t.call(o,d,r,e);goog.isDef(i)&&(n[i]||(n[i]=[])).push(d)}return n},goog.array.toObject=function(e,t,o){var n={};return goog.array.forEach(e,function(r,d){n[t.call(o,r,d,e)]=r}),n},goog.array.range=function(e,t,o){var n=[],r=0,d=e;if(o=o||1,void 0!==t&&(r=e,d=t),0>o*(d-r))return[];if(0<o)for(e=r;e<d;e+=o)n.push(e);else for(e=r;e>d;e+=o)n.push(e);return n},goog.array.repeat=function(e,t){for(var o=[],n=0;n<t;n++)o[n]=e;return o},goog.array.flatten=function(e){for(var t=[],o=0;o<arguments.length;o++){var n=arguments[o];if(goog.isArray(n))for(var r=0;r<n.length;r+=8192)for(var d=goog.array.slice(n,r,r+8192),d=goog.array.flatten.apply(null,d),i=0;i<d.length;i++)t.push(d[i]);else t.push(n)}return t},goog.array.rotate=function(e,t){return goog.asserts.assert(null!=e.length),e.length&&(t%=e.length,0<t?Array.prototype.unshift.apply(e,e.splice(-t,t)):0>t&&Array.prototype.push.apply(e,e.splice(0,-t))),e},goog.array.moveItem=function(e,t,o){goog.asserts.assert(0<=t&&t<e.length),goog.asserts.assert(0<=o&&o<e.length),t=Array.prototype.splice.call(e,t,1),Array.prototype.splice.call(e,o,0,t[0])},goog.array.zip=function(e){if(!arguments.length)return[];for(var t=[],o=arguments[0].length,n=1;n<arguments.length;n++)arguments[n].length<o&&(o=arguments[n].length);for(n=0;n<o;n++){for(var r=[],d=0;d<arguments.length;d++)r.push(arguments[d][n]);t.push(r)}return t},goog.array.shuffle=function(e,t){for(var o=t||Math.random,n=e.length-1;0<n;n--){var r=Math.floor(o()*(n+1)),d=e[n];e[n]=e[r],e[r]=d}},goog.array.copyByIndex=function(e,t){var o=[];return goog.array.forEach(t,function(t){o.push(e[t])}),o},goog.array.concatMap=function(e,t,o){return goog.array.concat.apply([],goog.array.map(e,t,o))},goog.proto2={},goog.proto2.FieldDescriptor=function(e,t,o){switch(this.parent_=e,goog.asserts.assert(goog.string.isNumeric(t)),this.tag_=t,this.name_=o.name,this.isPacked_=!!o.packed,this.isRepeated_=!!o.repeated,this.isRequired_=!!o.required,this.fieldType_=o.fieldType,this.nativeType_=o.type,this.deserializationConversionPermitted_=!1,this.fieldType_){case goog.proto2.FieldDescriptor.FieldType.INT64:case goog.proto2.FieldDescriptor.FieldType.UINT64:case goog.proto2.FieldDescriptor.FieldType.FIXED64:case goog.proto2.FieldDescriptor.FieldType.SFIXED64:case goog.proto2.FieldDescriptor.FieldType.SINT64:case goog.proto2.FieldDescriptor.FieldType.FLOAT:case goog.proto2.FieldDescriptor.FieldType.DOUBLE:this.deserializationConversionPermitted_=!0}this.defaultValue_=o.defaultValue},goog.proto2.FieldDescriptor.FieldType={DOUBLE:1,FLOAT:2,INT64:3,UINT64:4,INT32:5,FIXED64:6,FIXED32:7,BOOL:8,STRING:9,GROUP:10,MESSAGE:11,BYTES:12,UINT32:13,ENUM:14,SFIXED32:15,SFIXED64:16,SINT32:17,SINT64:18},goog.proto2.FieldDescriptor.prototype.getTag=function(){return this.tag_},goog.proto2.FieldDescriptor.prototype.getContainingType=function(){return this.parent_.prototype.getDescriptor()},goog.proto2.FieldDescriptor.prototype.getName=function(){return this.name_},goog.proto2.FieldDescriptor.prototype.getDefaultValue=function(){if(void 0===this.defaultValue_){var e=this.nativeType_;if(e===Boolean)this.defaultValue_=!1;else if(e===Number)this.defaultValue_=0;else{if(e!==String)return new e;this.defaultValue_=this.deserializationConversionPermitted_?"0":""}}return this.defaultValue_},goog.proto2.FieldDescriptor.prototype.getFieldType=function(){return this.fieldType_},goog.proto2.FieldDescriptor.prototype.getNativeType=function(){return this.nativeType_},goog.proto2.FieldDescriptor.prototype.deserializationConversionPermitted=function(){return this.deserializationConversionPermitted_},goog.proto2.FieldDescriptor.prototype.getFieldMessageType=function(){return this.nativeType_.prototype.getDescriptor()},goog.proto2.FieldDescriptor.prototype.isCompositeType=function(){return this.fieldType_==goog.proto2.FieldDescriptor.FieldType.MESSAGE||this.fieldType_==goog.proto2.FieldDescriptor.FieldType.GROUP},goog.proto2.FieldDescriptor.prototype.isPacked=function(){return this.isPacked_},goog.proto2.FieldDescriptor.prototype.isRepeated=function(){return this.isRepeated_},goog.proto2.FieldDescriptor.prototype.isRequired=function(){return this.isRequired_},goog.proto2.FieldDescriptor.prototype.isOptional=function(){return!this.isRepeated_&&!this.isRequired_},goog.object={},goog.object.is=function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t},goog.object.forEach=function(e,t,o){for(var n in e)t.call(o,e[n],n,e)},goog.object.filter=function(e,t,o){var n,r={};for(n in e)t.call(o,e[n],n,e)&&(r[n]=e[n]);return r},goog.object.map=function(e,t,o){var n,r={};for(n in e)r[n]=t.call(o,e[n],n,e);return r},goog.object.some=function(e,t,o){for(var n in e)if(t.call(o,e[n],n,e))return!0;return!1},goog.object.every=function(e,t,o){for(var n in e)if(!t.call(o,e[n],n,e))return!1;return!0},goog.object.getCount=function(e){var t,o=0;for(t in e)o++;return o},goog.object.getAnyKey=function(e){for(var t in e)return t},goog.object.getAnyValue=function(e){for(var t in e)return e[t]},goog.object.contains=function(e,t){return goog.object.containsValue(e,t)},goog.object.getValues=function(e){var t,o=[],n=0;for(t in e)o[n++]=e[t];return o},goog.object.getKeys=function(e){var t,o=[],n=0;for(t in e)o[n++]=t;return o},goog.object.getValueByKeys=function(e,t){for(var o=goog.isArrayLike(t),n=o?t:arguments,o=o?0:1;o<n.length&&(e=e[n[o]],goog.isDef(e));o++);return e},goog.object.containsKey=function(e,t){return null!==e&&t in e},goog.object.containsValue=function(e,t){for(var o in e)if(e[o]==t)return!0;return!1},goog.object.findKey=function(e,t,o){for(var n in e)if(t.call(o,e[n],n,e))return n},goog.object.findValue=function(e,t,o){return(t=goog.object.findKey(e,t,o))&&e[t]},goog.object.isEmpty=function(e){for(var t in e)return!1;return!0},goog.object.clear=function(e){for(var t in e)delete e[t]},goog.object.remove=function(e,t){var o;return(o=t in e)&&delete e[t],o},goog.object.add=function(e,t,o){if(null!==e&&t in e)throw Error('The object already contains the key "'+t+'"');goog.object.set(e,t,o)},goog.object.get=function(e,t,o){return null!==e&&t in e?e[t]:o},goog.object.set=function(e,t,o){e[t]=o},goog.object.setIfUndefined=function(e,t,o){return t in e?e[t]:e[t]=o},goog.object.setWithReturnValueIfNotSet=function(e,t,o){return t in e?e[t]:(o=o(),e[t]=o)},goog.object.equals=function(e,t){for(var o in e)if(!(o in t)||e[o]!==t[o])return!1;for(o in t)if(!(o in e))return!1;return!0},goog.object.clone=function(e){var t,o={};for(t in e)o[t]=e[t];return o},goog.object.unsafeClone=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if(goog.isFunction(e.clone))return e.clone();var o,t="array"==t?[]:{};for(o in e)t[o]=goog.object.unsafeClone(e[o]);return t}return e},goog.object.transpose=function(e){var t,o={};for(t in e)o[e[t]]=t;return o},goog.object.PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.object.extend=function(e,t){for(var o,n,r=1;r<arguments.length;r++){n=arguments[r];for(o in n)e[o]=n[o];for(var d=0;d<goog.object.PROTOTYPE_FIELDS_.length;d++)o=goog.object.PROTOTYPE_FIELDS_[d],Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}},goog.object.create=function(e){var t=arguments.length;if(1==t&&goog.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(t%2)throw Error("Uneven number of arguments");for(var o={},n=0;n<t;n+=2)o[arguments[n]]=arguments[n+1];return o},goog.object.createSet=function(e){var t=arguments.length;if(1==t&&goog.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);for(var o={},n=0;n<t;n++)o[arguments[n]]=!0;return o},goog.object.createImmutableView=function(e){var t=e;return Object.isFrozen&&!Object.isFrozen(e)&&(t=Object.create(e),Object.freeze(t)),t},goog.object.isImmutableView=function(e){return!!Object.isFrozen&&Object.isFrozen(e)},goog.proto2.Descriptor=function(e,t,o){for(this.messageType_=e,this.name_=t.name||null,this.fullName_=t.fullName||null,this.containingType_=t.containingType,this.fields_={},e=0;e<o.length;e++)t=o[e],this.fields_[t.getTag()]=t},goog.proto2.Descriptor.prototype.getName=function(){return this.name_},goog.proto2.Descriptor.prototype.getFullName=function(){return this.fullName_},goog.proto2.Descriptor.prototype.getContainingType=function(){return this.containingType_?this.containingType_.getDescriptor():null},goog.proto2.Descriptor.prototype.getFields=function(){var e=goog.object.getValues(this.fields_);return goog.array.sort(e,function(e,t){return e.getTag()-t.getTag()}),e},goog.proto2.Descriptor.prototype.getFieldsMap=function(){return this.fields_},goog.proto2.Descriptor.prototype.findFieldByName=function(e){return goog.object.findValue(this.fields_,function(t,o,n){return t.getName()==e})||null},goog.proto2.Descriptor.prototype.findFieldByTag=function(e){return goog.asserts.assert(goog.string.isNumeric(e)),this.fields_[parseInt(e,10)]||null},goog.proto2.Descriptor.prototype.createMessageInstance=function(){return new this.messageType_},goog.proto2.Message=function(){this.values_={},this.fields_=this.getDescriptor().getFieldsMap(),this.deserializedFields_=this.lazyDeserializer_=null},goog.proto2.Message.FieldType={DOUBLE:1,FLOAT:2,INT64:3,UINT64:4,INT32:5,FIXED64:6,FIXED32:7,BOOL:8,STRING:9,GROUP:10,MESSAGE:11,BYTES:12,UINT32:13,ENUM:14,SFIXED32:15,SFIXED64:16,SINT32:17,SINT64:18},goog.proto2.Message.prototype.initializeForLazyDeserializer=function(e,t){this.lazyDeserializer_=e,this.values_=t,this.deserializedFields_={}},goog.proto2.Message.prototype.setUnknown=function(e,t){goog.asserts.assert(!this.fields_[e],"Field is not unknown in this message"),goog.asserts.assert(1<=e,"Tag "+e+' has value "'+t+'" in descriptor '+this.getDescriptor().getName()),goog.asserts.assert(null!==t,"Value cannot be null"),this.values_[e]=t,this.deserializedFields_&&delete this.deserializedFields_[e]},goog.proto2.Message.prototype.forEachUnknown=function(e,t){var o,n=t||this;for(o in this.values_){var r=Number(o);this.fields_[r]||e.call(n,r,this.values_[o])}},goog.proto2.Message.prototype.has=function(e){return goog.asserts.assert(e.getContainingType()==this.getDescriptor(),"The current message does not contain the given field"),this.has$Value(e.getTag())},goog.proto2.Message.prototype.arrayOf=function(e){return goog.asserts.assert(e.getContainingType()==this.getDescriptor(),"The current message does not contain the given field"),this.array$Values(e.getTag())},goog.proto2.Message.prototype.countOf=function(e){return goog.asserts.assert(e.getContainingType()==this.getDescriptor(),"The current message does not contain the given field"),this.count$Values(e.getTag())},goog.proto2.Message.prototype.get=function(e,t){return goog.asserts.assert(e.getContainingType()==this.getDescriptor(),"The current message does not contain the given field"),this.get$Value(e.getTag(),t)},goog.proto2.Message.prototype.getOrDefault=function(e,t){return goog.asserts.assert(e.getContainingType()==this.getDescriptor(),"The current message does not contain the given field"),this.get$ValueOrDefault(e.getTag(),t)},goog.proto2.Message.prototype.set=function(e,t){goog.asserts.assert(e.getContainingType()==this.getDescriptor(),"The current message does not contain the given field"),this.set$Value(e.getTag(),t)},goog.proto2.Message.prototype.add=function(e,t){goog.asserts.assert(e.getContainingType()==this.getDescriptor(),"The current message does not contain the given field"),this.add$Value(e.getTag(),t)},goog.proto2.Message.prototype.clear=function(e){goog.asserts.assert(e.getContainingType()==this.getDescriptor(),"The current message does not contain the given field"),this.clear$Field(e.getTag())},goog.proto2.Message.prototype.equals=function(e){if(!e||this.constructor!=e.constructor)return!1;for(var t=this.getDescriptor().getFields(),o=0;o<t.length;o++){var n=t[o],r=n.getTag();if(this.has$Value(r)!=e.has$Value(r))return!1;if(this.has$Value(r)){var d=n.isCompositeType(),i=this.getValueForTag_(r),r=e.getValueForTag_(r);if(n.isRepeated()){if(i.length!=r.length)return!1;for(n=0;n<i.length;n++){var a=i[n],N=r[n];if(d?!a.equals(N):a!=N)return!1}}else if(d?!i.equals(r):i!=r)return!1}}return!0},goog.proto2.Message.prototype.copyFrom=function(e){goog.asserts.assert(this.constructor==e.constructor,"The source message must have the same type."),this!=e&&(this.values_={},this.deserializedFields_&&(this.deserializedFields_={}),this.mergeFrom(e))},goog.proto2.Message.prototype.mergeFrom=function(e){goog.asserts.assert(this.constructor==e.constructor,"The source message must have the same type.");for(var t=this.getDescriptor().getFields(),o=0;o<t.length;o++){var n=t[o],r=n.getTag();if(e.has$Value(r)){this.deserializedFields_&&delete this.deserializedFields_[n.getTag()];var d=n.isCompositeType();if(n.isRepeated())for(var n=e.array$Values(r),i=0;i<n.length;i++)this.add$Value(r,d?n[i].clone():n[i]);else n=e.getValueForTag_(r),d?(d=this.getValueForTag_(r))?d.mergeFrom(n):this.set$Value(r,n.clone()):this.set$Value(r,n)}}},goog.proto2.Message.prototype.clone=function(){var e=new this.constructor;return e.copyFrom(this),e},goog.proto2.Message.prototype.initDefaults=function(e){for(var t=this.getDescriptor().getFields(),o=0;o<t.length;o++){var n=t[o],r=n.getTag(),d=n.isCompositeType();if(this.has$Value(r)||n.isRepeated()||(d?this.values_[r]=new(n.getNativeType()):e&&(this.values_[r]=n.getDefaultValue())),d)if(n.isRepeated())for(n=this.array$Values(r),r=0;r<n.length;r++)n[r].initDefaults(e);else this.get$Value(r).initDefaults(e)}},goog.proto2.Message.prototype.has$Value=function(e){return null!=this.values_[e]},goog.proto2.Message.prototype.getValueForTag_=function(e){var t=this.values_[e];return goog.isDefAndNotNull(t)?this.lazyDeserializer_?e in this.deserializedFields_?this.deserializedFields_[e]:(t=this.lazyDeserializer_.deserializeField(this,this.fields_[e],t),this.deserializedFields_[e]=t):t:null},goog.proto2.Message.prototype.get$Value=function(e,t){var o=this.getValueForTag_(e);if(this.fields_[e].isRepeated()){var n=t||0;return goog.asserts.assert(0<=n&&n<o.length,"Given index %s is out of bounds.  Repeated field length: %s",n,o.length),o[n]}return o},goog.proto2.Message.prototype.get$ValueOrDefault=function(e,t){return this.has$Value(e)?this.get$Value(e,t):this.fields_[e].getDefaultValue()},goog.proto2.Message.prototype.array$Values=function(e){return this.getValueForTag_(e)||[]},goog.proto2.Message.prototype.count$Values=function(e){return this.fields_[e].isRepeated()?this.has$Value(e)?this.values_[e].length:0:this.has$Value(e)?1:0},goog.proto2.Message.prototype.set$Value=function(e,t){goog.asserts.ENABLE_ASSERTS&&this.checkFieldType_(this.fields_[e],t),this.values_[e]=t,this.deserializedFields_&&(this.deserializedFields_[e]=t)},goog.proto2.Message.prototype.add$Value=function(e,t){goog.asserts.ENABLE_ASSERTS&&this.checkFieldType_(this.fields_[e],t),this.values_[e]||(this.values_[e]=[]),this.values_[e].push(t),this.deserializedFields_&&delete this.deserializedFields_[e]},goog.proto2.Message.prototype.checkFieldType_=function(e,t){e.getFieldType()==goog.proto2.FieldDescriptor.FieldType.ENUM?goog.asserts.assertNumber(t):goog.asserts.assert(Object(t).constructor==e.getNativeType())},goog.proto2.Message.prototype.clear$Field=function(e){delete this.values_[e],this.deserializedFields_&&delete this.deserializedFields_[e]},goog.proto2.Message.createDescriptor=function(e,t){var o,n=[],r=t[0];for(o in t)0!=o&&n.push(new goog.proto2.FieldDescriptor(e,o,t[o]));return new goog.proto2.Descriptor(e,r,n)},goog.proto2.Serializer=function(){},goog.proto2.Serializer.DECODE_SYMBOLIC_ENUMS=!1,goog.proto2.Serializer.prototype.getSerializedValue=function(e,t){return e.isCompositeType()?this.serialize(t):goog.isNumber(t)&&!isFinite(t)?t.toString():t},goog.proto2.Serializer.prototype.deserialize=function(e,t){var o=e.createMessageInstance();return this.deserializeTo(o,t),goog.asserts.assert(o instanceof goog.proto2.Message),o},goog.proto2.Serializer.prototype.getDeserializedValue=function(e,t){if(e.isCompositeType())return t instanceof goog.proto2.Message?t:this.deserialize(e.getFieldMessageType(),t);if(e.getFieldType()==goog.proto2.FieldDescriptor.FieldType.ENUM){if(goog.proto2.Serializer.DECODE_SYMBOLIC_ENUMS&&goog.isString(t)){var o=e.getNativeType();if(o.hasOwnProperty(t))return o[t]}return goog.isString(t)&&goog.proto2.Serializer.INTEGER_REGEX.test(t)&&(o=Number(t),0<o)?o:t}if(!e.deserializationConversionPermitted())return t;if(o=e.getNativeType(),o===String){if(goog.isNumber(t))return String(t)}else if(o===Number&&goog.isString(t)&&("Infinity"===t||"-Infinity"===t||"NaN"===t||goog.proto2.Serializer.INTEGER_REGEX.test(t)))return Number(t);return t},goog.proto2.Serializer.INTEGER_REGEX=/^-?[0-9]+$/,goog.proto2.LazyDeserializer=function(){},goog.inherits(goog.proto2.LazyDeserializer,goog.proto2.Serializer),goog.proto2.LazyDeserializer.prototype.deserialize=function(e,t){var o=e.createMessageInstance();return o.initializeForLazyDeserializer(this,t),goog.asserts.assert(o instanceof goog.proto2.Message),o},goog.proto2.LazyDeserializer.prototype.deserializeTo=function(e,t){throw Error("Unimplemented")},goog.proto2.PbLiteSerializer=function(){},goog.inherits(goog.proto2.PbLiteSerializer,goog.proto2.LazyDeserializer),goog.proto2.PbLiteSerializer.prototype.zeroIndexing_=!1,goog.proto2.PbLiteSerializer.prototype.setZeroIndexed=function(e){this.zeroIndexing_=e},goog.proto2.PbLiteSerializer.prototype.serialize=function(e){for(var t=e.getDescriptor().getFields(),o=[],n=this.zeroIndexing_,r=0;r<t.length;r++){var d=t[r];if(e.has(d)){var i=d.getTag(),i=n?i-1:i;if(d.isRepeated()){o[i]=[];for(var a=0;a<e.countOf(d);a++)o[i][a]=this.getSerializedValue(d,e.get(d,a))}else o[i]=this.getSerializedValue(d,e.get(d))}}return e.forEachUnknown(function(e,t){o[n?e-1:e]=t}),o},goog.proto2.PbLiteSerializer.prototype.deserializeField=function(e,t,o){if(null==o)return o;if(t.isRepeated()){e=[],goog.asserts.assert(goog.isArray(o),"Value must be array: %s",o);for(var n=0;n<o.length;n++)e[n]=this.getDeserializedValue(t,o[n]);return e}return this.getDeserializedValue(t,o)},goog.proto2.PbLiteSerializer.prototype.getSerializedValue=function(e,t){return e.getFieldType()==goog.proto2.FieldDescriptor.FieldType.BOOL?t?1:0:goog.proto2.Serializer.prototype.getSerializedValue.apply(this,arguments)},goog.proto2.PbLiteSerializer.prototype.getDeserializedValue=function(e,t){return e.getFieldType()==goog.proto2.FieldDescriptor.FieldType.BOOL?(goog.asserts.assert(goog.isNumber(t)||goog.isBoolean(t),"Value is expected to be a number or boolean"),!!t):goog.proto2.Serializer.prototype.getDeserializedValue.apply(this,arguments)},goog.proto2.PbLiteSerializer.prototype.deserialize=function(e,t){var o=t;if(this.zeroIndexing_){var n,o=[];for(n in t)o[parseInt(n,10)+1]=t[n]}return goog.proto2.PbLiteSerializer.superClass_.deserialize.call(this,e,o)};var i18n={phonenumbers:{}};i18n.phonenumbers.NumberFormat=function(){goog.proto2.Message.call(this)},goog.inherits(i18n.phonenumbers.NumberFormat,goog.proto2.Message),i18n.phonenumbers.NumberFormat.prototype.getPattern=function(){return this.get$Value(1)},i18n.phonenumbers.NumberFormat.prototype.getPatternOrDefault=function(){return this.get$ValueOrDefault(1)},i18n.phonenumbers.NumberFormat.prototype.setPattern=function(e){this.set$Value(1,e)},i18n.phonenumbers.NumberFormat.prototype.hasPattern=function(){return this.has$Value(1)},i18n.phonenumbers.NumberFormat.prototype.patternCount=function(){return this.count$Values(1)},i18n.phonenumbers.NumberFormat.prototype.clearPattern=function(){this.clear$Field(1)},i18n.phonenumbers.NumberFormat.prototype.getFormat=function(){return this.get$Value(2)},i18n.phonenumbers.NumberFormat.prototype.getFormatOrDefault=function(){return this.get$ValueOrDefault(2)},i18n.phonenumbers.NumberFormat.prototype.setFormat=function(e){this.set$Value(2,e)},i18n.phonenumbers.NumberFormat.prototype.hasFormat=function(){return this.has$Value(2)},i18n.phonenumbers.NumberFormat.prototype.formatCount=function(){return this.count$Values(2)},i18n.phonenumbers.NumberFormat.prototype.clearFormat=function(){this.clear$Field(2)},i18n.phonenumbers.NumberFormat.prototype.getLeadingDigitsPattern=function(e){return this.get$Value(3,e)},i18n.phonenumbers.NumberFormat.prototype.getLeadingDigitsPatternOrDefault=function(e){return this.get$ValueOrDefault(3,e)},i18n.phonenumbers.NumberFormat.prototype.addLeadingDigitsPattern=function(e){this.add$Value(3,e)},i18n.phonenumbers.NumberFormat.prototype.leadingDigitsPatternArray=function(){return this.array$Values(3);
},i18n.phonenumbers.NumberFormat.prototype.hasLeadingDigitsPattern=function(){return this.has$Value(3)},i18n.phonenumbers.NumberFormat.prototype.leadingDigitsPatternCount=function(){return this.count$Values(3)},i18n.phonenumbers.NumberFormat.prototype.clearLeadingDigitsPattern=function(){this.clear$Field(3)},i18n.phonenumbers.NumberFormat.prototype.getNationalPrefixFormattingRule=function(){return this.get$Value(4)},i18n.phonenumbers.NumberFormat.prototype.getNationalPrefixFormattingRuleOrDefault=function(){return this.get$ValueOrDefault(4)},i18n.phonenumbers.NumberFormat.prototype.setNationalPrefixFormattingRule=function(e){this.set$Value(4,e)},i18n.phonenumbers.NumberFormat.prototype.hasNationalPrefixFormattingRule=function(){return this.has$Value(4)},i18n.phonenumbers.NumberFormat.prototype.nationalPrefixFormattingRuleCount=function(){return this.count$Values(4)},i18n.phonenumbers.NumberFormat.prototype.clearNationalPrefixFormattingRule=function(){this.clear$Field(4)},i18n.phonenumbers.NumberFormat.prototype.getNationalPrefixOptionalWhenFormatting=function(){return this.get$Value(6)},i18n.phonenumbers.NumberFormat.prototype.getNationalPrefixOptionalWhenFormattingOrDefault=function(){return this.get$ValueOrDefault(6)},i18n.phonenumbers.NumberFormat.prototype.setNationalPrefixOptionalWhenFormatting=function(e){this.set$Value(6,e)},i18n.phonenumbers.NumberFormat.prototype.hasNationalPrefixOptionalWhenFormatting=function(){return this.has$Value(6)},i18n.phonenumbers.NumberFormat.prototype.nationalPrefixOptionalWhenFormattingCount=function(){return this.count$Values(6)},i18n.phonenumbers.NumberFormat.prototype.clearNationalPrefixOptionalWhenFormatting=function(){this.clear$Field(6)},i18n.phonenumbers.NumberFormat.prototype.getDomesticCarrierCodeFormattingRule=function(){return this.get$Value(5)},i18n.phonenumbers.NumberFormat.prototype.getDomesticCarrierCodeFormattingRuleOrDefault=function(){return this.get$ValueOrDefault(5)},i18n.phonenumbers.NumberFormat.prototype.setDomesticCarrierCodeFormattingRule=function(e){this.set$Value(5,e)},i18n.phonenumbers.NumberFormat.prototype.hasDomesticCarrierCodeFormattingRule=function(){return this.has$Value(5)},i18n.phonenumbers.NumberFormat.prototype.domesticCarrierCodeFormattingRuleCount=function(){return this.count$Values(5)},i18n.phonenumbers.NumberFormat.prototype.clearDomesticCarrierCodeFormattingRule=function(){this.clear$Field(5)},i18n.phonenumbers.PhoneNumberDesc=function(){goog.proto2.Message.call(this)},goog.inherits(i18n.phonenumbers.PhoneNumberDesc,goog.proto2.Message),i18n.phonenumbers.PhoneNumberDesc.prototype.getNationalNumberPattern=function(){return this.get$Value(2)},i18n.phonenumbers.PhoneNumberDesc.prototype.getNationalNumberPatternOrDefault=function(){return this.get$ValueOrDefault(2)},i18n.phonenumbers.PhoneNumberDesc.prototype.setNationalNumberPattern=function(e){this.set$Value(2,e)},i18n.phonenumbers.PhoneNumberDesc.prototype.hasNationalNumberPattern=function(){return this.has$Value(2)},i18n.phonenumbers.PhoneNumberDesc.prototype.nationalNumberPatternCount=function(){return this.count$Values(2)},i18n.phonenumbers.PhoneNumberDesc.prototype.clearNationalNumberPattern=function(){this.clear$Field(2)},i18n.phonenumbers.PhoneNumberDesc.prototype.getPossibleNumberPattern=function(){return this.get$Value(3)},i18n.phonenumbers.PhoneNumberDesc.prototype.getPossibleNumberPatternOrDefault=function(){return this.get$ValueOrDefault(3)},i18n.phonenumbers.PhoneNumberDesc.prototype.setPossibleNumberPattern=function(e){this.set$Value(3,e)},i18n.phonenumbers.PhoneNumberDesc.prototype.hasPossibleNumberPattern=function(){return this.has$Value(3)},i18n.phonenumbers.PhoneNumberDesc.prototype.possibleNumberPatternCount=function(){return this.count$Values(3)},i18n.phonenumbers.PhoneNumberDesc.prototype.clearPossibleNumberPattern=function(){this.clear$Field(3)},i18n.phonenumbers.PhoneNumberDesc.prototype.getExampleNumber=function(){return this.get$Value(6)},i18n.phonenumbers.PhoneNumberDesc.prototype.getExampleNumberOrDefault=function(){return this.get$ValueOrDefault(6)},i18n.phonenumbers.PhoneNumberDesc.prototype.setExampleNumber=function(e){this.set$Value(6,e)},i18n.phonenumbers.PhoneNumberDesc.prototype.hasExampleNumber=function(){return this.has$Value(6)},i18n.phonenumbers.PhoneNumberDesc.prototype.exampleNumberCount=function(){return this.count$Values(6)},i18n.phonenumbers.PhoneNumberDesc.prototype.clearExampleNumber=function(){this.clear$Field(6)},i18n.phonenumbers.PhoneNumberDesc.prototype.getNationalNumberMatcherData=function(){return this.get$Value(7)},i18n.phonenumbers.PhoneNumberDesc.prototype.getNationalNumberMatcherDataOrDefault=function(){return this.get$ValueOrDefault(7)},i18n.phonenumbers.PhoneNumberDesc.prototype.setNationalNumberMatcherData=function(e){this.set$Value(7,e)},i18n.phonenumbers.PhoneNumberDesc.prototype.hasNationalNumberMatcherData=function(){return this.has$Value(7)},i18n.phonenumbers.PhoneNumberDesc.prototype.nationalNumberMatcherDataCount=function(){return this.count$Values(7)},i18n.phonenumbers.PhoneNumberDesc.prototype.clearNationalNumberMatcherData=function(){this.clear$Field(7)},i18n.phonenumbers.PhoneNumberDesc.prototype.getPossibleNumberMatcherData=function(){return this.get$Value(8)},i18n.phonenumbers.PhoneNumberDesc.prototype.getPossibleNumberMatcherDataOrDefault=function(){return this.get$ValueOrDefault(8)},i18n.phonenumbers.PhoneNumberDesc.prototype.setPossibleNumberMatcherData=function(e){this.set$Value(8,e)},i18n.phonenumbers.PhoneNumberDesc.prototype.hasPossibleNumberMatcherData=function(){return this.has$Value(8)},i18n.phonenumbers.PhoneNumberDesc.prototype.possibleNumberMatcherDataCount=function(){return this.count$Values(8)},i18n.phonenumbers.PhoneNumberDesc.prototype.clearPossibleNumberMatcherData=function(){this.clear$Field(8)},i18n.phonenumbers.PhoneMetadata=function(){goog.proto2.Message.call(this)},goog.inherits(i18n.phonenumbers.PhoneMetadata,goog.proto2.Message),i18n.phonenumbers.PhoneMetadata.prototype.getGeneralDesc=function(){return this.get$Value(1)},i18n.phonenumbers.PhoneMetadata.prototype.getGeneralDescOrDefault=function(){return this.get$ValueOrDefault(1)},i18n.phonenumbers.PhoneMetadata.prototype.setGeneralDesc=function(e){this.set$Value(1,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasGeneralDesc=function(){return this.has$Value(1)},i18n.phonenumbers.PhoneMetadata.prototype.generalDescCount=function(){return this.count$Values(1)},i18n.phonenumbers.PhoneMetadata.prototype.clearGeneralDesc=function(){this.clear$Field(1)},i18n.phonenumbers.PhoneMetadata.prototype.getFixedLine=function(){return this.get$Value(2)},i18n.phonenumbers.PhoneMetadata.prototype.getFixedLineOrDefault=function(){return this.get$ValueOrDefault(2)},i18n.phonenumbers.PhoneMetadata.prototype.setFixedLine=function(e){this.set$Value(2,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasFixedLine=function(){return this.has$Value(2)},i18n.phonenumbers.PhoneMetadata.prototype.fixedLineCount=function(){return this.count$Values(2)},i18n.phonenumbers.PhoneMetadata.prototype.clearFixedLine=function(){this.clear$Field(2)},i18n.phonenumbers.PhoneMetadata.prototype.getMobile=function(){return this.get$Value(3)},i18n.phonenumbers.PhoneMetadata.prototype.getMobileOrDefault=function(){return this.get$ValueOrDefault(3)},i18n.phonenumbers.PhoneMetadata.prototype.setMobile=function(e){this.set$Value(3,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasMobile=function(){return this.has$Value(3)},i18n.phonenumbers.PhoneMetadata.prototype.mobileCount=function(){return this.count$Values(3)},i18n.phonenumbers.PhoneMetadata.prototype.clearMobile=function(){this.clear$Field(3)},i18n.phonenumbers.PhoneMetadata.prototype.getTollFree=function(){return this.get$Value(4)},i18n.phonenumbers.PhoneMetadata.prototype.getTollFreeOrDefault=function(){return this.get$ValueOrDefault(4)},i18n.phonenumbers.PhoneMetadata.prototype.setTollFree=function(e){this.set$Value(4,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasTollFree=function(){return this.has$Value(4)},i18n.phonenumbers.PhoneMetadata.prototype.tollFreeCount=function(){return this.count$Values(4)},i18n.phonenumbers.PhoneMetadata.prototype.clearTollFree=function(){this.clear$Field(4)},i18n.phonenumbers.PhoneMetadata.prototype.getPremiumRate=function(){return this.get$Value(5)},i18n.phonenumbers.PhoneMetadata.prototype.getPremiumRateOrDefault=function(){return this.get$ValueOrDefault(5)},i18n.phonenumbers.PhoneMetadata.prototype.setPremiumRate=function(e){this.set$Value(5,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasPremiumRate=function(){return this.has$Value(5)},i18n.phonenumbers.PhoneMetadata.prototype.premiumRateCount=function(){return this.count$Values(5)},i18n.phonenumbers.PhoneMetadata.prototype.clearPremiumRate=function(){this.clear$Field(5)},i18n.phonenumbers.PhoneMetadata.prototype.getSharedCost=function(){return this.get$Value(6)},i18n.phonenumbers.PhoneMetadata.prototype.getSharedCostOrDefault=function(){return this.get$ValueOrDefault(6)},i18n.phonenumbers.PhoneMetadata.prototype.setSharedCost=function(e){this.set$Value(6,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasSharedCost=function(){return this.has$Value(6)},i18n.phonenumbers.PhoneMetadata.prototype.sharedCostCount=function(){return this.count$Values(6)},i18n.phonenumbers.PhoneMetadata.prototype.clearSharedCost=function(){this.clear$Field(6)},i18n.phonenumbers.PhoneMetadata.prototype.getPersonalNumber=function(){return this.get$Value(7)},i18n.phonenumbers.PhoneMetadata.prototype.getPersonalNumberOrDefault=function(){return this.get$ValueOrDefault(7)},i18n.phonenumbers.PhoneMetadata.prototype.setPersonalNumber=function(e){this.set$Value(7,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasPersonalNumber=function(){return this.has$Value(7)},i18n.phonenumbers.PhoneMetadata.prototype.personalNumberCount=function(){return this.count$Values(7)},i18n.phonenumbers.PhoneMetadata.prototype.clearPersonalNumber=function(){this.clear$Field(7)},i18n.phonenumbers.PhoneMetadata.prototype.getVoip=function(){return this.get$Value(8)},i18n.phonenumbers.PhoneMetadata.prototype.getVoipOrDefault=function(){return this.get$ValueOrDefault(8)},i18n.phonenumbers.PhoneMetadata.prototype.setVoip=function(e){this.set$Value(8,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasVoip=function(){return this.has$Value(8)},i18n.phonenumbers.PhoneMetadata.prototype.voipCount=function(){return this.count$Values(8)},i18n.phonenumbers.PhoneMetadata.prototype.clearVoip=function(){this.clear$Field(8)},i18n.phonenumbers.PhoneMetadata.prototype.getPager=function(){return this.get$Value(21)},i18n.phonenumbers.PhoneMetadata.prototype.getPagerOrDefault=function(){return this.get$ValueOrDefault(21)},i18n.phonenumbers.PhoneMetadata.prototype.setPager=function(e){this.set$Value(21,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasPager=function(){return this.has$Value(21)},i18n.phonenumbers.PhoneMetadata.prototype.pagerCount=function(){return this.count$Values(21)},i18n.phonenumbers.PhoneMetadata.prototype.clearPager=function(){this.clear$Field(21)},i18n.phonenumbers.PhoneMetadata.prototype.getUan=function(){return this.get$Value(25)},i18n.phonenumbers.PhoneMetadata.prototype.getUanOrDefault=function(){return this.get$ValueOrDefault(25)},i18n.phonenumbers.PhoneMetadata.prototype.setUan=function(e){this.set$Value(25,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasUan=function(){return this.has$Value(25)},i18n.phonenumbers.PhoneMetadata.prototype.uanCount=function(){return this.count$Values(25)},i18n.phonenumbers.PhoneMetadata.prototype.clearUan=function(){this.clear$Field(25)},i18n.phonenumbers.PhoneMetadata.prototype.getEmergency=function(){return this.get$Value(27)},i18n.phonenumbers.PhoneMetadata.prototype.getEmergencyOrDefault=function(){return this.get$ValueOrDefault(27)},i18n.phonenumbers.PhoneMetadata.prototype.setEmergency=function(e){this.set$Value(27,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasEmergency=function(){return this.has$Value(27)},i18n.phonenumbers.PhoneMetadata.prototype.emergencyCount=function(){return this.count$Values(27)},i18n.phonenumbers.PhoneMetadata.prototype.clearEmergency=function(){this.clear$Field(27)},i18n.phonenumbers.PhoneMetadata.prototype.getVoicemail=function(){return this.get$Value(28)},i18n.phonenumbers.PhoneMetadata.prototype.getVoicemailOrDefault=function(){return this.get$ValueOrDefault(28)},i18n.phonenumbers.PhoneMetadata.prototype.setVoicemail=function(e){this.set$Value(28,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasVoicemail=function(){return this.has$Value(28)},i18n.phonenumbers.PhoneMetadata.prototype.voicemailCount=function(){return this.count$Values(28)},i18n.phonenumbers.PhoneMetadata.prototype.clearVoicemail=function(){this.clear$Field(28)},i18n.phonenumbers.PhoneMetadata.prototype.getNoInternationalDialling=function(){return this.get$Value(24)},i18n.phonenumbers.PhoneMetadata.prototype.getNoInternationalDiallingOrDefault=function(){return this.get$ValueOrDefault(24)},i18n.phonenumbers.PhoneMetadata.prototype.setNoInternationalDialling=function(e){this.set$Value(24,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasNoInternationalDialling=function(){return this.has$Value(24)},i18n.phonenumbers.PhoneMetadata.prototype.noInternationalDiallingCount=function(){return this.count$Values(24)},i18n.phonenumbers.PhoneMetadata.prototype.clearNoInternationalDialling=function(){this.clear$Field(24)},i18n.phonenumbers.PhoneMetadata.prototype.getId=function(){return this.get$Value(9)},i18n.phonenumbers.PhoneMetadata.prototype.getIdOrDefault=function(){return this.get$ValueOrDefault(9)},i18n.phonenumbers.PhoneMetadata.prototype.setId=function(e){this.set$Value(9,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasId=function(){return this.has$Value(9)},i18n.phonenumbers.PhoneMetadata.prototype.idCount=function(){return this.count$Values(9)},i18n.phonenumbers.PhoneMetadata.prototype.clearId=function(){this.clear$Field(9)},i18n.phonenumbers.PhoneMetadata.prototype.getCountryCode=function(){return this.get$Value(10)},i18n.phonenumbers.PhoneMetadata.prototype.getCountryCodeOrDefault=function(){return this.get$ValueOrDefault(10)},i18n.phonenumbers.PhoneMetadata.prototype.setCountryCode=function(e){this.set$Value(10,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasCountryCode=function(){return this.has$Value(10)},i18n.phonenumbers.PhoneMetadata.prototype.countryCodeCount=function(){return this.count$Values(10)},i18n.phonenumbers.PhoneMetadata.prototype.clearCountryCode=function(){this.clear$Field(10)},i18n.phonenumbers.PhoneMetadata.prototype.getInternationalPrefix=function(){return this.get$Value(11)},i18n.phonenumbers.PhoneMetadata.prototype.getInternationalPrefixOrDefault=function(){return this.get$ValueOrDefault(11)},i18n.phonenumbers.PhoneMetadata.prototype.setInternationalPrefix=function(e){this.set$Value(11,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasInternationalPrefix=function(){return this.has$Value(11)},i18n.phonenumbers.PhoneMetadata.prototype.internationalPrefixCount=function(){return this.count$Values(11)},i18n.phonenumbers.PhoneMetadata.prototype.clearInternationalPrefix=function(){this.clear$Field(11)},i18n.phonenumbers.PhoneMetadata.prototype.getPreferredInternationalPrefix=function(){return this.get$Value(17)},i18n.phonenumbers.PhoneMetadata.prototype.getPreferredInternationalPrefixOrDefault=function(){return this.get$ValueOrDefault(17)},i18n.phonenumbers.PhoneMetadata.prototype.setPreferredInternationalPrefix=function(e){this.set$Value(17,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasPreferredInternationalPrefix=function(){return this.has$Value(17)},i18n.phonenumbers.PhoneMetadata.prototype.preferredInternationalPrefixCount=function(){return this.count$Values(17)},i18n.phonenumbers.PhoneMetadata.prototype.clearPreferredInternationalPrefix=function(){this.clear$Field(17)},i18n.phonenumbers.PhoneMetadata.prototype.getNationalPrefix=function(){return this.get$Value(12)},i18n.phonenumbers.PhoneMetadata.prototype.getNationalPrefixOrDefault=function(){return this.get$ValueOrDefault(12)},i18n.phonenumbers.PhoneMetadata.prototype.setNationalPrefix=function(e){this.set$Value(12,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasNationalPrefix=function(){return this.has$Value(12)},i18n.phonenumbers.PhoneMetadata.prototype.nationalPrefixCount=function(){return this.count$Values(12)},i18n.phonenumbers.PhoneMetadata.prototype.clearNationalPrefix=function(){this.clear$Field(12)},i18n.phonenumbers.PhoneMetadata.prototype.getPreferredExtnPrefix=function(){return this.get$Value(13)},i18n.phonenumbers.PhoneMetadata.prototype.getPreferredExtnPrefixOrDefault=function(){return this.get$ValueOrDefault(13)},i18n.phonenumbers.PhoneMetadata.prototype.setPreferredExtnPrefix=function(e){this.set$Value(13,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasPreferredExtnPrefix=function(){return this.has$Value(13)},i18n.phonenumbers.PhoneMetadata.prototype.preferredExtnPrefixCount=function(){return this.count$Values(13)},i18n.phonenumbers.PhoneMetadata.prototype.clearPreferredExtnPrefix=function(){this.clear$Field(13)},i18n.phonenumbers.PhoneMetadata.prototype.getNationalPrefixForParsing=function(){return this.get$Value(15)},i18n.phonenumbers.PhoneMetadata.prototype.getNationalPrefixForParsingOrDefault=function(){return this.get$ValueOrDefault(15)},i18n.phonenumbers.PhoneMetadata.prototype.setNationalPrefixForParsing=function(e){this.set$Value(15,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasNationalPrefixForParsing=function(){return this.has$Value(15)},i18n.phonenumbers.PhoneMetadata.prototype.nationalPrefixForParsingCount=function(){return this.count$Values(15)},i18n.phonenumbers.PhoneMetadata.prototype.clearNationalPrefixForParsing=function(){this.clear$Field(15)},i18n.phonenumbers.PhoneMetadata.prototype.getNationalPrefixTransformRule=function(){return this.get$Value(16)},i18n.phonenumbers.PhoneMetadata.prototype.getNationalPrefixTransformRuleOrDefault=function(){return this.get$ValueOrDefault(16)},i18n.phonenumbers.PhoneMetadata.prototype.setNationalPrefixTransformRule=function(e){this.set$Value(16,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasNationalPrefixTransformRule=function(){return this.has$Value(16)},i18n.phonenumbers.PhoneMetadata.prototype.nationalPrefixTransformRuleCount=function(){return this.count$Values(16)},i18n.phonenumbers.PhoneMetadata.prototype.clearNationalPrefixTransformRule=function(){this.clear$Field(16)},i18n.phonenumbers.PhoneMetadata.prototype.getSameMobileAndFixedLinePattern=function(){return this.get$Value(18)};i18n.phonenumbers.PhoneMetadata.prototype.getSameMobileAndFixedLinePatternOrDefault=function(){return this.get$ValueOrDefault(18)};i18n.phonenumbers.PhoneMetadata.prototype.setSameMobileAndFixedLinePattern=function(e){this.set$Value(18,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasSameMobileAndFixedLinePattern=function(){return this.has$Value(18)},i18n.phonenumbers.PhoneMetadata.prototype.sameMobileAndFixedLinePatternCount=function(){return this.count$Values(18)},i18n.phonenumbers.PhoneMetadata.prototype.clearSameMobileAndFixedLinePattern=function(){this.clear$Field(18)},i18n.phonenumbers.PhoneMetadata.prototype.getNumberFormat=function(e){return this.get$Value(19,e)},i18n.phonenumbers.PhoneMetadata.prototype.getNumberFormatOrDefault=function(e){return this.get$ValueOrDefault(19,e)},i18n.phonenumbers.PhoneMetadata.prototype.addNumberFormat=function(e){this.add$Value(19,e)},i18n.phonenumbers.PhoneMetadata.prototype.numberFormatArray=function(){return this.array$Values(19)},i18n.phonenumbers.PhoneMetadata.prototype.hasNumberFormat=function(){return this.has$Value(19)},i18n.phonenumbers.PhoneMetadata.prototype.numberFormatCount=function(){return this.count$Values(19)},i18n.phonenumbers.PhoneMetadata.prototype.clearNumberFormat=function(){this.clear$Field(19)},i18n.phonenumbers.PhoneMetadata.prototype.getIntlNumberFormat=function(e){return this.get$Value(20,e)},i18n.phonenumbers.PhoneMetadata.prototype.getIntlNumberFormatOrDefault=function(e){return this.get$ValueOrDefault(20,e)},i18n.phonenumbers.PhoneMetadata.prototype.addIntlNumberFormat=function(e){this.add$Value(20,e)},i18n.phonenumbers.PhoneMetadata.prototype.intlNumberFormatArray=function(){return this.array$Values(20)},i18n.phonenumbers.PhoneMetadata.prototype.hasIntlNumberFormat=function(){return this.has$Value(20)},i18n.phonenumbers.PhoneMetadata.prototype.intlNumberFormatCount=function(){return this.count$Values(20)},i18n.phonenumbers.PhoneMetadata.prototype.clearIntlNumberFormat=function(){this.clear$Field(20)},i18n.phonenumbers.PhoneMetadata.prototype.getMainCountryForCode=function(){return this.get$Value(22)},i18n.phonenumbers.PhoneMetadata.prototype.getMainCountryForCodeOrDefault=function(){return this.get$ValueOrDefault(22)},i18n.phonenumbers.PhoneMetadata.prototype.setMainCountryForCode=function(e){this.set$Value(22,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasMainCountryForCode=function(){return this.has$Value(22)},i18n.phonenumbers.PhoneMetadata.prototype.mainCountryForCodeCount=function(){return this.count$Values(22)},i18n.phonenumbers.PhoneMetadata.prototype.clearMainCountryForCode=function(){this.clear$Field(22)},i18n.phonenumbers.PhoneMetadata.prototype.getLeadingDigits=function(){return this.get$Value(23)},i18n.phonenumbers.PhoneMetadata.prototype.getLeadingDigitsOrDefault=function(){return this.get$ValueOrDefault(23)},i18n.phonenumbers.PhoneMetadata.prototype.setLeadingDigits=function(e){this.set$Value(23,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasLeadingDigits=function(){return this.has$Value(23)},i18n.phonenumbers.PhoneMetadata.prototype.leadingDigitsCount=function(){return this.count$Values(23)},i18n.phonenumbers.PhoneMetadata.prototype.clearLeadingDigits=function(){this.clear$Field(23)},i18n.phonenumbers.PhoneMetadata.prototype.getLeadingZeroPossible=function(){return this.get$Value(26)},i18n.phonenumbers.PhoneMetadata.prototype.getLeadingZeroPossibleOrDefault=function(){return this.get$ValueOrDefault(26)},i18n.phonenumbers.PhoneMetadata.prototype.setLeadingZeroPossible=function(e){this.set$Value(26,e)},i18n.phonenumbers.PhoneMetadata.prototype.hasLeadingZeroPossible=function(){return this.has$Value(26)},i18n.phonenumbers.PhoneMetadata.prototype.leadingZeroPossibleCount=function(){return this.count$Values(26)},i18n.phonenumbers.PhoneMetadata.prototype.clearLeadingZeroPossible=function(){this.clear$Field(26)},i18n.phonenumbers.PhoneMetadataCollection=function(){goog.proto2.Message.call(this)},goog.inherits(i18n.phonenumbers.PhoneMetadataCollection,goog.proto2.Message),i18n.phonenumbers.PhoneMetadataCollection.prototype.getMetadata=function(e){return this.get$Value(1,e)},i18n.phonenumbers.PhoneMetadataCollection.prototype.getMetadataOrDefault=function(e){return this.get$ValueOrDefault(1,e)},i18n.phonenumbers.PhoneMetadataCollection.prototype.addMetadata=function(e){this.add$Value(1,e)},i18n.phonenumbers.PhoneMetadataCollection.prototype.metadataArray=function(){return this.array$Values(1)},i18n.phonenumbers.PhoneMetadataCollection.prototype.hasMetadata=function(){return this.has$Value(1)},i18n.phonenumbers.PhoneMetadataCollection.prototype.metadataCount=function(){return this.count$Values(1)},i18n.phonenumbers.PhoneMetadataCollection.prototype.clearMetadata=function(){this.clear$Field(1)},i18n.phonenumbers.NumberFormat.prototype.getDescriptor=function(){return i18n.phonenumbers.NumberFormat.descriptor_||(i18n.phonenumbers.NumberFormat.descriptor_=goog.proto2.Message.createDescriptor(i18n.phonenumbers.NumberFormat,{0:{name:"NumberFormat",fullName:"i18n.phonenumbers.NumberFormat"},1:{name:"pattern",required:!0,fieldType:goog.proto2.Message.FieldType.STRING,type:String},2:{name:"format",required:!0,fieldType:goog.proto2.Message.FieldType.STRING,type:String},3:{name:"leading_digits_pattern",repeated:!0,fieldType:goog.proto2.Message.FieldType.STRING,type:String},4:{name:"national_prefix_formatting_rule",fieldType:goog.proto2.Message.FieldType.STRING,type:String},6:{name:"national_prefix_optional_when_formatting",fieldType:goog.proto2.Message.FieldType.BOOL,type:Boolean},5:{name:"domestic_carrier_code_formatting_rule",fieldType:goog.proto2.Message.FieldType.STRING,type:String}})),i18n.phonenumbers.NumberFormat.descriptor_},i18n.phonenumbers.NumberFormat.ctor=i18n.phonenumbers.NumberFormat,i18n.phonenumbers.NumberFormat.ctor.getDescriptor=i18n.phonenumbers.NumberFormat.prototype.getDescriptor,i18n.phonenumbers.PhoneNumberDesc.prototype.getDescriptor=function(){return i18n.phonenumbers.PhoneNumberDesc.descriptor_||(i18n.phonenumbers.PhoneNumberDesc.descriptor_=goog.proto2.Message.createDescriptor(i18n.phonenumbers.PhoneNumberDesc,{0:{name:"PhoneNumberDesc",fullName:"i18n.phonenumbers.PhoneNumberDesc"},2:{name:"national_number_pattern",fieldType:goog.proto2.Message.FieldType.STRING,type:String},3:{name:"possible_number_pattern",fieldType:goog.proto2.Message.FieldType.STRING,type:String},6:{name:"example_number",fieldType:goog.proto2.Message.FieldType.STRING,type:String},7:{name:"national_number_matcher_data",fieldType:goog.proto2.Message.FieldType.BYTES,type:String},8:{name:"possible_number_matcher_data",fieldType:goog.proto2.Message.FieldType.BYTES,type:String}})),i18n.phonenumbers.PhoneNumberDesc.descriptor_},i18n.phonenumbers.PhoneNumberDesc.ctor=i18n.phonenumbers.PhoneNumberDesc,i18n.phonenumbers.PhoneNumberDesc.ctor.getDescriptor=i18n.phonenumbers.PhoneNumberDesc.prototype.getDescriptor,i18n.phonenumbers.PhoneMetadata.prototype.getDescriptor=function(){return i18n.phonenumbers.PhoneMetadata.descriptor_||(i18n.phonenumbers.PhoneMetadata.descriptor_=goog.proto2.Message.createDescriptor(i18n.phonenumbers.PhoneMetadata,{0:{name:"PhoneMetadata",fullName:"i18n.phonenumbers.PhoneMetadata"},1:{name:"general_desc",fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.PhoneNumberDesc},2:{name:"fixed_line",fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.PhoneNumberDesc},3:{name:"mobile",fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.PhoneNumberDesc},4:{name:"toll_free",fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.PhoneNumberDesc},5:{name:"premium_rate",fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.PhoneNumberDesc},6:{name:"shared_cost",fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.PhoneNumberDesc},7:{name:"personal_number",fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.PhoneNumberDesc},8:{name:"voip",fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.PhoneNumberDesc},21:{name:"pager",fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.PhoneNumberDesc},25:{name:"uan",fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.PhoneNumberDesc},27:{name:"emergency",fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.PhoneNumberDesc},28:{name:"voicemail",fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.PhoneNumberDesc},24:{name:"no_international_dialling",fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.PhoneNumberDesc},9:{name:"id",required:!0,fieldType:goog.proto2.Message.FieldType.STRING,type:String},10:{name:"country_code",fieldType:goog.proto2.Message.FieldType.INT32,type:Number},11:{name:"international_prefix",fieldType:goog.proto2.Message.FieldType.STRING,type:String},17:{name:"preferred_international_prefix",fieldType:goog.proto2.Message.FieldType.STRING,type:String},12:{name:"national_prefix",fieldType:goog.proto2.Message.FieldType.STRING,type:String},13:{name:"preferred_extn_prefix",fieldType:goog.proto2.Message.FieldType.STRING,type:String},15:{name:"national_prefix_for_parsing",fieldType:goog.proto2.Message.FieldType.STRING,type:String},16:{name:"national_prefix_transform_rule",fieldType:goog.proto2.Message.FieldType.STRING,type:String},18:{name:"same_mobile_and_fixed_line_pattern",fieldType:goog.proto2.Message.FieldType.BOOL,defaultValue:!1,type:Boolean},19:{name:"number_format",repeated:!0,fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.NumberFormat},20:{name:"intl_number_format",repeated:!0,fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.NumberFormat},22:{name:"main_country_for_code",fieldType:goog.proto2.Message.FieldType.BOOL,defaultValue:!1,type:Boolean},23:{name:"leading_digits",fieldType:goog.proto2.Message.FieldType.STRING,type:String},26:{name:"leading_zero_possible",fieldType:goog.proto2.Message.FieldType.BOOL,defaultValue:!1,type:Boolean}})),i18n.phonenumbers.PhoneMetadata.descriptor_},i18n.phonenumbers.PhoneMetadata.ctor=i18n.phonenumbers.PhoneMetadata,i18n.phonenumbers.PhoneMetadata.ctor.getDescriptor=i18n.phonenumbers.PhoneMetadata.prototype.getDescriptor,i18n.phonenumbers.PhoneMetadataCollection.prototype.getDescriptor=function(){return i18n.phonenumbers.PhoneMetadataCollection.descriptor_||(i18n.phonenumbers.PhoneMetadataCollection.descriptor_=goog.proto2.Message.createDescriptor(i18n.phonenumbers.PhoneMetadataCollection,{0:{name:"PhoneMetadataCollection",fullName:"i18n.phonenumbers.PhoneMetadataCollection"},1:{name:"metadata",repeated:!0,fieldType:goog.proto2.Message.FieldType.MESSAGE,type:i18n.phonenumbers.PhoneMetadata}})),i18n.phonenumbers.PhoneMetadataCollection.descriptor_},i18n.phonenumbers.PhoneMetadataCollection.ctor=i18n.phonenumbers.PhoneMetadataCollection,i18n.phonenumbers.PhoneMetadataCollection.ctor.getDescriptor=i18n.phonenumbers.PhoneMetadataCollection.prototype.getDescriptor,i18n.phonenumbers.PhoneNumber=function(){goog.proto2.Message.call(this)},goog.inherits(i18n.phonenumbers.PhoneNumber,goog.proto2.Message),i18n.phonenumbers.PhoneNumber.prototype.getCountryCode=function(){return this.get$Value(1)},i18n.phonenumbers.PhoneNumber.prototype.getCountryCodeOrDefault=function(){return this.get$ValueOrDefault(1)},i18n.phonenumbers.PhoneNumber.prototype.setCountryCode=function(e){this.set$Value(1,e)},i18n.phonenumbers.PhoneNumber.prototype.hasCountryCode=function(){return this.has$Value(1)},i18n.phonenumbers.PhoneNumber.prototype.countryCodeCount=function(){return this.count$Values(1)},i18n.phonenumbers.PhoneNumber.prototype.clearCountryCode=function(){this.clear$Field(1)},i18n.phonenumbers.PhoneNumber.prototype.getNationalNumber=function(){return this.get$Value(2)},i18n.phonenumbers.PhoneNumber.prototype.getNationalNumberOrDefault=function(){return this.get$ValueOrDefault(2)},i18n.phonenumbers.PhoneNumber.prototype.setNationalNumber=function(e){this.set$Value(2,e)},i18n.phonenumbers.PhoneNumber.prototype.hasNationalNumber=function(){return this.has$Value(2)},i18n.phonenumbers.PhoneNumber.prototype.nationalNumberCount=function(){return this.count$Values(2)},i18n.phonenumbers.PhoneNumber.prototype.clearNationalNumber=function(){this.clear$Field(2)},i18n.phonenumbers.PhoneNumber.prototype.getExtension=function(){return this.get$Value(3)},i18n.phonenumbers.PhoneNumber.prototype.getExtensionOrDefault=function(){return this.get$ValueOrDefault(3)},i18n.phonenumbers.PhoneNumber.prototype.setExtension=function(e){this.set$Value(3,e)},i18n.phonenumbers.PhoneNumber.prototype.hasExtension=function(){return this.has$Value(3)},i18n.phonenumbers.PhoneNumber.prototype.extensionCount=function(){return this.count$Values(3)},i18n.phonenumbers.PhoneNumber.prototype.clearExtension=function(){this.clear$Field(3)},i18n.phonenumbers.PhoneNumber.prototype.getItalianLeadingZero=function(){return this.get$Value(4)},i18n.phonenumbers.PhoneNumber.prototype.getItalianLeadingZeroOrDefault=function(){return this.get$ValueOrDefault(4)},i18n.phonenumbers.PhoneNumber.prototype.setItalianLeadingZero=function(e){this.set$Value(4,e)},i18n.phonenumbers.PhoneNumber.prototype.hasItalianLeadingZero=function(){return this.has$Value(4)},i18n.phonenumbers.PhoneNumber.prototype.italianLeadingZeroCount=function(){return this.count$Values(4)},i18n.phonenumbers.PhoneNumber.prototype.clearItalianLeadingZero=function(){this.clear$Field(4);
},i18n.phonenumbers.PhoneNumber.prototype.getNumberOfLeadingZeros=function(){return this.get$Value(8)},i18n.phonenumbers.PhoneNumber.prototype.getNumberOfLeadingZerosOrDefault=function(){return this.get$ValueOrDefault(8)},i18n.phonenumbers.PhoneNumber.prototype.setNumberOfLeadingZeros=function(e){this.set$Value(8,e)},i18n.phonenumbers.PhoneNumber.prototype.hasNumberOfLeadingZeros=function(){return this.has$Value(8)},i18n.phonenumbers.PhoneNumber.prototype.numberOfLeadingZerosCount=function(){return this.count$Values(8)},i18n.phonenumbers.PhoneNumber.prototype.clearNumberOfLeadingZeros=function(){this.clear$Field(8)},i18n.phonenumbers.PhoneNumber.prototype.getRawInput=function(){return this.get$Value(5)},i18n.phonenumbers.PhoneNumber.prototype.getRawInputOrDefault=function(){return this.get$ValueOrDefault(5)},i18n.phonenumbers.PhoneNumber.prototype.setRawInput=function(e){this.set$Value(5,e)},i18n.phonenumbers.PhoneNumber.prototype.hasRawInput=function(){return this.has$Value(5)},i18n.phonenumbers.PhoneNumber.prototype.rawInputCount=function(){return this.count$Values(5)},i18n.phonenumbers.PhoneNumber.prototype.clearRawInput=function(){this.clear$Field(5)},i18n.phonenumbers.PhoneNumber.prototype.getCountryCodeSource=function(){return this.get$Value(6)},i18n.phonenumbers.PhoneNumber.prototype.getCountryCodeSourceOrDefault=function(){return this.get$ValueOrDefault(6)},i18n.phonenumbers.PhoneNumber.prototype.setCountryCodeSource=function(e){this.set$Value(6,e)},i18n.phonenumbers.PhoneNumber.prototype.hasCountryCodeSource=function(){return this.has$Value(6)},i18n.phonenumbers.PhoneNumber.prototype.countryCodeSourceCount=function(){return this.count$Values(6)},i18n.phonenumbers.PhoneNumber.prototype.clearCountryCodeSource=function(){this.clear$Field(6)},i18n.phonenumbers.PhoneNumber.prototype.getPreferredDomesticCarrierCode=function(){return this.get$Value(7)},i18n.phonenumbers.PhoneNumber.prototype.getPreferredDomesticCarrierCodeOrDefault=function(){return this.get$ValueOrDefault(7)},i18n.phonenumbers.PhoneNumber.prototype.setPreferredDomesticCarrierCode=function(e){this.set$Value(7,e)},i18n.phonenumbers.PhoneNumber.prototype.hasPreferredDomesticCarrierCode=function(){return this.has$Value(7)},i18n.phonenumbers.PhoneNumber.prototype.preferredDomesticCarrierCodeCount=function(){return this.count$Values(7)},i18n.phonenumbers.PhoneNumber.prototype.clearPreferredDomesticCarrierCode=function(){this.clear$Field(7)},i18n.phonenumbers.PhoneNumber.CountryCodeSource={FROM_NUMBER_WITH_PLUS_SIGN:1,FROM_NUMBER_WITH_IDD:5,FROM_NUMBER_WITHOUT_PLUS_SIGN:10,FROM_DEFAULT_COUNTRY:20},i18n.phonenumbers.PhoneNumber.prototype.getDescriptor=function(){return i18n.phonenumbers.PhoneNumber.descriptor_||(i18n.phonenumbers.PhoneNumber.descriptor_=goog.proto2.Message.createDescriptor(i18n.phonenumbers.PhoneNumber,{0:{name:"PhoneNumber",fullName:"i18n.phonenumbers.PhoneNumber"},1:{name:"country_code",required:!0,fieldType:goog.proto2.Message.FieldType.INT32,type:Number},2:{name:"national_number",required:!0,fieldType:goog.proto2.Message.FieldType.UINT64,type:Number},3:{name:"extension",fieldType:goog.proto2.Message.FieldType.STRING,type:String},4:{name:"italian_leading_zero",fieldType:goog.proto2.Message.FieldType.BOOL,type:Boolean},8:{name:"number_of_leading_zeros",fieldType:goog.proto2.Message.FieldType.INT32,defaultValue:1,type:Number},5:{name:"raw_input",fieldType:goog.proto2.Message.FieldType.STRING,type:String},6:{name:"country_code_source",fieldType:goog.proto2.Message.FieldType.ENUM,defaultValue:i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_NUMBER_WITH_PLUS_SIGN,type:i18n.phonenumbers.PhoneNumber.CountryCodeSource},7:{name:"preferred_domestic_carrier_code",fieldType:goog.proto2.Message.FieldType.STRING,type:String}})),i18n.phonenumbers.PhoneNumber.descriptor_},i18n.phonenumbers.PhoneNumber.ctor=i18n.phonenumbers.PhoneNumber,i18n.phonenumbers.PhoneNumber.ctor.getDescriptor=i18n.phonenumbers.PhoneNumber.prototype.getDescriptor,i18n.phonenumbers.metadata={},i18n.phonenumbers.metadata.countryCodeToRegionCodeMap={1:"US AG AI AS BB BM BS CA DM DO GD GU JM KN KY LC MP MS PR SX TC TT VC VG VI".split(" "),7:["RU","KZ"],20:["EG"],27:["ZA"],30:["GR"],31:["NL"],32:["BE"],33:["FR"],34:["ES"],36:["HU"],39:["IT","VA"],40:["RO"],41:["CH"],43:["AT"],44:["GB","GG","IM","JE"],45:["DK"],46:["SE"],47:["NO","SJ"],48:["PL"],49:["DE"],51:["PE"],52:["MX"],53:["CU"],54:["AR"],55:["BR"],56:["CL"],57:["CO"],58:["VE"],60:["MY"],61:["AU","CC","CX"],62:["ID"],63:["PH"],64:["NZ"],65:["SG"],66:["TH"],81:["JP"],82:["KR"],84:["VN"],86:["CN"],90:["TR"],91:["IN"],92:["PK"],93:["AF"],94:["LK"],95:["MM"],98:["IR"],211:["SS"],212:["MA","EH"],213:["DZ"],216:["TN"],218:["LY"],220:["GM"],221:["SN"],222:["MR"],223:["ML"],224:["GN"],225:["CI"],226:["BF"],227:["NE"],228:["TG"],229:["BJ"],230:["MU"],231:["LR"],232:["SL"],233:["GH"],234:["NG"],235:["TD"],236:["CF"],237:["CM"],238:["CV"],239:["ST"],240:["GQ"],241:["GA"],242:["CG"],243:["CD"],244:["AO"],245:["GW"],246:["IO"],247:["AC"],248:["SC"],249:["SD"],250:["RW"],251:["ET"],252:["SO"],253:["DJ"],254:["KE"],255:["TZ"],256:["UG"],257:["BI"],258:["MZ"],260:["ZM"],261:["MG"],262:["RE","YT"],263:["ZW"],264:["NA"],265:["MW"],266:["LS"],267:["BW"],268:["SZ"],269:["KM"],290:["SH","TA"],291:["ER"],297:["AW"],298:["FO"],299:["GL"],350:["GI"],351:["PT"],352:["LU"],353:["IE"],354:["IS"],355:["AL"],356:["MT"],357:["CY"],358:["FI","AX"],359:["BG"],370:["LT"],371:["LV"],372:["EE"],373:["MD"],374:["AM"],375:["BY"],376:["AD"],377:["MC"],378:["SM"],380:["UA"],381:["RS"],382:["ME"],385:["HR"],386:["SI"],387:["BA"],389:["MK"],420:["CZ"],421:["SK"],423:["LI"],500:["FK"],501:["BZ"],502:["GT"],503:["SV"],504:["HN"],505:["NI"],506:["CR"],507:["PA"],508:["PM"],509:["HT"],590:["GP","BL","MF"],591:["BO"],592:["GY"],593:["EC"],594:["GF"],595:["PY"],596:["MQ"],597:["SR"],598:["UY"],599:["CW","BQ"],670:["TL"],672:["NF"],673:["BN"],674:["NR"],675:["PG"],676:["TO"],677:["SB"],678:["VU"],679:["FJ"],680:["PW"],681:["WF"],682:["CK"],683:["NU"],685:["WS"],686:["KI"],687:["NC"],688:["TV"],689:["PF"],690:["TK"],691:["FM"],692:["MH"],800:["001"],808:["001"],850:["KP"],852:["HK"],853:["MO"],855:["KH"],856:["LA"],870:["001"],878:["001"],880:["BD"],881:["001"],882:["001"],883:["001"],886:["TW"],888:["001"],960:["MV"],961:["LB"],962:["JO"],963:["SY"],964:["IQ"],965:["KW"],966:["SA"],967:["YE"],968:["OM"],970:["PS"],971:["AE"],972:["IL"],973:["BH"],974:["QA"],975:["BT"],976:["MN"],977:["NP"],979:["001"],992:["TJ"],993:["TM"],994:["AZ"],995:["GE"],996:["KG"],998:["UZ"]},i18n.phonenumbers.metadata.countryToMetadata={AC:[,[,,"[46]\\d{4}|[01589]\\d{5}","\\d{5,6}"],[,,"6[2-467]\\d{3}","\\d{5}",,,"62889"],[,,"4\\d{4}","\\d{5}",,,"40123"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"AC",247,"00",,,,,,,,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"[01589]\\d{5}","\\d{6}",,,"542011"],,,[,,"NA","NA"]],AD:[,[,,"(?:[346-9]|180)\\d{5}","\\d{6,8}"],[,,"[78]\\d{5}","\\d{6}",,,"712345"],[,,"[346]\\d{5}","\\d{6}",,,"312345"],[,,"180[02]\\d{4}","\\d{8}",,,"18001234"],[,,"9\\d{5}","\\d{6}",,,"912345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"AD",376,"00",,,,,,,,[[,"(\\d{3})(\\d{3})","$1 $2",["[346-9]"]],[,"(180[02])(\\d{4})","$1 $2",["1"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],AE:[,[,,"[2-79]\\d{7,8}|800\\d{2,9}","\\d{5,12}"],[,,"[2-4679][2-8]\\d{6}","\\d{7,8}",,,"22345678"],[,,"5[024-6]\\d{7}","\\d{9}",,,"501234567"],[,,"400\\d{6}|800\\d{2,9}","\\d{5,12}",,,"800123456"],[,,"900[02]\\d{5}","\\d{9}",,,"900234567"],[,,"700[05]\\d{5}","\\d{9}",,,"700012345"],[,,"NA","NA"],[,,"NA","NA"],"AE",971,"00","0",,,"0",,,,[[,"([2-4679])(\\d{3})(\\d{4})","$1 $2 $3",["[2-4679][2-8]"],"0$1"],[,"(5\\d)(\\d{3})(\\d{4})","$1 $2 $3",["5"],"0$1"],[,"([479]00)(\\d)(\\d{5})","$1 $2 $3",["[479]0"],"$1"],[,"([68]00)(\\d{2,9})","$1 $2",["60|8"],"$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"600[25]\\d{5}","\\d{9}",,,"600212345"],,,[,,"NA","NA"]],AF:[,[,,"[2-7]\\d{8}","\\d{7,9}"],[,,"(?:[25][0-8]|[34][0-4]|6[0-5])[2-9]\\d{6}","\\d{7,9}",,,"234567890"],[,,"7(?:[014-9]\\d{7}|2[89]\\d{6})","\\d{9}",,,"701234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"AF",93,"00","0",,,"0",,,,[[,"([2-7]\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[2-7]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],AG:[,[,,"[2589]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"268(?:4(?:6[0-38]|84)|56[0-2])\\d{4}","\\d{7}(?:\\d{3})?",,,"2684601234"],[,,"268(?:464|7(?:2[0-9]|64|7[0-689]|8[02-68]))\\d{4}","\\d{10}",,,"2684641234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"26848[01]\\d{4}","\\d{10}",,,"2684801234"],"AG",1,"011","1",,,"1",,,,,,[,,"26840[69]\\d{4}","\\d{10}",,,"2684061234"],,"268",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],AI:[,[,,"[2589]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"2644(?:6[12]|9[78])\\d{4}","\\d{7}(?:\\d{3})?",,,"2644612345"],[,,"264(?:235|476|5(?:3[6-9]|8[1-4])|7(?:29|72))\\d{4}","\\d{10}",,,"2642351234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"AI",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"264",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],AL:[,[,,"[2-57]\\d{7}|6\\d{8}|8\\d{5,7}|9\\d{5}","\\d{5,9}"],[,,"(?:2(?:[168][1-9]|[247]\\d|9[1-7])|3(?:1[1-3]|[2-6]\\d|[79][1-8]|8[1-9])|4\\d{2}|5(?:1[1-4]|[2-578]\\d|6[1-5]|9[1-7])|8(?:[19][1-5]|[2-6]\\d|[78][1-7]))\\d{5}","\\d{5,8}",,,"22345678"],[,,"6[6-9]\\d{7}","\\d{9}",,,"661234567"],[,,"800\\d{4}","\\d{7}",,,"8001234"],[,,"900\\d{3}","\\d{6}",,,"900123"],[,,"808\\d{3}","\\d{6}",,,"808123"],[,,"700\\d{5}","\\d{8}",,,"70012345"],[,,"NA","NA"],"AL",355,"00","0",,,"0",,,,[[,"(4)(\\d{3})(\\d{4})","$1 $2 $3",["4[0-6]"],"0$1"],[,"(6[6-9])(\\d{3})(\\d{4})","$1 $2 $3",["6"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[2358][2-5]|4[7-9]"],"0$1"],[,"(\\d{3})(\\d{3,5})","$1 $2",["[235][16-9]|8[016-9]|[79]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],AM:[,[,,"[1-9]\\d{7}","\\d{5,8}"],[,,"(?:1[01]\\d|2(?:2[2-46]|3[1-8]|4[2-69]|5[2-7]|6[1-9]|8[1-7])|3[12]2|47\\d)\\d{5}","\\d{5,8}",,,"10123456"],[,,"(?:4[139]|55|77|9[1-9])\\d{6}","\\d{8}",,,"77123456"],[,,"800\\d{5}","\\d{8}",,,"80012345"],[,,"90[016]\\d{5}","\\d{8}",,,"90012345"],[,,"80[1-4]\\d{5}","\\d{8}",,,"80112345"],[,,"NA","NA"],[,,"60[2-6]\\d{5}","\\d{8}",,,"60271234"],"AM",374,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{6})","$1 $2",["1|47"],"(0$1)"],[,"(\\d{2})(\\d{6})","$1 $2",["4[139]|[5-7]|9[1-9]"],"0$1"],[,"(\\d{3})(\\d{5})","$1 $2",["[23]"],"(0$1)"],[,"(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["8|90"],"0 $1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],AO:[,[,,"[29]\\d{8}","\\d{9}"],[,,"2\\d(?:[26-9]\\d|\\d[26-9])\\d{5}","\\d{9}",,,"222123456"],[,,"9[1-49]\\d{7}","\\d{9}",,,"923123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"AO",244,"00",,,,,,,,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],AR:[,[,,"11\\d{8}|[2368]\\d{9}|9\\d{10}","\\d{6,11}"],[,,"11\\d{8}|(?:2(?:2(?:[013]\\d|2[13-79]|4[1-6]|5[2457]|6[124-8]|7[1-4]|8[13-6]|9[1267])|3(?:1[467]|2[03-6]|3[13-8]|[49][2-6]|5[2-8]|[067]\\d)|4(?:7[3-8]|9\\d)|6(?:[01346]\\d|2[24-6]|5[15-8])|80\\d|9(?:[0124789]\\d|3[1-6]|5[234]|6[2-46]))|3(?:3(?:2[79]|6\\d|8[2578])|4(?:[78]\\d|0[0124-9]|[1-35]\\d|4[24-7]|6[02-9]|9[123678])|5(?:[138]\\d|2[1245]|4[1-9]|6[2-4]|7[1-6])|6[24]\\d|7(?:[0469]\\d|1[1568]|2[013-9]|3[145]|5[14-8]|7[2-57]|8[0-24-9])|8(?:[013578]\\d|2[15-7]|4[13-6]|6[1-357-9]|9[124]))|670\\d)\\d{6}","\\d{6,10}",,,"1123456789"],[,,"675\\d{7}|9(?:11[2-9]\\d{7}|(?:2(?:2[013]|3[067]|49|6[01346]|80|9[147-9])|3(?:36|4[12358]|5[138]|6[24]|7[069]|8[013578]))[2-9]\\d{6}|\\d{4}[2-9]\\d{5})","\\d{6,11}",,,"91123456789"],[,,"800\\d{7}","\\d{10}",,,"8001234567"],[,,"60[04579]\\d{7}","\\d{10}",,,"6001234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"AR",54,"00","0",,,"0?(?:(11|2(?:2(?:02?|[13]|2[13-79]|4[1-6]|5[2457]|6[124-8]|7[1-4]|8[13-6]|9[1267])|3(?:02?|1[467]|2[03-6]|3[13-8]|[49][2-6]|5[2-8]|[67])|4(?:7[3-578]|9)|6(?:[0136]|2[24-6]|4[6-8]?|5[15-8])|80|9(?:0[1-3]|[19]|2\\d|3[1-6]|4[02568]?|5[2-4]|6[2-46]|72?|8[23]?))|3(?:3(?:2[79]|6|8[2578])|4(?:0[0-24-9]|[12]|3[5-8]?|4[24-7]|5[4-68]?|6[02-9]|7[126]|8[2379]?|9[1-36-8])|5(?:1|2[1245]|3[237]?|4[1-46-9]|6[2-4]|7[1-6]|8[2-5]?)|6[24]|7(?:[069]|1[1568]|2[15]|3[145]|4[13]|5[14-8]|7[2-57]|8[126])|8(?:[01]|2[15-7]|3[2578]?|4[13-6]|5[4-8]?|6[1-357-9]|7[36-8]?|8[5-8]?|9[124])))?15)?","9$1",,,[[,"([68]\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["[68]"],"0$1"],[,"(\\d{2})(\\d{4})","$1-$2",["[2-9]"],"$1"],[,"(\\d{3})(\\d{4})","$1-$2",["[2-9]"],"$1"],[,"(\\d{4})(\\d{4})","$1-$2",["[2-9]"],"$1"],[,"(9)(11)(\\d{4})(\\d{4})","$2 15-$3-$4",["911"],"0$1"],[,"(9)(\\d{3})(\\d{3})(\\d{4})","$2 15-$3-$4",["9(?:2[234689]|3[3-8])","9(?:2(?:2[013]|3[067]|49|6[01346]|80|9[147-9])|3(?:36|4[1-358]|5[138]|6[24]|7[069]|8[013578]))","9(?:2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3[456]|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45])))","9(?:2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3(?:4|5[014]|6[1239])|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45])))"],"0$1"],[,"(9)(\\d{4})(\\d{2})(\\d{4})","$2 15-$3-$4",["9[23]"],"0$1"],[,"(11)(\\d{4})(\\d{4})","$1 $2-$3",["1"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2-$3",["2(?:2[013]|3[067]|49|6[01346]|80|9[147-9])|3(?:36|4[1-358]|5[138]|6[24]|7[069]|8[013578])","2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3[456]|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45]))","2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3(?:4|5[014]|6[1239])|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45]))"],"0$1",,1],[,"(\\d{4})(\\d{2})(\\d{4})","$1 $2-$3",["[23]"],"0$1",,1],[,"(\\d{3})","$1",["1[012]|911"],"$1"]],[[,"([68]\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["[68]"],"0$1"],[,"(9)(11)(\\d{4})(\\d{4})","$1 $2 $3-$4",["911"]],[,"(9)(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3-$4",["9(?:2[234689]|3[3-8])","9(?:2(?:2[013]|3[067]|49|6[01346]|80|9[147-9])|3(?:36|4[1-358]|5[138]|6[24]|7[069]|8[013578]))","9(?:2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3[456]|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45])))","9(?:2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3(?:4|5[014]|6[1239])|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45])))"]],[,"(9)(\\d{4})(\\d{2})(\\d{4})","$1 $2 $3-$4",["9[23]"]],[,"(11)(\\d{4})(\\d{4})","$1 $2-$3",["1"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2-$3",["2(?:2[013]|3[067]|49|6[01346]|80|9[147-9])|3(?:36|4[1-358]|5[138]|6[24]|7[069]|8[013578])","2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3[456]|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45]))","2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3(?:4|5[014]|6[1239])|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45]))"],"0$1",,1],[,"(\\d{4})(\\d{2})(\\d{4})","$1 $2-$3",["[23]"],"0$1",,1]],[,,"NA","NA"],,,[,,"810\\d{7}","\\d{10}",,,"8101234567"],[,,"810\\d{7}","\\d{10}",,,"8101234567"],,,[,,"NA","NA"]],AS:[,[,,"[5689]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"6846(?:22|33|44|55|77|88|9[19])\\d{4}","\\d{7}(?:\\d{3})?",,,"6846221234"],[,,"684(?:2(?:5[2468]|72)|7(?:3[13]|70))\\d{4}","\\d{10}",,,"6847331234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"AS",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"684",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],AT:[,[,,"[1-9]\\d{3,12}","\\d{3,13}"],[,,"1\\d{3,12}|(?:2(?:1[467]|2[13-8]|5[2357]|6[1-46-8]|7[1-8]|8[124-7]|9[1458])|3(?:1[1-8]|3[23568]|4[5-7]|5[1378]|6[1-38]|8[3-68])|4(?:2[1-8]|35|63|7[1368]|8[2457])|5(?:12|2[1-8]|3[357]|4[147]|5[12578]|6[37])|6(?:13|2[1-47]|4[1-35-8]|5[468]|62)|7(?:2[1-8]|3[25]|4[13478]|5[68]|6[16-8]|7[1-6]|9[45]))\\d{3,10}","\\d{3,13}",,,"1234567890"],[,,"6(?:5[0-3579]|6[013-9]|[7-9]\\d)\\d{4,10}","\\d{7,13}",,,"664123456"],[,,"800\\d{6,10}","\\d{9,13}",,,"800123456"],[,,"(?:9(?:0[01]|3[019]))\\d{6,10}","\\d{9,13}",,,"900123456"],[,,"8(?:10\\d|2(?:[01]\\d|8\\d?))\\d{5,9}","\\d{8,13}",,,"810123456"],[,,"NA","NA"],[,,"780\\d{6,10}","\\d{9,13}",,,"780123456"],"AT",43,"00","0",,,"0",,,,[[,"(116\\d{3})","$1",["116"],"$1"],[,"(1)(\\d{3,12})","$1 $2",["1"],"0$1"],[,"(5\\d)(\\d{3,5})","$1 $2",["5[079]"],"0$1"],[,"(5\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["5[079]"],"0$1"],[,"(5\\d)(\\d{4})(\\d{4,7})","$1 $2 $3",["5[079]"],"0$1"],[,"(\\d{3})(\\d{3,10})","$1 $2",["316|46|51|732|6(?:5[0-3579]|[6-9])|7(?:[28]0)|[89]"],"0$1"],[,"(\\d{4})(\\d{3,9})","$1 $2",["2|3(?:1[1-578]|[3-8])|4[2378]|5[2-6]|6(?:[12]|4[1-9]|5[468])|7(?:2[1-8]|35|4[1-8]|[5-79])"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"5(?:(?:0[1-9]|17)\\d{2,10}|[79]\\d{3,11})|720\\d{6,10}","\\d{5,13}",,,"50123"],,,[,,"NA","NA"]],AU:[,[,,"[1-578]\\d{5,9}","\\d{6,10}"],[,,"[237]\\d{8}|8(?:[6-8]\\d{3}|9(?:[02-9]\\d{2}|1(?:[0-57-9]\\d|6[0135-9])))\\d{4}","\\d{8,9}",,,"212345678"],[,,"14(?:5\\d|71)\\d{5}|4(?:[0-3]\\d|4[47-9]|5[0-25-9]|6[6-9]|7[02-9]|8[147-9]|9[017-9])\\d{6}","\\d{9}",,,"412345678"],[,,"180(?:0\\d{3}|2)\\d{3}","\\d{7,10}",,,"1800123456"],[,,"19(?:0[0126]\\d|[679])\\d{5}","\\d{8,10}",,,"1900123456"],[,,"13(?:00\\d{3}|45[0-4]|\\d)\\d{3}","\\d{6,10}",,,"1300123456"],[,,"500\\d{6}","\\d{9}",,,"500123456"],[,,"550\\d{6}","\\d{9}",,,"550123456"],"AU",61,"(?:14(?:1[14]|34|4[17]|[56]6|7[47]|88))?001[14-689]","0",,,"0",,"0011",,[[,"([2378])(\\d{4})(\\d{4})","$1 $2 $3",["[2378]"],"(0$1)"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[45]|14"],"0$1"],[,"(16)(\\d{3})(\\d{2,4})","$1 $2 $3",["16"],"0$1"],[,"(1[389]\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["1(?:[38]0|90)","1(?:[38]00|90)"],"$1"],[,"(180)(2\\d{3})","$1 $2",["180","1802"],"$1"],[,"(19\\d)(\\d{3})","$1 $2",["19[13]"],"$1"],[,"(19\\d{2})(\\d{4})","$1 $2",["19[679]"],"$1"],[,"(13)(\\d{2})(\\d{2})","$1 $2 $3",["13[1-9]"],"$1"]],,[,,"16\\d{3,7}","\\d{5,9}",,,"1612345"],1,,[,,"1(?:3(?:00\\d{3}|45[0-4]|\\d)\\d{3}|80(?:0\\d{6}|2\\d{3}))","\\d{6,10}",,,"1300123456"],[,,"NA","NA"],,,[,,"NA","NA"]],AW:[,[,,"[25-9]\\d{6}","\\d{7}"],[,,"5(?:2\\d|8[1-9])\\d{4}","\\d{7}",,,"5212345"],[,,"(?:5(?:6\\d|9[2-478])|6(?:[039]0|22|4[01]|6[0-2])|7[34]\\d|9(?:6[45]|9[4-8]))\\d{4}","\\d{7}",,,"5601234"],[,,"800\\d{4}","\\d{7}",,,"8001234"],[,,"900\\d{4}","\\d{7}",,,"9001234"],[,,"NA","NA"],[,,"NA","NA"],[,,"28\\d{5}|501\\d{4}","\\d{7}",,,"5011234"],"AW",297,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],AX:[,[,,"[135]\\d{5,9}|[27]\\d{4,9}|4\\d{5,10}|6\\d{7,8}|8\\d{6,9}","\\d{5,12}"],[,,"18[1-8]\\d{3,9}","\\d{6,12}",,,"1812345678"],[,,"4\\d{5,10}|50\\d{4,8}","\\d{6,11}",,,"412345678"],[,,"800\\d{4,7}","\\d{7,10}",,,"8001234567"],[,,"[67]00\\d{5,6}","\\d{8,9}",,,"600123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"AX",358,"00|99[049]","0",,,"0",,,,,,[,,"NA","NA"],,,[,,"[13]00\\d{3,7}|2(?:0(?:0\\d{3,7}|2[023]\\d{1,6}|9[89]\\d{1,6}))|60(?:[12]\\d{5,6}|6\\d{7})|7(?:1\\d{7}|3\\d{8}|5[03-9]\\d{2,7})","\\d{5,10}",,,"100123"],[,,"[13]0\\d{4,8}|2(?:0(?:[016-8]\\d{3,7}|[2-59]\\d{2,7})|9\\d{4,8})|60(?:[12]\\d{5,6}|6\\d{7})|7(?:1\\d{7}|3\\d{8}|5[03-9]\\d{2,7})","\\d{5,10}",,,"10112345"],,,[,,"NA","NA"]],AZ:[,[,,"[1-9]\\d{8}","\\d{7,9}"],[,,"(?:1[28]\\d{3}|2(?:02|1[24]|2[2-4]|33|[45]2|6[23])\\d{2}|365(?:[0-46-9]\\d|5[0-35-9]))\\d{4}","\\d{7,9}",,,"123123456"],[,,"(?:36554|(?:4[04]|5[015]|60|7[07])\\d{3})\\d{4}","\\d{9}",,,"401234567"],[,,"88\\d{7}","\\d{9}",,,"881234567"],[,,"900200\\d{3}","\\d{9}",,,"900200123"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"AZ",994,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["(?:1[28]|2(?:[45]2|[0-36])|365)"],"(0$1)"],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[4-8]"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["9"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],BA:[,[,,"[3-9]\\d{7,8}","\\d{6,9}"],[,,"(?:[35]\\d|49)\\d{6}","\\d{6,8}",,,"30123456"],[,,"6(?:03|44|71|[1-356])\\d{6}","\\d{8,9}",,,"61123456"],[,,"8[08]\\d{6}","\\d{8}",,,"80123456"],[,,"9[0246]\\d{6}","\\d{8}",,,"90123456"],[,,"8[12]\\d{6}","\\d{8}",,,"82123456"],[,,"NA","NA"],[,,"NA","NA"],"BA",387,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2-$3",["[3-5]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["6[1-356]|[7-9]"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["6[047]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"70[23]\\d{5}","\\d{8}",,,"70223456"],,,[,,"NA","NA"]],BB:[,[,,"[2589]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"246(?:2(?:2[78]|7[0-4])|4(?:1[024-6]|2\\d|3[2-9])|5(?:20|[34]\\d|54|7[1-3])|6(?:2\\d|38)|7(?:37|57)|9(?:1[89]|63))\\d{4}","\\d{7}(?:\\d{3})?",,,"2464123456"],[,,"246(?:2(?:[356]\\d|4[0-57-9]|8[0-79])|45\\d|8(?:[2-5]\\d|83))\\d{4}","\\d{10}",,,"2462501234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900\\d{7}|246976\\d{4}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"24631\\d{5}","\\d{10}",,,"2463101234"],"BB",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"246",[,,"NA","NA"],[,,"246(?:292|41[7-9]|43[01])\\d{4}","\\d{10}",,,"2464301234"],,,[,,"NA","NA"]],BD:[,[,,"[2-79]\\d{5,9}|1\\d{9}|8[0-7]\\d{4,8}","\\d{6,10}"],[,,"2(?:550\\d|7(?:1[0-267]|2[0-289]|3[0-29]|[46][01]|5[1-3]|7[017]|91)|8(?:0[125]|[139][1-6]|2[0157-9]|6[1-35]|7[1-5]|8[1-8]|90)|9(?:0[0-2]|1[0-4]|2[568]|3[3-6]|5[5-7]|6[0167]|7[15]|8[0146-8]))\\d{4}|3(?:12?[5-7]\\d{2}|0(?:2(?:[025-79]\\d|[348]\\d{1,2})|3(?:[2-4]\\d|[56]\\d?))|2(?:1\\d{2}|2(?:[12]\\d|[35]\\d{1,2}|4\\d?))|3(?:1\\d{2}|2(?:[2356]\\d|4\\d{1,2}))|4(?:1\\d{2}|2(?:2\\d{1,2}|[47]|5\\d{2}))|5(?:1\\d{2}|29)|[67]1\\d{2}|8(?:1\\d{2}|2(?:2\\d{2}|3|4\\d)))\\d{3}|4(?:0(?:2(?:[09]\\d|7)|33\\d{2})|1\\d{3}|2(?:1\\d{2}|2(?:[25]\\d?|[348]\\d|[67]\\d{1,2}))|3(?:1\\d{2}(?:\\d{2})?|2(?:[045]\\d|[236-9]\\d{1,2})|32\\d{2})|4(?:[18]\\d{2}|2(?:[2-46]\\d{2}|3)|5[25]\\d{2})|5(?:1\\d{2}|2(?:3\\d|5))|6(?:[18]\\d{2}|2(?:3(?:\\d{2})?|[46]\\d{1,2}|5\\d{2}|7\\d)|5(?:3\\d?|4\\d|[57]\\d{1,2}|6\\d{2}|8))|71\\d{2}|8(?:[18]\\d{2}|23\\d{2}|54\\d{2})|9(?:[18]\\d{2}|2[2-5]\\d{2}|53\\d{1,2}))\\d{3}|5(?:02[03489]\\d{2}|1\\d{2}|2(?:1\\d{2}|2(?:2(?:\\d{2})?|[457]\\d{2}))|3(?:1\\d{2}|2(?:[37](?:\\d{2})?|[569]\\d{2}))|4(?:1\\d{2}|2[46]\\d{2})|5(?:1\\d{2}|26\\d{1,2})|6(?:[18]\\d{2}|2|53\\d{2})|7(?:1|24)\\d{2}|8(?:1|26)\\d{2}|91\\d{2})\\d{3}|6(?:0(?:1\\d{2}|2(?:3\\d{2}|4\\d{1,2}))|2(?:2[2-5]\\d{2}|5(?:[3-5]\\d{2}|7)|8\\d{2})|3(?:1|2[3478])\\d{2}|4(?:1|2[34])\\d{2}|5(?:1|2[47])\\d{2}|6(?:[18]\\d{2}|6(?:2(?:2\\d|[34]\\d{2})|5(?:[24]\\d{2}|3\\d|5\\d{1,2})))|72[2-5]\\d{2}|8(?:1\\d{2}|2[2-5]\\d{2})|9(?:1\\d{2}|2[2-6]\\d{2}))\\d{3}|7(?:(?:02|[3-589]1|6[12]|72[24])\\d{2}|21\\d{3}|32)\\d{3}|8(?:(?:4[12]|[5-7]2|1\\d?)|(?:0|3[12]|[5-7]1|217)\\d)\\d{4}|9(?:[35]1|(?:[024]2|81)\\d|(?:1|[24]1)\\d{2})\\d{3}","\\d{6,9}",,,"27111234"],[,,"(?:1[13-9]\\d|(?:3[78]|44)[02-9]|6(?:44|6[02-9]))\\d{7}","\\d{10}",,,"1812345678"],[,,"80[03]\\d{7}","\\d{10}",,,"8001234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"96(?:0[49]|1[0-4]|6[69])\\d{6}","\\d{10}",,,"9604123456"],"BD",880,"00","0",,,"0",,,,[[,"(2)(\\d{7,8})","$1-$2",["2"],"0$1"],[,"(\\d{2})(\\d{4,6})","$1-$2",["[3-79]1"],"0$1"],[,"(\\d{4})(\\d{3,6})","$1-$2",["1|3(?:0|[2-58]2)|4(?:0|[25]2|3[23]|[4689][25])|5(?:[02-578]2|6[25])|6(?:[0347-9]2|[26][25])|7[02-9]2|8(?:[023][23]|[4-7]2)|9(?:[02][23]|[458]2|6[016])"],"0$1"],[,"(\\d{3})(\\d{3,7})","$1-$2",["[3-79][2-9]|8"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],BE:[,[,,"[1-9]\\d{7,8}","\\d{8,9}"],[,,"(?:1[0-69]|[23][2-8]|4[23]|5\\d|6[013-57-9]|71|8[1-79]|9[2-4])\\d{6}|80[2-8]\\d{5}","\\d{8}",,,"12345678"],[,,"4(?:6[0135-8]|[79]\\d|8[3-9])\\d{6}","\\d{9}",,,"470123456"],[,,"800\\d{5}","\\d{8}",,,"80012345"],[,,"(?:70[2-467]|90[0-79])\\d{5}","\\d{8}",,,"90123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"BE",32,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["4[6-9]"],"0$1"],[,"(\\d)(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[23]|4[23]|9[2-4]"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[156]|7[018]|8(?:0[1-9]|[1-79])"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["(?:80|9)0"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"78\\d{6}","\\d{8}",,,"78123456"],,,[,,"NA","NA"]],BF:[,[,,"[267]\\d{7}","\\d{8}"],[,,"2(?:0(?:49|5[23]|9[016-9])|4(?:4[569]|5[4-6]|7[0179])|5(?:[34]\\d|50))\\d{4}","\\d{8}",,,"20491234"],[,,"6(?:[0-689]\\d|7[0-5])\\d{5}|7\\d{7}","\\d{8}",,,"70123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"BF",226,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],BG:[,[,,"[23567]\\d{5,7}|[489]\\d{6,8}","\\d{5,9}"],[,,"2\\d{5,7}|(?:[36]\\d|5[1-9]|8[1-6]|9[1-7])\\d{5,6}|(?:4(?:[124-7]\\d|3[1-6])|7(?:0[1-9]|[1-9]\\d))\\d{4,5}","\\d{5,8}",,,"2123456"],[,,"(?:8[7-9]\\d|9(?:8\\d|99))\\d{6}|4(?:3[0789]|8\\d)\\d{5}","\\d{8,9}",,,"48123456"],[,,"800\\d{5}","\\d{8}",,,"80012345"],[,,"90\\d{6}","\\d{8}",,,"90123456"],[,,"NA","NA"],[,,"700\\d{5}","\\d{5,9}",,,"70012345"],[,,"NA","NA"],"BG",359,"00","0",,,"0",,,,[[,"(2)(\\d)(\\d{2})(\\d{2})","$1 $2 $3 $4",["2"],"0$1"],[,"(2)(\\d{3})(\\d{3,4})","$1 $2 $3",["2"],"0$1"],[,"(\\d{3})(\\d{4})","$1 $2",["43[124-7]|70[1-9]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{2})","$1 $2 $3",["43[124-7]|70[1-9]"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["[78]00"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["999"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2,3})","$1 $2 $3",["[356]|4[124-7]|7[1-9]|8[1-6]|9[1-7]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["48|8[7-9]|9[08]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],BH:[,[,,"[136-9]\\d{7}","\\d{8}"],[,,"(?:1(?:3[1356]|6[0156]|7\\d)\\d|6(?:1[16]\\d|500|6(?:0\\d|3[12]|44|7[7-9])|9[69][69])|7(?:1(?:11|78)|7\\d{2}))\\d{4}","\\d{8}",,,"17001234"],[,,"(?:3(?:[1-4679]\\d|5[013-69]|8[0-47-9])\\d|6(?:3(?:00|33|6[16])|6(?:[69]\\d|3[03-9]|7[0-6])))\\d{4}","\\d{8}",,,"36001234"],[,,"80\\d{6}","\\d{8}",,,"80123456"],[,,"(?:87|9[014578])\\d{6}","\\d{8}",,,"90123456"],[,,"84\\d{6}","\\d{8}",,,"84123456"],[,,"NA","NA"],[,,"NA","NA"],"BH",973,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],BI:[,[,,"[267]\\d{7}","\\d{8}"],[,,"22\\d{6}","\\d{8}",,,"22201234"],[,,"(?:29|6[189]|7[124-9])\\d{6}","\\d{8}",,,"79561234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"BI",257,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],BJ:[,[,,"[2689]\\d{7}|7\\d{3}","\\d{4,8}"],[,,"2(?:02|1[037]|2[45]|3[68])\\d{5}","\\d{8}",,,"20211234"],[,,"(?:6[1-8]|9[03-9])\\d{6}","\\d{8}",,,"90011234"],[,,"7[3-5]\\d{2}","\\d{4}",,,"7312"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"857[58]\\d{4}","\\d{8}",,,"85751234"],"BJ",229,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"81\\d{6}","\\d{8}",,,"81123456"],,,[,,"NA","NA"]],BL:[,[,,"[56]\\d{8}","\\d{9}"],[,,"590(?:2[7-9]|5[12]|87)\\d{4}","\\d{9}",,,"590271234"],[,,"690(?:0[0-7]|[1-9]\\d)\\d{4}","\\d{9}",,,"690301234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"BL",590,"00","0",,,"0",,,,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],BM:[,[,,"[4589]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"441(?:2(?:02|23|61|[3479]\\d)|[46]\\d{2}|5(?:4\\d|60|89)|824)\\d{4}","\\d{7}(?:\\d{3})?",,,"4412345678"],[,,"441(?:[37]\\d|5[0-39])\\d{5}","\\d{10}",,,"4413701234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"BM",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"441",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],BN:[,[,,"[2-578]\\d{6}","\\d{7}"],[,,"2(?:[013-9]\\d|2[0-7])\\d{4}|[3-5]\\d{6}","\\d{7}",,,"2345678"],[,,"22[89]\\d{4}|[78]\\d{6}","\\d{7}",,,"7123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"BN",673,"00",,,,,,,,[[,"([2-578]\\d{2})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],BO:[,[,,"[23467]\\d{7}","\\d{7,8}"],[,,"(?:2(?:2\\d{2}|5(?:11|[258]\\d|9[67])|6(?:12|2\\d|9[34])|8(?:2[34]|39|62))|3(?:3\\d{2}|4(?:6\\d|8[24])|8(?:25|42|5[257]|86|9[25])|9(?:2\\d|3[234]|4[248]|5[24]|6[2-6]|7\\d))|4(?:4\\d{2}|6(?:11|[24689]\\d|72)))\\d{4}","\\d{7,8}",,,"22123456"],[,,"[67]\\d{7}","\\d{8}",,,"71234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"BO",591,"00(1\\d)?","0",,,"0(1\\d)?",,,,[[,"([234])(\\d{7})","$1 $2",["[234]"],,"0$CC $1"],[,"([67]\\d{7})","$1",["[67]"],,"0$CC $1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],BQ:[,[,,"[347]\\d{6}","\\d{7}"],[,,"(?:318[023]|416[023]|7(?:1[578]|50)\\d)\\d{3}","\\d{7}",,,"7151234"],[,,"(?:318[14-68]|416[15-9]|7(?:0[01]|7[07]|[89]\\d)\\d)\\d{3}","\\d{7}",,,"3181234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"BQ",599,"00",,,,,,,,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],BR:[,[,,"[1-46-9]\\d{7,10}|5\\d{8,9}","\\d{8,11}"],[,,"(?:[14689][1-9]|2[12478]|3[1-578]|5[1-5]|7[13-579])[2-5]\\d{7}","\\d{8,11}",,,"1123456789"],[,,"1[1-9](?:7|9\\d)\\d{7}|(?:2[12478]|3[1-578]|[689][1-9]|7[13-579])(?:[6-8]|9\\d?)\\d{7}|(?:4[1-9]|5[1-5])[6-9]\\d{7}","\\d{10,11}",,,"11961234567"],[,,"800\\d{6,7}","\\d{8,11}",,,"800123456"],[,,"(?:300|[59]00\\d?)\\d{6}","\\d{8,11}",,,"300123456"],[,,"(?:300\\d(?:\\d{2})?|40(?:0\\d|20))\\d{4}","\\d{8,10}",,,"40041234"],[,,"NA","NA"],[,,"NA","NA"],"BR",55,"00(?:1[245]|2[1-35]|31|4[13]|[56]5|99)","0",,,"0(?:(1[245]|2[1-35]|31|4[13]|[56]5|99)(\\d{10,11}))?","$2",,,[[,"(\\d{4})(\\d{4})","$1-$2",["[2-9](?:[1-9]|0[1-9])"],"$1"],[,"(\\d{5})(\\d{4})","$1-$2",["9(?:[1-9]|0[1-9])"],"$1"],[,"(\\d{3,5})","$1",["1[125689]"],"$1"],[,"(\\d{2})(\\d{5})(\\d{4})","$1 $2-$3",["(?:[1689][1-9]|2[12478]|3[1-578]|7[13-579])9"],"($1)","0 $CC ($1)"],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2-$3",["[1-9][1-9]"],"($1)","0 $CC ($1)"],[,"(\\d{4})(\\d{4})","$1-$2",["(?:300|40(?:0|20))"]],[,"([3589]00)(\\d{2,3})(\\d{4})","$1 $2 $3",["[3589]00"],"0$1"]],[[,"(\\d{2})(\\d{5})(\\d{4})","$1 $2-$3",["(?:[1689][1-9]|2[12478]|3[1-578]|7[13-579])9"],"($1)","0 $CC ($1)"],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2-$3",["[1-9][1-9]"],"($1)","0 $CC ($1)"],[,"(\\d{4})(\\d{4})","$1-$2",["(?:300|40(?:0|20))"]],[,"([3589]00)(\\d{2,3})(\\d{4})","$1 $2 $3",["[3589]00"],"0$1"]],[,,"NA","NA"],,,[,,"(?:300\\d|40(?:0\\d|20))\\d{4}","\\d{8}",,,"40041234"],[,,"NA","NA"],,,[,,"NA","NA"]],BS:[,[,,"[2589]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"242(?:3(?:02|[236][1-9]|4[0-24-9]|5[0-68]|7[3467]|8[0-4]|9[2-467])|461|502|6(?:0[1-3]|12|7[67]|8[78]|9[89])|7(?:02|88))\\d{4}","\\d{7}(?:\\d{3})?",,,"2423456789"],[,,"242(?:3(?:5[79]|[79]5)|4(?:[2-4][1-9]|5[1-8]|6[2-8]|7\\d|81)|5(?:2[45]|3[35]|44|5[1-9]|65|77)|6[34]6|727)\\d{4}","\\d{10}",,,"2423591234"],[,,"242300\\d{4}|8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"BS",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"242",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],
BT:[,[,,"[1-8]\\d{6,7}","\\d{6,8}"],[,,"(?:2[3-6]|[34][5-7]|5[236]|6[2-46]|7[246]|8[2-4])\\d{5}","\\d{6,7}",,,"2345678"],[,,"(?:1[67]|77)\\d{6}","\\d{8}",,,"17123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"BT",975,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1|77"]],[,"([2-8])(\\d{3})(\\d{3})","$1 $2 $3",["[2-68]|7[246]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],BW:[,[,,"[2-79]\\d{6,7}","\\d{7,8}"],[,,"(?:2(?:4[0-48]|6[0-24]|9[0578])|3(?:1[0235-9]|55|[69]\\d|7[01])|4(?:6[03]|7[1267]|9[0-5])|5(?:3[0389]|4[0489]|7[1-47]|88|9[0-49])|6(?:2[1-35]|5[149]|8[067]))\\d{4}","\\d{7}",,,"2401234"],[,,"7(?:[1-6]\\d|7[014-8])\\d{5}","\\d{8}",,,"71123456"],[,,"NA","NA"],[,,"90\\d{5}","\\d{7}",,,"9012345"],[,,"NA","NA"],[,,"NA","NA"],[,,"79[12][01]\\d{4}","\\d{8}",,,"79101234"],"BW",267,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[2-6]"]],[,"(7\\d)(\\d{3})(\\d{3})","$1 $2 $3",["7"]],[,"(90)(\\d{5})","$1 $2",["9"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],BY:[,[,,"[1-4]\\d{8}|800\\d{3,7}|[89]\\d{9,10}","\\d{6,11}"],[,,"(?:1(?:5(?:1[1-5]|[24]\\d|6[2-4]|9[1-7])|6(?:[235]\\d|4[1-7])|7\\d{2})|2(?:1(?:[246]\\d|3[0-35-9]|5[1-9])|2(?:[235]\\d|4[0-8])|3(?:[26]\\d|3[02-79]|4[024-7]|5[03-7])))\\d{5}","\\d{6,11}",,,"152450911"],[,,"(?:2(?:5[5679]|9[1-9])|33\\d|44\\d)\\d{6}","\\d{9}",,,"294911911"],[,,"8(?:0[13]|20\\d)\\d{7}|800\\d{3,7}","\\d{6,11}",,,"8011234567"],[,,"(?:810|902)\\d{7}","\\d{10}",,,"9021234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"249\\d{6}","\\d{9}",,,"249123456"],"BY",375,"810","8",,,"8?0?",,"8~10",,[[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2-$3-$4",["17[0-3589]|2[4-9]|[34]","17(?:[02358]|1[0-2]|9[0189])|2[4-9]|[34]"],"8 0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2-$3-$4",["1(?:5[24]|6[235]|7[467])|2(?:1[246]|2[25]|3[26])","1(?:5[24]|6(?:2|3[04-9]|5[0346-9])|7(?:[46]|7[37-9]))|2(?:1[246]|2[25]|3[26])"],"8 0$1"],[,"(\\d{4})(\\d{2})(\\d{3})","$1 $2-$3",["1(?:5[169]|6[3-5]|7[179])|2(?:1[35]|2[34]|3[3-5])","1(?:5[169]|6(?:3[1-3]|4|5[125])|7(?:1[3-9]|7[0-24-6]|9[2-7]))|2(?:1[35]|2[34]|3[3-5])"],"8 0$1"],[,"([89]\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["8[01]|9"],"8 $1"],[,"(82\\d)(\\d{4})(\\d{4})","$1 $2 $3",["82"],"8 $1"],[,"(800)(\\d{3})","$1 $2",["800"],"8 $1"],[,"(800)(\\d{2})(\\d{2,4})","$1 $2 $3",["800"],"8 $1"]],,[,,"NA","NA"],,,[,,"8(?:[013]|[12]0)\\d{8}|800\\d{3,7}|902\\d{7}","\\d{6,11}",,,"82012345678"],[,,"NA","NA"],,,[,,"NA","NA"]],BZ:[,[,,"[2-8]\\d{6}|0\\d{10}","\\d{7}(?:\\d{4})?"],[,,"(?:[23458][02]\\d|7(?:[02]\\d|32))\\d{4}","\\d{7}",,,"2221234"],[,,"6[0-35-7]\\d{5}","\\d{7}",,,"6221234"],[,,"0800\\d{7}","\\d{11}",,,"08001234123"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"BZ",501,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1-$2",["[2-8]"]],[,"(0)(800)(\\d{4})(\\d{3})","$1-$2-$3-$4",["0"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],1,,[,,"NA","NA"]],CA:[,[,,"[2-9]\\d{9}|3\\d{6}","\\d{7}(?:\\d{3})?"],[,,"(?:2(?:04|[23]6|[48]9|50)|3(?:06|43|65)|4(?:03|1[68]|3[178]|50)|5(?:06|1[49]|48|79|8[17])|6(?:0[04]|13|22|39|47)|7(?:0[59]|78|8[02])|8(?:[06]7|19|25|73)|90[25])[2-9]\\d{6}|310\\d{4}","\\d{7}(?:\\d{3})?",,,"2042345678"],[,,"(?:2(?:04|[23]6|[48]9|50)|3(?:06|43|65)|4(?:03|1[68]|3[178]|50)|5(?:06|1[49]|48|79|8[17])|6(?:0[04]|13|22|39|47)|7(?:0[59]|78|8[02])|8(?:[06]7|19|25|73)|90[25])[2-9]\\d{6}","\\d{7}(?:\\d{3})?",,,"2042345678"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}|310\\d{4}","\\d{7}(?:\\d{3})?",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"CA",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],CC:[,[,,"[1458]\\d{5,9}","\\d{6,10}"],[,,"89162\\d{4}","\\d{8,9}",,,"891621234"],[,,"14(?:5\\d|71)\\d{5}|4(?:[0-2]\\d|3[0-57-9]|4[47-9]|5[0-25-9]|6[6-9]|7[02-9]|8[147-9]|9[017-9])\\d{6}","\\d{9}",,,"412345678"],[,,"180(?:0\\d{3}|2)\\d{3}","\\d{7,10}",,,"1800123456"],[,,"190[0126]\\d{6}","\\d{10}",,,"1900123456"],[,,"13(?:00\\d{2})?\\d{4}","\\d{6,10}",,,"1300123456"],[,,"500\\d{6}","\\d{9}",,,"500123456"],[,,"550\\d{6}","\\d{9}",,,"550123456"],"CC",61,"(?:14(?:1[14]|34|4[17]|[56]6|7[47]|88))?001[14-689]","0",,,"0",,"0011",,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],CD:[,[,,"[2-6]\\d{6}|[18]\\d{6,8}|9\\d{8}","\\d{7,9}"],[,,"1(?:2\\d{7}|\\d{6})|[2-6]\\d{6}","\\d{7,9}",,,"1234567"],[,,"8(?:[0-2459]\\d{2}|8)\\d{5}|9[7-9]\\d{7}","\\d{7,9}",,,"991234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"CD",243,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["12"],"0$1"],[,"([89]\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["8[0-2459]|9"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["88"],"0$1"],[,"(\\d{2})(\\d{5})","$1 $2",["[1-6]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],CF:[,[,,"[278]\\d{7}","\\d{8}"],[,,"2[12]\\d{6}","\\d{8}",,,"21612345"],[,,"7[0257]\\d{6}","\\d{8}",,,"70012345"],[,,"NA","NA"],[,,"8776\\d{4}","\\d{8}",,,"87761234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"CF",236,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],CG:[,[,,"[028]\\d{8}","\\d{9}"],[,,"222[1-589]\\d{5}","\\d{9}",,,"222123456"],[,,"0[14-6]\\d{7}","\\d{9}",,,"061234567"],[,,"NA","NA"],[,,"800\\d{6}","\\d{9}",,,"800123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"CG",242,"00",,,,,,,,[[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[02]"]],[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["8"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],1,,[,,"NA","NA"]],CH:[,[,,"[2-9]\\d{8}|860\\d{9}","\\d{9}(?:\\d{3})?"],[,,"(?:2[12467]|3[1-4]|4[134]|5[256]|6[12]|[7-9]1)\\d{7}","\\d{9}",,,"212345678"],[,,"7[5-9]\\d{7}","\\d{9}",,,"781234567"],[,,"800\\d{6}","\\d{9}",,,"800123456"],[,,"90[016]\\d{6}","\\d{9}",,,"900123456"],[,,"84[0248]\\d{6}","\\d{9}",,,"840123456"],[,,"878\\d{6}","\\d{9}",,,"878123456"],[,,"NA","NA"],"CH",41,"00","0",,,"0",,,,[[,"([2-9]\\d)(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-7]|[89]1"],"0$1"],[,"([89]\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["8[047]|90"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["860"],"0$1"]],,[,,"74[0248]\\d{6}","\\d{9}",,,"740123456"],,,[,,"NA","NA"],[,,"5[18]\\d{7}","\\d{9}",,,"581234567"],,,[,,"860\\d{9}","\\d{12}",,,"860123456789"]],CI:[,[,,"[02-8]\\d{7}","\\d{8}"],[,,"(?:2(?:0[023]|1[02357]|[23][045]|4[03-5])|3(?:0[06]|1[069]|[2-4][07]|5[09]|6[08]))\\d{5}","\\d{8}",,,"21234567"],[,,"(?:0[1-9]|4\\d|5[14-9]|6[015-79]|7[578]|8[79])\\d{6}","\\d{8}",,,"01234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"CI",225,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],1,,[,,"NA","NA"]],CK:[,[,,"[2-8]\\d{4}","\\d{5}"],[,,"(?:2\\d|3[13-7]|4[1-5])\\d{3}","\\d{5}",,,"21234"],[,,"[5-8]\\d{4}","\\d{5}",,,"71234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"CK",682,"00",,,,,,,,[[,"(\\d{2})(\\d{3})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],CL:[,[,,"(?:[2-9]|600|123)\\d{7,8}","\\d{7,11}"],[,,"2(?:1962\\d{4}|2\\d{7}|32[0-2]\\d{5})|(?:3[2-5]|[47][1-35]|5[1-3578]|6[13-57])\\d{7}","\\d{7,9}",,,"221234567"],[,,"9[4-9]\\d{7}","\\d{8,9}",,,"961234567"],[,,"800\\d{6}|1230\\d{7}","\\d{9,11}",,,"800123456"],[,,"NA","NA"],[,,"600\\d{7,8}","\\d{10,11}",,,"6001234567"],[,,"NA","NA"],[,,"44\\d{7}","\\d{9}",,,"441234567"],"CL",56,"(?:0|1(?:1[0-69]|2[0-57]|5[13-58]|69|7[0167]|8[018]))0","0",,,"0|(1(?:1[0-69]|2[0-57]|5[13-58]|69|7[0167]|8[018]))",,,,[[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["2[23]"],"($1)","$CC ($1)"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[357]|4[1-35]|6[13-57]"],"($1)","$CC ($1)"],[,"(9)(\\d{4})(\\d{4})","$1 $2 $3",["9"],"0$1"],[,"(44)(\\d{3})(\\d{4})","$1 $2 $3",["44"],"0$1"],[,"([68]00)(\\d{3})(\\d{3,4})","$1 $2 $3",["60|8"],"$1"],[,"(600)(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3 $4",["60"],"$1"],[,"(1230)(\\d{3})(\\d{4})","$1 $2 $3",["1"],"$1"],[,"(\\d{5})(\\d{4})","$1 $2",["219"],"($1)","$CC ($1)"],[,"(\\d{4,5})","$1",["[1-9]"],"$1"]],[[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["2[23]"],"($1)","$CC ($1)"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[357]|4[1-35]|6[13-57]"],"($1)","$CC ($1)"],[,"(9)(\\d{4})(\\d{4})","$1 $2 $3",["9"],"0$1"],[,"(44)(\\d{3})(\\d{4})","$1 $2 $3",["44"],"0$1"],[,"([68]00)(\\d{3})(\\d{3,4})","$1 $2 $3",["60|8"],"$1"],[,"(600)(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3 $4",["60"],"$1"],[,"(1230)(\\d{3})(\\d{4})","$1 $2 $3",["1"],"$1"],[,"(\\d{5})(\\d{4})","$1 $2",["219"],"($1)","$CC ($1)"]],[,,"NA","NA"],,,[,,"600\\d{7,8}","\\d{10,11}",,,"6001234567"],[,,"NA","NA"],,,[,,"NA","NA"]],CM:[,[,,"[2368]\\d{7,8}","\\d{8,9}"],[,,"2(?:22|33|4[23])\\d{6}","\\d{9}",,,"222123456"],[,,"6[5-9]\\d{7}","\\d{9}",,,"671234567"],[,,"800\\d{5}","\\d{8}",,,"80012345"],[,,"88\\d{6}","\\d{8}",,,"88012345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"CM",237,"00",,,,,,,,[[,"([26])(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["[26]"]],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[23]|88"]],[,"(800)(\\d{2})(\\d{3})","$1 $2 $3",["80"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],CN:[,[,,"[1-7]\\d{6,11}|8[0-357-9]\\d{6,9}|9\\d{7,10}","\\d{4,12}"],[,,"21(?:100\\d{2}|95\\d{3,4}|\\d{8,10})|(?:10|2[02-57-9]|3(?:11|7[179])|4(?:[15]1|3[1-35])|5(?:1\\d|2[37]|3[12]|51|7[13-79]|9[15])|7(?:31|5[457]|6[09]|91)|8(?:[57]1|98))(?:100\\d{2}|95\\d{3,4}|\\d{8})|(?:3(?:1[02-9]|35|49|5\\d|7[02-68]|9[1-68])|4(?:1[02-9]|2[179]|3[3-9]|5[2-9]|6[4789]|7\\d|8[23])|5(?:3[03-9]|4[36]|5[02-9]|6[1-46]|7[028]|80|9[2-46-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[17]\\d|2[248]|3[04-9]|4[3-6]|5[0-4689]|6[2368]|9[02-9])|8(?:078|1[236-8]|2[5-7]|3\\d|5[1-9]|7[02-9]|8[3678]|9[1-7])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))(?:100\\d{2}|95\\d{3,4}|\\d{7})|80(?:29|6[03578]|7[018]|81)\\d{4}","\\d{4,12}",,,"1012345678"],[,,"1(?:[38]\\d|4[57]|5[0-35-9]|7[0136-8])\\d{8}","\\d{11}",,,"13123456789"],[,,"(?:10)?800\\d{7}","\\d{10,12}",,,"8001234567"],[,,"16[08]\\d{5}","\\d{8}",,,"16812345"],[,,"400\\d{7}|950\\d{7,8}|(?:10|2[0-57-9]|3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[4789]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[14-9]|8[3678]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))96\\d{3,4}","\\d{7,11}",,,"4001234567"],[,,"NA","NA"],[,,"NA","NA"],"CN",86,"(1(?:[129]\\d{3}|79\\d{2}))?00","0",,,"(1(?:[129]\\d{3}|79\\d{2}))|0",,"00",,[[,"(80\\d{2})(\\d{4})","$1 $2",["80[2678]"],"0$1","$CC $1",1],[,"([48]00)(\\d{3})(\\d{4})","$1 $2 $3",["[48]00"]],[,"(\\d{5,6})","$1",["100|95"]],[,"(\\d{2})(\\d{5,6})","$1 $2",["(?:10|2\\d)[19]","(?:10|2\\d)(?:10|9[56])","(?:10|2\\d)(?:100|9[56])"],"0$1","$CC $1"],[,"(\\d{3})(\\d{5,6})","$1 $2",["[3-9]","[3-9]\\d{2}[19]","[3-9]\\d{2}(?:10|9[56])"],"0$1","$CC $1"],[,"(\\d{3,4})(\\d{4})","$1 $2",["[2-9]"]],[,"(21)(\\d{4})(\\d{4,6})","$1 $2 $3",["21"],"0$1","$CC $1",1],[,"([12]\\d)(\\d{4})(\\d{4})","$1 $2 $3",["10[1-9]|2[02-9]","10[1-9]|2[02-9]","10(?:[1-79]|8(?:[1-9]|0[1-9]))|2[02-9]"],"0$1","$CC $1",1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["3(?:1[02-9]|35|49|5|7[02-68]|9[1-68])|4(?:1[02-9]|2[179]|[35][2-9]|6[4789]|7\\d|8[23])|5(?:3[03-9]|4[36]|5[02-9]|6[1-46]|7[028]|80|9[2-46-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]|2[248]|3[04-9]|4[3-6]|6[2368])|8(?:1[236-8]|2[5-7]|3|5[1-9]|7[02-9]|8[3678]|9[1-7])|9(?:0[1-3689]|1[1-79]|[379]|4[13]|5[1-5])"],"0$1","$CC $1",1],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["3(?:11|7[179])|4(?:[15]1|3[1-35])|5(?:1|2[37]|3[12]|51|7[13-79]|9[15])|7(?:31|5[457]|6[09]|91)|8(?:[57]1|98)"],"0$1","$CC $1",1],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["807","8078"],"0$1","$CC $1",1],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["1[3-578]"],,"$CC $1"],[,"(10800)(\\d{3})(\\d{4})","$1 $2 $3",["108","1080","10800"]],[,"(\\d{3})(\\d{7,8})","$1 $2",["950"]]],[[,"(80\\d{2})(\\d{4})","$1 $2",["80[2678]"],"0$1","$CC $1",1],[,"([48]00)(\\d{3})(\\d{4})","$1 $2 $3",["[48]00"]],[,"(\\d{2})(\\d{5,6})","$1 $2",["(?:10|2\\d)[19]","(?:10|2\\d)(?:10|9[56])","(?:10|2\\d)(?:100|9[56])"],"0$1","$CC $1"],[,"(\\d{3})(\\d{5,6})","$1 $2",["[3-9]","[3-9]\\d{2}[19]","[3-9]\\d{2}(?:10|9[56])"],"0$1","$CC $1"],[,"(21)(\\d{4})(\\d{4,6})","$1 $2 $3",["21"],"0$1","$CC $1",1],[,"([12]\\d)(\\d{4})(\\d{4})","$1 $2 $3",["10[1-9]|2[02-9]","10[1-9]|2[02-9]","10(?:[1-79]|8(?:[1-9]|0[1-9]))|2[02-9]"],"0$1","$CC $1",1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["3(?:1[02-9]|35|49|5|7[02-68]|9[1-68])|4(?:1[02-9]|2[179]|[35][2-9]|6[4789]|7\\d|8[23])|5(?:3[03-9]|4[36]|5[02-9]|6[1-46]|7[028]|80|9[2-46-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]|2[248]|3[04-9]|4[3-6]|6[2368])|8(?:1[236-8]|2[5-7]|3|5[1-9]|7[02-9]|8[3678]|9[1-7])|9(?:0[1-3689]|1[1-79]|[379]|4[13]|5[1-5])"],"0$1","$CC $1",1],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["3(?:11|7[179])|4(?:[15]1|3[1-35])|5(?:1|2[37]|3[12]|51|7[13-79]|9[15])|7(?:31|5[457]|6[09]|91)|8(?:[57]1|98)"],"0$1","$CC $1",1],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["807","8078"],"0$1","$CC $1",1],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["1[3-578]"],,"$CC $1"],[,"(10800)(\\d{3})(\\d{4})","$1 $2 $3",["108","1080","10800"]],[,"(\\d{3})(\\d{7,8})","$1 $2",["950"]]],[,,"NA","NA"],,,[,,"(?:4|(?:10)?8)00\\d{7}|950\\d{7,8}","\\d{10,12}",,,"4001234567"],[,,"NA","NA"],,,[,,"NA","NA"]],CO:[,[,,"(?:[13]\\d{0,3}|[24-8])\\d{7}","\\d{7,11}"],[,,"[124-8][2-9]\\d{6}","\\d{8}",,,"12345678"],[,,"3(?:0[0-5]|1\\d|2[0-3]|5[01])\\d{7}","\\d{10}",,,"3211234567"],[,,"1800\\d{7}","\\d{11}",,,"18001234567"],[,,"19(?:0[01]|4[78])\\d{7}","\\d{11}",,,"19001234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"CO",57,"00(?:4(?:[14]4|56)|[579])","0",,,"0([3579]|4(?:44|56))?",,,,[[,"(\\d)(\\d{7})","$1 $2",["1(?:8[2-9]|9[0-3]|[2-7])|[24-8]","1(?:8[2-9]|9(?:09|[1-3])|[2-7])|[24-8]"],"($1)","0$CC $1"],[,"(\\d{3})(\\d{7})","$1 $2",["3"],,"0$CC $1"],[,"(1)(\\d{3})(\\d{7})","$1-$2-$3",["1(?:80|9[04])","1(?:800|9(?:0[01]|4[78]))"],"0$1"]],[[,"(\\d)(\\d{7})","$1 $2",["1(?:8[2-9]|9[0-3]|[2-7])|[24-8]","1(?:8[2-9]|9(?:09|[1-3])|[2-7])|[24-8]"],"($1)","0$CC $1"],[,"(\\d{3})(\\d{7})","$1 $2",["3"],,"0$CC $1"],[,"(1)(\\d{3})(\\d{7})","$1 $2 $3",["1(?:80|9[04])","1(?:800|9(?:0[01]|4[78]))"]]],[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],CR:[,[,,"[24-9]\\d{7,9}","\\d{8,10}"],[,,"2[0-24-7]\\d{6}","\\d{8}",,,"22123456"],[,,"5(?:0[01]|7[0-3])\\d{5}|(?:[67][0-3]|8[3-9])\\d{6}","\\d{8}",,,"83123456"],[,,"800\\d{7}","\\d{10}",,,"8001234567"],[,,"90[059]\\d{7}","\\d{10}",,,"9001234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"210[0-6]\\d{4}|4\\d{7}|5100\\d{4}","\\d{8}",,,"40001234"],"CR",506,"00",,,,"(19(?:0[012468]|1[09]|20|66|77|99))",,,,[[,"(\\d{4})(\\d{4})","$1 $2",["[24-7]|8[3-9]"],,"$CC $1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["[89]0"],,"$CC $1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],CU:[,[,,"[2-57]\\d{5,7}","\\d{4,8}"],[,,"2[1-4]\\d{5,6}|3(?:1\\d{6}|[23]\\d{4,6})|4(?:[125]\\d{5,6}|[36]\\d{6}|[78]\\d{4,6})|7\\d{6,7}","\\d{4,8}",,,"71234567"],[,,"5\\d{7}","\\d{8}",,,"51234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"CU",53,"119","0",,,"0",,,,[[,"(\\d)(\\d{6,7})","$1 $2",["7"],"(0$1)"],[,"(\\d{2})(\\d{4,6})","$1 $2",["[2-4]"],"(0$1)"],[,"(\\d)(\\d{7})","$1 $2",["5"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],CV:[,[,,"[259]\\d{6}","\\d{7}"],[,,"2(?:2[1-7]|3[0-8]|4[12]|5[1256]|6\\d|7[1-3]|8[1-5])\\d{4}","\\d{7}",,,"2211234"],[,,"(?:9\\d|59)\\d{5}","\\d{7}",,,"9911234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"CV",238,"0",,,,,,,,[[,"(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],CW:[,[,,"[169]\\d{6,7}","\\d{7,8}"],[,,"9(?:[48]\\d{2}|50\\d|7(?:2[0-24]|[34]\\d|6[35-7]|77|8[7-9]))\\d{4}","\\d{7,8}",,,"94151234"],[,,"9(?:5(?:[12467]\\d|3[01])|6(?:[15-9]\\d|3[01]))\\d{4}","\\d{7,8}",,,"95181234"],[,,"NA","NA"],[,,"NA","NA"],[,,"60[0-2]\\d{4}","\\d{7}",,,"6001234"],[,,"NA","NA"],[,,"NA","NA"],"CW",599,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[13-7]"]],[,"(9)(\\d{3})(\\d{4})","$1 $2 $3",["9"]]],,[,,"955\\d{5}","\\d{7,8}",,,"95581234"],1,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],CX:[,[,,"[1458]\\d{5,9}","\\d{6,10}"],[,,"89164\\d{4}","\\d{8,9}",,,"891641234"],[,,"14(?:5\\d|71)\\d{5}|4(?:[0-2]\\d|3[0-57-9]|4[47-9]|5[0-25-9]|6[6-9]|7[02-9]|8[147-9]|9[017-9])\\d{6}","\\d{9}",,,"412345678"],[,,"180(?:0\\d{3}|2)\\d{3}","\\d{7,10}",,,"1800123456"],[,,"190[0126]\\d{6}","\\d{10}",,,"1900123456"],[,,"13(?:00\\d{2})?\\d{4}","\\d{6,10}",,,"1300123456"],[,,"500\\d{6}","\\d{9}",,,"500123456"],[,,"550\\d{6}","\\d{9}",,,"550123456"],"CX",61,"(?:14(?:1[14]|34|4[17]|[56]6|7[47]|88))?001[14-689]","0",,,"0",,"0011",,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],CY:[,[,,"[257-9]\\d{7}","\\d{8}"],[,,"2[2-6]\\d{6}","\\d{8}",,,"22345678"],[,,"9[4-79]\\d{6}","\\d{8}",,,"96123456"],[,,"800\\d{5}","\\d{8}",,,"80001234"],[,,"90[09]\\d{5}","\\d{8}",,,"90012345"],[,,"80[1-9]\\d{5}","\\d{8}",,,"80112345"],[,,"700\\d{5}","\\d{8}",,,"70012345"],[,,"NA","NA"],"CY",357,"00",,,,,,,,[[,"(\\d{2})(\\d{6})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"(?:50|77)\\d{6}","\\d{8}",,,"77123456"],,,[,,"NA","NA"]],CZ:[,[,,"[2-8]\\d{8}|9\\d{8,11}","\\d{9,12}"],[,,"2\\d{8}|(?:3[1257-9]|4[16-9]|5[13-9])\\d{7}","\\d{9,12}",,,"212345678"],[,,"(?:60[1-8]|7(?:0[2-5]|[2379]\\d))\\d{6}","\\d{9,12}",,,"601123456"],[,,"800\\d{6}","\\d{9,12}",,,"800123456"],[,,"9(?:0[05689]|76)\\d{6}","\\d{9,12}",,,"900123456"],[,,"8[134]\\d{7}","\\d{9,12}",,,"811234567"],[,,"70[01]\\d{6}","\\d{9,12}",,,"700123456"],[,,"9[17]0\\d{6}","\\d{9,12}",,,"910123456"],"CZ",420,"00",,,,,,,,[[,"([2-9]\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[2-8]|9[015-7]"]],[,"(96\\d)(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["96"]],[,"(9\\d)(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["9[36]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"9(?:5\\d|7[234])\\d{6}","\\d{9,12}",,,"972123456"],,,[,,"9(?:3\\d{9}|6\\d{7,10})","\\d{9,12}",,,"93123456789"]],DE:[,[,,"[1-35-9]\\d{3,14}|4(?:[0-8]\\d{4,12}|9(?:[0-37]\\d|4(?:[1-35-8]|4\\d?)|5\\d{1,2}|6[1-8]\\d?)\\d{2,8})","\\d{2,15}"],[,,"[246]\\d{5,13}|3(?:0\\d{3,13}|2\\d{9}|[3-9]\\d{4,13})|5(?:0[2-8]|[1256]\\d|[38][0-8]|4\\d{0,2}|[79][0-7])\\d{3,11}|7(?:0[2-8]|[1-9]\\d)\\d{3,10}|8(?:0[2-9]|[1-9]\\d)\\d{3,10}|9(?:0[6-9]\\d{3,10}|1\\d{4,12}|[2-9]\\d{4,11})","\\d{2,15}",,,"30123456"],[,,"1(?:5[0-25-9]\\d{8}|6[023]\\d{7,8}|7(?:[0-57-9]\\d?|6\\d)\\d{7})","\\d{10,11}",,,"15123456789"],[,,"800\\d{7,12}","\\d{10,15}",,,"8001234567890"],[,,"137[7-9]\\d{6}|900(?:[135]\\d{6}|9\\d{7})","\\d{10,11}",,,"9001234567"],[,,"1(?:3(?:7[1-6]\\d{6}|8\\d{4})|80\\d{5,11})","\\d{7,14}",,,"18012345"],[,,"700\\d{8}","\\d{11}",,,"70012345678"],[,,"NA","NA"],"DE",49,"00","0",,,"0",,,,[[,"(1\\d{2})(\\d{7,8})","$1 $2",["1[67]"],"0$1"],[,"(15\\d{3})(\\d{6})","$1 $2",["15[0568]"],"0$1"],[,"(1\\d{3})(\\d{7})","$1 $2",["15"],"0$1"],[,"(\\d{2})(\\d{3,11})","$1 $2",["3[02]|40|[68]9"],"0$1"],[,"(\\d{3})(\\d{3,11})","$1 $2",["2(?:\\d1|0[2389]|1[24]|28|34)|3(?:[3-9][15]|40)|[4-8][1-9]1|9(?:06|[1-9]1)"],"0$1"],[,"(\\d{4})(\\d{2,11})","$1 $2",["[24-6]|[7-9](?:\\d[1-9]|[1-9]\\d)|3(?:[3569][02-46-9]|4[2-4679]|7[2-467]|8[2-46-8])","[24-6]|[7-9](?:\\d[1-9]|[1-9]\\d)|3(?:3(?:0[1-467]|2[127-9]|3[124578]|[46][1246]|7[1257-9]|8[1256]|9[145])|4(?:2[135]|3[1357]|4[13578]|6[1246]|7[1356]|9[1346])|5(?:0[14]|2[1-3589]|3[1357]|4[1246]|6[1-4]|7[1346]|8[13568]|9[1246])|6(?:0[356]|2[1-489]|3[124-6]|4[1347]|6[13]|7[12579]|8[1-356]|9[135])|7(?:2[1-7]|3[1357]|4[145]|6[1-5]|7[1-4])|8(?:21|3[1468]|4[1347]|6[0135-9]|7[1467]|8[136])|9(?:0[12479]|2[1358]|3[1357]|4[134679]|6[1-9]|7[136]|8[147]|9[1468]))"],"0$1"],[,"(3\\d{4})(\\d{1,10})","$1 $2",["3"],"0$1"],[,"(800)(\\d{7,12})","$1 $2",["800"],"0$1"],[,"(\\d{3})(\\d)(\\d{4,10})","$1 $2 $3",["(?:18|90)0|137","1(?:37|80)|900[1359]"],"0$1"],[,"(1\\d{2})(\\d{5,11})","$1 $2",["181"],"0$1"],[,"(18\\d{3})(\\d{6})","$1 $2",["185","1850","18500"],"0$1"],[,"(18\\d{2})(\\d{7})","$1 $2",["18[68]"],"0$1"],[,"(18\\d)(\\d{8})","$1 $2",["18[2-579]"],"0$1"],[,"(700)(\\d{4})(\\d{4})","$1 $2 $3",["700"],"0$1"],[,"(138)(\\d{4})","$1 $2",["138"],"0$1"],[,"(15[013-68])(\\d{2})(\\d{8})","$1 $2 $3",["15[013-68]"],"0$1"],[,"(15[279]\\d)(\\d{2})(\\d{7})","$1 $2 $3",["15[279]"],"0$1"],[,"(1[67]\\d)(\\d{2})(\\d{7,8})","$1 $2 $3",["1(?:6[023]|7)"],"0$1"]],,[,,"16(?:4\\d{1,10}|[89]\\d{1,11})","\\d{4,14}",,,"16412345"],,,[,,"NA","NA"],[,,"18(?:1\\d{5,11}|[2-9]\\d{8})","\\d{8,14}",,,"18500123456"],,,[,,"1(?:5(?:(?:2\\d55|7\\d99|9\\d33)\\d{7}|(?:[034568]00|113)\\d{8})|6(?:013|255|399)\\d{7,8}|7(?:[015]13|[234]55|[69]33|[78]99)\\d{7,8})","\\d{12,13}",,,"177991234567"]],DJ:[,[,,"[27]\\d{7}","\\d{8}"],[,,"2(?:1[2-5]|7[45])\\d{5}","\\d{8}",,,"21360003"],[,,"77[0-26-8]\\d{5}","\\d{8}",,,"77831001"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"DJ",253,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],DK:[,[,,"[2-9]\\d{7}","\\d{8}"],[,,"(?:[2-7]\\d|8[126-9]|9[1-36-9])\\d{6}","\\d{8}",,,"32123456"],[,,"(?:[2-7]\\d|8[126-9]|9[1-36-9])\\d{6}","\\d{8}",,,"20123456"],[,,"80\\d{6}","\\d{8}",,,"80123456"],[,,"90\\d{6}","\\d{8}",,,"90123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"DK",45,"00",,,,,,,1,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],DM:[,[,,"[57-9]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"767(?:2(?:55|66)|4(?:2[01]|4[0-25-9])|50[0-4]|70[1-3])\\d{4}","\\d{7}(?:\\d{3})?",,,"7674201234"],[,,"767(?:2(?:[234689]5|7[5-7])|31[5-7]|61[2-7])\\d{4}","\\d{10}",,,"7672251234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"DM",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"767",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],DO:[,[,,"[589]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"8(?:[04]9[2-9]\\d{6}|29(?:2(?:[0-59]\\d|6[04-9]|7[0-27]|8[0237-9])|3(?:[0-35-9]\\d|4[7-9])|[45]\\d{2}|6(?:[0-27-9]\\d|[3-5][1-9]|6[0135-8])|7(?:0[013-9]|[1-37]\\d|4[1-35689]|5[1-4689]|6[1-57-9]|8[1-79]|9[1-8])|8(?:0[146-9]|1[0-48]|[248]\\d|3[1-79]|5[01589]|6[013-68]|7[124-8]|9[0-8])|9(?:[0-24]\\d|3[02-46-9]|5[0-79]|60|7[0169]|8[57-9]|9[02-9]))\\d{4})","\\d{7}(?:\\d{3})?",,,"8092345678"],[,,"8[024]9[2-9]\\d{6}","\\d{7}(?:\\d{3})?",,,"8092345678"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"DO",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"8[024]9",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],DZ:[,[,,"(?:[1-4]|[5-9]\\d)\\d{7}","\\d{8,9}"],[,,"(?:1\\d|2[013-79]|3[0-8]|4[0135689])\\d{6}|9619\\d{5}","\\d{8,9}",,,"12345678"],[,,"(?:5[4-6]|7[7-9])\\d{7}|6(?:[569]\\d|7[0-6])\\d{6}","\\d{9}",,,"551234567"],[,,"800\\d{6}","\\d{9}",,,"800123456"],[,,"80[3-689]1\\d{5}","\\d{9}",,,"808123456"],[,,"80[12]1\\d{5}","\\d{9}",,,"801123456"],[,,"NA","NA"],[,,"98[23]\\d{6}","\\d{9}",,,"983123456"],"DZ",213,"00","0",,,"0",,,,[[,"([1-4]\\d)(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[1-4]"],"0$1"],[,"([5-8]\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-8]"],"0$1"],[,"(9\\d)(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["9"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],EC:[,[,,"1\\d{9,10}|[2-8]\\d{7}|9\\d{8}","\\d{7,11}"],[,,"[2-7][2-7]\\d{6}","\\d{7,8}",,,"22123456"],[,,"9(?:39|[45][89]|[67][7-9]|[89]\\d)\\d{6}","\\d{9}",,,"991234567"],[,,"1800\\d{6,7}","\\d{10,11}",,,"18001234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"[2-7]890\\d{4}","\\d{8}",,,"28901234"],"EC",593,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{4})","$1 $2-$3",["[247]|[356][2-8]"],"(0$1)"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["9"],"0$1"],[,"(1800)(\\d{3})(\\d{3,4})","$1 $2 $3",["1"],"$1"]],[[,"(\\d)(\\d{3})(\\d{4})","$1-$2-$3",["[247]|[356][2-8]"]],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["9"],"0$1"],[,"(1800)(\\d{3})(\\d{3,4})","$1 $2 $3",["1"],"$1"]],[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],EE:[,[,,"1\\d{3,4}|[3-9]\\d{6,7}|800\\d{6,7}","\\d{4,10}"],[,,"(?:3[23589]|4[3-8]|6\\d|7[1-9]|88)\\d{5}","\\d{7}",,,"3212345"],[,,"(?:5\\d|8[1-5])\\d{6}|5(?:[02]\\d{2}|1(?:[0-8]\\d|95)|5[0-478]\\d|64[0-4]|65[1-589])\\d{3}","\\d{7,8}",,,"51234567"],[,,"800(?:0\\d{3}|1\\d|[2-9])\\d{3}","\\d{7,10}",,,"80012345"],[,,"(?:40\\d{2}|900)\\d{4}","\\d{7,8}",,,"9001234"],[,,"NA","NA"],[,,"70[0-2]\\d{5}","\\d{8}",,,"70012345"],[,,"NA","NA"],"EE",372,"00",,,,,,,,[[,"([3-79]\\d{2})(\\d{4})","$1 $2",["[369]|4[3-8]|5(?:[0-2]|5[0-478]|6[45])|7[1-9]","[369]|4[3-8]|5(?:[02]|1(?:[0-8]|95)|5[0-478]|6(?:4[0-4]|5[1-589]))|7[1-9]"]],[,"(70)(\\d{2})(\\d{4})","$1 $2 $3",["70"]],[,"(8000)(\\d{3})(\\d{3})","$1 $2 $3",["800","8000"]],[,"([458]\\d{3})(\\d{3,4})","$1 $2",["40|5|8(?:00|[1-5])","40|5|8(?:00[1-9]|[1-5])"]]],,[,,"NA","NA"],,,[,,"1\\d{3,4}|800[2-9]\\d{3}","\\d{4,7}",,,"8002123"],[,,"1(?:2[01245]|3[0-6]|4[1-489]|5[0-59]|6[1-46-9]|7[0-27-9]|8[189]|9[012])\\d{1,2}","\\d{4,5}",,,"12123"],,,[,,"NA","NA"]],EG:[,[,,"1\\d{4,9}|[2456]\\d{8}|3\\d{7}|[89]\\d{8,9}","\\d{5,10}"],[,,"(?:1(?:3[23]\\d|5(?:[23]|9\\d))|2[2-4]\\d{2}|3\\d{2}|4(?:0[2-5]|[578][23]|64)\\d|5(?:0[2-7]|[57][23])\\d|6[24-689]3\\d|8(?:2[2-57]|4[26]|6[237]|8[2-4])\\d|9(?:2[27]|3[24]|52|6[2356]|7[2-4])\\d)\\d{5}|1[69]\\d{3}","\\d{5,9}",,,"234567890"],[,,"1(?:0[0-269]|1[0-245]|2[0-278])\\d{7}","\\d{10}",,,"1001234567"],[,,"800\\d{7}","\\d{10}",,,"8001234567"],[,,"900\\d{7}","\\d{10}",,,"9001234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"EG",20,"00","0",,,"0",,,,[[,"(\\d)(\\d{7,8})","$1 $2",["[23]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["1[012]|[89]00"],"0$1"],[,"(\\d{2})(\\d{6,7})","$1 $2",["1[35]|[4-6]|[89][2-9]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],EH:[,[,,"[5689]\\d{8}","\\d{9}"],[,,"528[89]\\d{5}","\\d{9}",,,"528812345"],[,,"6(?:0[0-8]|[12-79]\\d|8[017])\\d{6}","\\d{9}",,,"650123456"],[,,"80\\d{7}","\\d{9}",,,"801234567"],[,,"89\\d{7}","\\d{9}",,,"891234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"EH",212,"00","0",,,"0",,,,,,[,,"NA","NA"],,"528[89]",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],ER:[,[,,"[178]\\d{6}","\\d{6,7}"],[,,"1(?:1[12568]|20|40|55|6[146])\\d{4}|8\\d{6}","\\d{6,7}",,,"8370362"],[,,"17[1-3]\\d{4}|7\\d{6}","\\d{7}",,,"7123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"ER",291,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{3})","$1 $2 $3",,"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],ES:[,[,,"[5-9]\\d{8}","\\d{9}"],[,,"8(?:[13]0|[28][0-8]|[47][1-9]|5[01346-9]|6[0457-9])\\d{6}|9(?:[1238][0-8]\\d{6}|4[1-9]\\d{6}|5\\d{7}|6(?:[0-8]\\d{6}|9(?:0(?:[0-57-9]\\d{4}|6(?:0[0-8]|1[1-9]|[2-9]\\d)\\d{2})|[1-9]\\d{5}))|7(?:[124-9]\\d{2}|3(?:[0-8]\\d|9[1-9]))\\d{4})","\\d{9}",,,"810123456"],[,,"(?:6\\d{6}|7[1-4]\\d{5}|9(?:6906(?:09|10)|7390\\d{2}))\\d{2}","\\d{9}",,,"612345678"],[,,"[89]00\\d{6}","\\d{9}",,,"800123456"],[,,"80[367]\\d{6}","\\d{9}",,,"803123456"],[,,"90[12]\\d{6}","\\d{9}",,,"901123456"],[,,"70\\d{7}","\\d{9}",,,"701234567"],[,,"NA","NA"],"ES",34,"00",,,,,,,,[[,"([89]00)(\\d{3})(\\d{3})","$1 $2 $3",["[89]00"]],[,"([5-9]\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[568]|[79][0-8]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"51\\d{7}","\\d{9}",,,"511234567"],,,[,,"NA","NA"]],ET:[,[,,"[1-59]\\d{8}","\\d{7,9}"],[,,"(?:11(?:1(?:1[124]|2[2-57]|3[1-5]|5[5-8]|8[6-8])|2(?:13|3[6-8]|5[89]|7[05-9]|8[2-6])|3(?:2[01]|3[0-289]|4[1289]|7[1-4]|87)|4(?:1[69]|3[2-49]|4[0-3]|6[5-8])|5(?:1[578]|44|5[0-4])|6(?:18|2[69]|4[5-7]|5[1-5]|6[0-59]|8[015-8]))|2(?:2(?:11[1-9]|22[0-7]|33\\d|44[1467]|66[1-68])|5(?:11[124-6]|33[2-8]|44[1467]|55[14]|66[1-3679]|77[124-79]|880))|3(?:3(?:11[0-46-8]|22[0-6]|33[0134689]|44[04]|55[0-6]|66[01467])|4(?:44[0-8]|55[0-69]|66[0-3]|77[1-5]))|4(?:6(?:22[0-24-7]|33[1-5]|44[13-69]|55[14-689]|660|88[1-4])|7(?:11[1-9]|22[1-9]|33[13-7]|44[13-6]|55[1-689]))|5(?:7(?:227|55[05]|(?:66|77)[14-8])|8(?:11[149]|22[013-79]|33[0-68]|44[013-8]|550|66[1-5]|77\\d)))\\d{4}","\\d{7,9}",,,"111112345"],[,,"9(?:[1-46]\\d|5[89])\\d{6}","\\d{9}",,,"911234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"ET",251,"00","0",,,"0",,,,[[,"([1-59]\\d)(\\d{3})(\\d{4})","$1 $2 $3",,"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],FI:[,[,,"1\\d{4,11}|[2-9]\\d{4,10}","\\d{5,12}"],[,,"1(?:[3569][1-8]\\d{3,9}|[47]\\d{5,10})|2[1-8]\\d{3,9}|3(?:[1-8]\\d{3,9}|9\\d{4,8})|[5689][1-8]\\d{3,9}","\\d{5,12}",,,"1312345678"],[,,"4\\d{5,10}|50\\d{4,8}","\\d{6,11}",,,"412345678"],[,,"800\\d{4,7}","\\d{7,10}",,,"8001234567"],[,,"[67]00\\d{5,6}","\\d{8,9}",,,"600123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"FI",358,"00|99[049]","0",,,"0",,,,[[,"(\\d{3})(\\d{3,7})","$1 $2",["(?:[1-3]00|[6-8]0)"],"0$1"],[,"(116\\d{3})","$1",["116"],"$1"],[,"(\\d{2})(\\d{4,10})","$1 $2",["[14]|2[09]|50|7[135]"],"0$1"],[,"(\\d)(\\d{4,11})","$1 $2",["[25689][1-8]|3"],"0$1"]],,[,,"NA","NA"],1,,[,,"[13]00\\d{3,7}|2(?:0(?:0\\d{3,7}|2[023]\\d{1,6}|9[89]\\d{1,6}))|60(?:[12]\\d{5,6}|6\\d{7})|7(?:1\\d{7}|3\\d{8}|5[03-9]\\d{2,7})","\\d{5,10}",,,"100123"],[,,"[13]0\\d{4,8}|2(?:0(?:[016-8]\\d{3,7}|[2-59]\\d{2,7})|9\\d{4,8})|60(?:[12]\\d{5,6}|6\\d{7})|7(?:1\\d{7}|3\\d{8}|5[03-9]\\d{2,7})","\\d{5,10}",,,"10112345"],,,[,,"NA","NA"]],FJ:[,[,,"[36-9]\\d{6}|0\\d{10}","\\d{7}(?:\\d{4})?"],[,,"(?:3[0-5]|6[25-7]|8[58])\\d{5}","\\d{7}",,,"3212345"],[,,"(?:7[0-8]|8[034679]|9\\d)\\d{5}","\\d{7}",,,"7012345"],[,,"0800\\d{7}","\\d{11}",,,"08001234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"FJ",679,"0(?:0|52)",,,,,,"00",,[[,"(\\d{3})(\\d{4})","$1 $2",["[36-9]"]],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["0"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],1,,[,,"NA","NA"]],FK:[,[,,"[2-7]\\d{4}","\\d{5}"],[,,"[2-47]\\d{4}","\\d{5}",,,"31234"],[,,"[56]\\d{4}","\\d{5}",,,"51234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"FK",500,"00",,,,,,,,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],FM:[,[,,"[39]\\d{6}","\\d{7}"],[,,"3[2357]0[1-9]\\d{3}|9[2-6]\\d{5}","\\d{7}",,,"3201234"],[,,"3[2357]0[1-9]\\d{3}|9[2-7]\\d{5}","\\d{7}",,,"3501234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"FM",691,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],FO:[,[,,"[2-9]\\d{5}","\\d{6}"],[,,"(?:20|[3-4]\\d|8[19])\\d{4}","\\d{6}",,,"201234"],[,,"(?:[27][1-9]|5\\d)\\d{4}","\\d{6}",,,"211234"],[,,"80[257-9]\\d{3}","\\d{6}",,,"802123"],[,,"90(?:[1345][15-7]|2[125-7]|99)\\d{2}","\\d{6}",,,"901123"],[,,"NA","NA"],[,,"NA","NA"],[,,"(?:6[0-36]|88)\\d{4}","\\d{6}",,,"601234"],"FO",298,"00",,,,"(10(?:01|[12]0|88))",,,,[[,"(\\d{6})","$1",,,"$CC $1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],FR:[,[,,"[1-9]\\d{8}","\\d{9}"],[,,"[1-5]\\d{8}","\\d{9}",,,"123456789"],[,,"6\\d{8}|7(?:00\\d{6}|[3-9]\\d{7})","\\d{9}",,,"612345678"],[,,"80[0-5]\\d{6}","\\d{9}",,,"801234567"],[,,"89[1-37-9]\\d{6}","\\d{9}",,,"891123456"],[,,"8(?:1[019]|2[0156]|84|90)\\d{6}","\\d{9}",,,"810123456"],[,,"NA","NA"],[,,"9\\d{8}","\\d{9}",,,"912345678"],"FR",33,"00","0",,,"0",,,,[[,"([1-79])(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["[1-79]"],"0$1"],[,"(1\\d{2})(\\d{3})","$1 $2",["11"],"$1"],[,"(8\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0 $1"]],[[,"([1-79])(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["[1-79]"],"0$1"],[,"(8\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0 $1"]],[,,"NA","NA"],,,[,,"NA","NA"],[,,"80[6-9]\\d{6}","\\d{9}",,,"806123456"],,,[,,"NA","NA"]],GA:[,[,,"0?\\d{7}","\\d{7,8}"],[,,"01\\d{6}","\\d{8}",,,"01441234"],[,,"0?[2-7]\\d{6}","\\d{7,8}",,,"06031234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"GA",241,"00",,,,,,,,[[,"(\\d)(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-7]"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["0"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],1,,[,,"NA","NA"]],
GB:[,[,,"\\d{7,10}","\\d{4,10}"],[,,"2(?:0[01378]|3[0189]|4[017]|8[0-46-9]|9[012])\\d{7}|1(?:(?:1(?:3[0-48]|[46][0-4]|5[012789]|7[0-49]|8[01349])|21[0-7]|31[0-8]|[459]1\\d|61[0-46-9]))\\d{6}|1(?:2(?:0[024-9]|2[3-9]|3[3-79]|4[1-689]|[58][02-9]|6[0-4789]|7[013-9]|9\\d)|3(?:0\\d|[25][02-9]|3[02-579]|[468][0-46-9]|7[1235679]|9[24578])|4(?:0[03-9]|[28][02-5789]|[37]\\d|4[02-69]|5[0-8]|[69][0-79])|5(?:0[1235-9]|2[024-9]|3[015689]|4[02-9]|5[03-9]|6\\d|7[0-35-9]|8[0-468]|9[0-5789])|6(?:0[034689]|2[0-35689]|[38][013-9]|4[1-467]|5[0-69]|6[13-9]|7[0-8]|9[0124578])|7(?:0[0246-9]|2\\d|3[023678]|4[03-9]|5[0-46-9]|6[013-9]|7[0-35-9]|8[024-9]|9[02-9])|8(?:0[35-9]|2[1-5789]|3[02-578]|4[0-578]|5[124-9]|6[2-69]|7\\d|8[02-9]|9[02569])|9(?:0[02-589]|2[02-689]|3[1-5789]|4[2-9]|5[0-579]|6[234789]|7[0124578]|8\\d|9[2-57]))\\d{6}|1(?:2(?:0(?:46[1-4]|87[2-9])|545[1-79]|76(?:2\\d|3[1-8]|6[1-6])|9(?:7(?:2[0-4]|3[2-5])|8(?:2[2-8]|7[0-4789]|8[345])))|3(?:638[2-5]|647[23]|8(?:47[04-9]|64[015789]))|4(?:044[1-7]|20(?:2[23]|8\\d)|6(?:0(?:30|5[2-57]|6[1-8]|7[2-8])|140)|8(?:052|87[123]))|5(?:24(?:3[2-79]|6\\d)|276\\d|6(?:26[06-9]|686))|6(?:06(?:4\\d|7[4-79])|295[567]|35[34]\\d|47(?:24|61)|59(?:5[08]|6[67]|74)|955[0-4])|7(?:26(?:6[13-9]|7[0-7])|442\\d|50(?:2[0-3]|[3-68]2|76))|8(?:27[56]\\d|37(?:5[2-5]|8[239])|84(?:3[2-58]))|9(?:0(?:0(?:6[1-8]|85)|52\\d)|3583|4(?:66[1-8]|9(?:2[01]|81))|63(?:23|3[1-4])|9561))\\d{3}|176888[234678]\\d{2}|16977[23]\\d{3}","\\d{4,10}",,,"1212345678"],[,,"7(?:[1-4]\\d\\d|5(?:0[0-8]|[13-9]\\d|2[0-35-9])|7(?:0[1-9]|[1-7]\\d|8[02-9]|9[0-689])|8(?:[014-9]\\d|[23][0-8])|9(?:[04-9]\\d|1[02-9]|2[0-35-9]|3[0-689]))\\d{6}","\\d{10}",,,"7400123456"],[,,"80(?:0(?:1111|\\d{6,7})|8\\d{7})|500\\d{6}","\\d{7}(?:\\d{2,3})?",,,"8001234567"],[,,"(?:87[123]|9(?:[01]\\d|8[2349]))\\d{7}","\\d{10}",,,"9012345678"],[,,"8(?:4(?:5464\\d|[2-5]\\d{7})|70\\d{7})","\\d{7}(?:\\d{3})?",,,"8431234567"],[,,"70\\d{8}","\\d{10}",,,"7012345678"],[,,"56\\d{8}","\\d{10}",,,"5612345678"],"GB",44,"00","0"," x",,"0",,,,[[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["2|5[56]|7(?:0|6[013-9])","2|5[56]|7(?:0|6(?:[013-9]|2[0-35-9]))"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["1(?:1|\\d1)|3|9[018]"],"0$1"],[,"(\\d{5})(\\d{4,5})","$1 $2",["1(?:38|5[23]|69|76|94)","1(?:387|5(?:24|39)|697|768|946)","1(?:3873|5(?:242|39[456])|697[347]|768[347]|9467)"],"0$1"],[,"(1\\d{3})(\\d{5,6})","$1 $2",["1"],"0$1"],[,"(7\\d{3})(\\d{6})","$1 $2",["7(?:[1-5789]|62)","7(?:[1-5789]|624)"],"0$1"],[,"(800)(\\d{4})","$1 $2",["800","8001","80011","800111","8001111"],"0$1"],[,"(845)(46)(4\\d)","$1 $2 $3",["845","8454","84546","845464"],"0$1"],[,"(8\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["8(?:4[2-5]|7[0-3])"],"0$1"],[,"(80\\d)(\\d{3})(\\d{4})","$1 $2 $3",["80"],"0$1"],[,"([58]00)(\\d{6})","$1 $2",["[58]00"],"0$1"]],,[,,"76(?:0[012]|2[356]|4[0134]|5[49]|6[0-369]|77|81|9[39])\\d{6}","\\d{10}",,,"7640123456"],1,,[,,"NA","NA"],[,,"(?:3[0347]|55)\\d{8}","\\d{10}",,,"5512345678"],,,[,,"NA","NA"]],GD:[,[,,"[4589]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"473(?:2(?:3[0-2]|69)|3(?:2[89]|86)|4(?:[06]8|3[5-9]|4[0-49]|5[5-79]|68|73|90)|63[68]|7(?:58|84)|800|938)\\d{4}","\\d{7}(?:\\d{3})?",,,"4732691234"],[,,"473(?:4(?:0[2-79]|1[04-9]|20|58)|5(?:2[01]|3[3-8])|901)\\d{4}","\\d{10}",,,"4734031234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"GD",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"473",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],GE:[,[,,"[34578]\\d{8}","\\d{6,9}"],[,,"(?:3(?:[256]\\d|4[124-9]|7[0-4])|4(?:1\\d|2[2-7]|3[1-79]|4[2-8]|7[239]|9[1-7]))\\d{6}","\\d{6,9}",,,"322123456"],[,,"5(?:14|5[01578]|68|7[0147-9]|9[0-35-9])\\d{6}","\\d{9}",,,"555123456"],[,,"800\\d{6}","\\d{9}",,,"800123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"706\\d{6}","\\d{9}",,,"706123456"],"GE",995,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[348]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["7"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["5"],"$1"]],,[,,"NA","NA"],,,[,,"706\\d{6}","\\d{9}",,,"706123456"],[,,"NA","NA"],,,[,,"NA","NA"]],GF:[,[,,"[56]\\d{8}","\\d{9}"],[,,"594(?:10|2[012457-9]|3[0-57-9]|4[3-9]|5[7-9]|6[0-3]|9[014])\\d{4}","\\d{9}",,,"594101234"],[,,"694(?:[04][0-7]|1[0-5]|3[018]|[29]\\d)\\d{4}","\\d{9}",,,"694201234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"GF",594,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",,"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],GG:[,[,,"[135789]\\d{6,9}","\\d{6,10}"],[,,"1481\\d{6}","\\d{6,10}",,,"1481456789"],[,,"7(?:781|839|911)\\d{6}","\\d{10}",,,"7781123456"],[,,"80(?:0(?:1111|\\d{6,7})|8\\d{7})|500\\d{6}","\\d{7}(?:\\d{2,3})?",,,"8001234567"],[,,"(?:87[123]|9(?:[01]\\d|8[0-3]))\\d{7}","\\d{10}",,,"9012345678"],[,,"8(?:4(?:5464\\d|[2-5]\\d{7})|70\\d{7})","\\d{7}(?:\\d{3})?",,,"8431234567"],[,,"70\\d{8}","\\d{10}",,,"7012345678"],[,,"56\\d{8}","\\d{10}",,,"5612345678"],"GG",44,"00","0"," x",,"0",,,,,,[,,"76(?:0[012]|2[356]|4[0134]|5[49]|6[0-369]|77|81|9[39])\\d{6}","\\d{10}",,,"7640123456"],,,[,,"NA","NA"],[,,"(?:3[0347]|55)\\d{8}","\\d{10}",,,"5512345678"],,,[,,"NA","NA"]],GH:[,[,,"[235]\\d{8}|8\\d{7}","\\d{7,9}"],[,,"3(?:0[237]\\d|[167](?:2[0-6]|7\\d)|2(?:2[0-5]|7\\d)|3(?:2[0-3]|7\\d)|4(?:2[013-9]|3[01]|7\\d)|5(?:2[0-7]|7\\d)|8(?:2[0-2]|7\\d)|9(?:20|7\\d))\\d{5}","\\d{7,9}",,,"302345678"],[,,"(?:2[034678]\\d|5(?:[047]\\d|5[3-6]|6[01]))\\d{6}","\\d{9}",,,"231234567"],[,,"800\\d{5}","\\d{8}",,,"80012345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"GH",233,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[235]"],"0$1"],[,"(\\d{3})(\\d{5})","$1 $2",["8"],"0$1"]],,[,,"NA","NA"],,,[,,"800\\d{5}","\\d{8}",,,"80012345"],[,,"NA","NA"],,,[,,"NA","NA"]],GI:[,[,,"[2568]\\d{7}","\\d{8}"],[,,"2(?:00\\d|1(?:6[24-7]|9\\d)|2(?:00|2[2457]))\\d{4}","\\d{8}",,,"20012345"],[,,"(?:5[46-8]|62)\\d{6}","\\d{8}",,,"57123456"],[,,"80\\d{6}","\\d{8}",,,"80123456"],[,,"8[1-689]\\d{6}","\\d{8}",,,"88123456"],[,,"87\\d{6}","\\d{8}",,,"87123456"],[,,"NA","NA"],[,,"NA","NA"],"GI",350,"00",,,,,,,,[[,"(\\d{3})(\\d{5})","$1 $2",["2"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],GL:[,[,,"[1-689]\\d{5}","\\d{6}"],[,,"(?:19|3[1-6]|6[14689]|8[14-79]|9\\d)\\d{4}","\\d{6}",,,"321000"],[,,"[245][2-9]\\d{4}","\\d{6}",,,"221234"],[,,"80\\d{4}","\\d{6}",,,"801234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"3[89]\\d{4}","\\d{6}",,,"381234"],"GL",299,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],GM:[,[,,"[2-9]\\d{6}","\\d{7}"],[,,"(?:4(?:[23]\\d{2}|4(?:1[024679]|[6-9]\\d))|5(?:54[0-7]|6(?:[67]\\d)|7(?:1[04]|2[035]|3[58]|48))|8\\d{3})\\d{3}","\\d{7}",,,"5661234"],[,,"[23679]\\d{6}","\\d{7}",,,"3012345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"GM",220,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],GN:[,[,,"[367]\\d{7,8}","\\d{8,9}"],[,,"30(?:24|3[12]|4[1-35-7]|5[13]|6[189]|[78]1|9[1478])\\d{4}","\\d{8}",,,"30241234"],[,,"6[02356]\\d{7}","\\d{9}",,,"601123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"722\\d{6}","\\d{9}",,,"722123456"],"GN",224,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["3"]],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[67]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],GP:[,[,,"[56]\\d{8}","\\d{9}"],[,,"590(?:0[13468]|1[012]|2[0-68]|3[28]|4[0-8]|5[579]|6[0189]|70|8[0-689]|9\\d)\\d{4}","\\d{9}",,,"590201234"],[,,"690(?:0[0-7]|[1-9]\\d)\\d{4}","\\d{9}",,,"690301234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"GP",590,"00","0",,,"0",,,,[[,"([56]90)(\\d{2})(\\d{4})","$1 $2-$3",,"0$1"]],,[,,"NA","NA"],1,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],GQ:[,[,,"[23589]\\d{8}","\\d{9}"],[,,"3(?:3(?:3\\d[7-9]|[0-24-9]\\d[46])|5\\d{2}[7-9])\\d{4}","\\d{9}",,,"333091234"],[,,"(?:222|55[15])\\d{6}","\\d{9}",,,"222123456"],[,,"80\\d[1-9]\\d{5}","\\d{9}",,,"800123456"],[,,"90\\d[1-9]\\d{5}","\\d{9}",,,"900123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"GQ",240,"00",,,,,,,,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[235]"]],[,"(\\d{3})(\\d{6})","$1 $2",["[89]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],GR:[,[,,"[26-9]\\d{9}","\\d{10}"],[,,"2(?:1\\d{2}|2(?:2[1-46-9]|3[1-8]|4[1-7]|5[1-4]|6[1-8]|7[1-5]|[89][1-9])|3(?:1\\d|2[1-57]|[35][1-3]|4[13]|7[1-7]|8[124-6]|9[1-79])|4(?:1\\d|2[1-8]|3[1-4]|4[13-5]|6[1-578]|9[1-5])|5(?:1\\d|[29][1-4]|3[1-5]|4[124]|5[1-6])|6(?:1\\d|3[1245]|4[1-7]|5[13-9]|[269][1-6]|7[14]|8[1-5])|7(?:1\\d|2[1-5]|3[1-6]|4[1-7]|5[1-57]|6[135]|9[125-7])|8(?:1\\d|2[1-5]|[34][1-4]|9[1-57]))\\d{6}","\\d{10}",,,"2123456789"],[,,"69\\d{8}","\\d{10}",,,"6912345678"],[,,"800\\d{7}","\\d{10}",,,"8001234567"],[,,"90[19]\\d{7}","\\d{10}",,,"9091234567"],[,,"8(?:0[16]|12|25)\\d{7}","\\d{10}",,,"8011234567"],[,,"70\\d{8}","\\d{10}",,,"7012345678"],[,,"NA","NA"],"GR",30,"00",,,,,,,,[[,"([27]\\d)(\\d{4})(\\d{4})","$1 $2 $3",["21|7"]],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["2[2-9]1|[689]"]],[,"(2\\d{3})(\\d{6})","$1 $2",["2[2-9][02-9]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],GT:[,[,,"[2-7]\\d{7}|1[89]\\d{9}","\\d{8}(?:\\d{3})?"],[,,"[267][2-9]\\d{6}","\\d{8}",,,"22456789"],[,,"[345]\\d{7}","\\d{8}",,,"51234567"],[,,"18[01]\\d{8}","\\d{11}",,,"18001112222"],[,,"19\\d{9}","\\d{11}",,,"19001112222"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"GT",502,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1 $2",["[2-7]"]],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],GU:[,[,,"[5689]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"671(?:3(?:00|3[39]|4[349]|55|6[26])|4(?:56|7[1-9]|8[236-9])|5(?:55|6[2-5]|88)|6(?:3[2-578]|4[24-9]|5[34]|78|8[5-9])|7(?:[079]7|2[0167]|3[45]|47|8[789])|8(?:[2-5789]8|6[48])|9(?:2[29]|6[79]|7[179]|8[789]|9[78]))\\d{4}","\\d{7}(?:\\d{3})?",,,"6713001234"],[,,"671(?:3(?:00|3[39]|4[349]|55|6[26])|4(?:56|7[1-9]|8[236-9])|5(?:55|6[2-5]|88)|6(?:3[2-578]|4[24-9]|5[34]|78|8[5-9])|7(?:[079]7|2[0167]|3[45]|47|8[789])|8(?:[2-5789]8|6[48])|9(?:2[29]|6[79]|7[179]|8[789]|9[78]))\\d{4}","\\d{7}(?:\\d{3})?",,,"6713001234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"GU",1,"011","1",,,"1",,,1,,,[,,"NA","NA"],,"671",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],GW:[,[,,"(?:4(?:0\\d{5}|4\\d{7})|9\\d{8})","\\d{7,9}"],[,,"443(?:2[0125]|3[1245]|4[12]|5[1-4]|70|9[1-467])\\d{4}","\\d{7,9}",,,"443201234"],[,,"9(?:55\\d|6(?:6\\d|9[012])|77\\d)\\d{5}","\\d{7,9}",,,"955012345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"40\\d{5}","\\d{7,9}",,,"4012345"],"GW",245,"00",,,,,,,,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["44|9[567]"]],[,"(\\d{3})(\\d{4})","$1 $2",["40"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],GY:[,[,,"[2-4679]\\d{6}","\\d{7}"],[,,"(?:2(?:1[6-9]|2[0-35-9]|3[1-4]|5[3-9]|6\\d|7[0-24-79])|3(?:2[25-9]|3\\d)|4(?:4[0-24]|5[56])|77[1-57])\\d{4}","\\d{7}",,,"2201234"],[,,"6\\d{6}","\\d{7}",,,"6091234"],[,,"(?:289|862)\\d{4}","\\d{7}",,,"2891234"],[,,"9008\\d{3}","\\d{7}",,,"9008123"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"GY",592,"001",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],HK:[,[,,"[235-7]\\d{7}|8\\d{7,8}|9\\d{4,10}","\\d{5,11}"],[,,"(?:[23]\\d|58)\\d{6}","\\d{8}",,,"21234567"],[,,"(?:5[1-79]\\d|6\\d{2}|8[4-79]\\d|9(?:0[1-9]|[1-8]\\d))\\d{5}","\\d{8}",,,"51234567"],[,,"800\\d{6}","\\d{9}",,,"800123456"],[,,"900(?:[0-24-9]\\d{7}|3\\d{1,4})","\\d{5,11}",,,"90012345678"],[,,"NA","NA"],[,,"8[1-3]\\d{6}","\\d{8}",,,"81123456"],[,,"NA","NA"],"HK",852,"00(?:[126-9]|30|5[09])?",,,,,,"00",,[[,"(\\d{4})(\\d{4})","$1 $2",["[235-7]|[89](?:0[1-9]|[1-9])"]],[,"(800)(\\d{3})(\\d{3})","$1 $2 $3",["800"]],[,"(900)(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3 $4",["900"]],[,"(900)(\\d{2,5})","$1 $2",["900"]]],,[,,"7\\d{7}","\\d{8}",,,"71234567"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],HN:[,[,,"[237-9]\\d{7}","\\d{8}"],[,,"2(?:2(?:0[019]|1[1-36]|[23]\\d|4[056]|5[57]|7[01389]|8[0146-9]|9[012])|4(?:07|2[3-59]|3[13-689]|4[0-68]|5[1-35])|5(?:16|4[3-5]|5\\d|6[4-6]|74)|6(?:[056]\\d|17|3[04]|4[0-378]|[78][0-8]|9[01])|7(?:6[46-9]|7[02-9]|8[034])|8(?:79|8[0-35789]|9[1-57-9]))\\d{4}","\\d{8}",,,"22123456"],[,,"[37-9]\\d{7}","\\d{8}",,,"91234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"HN",504,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1-$2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],HR:[,[,,"[1-7]\\d{5,8}|[89]\\d{6,11}","\\d{6,12}"],[,,"1\\d{7}|(?:2[0-3]|3[1-5]|4[02-47-9]|5[1-3])\\d{6,7}","\\d{6,9}",,,"12345678"],[,,"9(?:[1-9]\\d{6,10}|01\\d{6,9})","\\d{8,12}",,,"912345678"],[,,"80[01]\\d{4,7}","\\d{7,10}",,,"8001234567"],[,,"6(?:[01459]\\d{4,7})","\\d{6,9}",,,"611234"],[,,"NA","NA"],[,,"7[45]\\d{4,7}","\\d{6,9}",,,"741234567"],[,,"NA","NA"],"HR",385,"00","0",,,"0",,,,[[,"(1)(\\d{4})(\\d{3})","$1 $2 $3",["1"],"0$1"],[,"(6[09])(\\d{4})(\\d{3})","$1 $2 $3",["6[09]"],"0$1"],[,"([67]2)(\\d{3})(\\d{3,4})","$1 $2 $3",["[67]2"],"0$1"],[,"([2-5]\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-5]"],"0$1"],[,"(9\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["9"],"0$1"],[,"(9\\d)(\\d{4})(\\d{4})","$1 $2 $3",["9"],"0$1"],[,"(9\\d)(\\d{3,4})(\\d{3})(\\d{3})","$1 $2 $3 $4",["9"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{2,3})","$1 $2 $3",["6[0145]|7"],"0$1"],[,"(\\d{2})(\\d{3,4})(\\d{3})","$1 $2 $3",["6[0145]|7"],"0$1"],[,"(80[01])(\\d{2})(\\d{2,3})","$1 $2 $3",["8"],"0$1"],[,"(80[01])(\\d{3,4})(\\d{3})","$1 $2 $3",["8"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"[76]2\\d{6,7}","\\d{8,9}",,,"62123456"],,,[,,"NA","NA"]],HT:[,[,,"[2-489]\\d{7}","\\d{8}"],[,,"2(?:[248]\\d|5[1-5]|94)\\d{5}","\\d{8}",,,"22453300"],[,,"(?:3[1-9]\\d|4\\d{2}|9(?:8[0-35]|9[5-9]))\\d{5}","\\d{8}",,,"34101234"],[,,"8\\d{7}","\\d{8}",,,"80012345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"98[89]\\d{5}","\\d{8}",,,"98901234"],"HT",509,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],HU:[,[,,"[1-9]\\d{7,8}","\\d{6,9}"],[,,"(?:1\\d|2(?:1\\d|[2-9])|3(?:[2-7]|8\\d)|4[24-9]|5[2-79]|6[23689]|7(?:1\\d|[2-9])|8[2-57-9]|9[2-69])\\d{6}","\\d{6,9}",,,"12345678"],[,,"(?:[257]0|3[01])\\d{7}","\\d{9}",,,"201234567"],[,,"80\\d{6}","\\d{8}",,,"80123456"],[,,"9[01]\\d{6}","\\d{8}",,,"90123456"],[,,"40\\d{6}","\\d{8}",,,"40123456"],[,,"NA","NA"],[,,"NA","NA"],"HU",36,"00","06",,,"06",,,,[[,"(1)(\\d{3})(\\d{4})","$1 $2 $3",["1"],"($1)"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-9]"],"($1)"]],,[,,"NA","NA"],,,[,,"[48]0\\d{6}","\\d{8}",,,"80123456"],[,,"NA","NA"],,,[,,"NA","NA"]],ID:[,[,,"(?:[1-79]\\d{6,10}|8\\d{7,11})","\\d{5,12}"],[,,"2(?:1(?:14\\d{3}|[0-8]\\d{6,7}|500\\d{3}|9\\d{6})|2\\d{6,8}|4\\d{7,8})|(?:2(?:[35][1-4]|6[0-8]|7[1-6]|8\\d|9[1-8])|3(?:1|[25][1-8]|3[1-68]|4[1-3]|6[1-3568]|7[0-469]|8\\d)|4(?:0[1-589]|1[01347-9]|2[0-36-8]|3[0-24-68]|43|5[1-378]|6[1-5]|7[134]|8[1245])|5(?:1[1-35-9]|2[25-8]|3[124-9]|4[1-3589]|5[1-46]|6[1-8])|6(?:19?|[25]\\d|3[1-69]|4[1-6])|7(?:02|[125][1-9]|[36]\\d|4[1-8]|7[0-36-9])|9(?:0[12]|1[013-8]|2[0-479]|5[125-8]|6[23679]|7[159]|8[01346]))\\d{5,8}","\\d{5,11}",,,"612345678"],[,,"(?:2(?:1(?:3[145]|4[01]|5[1-469]|60|8[0359]|9\\d)|2(?:88|9[1256])|3[1-4]9|4(?:36|91)|5(?:1[349]|[2-4]9)|6[0-7]9|7(?:[1-36]9|4[39])|8[1-5]9|9[1-48]9)|3(?:19[1-3]|2[12]9|3[13]9|4(?:1[69]|39)|5[14]9|6(?:1[69]|2[89])|709)|4[13]19|5(?:1(?:19|8[39])|4[129]9|6[12]9)|6(?:19[12]|2(?:[23]9|77))|7(?:1[13]9|2[15]9|419|5(?:1[89]|29)|6[15]9|7[178]9))\\d{5,6}|8[1-35-9]\\d{7,10}","\\d{9,12}",,,"812345678"],[,,"177\\d{6,8}|800\\d{5,7}","\\d{8,11}",,,"8001234567"],[,,"809\\d{7}","\\d{10}",,,"8091234567"],[,,"804\\d{7}","\\d{10}",,,"8041234567"],[,,"NA","NA"],[,,"NA","NA"],"ID",62,"0(?:0[1789]|10(?:00|1[67]))","0",,,"0",,,,[[,"(\\d{2})(\\d{5,8})","$1 $2",["2[124]|[36]1"],"(0$1)"],[,"(\\d{3})(\\d{5,8})","$1 $2",["[4579]|2[035-9]|[36][02-9]"],"(0$1)"],[,"(8\\d{2})(\\d{3,4})(\\d{3,5})","$1-$2-$3",["8[1-35-9]"],"0$1"],[,"(1)(500)(\\d{3})","$1 $2 $3",["15"],"$1"],[,"(177)(\\d{6,8})","$1 $2",["17"],"0$1"],[,"(800)(\\d{5,7})","$1 $2",["800"],"0$1"],[,"(804)(\\d{3})(\\d{4})","$1 $2 $3",["804"],"0$1"],[,"(80\\d)(\\d)(\\d{3})(\\d{3})","$1 $2 $3 $4",["80[79]"],"0$1"]],,[,,"NA","NA"],,,[,,"8071\\d{6}","\\d{10}",,,"8071123456"],[,,"1500\\d{3}|8071\\d{6}","\\d{7,10}",,,"8071123456"],,,[,,"NA","NA"]],IE:[,[,,"[124-9]\\d{6,9}","\\d{5,10}"],[,,"1\\d{7,8}|2(?:1\\d{6,7}|3\\d{7}|[24-9]\\d{5})|4(?:0[24]\\d{5}|[1-469]\\d{7}|5\\d{6}|7\\d{5}|8[0-46-9]\\d{7})|5(?:0[45]\\d{5}|1\\d{6}|[23679]\\d{7}|8\\d{5})|6(?:1\\d{6}|[237-9]\\d{5}|[4-6]\\d{7})|7[14]\\d{7}|9(?:1\\d{6}|[04]\\d{7}|[35-9]\\d{5})","\\d{5,10}",,,"2212345"],[,,"8(?:22\\d{6}|[35-9]\\d{7})","\\d{9}",,,"850123456"],[,,"1800\\d{6}","\\d{10}",,,"1800123456"],[,,"15(?:1[2-8]|[2-8]0|9[089])\\d{6}","\\d{10}",,,"1520123456"],[,,"18[59]0\\d{6}","\\d{10}",,,"1850123456"],[,,"700\\d{6}","\\d{9}",,,"700123456"],[,,"76\\d{7}","\\d{9}",,,"761234567"],"IE",353,"00","0",,,"0",,,,[[,"(1)(\\d{3,4})(\\d{4})","$1 $2 $3",["1"],"(0$1)"],[,"(\\d{2})(\\d{5})","$1 $2",["2[24-9]|47|58|6[237-9]|9[35-9]"],"(0$1)"],[,"(\\d{3})(\\d{5})","$1 $2",["40[24]|50[45]"],"(0$1)"],[,"(48)(\\d{4})(\\d{4})","$1 $2 $3",["48"],"(0$1)"],[,"(818)(\\d{3})(\\d{3})","$1 $2 $3",["81"],"(0$1)"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[24-69]|7[14]"],"(0$1)"],[,"([78]\\d)(\\d{3,4})(\\d{4})","$1 $2 $3",["76|8[35-9]"],"0$1"],[,"(700)(\\d{3})(\\d{3})","$1 $2 $3",["70"],"0$1"],[,"(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1(?:8[059]|5)","1(?:8[059]0|5)"],"$1"]],,[,,"NA","NA"],,,[,,"18[59]0\\d{6}","\\d{10}",,,"1850123456"],[,,"818\\d{6}","\\d{9}",,,"818123456"],,,[,,"8[35-9]\\d{8}","\\d{10}",,,"8501234567"]],IL:[,[,,"[17]\\d{6,9}|[2-589]\\d{3}(?:\\d{3,6})?|6\\d{3}","\\d{4,10}"],[,,"[2-489]\\d{7}","\\d{7,8}",,,"21234567"],[,,"5(?:[02-47-9]\\d{2}|5(?:01|2[23]|3[2-4]|4[45]|5[5689]|6[67]|7[0178]|8[6-9]|9[4-9])|6[2-9]\\d)\\d{5}","\\d{9}",,,"501234567"],[,,"1(?:80[019]\\d{3}|255)\\d{3}","\\d{7,10}",,,"1800123456"],[,,"1(?:212|(?:9(?:0[01]|19)|200)\\d{2})\\d{4}","\\d{8,10}",,,"1919123456"],[,,"1700\\d{6}","\\d{10}",,,"1700123456"],[,,"NA","NA"],[,,"7(?:18\\d|2[23]\\d|3[237]\\d|47\\d|6(?:5\\d|8[0168])|7\\d{2}|8(?:2\\d|33|55|77|81)|9[29]\\d)\\d{5}","\\d{9}",,,"771234567"],"IL",972,"0(?:0|1[2-9])","0",,,"0",,,,[[,"([2-489])(\\d{3})(\\d{4})","$1-$2-$3",["[2-489]"],"0$1"],[,"([57]\\d)(\\d{3})(\\d{4})","$1-$2-$3",["[57]"],"0$1"],[,"(1)([7-9]\\d{2})(\\d{3})(\\d{3})","$1-$2-$3-$4",["1[7-9]"],"$1"],[,"(1255)(\\d{3})","$1-$2",["125"],"$1"],[,"(1200)(\\d{3})(\\d{3})","$1-$2-$3",["120"],"$1"],[,"(1212)(\\d{2})(\\d{2})","$1-$2-$3",["121"],"$1"],[,"(1599)(\\d{6})","$1-$2",["15"],"$1"],[,"(\\d{4})","*$1",["[2-689]"],"$1"]],,[,,"NA","NA"],,,[,,"1700\\d{6}|[2-689]\\d{3}","\\d{4,10}",,,"1700123456"],[,,"[2-689]\\d{3}|1599\\d{6}","\\d{4}(?:\\d{6})?",,,"1599123456"],,,[,,"NA","NA"]],IM:[,[,,"[135789]\\d{6,9}","\\d{6,10}"],[,,"1624\\d{6}","\\d{6,10}",,,"1624456789"],[,,"7[569]24\\d{6}","\\d{10}",,,"7924123456"],[,,"808162\\d{4}","\\d{10}",,,"8081624567"],[,,"(?:872299|90[0167]624)\\d{4}","\\d{10}",,,"9016247890"],[,,"8(?:4(?:40[49]06|5624\\d)|70624\\d)\\d{3}","\\d{10}",,,"8456247890"],[,,"70\\d{8}","\\d{10}",,,"7012345678"],[,,"56\\d{8}","\\d{10}",,,"5612345678"],"IM",44,"00","0"," x",,"0",,,,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"3(?:08162\\d|3\\d{5}|4(?:40[49]06|5624\\d)|7(?:0624\\d|2299\\d))\\d{3}|55\\d{8}","\\d{10}",,,"5512345678"],,,[,,"NA","NA"]],IN:[,[,,"008\\d{9}|1\\d{7,12}|[2-9]\\d{9,10}","\\d{6,13}"],[,,"(?:11|2[02]|33|4[04]|79)[2-7]\\d{7}|80[2-467]\\d{7}|(?:1(?:2[0-249]|3[0-25]|4[145]|[59][14]|6[014]|7[1257]|8[01346])|2(?:1[257]|3[013]|4[01]|5[0137]|6[0158]|78|8[1568]|9[14])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|[36][25]|22|4[28]|5[12]|[78]1|9[15])|6(?:12|[2345]1|57|6[13]|7[14]|80)|7(?:12|2[14]|3[134]|4[47]|5[15]|[67]1|88)|8(?:16|2[014]|3[126]|6[136]|7[078]|8[34]|91))[2-7]\\d{6}|(?:(?:1(?:2[35-8]|3[346-9]|4[236-9]|[59][0235-9]|6[235-9]|7[34689]|8[257-9])|2(?:1[134689]|3[24-8]|4[2-8]|5[25689]|6[2-4679]|7[13-79]|8[2-479]|9[235-9])|3(?:01|1[79]|2[1-5]|4[25-8]|5[125689]|6[235-7]|7[157-9]|8[2-467])|4(?:1[14578]|2[5689]|3[2-467]|5[4-7]|6[35]|73|8[2689]|9[2389])|5(?:[16][146-9]|2[14-8]|3[1346]|4[14-69]|5[46]|7[2-4]|8[2-8]|9[246])|6(?:1[1358]|2[2457]|3[2-4]|4[235-7]|[57][2-689]|6[24-578]|8[1-6])|8(?:1[1357-9]|2[235-8]|3[03-57-9]|4[0-24-9]|5\\d|6[2457-9]|7[1-6]|8[1256]|9[2-4]))\\d|7(?:(?:1[013-9]|2[0235-9]|3[2679]|4[1-35689]|5[2-46-9]|[67][02-9]|9\\d)\\d|8(?:2[0-6]|[013-8]\\d)))[2-7]\\d{5}","\\d{6,10}",,,"1123456789"],[,,"(?:7(?:0\\d{3}|2(?:[0235679]\\d{2}|[14][017-9]\\d|8(?:[0-59]\\d|6[089]|78)|9[389]\\d)|3(?:[05-8]\\d{2}|1(?:[089]\\d|7[5-8])|2(?:[5-8]\\d|[01][089])|3[17-9]\\d|4(?:[07-9]\\d|11)|9(?:[01689]\\d|59))|4(?:0[1-9]\\d|1(?:[015-9]\\d|4[08])|2(?:09|[1-7][089]|[89]\\d)|3(?:[0-8][089]|9\\d)|4(?:[089]\\d|11|7[02-8])|5(?:0[089]|[59]9)|7(?:0[3-9]|11|7[02-8]|[89]\\d)|8(?:[0-24-7][089]|[389]\\d)|9(?:[0-6][089]|7[08]|[89]\\d))|5(?:[034678]\\d|2[03-9]|5[017-9]|9[7-9])\\d|6(?:0[0-47]|1[0-257-9]|2[0-4]|3[19]|5[4589]|[6-9]\\d)\\d|7(?:0[2-9]|[1-79]\\d|8[1-9])\\d|8(?:[0-79]\\d{2}|88[01])|99[4-9]\\d)|8(?:0(?:[01589]\\d|6[67])|1(?:[02-57-9]\\d|1[0135-9])|2(?:[236-9]\\d|5[1-9])|3(?:[0357-9]\\d|4[1-9])|[45]\\d{2}|6[02457-9]\\d|7(?:07|[1-69]\\d)|8(?:[0-26-9]\\d|44|5[2-9])|9(?:[035-9]\\d|2[2-9]|4[0-8]))\\d|9\\d{4})\\d{5}","\\d{10}",,,"9987654321"],[,,"00800\\d{7}|1(?:600\\d{6}|80(?:0\\d{4,9}|3\\d{9}))","\\d{8,13}",,,"1800123456"],[,,"186[12]\\d{9}","\\d{13}",,,"1861123456789"],[,,"1860\\d{7}","\\d{11}",,,"18603451234"],[,,"NA","NA"],[,,"NA","NA"],"IN",91,"00","0",,,"0",,,,[[,"(\\d{5})(\\d{5})","$1 $2",["7(?:[023578]|4[0-57-9]|6[0-35-9]|99)|8(?:0[015689]|1[0-57-9]|2[2356-9]|3[0-57-9]|[45]|6[02457-9]|7[01-69]|8[0-24-9]|9[02-9])|9","7(?:[08]|2(?:[0235679]|[14][017-9]|8[0-79]|9[389])|3(?:[05-8]|1[07-9]|2[015-8]|3[17-9]|4[017-9]|9[015689])|4(?:0[1-9]|1[014-9]|[2389]|[47][017-9]|5[059])|5(?:[034678]|2[03-9]|5[017-9]|9[7-9])|6(?:0[0-47]|1[0-257-9]|2[0-4]|3[19]|5[4589]|[6-9])|7(?:0[2-9]|[1-79]|8[1-9])|99[4-9])|8(?:0(?:[01589]|6[67])|1(?:[02-57-9]|1[0135-9])|2(?:[236-9]|5[1-9])|3(?:[0357-9]|4[1-9])|[45]|6[02457-9]|7(?:07|[1-69])|8(?:[0-26-9]|44|5[2-9])|9(?:[035-9]|2[2-9]|4[0-8]))|9","7(?:0|2(?:[0235679]|[14][017-9]|8(?:[0-569]|78)|9[389])|3(?:[05-8]|1(?:[089]|7[5-9])|2(?:[5-8]|[01][089])|3[17-9]|4(?:[07-9]|11)|9(?:[01689]|59))|4(?:0[1-9]|1(?:[015-9]|4[08])|2(?:09|[1-7][089]|[89])|3(?:[0-8][089]|9)|4(?:[089]|11|7[02-8])|5(?:0[089]|[59]9)|7(?:0[3-9]|11|7[02-8]|[89])|8(?:[0-24-7][089]|[389])|9(?:[0-6][089]|7[08]|[89]))|5(?:[034678]|2[03-9]|5[017-9]|9[7-9])|6(?:0[0-47]|1[0-257-9]|2[0-4]|3[19]|5[4589]|[6-9])|7(?:0[2-9]|[1-79]|8[1-9])|8(?:[0-79]|88[01])|99[4-9])|8(?:0(?:[01589]|6[67])|1(?:[02-57-9]|1[0135-9])|2(?:[236-9]|5[1-9])|3(?:[0357-9]|4[1-9])|[45]|6[02457-9]|7(?:07|[1-69])|8(?:[0-26-9]|44|5[2-9])|9(?:[035-9]|2[2-9]|4[0-8]))|9"],"0$1",,1],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["11|2[02]|33|4[04]|79|80[2-46]"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["1(?:2[0-249]|3[0-25]|4[145]|[569][14]|7[1257]|8[1346]|[68][1-9])|2(?:1[257]|3[013]|4[01]|5[0137]|6[0158]|78|8[1568]|9[14])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|[36][25]|22|4[28]|5[12]|[78]1|9[15])|6(?:12|[2345]1|57|6[13]|7[14]|80)"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["7(?:12|2[14]|3[134]|4[47]|5[15]|[67]1|88)","7(?:12|2[14]|3[134]|4[47]|5(?:1|5[2-6])|[67]1|88)"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8(?:16|2[014]|3[126]|6[136]|7[078]|8[34]|91)"],"0$1",,1],[,"(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1(?:[23579]|[468][1-9])|[2-8]"],"0$1",,1],[,"(\\d{2})(\\d{3})(\\d{4})(\\d{3})","$1 $2 $3 $4",["008"],"0$1",,1],[,"(1600)(\\d{2})(\\d{4})","$1 $2 $3",["160","1600"],"$1",,1],[,"(1800)(\\d{4,5})","$1 $2",["180","1800"],"$1",,1],[,"(18[06]0)(\\d{2,4})(\\d{4})","$1 $2 $3",["18[06]","18[06]0"],"$1",,1],[,"(140)(\\d{3})(\\d{4})","$1 $2 $3",["140"],"$1",,1],[,"(\\d{4})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["18[06]","18(?:0[03]|6[12])"],"$1",,1]],,[,,"NA","NA"],,,[,,"00800\\d{7}|1(?:600\\d{6}|8(?:0(?:0\\d{4,9}|3\\d{9})|6(?:0\\d{7}|[12]\\d{9})))","\\d{8,13}",,,"1800123456"],[,,"140\\d{7}","\\d{10}",,,"1409305260"],1,,[,,"NA","NA"]],IO:[,[,,"3\\d{6}","\\d{7}"],[,,"37\\d{5}","\\d{7}",,,"3709100"],[,,"38\\d{5}","\\d{7}",,,"3801234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"IO",246,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],IQ:[,[,,"[1-7]\\d{7,9}","\\d{6,10}"],[,,"1\\d{7}|(?:2[13-5]|3[02367]|4[023]|5[03]|6[026])\\d{6,7}","\\d{6,9}",,,"12345678"],[,,"7[3-9]\\d{8}","\\d{10}",,,"7912345678"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"IQ",964,"00","0",,,"0",,,,[[,"(1)(\\d{3})(\\d{4})","$1 $2 $3",["1"],"0$1"],[,"([2-6]\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-6]"],"0$1"],[,"(7\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],IR:[,[,,"[1-8]\\d{9}|9(?:[0-4]\\d{8}|9\\d{2,8})","\\d{4,10}"],[,,"(?:1[137]|2[13-68]|3[1458]|4[145]|5[146-8]|6[146]|7[1467]|8[13467])\\d{8}","\\d{10}",,,"2123456789"],[,,"9(?:0[1-3]|[13]\\d|2[0-2]|90)\\d{7}","\\d{10}",,,"9123456789"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"(?:[2-6]0\\d|993)\\d{7}","\\d{10}",,,"9932123456"],"IR",98,"00","0",,,"0",,,,[[,"(21)(\\d{3,5})","$1 $2",["21"],"0$1"],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["[1-8]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["9"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2,3})","$1 $2 $3",["9"],"0$1"],[,"(\\d{3})(\\d{3})","$1 $2",["9"],"0$1"]],,[,,"943\\d{7}","\\d{10}",,,"9432123456"],,,[,,"NA","NA"],[,,"9990\\d{0,6}","\\d{4,10}",,,"9990123456"],,,[,,"NA","NA"]],IS:[,[,,"[4-9]\\d{6}|38\\d{7}","\\d{7,9}"],[,,"(?:4(?:1[0-24-6]|2[0-7]|[37][0-8]|4[0-245]|5[0-68]|6\\d|8[0-36-8])|5(?:05|[156]\\d|2[02578]|3[013-79]|4[03-7]|7[0-2578]|8[0-35-9]|9[013-689])|87[23])\\d{4}","\\d{7}",,,"4101234"],[,,"38[589]\\d{6}|(?:6(?:1[1-8]|2[056]|3[089]|4[0167]|5[0159]|[67][0-69]|9\\d)|7(?:5[057]|6[0-2]|[78]\\d)|8(?:2[0-59]|3[0-4]|[469]\\d|5[1-9]))\\d{4}","\\d{7,9}",,,"6111234"],[,,"800\\d{4}","\\d{7}",,,"8001234"],[,,"90\\d{5}","\\d{7}",,,"9011234"],[,,"NA","NA"],[,,"NA","NA"],[,,"49\\d{5}","\\d{7}",,,"4921234"],"IS",354,"1(?:0(?:01|10|20)|100)|00",,,,,,"00",,[[,"(\\d{3})(\\d{4})","$1 $2",["[4-9]"]],[,"(3\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["3"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"809\\d{4}","\\d{7}",,,"8091234"],,,[,,"(?:6(?:2[1-478]|49|8\\d)|8(?:7[0189]|80)|95[48])\\d{4}","\\d{7}",,,"6211234"]],IT:[,[,,"[01589]\\d{5,10}|3(?:[12457-9]\\d{8}|[36]\\d{7,9})","\\d{6,11}"],[,,"0(?:[26]\\d{4,9}|(?:1(?:[0159]\\d|[27][1-5]|31|4[1-4]|6[1356]|8[2-57])|3(?:[0159]\\d|2[1-4]|3[12]|[48][1-6]|6[2-59]|7[1-7])|4(?:[0159]\\d|[23][1-9]|4[245]|6[1-5]|7[1-4]|81)|5(?:[0159]\\d|2[1-5]|3[2-6]|4[1-79]|6[4-6]|7[1-578]|8[3-8])|7(?:[0159]\\d|2[12]|3[1-7]|4[2346]|6[13569]|7[13-6]|8[1-59])|8(?:[0159]\\d|2[34578]|3[1-356]|[6-8][1-5])|9(?:[0159]\\d|[238][1-5]|4[12]|6[1-8]|7[1-6]))\\d{2,7})","\\d{6,11}",,,"0212345678"],[,,"3(?:[12457-9]\\d{8}|6\\d{7,8}|3\\d{7,9})","\\d{9,11}",,,"3123456789"],[,,"80(?:0\\d{6}|3\\d{3})","\\d{6,9}",,,"800123456"],[,,"0878\\d{5}|1(?:44|6[346])\\d{6}|89(?:2\\d{3}|4(?:[0-4]\\d{2}|[5-9]\\d{4})|5(?:[0-4]\\d{2}|[5-9]\\d{6})|9\\d{6})","\\d{6,10}",,,"899123456"],[,,"84(?:[08]\\d{6}|[17]\\d{3})","\\d{6,9}",,,"848123456"],[,,"1(?:78\\d|99)\\d{6}","\\d{9,10}",,,"1781234567"],[,,"55\\d{8}","\\d{10}",,,"5512345678"],"IT",39,"00",,,,,,,,[[,"(\\d{2})(\\d{3,4})(\\d{4})","$1 $2 $3",["0[26]|55"]],[,"(0[26])(\\d{4})(\\d{5})","$1 $2 $3",["0[26]"]],[,"(0[26])(\\d{4,6})","$1 $2",["0[26]"]],[,"(0\\d{2})(\\d{3,4})(\\d{4})","$1 $2 $3",["0[13-57-9][0159]"]],[,"(\\d{3})(\\d{3,6})","$1 $2",["0[13-57-9][0159]|8(?:03|4[17]|9[245])","0[13-57-9][0159]|8(?:03|4[17]|9(?:2|[45][0-4]))"]],[,"(0\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["0[13-57-9][2-46-8]"]],[,"(0\\d{3})(\\d{2,6})","$1 $2",["0[13-57-9][2-46-8]"]],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["[13]|8(?:00|4[08]|9[59])","[13]|8(?:00|4[08]|9(?:5[5-9]|9))"]],[,"(\\d{4})(\\d{4})","$1 $2",["894","894[5-9]"]],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["3"]]],,[,,"NA","NA"],1,,[,,"848\\d{6}","\\d{9}",,,"848123456"],[,,"NA","NA"],1,,[,,"NA","NA"]],JE:[,[,,"[135789]\\d{6,9}","\\d{6,10}"],[,,"1534\\d{6}","\\d{6,10}",,,"1534456789"],[,,"7(?:509|7(?:00|97)|829|937)\\d{6}","\\d{10}",,,"7797123456"],[,,"80(?:07(?:35|81)|8901)\\d{4}","\\d{10}",,,"8007354567"],[,,"(?:871206|90(?:066[59]|1810|71(?:07|55)))\\d{4}","\\d{10}",,,"9018105678"],[,,"8(?:4(?:4(?:4(?:05|42|69)|703)|5(?:041|800))|70002)\\d{4}","\\d{10}",,,"8447034567"],[,,"701511\\d{4}","\\d{10}",,,"7015115678"],[,,"56\\d{8}","\\d{10}",,,"5612345678"],"JE",44,"00","0"," x",,"0",,,,,,[,,"76(?:0[012]|2[356]|4[0134]|5[49]|6[0-369]|77|81|9[39])\\d{6}","\\d{10}",,,"7640123456"],,,[,,"NA","NA"],[,,"3(?:0(?:07(?:35|81)|8901)|3\\d{4}|4(?:4(?:4(?:05|42|69)|703)|5(?:041|800))|7(?:0002|1206))\\d{4}|55\\d{8}","\\d{10}",,,"5512345678"],,,[,,"NA","NA"]],JM:[,[,,"[589]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"876(?:5(?:0[12]|1[0-468]|2[35]|63)|6(?:0[1-3579]|1[027-9]|[23]\\d|40|5[06]|6[2-589]|7[05]|8[04]|9[4-9])|7(?:0[2-689]|[1-6]\\d|8[056]|9[45])|9(?:0[1-8]|1[02378]|[2-8]\\d|9[2-468]))\\d{4}","\\d{7}(?:\\d{3})?",,,"8765123456"],[,,"876(?:2[16-9]\\d|[348]\\d{2}|5(?:0[3-9]|27|6[0-24-9]|[3-578]\\d)|7(?:0[07]|7\\d|8[1-47-9]|9[0-36-9])|9(?:[01]9|9[0579]))\\d{4}","\\d{10}",,,"8762101234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"JM",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"876",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],JO:[,[,,"[235-9]\\d{7,8}","\\d{8,9}"],[,,"(?:2(?:6(?:2[0-35-9]|3[0-57-8]|4[24-7]|5[0-24-8]|[6-8][023]|9[0-3])|7(?:0[1-79]|10|2[014-7]|3[0-689]|4[019]|5[0-3578]))|32(?:0[1-69]|1[1-35-7]|2[024-7]|3\\d|4[0-3]|[57][023]|6[03])|53(?:0[0-3]|[13][023]|2[0-59]|49|5[0-35-9]|6[15]|7[45]|8[1-6]|9[0-36-9])|6(?:2[50]0|3(?:00|33)|4(?:0[0125]|1[2-7]|2[0569]|[38][07-9]|4[025689]|6[0-589]|7\\d|9[0-2])|5(?:[01][056]|2[034]|3[0-57-9]|4[17-8]|5[0-69]|6[0-35-9]|7[1-379]|8[0-68]|9[02-39]))|87(?:[02]0|7[08]|90))\\d{4}","\\d{8}",,,"62001234"],[,,"7(?:55|7[025-9]|8[015-9]|9[0-25-9])\\d{6}","\\d{9}",,,"790123456"],[,,"80\\d{6}","\\d{8}",,,"80012345"],[,,"900\\d{5}","\\d{8}",,,"90012345"],[,,"85\\d{6}","\\d{8}",,,"85012345"],[,,"70\\d{7}","\\d{9}",,,"700123456"],[,,"NA","NA"],"JO",962,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[2356]|87"],"(0$1)"],[,"(7)(\\d{4})(\\d{4})","$1 $2 $3",["7[457-9]"],"0$1"],[,"(\\d{3})(\\d{5,6})","$1 $2",["70|8[0158]|9"],"0$1"]],,[,,"74(?:66|77)\\d{5}","\\d{9}",,,"746612345"],,,[,,"NA","NA"],[,,"8(?:10|8\\d)\\d{5}","\\d{8}",,,"88101234"],,,[,,"NA","NA"]],JP:[,[,,"[1-9]\\d{8,9}|00(?:[36]\\d{7,14}|7\\d{5,7}|8\\d{7})","\\d{8,17}"],[,,"(?:1(?:1[235-8]|2[3-6]|3[3-9]|4[2-6]|[58][2-8]|6[2-7]|7[2-9]|9[1-9])|2[2-9]\\d|[36][1-9]\\d|4(?:6[02-8]|[2-578]\\d|9[2-59])|5(?:6[1-9]|7[2-8]|[2-589]\\d)|7(?:3[4-9]|4[02-9]|[25-9]\\d)|8(?:3[2-9]|4[5-9]|5[1-9]|8[03-9]|[2679]\\d)|9(?:[679][1-9]|[2-58]\\d))\\d{6}","\\d{9}",,,"312345678"],[,,"[7-9]0[1-9]\\d{7}","\\d{10}",,,"9012345678"],[,,"120\\d{6}|800\\d{7}|00(?:37\\d{6,13}|66\\d{6,13}|777(?:[01]\\d{2}|5\\d{3}|8\\d{4})|882[1245]\\d{4})","\\d{8,17}",,,"120123456"],[,,"990\\d{6}","\\d{9}",,,"990123456"],[,,"NA","NA"],[,,"60\\d{7}","\\d{9}",,,"601234567"],[,,"50[1-9]\\d{7}","\\d{10}",,,"5012345678"],"JP",81,"010","0",,,"0",,,,[[,"(\\d{3})(\\d{3})(\\d{3})","$1-$2-$3",["(?:12|57|99)0"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["800"],"0$1"],[,"(\\d{4})(\\d{4})","$1-$2",["0077"],"$1"],[,"(\\d{4})(\\d{2})(\\d{3,4})","$1-$2-$3",["0077"],"$1"],[,"(\\d{4})(\\d{2})(\\d{4})","$1-$2-$3",["0088"],"$1"],[,"(\\d{4})(\\d{3})(\\d{3,4})","$1-$2-$3",["00(?:37|66)"],"$1"],[,"(\\d{4})(\\d{4})(\\d{4,5})","$1-$2-$3",["00(?:37|66)"],"$1"],[,"(\\d{4})(\\d{5})(\\d{5,6})","$1-$2-$3",["00(?:37|66)"],"$1"],[,"(\\d{4})(\\d{6})(\\d{6,7})","$1-$2-$3",["00(?:37|66)"],"$1"],[,"(\\d{2})(\\d{4})(\\d{4})","$1-$2-$3",["[2579]0|80[1-9]"],"0$1"],[,"(\\d{4})(\\d)(\\d{4})","$1-$2-$3",["1(?:26|3[79]|4[56]|5[4-68]|6[3-5])|5(?:76|97)|499|746|8(?:3[89]|63|47|51)|9(?:49|80|9[16])","1(?:267|3(?:7[247]|9[278])|4(?:5[67]|66)|5(?:47|58|64|8[67])|6(?:3[245]|48|5[4-68]))|5(?:76|97)9|499[2468]|7468|8(?:3(?:8[78]|96)|636|477|51[24])|9(?:496|802|9(?:1[23]|69))","1(?:267|3(?:7[247]|9[278])|4(?:5[67]|66)|5(?:47|58|64|8[67])|6(?:3[245]|48|5[4-68]))|5(?:769|979[2-69])|499[2468]|7468|8(?:3(?:8[78]|96[2457-9])|636[2-57-9]|477|51[24])|9(?:496|802|9(?:1[23]|69))"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{4})","$1-$2-$3",["1(?:2[3-6]|3[3-9]|4[2-6]|5[2-8]|[68][2-7]|7[2-689]|9[1-578])|2(?:2[03-689]|3[3-58]|4[0-468]|5[04-8]|6[013-8]|7[06-9]|8[02-57-9]|9[13])|4(?:2[28]|3[689]|6[035-7]|7[05689]|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9[4-9])|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9[014-9])|8(?:2[49]|3[3-8]|4[5-8]|5[2-9]|6[35-9]|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9[3-7])","1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9[2-8])|3(?:7[2-6]|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5[4-7]|6[2-9]|8[2-8]|9[236-9])|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3[34]|[4-7]))","1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9(?:[3578]|20|4[04-9]|6[56]))|3(?:7(?:[2-5]|6[0-59])|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5(?:[467]|5[014-9])|6(?:[2-8]|9[02-69])|8[2-8]|9(?:[236-8]|9[23]))|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3(?:3[02-9]|4[0-24689])|4[2-69]|[5-7]))","1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9(?:[3578]|20|4[04-9]|6(?:5[25]|60)))|3(?:7(?:[2-5]|6[0-59])|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5(?:[467]|5[014-9])|6(?:[2-8]|9[02-69])|8[2-8]|9(?:[236-8]|9[23]))|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3(?:3[02-9]|4[0-24689])|4[2-69]|[5-7]))"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["1|2(?:2[37]|5[5-9]|64|78|8[39]|91)|4(?:2[2689]|64|7[347])|5(?:[2-589]|39)|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93)","1|2(?:2[37]|5(?:[57]|[68]0|9[19])|64|78|8[39]|917)|4(?:2(?:[68]|20|9[178])|64|7[347])|5(?:[2-589]|39[67])|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93[34])","1|2(?:2[37]|5(?:[57]|[68]0|9(?:17|99))|64|78|8[39]|917)|4(?:2(?:[68]|20|9[178])|64|7[347])|5(?:[2-589]|39[67])|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93(?:31|4))"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{4})","$1-$2-$3",["2(?:9[14-79]|74|[34]7|[56]9)|82|993"],"0$1"],[,"(\\d)(\\d{4})(\\d{4})","$1-$2-$3",["3|4(?:2[09]|7[01])|6[1-9]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["[2479][1-9]"],"0$1"]],[[,"(\\d{3})(\\d{3})(\\d{3})","$1-$2-$3",["(?:12|57|99)0"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["800"],"0$1"],[,"(\\d{2})(\\d{4})(\\d{4})","$1-$2-$3",["[2579]0|80[1-9]"],"0$1"],[,"(\\d{4})(\\d)(\\d{4})","$1-$2-$3",["1(?:26|3[79]|4[56]|5[4-68]|6[3-5])|5(?:76|97)|499|746|8(?:3[89]|63|47|51)|9(?:49|80|9[16])","1(?:267|3(?:7[247]|9[278])|4(?:5[67]|66)|5(?:47|58|64|8[67])|6(?:3[245]|48|5[4-68]))|5(?:76|97)9|499[2468]|7468|8(?:3(?:8[78]|96)|636|477|51[24])|9(?:496|802|9(?:1[23]|69))","1(?:267|3(?:7[247]|9[278])|4(?:5[67]|66)|5(?:47|58|64|8[67])|6(?:3[245]|48|5[4-68]))|5(?:769|979[2-69])|499[2468]|7468|8(?:3(?:8[78]|96[2457-9])|636[2-57-9]|477|51[24])|9(?:496|802|9(?:1[23]|69))"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{4})","$1-$2-$3",["1(?:2[3-6]|3[3-9]|4[2-6]|5[2-8]|[68][2-7]|7[2-689]|9[1-578])|2(?:2[03-689]|3[3-58]|4[0-468]|5[04-8]|6[013-8]|7[06-9]|8[02-57-9]|9[13])|4(?:2[28]|3[689]|6[035-7]|7[05689]|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9[4-9])|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9[014-9])|8(?:2[49]|3[3-8]|4[5-8]|5[2-9]|6[35-9]|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9[3-7])","1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9[2-8])|3(?:7[2-6]|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5[4-7]|6[2-9]|8[2-8]|9[236-9])|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3[34]|[4-7]))","1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9(?:[3578]|20|4[04-9]|6[56]))|3(?:7(?:[2-5]|6[0-59])|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5(?:[467]|5[014-9])|6(?:[2-8]|9[02-69])|8[2-8]|9(?:[236-8]|9[23]))|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3(?:3[02-9]|4[0-24689])|4[2-69]|[5-7]))","1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9(?:[3578]|20|4[04-9]|6(?:5[25]|60)))|3(?:7(?:[2-5]|6[0-59])|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5(?:[467]|5[014-9])|6(?:[2-8]|9[02-69])|8[2-8]|9(?:[236-8]|9[23]))|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3(?:3[02-9]|4[0-24689])|4[2-69]|[5-7]))"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["1|2(?:2[37]|5[5-9]|64|78|8[39]|91)|4(?:2[2689]|64|7[347])|5(?:[2-589]|39)|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93)","1|2(?:2[37]|5(?:[57]|[68]0|9[19])|64|78|8[39]|917)|4(?:2(?:[68]|20|9[178])|64|7[347])|5(?:[2-589]|39[67])|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93[34])","1|2(?:2[37]|5(?:[57]|[68]0|9(?:17|99))|64|78|8[39]|917)|4(?:2(?:[68]|20|9[178])|64|7[347])|5(?:[2-589]|39[67])|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93(?:31|4))"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{4})","$1-$2-$3",["2(?:9[14-79]|74|[34]7|[56]9)|82|993"],"0$1"],[,"(\\d)(\\d{4})(\\d{4})","$1-$2-$3",["3|4(?:2[09]|7[01])|6[1-9]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["[2479][1-9]"],"0$1"]],[,,"20\\d{8}","\\d{10}",,,"2012345678"],,,[,,"00(?:37\\d{6,13}|66\\d{6,13}|777(?:[01]\\d{2}|5\\d{3}|8\\d{4})|882[1245]\\d{4})","\\d{8,17}",,,"00777012"],[,,"570\\d{6}","\\d{9}",,,"570123456"],1,,[,,"NA","NA"]],
KE:[,[,,"20\\d{6,7}|[4-9]\\d{6,9}","\\d{7,10}"],[,,"20\\d{6,7}|4(?:[0136]\\d{7}|[245]\\d{5,7})|5(?:[08]\\d{7}|[1-79]\\d{5,7})|6(?:[01457-9]\\d{5,7}|[26]\\d{7})","\\d{7,9}",,,"202012345"],[,,"7(?:[0-36]\\d|5[0-6]|[79][0-7]|8[0-25-9])\\d{6}","\\d{9}",,,"712123456"],[,,"800[24-8]\\d{5,6}","\\d{9,10}",,,"800223456"],[,,"900[02-9]\\d{5}","\\d{9}",,,"900223456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"KE",254,"000","0",,,"005|0",,,,[[,"(\\d{2})(\\d{5,7})","$1 $2",["[24-6]"],"0$1"],[,"(\\d{3})(\\d{6})","$1 $2",["7"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["[89]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],KG:[,[,,"[235-8]\\d{8,9}","\\d{5,10}"],[,,"(?:3(?:1(?:[256]\\d|3[1-9]|47)|2(?:22|3[0-479]|6[0-7])|4(?:22|5[6-9]|6\\d)|5(?:22|3[4-7]|59|6\\d)|6(?:22|5[35-7]|6\\d)|7(?:22|3[468]|4[1-9]|59|[67]\\d)|9(?:22|4[1-8]|6\\d))|6(?:09|12|2[2-4])\\d)\\d{5}","\\d{5,10}",,,"312123456"],[,,"(?:20[0-35]|5[124-7]\\d|7[07]\\d)\\d{6}","\\d{9}",,,"700123456"],[,,"800\\d{6,7}","\\d{9,10}",,,"800123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"KG",996,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[25-7]|31[25]"],"0$1"],[,"(\\d{4})(\\d{5})","$1 $2",["3(?:1[36]|[2-9])"],"0$1"],[,"(\\d{3})(\\d{3})(\\d)(\\d{3})","$1 $2 $3 $4",["8"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],KH:[,[,,"[1-9]\\d{7,9}","\\d{6,10}"],[,,"(?:2[3-6]|3[2-6]|4[2-4]|[5-7][2-5])(?:[237-9]|4[56]|5\\d|6\\d?)\\d{5}|23(?:4[234]|8\\d{2})\\d{4}","\\d{6,9}",,,"23756789"],[,,"(?:1(?:[013-79]\\d|[28]\\d{1,2})|2[3-6]48|3(?:[18]\\d{2}|[2-6]48)|4[2-4]48|5[2-5]48|6(?:[016-9]\\d|[2-5]48)|7(?:[07-9]\\d|[16]\\d{2}|[2-5]48)|8(?:[013-79]\\d|8\\d{2})|9(?:6\\d{2}|7\\d{1,2}|[0-589]\\d))\\d{5}","\\d{8,9}",,,"91234567"],[,,"1800(?:1\\d|2[019])\\d{4}","\\d{10}",,,"1800123456"],[,,"1900(?:1\\d|2[09])\\d{4}","\\d{10}",,,"1900123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"KH",855,"00[14-9]","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["1\\d[1-9]|[2-9]"],"0$1"],[,"(1[89]00)(\\d{3})(\\d{3})","$1 $2 $3",["1[89]0"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],KI:[,[,,"[2458]\\d{4}|3\\d{4,7}|7\\d{7}","\\d{5,8}"],[,,"(?:[24]\\d|3[1-9]|50|8[0-5])\\d{3}","\\d{5}",,,"31234"],[,,"7\\d{7}","\\d{8}",,,"72012345"],[,,"NA","NA"],[,,"3001\\d{4}","\\d{5,8}",,,"30010000"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"KI",686,"00",,,,"0",,,,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],KM:[,[,,"[379]\\d{6}","\\d{7}"],[,,"7(?:6[0-37-9]|7[0-57-9])\\d{4}","\\d{7}",,,"7712345"],[,,"3[234]\\d{5}","\\d{7}",,,"3212345"],[,,"NA","NA"],[,,"(?:39[01]|9[01]0)\\d{4}","\\d{7}",,,"9001234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"KM",269,"00",,,,,,,,[[,"(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],KN:[,[,,"[589]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"869(?:2(?:29|36)|302|4(?:6[015-9]|70))\\d{4}","\\d{7}(?:\\d{3})?",,,"8692361234"],[,,"869(?:5(?:5[6-8]|6[5-7])|66\\d|76[02-7])\\d{4}","\\d{10}",,,"8697652917"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"KN",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"869",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],KP:[,[,,"1\\d{9}|[28]\\d{7}","\\d{6,8}|\\d{10}"],[,,"2\\d{7}|85\\d{6}","\\d{6,8}",,,"21234567"],[,,"19[123]\\d{7}","\\d{10}",,,"1921234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"KP",850,"00|99","0",,,"0",,,,[[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["1"],"0$1"],[,"(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["2"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["8"],"0$1"]],,[,,"NA","NA"],,,[,,"2(?:[0-24-9]\\d{2}|3(?:[0-79]\\d|8[02-9]))\\d{4}","\\d{8}",,,"23821234"],[,,"NA","NA"],,,[,,"NA","NA"]],KR:[,[,,"007\\d{9,11}|[1-7]\\d{3,9}|8\\d{8}","\\d{4,14}"],[,,"(?:2|3[1-3]|[46][1-4]|5[1-5])(?:1\\d{2,3}|[1-9]\\d{6,7})","\\d{4,10}",,,"22123456"],[,,"1[0-26-9]\\d{7,8}","\\d{9,10}",,,"1000000000"],[,,"(?:00798\\d{0,2}|80)\\d{7}","\\d{9,14}",,,"801234567"],[,,"60[2-9]\\d{6}","\\d{9}",,,"602345678"],[,,"NA","NA"],[,,"50\\d{8}","\\d{10}",,,"5012345678"],[,,"70\\d{8}","\\d{10}",,,"7012345678"],"KR",82,"00(?:[124-68]|3\\d{2}|7(?:[0-8]\\d|9[0-79]))","0",,,"0(8[1-46-8]|85\\d{2})?",,,,[[,"(\\d{5})(\\d{3,4})(\\d{4})","$1 $2 $3",["00798"],"$1","0$CC-$1"],[,"(\\d{5})(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3 $4",["00798"],"$1","0$CC-$1"],[,"(\\d{2})(\\d{4})(\\d{4})","$1-$2-$3",["1(?:0|1[19]|[69]9|5[458])|[57]0","1(?:0|1[19]|[69]9|5(?:44|59|8))|[57]0"],"0$1","0$CC-$1"],[,"(\\d{2})(\\d{3,4})(\\d{4})","$1-$2-$3",["1(?:[01]|5[1-4]|6[2-8]|[7-9])|[68]0|[3-6][1-9][1-9]","1(?:[01]|5(?:[1-3]|4[56])|6[2-8]|[7-9])|[68]0|[3-6][1-9][1-9]"],"0$1","0$CC-$1"],[,"(\\d{3})(\\d)(\\d{4})","$1-$2-$3",["131","1312"],"0$1","0$CC-$1"],[,"(\\d{3})(\\d{2})(\\d{4})","$1-$2-$3",["131","131[13-9]"],"0$1","0$CC-$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["13[2-9]"],"0$1","0$CC-$1"],[,"(\\d{2})(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3-$4",["30"],"0$1","0$CC-$1"],[,"(\\d)(\\d{3,4})(\\d{4})","$1-$2-$3",["2[1-9]"],"0$1","0$CC-$1"],[,"(\\d)(\\d{3,4})","$1-$2",["21[0-46-9]"],"0$1","0$CC-$1"],[,"(\\d{2})(\\d{3,4})","$1-$2",["[3-6][1-9]1","[3-6][1-9]1(?:[0-46-9])"],"0$1","0$CC-$1"],[,"(\\d{4})(\\d{4})","$1-$2",["1(?:5[46-9]|6[04678]|8[03579])","1(?:5(?:44|66|77|88|99)|6(?:00|44|6[16]|70|88)|8(?:00|33|55|77|99))"],"$1","0$CC-$1"]],[[,"(\\d{2})(\\d{4})(\\d{4})","$1-$2-$3",["1(?:0|1[19]|[69]9|5[458])|[57]0","1(?:0|1[19]|[69]9|5(?:44|59|8))|[57]0"],"0$1","0$CC-$1"],[,"(\\d{2})(\\d{3,4})(\\d{4})","$1-$2-$3",["1(?:[01]|5[1-4]|6[2-8]|[7-9])|[68]0|[3-6][1-9][1-9]","1(?:[01]|5(?:[1-3]|4[56])|6[2-8]|[7-9])|[68]0|[3-6][1-9][1-9]"],"0$1","0$CC-$1"],[,"(\\d{3})(\\d)(\\d{4})","$1-$2-$3",["131","1312"],"0$1","0$CC-$1"],[,"(\\d{3})(\\d{2})(\\d{4})","$1-$2-$3",["131","131[13-9]"],"0$1","0$CC-$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["13[2-9]"],"0$1","0$CC-$1"],[,"(\\d{2})(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3-$4",["30"],"0$1","0$CC-$1"],[,"(\\d)(\\d{3,4})(\\d{4})","$1-$2-$3",["2[1-9]"],"0$1","0$CC-$1"],[,"(\\d)(\\d{3,4})","$1-$2",["21[0-46-9]"],"0$1","0$CC-$1"],[,"(\\d{2})(\\d{3,4})","$1-$2",["[3-6][1-9]1","[3-6][1-9]1(?:[0-46-9])"],"0$1","0$CC-$1"],[,"(\\d{4})(\\d{4})","$1-$2",["1(?:5[46-9]|6[04678]|8[03579])","1(?:5(?:44|66|77|88|99)|6(?:00|44|6[16]|70|88)|8(?:00|33|55|77|99))"],"$1","0$CC-$1"]],[,,"15\\d{7,8}","\\d{9,10}",,,"1523456789"],,,[,,"00798\\d{7,9}","\\d{12,14}",,,"007981234567"],[,,"1(?:5(?:44|66|77|88|99)|6(?:00|44|6[16]|70|88)|8(?:00|33|55|77|99))\\d{4}","\\d{8}",,,"15441234"],,,[,,"NA","NA"]],KW:[,[,,"[12569]\\d{6,7}","\\d{7,8}"],[,,"(?:18\\d|2(?:[23]\\d{2}|4(?:[1-35-9]\\d|44)|5(?:0[034]|[2-46]\\d|5[1-3]|7[1-7])))\\d{4}","\\d{7,8}",,,"22345678"],[,,"(?:5(?:[05]\\d{2}|1[0-7]\\d|2(?:22|5[25])|66\\d)|6(?:0[034679]\\d|222|5[015-9]\\d|6\\d{2}|7[067]\\d|9[0369]\\d)|9(?:0[09]\\d|22\\d|4[01479]\\d|55\\d|6[0679]\\d|[79]\\d{2}|8[057-9]\\d))\\d{4}","\\d{8}",,,"50012345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"KW",965,"00",,,,,,,,[[,"(\\d{4})(\\d{3,4})","$1 $2",["[16]|2(?:[0-35-9]|4[0-35-9])|9[024-9]|52[25]"]],[,"(\\d{3})(\\d{5})","$1 $2",["244|5(?:[015]|66)"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],KY:[,[,,"[3589]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"345(?:2(?:22|44)|444|6(?:23|38|40)|7(?:4[35-79]|6[6-9]|77)|8(?:00|1[45]|25|[48]8)|9(?:14|4[035-9]))\\d{4}","\\d{7}(?:\\d{3})?",,,"3452221234"],[,,"345(?:32[1-9]|5(?:1[67]|2[5-7]|4[6-8]|76)|9(?:1[67]|2[2-9]|3[689]))\\d{4}","\\d{10}",,,"3453231234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002345678"],[,,"900[2-9]\\d{6}|345976\\d{4}","\\d{10}",,,"9002345678"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"KY",1,"011","1",,,"1",,,,,,[,,"345849\\d{4}","\\d{10}",,,"3458491234"],,"345",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],KZ:[,[,,"(?:33\\d|7\\d{2}|80[09])\\d{7}","\\d{10}"],[,,"33622\\d{5}|7(?:1(?:0(?:[23]\\d|4[023]|59|63)|1(?:[23]\\d|4[0-79]|59)|2(?:[23]\\d|59)|3(?:2\\d|3[1-79]|4[0-35-9]|59)|4(?:2\\d|3[013-79]|4[0-8]|5[1-79])|5(?:2\\d|3[1-8]|4[1-7]|59)|6(?:[234]\\d|5[19]|61)|72\\d|8(?:[27]\\d|3[1-46-9]|4[0-5]))|2(?:1(?:[23]\\d|4[46-9]|5[3469])|2(?:2\\d|3[0679]|46|5[12679])|3(?:[234]\\d|5[139])|4(?:2\\d|3[1235-9]|59)|5(?:[23]\\d|4[01246-8]|59|61)|6(?:2\\d|3[1-9]|4[0-4]|59)|7(?:[237]\\d|40|5[279])|8(?:[23]\\d|4[0-3]|59)|9(?:2\\d|3[124578]|59)))\\d{5}","\\d{10}",,,"7123456789"],[,,"7(?:0[012578]|47|6[02-4]|7[15-8]|85)\\d{7}","\\d{10}",,,"7710009998"],[,,"800\\d{7}","\\d{10}",,,"8001234567"],[,,"809\\d{7}","\\d{10}",,,"8091234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"751\\d{7}","\\d{10}",,,"7511234567"],"KZ",7,"810","8",,,"8",,"8~10",,,,[,,"NA","NA"],,,[,,"751\\d{7}","\\d{10}",,,"7511234567"],[,,"NA","NA"],,,[,,"NA","NA"]],LA:[,[,,"[2-8]\\d{7,9}","\\d{6,10}"],[,,"(?:2[13]|3(?:0\\d|[14])|[5-7][14]|41|8[1468])\\d{6}","\\d{6,9}",,,"21212862"],[,,"20(?:2[2389]|5[4-689]|7[6-8]|9[15-9])\\d{6}","\\d{10}",,,"2023123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"LA",856,"00","0",,,"0",,,,[[,"(20)(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3 $4",["20"],"0$1"],[,"([2-8]\\d)(\\d{3})(\\d{3})","$1 $2 $3",["2[13]|3[14]|[4-8]"],"0$1"],[,"(30)(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["30"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],LB:[,[,,"[13-9]\\d{6,7}","\\d{7,8}"],[,,"(?:[14-6]\\d{2}|7(?:[2-57]\\d|62|8[0-7]|9[04-9])|8[02-9]\\d|9\\d{2})\\d{4}","\\d{7}",,,"1123456"],[,,"(?:3\\d|7(?:[01]\\d|6[013-9]|8[89]|9[1-3])|81\\d)\\d{5}","\\d{7,8}",,,"71123456"],[,,"NA","NA"],[,,"9[01]\\d{6}","\\d{8}",,,"90123456"],[,,"80\\d{6}","\\d{8}",,,"80123456"],[,,"NA","NA"],[,,"NA","NA"],"LB",961,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[13-6]|7(?:[2-57]|62|8[0-7]|9[04-9])|8[02-9]|9"],"0$1"],[,"([7-9]\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[89][01]|7(?:[01]|6[013-9]|8[89]|9[1-3])"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],LC:[,[,,"[5789]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"758(?:4(?:30|5[0-9]|6[2-9]|8[0-2])|57[0-2]|638)\\d{4}","\\d{7}(?:\\d{3})?",,,"7584305678"],[,,"758(?:28[4-7]|384|4(?:6[01]|8[4-9])|5(?:1[89]|20|84)|7(?:1[2-9]|2[0-8]))\\d{4}","\\d{10}",,,"7582845678"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"LC",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"758",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],LI:[,[,,"6\\d{8}|[23789]\\d{6}","\\d{7,9}"],[,,"(?:2(?:01|1[27]|3\\d|6[02-578]|96)|3(?:7[0135-7]|8[048]|9[0269]))\\d{4}","\\d{7}",,,"2345678"],[,,"6(?:51[01]|6(?:0[0-6]|2[016-9]|39))\\d{5}|7(?:[37-9]\\d|42|56)\\d{4}","\\d{7,9}",,,"660234567"],[,,"80(?:02[28]|9\\d{2})\\d{2}","\\d{7}",,,"8002222"],[,,"90(?:02[258]|1(?:23|3[14])|66[136])\\d{2}","\\d{7}",,,"9002222"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"LI",423,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3",["[23789]"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["6[56]"]],[,"(69)(7\\d{2})(\\d{4})","$1 $2 $3",["697"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"870(?:28|87)\\d{2}","\\d{7}",,,"8702812"],,,[,,"697(?:42|56|[7-9]\\d)\\d{4}","\\d{9}",,,"697861234"]],LK:[,[,,"[1-9]\\d{8}","\\d{7,9}"],[,,"(?:[189]1|2[13-7]|3[1-8]|4[157]|5[12457]|6[35-7])[2-57]\\d{6}","\\d{7,9}",,,"112345678"],[,,"7[0125-8]\\d{7}","\\d{9}",,,"712345678"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"LK",94,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{1})(\\d{6})","$1 $2 $3",["[1-689]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],LR:[,[,,"2\\d{7,8}|[37-9]\\d{8}|4\\d{6}|5\\d{6,8}","\\d{7,9}"],[,,"2\\d{7}","\\d{8}",,,"21234567"],[,,"(?:330\\d|4[67]|5\\d|77\\d{2}|88\\d{2}|994\\d)\\d{5}|(?:20\\d{3}|33(?:0\\d{2}|2(?:02|5\\d))|555\\d{2}|77[0567]\\d{2}|88[068]\\d{2}|994\\d{2})\\d{4}","\\d{7,9}",,,"770123456"],[,,"NA","NA"],[,,"90[03]\\d{6}","\\d{9}",,,"900123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"332(?:0[02]|5\\d)\\d{4}","\\d{9}",,,"332001234"],"LR",231,"00","0",,,"0",,,,[[,"(2\\d)(\\d{3})(\\d{3})","$1 $2 $3",["2"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[2579]"],"0$1"],[,"([4-6])(\\d{3})(\\d{3})","$1 $2 $3",["[4-6]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[38]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],LS:[,[,,"[2568]\\d{7}","\\d{8}"],[,,"2\\d{7}","\\d{8}",,,"22123456"],[,,"[56]\\d{7}","\\d{8}",,,"50123456"],[,,"800[256]\\d{4}","\\d{8}",,,"80021234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"LS",266,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],LT:[,[,,"[3-9]\\d{7}","\\d{8}"],[,,"(?:3[1478]|4[124-6]|52)\\d{6}","\\d{8}",,,"31234567"],[,,"6\\d{7}","\\d{8}",,,"61234567"],[,,"800\\d{5}","\\d{8}",,,"80012345"],[,,"9(?:0[0239]|10)\\d{5}","\\d{8}",,,"90012345"],[,,"808\\d{5}","\\d{8}",,,"80812345"],[,,"700\\d{5}","\\d{8}",,,"70012345"],[,,"NA","NA"],"LT",370,"00","8",,,"[08]",,,,[[,"([34]\\d)(\\d{6})","$1 $2",["37|4(?:1|5[45]|6[2-4])"],"(8-$1)",,1],[,"([3-6]\\d{2})(\\d{5})","$1 $2",["3[148]|4(?:[24]|6[09])|528|6"],"(8-$1)",,1],[,"([7-9]\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["[7-9]"],"8 $1",,1],[,"(5)(2\\d{2})(\\d{4})","$1 $2 $3",["52[0-79]"],"(8-$1)",,1]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"70[67]\\d{5}","\\d{8}",,,"70712345"],,,[,,"NA","NA"]],LU:[,[,,"[24-9]\\d{3,10}|3(?:[0-46-9]\\d{2,9}|5[013-9]\\d{1,8})","\\d{4,11}"],[,,"(?:2[2-9]\\d{2,9}|(?:[3457]\\d{2}|8(?:0[2-9]|[13-9]\\d)|9(?:0[89]|[2-579]\\d))\\d{1,8})","\\d{4,11}",,,"27123456"],[,,"6[2679][18]\\d{6}","\\d{9}",,,"628123456"],[,,"800\\d{5}","\\d{8}",,,"80012345"],[,,"90[015]\\d{5}","\\d{8}",,,"90012345"],[,,"801\\d{5}","\\d{8}",,,"80112345"],[,,"70\\d{6}","\\d{8}",,,"70123456"],[,,"20(?:1\\d{5}|[2-689]\\d{1,7})","\\d{4,10}",,,"20201234"],"LU",352,"00",,,,"(15(?:0[06]|1[12]|35|4[04]|55|6[26]|77|88|99)\\d)",,,,[[,"(\\d{2})(\\d{3})","$1 $2",["[2-5]|7[1-9]|[89](?:[1-9]|0[2-9])"],,"$CC $1"],[,"(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["[2-5]|7[1-9]|[89](?:[1-9]|0[2-9])"],,"$CC $1"],[,"(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["20"],,"$CC $1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{1,2})","$1 $2 $3 $4",["2(?:[0367]|4[3-8])"],,"$CC $1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["20"],,"$CC $1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{1,2})","$1 $2 $3 $4 $5",["2(?:[0367]|4[3-8])"],,"$CC $1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{1,4})","$1 $2 $3 $4",["2(?:[12589]|4[12])|[3-5]|7[1-9]|8(?:[1-9]|0[2-9])|9(?:[1-9]|0[2-46-9])"],,"$CC $1"],[,"(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["70|80[01]|90[015]"],,"$CC $1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["6"],,"$CC $1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],LV:[,[,,"[2689]\\d{7}","\\d{8}"],[,,"6\\d{7}","\\d{8}",,,"63123456"],[,,"2\\d{7}","\\d{8}",,,"21234567"],[,,"80\\d{6}","\\d{8}",,,"80123456"],[,,"90\\d{6}","\\d{8}",,,"90123456"],[,,"81\\d{6}","\\d{8}",,,"81123456"],[,,"NA","NA"],[,,"NA","NA"],"LV",371,"00",,,,,,,,[[,"([2689]\\d)(\\d{3})(\\d{3})","$1 $2 $3"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],LY:[,[,,"[25679]\\d{8}","\\d{7,9}"],[,,"(?:2[1345]|5[1347]|6[123479]|71)\\d{7}","\\d{7,9}",,,"212345678"],[,,"9[1-6]\\d{7}","\\d{9}",,,"912345678"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"LY",218,"00","0",,,"0",,,,[[,"([25679]\\d)(\\d{7})","$1-$2",,"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MA:[,[,,"[5689]\\d{8}","\\d{9}"],[,,"5(?:2(?:(?:[015-7]\\d|2[02-9]|3[2-57]|4[2-8]|8[235-7])\\d|9(?:0\\d|[89]0))|3(?:(?:[0-4]\\d|[57][2-9]|6[235-8]|9[3-9])\\d|8(?:0\\d|[89]0)))\\d{4}","\\d{9}",,,"520123456"],[,,"6(?:0[0-8]|[12-79]\\d|8[017])\\d{6}","\\d{9}",,,"650123456"],[,,"80\\d{7}","\\d{9}",,,"801234567"],[,,"89\\d{7}","\\d{9}",,,"891234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"MA",212,"00","0",,,"0",,,,[[,"([56]\\d{2})(\\d{6})","$1-$2",["5(?:2[015-7]|3[0-4])|6"],"0$1"],[,"([58]\\d{3})(\\d{5})","$1-$2",["5(?:2[2-489]|3[5-9])|892","5(?:2(?:[2-48]|90)|3(?:[5-79]|80))|892"],"0$1"],[,"(5\\d{4})(\\d{4})","$1-$2",["5(?:29|38)","5(?:29|38)[89]"],"0$1"],[,"(8[09])(\\d{7})","$1-$2",["8(?:0|9[013-9])"],"0$1"]],,[,,"NA","NA"],1,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MC:[,[,,"[4689]\\d{7,8}","\\d{8,9}"],[,,"870\\d{5}|9[2-47-9]\\d{6}","\\d{8}",,,"99123456"],[,,"6\\d{8}|4(?:4\\d|5[1-9])\\d{5}","\\d{8,9}",,,"612345678"],[,,"90\\d{6}","\\d{8}",,,"90123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"MC",377,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["9"],"$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["4"],"0$1"],[,"(6)(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["6"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{2})","$1 $2 $3",["8"],"$1"]],,[,,"NA","NA"],,,[,,"8\\d{7}","\\d{8}"],[,,"NA","NA"],,,[,,"NA","NA"]],MD:[,[,,"[235-9]\\d{7}","\\d{8}"],[,,"(?:2(?:1[0569]|2\\d|3[015-7]|4[1-46-9]|5[0-24689]|6[2-589]|7[1-37]|9[1347-9])|5(?:33|5[257]))\\d{5}","\\d{8}",,,"22212345"],[,,"(?:562\\d|6(?:[089]\\d{2}|[12][01]\\d|7(?:[1-6]\\d|7[0-4]))|7(?:6[07]|7[457-9]|[89]\\d)\\d)\\d{4}","\\d{8}",,,"62112345"],[,,"800\\d{5}","\\d{8}",,,"80012345"],[,,"90[056]\\d{5}","\\d{8}",,,"90012345"],[,,"808\\d{5}","\\d{8}",,,"80812345"],[,,"NA","NA"],[,,"3[08]\\d{6}","\\d{8}",,,"30123456"],"MD",373,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["22|3"],"0$1"],[,"([25-7]\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["2[13-79]|[5-7]"],"0$1"],[,"([89]\\d{2})(\\d{5})","$1 $2",["[89]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"8(?:03|14)\\d{5}","\\d{8}",,,"80312345"],,,[,,"NA","NA"]],ME:[,[,,"[2-9]\\d{7,8}","\\d{6,9}"],[,,"(?:20[2-8]|3(?:0[2-7]|[12][35-7]|3[4-7])|4(?:0[2367]|1[267])|5(?:0[467]|1[267]|2[367]))\\d{5}","\\d{6,8}",,,"30234567"],[,,"6(?:00\\d|3[24]\\d|61\\d|7(?:[0-8]\\d|9(?:[3-9]|[0-2]\\d))|[89]\\d{2})\\d{4}","\\d{8,9}",,,"67622901"],[,,"80\\d{6}","\\d{8}",,,"80080002"],[,,"(?:9(?:4[1568]|5[178]))\\d{5}","\\d{8}",,,"94515151"],[,,"NA","NA"],[,,"NA","NA"],[,,"78[1-9]\\d{5}","\\d{8}",,,"78108780"],"ME",382,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[2-57-9]|6[036-9]","[2-57-9]|6(?:[03689]|7(?:[0-8]|9[3-9]))"],"0$1"],[,"(67)(9)(\\d{3})(\\d{3})","$1 $2 $3 $4",["679","679[0-2]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"77\\d{6}","\\d{8}",,,"77273012"],,,[,,"NA","NA"]],MF:[,[,,"[56]\\d{8}","\\d{9}"],[,,"590(?:[02][79]|13|5[0-268]|[78]7)\\d{4}","\\d{9}",,,"590271234"],[,,"690(?:0[0-7]|[1-9]\\d)\\d{4}","\\d{9}",,,"690301234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"MF",590,"00","0",,,"0",,,,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MG:[,[,,"[23]\\d{8}","\\d{7,9}"],[,,"20(?:2\\d{2}|4[47]\\d|5[3467]\\d|6[279]\\d|7(?:2[29]|[35]\\d)|8[268]\\d|9[245]\\d)\\d{4}","\\d{7,9}",,,"202123456"],[,,"3[2-49]\\d{7}","\\d{9}",,,"321234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"22\\d{7}","\\d{9}",,,"221234567"],"MG",261,"00","0",,,"0",,,,[[,"([23]\\d)(\\d{2})(\\d{3})(\\d{2})","$1 $2 $3 $4",,"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MH:[,[,,"[2-6]\\d{6}","\\d{7}"],[,,"(?:247|528|625)\\d{4}","\\d{7}",,,"2471234"],[,,"(?:235|329|45[56]|545)\\d{4}","\\d{7}",,,"2351234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"635\\d{4}","\\d{7}",,,"6351234"],"MH",692,"011","1",,,"1",,,,[[,"(\\d{3})(\\d{4})","$1-$2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MK:[,[,,"[2-578]\\d{7}","\\d{8}"],[,,"(?:2(?:[23]\\d|5[124578]|6[01])|3(?:1[3-6]|[23][2-6]|4[2356])|4(?:[23][2-6]|4[3-6]|5[256]|6[25-8]|7[24-6]|8[4-6]))\\d{5}","\\d{6,8}",,,"22212345"],[,,"7(?:[0-25-8]\\d{2}|32\\d|421)\\d{4}","\\d{8}",,,"72345678"],[,,"800\\d{5}","\\d{8}",,,"80012345"],[,,"5[02-9]\\d{6}","\\d{8}",,,"50012345"],[,,"8(?:0[1-9]|[1-9]\\d)\\d{5}","\\d{8}",,,"80123456"],[,,"NA","NA"],[,,"NA","NA"],"MK",389,"00","0",,,"0",,,,[[,"(2)(\\d{3})(\\d{4})","$1 $2 $3",["2"],"0$1"],[,"([347]\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[347]"],"0$1"],[,"([58]\\d{2})(\\d)(\\d{2})(\\d{2})","$1 $2 $3 $4",["[58]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],ML:[,[,,"[246-9]\\d{7}","\\d{8}"],[,,"(?:2(?:0(?:2\\d|7[0-8])|1(?:2[5-7]|[3-689]\\d))|44[1239]\\d)\\d{4}","\\d{8}",,,"20212345"],[,,"(?:2(?:079|17\\d)|[679]\\d{3}|8[239]\\d{2})\\d{4}","\\d{8}",,,"65012345"],[,,"80\\d{6}","\\d{8}",,,"80012345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"ML",223,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[246-9]"]],[,"(\\d{4})","$1",["67|74"]]],[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[246-9]"]]],[,,"NA","NA"],,,[,,"80\\d{6}","\\d{8}",,,"80012345"],[,,"NA","NA"],,,[,,"NA","NA"]],MM:[,[,,"[14578]\\d{5,7}|[26]\\d{5,8}|9(?:2\\d{0,2}|[58]|3\\d|4\\d{1,2}|6\\d?|[79]\\d{0,2})\\d{6}","\\d{5,10}"],[,,"1(?:2\\d{1,2}|[3-5]\\d|6\\d?|[89][0-6]\\d)\\d{4}|2(?:2(?:000\\d{3}|\\d{4})|3\\d{4}|4(?:0\\d{5}|\\d{4})|5(?:1\\d{3,6}|[02-9]\\d{3,5})|[6-9]\\d{4})|4(?:2[245-8]|[346][2-6]|5[3-5])\\d{4}|5(?:2(?:20?|[3-8])|3[2-68]|4(?:21?|[4-8])|5[23]|6[2-4]|7[2-8]|8[24-7]|9[2-7])\\d{4}|6(?:0[23]|1[2356]|[24][2-6]|3[24-6]|5[2-4]|6[2-8]|7(?:[2367]|4\\d|5\\d?|8[145]\\d)|8[245]|9[24])\\d{4}|7(?:[04][24-8]|[15][2-7]|22|3[2-4])\\d{4}|8(?:1(?:2\\d{1,2}|[3-689]\\d)|2(?:2\\d|3(?:\\d|20)|[4-8]\\d)|3[24]\\d|4[24-7]\\d|5[245]\\d|6[23]\\d)\\d{3}","\\d{5,9}",,,"1234567"],[,,"17[01]\\d{4}|9(?:2(?:[0-4]|5\\d{2}|6[0-5]\\d)|3[0-36]\\d|4(?:0[0-4]\\d|[1379]\\d|2\\d{2}|4[0-589]\\d|5\\d{2}|88)|5[0-6]|61?\\d|7(?:3\\d|[789]\\d{2})|8\\d|9(?:1\\d|[67]\\d{2}|[089]))\\d{5}","\\d{7,10}",,,"92123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"1333\\d{4}","\\d{8}",,,"13331234"],"MM",95,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["1|2[245]"],"0$1"],[,"(2)(\\d{4})(\\d{4})","$1 $2 $3",["251"],"0$1"],[,"(\\d)(\\d{2})(\\d{3})","$1 $2 $3",["16|2"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["67|81"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{3,4})","$1 $2 $3",["[4-8]"],"0$1"],[,"(9)(\\d{3})(\\d{4,6})","$1 $2 $3",["9(?:2[0-4]|[35-9]|4[137-9])"],"0$1"],[,"(9)([34]\\d{4})(\\d{4})","$1 $2 $3",["9(?:3[0-36]|4[0-57-9])"],"0$1"],[,"(9)(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["92[56]"],"0$1"],[,"(9)(\\d{3})(\\d{3})(\\d{2})","$1 $2 $3 $4",["93"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MN:[,[,,"[12]\\d{7,9}|[57-9]\\d{7}","\\d{6,10}"],[,,"[12](?:1\\d|2(?:[1-3]\\d?|7\\d)|3[2-8]\\d{1,2}|4[2-68]\\d{1,2}|5[1-4689]\\d{1,2})\\d{5}|5[0568]\\d{6}","\\d{6,10}",,,"50123456"],[,,"(?:8(?:[05689]\\d|3[01])|9[013-9]\\d)\\d{5}","\\d{8}",,,"88123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"7[05-8]\\d{6}","\\d{8}",,,"75123456"],"MN",976,"001","0",,,"0",,,,[[,"([12]\\d)(\\d{2})(\\d{4})","$1 $2 $3",["[12]1"],"0$1"],[,"([12]2\\d)(\\d{5,6})","$1 $2",["[12]2[1-3]"],"0$1"],[,"([12]\\d{3})(\\d{5})","$1 $2",["[12](?:27|[3-5])","[12](?:27|[3-5]\\d)2"],"0$1"],[,"(\\d{4})(\\d{4})","$1 $2",["[57-9]"],"$1"],[,"([12]\\d{4})(\\d{4,5})","$1 $2",["[12](?:27|[3-5])","[12](?:27|[3-5]\\d)[4-9]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MO:[,[,,"[268]\\d{7}","\\d{8}"],[,,"(?:28[2-57-9]|8[2-57-9]\\d)\\d{5}","\\d{8}",,,"28212345"],[,,"6(?:[2356]\\d|8[158])\\d{5}","\\d{8}",,,"66123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"MO",853,"00",,,,,,,,[[,"([268]\\d{3})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MP:[,[,,"[5689]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"670(?:2(?:3[3-7]|56|8[5-8])|32[1238]|4(?:33|8[348])|5(?:32|55|88)|6(?:64|70|82)|78[589]|8[3-9]8|989)\\d{4}","\\d{7}(?:\\d{3})?",,,"6702345678"],[,,"670(?:2(?:3[3-7]|56|8[5-8])|32[1238]|4(?:33|8[348])|5(?:32|55|88)|6(?:64|70|82)|78[589]|8[3-9]8|989)\\d{4}","\\d{7}(?:\\d{3})?",,,"6702345678"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"MP",1,"011","1",,,"1",,,1,,,[,,"NA","NA"],,"670",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MQ:[,[,,"[56]\\d{8}","\\d{9}"],[,,"596(?:0[2-5]|[12]0|3[05-9]|4[024-8]|[5-7]\\d|89|9[4-8])\\d{4}","\\d{9}",,,"596301234"],[,,"696(?:[0-479]\\d|5[01]|8[0-689])\\d{4}","\\d{9}",,,"696201234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"MQ",596,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",,"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MR:[,[,,"[2-48]\\d{7}","\\d{8}"],[,,"25[08]\\d{5}|35\\d{6}|45[1-7]\\d{5}","\\d{8}",,,"35123456"],[,,"[234][0-46-9]\\d{6}","\\d{8}",,,"22123456"],[,,"800\\d{5}","\\d{8}",,,"80012345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"MR",222,"00",,,,,,,,[[,"([2-48]\\d)(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MS:[,[,,"[5689]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"664491\\d{4}","\\d{7}(?:\\d{3})?",,,"6644912345"],[,,"66449[2-6]\\d{4}","\\d{10}",,,"6644923456"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"MS",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"664",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MT:[,[,,"[2357-9]\\d{7}","\\d{8}"],[,,"2(?:0(?:1[0-6]|3[1-4]|[69]\\d)|[1-357]\\d{2})\\d{4}","\\d{8}",,,"21001234"],[,,"(?:7(?:210|[79]\\d{2})|9(?:2(?:1[01]|31)|696|8(?:1[1-3]|89|97)|9\\d{2}))\\d{4}","\\d{8}",,,"96961234"],[,,"800[3467]\\d{4}","\\d{8}",,,"80071234"],[,,"5(?:0(?:0(?:37|43)|6\\d{2}|70\\d|9[0168])|[12]\\d0[1-5])\\d{3}","\\d{8}",,,"50037123"],[,,"NA","NA"],[,,"NA","NA"],[,,"3550\\d{4}","\\d{8}",,,"35501234"],"MT",356,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1 $2"]],,[,,"7117\\d{4}","\\d{8}",,,"71171234"],,,[,,"NA","NA"],[,,"501\\d{5}","\\d{8}",,,"50112345"],,,[,,"NA","NA"]],MU:[,[,,"[2-9]\\d{6,7}","\\d{7,8}"],[,,"(?:2(?:[03478]\\d|1[0-7]|6[1-69])|4(?:[013568]\\d|2[4-7])|5(?:44\\d|471)|6\\d{2}|8(?:14|3[129]))\\d{4}","\\d{7,8}",,,"2012345"],[,,"5(?:2[59]\\d|4(?:2[1-389]|4\\d|7[1-9]|9\\d)|7\\d{2}|8(?:[0-2568]\\d|7[15-8])|9[0-8]\\d)\\d{4}","\\d{8}",,,"52512345"],[,,"80[012]\\d{4}","\\d{7}",,,"8001234"],[,,"30\\d{5}","\\d{7}",,,"3012345"],[,,"NA","NA"],[,,"NA","NA"],[,,"3(?:20|9\\d)\\d{4}","\\d{7}",,,"3201234"],"MU",230,"0(?:0|[2-7]0|33)",,,,,,"020",,[[,"([2-46-9]\\d{2})(\\d{4})","$1 $2",["[2-46-9]"]],[,"(5\\d{3})(\\d{4})","$1 $2",["5"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MV:[,[,,"[3467]\\d{6}|9(?:00\\d{7}|\\d{6})","\\d{7,10}"],[,,"(?:3(?:0[01]|3[0-59])|6(?:[567][02468]|8[024689]|90))\\d{4}","\\d{7}",,,"6701234"],[,,"(?:46[46]|7[3-9]\\d|9[15-9]\\d)\\d{4}","\\d{7}",,,"7712345"],[,,"NA","NA"],[,,"900\\d{7}","\\d{10}",,,"9001234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"MV",960,"0(?:0|19)",,,,,,"00",,[[,"(\\d{3})(\\d{4})","$1-$2",["[3467]|9(?:[1-9]|0[1-9])"]],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["900"]]],,[,,"781\\d{4}","\\d{7}",,,"7812345"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MW:[,[,,"(?:1(?:\\d{2})?|[2789]\\d{2})\\d{6}","\\d{7,9}"],[,,"(?:1[2-9]|21\\d{2})\\d{5}","\\d{7,9}",,,"1234567"],[,,"(?:111|77\\d|88\\d|99\\d)\\d{6}","\\d{9}",,,"991234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"MW",265,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["1"],"0$1"],[,"(2\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["2"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[1789]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MX:[,[,,"[1-9]\\d{9,10}","\\d{7,11}"],[,,"(?:33|55|81)\\d{8}|(?:2(?:0[01]|2[2-9]|3[1-35-8]|4[13-9]|7[1-689]|8[1-578]|9[467])|3(?:1[1-79]|[2458][1-9]|7[1-8]|9[1-5])|4(?:1[1-57-9]|[24-6][1-9]|[37][1-8]|8[1-35-9]|9[2-689])|5(?:88|9[1-79])|6(?:1[2-68]|[234][1-9]|5[1-3689]|6[12457-9]|7[1-7]|8[67]|9[4-8])|7(?:[13467][1-9]|2[1-8]|5[13-9]|8[1-69]|9[17])|8(?:2[13-689]|3[1-6]|4[124-6]|6[1246-9]|7[1-378]|9[12479])|9(?:1[346-9]|2[1-4]|3[2-46-8]|5[1348]|[69][1-9]|7[12]|8[1-8]))\\d{7}","\\d{7,10}",,,"2221234567"],[,,"1(?:(?:33|55|81)\\d{8}|(?:2(?:2[2-9]|3[1-35-8]|4[13-9]|7[1-689]|8[1-578]|9[467])|3(?:1[1-79]|[2458][1-9]|7[1-8]|9[1-5])|4(?:1[1-57-9]|[24-6][1-9]|[37][1-8]|8[1-35-9]|9[2-689])|5(?:88|9[1-79])|6(?:1[2-68]|[2-4][1-9]|5[1-3689]|6[12457-9]|7[1-7]|8[67]|9[4-8])|7(?:[13467][1-9]|2[1-8]|5[13-9]|8[1-69]|9[17])|8(?:2[13-689]|3[1-6]|4[124-6]|6[1246-9]|7[1-378]|9[12479])|9(?:1[346-9]|2[1-4]|3[2-46-8]|5[1348]|[69][1-9]|7[12]|8[1-8]))\\d{7})","\\d{11}",,,"12221234567"],[,,"8(?:00|88)\\d{7}","\\d{10}",,,"8001234567"],[,,"900\\d{7}","\\d{10}",,,"9001234567"],[,,"300\\d{7}","\\d{10}",,,"3001234567"],[,,"500\\d{7}","\\d{10}",,,"5001234567"],[,,"NA","NA"],"MX",52,"0[09]","01",,,"0[12]|04[45](\\d{10})","1$1",,,[[,"([358]\\d)(\\d{4})(\\d{4})","$1 $2 $3",["33|55|81"],"01 $1",,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[2467]|3[0-2457-9]|5[089]|8[02-9]|9[0-35-9]"],"01 $1",,1],[,"(1)([358]\\d)(\\d{4})(\\d{4})","044 $2 $3 $4",["1(?:33|55|81)"],"$1",,1],[,"(1)(\\d{3})(\\d{3})(\\d{4})","044 $2 $3 $4",["1(?:[2467]|3[0-2457-9]|5[089]|8[2-9]|9[1-35-9])"],"$1",,1]],[[,"([358]\\d)(\\d{4})(\\d{4})","$1 $2 $3",["33|55|81"],"01 $1",,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[2467]|3[0-2457-9]|5[089]|8[02-9]|9[0-35-9]"],"01 $1",,1],[,"(1)([358]\\d)(\\d{4})(\\d{4})","$1 $2 $3 $4",["1(?:33|55|81)"]],[,"(1)(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3 $4",["1(?:[2467]|3[0-2457-9]|5[089]|8[2-9]|9[1-35-9])"]]],[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],1,,[,,"NA","NA"]],MY:[,[,,"[13-9]\\d{7,9}","\\d{6,10}"],[,,"(?:3[2-9]\\d|[4-9][2-9])\\d{6}","\\d{6,9}",,,"323456789"],[,,"1(?:1[1-5]\\d{2}|[02-4679][2-9]\\d|59\\d{2}|8(?:1[23]|[2-9]\\d))\\d{5}","\\d{9,10}",,,"123456789"],[,,"1[378]00\\d{6}","\\d{10}",,,"1300123456"],[,,"1600\\d{6}","\\d{10}",,,"1600123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"154\\d{7}","\\d{10}",,,"1541234567"],"MY",60,"00","0",,,"0",,,,[[,"([4-79])(\\d{3})(\\d{4})","$1-$2 $3",["[4-79]"],"0$1"],[,"(3)(\\d{4})(\\d{4})","$1-$2 $3",["3"],"0$1"],[,"([18]\\d)(\\d{3})(\\d{3,4})","$1-$2 $3",["1[02-46-9][1-9]|8"],"0$1"],[,"(1)([36-8]00)(\\d{2})(\\d{4})","$1-$2-$3-$4",["1[36-8]0"]],[,"(11)(\\d{4})(\\d{4})","$1-$2 $3",["11"],"0$1"],[,"(15[49])(\\d{3})(\\d{4})","$1-$2 $3",["15"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],MZ:[,[,,"[28]\\d{7,8}","\\d{8,9}"],[,,"2(?:[1346]\\d|5[0-2]|[78][12]|93)\\d{5}","\\d{8}",,,"21123456"],[,,"8[23467]\\d{7}","\\d{9}",,,"821234567"],[,,"800\\d{6}","\\d{9}",,,"800123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"MZ",258,"00",,,,,,,,[[,"([28]\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["2|8[2-7]"]],[,"(80\\d)(\\d{3})(\\d{3})","$1 $2 $3",["80"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],NA:[,[,,"[68]\\d{7,8}","\\d{8,9}"],[,,"6(?:1(?:17|2(?:[0189]\\d|[2-6]|7\\d?)|3(?:[01378]|2\\d)|4(?:[024]|10?|3[15]?)|69|7[014])|2(?:17|5(?:[0-36-8]|4\\d?)|69|70)|3(?:17|2(?:[0237]\\d?|[14-689])|34|6[289]|7[01]|81)|4(?:17|2(?:[012]|7?)|4(?:[06]|1\\d?)|5(?:[01357]|[25]\\d?)|69|7[01])|5(?:17|2(?:[0459]|[23678]\\d?)|69|7[01])|6(?:17|2(?:5|6\\d?)|38|42|69|7[01])|7(?:17|2(?:[569]|[234]\\d?)|3(?:0\\d?|[13])|69|7[01]))\\d{4}","\\d{8,9}",,,"61221234"],[,,"(?:60|8[125])\\d{7}","\\d{9}",,,"811234567"],[,,"NA","NA"],[,,"8701\\d{5}","\\d{9}",,,"870123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"8(?:3\\d{2}|86)\\d{5}","\\d{8,9}",,,"88612345"],"NA",264,"00","0",,,"0",,,,[[,"(8\\d)(\\d{3})(\\d{4})","$1 $2 $3",["8[1235]"],"0$1"],[,"(6\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["6"],"0$1"],[,"(88)(\\d{3})(\\d{3})","$1 $2 $3",["88"],"0$1"],[,"(870)(\\d{3})(\\d{3})","$1 $2 $3",["870"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],NC:[,[,,"[2-57-9]\\d{5}","\\d{6}"],[,,"(?:2[03-9]|3[0-5]|4[1-7]|88)\\d{4}","\\d{6}",,,"201234"],[,,"(?:5[0-4]|[79]\\d|8[0-79])\\d{4}","\\d{6}",,,"751234"],[,,"NA","NA"],[,,"36\\d{4}","\\d{6}",,,"366711"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"NC",687,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})","$1.$2.$3",["[2-46-9]|5[0-4]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],
NE:[,[,,"[0289]\\d{7}","\\d{8}"],[,,"2(?:0(?:20|3[1-7]|4[134]|5[14]|6[14578]|7[1-578])|1(?:4[145]|5[14]|6[14-68]|7[169]|88))\\d{4}","\\d{8}",,,"20201234"],[,,"(?:8[089]|9\\d)\\d{6}","\\d{8}",,,"93123456"],[,,"08\\d{6}","\\d{8}",,,"08123456"],[,,"09\\d{6}","\\d{8}",,,"09123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"NE",227,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[289]|09"]],[,"(08)(\\d{3})(\\d{3})","$1 $2 $3",["08"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],1,,[,,"NA","NA"]],NF:[,[,,"[13]\\d{5}","\\d{5,6}"],[,,"(?:1(?:06|17|28|39)|3[012]\\d)\\d{3}","\\d{5,6}",,,"106609"],[,,"3[58]\\d{4}","\\d{5,6}",,,"381234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"NF",672,"00",,,,,,,,[[,"(\\d{2})(\\d{4})","$1 $2",["1"]],[,"(\\d)(\\d{5})","$1 $2",["3"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],NG:[,[,,"[1-6]\\d{5,8}|9\\d{5,9}|[78]\\d{5,13}","\\d{5,14}"],[,,"[12]\\d{6,7}|9(?:0[3-9]|[1-9]\\d)\\d{5}|(?:3\\d|4[023568]|5[02368]|6[02-469]|7[4-69]|8[2-9])\\d{6}|(?:4[47]|5[14579]|6[1578]|7[0-357])\\d{5,6}|(?:78|41)\\d{5}","\\d{5,9}",,,"12345678"],[,,"(?:1(?:7[34]\\d|8(?:04|[124579]\\d|8[0-3])|95\\d)|287[0-7]|3(?:18[1-8]|88[0-7]|9(?:8[5-9]|6[1-5]))|4(?:28[0-2]|6(?:7[1-9]|8[02-47])|88[0-2])|5(?:2(?:7[7-9]|8\\d)|38[1-79]|48[0-7]|68[4-7])|6(?:2(?:7[7-9]|8\\d)|4(?:3[7-9]|[68][129]|7[04-69]|9[1-8])|58[0-2]|98[7-9])|7(?:38[0-7]|69[1-8]|78[2-4])|8(?:28[3-9]|38[0-2]|4(?:2[12]|3[147-9]|5[346]|7[4-9]|8[014-689]|90)|58[1-8]|78[2-9]|88[5-7])|98[07]\\d)\\d{4}|(?:70[1-689]\\d|8(?:0(?:1[01]|[2-9]\\d)|1(?:[0-8]\\d|9[01]))|90[23589]\\d)\\d{6}","\\d{8,10}",,,"8021234567"],[,,"800\\d{7,11}","\\d{10,14}",,,"80017591759"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"NG",234,"009","0",,,"0",,,,[[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["70|8[01]|90[23589]"],"0$1"],[,"(\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["[12]|9(?:0[3-9]|[1-9])"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2,3})","$1 $2 $3",["[3-6]|7(?:[1-79]|0[1-9])|8[2-9]"],"0$1"],[,"([78]00)(\\d{4})(\\d{4,5})","$1 $2 $3",["[78]00"],"0$1"],[,"([78]00)(\\d{5})(\\d{5,6})","$1 $2 $3",["[78]00"],"0$1"],[,"(78)(\\d{2})(\\d{3})","$1 $2 $3",["78"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"700\\d{7,11}","\\d{10,14}",,,"7001234567"],,,[,,"NA","NA"]],NI:[,[,,"[12578]\\d{7}","\\d{8}"],[,,"2\\d{7}","\\d{8}",,,"21234567"],[,,"5(?:5[0-7]\\d{5}|[78]\\d{6})|7[5-8]\\d{6}|8\\d{7}","\\d{8}",,,"81234567"],[,,"1800\\d{4}","\\d{8}",,,"18001234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"NI",505,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],NL:[,[,,"1\\d{4,8}|[2-7]\\d{8}|[89]\\d{6,9}","\\d{5,10}"],[,,"(?:1[0135-8]|2[02-69]|3[0-68]|4[0135-9]|[57]\\d|8[478])\\d{7}","\\d{9}",,,"101234567"],[,,"6[1-58]\\d{7}","\\d{9}",,,"612345678"],[,,"800\\d{4,7}","\\d{7,10}",,,"8001234"],[,,"90[069]\\d{4,7}","\\d{7,10}",,,"9061234"],[,,"NA","NA"],[,,"NA","NA"],[,,"85\\d{7}","\\d{9}",,,"851234567"],"NL",31,"00","0",,,"0",,,,[[,"([1-578]\\d)(\\d{3})(\\d{4})","$1 $2 $3",["1[035]|2[0346]|3[03568]|4[0356]|5[0358]|7|8[4578]"],"0$1"],[,"([1-5]\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["1[16-8]|2[259]|3[124]|4[17-9]|5[124679]"],"0$1"],[,"(6)(\\d{8})","$1 $2",["6[0-57-9]"],"0$1"],[,"(66)(\\d{7})","$1 $2",["66"],"0$1"],[,"(14)(\\d{3,4})","$1 $2",["14"],"$1"],[,"([89]0\\d)(\\d{4,7})","$1 $2",["80|9"],"0$1"]],,[,,"66\\d{7}","\\d{9}",,,"662345678"],,,[,,"14\\d{3,4}","\\d{5,6}"],[,,"140(?:1(?:[035]|[16-8]\\d)|2(?:[0346]|[259]\\d)|3(?:[03568]|[124]\\d)|4(?:[0356]|[17-9]\\d)|5(?:[0358]|[124679]\\d)|7\\d|8[458])","\\d{5,6}",,,"14020"],,,[,,"NA","NA"]],NO:[,[,,"0\\d{4}|[2-9]\\d{7}","\\d{5}(?:\\d{3})?"],[,,"(?:2[1-4]|3[1-3578]|5[1-35-7]|6[1-4679]|7[0-8])\\d{6}","\\d{8}",,,"21234567"],[,,"(?:4[015-8]|5[89]|87|9\\d)\\d{6}","\\d{8}",,,"40612345"],[,,"80[01]\\d{5}","\\d{8}",,,"80012345"],[,,"82[09]\\d{5}","\\d{8}",,,"82012345"],[,,"810(?:0[0-6]|[2-8]\\d)\\d{3}","\\d{8}",,,"81021234"],[,,"880\\d{5}","\\d{8}",,,"88012345"],[,,"85[0-5]\\d{5}","\\d{8}",,,"85012345"],"NO",47,"00",,,,,,,,[[,"([489]\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["[489]"]],[,"([235-7]\\d)(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[235-7]"]]],,[,,"NA","NA"],1,,[,,"NA","NA"],[,,"0\\d{4}|81(?:0(?:0[7-9]|1\\d)|5\\d{2})\\d{3}","\\d{5}(?:\\d{3})?",,,"01234"],1,,[,,"81[23]\\d{5}","\\d{8}",,,"81212345"]],NP:[,[,,"[1-8]\\d{7}|9(?:[1-69]\\d{6,8}|7[2-6]\\d{5,7}|8\\d{8})","\\d{6,10}"],[,,"(?:1[0-6]\\d|2[13-79][2-6]|3[135-8][2-6]|4[146-9][2-6]|5[135-7][2-6]|6[13-9][2-6]|7[15-9][2-6]|8[1-46-9][2-6]|9[1-79][2-6])\\d{5}","\\d{6,8}",,,"14567890"],[,,"9(?:6[013]|7[245]|8[0-24-6])\\d{7}","\\d{10}",,,"9841234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"NP",977,"00","0",,,"0",,,,[[,"(1)(\\d{7})","$1-$2",["1[2-6]"],"0$1"],[,"(\\d{2})(\\d{6})","$1-$2",["1[01]|[2-8]|9(?:[1-69]|7[15-9])"],"0$1"],[,"(9\\d{2})(\\d{7})","$1-$2",["9(?:6[013]|7[245]|8)"],"$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],NR:[,[,,"[458]\\d{6}","\\d{7}"],[,,"(?:444|888)\\d{4}","\\d{7}",,,"4441234"],[,,"55[5-9]\\d{4}","\\d{7}",,,"5551234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"NR",674,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],NU:[,[,,"[1-5]\\d{3}","\\d{4}"],[,,"[34]\\d{3}","\\d{4}",,,"4002"],[,,"[125]\\d{3}","\\d{4}",,,"1234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"NU",683,"00",,,,,,,,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],NZ:[,[,,"6[235-9]\\d{6}|[2-57-9]\\d{7,10}","\\d{7,11}"],[,,"(?:3[2-79]|[49][2-9]|6[235-9]|7[2-57-9])\\d{6}|24099\\d{3}","\\d{7,8}",,,"32345678"],[,,"2(?:[028]\\d{7,8}|1(?:[03]\\d{5,7}|[12457]\\d{5,6}|[689]\\d{5})|[79]\\d{7})","\\d{8,10}",,,"211234567"],[,,"508\\d{6,7}|80\\d{6,8}","\\d{8,10}",,,"800123456"],[,,"90\\d{7,9}","\\d{9,11}",,,"900123456"],[,,"NA","NA"],[,,"70\\d{7}","\\d{9}",,,"701234567"],[,,"NA","NA"],"NZ",64,"0(?:0|161)","0",,,"0",,"00",,[[,"([34679])(\\d{3})(\\d{4})","$1-$2 $3",["[346]|7[2-57-9]|9[1-9]"],"0$1"],[,"(24099)(\\d{3})","$1 $2",["240","2409","24099"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["21"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,5})","$1 $2 $3",["2(?:1[1-9]|[69]|7[0-35-9])|70|86"],"0$1"],[,"(2\\d)(\\d{3,4})(\\d{4})","$1 $2 $3",["2[028]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["2(?:10|74)|5|[89]0"],"0$1"]],,[,,"[28]6\\d{6,7}","\\d{8,9}",,,"26123456"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],OM:[,[,,"(?:5|[279]\\d)\\d{6}|800\\d{5,6}","\\d{7,9}"],[,,"2[2-6]\\d{6}","\\d{8}",,,"23123456"],[,,"7[19]\\d{6}|9(?:0[1-9]|[1-9]\\d)\\d{5}","\\d{8}",,,"92123456"],[,,"8007\\d{4,5}|500\\d{4}","\\d{7,9}",,,"80071234"],[,,"900\\d{5}","\\d{8}",,,"90012345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"OM",968,"00",,,,,,,,[[,"(2\\d)(\\d{6})","$1 $2",["2"]],[,"([79]\\d{3})(\\d{4})","$1 $2",["[79]"]],[,"([58]00)(\\d{4,6})","$1 $2",["[58]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],PA:[,[,,"[1-9]\\d{6,7}","\\d{7,8}"],[,,"(?:1(?:0[0-8]|1[49]|2[37]|3[0137]|4[147]|5[05]|6[58]|7[0167]|8[58]|9[139])|2(?:[0235679]\\d|1[0-7]|4[04-9]|8[028])|3(?:[09]\\d|1[014-7]|2[0-3]|3[03]|4[03-57]|55|6[068]|7[06-8]|8[06-9])|4(?:3[013-69]|4\\d|7[0-589])|5(?:[01]\\d|2[0-7]|[56]0|79)|7(?:0[09]|2[0-267]|3[06]|[469]0|5[06-9]|7[0-24-79]|8[7-9])|8(?:09|[34]\\d|5[0134]|8[02])|9(?:0[6-9]|1[016-8]|2[036-8]|3[3679]|40|5[0489]|6[06-9]|7[046-9]|8[36-8]|9[1-9]))\\d{4}","\\d{7}",,,"2001234"],[,,"(?:1[16]1|21[89]|8(?:1[01]|7[23]))\\d{4}|6(?:[024-9]\\d|1[0-5]|3[0-24-9])\\d{5}","\\d{7,8}",,,"60012345"],[,,"80[09]\\d{4}","\\d{7}",,,"8001234"],[,,"(?:779|8(?:55|60|7[78])|9(?:00|81))\\d{4}","\\d{7}",,,"8601234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"PA",507,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1-$2",["[1-57-9]"]],[,"(\\d{4})(\\d{4})","$1-$2",["6"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],PE:[,[,,"[14-9]\\d{7,8}","\\d{6,9}"],[,,"(?:1\\d|4[1-4]|5[1-46]|6[1-7]|7[2-46]|8[2-4])\\d{6}","\\d{6,8}",,,"11234567"],[,,"9\\d{8}","\\d{9}",,,"912345678"],[,,"800\\d{5}","\\d{8}",,,"80012345"],[,,"805\\d{5}","\\d{8}",,,"80512345"],[,,"801\\d{5}","\\d{8}",,,"80112345"],[,,"80[24]\\d{5}","\\d{8}",,,"80212345"],[,,"NA","NA"],"PE",51,"19(?:1[124]|77|90)00","0"," Anexo ",,"0",,,,[[,"(1)(\\d{7})","$1 $2",["1"],"(0$1)"],[,"([4-8]\\d)(\\d{6})","$1 $2",["[4-7]|8[2-4]"],"(0$1)"],[,"(\\d{3})(\\d{5})","$1 $2",["80"],"(0$1)"],[,"(9\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["9"],"$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],PF:[,[,,"4\\d{5,7}|8\\d{7}","\\d{6}(?:\\d{2})?"],[,,"4(?:[09][45689]\\d|4)\\d{4}","\\d{6}(?:\\d{2})?",,,"40412345"],[,,"8[79]\\d{6}","\\d{8}",,,"87123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"PF",689,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["4[09]|8[79]"]],[,"(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["44"]]],,[,,"NA","NA"],,,[,,"44\\d{4}","\\d{6}",,,"441234"],[,,"NA","NA"],,,[,,"NA","NA"]],PG:[,[,,"[1-9]\\d{6,7}","\\d{7,8}"],[,,"(?:3[0-2]\\d|4[25]\\d|5[34]\\d|64[1-9]|77(?:[0-24]\\d|30)|85[02-46-9]|9[78]\\d)\\d{4}","\\d{7}",,,"3123456"],[,,"(?:20150|68\\d{2}|7(?:[0-689]\\d|75)\\d{2})\\d{3}","\\d{7,8}",,,"6812345"],[,,"180\\d{4}","\\d{7}",,,"1801234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"275\\d{4}","\\d{7}",,,"2751234"],"PG",675,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[13-689]|27"]],[,"(\\d{4})(\\d{4})","$1 $2",["20|7"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],PH:[,[,,"2\\d{5,7}|[3-9]\\d{7,9}|1800\\d{7,9}","\\d{5,13}"],[,,"2\\d{5}(?:\\d{2})?|(?:3[2-68]|4[2-9]|5[2-6]|6[2-58]|7[24578]|8[2-8])\\d{7}|88(?:22\\d{6}|42\\d{4})","\\d{5,10}",,,"21234567"],[,,"(?:81[37]|9(?:0[5-9]|1[024-9]|2[0-35-9]|3[02-9]|4[236-9]|50|7[34-79]|89|9[4-9]))\\d{7}","\\d{10}",,,"9051234567"],[,,"1800\\d{7,9}","\\d{11,13}",,,"180012345678"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"PH",63,"00","0",,,"0",,,,[[,"(2)(\\d{3})(\\d{4})","$1 $2 $3",["2"],"(0$1)"],[,"(2)(\\d{5})","$1 $2",["2"],"(0$1)"],[,"(\\d{4})(\\d{4,6})","$1 $2",["3(?:23|39|46)|4(?:2[3-6]|[35]9|4[26]|76)|5(?:22|44)|642|8(?:62|8[245])","3(?:230|397|461)|4(?:2(?:35|[46]4|51)|396|4(?:22|63)|59[347]|76[15])|5(?:221|446)|642[23]|8(?:622|8(?:[24]2|5[13]))"],"(0$1)"],[,"(\\d{5})(\\d{4})","$1 $2",["346|4(?:27|9[35])|883","3469|4(?:279|9(?:30|56))|8834"],"(0$1)"],[,"([3-8]\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[3-8]"],"(0$1)"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["81|9"],"0$1"],[,"(1800)(\\d{3})(\\d{4})","$1 $2 $3",["1"]],[,"(1800)(\\d{1,2})(\\d{3})(\\d{4})","$1 $2 $3 $4",["1"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],PK:[,[,,"1\\d{8}|[2-8]\\d{5,11}|9(?:[013-9]\\d{4,9}|2\\d(?:111\\d{6}|\\d{3,7}))","\\d{6,12}"],[,,"(?:21|42)[2-9]\\d{7}|(?:2[25]|4[0146-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)[2-9]\\d{6}|(?:2(?:3[2358]|4[2-4]|9[2-8])|45[3479]|54[2-467]|60[468]|72[236]|8(?:2[2-689]|3[23578]|4[3478]|5[2356])|9(?:1|2[2-8]|3[27-9]|4[2-6]|6[3569]|9[25-8]))[2-9]\\d{5,6}|58[126]\\d{7}","\\d{6,10}",,,"2123456789"],[,,"3(?:0\\d|1[0-6]|2[0-5]|3[0-7]|4[0-8]|55|64)\\d{7}","\\d{10}",,,"3012345678"],[,,"800\\d{5}","\\d{8}",,,"80012345"],[,,"900\\d{5}","\\d{8}",,,"90012345"],[,,"NA","NA"],[,,"122\\d{6}","\\d{9}",,,"122044444"],[,,"NA","NA"],"PK",92,"00","0",,,"0",,,,[[,"(\\d{2})(111)(\\d{3})(\\d{3})","$1 $2 $3 $4",["(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)1","(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)11","(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)111"],"(0$1)"],[,"(\\d{3})(111)(\\d{3})(\\d{3})","$1 $2 $3 $4",["2[349]|45|54|60|72|8[2-5]|9[2-9]","(?:2[349]|45|54|60|72|8[2-5]|9[2-9])\\d1","(?:2[349]|45|54|60|72|8[2-5]|9[2-9])\\d11","(?:2[349]|45|54|60|72|8[2-5]|9[2-9])\\d111"],"(0$1)"],[,"(\\d{2})(\\d{7,8})","$1 $2",["(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)[2-9]"],"(0$1)"],[,"(\\d{3})(\\d{6,7})","$1 $2",["2[349]|45|54|60|72|8[2-5]|9[2-9]","(?:2[349]|45|54|60|72|8[2-5]|9[2-9])\\d[2-9]"],"(0$1)"],[,"(3\\d{2})(\\d{7})","$1 $2",["3"],"0$1"],[,"([15]\\d{3})(\\d{5,6})","$1 $2",["58[12]|1"],"(0$1)"],[,"(586\\d{2})(\\d{5})","$1 $2",["586"],"(0$1)"],[,"([89]00)(\\d{3})(\\d{2})","$1 $2 $3",["[89]00"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"(?:2(?:[125]|3[2358]|4[2-4]|9[2-8])|4(?:[0-246-9]|5[3479])|5(?:[1-35-7]|4[2-467])|6(?:[1-8]|0[468])|7(?:[14]|2[236])|8(?:[16]|2[2-689]|3[23578]|4[3478]|5[2356])|9(?:1|22|3[27-9]|4[2-6]|6[3569]|9[2-7]))111\\d{6}","\\d{11,12}",,,"21111825888"],,,[,,"NA","NA"]],PL:[,[,,"[12]\\d{6,8}|[3-57-9]\\d{8}|6\\d{5,8}","\\d{6,9}"],[,,"(?:1[2-8]|2[2-69]|3[2-4]|4[1-468]|5[24-689]|6[1-3578]|7[14-7]|8[1-79]|9[145])\\d{7}|[12]2\\d{5}","\\d{6,9}",,,"123456789"],[,,"(?:5[0137]|6[069]|7[2389]|88)\\d{7}","\\d{9}",,,"512345678"],[,,"800\\d{6}","\\d{9}",,,"800123456"],[,,"70\\d{7}","\\d{9}",,,"701234567"],[,,"801\\d{6}","\\d{9}",,,"801234567"],[,,"NA","NA"],[,,"39\\d{7}","\\d{9}",,,"391234567"],"PL",48,"00",,,,,,,,[[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[14]|2[0-57-9]|3[2-4]|5[24-689]|6[1-3578]|7[14-7]|8[1-79]|9[145]"]],[,"(\\d{2})(\\d{1})(\\d{4})","$1 $2 $3",["[12]2"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["26|39|5[0137]|6[0469]|7[02389]|8[08]"]],[,"(\\d{3})(\\d{2})(\\d{2,3})","$1 $2 $3",["64"]],[,"(\\d{3})(\\d{3})","$1 $2",["64"]]],,[,,"64\\d{4,7}","\\d{6,9}",,,"641234567"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],PM:[,[,,"[45]\\d{5}","\\d{6}"],[,,"41\\d{4}","\\d{6}",,,"411234"],[,,"55\\d{4}","\\d{6}",,,"551234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"PM",508,"00","0",,,"0",,,,[[,"([45]\\d)(\\d{2})(\\d{2})","$1 $2 $3",,"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],PR:[,[,,"[5789]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"(?:787|939)[2-9]\\d{6}","\\d{7}(?:\\d{3})?",,,"7872345678"],[,,"(?:787|939)[2-9]\\d{6}","\\d{7}(?:\\d{3})?",,,"7872345678"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002345678"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002345678"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"PR",1,"011","1",,,"1",,,1,,,[,,"NA","NA"],,"787|939",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],PS:[,[,,"[24589]\\d{7,8}|1(?:[78]\\d{8}|[49]\\d{2,3})","\\d{4,10}"],[,,"(?:22[234789]|42[45]|82[01458]|92[369])\\d{5}","\\d{7,8}",,,"22234567"],[,,"5[69]\\d{7}","\\d{9}",,,"599123456"],[,,"1800\\d{6}","\\d{10}",,,"1800123456"],[,,"1(?:4|9\\d)\\d{2}","\\d{4,5}",,,"19123"],[,,"1700\\d{6}","\\d{10}",,,"1700123456"],[,,"NA","NA"],[,,"NA","NA"],"PS",970,"00","0",,,"0",,,,[[,"([2489])(2\\d{2})(\\d{4})","$1 $2 $3",["[2489]"],"0$1"],[,"(5[69]\\d)(\\d{3})(\\d{3})","$1 $2 $3",["5"],"0$1"],[,"(1[78]00)(\\d{3})(\\d{3})","$1 $2 $3",["1[78]"],"$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],PT:[,[,,"[2-46-9]\\d{8}","\\d{9}"],[,,"2(?:[12]\\d|[35][1-689]|4[1-59]|6[1-35689]|7[1-9]|8[1-69]|9[1256])\\d{6}","\\d{9}",,,"212345678"],[,,"9(?:[1236]\\d{2}|480)\\d{5}","\\d{9}",,,"912345678"],[,,"80[02]\\d{6}","\\d{9}",,,"800123456"],[,,"6(?:0[178]|4[68])\\d{6}|76(?:0[1-57]|1[2-47]|2[237])\\d{5}","\\d{9}",,,"760123456"],[,,"80(?:8\\d|9[1579])\\d{5}","\\d{9}",,,"808123456"],[,,"884[0-4689]\\d{5}","\\d{9}",,,"884123456"],[,,"30\\d{7}","\\d{9}",,,"301234567"],"PT",351,"00",,,,,,,,[[,"(2\\d)(\\d{3})(\\d{4})","$1 $2 $3",["2[12]"]],[,"([2-46-9]\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["2[3-9]|[346-9]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"7(?:0(?:7\\d|8[17]))\\d{5}","\\d{9}",,,"707123456"],,,[,,"600\\d{6}","\\d{9}",,,"600110000"]],PW:[,[,,"[2-8]\\d{6}","\\d{7}"],[,,"2552255|(?:277|345|488|5(?:35|44|87)|6(?:22|54|79)|7(?:33|47)|8(?:24|55|76))\\d{4}","\\d{7}",,,"2771234"],[,,"(?:6[234689]0|77[45789])\\d{4}","\\d{7}",,,"6201234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"PW",680,"01[12]",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],PY:[,[,,"5[0-5]\\d{4,7}|[2-46-9]\\d{5,8}","\\d{5,9}"],[,,"(?:[26]1|3[289]|4[124678]|7[123]|8[1236])\\d{5,7}|(?:2(?:2[4568]|7[15]|9[1-5])|3(?:18|3[167]|4[2357]|51)|4(?:18|2[45]|3[12]|5[13]|64|71|9[1-47])|5(?:[1-4]\\d|5[0234])|6(?:3[1-3]|44|7[1-4678])|7(?:17|4[0-4]|6[1-578]|75|8[0-8])|858)\\d{5,6}","\\d{5,9}",,,"212345678"],[,,"9(?:6[12]|[78][1-6]|9[1-5])\\d{6}","\\d{9}",,,"961456789"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"8700[0-4]\\d{4}","\\d{9}",,,"870012345"],"PY",595,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{5})","$1 $2",["(?:[26]1|3[289]|4[124678]|7[123]|8[1236])"],"(0$1)"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["(?:[26]1|3[289]|4[124678]|7[123]|8[1236])"],"(0$1)"],[,"(\\d{3})(\\d{3,6})","$1 $2",["[2-9]0"],"0$1"],[,"(\\d{3})(\\d{6})","$1 $2",["9[1-9]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["8700"]],[,"(\\d{3})(\\d{4,5})","$1 $2",["[2-8][1-9]"],"(0$1)"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[2-8][1-9]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"[2-9]0\\d{4,7}","\\d{6,9}",,,"201234567"],,,[,,"NA","NA"]],QA:[,[,,"[2-8]\\d{6,7}","\\d{7,8}"],[,,"4[04]\\d{6}","\\d{7,8}",,,"44123456"],[,,"[3567]\\d{7}","\\d{7,8}",,,"33123456"],[,,"800\\d{4}","\\d{7,8}",,,"8001234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"QA",974,"00",,,,,,,,[[,"([28]\\d{2})(\\d{4})","$1 $2",["[28]"]],[,"([3-7]\\d{3})(\\d{4})","$1 $2",["[3-7]"]]],,[,,"2(?:[12]\\d|61)\\d{4}","\\d{7}",,,"2123456"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],RE:[,[,,"[268]\\d{8}","\\d{9}"],[,,"262\\d{6}","\\d{9}",,,"262161234"],[,,"6(?:9[23]|47)\\d{6}","\\d{9}",,,"692123456"],[,,"80\\d{7}","\\d{9}",,,"801234567"],[,,"89[1-37-9]\\d{6}","\\d{9}",,,"891123456"],[,,"8(?:1[019]|2[0156]|84|90)\\d{6}","\\d{9}",,,"810123456"],[,,"NA","NA"],[,,"NA","NA"],"RE",262,"00","0",,,"0",,,,[[,"([268]\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",,"0$1"]],,[,,"NA","NA"],1,"262|6[49]|8",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],RO:[,[,,"2\\d{5,8}|[37-9]\\d{8}","\\d{6,9}"],[,,"2(?:1(?:\\d{7}|9\\d{3})|[3-6](?:\\d{7}|\\d9\\d{2}))|3[13-6]\\d{7}","\\d{6,9}",,,"211234567"],[,,"7(?:[0-8]\\d{2}|99\\d)\\d{5}","\\d{9}",,,"712345678"],[,,"800\\d{6}","\\d{9}",,,"800123456"],[,,"90[036]\\d{6}","\\d{9}",,,"900123456"],[,,"801\\d{6}","\\d{9}",,,"801123456"],[,,"802\\d{6}","\\d{9}",,,"802123456"],[,,"NA","NA"],"RO",40,"00","0"," int ",,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[23]1"],"0$1"],[,"(21)(\\d{4})","$1 $2",["21"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[23][3-7]|[7-9]"],"0$1"],[,"(2\\d{2})(\\d{3})","$1 $2",["2[3-6]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"37\\d{7}","\\d{9}",,,"372123456"],,,[,,"NA","NA"]],RS:[,[,,"[126-9]\\d{4,11}|3(?:[0-79]\\d{3,10}|8[2-9]\\d{2,9})","\\d{5,12}"],[,,"(?:1(?:[02-9][2-9]|1[1-9])\\d|2(?:[0-24-7][2-9]\\d|[389](?:0[2-9]|[2-9]\\d))|3(?:[0-8][2-9]\\d|9(?:[2-9]\\d|0[2-9])))\\d{3,8}","\\d{5,12}",,,"10234567"],[,,"6(?:[0-689]|7\\d)\\d{6,7}","\\d{8,10}",,,"601234567"],[,,"800\\d{3,9}","\\d{6,12}",,,"80012345"],[,,"(?:90[0169]|78\\d)\\d{3,7}","\\d{6,12}",,,"90012345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"RS",381,"00","0",,,"0",,,,[[,"([23]\\d{2})(\\d{4,9})","$1 $2",["(?:2[389]|39)0"],"0$1"],[,"([1-3]\\d)(\\d{5,10})","$1 $2",["1|2(?:[0-24-7]|[389][1-9])|3(?:[0-8]|9[1-9])"],"0$1"],[,"(6\\d)(\\d{6,8})","$1 $2",["6"],"0$1"],[,"([89]\\d{2})(\\d{3,9})","$1 $2",["[89]"],"0$1"],[,"(7[26])(\\d{4,9})","$1 $2",["7[26]"],"0$1"],[,"(7[08]\\d)(\\d{4,9})","$1 $2",["7[08]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"7[06]\\d{4,10}","\\d{6,12}",,,"700123456"],,,[,,"NA","NA"]],RU:[,[,,"[3489]\\d{9}","\\d{10}"],[,,"(?:3(?:0[12]|4[1-35-79]|5[1-3]|65|8[1-58]|9[0145])|4(?:01|1[1356]|2[13467]|7[1-5]|8[1-7]|9[1-689])|8(?:1[1-8]|2[01]|3[13-6]|4[0-8]|5[15]|6[1-35-79]|7[1-37-9]))\\d{7}","\\d{10}",,,"3011234567"],[,,"9\\d{9}","\\d{10}",,,"9123456789"],[,,"80[04]\\d{7}","\\d{10}",,,"8001234567"],[,,"80[39]\\d{7}","\\d{10}",,,"8091234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"RU",7,"810","8",,,"8",,"8~10",,[[,"(\\d{3})(\\d{2})(\\d{2})","$1-$2-$3",["[1-79]"],"$1",,1],[,"([3489]\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2-$3-$4",["[34689]"],"8 ($1)",,1],[,"(7\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"8 ($1)",,1]],[[,"([3489]\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2-$3-$4",["[34689]"],"8 ($1)",,1],[,"(7\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"8 ($1)",,1]],[,,"NA","NA"],1,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],RW:[,[,,"[027-9]\\d{7,8}","\\d{8,9}"],[,,"2[258]\\d{7}|06\\d{6}","\\d{8,9}",,,"250123456"],[,,"7[238]\\d{7}","\\d{9}",,,"720123456"],[,,"800\\d{6}","\\d{9}",,,"800123456"],[,,"900\\d{6}","\\d{9}",,,"900123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"RW",250,"00","0",,,"0",,,,[[,"(2\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["2"],"$1"],[,"([7-9]\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[7-9]"],"0$1"],[,"(0\\d)(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["0"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],1,,[,,"NA","NA"]],SA:[,[,,"1\\d{7,8}|(?:[2-467]|92)\\d{7}|5\\d{8}|8\\d{9}","\\d{7,10}"],[,,"11\\d{7}|1?(?:2[24-8]|3[35-8]|4[3-68]|6[2-5]|7[235-7])\\d{6}","\\d{7,9}",,,"112345678"],[,,"(?:5(?:[013-689]\\d|7[0-26-8])|811\\d)\\d{6}","\\d{9,10}",,,"512345678"],[,,"800\\d{7}","\\d{10}",,,"8001234567"],[,,"NA","NA"],[,,"92[05]\\d{6}","\\d{9}",,,"920012345"],[,,"NA","NA"],[,,"NA","NA"],"SA",966,"00","0",,,"0",,,,[[,"([1-467])(\\d{3})(\\d{4})","$1 $2 $3",["[1-467]"],"0$1"],[,"(1\\d)(\\d{3})(\\d{4})","$1 $2 $3",["1[1-467]"],"0$1"],[,"(5\\d)(\\d{3})(\\d{4})","$1 $2 $3",["5"],"0$1"],[,"(92\\d{2})(\\d{5})","$1 $2",["92"],"$1"],[,"(800)(\\d{3})(\\d{4})","$1 $2 $3",["80"],"$1"],[,"(811)(\\d{3})(\\d{3,4})","$1 $2 $3",["81"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],SB:[,[,,"[1-9]\\d{4,6}","\\d{5,7}"],[,,"(?:1[4-79]|[23]\\d|4[0-2]|5[03]|6[0-37])\\d{3}","\\d{5}",,,"40123"],[,,"48\\d{3}|7(?:30|[46-8]\\d|5[025-9]|9[0-5])\\d{4}|8[4-9]\\d{5}|9(?:1[2-9]|2[013-9]|3[0-2]|[46]\\d|5[0-46-9]|7[0-689]|8[0-79]|9[0-8])\\d{4}","\\d{5,7}",,,"7421234"],[,,"1[38]\\d{3}","\\d{5}",,,"18123"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"5[12]\\d{3}","\\d{5}",,,"51123"],"SB",677,"0[01]",,,,,,,,[[,"(\\d{2})(\\d{5})","$1 $2",["[7-9]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],SC:[,[,,"[2468]\\d{5,6}","\\d{6,7}"],[,,"4[2-46]\\d{5}","\\d{7}",,,"4217123"],[,,"2[5-8]\\d{5}","\\d{7}",,,"2510123"],[,,"8000\\d{2}","\\d{6}",,,"800000"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"64\\d{5}","\\d{7}",,,"6412345"],"SC",248,"0[0-2]",,,,,,"00",,[[,"(\\d{3})(\\d{3})","$1 $2",["8"]],[,"(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[246]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],SD:[,[,,"[19]\\d{8}","\\d{9}"],[,,"1(?:[125]\\d|8[3567])\\d{6}","\\d{9}",,,"121231234"],[,,"9[0-3569]\\d{7}","\\d{9}",,,"911231234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"SD",249,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",,"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],SE:[,[,,"[1-35-9]\\d{5,11}|4\\d{6,8}","\\d{6,12}"],[,,"1(?:0[1-8]\\d{6}|[136]\\d{5,7}|(?:2[0-35]|4[0-4]|5[0-25-9]|7[13-6]|[89]\\d)\\d{5,6})|2(?:[136]\\d{5,7}|(?:2[0-7]|4[0136-8]|5[0138]|7[018]|8[01]|9[0-57])\\d{5,6})|3(?:[356]\\d{5,7}|(?:0[0-4]|1\\d|2[0-25]|4[056]|7[0-2]|8[0-3]|9[023])\\d{5,6})|4(?:[0246]\\d{5,7}|(?:1[013-8]|3[0135]|5[14-79]|7[0-246-9]|8[0156]|9[0-689])\\d{5,6})|5(?:0[0-6]|[15][0-5]|2[0-68]|3[0-4]|4\\d|6[03-5]|7[013]|8[0-79]|9[01])\\d{5,6}|6(?:[03]\\d{5,7}|(?:1[1-3]|2[0-4]|4[02-57]|5[0-37]|6[0-3]|7[0-2]|8[0247]|9[0-356])\\d{5,6})|8\\d{6,8}|9(?:0[1-9]\\d{4,6}|(?:1[0-68]|2\\d|3[02-5]|4[0-3]|5[0-4]|[68][01]|7[0135-8])\\d{5,6})","\\d{7,9}",,,"8123456"],[,,"7[02369]\\d{7}","\\d{9}",,,"701234567"],[,,"20\\d{4,7}","\\d{6,9}",,,"20123456"],[,,"649\\d{6}|9(?:00|39|44)[1-8]\\d{3,6}","\\d{7,10}",,,"9001234567"],[,,"77(?:0\\d{3}(?:\\d{3})?|[1-7]\\d{6})","\\d{6}(?:\\d{3})?",,,"771234567"],[,,"75[1-8]\\d{6}","\\d{9}",,,"751234567"],[,,"NA","NA"],"SE",46,"00","0",,,"0",,,,[[,"(8)(\\d{2,3})(\\d{2,3})(\\d{2})","$1-$2 $3 $4",["8"],"0$1"],[,"([1-69]\\d)(\\d{2,3})(\\d{2})(\\d{2})","$1-$2 $3 $4",["1[013689]|2[0136]|3[1356]|4[0246]|54|6[03]|90"],"0$1"],[,"([1-469]\\d)(\\d{3})(\\d{2})","$1-$2 $3",["1[136]|2[136]|3[356]|4[0246]|6[03]|90"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1-$2 $3 $4",["1[2457]|2(?:[247-9]|5[0138])|3[0247-9]|4[1357-9]|5[0-35-9]|6(?:[124-689]|7[0-2])|9(?:[125-8]|3[0-5]|4[0-3])"],"0$1"],[,"(\\d{3})(\\d{2,3})(\\d{2})","$1-$2 $3",["1[2457]|2(?:[247-9]|5[0138])|3[0247-9]|4[1357-9]|5[0-35-9]|6(?:[124-689]|7[0-2])|9(?:[125-8]|3[0-5]|4[0-3])"],"0$1"],[,"(7\\d)(\\d{3})(\\d{2})(\\d{2})","$1-$2 $3 $4",["7"],"0$1"],[,"(77)(\\d{2})(\\d{2})","$1-$2$3",["7"],"0$1"],[,"(20)(\\d{2,3})(\\d{2})","$1-$2 $3",["20"],"0$1"],[,"(9[034]\\d)(\\d{2})(\\d{2})(\\d{3})","$1-$2 $3 $4",["9[034]"],"0$1"],[,"(9[034]\\d)(\\d{4})","$1-$2",["9[034]"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1-$2 $3 $4 $5",["25[245]|67[3-6]"],"0$1"]],[[,"(8)(\\d{2,3})(\\d{2,3})(\\d{2})","$1 $2 $3 $4",["8"]],[,"([1-69]\\d)(\\d{2,3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1[013689]|2[0136]|3[1356]|4[0246]|54|6[03]|90"]],[,"([1-469]\\d)(\\d{3})(\\d{2})","$1 $2 $3",["1[136]|2[136]|3[356]|4[0246]|6[03]|90"]],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1[2457]|2(?:[247-9]|5[0138])|3[0247-9]|4[1357-9]|5[0-35-9]|6(?:[124-689]|7[0-2])|9(?:[125-8]|3[0-5]|4[0-3])"]],[,"(\\d{3})(\\d{2,3})(\\d{2})","$1 $2 $3",["1[2457]|2(?:[247-9]|5[0138])|3[0247-9]|4[1357-9]|5[0-35-9]|6(?:[124-689]|7[0-2])|9(?:[125-8]|3[0-5]|4[0-3])"]],[,"(7\\d)(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["7"]],[,"(77)(\\d{2})(\\d{2})","$1 $2 $3",["7"]],[,"(20)(\\d{2,3})(\\d{2})","$1 $2 $3",["20"]],[,"(9[034]\\d)(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["9[034]"]],[,"(9[034]\\d)(\\d{4})","$1 $2",["9[034]"]],[,"(\\d{3})(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["25[245]|67[3-6]"]]],[,,"74[02-9]\\d{6}","\\d{9}",,,"740123456"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"(?:25[245]|67[3-6])\\d{9}","\\d{12}",,,"254123456789"]],SG:[,[,,"[36]\\d{7}|[17-9]\\d{7,10}","\\d{8,11}"],[,,"6[1-9]\\d{6}","\\d{8}",,,"61234567"],[,,"(?:8[1-8]|9[0-8])\\d{6}","\\d{8}",,,"81234567"],[,,"1?800\\d{7}","\\d{10,11}",,,"18001234567"],[,,"1900\\d{7}","\\d{11}",,,"19001234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"3[12]\\d{6}","\\d{8}",,,"31234567"],"SG",65,"0[0-3]\\d",,,,,,,,[[,"([3689]\\d{3})(\\d{4})","$1 $2",["[369]|8[1-9]"]],[,"(1[89]00)(\\d{3})(\\d{4})","$1 $2 $3",["1[89]"]],[,"(7000)(\\d{4})(\\d{3})","$1 $2 $3",["70"]],[,"(800)(\\d{3})(\\d{4})","$1 $2 $3",["80"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"7000\\d{7}","\\d{11}",,,"70001234567"],,,[,,"NA","NA"]],SH:[,[,,"[256]\\d{4}","\\d{4,5}"],[,,"2(?:[0-57-9]\\d|6[4-9])\\d{2}","\\d{5}",,,"22158"],[,,"[56]\\d{4}","\\d{5}"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"262\\d{2}","\\d{5}"],"SH",290,"00",,,,,,,,,,[,,"NA","NA"],1,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],SI:[,[,,"[1-7]\\d{6,7}|[89]\\d{4,7}","\\d{5,8}"],[,,"(?:1\\d|[25][2-8]|3[24-8]|4[24-8]|7[3-8])\\d{6}","\\d{7,8}",,,"11234567"],[,,"(?:[37][01]|4[0139]|51|6[48])\\d{6}","\\d{8}",,,"31234567"],[,,"80\\d{4,6}","\\d{6,8}",,,"80123456"],[,,"90\\d{4,6}|89[1-3]\\d{2,5}","\\d{5,8}",,,"90123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"(?:59|8[1-3])\\d{6}","\\d{8}",,,"59012345"],"SI",386,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[12]|3[24-8]|4[24-8]|5[2-8]|7[3-8]"],"(0$1)"],[,"([3-7]\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[37][01]|4[0139]|51|6"],"0$1"],[,"([89][09])(\\d{3,6})","$1 $2",["[89][09]"],"0$1"],[,"([58]\\d{2})(\\d{5})","$1 $2",["59|8[1-3]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],SJ:[,[,,"0\\d{4}|[4789]\\d{7}","\\d{5}(?:\\d{3})?"],[,,"79\\d{6}","\\d{8}",,,"79123456"],[,,"(?:4[015-8]|5[89]|9\\d)\\d{6}","\\d{8}",,,"41234567"],[,,"80[01]\\d{5}","\\d{8}",,,"80012345"],[,,"82[09]\\d{5}","\\d{8}",,,"82012345"],[,,"810(?:0[0-6]|[2-8]\\d)\\d{3}","\\d{8}",,,"81021234"],[,,"880\\d{5}","\\d{8}",,,"88012345"],[,,"85[0-5]\\d{5}","\\d{8}",,,"85012345"],"SJ",47,"00",,,,,,,,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"0\\d{4}|81(?:0(?:0[7-9]|1\\d)|5\\d{2})\\d{3}","\\d{5}(?:\\d{3})?",,,"01234"],1,,[,,"81[23]\\d{5}","\\d{8}",,,"81212345"]],SK:[,[,,"(?:[2-68]\\d{5,8}|9\\d{6,8})","\\d{6,9}"],[,,"2(?:16\\d{3,4}|\\d{8})|[3-5](?:[1-8]16\\d{2,3}|\\d{8})","\\d{6,9}",,,"212345678"],[,,"9(?:0(?:[1-8]\\d|9[1-9])|(?:1[0-24-9]|4[0489]|50)\\d)\\d{5}","\\d{9}",,,"912123456"],[,,"800\\d{6}","\\d{9}",,,"800123456"],[,,"9(?:[78]\\d{7}|00\\d{6})","\\d{9}",,,"900123456"],[,,"8[5-9]\\d{7}","\\d{9}",,,"850123456"],[,,"NA","NA"],[,,"6(?:02|5[0-4]|9[0-6])\\d{6}","\\d{9}",,,"690123456"],"SK",421,"00","0",,,"0",,,,[[,"(2)(16)(\\d{3,4})","$1 $2 $3",["216"],"0$1"],[,"([3-5]\\d)(16)(\\d{2,3})","$1 $2 $3",["[3-5]"],"0$1"],[,"(2)(\\d{3})(\\d{3})(\\d{2})","$1/$2 $3 $4",["2"],"0$1"],[,"([3-5]\\d)(\\d{3})(\\d{2})(\\d{2})","$1/$2 $3 $4",["[3-5]"],"0$1"],[,"([689]\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[689]"],"0$1"],[,"(9090)(\\d{3})","$1 $2",["9090"],"0$1"]],,[,,"9090\\d{3}","\\d{7}",,,"9090123"],,,[,,"(?:602|8(?:00|[5-9]\\d)|9(?:00|[78]\\d))\\d{6}|9090\\d{3}","\\d{7,9}",,,"800123456"],[,,"96\\d{7}","\\d{9}",,,"961234567"],,,[,,"NA","NA"]],SL:[,[,,"[2-9]\\d{7}","\\d{6,8}"],[,,"[235]2[2-4][2-9]\\d{4}","\\d{6,8}",,,"22221234"],[,,"(?:2[15]|3[03-5]|4[04]|5[05]|66|7[6-9]|88|99)\\d{6}","\\d{6,8}",,,"25123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"SL",232,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{6})","$1 $2",,"(0$1)"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],SM:[,[,,"[05-7]\\d{7,9}","\\d{6,10}"],[,,"0549(?:8[0157-9]|9\\d)\\d{4}","\\d{6,10}",,,"0549886377"],[,,"6[16]\\d{6}","\\d{8}",,,"66661212"],[,,"NA","NA"],[,,"7[178]\\d{6}","\\d{8}",,,"71123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"5[158]\\d{6}","\\d{8}",,,"58001110"],"SM",378,"00",,,,"(?:0549)?([89]\\d{5})","0549$1",,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-7]"]],[,"(0549)(\\d{6})","$1 $2",["0"]],[,"(\\d{6})","0549 $1",["[89]"]]],[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-7]"]],[,"(0549)(\\d{6})","($1) $2",["0"]],[,"(\\d{6})","(0549) $1",["[89]"]]],[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],1,,[,,"NA","NA"]],SN:[,[,,"[3789]\\d{8}","\\d{9}"],[,,"3(?:0(?:1[0-2]|80)|282|3(?:8[1-9]|9[3-9])|611|90[1-5])\\d{5}","\\d{9}",,,"301012345"],[,,"7(?:[067]\\d|21|8[0-46]|90)\\d{6}","\\d{9}",,,"701234567"],[,,"800\\d{6}","\\d{9}",,,"800123456"],[,,"88[4689]\\d{6}","\\d{9}",,,"884123456"],[,,"81[02468]\\d{6}","\\d{9}",,,"810123456"],[,,"NA","NA"],[,,"3392\\d{5}|93330\\d{4}","\\d{9}",,,"933301234"],"SN",221,"00",,,,,,,,[[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[379]"]],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],SO:[,[,,"[1-79]\\d{6,8}","\\d{7,9}"],[,,"(?:1\\d|2[0-79]|3[0-46-8]|4[0-7]|59)\\d{5}","\\d{7}",,,"4012345"],[,,"(?:15\\d|2(?:4\\d|8)|6[1-35-9]?\\d{2}|7(?:[1-8]\\d|99?\\d)|9(?:0[67]|[2-9])\\d)\\d{5}","\\d{7,9}",,,"71123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"SO",252,"00","0",,,"0",,,,[[,"(\\d)(\\d{6})","$1 $2",["2[0-79]|[13-5]"]],[,"(\\d)(\\d{7})","$1 $2",["24|[67]"]],[,"(\\d{2})(\\d{5,7})","$1 $2",["15|28|6[1-35-9]|799|9[2-9]"]],[,"(90\\d)(\\d{3})(\\d{3})","$1 $2 $3",["90"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],SR:[,[,,"[2-8]\\d{5,6}","\\d{6,7}"],[,,"(?:2[1-3]|3[0-7]|4\\d|5[2-58]|68\\d)\\d{4}","\\d{6,7}",,,"211234"],[,,"(?:7[124-7]|8[1-9])\\d{5}","\\d{7}",,,"7412345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"5(?:6\\d{4}|90[0-4]\\d{3})","\\d{6,7}",,,"561234"],"SR",597,"00",,,,,,,,[[,"(\\d{3})(\\d{3})","$1-$2",["[2-4]|5[2-58]"]],[,"(\\d{2})(\\d{2})(\\d{2})","$1-$2-$3",["56"]],[,"(\\d{3})(\\d{4})","$1-$2",["59|[6-8]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],SS:[,[,,"[19]\\d{8}","\\d{9}"],[,,"18\\d{7}","\\d{9}",,,"181234567"],[,,"(?:12|9[1257])\\d{7}","\\d{9}",,,"977123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"SS",211,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",,"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],ST:[,[,,"[29]\\d{6}","\\d{7}"],[,,"22\\d{5}","\\d{7}",,,"2221234"],[,,"9(?:0(?:0[5-9]|[1-9]\\d)|[89]\\d{2})\\d{3}","\\d{7}",,,"9812345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"ST",239,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],
SV:[,[,,"[267]\\d{7}|[89]\\d{6}(?:\\d{4})?","\\d{7,8}|\\d{11}"],[,,"2[1-6]\\d{6}","\\d{8}",,,"21234567"],[,,"[67]\\d{7}","\\d{8}",,,"70123456"],[,,"800\\d{4}(?:\\d{4})?","\\d{7}(?:\\d{4})?",,,"8001234"],[,,"900\\d{4}(?:\\d{4})?","\\d{7}(?:\\d{4})?",,,"9001234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"SV",503,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1 $2",["[267]"]],[,"(\\d{3})(\\d{4})","$1 $2",["[89]"]],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["[89]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],SX:[,[,,"[5789]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"7215(?:4[2-8]|8[239]|9[056])\\d{4}","\\d{7}(?:\\d{3})?",,,"7215425678"],[,,"7215(?:1[02]|2\\d|5[034679]|8[014-8])\\d{4}","\\d{10}",,,"7215205678"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002123456"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002123456"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"SX",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"721",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],SY:[,[,,"[1-59]\\d{7,8}","\\d{6,9}"],[,,"(?:1(?:1\\d?|4\\d|[2356])|2(?:1\\d?|[235])|3(?:[13]\\d|4)|4[13]|5[1-3])\\d{6}","\\d{6,9}",,,"112345678"],[,,"9(?:22|[35][0-8]|4\\d|6[024-9]|88|9[0-489])\\d{6}","\\d{9}",,,"944567890"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"SY",963,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[1-5]"],"0$1",,1],[,"(9\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["9"],"0$1",,1]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],SZ:[,[,,"[027]\\d{7}","\\d{8}"],[,,"2[2-5]\\d{6}","\\d{8}",,,"22171234"],[,,"7[6-8]\\d{6}","\\d{8}",,,"76123456"],[,,"0800\\d{4}","\\d{8}",,,"08001234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"SZ",268,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1 $2",["[027]"]]],,[,,"NA","NA"],,,[,,"0800\\d{4}","\\d{8}",,,"08001234"],[,,"NA","NA"],1,,[,,"NA","NA"]],TA:[,[,,"8\\d{3}","\\d{4}"],[,,"8\\d{3}","\\d{4}",,,"8999"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"TA",290,"00",,,,,,,,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],TC:[,[,,"[5689]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"649(?:712|9(?:4\\d|50))\\d{4}","\\d{7}(?:\\d{3})?",,,"6497121234"],[,,"649(?:2(?:3[129]|4[1-7])|3(?:3[1-389]|4[1-8])|4[34][1-3])\\d{4}","\\d{10}",,,"6492311234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002345678"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002345678"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"64971[01]\\d{4}","\\d{10}",,,"6497101234"],"TC",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"649",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],TD:[,[,,"[2679]\\d{7}","\\d{8}"],[,,"22(?:[3789]0|5[0-5]|6[89])\\d{4}","\\d{8}",,,"22501234"],[,,"(?:6[023568]\\d|77\\d|9\\d{2})\\d{5}","\\d{8}",,,"63012345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"TD",235,"00|16",,,,,,"00",,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],TG:[,[,,"[29]\\d{7}","\\d{8}"],[,,"2(?:2[2-7]|3[23]|44|55|66|77)\\d{5}","\\d{8}",,,"22212345"],[,,"9[0-389]\\d{6}","\\d{8}",,,"90112345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"TG",228,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],TH:[,[,,"[2-9]\\d{7,8}|1\\d{3}(?:\\d{5,6})?","\\d{4}|\\d{8,10}"],[,,"(?:2\\d|3[2-9]|4[2-5]|5[2-6]|7[3-7])\\d{6}","\\d{8}",,,"21234567"],[,,"(?:14|6[1-4]|[89]\\d)\\d{7}","\\d{9}",,,"812345678"],[,,"1800\\d{6}","\\d{10}",,,"1800123456"],[,,"1900\\d{6}","\\d{10}",,,"1900123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"6[08]\\d{7}","\\d{9}",,,"601234567"],"TH",66,"00","0",,,"0",,,,[[,"(2)(\\d{3})(\\d{4})","$1 $2 $3",["2"],"0$1"],[,"([13-9]\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["14|[3-9]"],"0$1"],[,"(1[89]00)(\\d{3})(\\d{3})","$1 $2 $3",["1"],"$1"]],,[,,"NA","NA"],,,[,,"1\\d{3}","\\d{4}",,,"1100"],[,,"1\\d{3}","\\d{4}",,,"1100"],,,[,,"NA","NA"]],TJ:[,[,,"[3-589]\\d{8}","\\d{3,9}"],[,,"(?:3(?:1[3-5]|2[245]|3[12]|4[24-7]|5[25]|72)|4(?:46|74|87))\\d{6}","\\d{3,9}",,,"372123456"],[,,"(?:41[18]|5(?:0[125]|5\\d)|88\\d|9[0-35-9]\\d)\\d{6}","\\d{9}",,,"917123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"TJ",992,"810","8",,,"8",,"8~10",,[[,"([349]\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["[34]7|91[78]"],"(8) $1",,1],[,"([4589]\\d)(\\d{3})(\\d{4})","$1 $2 $3",["4[148]|[58]|9(?:1[59]|[0235-9])"],"(8) $1",,1],[,"(331700)(\\d)(\\d{2})","$1 $2 $3",["331","3317","33170","331700"],"(8) $1",,1],[,"(\\d{4})(\\d)(\\d{4})","$1 $2 $3",["3[1-5]","3(?:[1245]|3(?:[02-9]|1[0-589]))"],"(8) $1",,1]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],TK:[,[,,"[2-47]\\d{3,6}","\\d{4,7}"],[,,"(?:2[2-4]|[34]\\d)\\d{2,5}","\\d{4,7}",,,"3101"],[,,"7[2-4]\\d{2,5}","\\d{4,7}",,,"7290"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"TK",690,"00",,,,,,,,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],TL:[,[,,"[2-489]\\d{6}|7\\d{6,7}","\\d{7,8}"],[,,"(?:2[1-5]|3[1-9]|4[1-4])\\d{5}","\\d{7}",,,"2112345"],[,,"7[3-8]\\d{6}","\\d{8}",,,"77212345"],[,,"80\\d{5}","\\d{7}",,,"8012345"],[,,"90\\d{5}","\\d{7}",,,"9012345"],[,,"NA","NA"],[,,"70\\d{5}","\\d{7}",,,"7012345"],[,,"NA","NA"],"TL",670,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[2-489]"]],[,"(\\d{4})(\\d{4})","$1 $2",["7"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],TM:[,[,,"[1-6]\\d{7}","\\d{8}"],[,,"(?:1(?:2\\d|3[1-9])|2(?:22|4[0-35-8])|3(?:22|4[03-9])|4(?:22|3[128]|4\\d|6[15])|5(?:22|5[7-9]|6[014-689]))\\d{5}","\\d{8}",,,"12345678"],[,,"6[1-9]\\d{6}","\\d{8}",,,"66123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"TM",993,"810","8",,,"8",,"8~10",,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2-$3-$4",["12"],"(8 $1)"],[,"(\\d{2})(\\d{6})","$1 $2",["6"],"8 $1"],[,"(\\d{3})(\\d)(\\d{2})(\\d{2})","$1 $2-$3-$4",["13|[2-5]"],"(8 $1)"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],TN:[,[,,"[2-57-9]\\d{7}","\\d{8}"],[,,"3(?:[012]\\d|6[0-4]|91)\\d{5}|7\\d{7}|81200\\d{3}","\\d{8}",,,"71234567"],[,,"(?:[259]\\d|4[0-6])\\d{6}","\\d{8}",,,"20123456"],[,,"8010\\d{4}","\\d{8}",,,"80101234"],[,,"88\\d{6}","\\d{8}",,,"88123456"],[,,"8[12]10\\d{4}","\\d{8}",,,"81101234"],[,,"NA","NA"],[,,"NA","NA"],"TN",216,"00",,,,,,,,[[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],TO:[,[,,"[02-8]\\d{4,6}","\\d{5,7}"],[,,"(?:2\\d|3[1-8]|4[1-4]|[56]0|7[0149]|8[05])\\d{3}","\\d{5}",,,"20123"],[,,"(?:7[578]|8[47-9])\\d{5}","\\d{7}",,,"7715123"],[,,"0800\\d{3}","\\d{7}",,,"0800222"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"TO",676,"00",,,,,,,,[[,"(\\d{2})(\\d{3})","$1-$2",["[1-6]|7[0-4]|8[05]"]],[,"(\\d{3})(\\d{4})","$1 $2",["7[5-9]|8[47-9]"]],[,"(\\d{4})(\\d{3})","$1 $2",["0"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],1,,[,,"NA","NA"]],TR:[,[,,"[2-589]\\d{9}|444\\d{4}","\\d{7,10}"],[,,"(?:2(?:[13][26]|[28][2468]|[45][268]|[67][246])|3(?:[13][28]|[24-6][2468]|[78][02468]|92)|4(?:[16][246]|[23578][2468]|4[26]))\\d{7}","\\d{10}",,,"2123456789"],[,,"5(?:0[1-7]|22|[34]\\d|5[1-59]|9[246])\\d{7}","\\d{10}",,,"5012345678"],[,,"800\\d{7}","\\d{10}",,,"8001234567"],[,,"900\\d{7}","\\d{10}",,,"9001234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"TR",90,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[23]|4(?:[0-35-9]|4[0-35-9])"],"(0$1)",,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[589]"],"0$1",,1],[,"(444)(\\d{1})(\\d{3})","$1 $2 $3",["444"]]],,[,,"512\\d{7}","\\d{10}",,,"5123456789"],,,[,,"444\\d{4}","\\d{7}",,,"4441444"],[,,"444\\d{4}|850\\d{7}","\\d{7,10}",,,"4441444"],,,[,,"NA","NA"]],TT:[,[,,"[589]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"868(?:2(?:01|2[1-6]|3[1-5])|6(?:0[79]|1[02-8]|2[1-9]|[3-69]\\d|7[0-79])|82[124])\\d{4}","\\d{7}(?:\\d{3})?",,,"8682211234"],[,,"868(?:2(?:[789]\\d)|3(?:0[1-9]|1[02-9]|[2-9]\\d)|4[6-9]\\d|6(?:20|78|8\\d)|7(?:0[1-9]|1[02-9]|[2-9]\\d))\\d{4}","\\d{10}",,,"8682911234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002345678"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002345678"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"TT",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"868",[,,"NA","NA"],[,,"NA","NA"],,,[,,"868619\\d{4}","\\d{10}"]],TV:[,[,,"[279]\\d{4,6}","\\d{5,7}"],[,,"2[02-9]\\d{3}","\\d{5}",,,"20123"],[,,"(?:70\\d|90)\\d{4}","\\d{6,7}",,,"901234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"TV",688,"00",,,,,,,,,,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],TW:[,[,,"[2-689]\\d{7,8}|7\\d{7,9}","\\d{8,10}"],[,,"[2-8]\\d{7,8}","\\d{8,9}",,,"21234567"],[,,"9\\d{8}","\\d{9}",,,"912345678"],[,,"800\\d{6}","\\d{9}",,,"800123456"],[,,"900\\d{6}","\\d{9}",,,"900123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"70\\d{8}","\\d{10}",,,"7012345678"],"TW",886,"0(?:0[25679]|19)","0","#",,"0",,,,[[,"([2-8])(\\d{3,4})(\\d{4})","$1 $2 $3",["[2-6]|[78][1-9]"],"0$1"],[,"([89]\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["80|9"],"0$1"],[,"(70)(\\d{4})(\\d{4})","$1 $2 $3",["70"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],TZ:[,[,,"\\d{9}","\\d{7,9}"],[,,"2[2-8]\\d{7}","\\d{7,9}",,,"222345678"],[,,"(?:6[125-9]|7[1-9])\\d{7}","\\d{9}",,,"621234567"],[,,"80[08]\\d{6}","\\d{9}",,,"800123456"],[,,"90\\d{7}","\\d{9}",,,"900123456"],[,,"8(?:40|6[01])\\d{6}","\\d{9}",,,"840123456"],[,,"NA","NA"],[,,"41\\d{7}","\\d{9}",,,"412345678"],"TZ",255,"00[056]","0",,,"0",,,,[[,"([24]\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[24]"],"0$1"],[,"([67]\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[67]"],"0$1"],[,"([89]\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["[89]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],UA:[,[,,"[3-9]\\d{8}","\\d{5,9}"],[,,"(?:3[1-8]|4[13-8]|5[1-7]|6[12459])\\d{7}","\\d{5,9}",,,"311234567"],[,,"(?:39|50|6[36-8]|73|9[1-9])\\d{7}","\\d{9}",,,"391234567"],[,,"800\\d{6}","\\d{9}",,,"800123456"],[,,"900\\d{6}","\\d{9}",,,"900123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"89\\d{7}","\\d{9}",,,"891234567"],"UA",380,"00","0",,,"0",,"0~0",,[[,"([3-9]\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[38]9|4(?:[45][0-5]|87)|5(?:0|6[37]|7[37])|6[36-8]|73|9[1-9]","[38]9|4(?:[45][0-5]|87)|5(?:0|6(?:3[14-7]|7)|7[37])|6[36-8]|73|9[1-9]"],"0$1"],[,"([3-689]\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["3[1-8]2|4[13678]2|5(?:[12457]2|6[24])|6(?:[49]2|[12][29]|5[24])|8[0-8]|90","3(?:[1-46-8]2[013-9]|52)|4(?:[1378]2|62[013-9])|5(?:[12457]2|6[24])|6(?:[49]2|[12][29]|5[24])|8[0-8]|90"],"0$1"],[,"([3-6]\\d{3})(\\d{5})","$1 $2",["3(?:5[013-9]|[1-46-8])|4(?:[137][013-9]|6|[45][6-9]|8[4-6])|5(?:[1245][013-9]|6[0135-9]|3|7[4-6])|6(?:[49][013-9]|5[0135-9]|[12][13-8])","3(?:5[013-9]|[1-46-8](?:22|[013-9]))|4(?:[137][013-9]|6(?:[013-9]|22)|[45][6-9]|8[4-6])|5(?:[1245][013-9]|6(?:3[02389]|[015689])|3|7[4-6])|6(?:[49][013-9]|5[0135-9]|[12][13-8])"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],UG:[,[,,"\\d{9}","\\d{5,9}"],[,,"20(?:[0147]\\d{2}|2(?:40|[5-9]\\d)|3[23]\\d|5[0-4]\\d|6[03]\\d|8[0-2]\\d)\\d{4}|[34]\\d{8}","\\d{5,9}",,,"312345678"],[,,"2030\\d{5}|7(?:0[0-7]|[15789]\\d|2[03]|30|[46][0-4])\\d{6}","\\d{9}",,,"712345678"],[,,"800[123]\\d{5}","\\d{9}",,,"800123456"],[,,"90[123]\\d{6}","\\d{9}",,,"901123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"UG",256,"00[057]","0",,,"0",,,,[[,"(\\d{3})(\\d{6})","$1 $2",["[7-9]|20(?:[013-8]|2[5-9])|4(?:6[45]|[7-9])"],"0$1"],[,"(\\d{2})(\\d{7})","$1 $2",["3|4(?:[1-5]|6[0-36-9])"],"0$1"],[,"(2024)(\\d{5})","$1 $2",["2024"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],US:[,[,,"[2-9]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"(?:2(?:0[1-35-9]|1[02-9]|2[04589]|3[149]|4[08]|5[1-46]|6[0279]|7[026]|8[13])|3(?:0[1-57-9]|1[02-9]|2[0135]|3[014679]|4[67]|5[12]|6[014]|8[056])|4(?:0[124-9]|1[02-579]|2[3-5]|3[0245]|4[0235]|58|69|7[0589]|8[04])|5(?:0[1-57-9]|1[0235-8]|20|3[0149]|4[01]|5[19]|6[1-37]|7[013-5]|8[056])|6(?:0[1-35-9]|1[024-9]|2[03689]|3[016]|4[16]|5[017]|6[0-279]|78|8[12])|7(?:0[1-46-8]|1[02-9]|2[0457]|3[1247]|4[037]|5[47]|6[02359]|7[02-59]|8[156])|8(?:0[1-68]|1[02-8]|28|3[0-25]|4[3578]|5[046-9]|6[02-5]|7[028])|9(?:0[1346-9]|1[02-9]|2[0589]|3[014678]|4[0179]|5[12469]|7[0-3589]|8[0459]))[2-9]\\d{6}","\\d{7}(?:\\d{3})?",,,"2015550123"],[,,"(?:2(?:0[1-35-9]|1[02-9]|2[04589]|3[149]|4[08]|5[1-46]|6[0279]|7[026]|8[13])|3(?:0[1-57-9]|1[02-9]|2[0135]|3[014679]|4[67]|5[12]|6[014]|8[056])|4(?:0[124-9]|1[02-579]|2[3-5]|3[0245]|4[0235]|58|69|7[0589]|8[04])|5(?:0[1-57-9]|1[0235-8]|20|3[0149]|4[01]|5[19]|6[1-37]|7[013-5]|8[056])|6(?:0[1-35-9]|1[024-9]|2[03689]|3[016]|4[16]|5[017]|6[0-279]|78|8[12])|7(?:0[1-46-8]|1[02-9]|2[0457]|3[1247]|4[037]|5[47]|6[02359]|7[02-59]|8[156])|8(?:0[1-68]|1[02-8]|28|3[0-25]|4[3578]|5[046-9]|6[02-5]|7[028])|9(?:0[1346-9]|1[02-9]|2[0589]|3[014678]|4[0179]|5[12469]|7[0-3589]|8[0459]))[2-9]\\d{6}","\\d{7}(?:\\d{3})?",,,"2015550123"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002345678"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002345678"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"US",1,"011","1",,,"1",,,1,[[,"(\\d{3})(\\d{4})","$1-$2",,,,1],[,"(\\d{3})(\\d{3})(\\d{4})","($1) $2-$3",,,,1]],[[,"(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3"]],[,,"NA","NA"],1,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],UY:[,[,,"[2489]\\d{6,7}","\\d{7,8}"],[,,"2\\d{7}|4[2-7]\\d{6}","\\d{7,8}",,,"21231234"],[,,"9[1-9]\\d{6}","\\d{8}",,,"94231234"],[,,"80[05]\\d{4}","\\d{7}",,,"8001234"],[,,"90[0-8]\\d{4}","\\d{7}",,,"9001234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"UY",598,"0(?:1[3-9]\\d|0)","0"," int. ",,"0",,"00",,[[,"(\\d{4})(\\d{4})","$1 $2",["[24]"]],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["9[1-9]"],"0$1"],[,"(\\d{3})(\\d{4})","$1 $2",["[89]0"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],UZ:[,[,,"[679]\\d{8}","\\d{7,9}"],[,,"(?:6(?:1(?:22|3[124]|4[1-4]|5[123578]|64)|2(?:22|3[0-57-9]|41)|5(?:22|3[3-7]|5[024-8])|6\\d{2}|7(?:[23]\\d|7[69])|9(?:22|4[1-8]|6[135]))|7(?:0(?:5[4-9]|6[0146]|7[12456]|9[135-8])|1[12]\\d|2(?:22|3[1345789]|4[123579]|5[14])|3(?:2\\d|3[1578]|4[1-35-7]|5[1-57]|61)|4(?:2\\d|3[1-579]|7[1-79])|5(?:22|5[1-9]|6[1457])|6(?:22|3[12457]|4[13-8])|9(?:22|5[1-9])))\\d{5}","\\d{7,9}",,,"662345678"],[,,"6(?:1(?:2(?:98|2[01])|35[0-4]|50\\d|61[23]|7(?:[01][017]|4\\d|55|9[5-9]))|2(?:11\\d|2(?:[12]1|9[01379])|5(?:[126]\\d|3[0-4])|7\\d{2})|5(?:19[01]|2(?:27|9[26])|30\\d|59\\d|7\\d{2})|6(?:2(?:1[5-9]|2[0367]|38|41|52|60)|3[79]\\d|4(?:56|83)|7(?:[07]\\d|1[017]|3[07]|4[047]|5[057]|67|8[0178]|9[79])|9[0-3]\\d)|7(?:2(?:24|3[237]|4[5-9]|7[15-8])|5(?:7[12]|8[0589])|7(?:0\\d|[39][07])|9(?:0\\d|7[079]))|9(?:2(?:1[1267]|5\\d|3[01]|7[0-4])|5[67]\\d|6(?:2[0-26]|8\\d)|7\\d{2}))\\d{4}|7(?:0\\d{3}|1(?:13[01]|6(?:0[47]|1[67]|66)|71[3-69]|98\\d)|2(?:2(?:2[79]|95)|3(?:2[5-9]|6[0-6])|57\\d|7(?:0\\d|1[17]|2[27]|3[37]|44|5[057]|66|88))|3(?:2(?:1[0-6]|21|3[469]|7[159])|33\\d|5(?:0[0-4]|5[579]|9\\d)|7(?:[0-3579]\\d|4[0467]|6[67]|8[078])|9[4-6]\\d)|4(?:2(?:29|5[0257]|6[0-7]|7[1-57])|5(?:1[0-4]|8\\d|9[5-9])|7(?:0\\d|1[024589]|2[0127]|3[0137]|[46][07]|5[01]|7[5-9]|9[079])|9(?:7[015-9]|[89]\\d))|5(?:112|2(?:0\\d|2[29]|[49]4)|3[1568]\\d|52[6-9]|7(?:0[01578]|1[017]|[23]7|4[047]|[5-7]\\d|8[78]|9[079]))|6(?:2(?:2[1245]|4[2-4])|39\\d|41[179]|5(?:[349]\\d|5[0-2])|7(?:0[017]|[13]\\d|22|44|55|67|88))|9(?:22[128]|3(?:2[0-4]|7\\d)|57[05629]|7(?:2[05-9]|3[37]|4\\d|60|7[2579]|87|9[07])))\\d{4}|9[0-57-9]\\d{7}","\\d{7,9}",,,"912345678"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"UZ",998,"810","8",,,"8",,"8~10",,[[,"([679]\\d)(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",,"8 $1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],VA:[,[,,"(?:0(?:878\\d{5}|6698\\d{5})|[1589]\\d{5,10}|3(?:[12457-9]\\d{8}|[36]\\d{7,9}))","\\d{6,11}"],[,,"06698\\d{5}","\\d{10}",,,"0669812345"],[,,"3(?:[12457-9]\\d{8}|6\\d{7,8}|3\\d{7,9})","\\d{9,11}",,,"3123456789"],[,,"80(?:0\\d{6}|3\\d{3})","\\d{6,9}",,,"800123456"],[,,"0878\\d{5}|1(?:44|6[346])\\d{6}|89(?:2\\d{3}|4(?:[0-4]\\d{2}|[5-9]\\d{4})|5(?:[0-4]\\d{2}|[5-9]\\d{6})|9\\d{6})","\\d{6,10}",,,"899123456"],[,,"84(?:[08]\\d{6}|[17]\\d{3})","\\d{6,9}",,,"848123456"],[,,"1(?:78\\d|99)\\d{6}","\\d{9,10}",,,"1781234567"],[,,"55\\d{8}","\\d{10}",,,"5512345678"],"VA",39,"00",,,,,,,,,,[,,"NA","NA"],,,[,,"848\\d{6}","\\d{9}",,,"848123456"],[,,"NA","NA"],1,,[,,"NA","NA"]],VC:[,[,,"[5789]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"784(?:266|3(?:6[6-9]|7\\d|8[0-24-6])|4(?:38|5[0-36-8]|8[0-8])|5(?:55|7[0-2]|93)|638|784)\\d{4}","\\d{7}(?:\\d{3})?",,,"7842661234"],[,,"784(?:4(?:3[0-4]|5[45]|89|9[0-58])|5(?:2[6-9]|3[0-4]))\\d{4}","\\d{10}",,,"7844301234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002345678"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002345678"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"VC",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"784",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],VE:[,[,,"[24589]\\d{9}","\\d{7,10}"],[,,"(?:2(?:12|3[457-9]|[58][1-9]|[467]\\d|9[1-6])|50[01])\\d{7}","\\d{7,10}",,,"2121234567"],[,,"4(?:1[24-8]|2[46])\\d{7}","\\d{10}",,,"4121234567"],[,,"800\\d{7}","\\d{10}",,,"8001234567"],[,,"900\\d{7}","\\d{10}",,,"9001234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"VE",58,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{7})","$1-$2",,"0$1","$CC $1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],VG:[,[,,"[2589]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"284(?:(?:229|4(?:22|9[45])|774|8(?:52|6[459]))\\d{4}|496[0-5]\\d{3})","\\d{7}(?:\\d{3})?",,,"2842291234"],[,,"284(?:(?:3(?:0[0-3]|4[0-367]|94)|4(?:4[0-6]|68|99)|54[0-57])\\d{4}|496[6-9]\\d{3})","\\d{10}",,,"2843001234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002345678"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002345678"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"VG",1,"011","1",,,"1",,,,,,[,,"NA","NA"],,"284",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],VI:[,[,,"[3589]\\d{9}","\\d{7}(?:\\d{3})?"],[,,"340(?:2(?:01|2[0678]|44|77)|3(?:32|44)|4(?:22|7[34])|5(?:1[34]|55)|6(?:26|4[23]|77|9[023])|7(?:1[2-589]|27|7\\d)|884|998)\\d{4}","\\d{7}(?:\\d{3})?",,,"3406421234"],[,,"340(?:2(?:01|2[0678]|44|77)|3(?:32|44)|4(?:22|7[34])|5(?:1[34]|55)|6(?:26|4[23]|77|9[023])|7(?:1[2-589]|27|7\\d)|884|998)\\d{4}","\\d{7}(?:\\d{3})?",,,"3406421234"],[,,"8(?:00|44|55|66|77|88)[2-9]\\d{6}","\\d{10}",,,"8002345678"],[,,"900[2-9]\\d{6}","\\d{10}",,,"9002345678"],[,,"NA","NA"],[,,"5(?:00|33|44|66|77|88)[2-9]\\d{6}","\\d{10}",,,"5002345678"],[,,"NA","NA"],"VI",1,"011","1",,,"1",,,1,,,[,,"NA","NA"],,"340",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],VN:[,[,,"[17]\\d{6,9}|[2-69]\\d{7,9}|8\\d{6,8}","\\d{7,10}"],[,,"(?:2(?:[025-79]|1[0189]|[348][01])|3(?:[0136-9]|[25][01])|4\\d|5(?:[01][01]|[2-9])|6(?:[0-46-8]|5[01])|7(?:[02-79]|[18][01]))\\d{7}|8(?:[1-57]\\d|[689][0-79])\\d{6}","\\d{9,10}",,,"2101234567"],[,,"(?:9\\d|1(?:2\\d|6[2-9]|8[68]|99))\\d{7}|8[689]8\\d{6}","\\d{9,10}",,,"912345678"],[,,"1800\\d{4,6}","\\d{8,10}",,,"1800123456"],[,,"1900\\d{4,6}","\\d{8,10}",,,"1900123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"VN",84,"00","0",,,"0",,,,[[,"([17]99)(\\d{4})","$1 $2",["[17]99"],"0$1",,1],[,"([48])(\\d{4})(\\d{4})","$1 $2 $3",["4|8(?:[1-57]|[689][0-79])"],"0$1",,1],[,"([235-7]\\d)(\\d{4})(\\d{3})","$1 $2 $3",["2[025-79]|3[0136-9]|5[2-9]|6[0-46-8]|7[02-79]"],"0$1",,1],[,"(80)(\\d{5})","$1 $2",["80"],"0$1",,1],[,"(69\\d)(\\d{4,5})","$1 $2",["69"],"0$1",,1],[,"([235-7]\\d{2})(\\d{4})(\\d{3})","$1 $2 $3",["2[1348]|3[25]|5[01]|65|7[18]"],"0$1",,1],[,"([89]\\d)(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8[689]8|9"],"0$1",,1],[,"(1[2689]\\d)(\\d{3})(\\d{4})","$1 $2 $3",["1(?:[26]|8[68]|99)"],"0$1",,1],[,"(1[89]00)(\\d{4,6})","$1 $2",["1[89]0"],"$1",,1]],,[,,"NA","NA"],,,[,,"[17]99\\d{4}|69\\d{5,6}","\\d{7,8}",,,"1992000"],[,,"[17]99\\d{4}|69\\d{5,6}|80\\d{5}","\\d{7,8}",,,"1992000"],,,[,,"NA","NA"]],VU:[,[,,"[2-57-9]\\d{4,6}","\\d{5,7}"],[,,"(?:2[02-9]\\d|3(?:[5-7]\\d|8[0-8])|48[4-9]|88\\d)\\d{2}","\\d{5}",,,"22123"],[,,"(?:5(?:7[2-5]|[0-689]\\d)|7[013-7]\\d)\\d{4}","\\d{7}",,,"5912345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"VU",678,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[579]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"3[03]\\d{3}|900\\d{4}","\\d{5,7}",,,"30123"],,,[,,"NA","NA"]],WF:[,[,,"[4-8]\\d{5}","\\d{6}"],[,,"(?:50|68|72)\\d{4}","\\d{6}",,,"501234"],[,,"(?:50|68|72|8[23])\\d{4}","\\d{6}",,,"501234"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"WF",681,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"[48]0\\d{4}","\\d{6}",,,"401234"]],WS:[,[,,"[2-8]\\d{4,6}","\\d{5,7}"],[,,"(?:[2-5]\\d|6[1-9]|84\\d{2})\\d{3}","\\d{5,7}",,,"22123"],[,,"(?:60|7[25-7]\\d)\\d{4}","\\d{6,7}",,,"601234"],[,,"800\\d{3}","\\d{6}",,,"800123"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"WS",685,"0",,,,,,,,[[,"(8\\d{2})(\\d{3,4})","$1 $2",["8"]],[,"(7\\d)(\\d{5})","$1 $2",["7"]],[,"(\\d{5})","$1",["[2-6]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],YE:[,[,,"[1-7]\\d{6,8}","\\d{6,9}"],[,,"(?:1(?:7\\d|[2-68])|2[2-68]|3[2358]|4[2-58]|5[2-6]|6[3-58]|7[24-68])\\d{5}","\\d{6,8}",,,"1234567"],[,,"7[0137]\\d{7}","\\d{9}",,,"712345678"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"YE",967,"00","0",,,"0",,,,[[,"([1-7])(\\d{3})(\\d{3,4})","$1 $2 $3",["[1-6]|7[24-68]"],"0$1"],[,"(7\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["7[0137]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],YT:[,[,,"[268]\\d{8}","\\d{9}"],[,,"269(?:6[0-4]|50)\\d{4}","\\d{9}",,,"269601234"],[,,"639\\d{6}","\\d{9}",,,"639123456"],[,,"80\\d{7}","\\d{9}",,,"801234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"YT",262,"00","0",,,"0",,,,,,[,,"NA","NA"],,"269|63",[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],ZA:[,[,,"[1-79]\\d{8}|8(?:[067]\\d{7}|[1-4]\\d{3,7})","\\d{5,9}"],[,,"(?:1[0-8]|2[0-378]|3[1-69]|4\\d|5[1346-8])\\d{7}","\\d{9}",,,"101234567"],[,,"(?:6[0-5]|7[0-46-9])\\d{7}|8[1-4]\\d{3,7}","\\d{5,9}",,,"711234567"],[,,"80\\d{7}","\\d{9}",,,"801234567"],[,,"86[2-9]\\d{6}|90\\d{7}","\\d{9}",,,"862345678"],[,,"860\\d{6}","\\d{9}",,,"860123456"],[,,"NA","NA"],[,,"87\\d{7}","\\d{9}",,,"871234567"],"ZA",27,"00","0",,,"0",,,,[[,"(860)(\\d{3})(\\d{3})","$1 $2 $3",["860"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[1-79]|8(?:[0-47]|6[1-9])"],"0$1"],[,"(\\d{2})(\\d{3,4})","$1 $2",["8[1-4]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2,3})","$1 $2 $3",["8[1-4]"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"861\\d{6}","\\d{9}",,,"861123456"],,,[,,"NA","NA"]],ZM:[,[,,"[289]\\d{8}","\\d{9}"],[,,"21[1-8]\\d{6}","\\d{9}",,,"211234567"],[,,"9(?:5[05]|6\\d|7[1-9])\\d{6}","\\d{9}",,,"955123456"],[,,"800\\d{6}","\\d{9}",,,"800123456"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"ZM",260,"00","0",,,"0",,,,[[,"([29]\\d)(\\d{7})","$1 $2",["[29]"],"0$1"],[,"(800)(\\d{3})(\\d{3})","$1 $2 $3",["8"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],ZW:[,[,,"2(?:[012457-9]\\d{3,8}|6(?:[14]\\d{7}|\\d{4}))|[13-79]\\d{4,9}|8[06]\\d{8}","\\d{3,10}"],[,,"(?:2(?:0(?:4\\d|5\\d{2})|2[278]\\d|48\\d|7(?:[1-7]\\d|[089]\\d{2})|8(?:[2-57-9]|[146]\\d{2})|98)|3(?:08|17|3[78]|7(?:[19]|[56]\\d)|8[37]|98)|5[15][78]|6(?:28\\d{2}|[36]7|75\\d|[69]8|8(?:7\\d|8)))\\d{3}|(?:2(?:1[39]|2[0157]|6[14]|7[35]|84)|329)\\d{7}|(?:1(?:3\\d{2}|9\\d|[4-8])|2(?:0\\d{2}|[569]\\d)|3(?:[26]|[013459]\\d)|5(?:0|5\\d{2}|[689]\\d)|6(?:[39]|[01246]\\d|[78]\\d{2}))\\d{3}|(?:29\\d|39|54)\\d{6}|(?:(?:25|54)83|2582\\d)\\d{3}|(?:4\\d{6,7}|9[2-9]\\d{4,5})","\\d{3,10}",,,"1312345"],[,,"7[1378]\\d{7}","\\d{9}",,,"711234567"],[,,"800\\d{7}","\\d{10}",,,"8001234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"86(?:1[12]|30|44|55|77|8[367]|99)\\d{6}","\\d{10}",,,"8686123456"],"ZW",263,"00","0",,,"0",,,,[[,"([49])(\\d{3})(\\d{2,4})","$1 $2 $3",["4|9[2-9]"],"0$1"],[,"(7\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["7"],"0$1"],[,"(86\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["86[24]"],"0$1"],[,"([2356]\\d{2})(\\d{3,5})","$1 $2",["2(?:0[45]|2[278]|[49]8|[78])|3(?:08|17|3[78]|7[1569]|8[37]|98)|5[15][78]|6(?:[29]8|[38]7|6[78]|75|[89]8)"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["2(?:1[39]|2[0157]|6[14]|7[35]|84)|329"],"0$1"],[,"([1-356]\\d)(\\d{3,5})","$1 $2",["1[3-9]|2[0569]|3[0-69]|5[05689]|6[0-46-9]"],"0$1"],[,"([235]\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["[23]9|54"],"0$1"],[,"([25]\\d{3})(\\d{3,5})","$1 $2",["(?:25|54)8","258[23]|5483"],"0$1"],[,"(8\\d{3})(\\d{6})","$1 $2",["86"],"0$1"],[,"(80\\d)(\\d{3})(\\d{4})","$1 $2 $3",["80"],"0$1"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],800:[,[,,"\\d{8}","\\d{8}",,,"12345678"],[,,"NA","NA",,,"12345678"],[,,"NA","NA",,,"12345678"],[,,"\\d{8}","\\d{8}",,,"12345678"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"001",800,,,,,,,,1,[[,"(\\d{4})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],1,,[,,"NA","NA"]],808:[,[,,"\\d{8}","\\d{8}",,,"12345678"],[,,"NA","NA",,,"12345678"],[,,"NA","NA",,,"12345678"],[,,"NA","NA"],[,,"NA","NA"],[,,"\\d{8}","\\d{8}",,,"12345678"],[,,"NA","NA"],[,,"NA","NA"],"001",808,,,,,,,,1,[[,"(\\d{4})(\\d{4})","$1 $2"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],1,,[,,"NA","NA"]],870:[,[,,"[35-7]\\d{8}","\\d{9}",,,"301234567"],[,,"NA","NA",,,"301234567"],[,,"(?:[356]\\d|7[6-8])\\d{7}","\\d{9}",,,"301234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"001",870,,,,,,,,,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],878:[,[,,"1\\d{11}","\\d{12}",,,"101234567890"],[,,"NA","NA",,,"101234567890"],[,,"NA","NA",,,"101234567890"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"10\\d{10}","\\d{12}",,,"101234567890"],"001",878,,,,,,,,1,[[,"(\\d{2})(\\d{5})(\\d{5})","$1 $2 $3"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],881:[,[,,"[67]\\d{8}","\\d{9}",,,"612345678"],[,,"NA","NA",,,"612345678"],[,,"[67]\\d{8}","\\d{9}",,,"612345678"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"001",881,,,,,,,,,[[,"(\\d)(\\d{3})(\\d{5})","$1 $2 $3",["[67]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],882:[,[,,"[13]\\d{6,11}","\\d{7,12}",,,"3451234567"],[,,"NA","NA",,,"3451234567"],[,,"3(?:2\\d{3}|37\\d{2}|4(?:2|7\\d{3}))\\d{4}","\\d{7,10}",,,"3451234567"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"1(?:3(?:0[0347]|[13][0139]|2[035]|4[013568]|6[0459]|7[06]|8[15678]|9[0689])\\d{4}|6\\d{5,10})|345\\d{7}","\\d{7,12}",,,"3451234567"],"001",882,,,,,,,,,[[,"(\\d{2})(\\d{4})(\\d{3})","$1 $2 $3",["3[23]"]],[,"(\\d{2})(\\d{5})","$1 $2",["16|342"]],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["34[57]"]],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["348"]],[,"(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["1"]],[,"(\\d{2})(\\d{3,4})(\\d{4})","$1 $2 $3",["16"]],[,"(\\d{2})(\\d{4,5})(\\d{5})","$1 $2 $3",["16"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"348[57]\\d{7}","\\d{11}",,,"3451234567"]],883:[,[,,"51\\d{7}(?:\\d{3})?","\\d{9}(?:\\d{3})?",,,"510012345"],[,,"NA","NA",,,"510012345"],[,,"NA","NA",,,"510012345"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"51(?:00\\d{5}(?:\\d{3})?|[13]0\\d{8})","\\d{9}(?:\\d{3})?",,,"510012345"],"001",883,,,,,,,,1,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["510"]],[,"(\\d{3})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["510"]],[,"(\\d{4})(\\d{4})(\\d{4})","$1 $2 $3",["51[13]"]]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],,,[,,"NA","NA"]],888:[,[,,"\\d{11}","\\d{11}",,,"12345678901"],[,,"NA","NA",,,"12345678901"],[,,"NA","NA",,,"12345678901"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"001",888,,,,,,,,1,[[,"(\\d{3})(\\d{3})(\\d{5})","$1 $2 $3"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"\\d{11}","\\d{11}",,,"12345678901"],1,,[,,"NA","NA"]],979:[,[,,"\\d{9}","\\d{9}",,,"123456789"],[,,"NA","NA",,,"123456789"],[,,"NA","NA",,,"123456789"],[,,"NA","NA"],[,,"\\d{9}","\\d{9}",,,"123456789"],[,,"NA","NA"],[,,"NA","NA"],[,,"NA","NA"],"001",979,,,,,,,,1,[[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3"]],,[,,"NA","NA"],,,[,,"NA","NA"],[,,"NA","NA"],1,,[,,"NA","NA"]]},i18n.phonenumbers.PhoneNumberUtil=function(){this.regionToMetadataMap={}},goog.addSingletonGetter(i18n.phonenumbers.PhoneNumberUtil),i18n.phonenumbers.Error={INVALID_COUNTRY_CODE:"Invalid country calling code",NOT_A_NUMBER:"The string supplied did not seem to be a phone number",TOO_SHORT_AFTER_IDD:"Phone number too short after IDD",TOO_SHORT_NSN:"The string supplied is too short to be a phone number",TOO_LONG:"The string supplied is too long to be a phone number"},i18n.phonenumbers.PhoneNumberUtil.NANPA_COUNTRY_CODE_=1,i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_FOR_NSN_=2,i18n.phonenumbers.PhoneNumberUtil.MAX_LENGTH_FOR_NSN_=17,i18n.phonenumbers.PhoneNumberUtil.MAX_LENGTH_COUNTRY_CODE_=3,i18n.phonenumbers.PhoneNumberUtil.MAX_INPUT_STRING_LENGTH_=250,i18n.phonenumbers.PhoneNumberUtil.UNKNOWN_REGION_="ZZ",i18n.phonenumbers.PhoneNumberUtil.COLOMBIA_MOBILE_TO_FIXED_LINE_PREFIX_="3",i18n.phonenumbers.PhoneNumberUtil.MOBILE_TOKEN_MAPPINGS_={52:"1",54:"9"},i18n.phonenumbers.PhoneNumberUtil.GEO_MOBILE_COUNTRIES_=[52,54,55],i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN="+",i18n.phonenumbers.PhoneNumberUtil.STAR_SIGN_="*",i18n.phonenumbers.PhoneNumberUtil.RFC3966_EXTN_PREFIX_=";ext=",i18n.phonenumbers.PhoneNumberUtil.RFC3966_PREFIX_="tel:",i18n.phonenumbers.PhoneNumberUtil.RFC3966_PHONE_CONTEXT_=";phone-context=",i18n.phonenumbers.PhoneNumberUtil.RFC3966_ISDN_SUBADDRESS_=";isub=",i18n.phonenumbers.PhoneNumberUtil.DIGIT_MAPPINGS={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9","０":"0","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9","٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9"},i18n.phonenumbers.PhoneNumberUtil.DIALLABLE_CHAR_MAPPINGS_={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9","+":i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN,"*":"*"},i18n.phonenumbers.PhoneNumberUtil.ALPHA_MAPPINGS_={A:"2",B:"2",C:"2",D:"3",E:"3",F:"3",G:"4",H:"4",I:"4",J:"5",K:"5",L:"5",M:"6",N:"6",O:"6",P:"7",Q:"7",R:"7",S:"7",T:"8",U:"8",V:"8",W:"9",X:"9",Y:"9",Z:"9"},i18n.phonenumbers.PhoneNumberUtil.ALL_NORMALIZATION_MAPPINGS_={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9","０":"0","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9","٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9",A:"2",B:"2",C:"2",D:"3",E:"3",F:"3",G:"4",H:"4",I:"4",J:"5",K:"5",L:"5",M:"6",N:"6",O:"6",P:"7",Q:"7",R:"7",S:"7",T:"8",U:"8",V:"8",W:"9",X:"9",Y:"9",Z:"9"},i18n.phonenumbers.PhoneNumberUtil.ALL_PLUS_NUMBER_GROUPING_SYMBOLS_={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"A",b:"B",c:"C",d:"D",e:"E",f:"F",g:"G",h:"H",i:"I",j:"J",k:"K",l:"L",m:"M",n:"N",o:"O",p:"P",q:"Q",r:"R",s:"S",t:"T",u:"U",v:"V",w:"W",x:"X",y:"Y",z:"Z","-":"-","－":"-","‐":"-","‑":"-","‒":"-","–":"-","—":"-","―":"-","−":"-","/":"/","／":"/"," ":" ","　":" ","⁠":" ",".":".","．":"."},i18n.phonenumbers.PhoneNumberUtil.UNIQUE_INTERNATIONAL_PREFIX_=/[\d]+(?:[~\u2053\u223C\uFF5E][\d]+)?/,i18n.phonenumbers.PhoneNumberUtil.VALID_PUNCTUATION="-x‐-―−ー－-／  ­​⁠　()（）［］.\\[\\]/~⁓∼～",i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_="0-9０-９٠-٩۰-۹",i18n.phonenumbers.PhoneNumberUtil.VALID_ALPHA_="A-Za-z",i18n.phonenumbers.PhoneNumberUtil.PLUS_CHARS_="+＋",i18n.phonenumbers.PhoneNumberUtil.PLUS_CHARS_PATTERN=new RegExp("["+i18n.phonenumbers.PhoneNumberUtil.PLUS_CHARS_+"]+"),i18n.phonenumbers.PhoneNumberUtil.LEADING_PLUS_CHARS_PATTERN_=new RegExp("^["+i18n.phonenumbers.PhoneNumberUtil.PLUS_CHARS_+"]+"),
i18n.phonenumbers.PhoneNumberUtil.SEPARATOR_PATTERN_="["+i18n.phonenumbers.PhoneNumberUtil.VALID_PUNCTUATION+"]+",i18n.phonenumbers.PhoneNumberUtil.CAPTURING_DIGIT_PATTERN=new RegExp("(["+i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_+"])"),i18n.phonenumbers.PhoneNumberUtil.VALID_START_CHAR_PATTERN_=new RegExp("["+i18n.phonenumbers.PhoneNumberUtil.PLUS_CHARS_+i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_+"]"),i18n.phonenumbers.PhoneNumberUtil.SECOND_NUMBER_START_PATTERN_=/[\\\/] *x/,i18n.phonenumbers.PhoneNumberUtil.UNWANTED_END_CHAR_PATTERN_=new RegExp("[^"+i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_+i18n.phonenumbers.PhoneNumberUtil.VALID_ALPHA_+"#]+$"),i18n.phonenumbers.PhoneNumberUtil.VALID_ALPHA_PHONE_PATTERN_=/(?:.*?[A-Za-z]){3}.*/,i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_PHONE_NUMBER_PATTERN_="["+i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_+"]{"+i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_FOR_NSN_+"}",i18n.phonenumbers.PhoneNumberUtil.VALID_PHONE_NUMBER_="["+i18n.phonenumbers.PhoneNumberUtil.PLUS_CHARS_+"]*(?:["+i18n.phonenumbers.PhoneNumberUtil.VALID_PUNCTUATION+i18n.phonenumbers.PhoneNumberUtil.STAR_SIGN_+"]*["+i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_+"]){3,}["+i18n.phonenumbers.PhoneNumberUtil.VALID_PUNCTUATION+i18n.phonenumbers.PhoneNumberUtil.STAR_SIGN_+i18n.phonenumbers.PhoneNumberUtil.VALID_ALPHA_+i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_+"]*",i18n.phonenumbers.PhoneNumberUtil.DEFAULT_EXTN_PREFIX_=" ext. ",i18n.phonenumbers.PhoneNumberUtil.CAPTURING_EXTN_DIGITS_="(["+i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_+"]{1,7})",i18n.phonenumbers.PhoneNumberUtil.EXTN_PATTERNS_FOR_PARSING_=i18n.phonenumbers.PhoneNumberUtil.RFC3966_EXTN_PREFIX_+i18n.phonenumbers.PhoneNumberUtil.CAPTURING_EXTN_DIGITS_+"|[  \\t,]*(?:e?xt(?:ensi(?:ó?|ó))?n?|ｅ?ｘｔｎ?|[,xｘ#＃~～]|int|anexo|ｉｎｔ)[:\\.．]?[  \\t,-]*"+i18n.phonenumbers.PhoneNumberUtil.CAPTURING_EXTN_DIGITS_+"#?|[- ]+(["+i18n.phonenumbers.PhoneNumberUtil.VALID_DIGITS_+"]{1,5})#",i18n.phonenumbers.PhoneNumberUtil.EXTN_PATTERN_=new RegExp("(?:"+i18n.phonenumbers.PhoneNumberUtil.EXTN_PATTERNS_FOR_PARSING_+")$","i"),i18n.phonenumbers.PhoneNumberUtil.VALID_PHONE_NUMBER_PATTERN_=new RegExp("^"+i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_PHONE_NUMBER_PATTERN_+"$|^"+i18n.phonenumbers.PhoneNumberUtil.VALID_PHONE_NUMBER_+"(?:"+i18n.phonenumbers.PhoneNumberUtil.EXTN_PATTERNS_FOR_PARSING_+")?$","i"),i18n.phonenumbers.PhoneNumberUtil.NON_DIGITS_PATTERN_=/\D+/,i18n.phonenumbers.PhoneNumberUtil.FIRST_GROUP_PATTERN_=/(\$\d)/,i18n.phonenumbers.PhoneNumberUtil.NP_PATTERN_=/\$NP/,i18n.phonenumbers.PhoneNumberUtil.FG_PATTERN_=/\$FG/,i18n.phonenumbers.PhoneNumberUtil.CC_PATTERN_=/\$CC/,i18n.phonenumbers.PhoneNumberUtil.FIRST_GROUP_ONLY_PREFIX_PATTERN_=/^\(?\$1\)?$/,i18n.phonenumbers.PhoneNumberUtil.REGION_CODE_FOR_NON_GEO_ENTITY="001",i18n.phonenumbers.PhoneNumberFormat={E164:0,INTERNATIONAL:1,NATIONAL:2,RFC3966:3},i18n.phonenumbers.PhoneNumberType={FIXED_LINE:0,MOBILE:1,FIXED_LINE_OR_MOBILE:2,TOLL_FREE:3,PREMIUM_RATE:4,SHARED_COST:5,VOIP:6,PERSONAL_NUMBER:7,PAGER:8,UAN:9,VOICEMAIL:10,UNKNOWN:-1},i18n.phonenumbers.PhoneNumberUtil.MatchType={NOT_A_NUMBER:0,NO_MATCH:1,SHORT_NSN_MATCH:2,NSN_MATCH:3,EXACT_MATCH:4},i18n.phonenumbers.PhoneNumberUtil.ValidationResult={IS_POSSIBLE:0,INVALID_COUNTRY_CODE:1,TOO_SHORT:2,TOO_LONG:3},i18n.phonenumbers.PhoneNumberUtil.extractPossibleNumber=function(e){var t=e.search(i18n.phonenumbers.PhoneNumberUtil.VALID_START_CHAR_PATTERN_);return 0<=t?(e=e.substring(t),e=e.replace(i18n.phonenumbers.PhoneNumberUtil.UNWANTED_END_CHAR_PATTERN_,""),t=e.search(i18n.phonenumbers.PhoneNumberUtil.SECOND_NUMBER_START_PATTERN_),0<=t&&(e=e.substring(0,t))):e="",e},i18n.phonenumbers.PhoneNumberUtil.isViablePhoneNumber=function(e){return!(e.length<i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_FOR_NSN_)&&i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(i18n.phonenumbers.PhoneNumberUtil.VALID_PHONE_NUMBER_PATTERN_,e)},i18n.phonenumbers.PhoneNumberUtil.normalize=function(e){return i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(i18n.phonenumbers.PhoneNumberUtil.VALID_ALPHA_PHONE_PATTERN_,e)?i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_(e,i18n.phonenumbers.PhoneNumberUtil.ALL_NORMALIZATION_MAPPINGS_,!0):i18n.phonenumbers.PhoneNumberUtil.normalizeDigitsOnly(e)},i18n.phonenumbers.PhoneNumberUtil.normalizeSB_=function(e){var t=i18n.phonenumbers.PhoneNumberUtil.normalize(e.toString());e.clear(),e.append(t)},i18n.phonenumbers.PhoneNumberUtil.normalizeDigitsOnly=function(e){return i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_(e,i18n.phonenumbers.PhoneNumberUtil.DIGIT_MAPPINGS,!0)},i18n.phonenumbers.PhoneNumberUtil.convertAlphaCharactersInNumber=function(e){return i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_(e,i18n.phonenumbers.PhoneNumberUtil.ALL_NORMALIZATION_MAPPINGS_,!1)},i18n.phonenumbers.PhoneNumberUtil.prototype.getLengthOfGeographicalAreaCode=function(e){var t=this.getMetadataForRegion(this.getRegionCodeForNumber(e));return null!=t&&(t.hasNationalPrefix()||e.hasItalianLeadingZero())&&this.isNumberGeographical(e)?this.getLengthOfNationalDestinationCode(e):0},i18n.phonenumbers.PhoneNumberUtil.prototype.getLengthOfNationalDestinationCode=function(e){var t;return e.hasExtension()?(t=e.clone(),t.clearExtension()):t=e,t=this.format(t,i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL).split(i18n.phonenumbers.PhoneNumberUtil.NON_DIGITS_PATTERN_),0==t[0].length&&t.shift(),2>=t.length?0:this.getNumberType(e)==i18n.phonenumbers.PhoneNumberType.MOBILE&&(e=i18n.phonenumbers.PhoneNumberUtil.getCountryMobileToken(e.getCountryCodeOrDefault()),""!=e)?t[2].length+e.length:t[1].length},i18n.phonenumbers.PhoneNumberUtil.getCountryMobileToken=function(e){return i18n.phonenumbers.PhoneNumberUtil.MOBILE_TOKEN_MAPPINGS_[e]||""},i18n.phonenumbers.PhoneNumberUtil.prototype.getSupportedRegions=function(){return goog.array.filter(Object.keys(i18n.phonenumbers.metadata.countryToMetadata),function(e){return isNaN(e)})},i18n.phonenumbers.PhoneNumberUtil.prototype.getSupportedGlobalNetworkCallingCodes=function(){var e=goog.array.filter(Object.keys(i18n.phonenumbers.metadata.countryToMetadata),function(e){return!isNaN(e)});return goog.array.map(e,function(e){return parseInt(e,10)})},i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_=function(e,t,o){for(var n,r,d=new goog.string.StringBuffer,i=e.length,a=0;a<i;++a)n=e.charAt(a),r=t[n.toUpperCase()],null!=r?d.append(r):o||d.append(n);return d.toString()},i18n.phonenumbers.PhoneNumberUtil.prototype.formattingRuleHasFirstGroupOnly=function(e){return 0==e.length||i18n.phonenumbers.PhoneNumberUtil.FIRST_GROUP_ONLY_PREFIX_PATTERN_.test(e)},i18n.phonenumbers.PhoneNumberUtil.prototype.isNumberGeographical=function(e){var t=this.getNumberType(e);return t==i18n.phonenumbers.PhoneNumberType.FIXED_LINE||t==i18n.phonenumbers.PhoneNumberType.FIXED_LINE_OR_MOBILE||goog.array.contains(i18n.phonenumbers.PhoneNumberUtil.GEO_MOBILE_COUNTRIES_,e.getCountryCodeOrDefault())&&t==i18n.phonenumbers.PhoneNumberType.MOBILE},i18n.phonenumbers.PhoneNumberUtil.prototype.isValidRegionCode_=function(e){return null!=e&&isNaN(e)&&e.toUpperCase()in i18n.phonenumbers.metadata.countryToMetadata},i18n.phonenumbers.PhoneNumberUtil.prototype.hasValidCountryCallingCode_=function(e){return e in i18n.phonenumbers.metadata.countryCodeToRegionCodeMap},i18n.phonenumbers.PhoneNumberUtil.prototype.format=function(e,t){if(0==e.getNationalNumber()&&e.hasRawInput()){var o=e.getRawInputOrDefault();if(0<o.length)return o}var o=e.getCountryCodeOrDefault(),n=this.getNationalSignificantNumber(e);if(t==i18n.phonenumbers.PhoneNumberFormat.E164)return this.prefixNumberWithCountryCallingCode_(o,i18n.phonenumbers.PhoneNumberFormat.E164,n,"");if(!this.hasValidCountryCallingCode_(o))return n;var r=this.getRegionCodeForCountryCode(o),d=this.getMetadataForRegionOrCallingCode_(o,r),r=this.maybeGetFormattedExtension_(e,d,t),n=this.formatNsn_(n,d,t);return this.prefixNumberWithCountryCallingCode_(o,t,n,r)},i18n.phonenumbers.PhoneNumberUtil.prototype.formatByPattern=function(e,t,o){var n=e.getCountryCodeOrDefault(),r=this.getNationalSignificantNumber(e);if(!this.hasValidCountryCallingCode_(n))return r;var d=this.getRegionCodeForCountryCode(n),d=this.getMetadataForRegionOrCallingCode_(n,d),i=this.chooseFormattingPatternForNumber_(o,r);if(null!=i){if(o=i.clone(),i=i.getNationalPrefixFormattingRuleOrDefault(),0<i.length){var a=d.getNationalPrefixOrDefault();0<a.length?(i=i.replace(i18n.phonenumbers.PhoneNumberUtil.NP_PATTERN_,a).replace(i18n.phonenumbers.PhoneNumberUtil.FG_PATTERN_,"$1"),o.setNationalPrefixFormattingRule(i)):o.clearNationalPrefixFormattingRule()}r=this.formatNsnUsingPattern_(r,o,t)}return e=this.maybeGetFormattedExtension_(e,d,t),this.prefixNumberWithCountryCallingCode_(n,t,r,e)},i18n.phonenumbers.PhoneNumberUtil.prototype.formatNationalNumberWithCarrierCode=function(e,t){var o=e.getCountryCodeOrDefault(),n=this.getNationalSignificantNumber(e);if(!this.hasValidCountryCallingCode_(o))return n;var r=this.getRegionCodeForCountryCode(o),d=this.getMetadataForRegionOrCallingCode_(o,r),r=this.maybeGetFormattedExtension_(e,d,i18n.phonenumbers.PhoneNumberFormat.NATIONAL),n=this.formatNsn_(n,d,i18n.phonenumbers.PhoneNumberFormat.NATIONAL,t);return this.prefixNumberWithCountryCallingCode_(o,i18n.phonenumbers.PhoneNumberFormat.NATIONAL,n,r)},i18n.phonenumbers.PhoneNumberUtil.prototype.getMetadataForRegionOrCallingCode_=function(e,t){return i18n.phonenumbers.PhoneNumberUtil.REGION_CODE_FOR_NON_GEO_ENTITY==t?this.getMetadataForNonGeographicalRegion(e):this.getMetadataForRegion(t)},i18n.phonenumbers.PhoneNumberUtil.prototype.formatNationalNumberWithPreferredCarrierCode=function(e,t){return this.formatNationalNumberWithCarrierCode(e,e.hasPreferredDomesticCarrierCode()?e.getPreferredDomesticCarrierCodeOrDefault():t)},i18n.phonenumbers.PhoneNumberUtil.prototype.formatNumberForMobileDialing=function(e,t,o){var n=e.getCountryCodeOrDefault();if(!this.hasValidCountryCallingCode_(n))return e.hasRawInput()?e.getRawInputOrDefault():"";var r="";e=e.clone(),e.clearExtension();var d=this.getRegionCodeForCountryCode(n),i=this.getNumberType(e),a=i!=i18n.phonenumbers.PhoneNumberType.UNKNOWN;if(t==d)r=i==i18n.phonenumbers.PhoneNumberType.FIXED_LINE||i==i18n.phonenumbers.PhoneNumberType.MOBILE||i==i18n.phonenumbers.PhoneNumberType.FIXED_LINE_OR_MOBILE,"CO"==d&&i==i18n.phonenumbers.PhoneNumberType.FIXED_LINE?r=this.formatNationalNumberWithCarrierCode(e,i18n.phonenumbers.PhoneNumberUtil.COLOMBIA_MOBILE_TO_FIXED_LINE_PREFIX_):"BR"==d&&r?r=e.hasPreferredDomesticCarrierCode()?this.formatNationalNumberWithPreferredCarrierCode(e,""):"":a&&"HU"==d?r=this.getNddPrefixForRegion(d,!0)+" "+this.format(e,i18n.phonenumbers.PhoneNumberFormat.NATIONAL):n==i18n.phonenumbers.PhoneNumberUtil.NANPA_COUNTRY_CODE_?(t=this.getMetadataForRegion(t),r=this.canBeInternationallyDialled(e)&&!this.isShorterThanPossibleNormalNumber_(t,this.getNationalSignificantNumber(e))?this.format(e,i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL):this.format(e,i18n.phonenumbers.PhoneNumberFormat.NATIONAL)):r=(d==i18n.phonenumbers.PhoneNumberUtil.REGION_CODE_FOR_NON_GEO_ENTITY||("MX"==d||"CL"==d)&&r)&&this.canBeInternationallyDialled(e)?this.format(e,i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL):this.format(e,i18n.phonenumbers.PhoneNumberFormat.NATIONAL);else if(a&&this.canBeInternationallyDialled(e))return o?this.format(e,i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL):this.format(e,i18n.phonenumbers.PhoneNumberFormat.E164);return o?r:i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_(r,i18n.phonenumbers.PhoneNumberUtil.DIALLABLE_CHAR_MAPPINGS_,!0)},i18n.phonenumbers.PhoneNumberUtil.prototype.formatOutOfCountryCallingNumber=function(e,t){if(!this.isValidRegionCode_(t))return this.format(e,i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL);var o=e.getCountryCodeOrDefault(),n=this.getNationalSignificantNumber(e);if(!this.hasValidCountryCallingCode_(o))return n;if(o==i18n.phonenumbers.PhoneNumberUtil.NANPA_COUNTRY_CODE_){if(this.isNANPACountry(t))return o+" "+this.format(e,i18n.phonenumbers.PhoneNumberFormat.NATIONAL)}else if(o==this.getCountryCodeForValidRegion_(t))return this.format(e,i18n.phonenumbers.PhoneNumberFormat.NATIONAL);var r=this.getMetadataForRegion(t),d=r.getInternationalPrefixOrDefault(),i="";return i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(i18n.phonenumbers.PhoneNumberUtil.UNIQUE_INTERNATIONAL_PREFIX_,d)?i=d:r.hasPreferredInternationalPrefix()&&(i=r.getPreferredInternationalPrefixOrDefault()),r=this.getRegionCodeForCountryCode(o),r=this.getMetadataForRegionOrCallingCode_(o,r),n=this.formatNsn_(n,r,i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL),r=this.maybeGetFormattedExtension_(e,r,i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL),0<i.length?i+" "+o+" "+n+r:this.prefixNumberWithCountryCallingCode_(o,i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL,n,r)},i18n.phonenumbers.PhoneNumberUtil.prototype.formatInOriginalFormat=function(e,t){if(e.hasRawInput()&&(this.hasUnexpectedItalianLeadingZero_(e)||!this.hasFormattingPatternForNumber_(e)))return e.getRawInputOrDefault();if(!e.hasCountryCodeSource())return this.format(e,i18n.phonenumbers.PhoneNumberFormat.NATIONAL);var o;switch(e.getCountryCodeSource()){case i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_NUMBER_WITH_PLUS_SIGN:o=this.format(e,i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL);break;case i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_NUMBER_WITH_IDD:o=this.formatOutOfCountryCallingNumber(e,t);break;case i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_NUMBER_WITHOUT_PLUS_SIGN:o=this.format(e,i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL).substring(1);break;default:var n=this.getRegionCodeForCountryCode(e.getCountryCodeOrDefault()),r=this.getNddPrefixForRegion(n,!0);if(o=this.format(e,i18n.phonenumbers.PhoneNumberFormat.NATIONAL),null!=r&&0!=r.length&&!this.rawInputContainsNationalPrefix_(e.getRawInputOrDefault(),r,n)&&(n=this.getMetadataForRegion(n),r=this.getNationalSignificantNumber(e),n=this.chooseFormattingPatternForNumber_(n.numberFormatArray(),r),null!=n)){var r=n.getNationalPrefixFormattingRuleOrDefault(),d=r.indexOf("$1");0>=d||(r=r.substring(0,d),r=i18n.phonenumbers.PhoneNumberUtil.normalizeDigitsOnly(r),0!=r.length&&(o=n.clone(),o.clearNationalPrefixFormattingRule(),o=this.formatByPattern(e,i18n.phonenumbers.PhoneNumberFormat.NATIONAL,[o])))}}return n=e.getRawInputOrDefault(),null!=o&&0<n.length&&(r=i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_(o,i18n.phonenumbers.PhoneNumberUtil.DIALLABLE_CHAR_MAPPINGS_,!0),d=i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_(n,i18n.phonenumbers.PhoneNumberUtil.DIALLABLE_CHAR_MAPPINGS_,!0),r!=d&&(o=n)),o},i18n.phonenumbers.PhoneNumberUtil.prototype.rawInputContainsNationalPrefix_=function(e,t,o){if(e=i18n.phonenumbers.PhoneNumberUtil.normalizeDigitsOnly(e),goog.string.startsWith(e,t))try{return this.isValidNumber(this.parse(e.substring(t.length),o))}catch(e){}return!1},i18n.phonenumbers.PhoneNumberUtil.prototype.hasUnexpectedItalianLeadingZero_=function(e){return e.hasItalianLeadingZero()&&!this.isLeadingZeroPossible(e.getCountryCodeOrDefault())},i18n.phonenumbers.PhoneNumberUtil.prototype.hasFormattingPatternForNumber_=function(e){var t=e.getCountryCodeOrDefault(),o=this.getRegionCodeForCountryCode(t),t=this.getMetadataForRegionOrCallingCode_(t,o);return null!=t&&(e=this.getNationalSignificantNumber(e),null!=this.chooseFormattingPatternForNumber_(t.numberFormatArray(),e))},i18n.phonenumbers.PhoneNumberUtil.prototype.formatOutOfCountryKeepingAlphaChars=function(e,t){var o=e.getRawInputOrDefault();if(0==o.length)return this.formatOutOfCountryCallingNumber(e,t);var n=e.getCountryCodeOrDefault();if(!this.hasValidCountryCallingCode_(n))return o;var o=i18n.phonenumbers.PhoneNumberUtil.normalizeHelper_(o,i18n.phonenumbers.PhoneNumberUtil.ALL_PLUS_NUMBER_GROUPING_SYMBOLS_,!0),r=this.getNationalSignificantNumber(e);if(3<r.length){var d=o.indexOf(r.substring(0,3));-1!=d&&(o=o.substring(d))}if(d=this.getMetadataForRegion(t),n==i18n.phonenumbers.PhoneNumberUtil.NANPA_COUNTRY_CODE_){if(this.isNANPACountry(t))return n+" "+o}else if(null!=d&&n==this.getCountryCodeForValidRegion_(t))return n=this.chooseFormattingPatternForNumber_(d.numberFormatArray(),r),null==n?o:(n=n.clone(),n.setPattern("(\\d+)(.*)"),n.setFormat("$1$2"),this.formatNsnUsingPattern_(o,n,i18n.phonenumbers.PhoneNumberFormat.NATIONAL));return r="",null!=d&&(r=d.getInternationalPrefixOrDefault(),r=i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(i18n.phonenumbers.PhoneNumberUtil.UNIQUE_INTERNATIONAL_PREFIX_,r)?r:d.getPreferredInternationalPrefixOrDefault()),d=this.getRegionCodeForCountryCode(n),d=this.getMetadataForRegionOrCallingCode_(n,d),d=this.maybeGetFormattedExtension_(e,d,i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL),0<r.length?r+" "+n+" "+o+d:this.prefixNumberWithCountryCallingCode_(n,i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL,o,d)},i18n.phonenumbers.PhoneNumberUtil.prototype.getNationalSignificantNumber=function(e){var t=""+e.getNationalNumber();return e.hasItalianLeadingZero()&&e.getItalianLeadingZero()?Array(e.getNumberOfLeadingZerosOrDefault()+1).join("0")+t:t},i18n.phonenumbers.PhoneNumberUtil.prototype.prefixNumberWithCountryCallingCode_=function(e,t,o,n){switch(t){case i18n.phonenumbers.PhoneNumberFormat.E164:return i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN+e+o+n;case i18n.phonenumbers.PhoneNumberFormat.INTERNATIONAL:return i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN+e+" "+o+n;case i18n.phonenumbers.PhoneNumberFormat.RFC3966:return i18n.phonenumbers.PhoneNumberUtil.RFC3966_PREFIX_+i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN+e+"-"+o+n;default:return o+n}},i18n.phonenumbers.PhoneNumberUtil.prototype.formatNsn_=function(e,t,o,n){return t=0==t.intlNumberFormatArray().length||o==i18n.phonenumbers.PhoneNumberFormat.NATIONAL?t.numberFormatArray():t.intlNumberFormatArray(),t=this.chooseFormattingPatternForNumber_(t,e),null==t?e:this.formatNsnUsingPattern_(e,t,o,n)},i18n.phonenumbers.PhoneNumberUtil.prototype.chooseFormattingPatternForNumber_=function(e,t){for(var o,n=e.length,r=0;r<n;++r){o=e[r];var d=o.leadingDigitsPatternCount();if((0==d||0==t.search(o.getLeadingDigitsPattern(d-1)))&&(d=new RegExp(o.getPattern()),i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(d,t)))return o}return null};i18n.phonenumbers.PhoneNumberUtil.prototype.formatNsnUsingPattern_=function(e,t,o,n){var r=t.getFormatOrDefault(),d=new RegExp(t.getPattern()),i=t.getDomesticCarrierCodeFormattingRuleOrDefault();return o==i18n.phonenumbers.PhoneNumberFormat.NATIONAL&&null!=n&&0<n.length&&0<i.length?(t=i.replace(i18n.phonenumbers.PhoneNumberUtil.CC_PATTERN_,n),r=r.replace(i18n.phonenumbers.PhoneNumberUtil.FIRST_GROUP_PATTERN_,t),e=e.replace(d,r)):(t=t.getNationalPrefixFormattingRuleOrDefault(),e=o==i18n.phonenumbers.PhoneNumberFormat.NATIONAL&&null!=t&&0<t.length?e.replace(d,r.replace(i18n.phonenumbers.PhoneNumberUtil.FIRST_GROUP_PATTERN_,t)):e.replace(d,r)),o==i18n.phonenumbers.PhoneNumberFormat.RFC3966&&(e=e.replace(new RegExp("^"+i18n.phonenumbers.PhoneNumberUtil.SEPARATOR_PATTERN_),""),e=e.replace(new RegExp(i18n.phonenumbers.PhoneNumberUtil.SEPARATOR_PATTERN_,"g"),"-")),e};i18n.phonenumbers.PhoneNumberUtil.prototype.getExampleNumber=function(e){return this.getExampleNumberForType(e,i18n.phonenumbers.PhoneNumberType.FIXED_LINE)},i18n.phonenumbers.PhoneNumberUtil.prototype.getExampleNumberForType=function(e,t){if(!this.isValidRegionCode_(e))return null;var o=this.getNumberDescByType_(this.getMetadataForRegion(e),t);try{if(o.hasExampleNumber())return this.parse(o.getExampleNumberOrDefault(),e)}catch(e){}return null},i18n.phonenumbers.PhoneNumberUtil.prototype.getExampleNumberForNonGeoEntity=function(e){var t=this.getMetadataForNonGeographicalRegion(e);if(null!=t){t=t.getGeneralDesc();try{if(t.hasExampleNumber())return this.parse("+"+e+t.getExampleNumber(),"ZZ")}catch(e){}}return null},i18n.phonenumbers.PhoneNumberUtil.prototype.maybeGetFormattedExtension_=function(e,t,o){return e.hasExtension()&&0!=e.getExtension().length?o==i18n.phonenumbers.PhoneNumberFormat.RFC3966?i18n.phonenumbers.PhoneNumberUtil.RFC3966_EXTN_PREFIX_+e.getExtension():t.hasPreferredExtnPrefix()?t.getPreferredExtnPrefix()+e.getExtensionOrDefault():i18n.phonenumbers.PhoneNumberUtil.DEFAULT_EXTN_PREFIX_+e.getExtensionOrDefault():""},i18n.phonenumbers.PhoneNumberUtil.prototype.getNumberDescByType_=function(e,t){switch(t){case i18n.phonenumbers.PhoneNumberType.PREMIUM_RATE:return e.getPremiumRate();case i18n.phonenumbers.PhoneNumberType.TOLL_FREE:return e.getTollFree();case i18n.phonenumbers.PhoneNumberType.MOBILE:return e.getMobile();case i18n.phonenumbers.PhoneNumberType.FIXED_LINE:case i18n.phonenumbers.PhoneNumberType.FIXED_LINE_OR_MOBILE:return e.getFixedLine();case i18n.phonenumbers.PhoneNumberType.SHARED_COST:return e.getSharedCost();case i18n.phonenumbers.PhoneNumberType.VOIP:return e.getVoip();case i18n.phonenumbers.PhoneNumberType.PERSONAL_NUMBER:return e.getPersonalNumber();case i18n.phonenumbers.PhoneNumberType.PAGER:return e.getPager();case i18n.phonenumbers.PhoneNumberType.UAN:return e.getUan();case i18n.phonenumbers.PhoneNumberType.VOICEMAIL:return e.getVoicemail();default:return e.getGeneralDesc()}},i18n.phonenumbers.PhoneNumberUtil.prototype.getNumberType=function(e){var t=this.getRegionCodeForNumber(e),t=this.getMetadataForRegionOrCallingCode_(e.getCountryCodeOrDefault(),t);return null==t?i18n.phonenumbers.PhoneNumberType.UNKNOWN:(e=this.getNationalSignificantNumber(e),this.getNumberTypeHelper_(e,t))},i18n.phonenumbers.PhoneNumberUtil.prototype.getNumberTypeHelper_=function(e,t){return this.isNumberMatchingDesc_(e,t.getGeneralDesc())?this.isNumberMatchingDesc_(e,t.getPremiumRate())?i18n.phonenumbers.PhoneNumberType.PREMIUM_RATE:this.isNumberMatchingDesc_(e,t.getTollFree())?i18n.phonenumbers.PhoneNumberType.TOLL_FREE:this.isNumberMatchingDesc_(e,t.getSharedCost())?i18n.phonenumbers.PhoneNumberType.SHARED_COST:this.isNumberMatchingDesc_(e,t.getVoip())?i18n.phonenumbers.PhoneNumberType.VOIP:this.isNumberMatchingDesc_(e,t.getPersonalNumber())?i18n.phonenumbers.PhoneNumberType.PERSONAL_NUMBER:this.isNumberMatchingDesc_(e,t.getPager())?i18n.phonenumbers.PhoneNumberType.PAGER:this.isNumberMatchingDesc_(e,t.getUan())?i18n.phonenumbers.PhoneNumberType.UAN:this.isNumberMatchingDesc_(e,t.getVoicemail())?i18n.phonenumbers.PhoneNumberType.VOICEMAIL:this.isNumberMatchingDesc_(e,t.getFixedLine())?t.getSameMobileAndFixedLinePattern()||this.isNumberMatchingDesc_(e,t.getMobile())?i18n.phonenumbers.PhoneNumberType.FIXED_LINE_OR_MOBILE:i18n.phonenumbers.PhoneNumberType.FIXED_LINE:!t.getSameMobileAndFixedLinePattern()&&this.isNumberMatchingDesc_(e,t.getMobile())?i18n.phonenumbers.PhoneNumberType.MOBILE:i18n.phonenumbers.PhoneNumberType.UNKNOWN:i18n.phonenumbers.PhoneNumberType.UNKNOWN},i18n.phonenumbers.PhoneNumberUtil.prototype.getMetadataForRegion=function(e){if(null==e)return null;e=e.toUpperCase();var t=this.regionToMetadataMap[e];if(null==t){var t=new goog.proto2.PbLiteSerializer,o=i18n.phonenumbers.metadata.countryToMetadata[e];if(null==o)return null;t=t.deserialize(i18n.phonenumbers.PhoneMetadata.getDescriptor(),o),this.regionToMetadataMap[e]=t}return t},i18n.phonenumbers.PhoneNumberUtil.prototype.getMetadataForNonGeographicalRegion=function(e){return this.getMetadataForRegion(""+e)},i18n.phonenumbers.PhoneNumberUtil.prototype.isNumberMatchingDesc_=function(e,t){return i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(t.getPossibleNumberPatternOrDefault(),e)&&i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(t.getNationalNumberPatternOrDefault(),e)},i18n.phonenumbers.PhoneNumberUtil.prototype.isValidNumber=function(e){var t=this.getRegionCodeForNumber(e);return this.isValidNumberForRegion(e,t)},i18n.phonenumbers.PhoneNumberUtil.prototype.isValidNumberForRegion=function(e,t){var o=e.getCountryCodeOrDefault(),n=this.getMetadataForRegionOrCallingCode_(o,t);return null!=n&&(i18n.phonenumbers.PhoneNumberUtil.REGION_CODE_FOR_NON_GEO_ENTITY==t||o==this.getCountryCodeForValidRegion_(t))&&(o=this.getNationalSignificantNumber(e),this.getNumberTypeHelper_(o,n)!=i18n.phonenumbers.PhoneNumberType.UNKNOWN)},i18n.phonenumbers.PhoneNumberUtil.prototype.getRegionCodeForNumber=function(e){if(null==e)return null;var t=e.getCountryCodeOrDefault(),t=i18n.phonenumbers.metadata.countryCodeToRegionCodeMap[t];return null==t?null:1==t.length?t[0]:this.getRegionCodeForNumberFromRegionList_(e,t)},i18n.phonenumbers.PhoneNumberUtil.prototype.getRegionCodeForNumberFromRegionList_=function(e,t){for(var o,n=this.getNationalSignificantNumber(e),r=t.length,d=0;d<r;d++){o=t[d];var i=this.getMetadataForRegion(o);if(i.hasLeadingDigits()){if(0==n.search(i.getLeadingDigits()))return o}else if(this.getNumberTypeHelper_(n,i)!=i18n.phonenumbers.PhoneNumberType.UNKNOWN)return o}return null},i18n.phonenumbers.PhoneNumberUtil.prototype.getRegionCodeForCountryCode=function(e){return e=i18n.phonenumbers.metadata.countryCodeToRegionCodeMap[e],null==e?i18n.phonenumbers.PhoneNumberUtil.UNKNOWN_REGION_:e[0]},i18n.phonenumbers.PhoneNumberUtil.prototype.getRegionCodesForCountryCode=function(e){return e=i18n.phonenumbers.metadata.countryCodeToRegionCodeMap[e],null==e?[]:e},i18n.phonenumbers.PhoneNumberUtil.prototype.getCountryCodeForRegion=function(e){return this.isValidRegionCode_(e)?this.getCountryCodeForValidRegion_(e):0},i18n.phonenumbers.PhoneNumberUtil.prototype.getCountryCodeForValidRegion_=function(e){var t=this.getMetadataForRegion(e);if(null==t)throw Error("Invalid region code: "+e);return t.getCountryCodeOrDefault()},i18n.phonenumbers.PhoneNumberUtil.prototype.getNddPrefixForRegion=function(e,t){var o=this.getMetadataForRegion(e);return null==o?null:(o=o.getNationalPrefixOrDefault(),0==o.length?null:(t&&(o=o.replace("~","")),o))},i18n.phonenumbers.PhoneNumberUtil.prototype.isNANPACountry=function(e){return null!=e&&goog.array.contains(i18n.phonenumbers.metadata.countryCodeToRegionCodeMap[i18n.phonenumbers.PhoneNumberUtil.NANPA_COUNTRY_CODE_],e.toUpperCase())},i18n.phonenumbers.PhoneNumberUtil.prototype.isLeadingZeroPossible=function(e){return e=this.getMetadataForRegionOrCallingCode_(e,this.getRegionCodeForCountryCode(e)),null!=e&&e.getLeadingZeroPossibleOrDefault()},i18n.phonenumbers.PhoneNumberUtil.prototype.isAlphaNumber=function(e){return!!i18n.phonenumbers.PhoneNumberUtil.isViablePhoneNumber(e)&&(e=new goog.string.StringBuffer(e),this.maybeStripExtension(e),i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(i18n.phonenumbers.PhoneNumberUtil.VALID_ALPHA_PHONE_PATTERN_,e.toString()))},i18n.phonenumbers.PhoneNumberUtil.prototype.isPossibleNumber=function(e){return this.isPossibleNumberWithReason(e)==i18n.phonenumbers.PhoneNumberUtil.ValidationResult.IS_POSSIBLE},i18n.phonenumbers.PhoneNumberUtil.prototype.testNumberLengthAgainstPattern_=function(e,t){return i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(e,t)?i18n.phonenumbers.PhoneNumberUtil.ValidationResult.IS_POSSIBLE:0==t.search(e)?i18n.phonenumbers.PhoneNumberUtil.ValidationResult.TOO_LONG:i18n.phonenumbers.PhoneNumberUtil.ValidationResult.TOO_SHORT},i18n.phonenumbers.PhoneNumberUtil.prototype.isShorterThanPossibleNormalNumber_=function(e,t){var o=e.getGeneralDesc().getPossibleNumberPatternOrDefault();return this.testNumberLengthAgainstPattern_(o,t)==i18n.phonenumbers.PhoneNumberUtil.ValidationResult.TOO_SHORT},i18n.phonenumbers.PhoneNumberUtil.prototype.isPossibleNumberWithReason=function(e){var t=this.getNationalSignificantNumber(e);if(e=e.getCountryCodeOrDefault(),!this.hasValidCountryCallingCode_(e))return i18n.phonenumbers.PhoneNumberUtil.ValidationResult.INVALID_COUNTRY_CODE;var o=this.getRegionCodeForCountryCode(e);return e=this.getMetadataForRegionOrCallingCode_(e,o).getGeneralDesc().getPossibleNumberPatternOrDefault(),this.testNumberLengthAgainstPattern_(e,t)},i18n.phonenumbers.PhoneNumberUtil.prototype.isPossibleNumberString=function(e,t){try{return this.isPossibleNumber(this.parse(e,t))}catch(e){return!1}},i18n.phonenumbers.PhoneNumberUtil.prototype.truncateTooLongNumber=function(e){if(this.isValidNumber(e))return!0;var t=e.clone(),o=e.getNationalNumberOrDefault();do if(o=Math.floor(o/10),t.setNationalNumber(o),0==o||this.isPossibleNumberWithReason(t)==i18n.phonenumbers.PhoneNumberUtil.ValidationResult.TOO_SHORT)return!1;while(!this.isValidNumber(t));return e.setNationalNumber(o),!0},i18n.phonenumbers.PhoneNumberUtil.prototype.extractCountryCode=function(e,t){var o=e.toString();if(0==o.length||"0"==o.charAt(0))return 0;for(var n,r=o.length,d=1;d<=i18n.phonenumbers.PhoneNumberUtil.MAX_LENGTH_COUNTRY_CODE_&&d<=r;++d)if(n=parseInt(o.substring(0,d),10),n in i18n.phonenumbers.metadata.countryCodeToRegionCodeMap)return t.append(o.substring(d)),n;return 0},i18n.phonenumbers.PhoneNumberUtil.prototype.maybeExtractCountryCode=function(e,t,o,n,r){if(0==e.length)return 0;e=new goog.string.StringBuffer(e);var d;if(null!=t&&(d=t.getInternationalPrefix()),null==d&&(d="NonMatch"),d=this.maybeStripInternationalPrefixAndNormalize(e,d),n&&r.setCountryCodeSource(d),d!=i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_DEFAULT_COUNTRY){if(e.getLength()<=i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_FOR_NSN_)throw Error(i18n.phonenumbers.Error.TOO_SHORT_AFTER_IDD);if(o=this.extractCountryCode(e,o),0!=o)return r.setCountryCode(o),o;throw Error(i18n.phonenumbers.Error.INVALID_COUNTRY_CODE)}if(null!=t){d=t.getCountryCodeOrDefault();var i=""+d,a=e.toString();if(goog.string.startsWith(a,i)){var N=new goog.string.StringBuffer(a.substring(i.length)),a=t.getGeneralDesc(),i=new RegExp(a.getNationalNumberPatternOrDefault());if(this.maybeStripNationalPrefixAndCarrierCode(N,t,null),t=N.toString(),a=a.getPossibleNumberPatternOrDefault(),!i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(i,e.toString())&&i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(i,t)||this.testNumberLengthAgainstPattern_(a,e.toString())==i18n.phonenumbers.PhoneNumberUtil.ValidationResult.TOO_LONG)return o.append(t),n&&r.setCountryCodeSource(i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_NUMBER_WITHOUT_PLUS_SIGN),r.setCountryCode(d),d}}return r.setCountryCode(0),0},i18n.phonenumbers.PhoneNumberUtil.prototype.parsePrefixAsIdd_=function(e,t){var o=t.toString();if(0==o.search(e)){var n=o.match(e)[0].length,r=o.substring(n).match(i18n.phonenumbers.PhoneNumberUtil.CAPTURING_DIGIT_PATTERN);return!(r&&null!=r[1]&&0<r[1].length&&"0"==i18n.phonenumbers.PhoneNumberUtil.normalizeDigitsOnly(r[1]))&&(t.clear(),t.append(o.substring(n)),!0)}return!1},i18n.phonenumbers.PhoneNumberUtil.prototype.maybeStripInternationalPrefixAndNormalize=function(e,t){var o=e.toString();return 0==o.length?i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_DEFAULT_COUNTRY:i18n.phonenumbers.PhoneNumberUtil.LEADING_PLUS_CHARS_PATTERN_.test(o)?(o=o.replace(i18n.phonenumbers.PhoneNumberUtil.LEADING_PLUS_CHARS_PATTERN_,""),e.clear(),e.append(i18n.phonenumbers.PhoneNumberUtil.normalize(o)),i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_NUMBER_WITH_PLUS_SIGN):(o=new RegExp(t),i18n.phonenumbers.PhoneNumberUtil.normalizeSB_(e),this.parsePrefixAsIdd_(o,e)?i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_NUMBER_WITH_IDD:i18n.phonenumbers.PhoneNumber.CountryCodeSource.FROM_DEFAULT_COUNTRY)},i18n.phonenumbers.PhoneNumberUtil.prototype.maybeStripNationalPrefixAndCarrierCode=function(e,t,o){var n=e.toString(),r=n.length,d=t.getNationalPrefixForParsing();if(0==r||null==d||0==d.length)return!1;var i=new RegExp("^(?:"+d+")");if(r=i.exec(n)){var d=new RegExp(t.getGeneralDesc().getNationalNumberPatternOrDefault()),a=i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(d,n),N=r.length-1;if(t=t.getNationalPrefixTransformRule(),null==t||0==t.length||null==r[N]||0==r[N].length){if(a&&!i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(d,n.substring(r[0].length)))return!1;null!=o&&0<N&&null!=r[N]&&o.append(r[1]),e.set(n.substring(r[0].length))}else{if(n=n.replace(i,t),a&&!i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_(d,n))return!1;
null!=o&&0<N&&o.append(r[1]),e.set(n)}return!0}return!1},i18n.phonenumbers.PhoneNumberUtil.prototype.maybeStripExtension=function(e){var t=e.toString(),o=t.search(i18n.phonenumbers.PhoneNumberUtil.EXTN_PATTERN_);if(0<=o&&i18n.phonenumbers.PhoneNumberUtil.isViablePhoneNumber(t.substring(0,o)))for(var n=t.match(i18n.phonenumbers.PhoneNumberUtil.EXTN_PATTERN_),r=n.length,d=1;d<r;++d)if(null!=n[d]&&0<n[d].length)return e.clear(),e.append(t.substring(0,o)),n[d];return""},i18n.phonenumbers.PhoneNumberUtil.prototype.checkRegionForParsing_=function(e,t){return this.isValidRegionCode_(t)||null!=e&&0<e.length&&i18n.phonenumbers.PhoneNumberUtil.LEADING_PLUS_CHARS_PATTERN_.test(e)},i18n.phonenumbers.PhoneNumberUtil.prototype.parse=function(e,t){return this.parseHelper_(e,t,!1,!0)},i18n.phonenumbers.PhoneNumberUtil.prototype.parseAndKeepRawInput=function(e,t){if(!this.isValidRegionCode_(t)&&0<e.length&&e.charAt(0)!=i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN)throw Error(i18n.phonenumbers.Error.INVALID_COUNTRY_CODE);return this.parseHelper_(e,t,!0,!0)},i18n.phonenumbers.PhoneNumberUtil.prototype.setItalianLeadingZerosForPhoneNumber_=function(e,t){if(1<e.length&&"0"==e.charAt(0)){t.setItalianLeadingZero(!0);for(var o=1;o<e.length-1&&"0"==e.charAt(o);)o++;1!=o&&t.setNumberOfLeadingZeros(o)}},i18n.phonenumbers.PhoneNumberUtil.prototype.parseHelper_=function(e,t,o,n){if(null==e)throw Error(i18n.phonenumbers.Error.NOT_A_NUMBER);if(e.length>i18n.phonenumbers.PhoneNumberUtil.MAX_INPUT_STRING_LENGTH_)throw Error(i18n.phonenumbers.Error.TOO_LONG);var r=new goog.string.StringBuffer;if(this.buildNationalNumberForParsing_(e,r),!i18n.phonenumbers.PhoneNumberUtil.isViablePhoneNumber(r.toString()))throw Error(i18n.phonenumbers.Error.NOT_A_NUMBER);if(n&&!this.checkRegionForParsing_(r.toString(),t))throw Error(i18n.phonenumbers.Error.INVALID_COUNTRY_CODE);n=new i18n.phonenumbers.PhoneNumber,o&&n.setRawInput(e),e=this.maybeStripExtension(r),0<e.length&&n.setExtension(e),e=this.getMetadataForRegion(t);var d=new goog.string.StringBuffer,i=0,a=r.toString();try{i=this.maybeExtractCountryCode(a,e,d,o,n)}catch(t){if(t.message!=i18n.phonenumbers.Error.INVALID_COUNTRY_CODE||!i18n.phonenumbers.PhoneNumberUtil.LEADING_PLUS_CHARS_PATTERN_.test(a))throw t;if(a=a.replace(i18n.phonenumbers.PhoneNumberUtil.LEADING_PLUS_CHARS_PATTERN_,""),i=this.maybeExtractCountryCode(a,e,d,o,n),0==i)throw t}if(0!=i?(r=this.getRegionCodeForCountryCode(i),r!=t&&(e=this.getMetadataForRegionOrCallingCode_(i,r))):(i18n.phonenumbers.PhoneNumberUtil.normalizeSB_(r),d.append(r.toString()),null!=t?(i=e.getCountryCodeOrDefault(),n.setCountryCode(i)):o&&n.clearCountryCodeSource()),d.getLength()<i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_FOR_NSN_)throw Error(i18n.phonenumbers.Error.TOO_SHORT_NSN);if(null!=e&&(t=new goog.string.StringBuffer,r=new goog.string.StringBuffer(d.toString()),this.maybeStripNationalPrefixAndCarrierCode(r,e,t),this.isShorterThanPossibleNormalNumber_(e,r.toString())||(d=r,o&&n.setPreferredDomesticCarrierCode(t.toString()))),o=d.toString(),t=o.length,t<i18n.phonenumbers.PhoneNumberUtil.MIN_LENGTH_FOR_NSN_)throw Error(i18n.phonenumbers.Error.TOO_SHORT_NSN);if(t>i18n.phonenumbers.PhoneNumberUtil.MAX_LENGTH_FOR_NSN_)throw Error(i18n.phonenumbers.Error.TOO_LONG);return this.setItalianLeadingZerosForPhoneNumber_(o,n),n.setNationalNumber(parseInt(o,10)),n},i18n.phonenumbers.PhoneNumberUtil.prototype.buildNationalNumberForParsing_=function(e,t){var o=e.indexOf(i18n.phonenumbers.PhoneNumberUtil.RFC3966_PHONE_CONTEXT_);if(0<o){var n=o+i18n.phonenumbers.PhoneNumberUtil.RFC3966_PHONE_CONTEXT_.length;if(e.charAt(n)==i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN){var r=e.indexOf(";",n);0<r?t.append(e.substring(n,r)):t.append(e.substring(n))}n=e.indexOf(i18n.phonenumbers.PhoneNumberUtil.RFC3966_PREFIX_),t.append(e.substring(0<=n?n+i18n.phonenumbers.PhoneNumberUtil.RFC3966_PREFIX_.length:0,o))}else t.append(i18n.phonenumbers.PhoneNumberUtil.extractPossibleNumber(e));o=t.toString(),n=o.indexOf(i18n.phonenumbers.PhoneNumberUtil.RFC3966_ISDN_SUBADDRESS_),0<n&&(t.clear(),t.append(o.substring(0,n)))},i18n.phonenumbers.PhoneNumberUtil.prototype.isNumberMatch=function(e,t){var o,n;if("string"==typeof e)try{o=this.parse(e,i18n.phonenumbers.PhoneNumberUtil.UNKNOWN_REGION_)}catch(n){if(n.message!=i18n.phonenumbers.Error.INVALID_COUNTRY_CODE)return i18n.phonenumbers.PhoneNumberUtil.MatchType.NOT_A_NUMBER;if("string"!=typeof t){var r=this.getRegionCodeForCountryCode(t.getCountryCodeOrDefault());if(r!=i18n.phonenumbers.PhoneNumberUtil.UNKNOWN_REGION_){try{o=this.parse(e,r)}catch(e){return i18n.phonenumbers.PhoneNumberUtil.MatchType.NOT_A_NUMBER}return o=this.isNumberMatch(o,t),o==i18n.phonenumbers.PhoneNumberUtil.MatchType.EXACT_MATCH?i18n.phonenumbers.PhoneNumberUtil.MatchType.NSN_MATCH:o}}try{o=this.parseHelper_(e,null,!1,!1)}catch(e){return i18n.phonenumbers.PhoneNumberUtil.MatchType.NOT_A_NUMBER}}else o=e.clone();if("string"==typeof t)try{return n=this.parse(t,i18n.phonenumbers.PhoneNumberUtil.UNKNOWN_REGION_),this.isNumberMatch(e,n)}catch(e){return e.message!=i18n.phonenumbers.Error.INVALID_COUNTRY_CODE?i18n.phonenumbers.PhoneNumberUtil.MatchType.NOT_A_NUMBER:this.isNumberMatch(t,o)}else n=t.clone();if(o.clearRawInput(),o.clearCountryCodeSource(),o.clearPreferredDomesticCarrierCode(),n.clearRawInput(),n.clearCountryCodeSource(),n.clearPreferredDomesticCarrierCode(),o.hasExtension()&&0==o.getExtension().length&&o.clearExtension(),n.hasExtension()&&0==n.getExtension().length&&n.clearExtension(),o.hasExtension()&&n.hasExtension()&&o.getExtension()!=n.getExtension())return i18n.phonenumbers.PhoneNumberUtil.MatchType.NO_MATCH;var r=o.getCountryCodeOrDefault(),d=n.getCountryCodeOrDefault();return 0!=r&&0!=d?o.equals(n)?i18n.phonenumbers.PhoneNumberUtil.MatchType.EXACT_MATCH:r==d&&this.isNationalNumberSuffixOfTheOther_(o,n)?i18n.phonenumbers.PhoneNumberUtil.MatchType.SHORT_NSN_MATCH:i18n.phonenumbers.PhoneNumberUtil.MatchType.NO_MATCH:(o.setCountryCode(0),n.setCountryCode(0),o.equals(n)?i18n.phonenumbers.PhoneNumberUtil.MatchType.NSN_MATCH:this.isNationalNumberSuffixOfTheOther_(o,n)?i18n.phonenumbers.PhoneNumberUtil.MatchType.SHORT_NSN_MATCH:i18n.phonenumbers.PhoneNumberUtil.MatchType.NO_MATCH)},i18n.phonenumbers.PhoneNumberUtil.prototype.isNationalNumberSuffixOfTheOther_=function(e,t){var o=""+e.getNationalNumber(),n=""+t.getNationalNumber();return goog.string.endsWith(o,n)||goog.string.endsWith(n,o)},i18n.phonenumbers.PhoneNumberUtil.prototype.canBeInternationallyDialled=function(e){var t=this.getMetadataForRegion(this.getRegionCodeForNumber(e));return null==t||(e=this.getNationalSignificantNumber(e),!this.isNumberMatchingDesc_(e,t.getNoInternationalDialling()))},i18n.phonenumbers.PhoneNumberUtil.matchesEntirely_=function(e,t){var o="string"==typeof e?t.match("^(?:"+e+")$"):t.match(e);return!(!o||o[0].length!=t.length)},i18n.phonenumbers.AsYouTypeFormatter=function(e){this.DIGIT_PLACEHOLDER_=" ",this.DIGIT_PATTERN_=new RegExp(this.DIGIT_PLACEHOLDER_),this.currentOutput_="",this.formattingTemplate_=new goog.string.StringBuffer,this.currentFormattingPattern_="",this.accruedInput_=new goog.string.StringBuffer,this.accruedInputWithoutFormatting_=new goog.string.StringBuffer,this.ableToFormat_=!0,this.isExpectingCountryCallingCode_=this.isCompleteNumber_=this.inputHasFormatting_=!1,this.phoneUtil_=i18n.phonenumbers.PhoneNumberUtil.getInstance(),this.positionToRemember_=this.originalPosition_=this.lastMatchPosition_=0,this.prefixBeforeNationalNumber_=new goog.string.StringBuffer,this.shouldAddSpaceAfterNationalPrefix_=!1,this.extractedNationalPrefix_="",this.nationalNumber_=new goog.string.StringBuffer,this.possibleFormats_=[],this.defaultCountry_=e,this.defaultMetadata_=this.currentMetadata_=this.getMetadataForRegion_(this.defaultCountry_)},i18n.phonenumbers.AsYouTypeFormatter.SEPARATOR_BEFORE_NATIONAL_NUMBER_=" ",i18n.phonenumbers.AsYouTypeFormatter.EMPTY_METADATA_=new i18n.phonenumbers.PhoneMetadata,i18n.phonenumbers.AsYouTypeFormatter.EMPTY_METADATA_.setInternationalPrefix("NA"),i18n.phonenumbers.AsYouTypeFormatter.CHARACTER_CLASS_PATTERN_=/\[([^\[\]])*\]/g,i18n.phonenumbers.AsYouTypeFormatter.STANDALONE_DIGIT_PATTERN_=/\d(?=[^,}][^,}])/g,i18n.phonenumbers.AsYouTypeFormatter.ELIGIBLE_FORMAT_PATTERN_=new RegExp("^["+i18n.phonenumbers.PhoneNumberUtil.VALID_PUNCTUATION+"]*(\\$\\d["+i18n.phonenumbers.PhoneNumberUtil.VALID_PUNCTUATION+"]*)+$"),i18n.phonenumbers.AsYouTypeFormatter.NATIONAL_PREFIX_SEPARATORS_PATTERN_=/[- ]/,i18n.phonenumbers.AsYouTypeFormatter.MIN_LEADING_DIGITS_LENGTH_=3,i18n.phonenumbers.AsYouTypeFormatter.prototype.getMetadataForRegion_=function(e){return e=this.phoneUtil_.getCountryCodeForRegion(e),e=this.phoneUtil_.getRegionCodeForCountryCode(e),e=this.phoneUtil_.getMetadataForRegion(e),null!=e?e:i18n.phonenumbers.AsYouTypeFormatter.EMPTY_METADATA_},i18n.phonenumbers.AsYouTypeFormatter.prototype.maybeCreateNewTemplate_=function(){for(var e=this.possibleFormats_.length,t=0;t<e;++t){var o=this.possibleFormats_[t],n=o.getPatternOrDefault();if(this.currentFormattingPattern_==n)return!1;if(this.createFormattingTemplate_(o))return this.currentFormattingPattern_=n,this.shouldAddSpaceAfterNationalPrefix_=i18n.phonenumbers.AsYouTypeFormatter.NATIONAL_PREFIX_SEPARATORS_PATTERN_.test(o.getNationalPrefixFormattingRule()),this.lastMatchPosition_=0,!0}return this.ableToFormat_=!1},i18n.phonenumbers.AsYouTypeFormatter.prototype.getAvailableFormats_=function(e){for(var t=this.isCompleteNumber_&&0<this.currentMetadata_.intlNumberFormatCount()?this.currentMetadata_.intlNumberFormatArray():this.currentMetadata_.numberFormatArray(),o=t.length,n=0;n<o;++n){var r=t[n];(!this.currentMetadata_.hasNationalPrefix()||this.isCompleteNumber_||r.getNationalPrefixOptionalWhenFormatting()||this.phoneUtil_.formattingRuleHasFirstGroupOnly(r.getNationalPrefixFormattingRuleOrDefault()))&&this.isFormatEligible_(r.getFormatOrDefault())&&this.possibleFormats_.push(r)}this.narrowDownPossibleFormats_(e)},i18n.phonenumbers.AsYouTypeFormatter.prototype.isFormatEligible_=function(e){return i18n.phonenumbers.AsYouTypeFormatter.ELIGIBLE_FORMAT_PATTERN_.test(e)},i18n.phonenumbers.AsYouTypeFormatter.prototype.narrowDownPossibleFormats_=function(e){for(var t=[],o=e.length-i18n.phonenumbers.AsYouTypeFormatter.MIN_LEADING_DIGITS_LENGTH_,n=this.possibleFormats_.length,r=0;r<n;++r){var d=this.possibleFormats_[r];if(0==d.leadingDigitsPatternCount())t.push(this.possibleFormats_[r]);else{var i=Math.min(o,d.leadingDigitsPatternCount()-1),d=d.getLeadingDigitsPattern(i);0==e.search(d)&&t.push(this.possibleFormats_[r])}}this.possibleFormats_=t},i18n.phonenumbers.AsYouTypeFormatter.prototype.createFormattingTemplate_=function(e){var t=e.getPatternOrDefault();return-1==t.indexOf("|")&&(t=t.replace(i18n.phonenumbers.AsYouTypeFormatter.CHARACTER_CLASS_PATTERN_,"\\d"),t=t.replace(i18n.phonenumbers.AsYouTypeFormatter.STANDALONE_DIGIT_PATTERN_,"\\d"),this.formattingTemplate_.clear(),e=this.getFormattingTemplate_(t,e.getFormatOrDefault()),0<e.length&&(this.formattingTemplate_.append(e),!0))},i18n.phonenumbers.AsYouTypeFormatter.prototype.getFormattingTemplate_=function(e,t){var o="999999999999999".match(e)[0];return o.length<this.nationalNumber_.getLength()?"":(o=o.replace(new RegExp(e,"g"),t),o=o.replace(RegExp("9","g"),this.DIGIT_PLACEHOLDER_))},i18n.phonenumbers.AsYouTypeFormatter.prototype.clear=function(){this.currentOutput_="",this.accruedInput_.clear(),this.accruedInputWithoutFormatting_.clear(),this.formattingTemplate_.clear(),this.lastMatchPosition_=0,this.currentFormattingPattern_="",this.prefixBeforeNationalNumber_.clear(),this.extractedNationalPrefix_="",this.nationalNumber_.clear(),this.ableToFormat_=!0,this.inputHasFormatting_=!1,this.originalPosition_=this.positionToRemember_=0,this.isExpectingCountryCallingCode_=this.isCompleteNumber_=!1,this.possibleFormats_=[],this.shouldAddSpaceAfterNationalPrefix_=!1,this.currentMetadata_!=this.defaultMetadata_&&(this.currentMetadata_=this.getMetadataForRegion_(this.defaultCountry_))},i18n.phonenumbers.AsYouTypeFormatter.prototype.inputDigit=function(e){return this.currentOutput_=this.inputDigitWithOptionToRememberPosition_(e,!1)},i18n.phonenumbers.AsYouTypeFormatter.prototype.inputDigitAndRememberPosition=function(e){return this.currentOutput_=this.inputDigitWithOptionToRememberPosition_(e,!0)},i18n.phonenumbers.AsYouTypeFormatter.prototype.inputDigitWithOptionToRememberPosition_=function(e,t){if(this.accruedInput_.append(e),t&&(this.originalPosition_=this.accruedInput_.getLength()),this.isDigitOrLeadingPlusSign_(e)?e=this.normalizeAndAccrueDigitsAndPlusSign_(e,t):(this.ableToFormat_=!1,this.inputHasFormatting_=!0),!this.ableToFormat_){if(!this.inputHasFormatting_)if(this.attemptToExtractIdd_()){if(this.attemptToExtractCountryCallingCode_())return this.attemptToChoosePatternWithPrefixExtracted_()}else if(this.ableToExtractLongerNdd_())return this.prefixBeforeNationalNumber_.append(i18n.phonenumbers.AsYouTypeFormatter.SEPARATOR_BEFORE_NATIONAL_NUMBER_),this.attemptToChoosePatternWithPrefixExtracted_();return this.accruedInput_.toString()}switch(this.accruedInputWithoutFormatting_.getLength()){case 0:case 1:case 2:return this.accruedInput_.toString();case 3:if(!this.attemptToExtractIdd_())return this.extractedNationalPrefix_=this.removeNationalPrefixFromNationalNumber_(),this.attemptToChooseFormattingPattern_();this.isExpectingCountryCallingCode_=!0;default:if(this.isExpectingCountryCallingCode_)return this.attemptToExtractCountryCallingCode_()&&(this.isExpectingCountryCallingCode_=!1),this.prefixBeforeNationalNumber_.toString()+this.nationalNumber_.toString();if(0<this.possibleFormats_.length){var o=this.inputDigitHelper_(e),n=this.attemptToFormatAccruedDigits_();return 0<n.length?n:(this.narrowDownPossibleFormats_(this.nationalNumber_.toString()),this.maybeCreateNewTemplate_()?this.inputAccruedNationalNumber_():this.ableToFormat_?this.appendNationalNumber_(o):this.accruedInput_.toString())}return this.attemptToChooseFormattingPattern_()}},i18n.phonenumbers.AsYouTypeFormatter.prototype.attemptToChoosePatternWithPrefixExtracted_=function(){return this.ableToFormat_=!0,this.isExpectingCountryCallingCode_=!1,this.possibleFormats_=[],this.lastMatchPosition_=0,this.formattingTemplate_.clear(),this.currentFormattingPattern_="",this.attemptToChooseFormattingPattern_()},i18n.phonenumbers.AsYouTypeFormatter.prototype.getExtractedNationalPrefix_=function(){return this.extractedNationalPrefix_},i18n.phonenumbers.AsYouTypeFormatter.prototype.ableToExtractLongerNdd_=function(){if(0<this.extractedNationalPrefix_.length){var e=this.nationalNumber_.toString();this.nationalNumber_.clear(),this.nationalNumber_.append(this.extractedNationalPrefix_),this.nationalNumber_.append(e);var e=this.prefixBeforeNationalNumber_.toString(),t=e.lastIndexOf(this.extractedNationalPrefix_);this.prefixBeforeNationalNumber_.clear(),this.prefixBeforeNationalNumber_.append(e.substring(0,t))}return this.extractedNationalPrefix_!=this.removeNationalPrefixFromNationalNumber_()},i18n.phonenumbers.AsYouTypeFormatter.prototype.isDigitOrLeadingPlusSign_=function(e){return i18n.phonenumbers.PhoneNumberUtil.CAPTURING_DIGIT_PATTERN.test(e)||1==this.accruedInput_.getLength()&&i18n.phonenumbers.PhoneNumberUtil.PLUS_CHARS_PATTERN.test(e)},i18n.phonenumbers.AsYouTypeFormatter.prototype.attemptToFormatAccruedDigits_=function(){for(var e=this.nationalNumber_.toString(),t=this.possibleFormats_.length,o=0;o<t;++o){var n=this.possibleFormats_[o],r=n.getPatternOrDefault();if(new RegExp("^(?:"+r+")$").test(e))return this.shouldAddSpaceAfterNationalPrefix_=i18n.phonenumbers.AsYouTypeFormatter.NATIONAL_PREFIX_SEPARATORS_PATTERN_.test(n.getNationalPrefixFormattingRule()),e=e.replace(new RegExp(r,"g"),n.getFormat()),this.appendNationalNumber_(e)}return""},i18n.phonenumbers.AsYouTypeFormatter.prototype.appendNationalNumber_=function(e){var t=this.prefixBeforeNationalNumber_.getLength();return this.shouldAddSpaceAfterNationalPrefix_&&0<t&&this.prefixBeforeNationalNumber_.toString().charAt(t-1)!=i18n.phonenumbers.AsYouTypeFormatter.SEPARATOR_BEFORE_NATIONAL_NUMBER_?this.prefixBeforeNationalNumber_+i18n.phonenumbers.AsYouTypeFormatter.SEPARATOR_BEFORE_NATIONAL_NUMBER_+e:this.prefixBeforeNationalNumber_+e},i18n.phonenumbers.AsYouTypeFormatter.prototype.getRememberedPosition=function(){if(!this.ableToFormat_)return this.originalPosition_;for(var e=0,t=0,o=this.accruedInputWithoutFormatting_.toString(),n=this.currentOutput_.toString();e<this.positionToRemember_&&t<n.length;)o.charAt(e)==n.charAt(t)&&e++,t++;return t},i18n.phonenumbers.AsYouTypeFormatter.prototype.attemptToChooseFormattingPattern_=function(){var e=this.nationalNumber_.toString();return e.length>=i18n.phonenumbers.AsYouTypeFormatter.MIN_LEADING_DIGITS_LENGTH_?(this.getAvailableFormats_(e),e=this.attemptToFormatAccruedDigits_(),0<e.length?e:this.maybeCreateNewTemplate_()?this.inputAccruedNationalNumber_():this.accruedInput_.toString()):this.appendNationalNumber_(e)},i18n.phonenumbers.AsYouTypeFormatter.prototype.inputAccruedNationalNumber_=function(){var e=this.nationalNumber_.toString(),t=e.length;if(0<t){for(var o="",n=0;n<t;n++)o=this.inputDigitHelper_(e.charAt(n));return this.ableToFormat_?this.appendNationalNumber_(o):this.accruedInput_.toString()}return this.prefixBeforeNationalNumber_.toString()},i18n.phonenumbers.AsYouTypeFormatter.prototype.isNanpaNumberWithNationalPrefix_=function(){if(1!=this.currentMetadata_.getCountryCode())return!1;var e=this.nationalNumber_.toString();return"1"==e.charAt(0)&&"0"!=e.charAt(1)&&"1"!=e.charAt(1)},i18n.phonenumbers.AsYouTypeFormatter.prototype.removeNationalPrefixFromNationalNumber_=function(){var e=this.nationalNumber_.toString(),t=0;if(this.isNanpaNumberWithNationalPrefix_())t=1,this.prefixBeforeNationalNumber_.append("1").append(i18n.phonenumbers.AsYouTypeFormatter.SEPARATOR_BEFORE_NATIONAL_NUMBER_),this.isCompleteNumber_=!0;else if(this.currentMetadata_.hasNationalPrefixForParsing()){var o=new RegExp("^(?:"+this.currentMetadata_.getNationalPrefixForParsing()+")"),o=e.match(o);null!=o&&null!=o[0]&&0<o[0].length&&(this.isCompleteNumber_=!0,t=o[0].length,this.prefixBeforeNationalNumber_.append(e.substring(0,t)))}return this.nationalNumber_.clear(),this.nationalNumber_.append(e.substring(t)),e.substring(0,t)},i18n.phonenumbers.AsYouTypeFormatter.prototype.attemptToExtractIdd_=function(){var e=this.accruedInputWithoutFormatting_.toString(),t=new RegExp("^(?:\\"+i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN+"|"+this.currentMetadata_.getInternationalPrefix()+")"),t=e.match(t);return null!=t&&null!=t[0]&&0<t[0].length&&(this.isCompleteNumber_=!0,t=t[0].length,this.nationalNumber_.clear(),this.nationalNumber_.append(e.substring(t)),this.prefixBeforeNationalNumber_.clear(),this.prefixBeforeNationalNumber_.append(e.substring(0,t)),e.charAt(0)!=i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN&&this.prefixBeforeNationalNumber_.append(i18n.phonenumbers.AsYouTypeFormatter.SEPARATOR_BEFORE_NATIONAL_NUMBER_),!0)},i18n.phonenumbers.AsYouTypeFormatter.prototype.attemptToExtractCountryCallingCode_=function(){if(0==this.nationalNumber_.getLength())return!1;var e=new goog.string.StringBuffer,t=this.phoneUtil_.extractCountryCode(this.nationalNumber_,e);return 0!=t&&(this.nationalNumber_.clear(),this.nationalNumber_.append(e.toString()),e=this.phoneUtil_.getRegionCodeForCountryCode(t),i18n.phonenumbers.PhoneNumberUtil.REGION_CODE_FOR_NON_GEO_ENTITY==e?this.currentMetadata_=this.phoneUtil_.getMetadataForNonGeographicalRegion(t):e!=this.defaultCountry_&&(this.currentMetadata_=this.getMetadataForRegion_(e)),this.prefixBeforeNationalNumber_.append(""+t).append(i18n.phonenumbers.AsYouTypeFormatter.SEPARATOR_BEFORE_NATIONAL_NUMBER_),this.extractedNationalPrefix_="",!0)},i18n.phonenumbers.AsYouTypeFormatter.prototype.normalizeAndAccrueDigitsAndPlusSign_=function(e,t){var o;return e==i18n.phonenumbers.PhoneNumberUtil.PLUS_SIGN?(o=e,this.accruedInputWithoutFormatting_.append(e)):(o=i18n.phonenumbers.PhoneNumberUtil.DIGIT_MAPPINGS[e],this.accruedInputWithoutFormatting_.append(o),this.nationalNumber_.append(o)),t&&(this.positionToRemember_=this.accruedInputWithoutFormatting_.getLength()),o},i18n.phonenumbers.AsYouTypeFormatter.prototype.inputDigitHelper_=function(e){var t=this.formattingTemplate_.toString();if(0<=t.substring(this.lastMatchPosition_).search(this.DIGIT_PATTERN_)){var o=t.search(this.DIGIT_PATTERN_);return e=t.replace(this.DIGIT_PATTERN_,e),this.formattingTemplate_.clear(),this.formattingTemplate_.append(e),this.lastMatchPosition_=o,e.substring(0,this.lastMatchPosition_+1)}return 1==this.possibleFormats_.length&&(this.ableToFormat_=!1),this.currentFormattingPattern_="",this.accruedInput_.toString()},module.exports=i18n.phonenumbers.default=i18n.phonenumbers.libphonenumber=i18n.phonenumbers},{}]},{},[1])(1)});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}]},{},[1])(1)
});
window.LILY_FLOWS_APP = window.LILY_FLOWS_APP || {};
window.LILY_FLOWS_APP.LilyContactFlowINIT = function () {

LilyContactFlow = {};
LilyContactFlow.strings = window.localizedStrings['contact-flow-js'];
LilyContactFlow.getString = function(id) {
    return LilyContactFlow.strings[id];
};
LilyContactFlow.translateStatus = function(status) {
    switch (status) {
    case "Available":
        return LilyContactFlow.getString('lily-admin-contact-flow-status-available');
    case "Staffed":
        return LilyContactFlow.getString('lily-admin-contact-flow-status-staffed');
    case "Online":
        return LilyContactFlow.getString('lily-admin-contact-flow-status-online');
    default:
        return status;
    }
};
LilyContactFlow.translateNamespace = function(namespace) {
    // Lex.SessionAttributes -> lily-admin-contact-flow-namespace-lex-sessionattributes
    var translated = LilyContactFlow.getString('lily-admin-contact-flow-namespace-' + namespace.toLowerCase().split( /[\. ]/).join('-'));
    return translated ? translated : namespace;
};
LilyContactFlow.translateSystemAttribute = function(attr) {
    switch (attr) {
    case "Customer Number":
        return LilyContactFlow.getString('lily-admin-contact-flow-attr-cust-number');
    case "Dialed Number":
        return LilyContactFlow.getString('lily-admin-contact-flow-attr-dialed-number');
    case "Customer callback number":
        return LilyContactFlow.getString('lily-admin-contact-flow-attr-customer-callback');
    case "Stored customer input":
        return LilyContactFlow.getString('lily-admin-contact-flow-attr-stored-input');
    case "Lex.IntentName":
        if (LilyContactFlow.isFeatureEnabled('isConsolidatedLexAttributesEnabled')) {
            return LilyContactFlow.getString('lily-admin-contact-flow-attr-lex-intentname');
        }
        return LilyContactFlow.getString('lily-admin-contact-flow-attr-lex-intentname-system');
    default:
        // Metrics.Agents.NonProductive.Count -> lily-admin-contact-flow-attr-metrics-agents-nonproductive-count
        var translated = LilyContactFlow.getString('lily-admin-contact-flow-attr-' + attr.toLowerCase().split('.').join('-'));
        return translated ? translated : attr;
    }
};

LilyContactFlow.featureAccess = {};
LilyContactFlow.isFeatureEnabled = function(feature) {
    return LilyContactFlow.featureAccess[feature] === true;
};
LilyContactFlow.initializeFeatureAccess = function(features) {
    LilyContactFlow.featureAccess = _.extend(LilyContactFlow.featureAccess, features);
    LilyContactFlow.initializeBlockDefinition();
    LilyContactFlow.voiceService = new LilyContactFlow.VoiceService(LilyContactFlow.featureAccess.isAutoResolveToBestSoundingVoiceEnabled);
};

// Various backwards compatibility things:
// Backwards compatibility with v0.9
joint.shapes.devs.ModelView = joint.dia.ElementView.extend(joint.shapes.basic.PortsViewInterface);
// Chrome v57 renders SVGs too quickly, and we need to delay this method
LilyContactFlow.oldApplyPortTransform = joint.dia.ElementView.prototype.applyPortTransform;
joint.dia.ElementView.prototype.applyPortTransform = function(a,b,c) { _.defer(LilyContactFlow.oldApplyPortTransform.bind(this,a,b,c));};

// Useful for adding markup (like defs) to the SVG via JS
LilyContactFlow.jointVectorizer = V;
LilyContactFlow.ModuleType = {
    parent: "parent",
    child: "child",
    shadow: "shadow"
};
LilyContactFlow.Sizes = {
    ENTRY_POINT_MODULE_WIDTH: 91,
    ENTRY_POINT_MODULE_LABEL_WIDTH: 45,
    MODULE_WIDTH: 181,
    MODULE_LABEL_WIDTH: 114,
    MODULE_ICON_WIDTH: 40,
    MODULE_CLOSE_WIDTH: 40,
    BRANCH_HEIGHT: 30,
    BRANCH_SPACING: 40,
    HEADER_HEIGHT: 48,
    LABEL_HEIGHT: 30,
    ERROR_DETAIL_BASE_SIZE: 30,
    ERROR_DETAIL_EXPANDED_WIDTH: 485,
    GRID_SCALE: 1.15,
    TRIM_MARGIN:15,
    PAPER_MIN_WIDTH: 12000, //should have same value as width specified for #paper on edit.css
    PAPER_MIN_HEIGHT: 8000 //should have same value as height specified for #paper on edit.css
};
LilyContactFlow.Colors = {
    GENERAL_MODULE_HEADER_BACKGROUND_COLOR: "#E9F1F9",
    ENTRY_POINT_MODULE_HEADER_BACKGROUND_COLOR: "#417505",
    TT_MODULE_HEADER_BACKGROUND_COLOR: "#4A4A4A",
    GENERAL_MODULE_HEADER_FONT_COLOR: "#1166BB",
    ENTRY_POINT_MODULE_HEADER_FONT_COLOR: "#FFFFFF",
    TT_MODULE_HEADER_FONT_COLOR: "FFFFFFF",
    ERROR_STROKE_COLOR: "#D0011B",
    WARN_STROKE_COLOR: "#F9CF83",
    ERROR_FILL_COLOR: "#FDF9F9",
    WARN_FILL_COLOR: "#FEF6E8"
};
LilyContactFlow.ModuleDecompilerByType = {};
LilyContactFlow.ModuleFragmenterByType = {};
LilyContactFlow.ModuleDefragmenterByType = {};
LilyContactFlow.linkTargetArrowSvg = { stroke: '#1F62BD', fill: '#1F62BD', d: 'M 10 0 L 0 5 L 10 10 z'};
LilyContactFlow.linkConnectionSvg = { stroke: '#1F62BD', 'stroke-width': 2 };
LilyContactFlow.labelStyle = {'font-size': '11px', 'font-weight': 'bold'};
LilyContactFlow.SplitModuleByType = {};

LilyContactFlow.TransferToQueueModuleTypes = {
    CUSTOMER_IN_QUEUE: "CustomerInQueue",
    CREATE_CALL_BACK: "CreateCallback",
    TRANSFER_TO_QUEUE: "TransferToQueue"
};

LilyContactFlow.GetUserInputModelTargets = {
    DIGITS: "Digits",
    LEX: "Lex"
};
LilyContactFlow.StoreUserInputType = {
    CUSTOM: "Custom",
    PHONE_NUMBER: "PhoneNumber"
};
LilyContactFlow.PhoneNumberFormat = {
    LOCAL: "Local",
    INTERNATIONAL: "International"
};
LilyContactFlow.SetVoiceModuleDefaultValue = {
    VOICE: "Joanna",
    NTTS_VOICE: JSON.stringify({
                    voiceId : "Joanna",
                    engine : "Standard"
                }),
    ENGINE_NEURAL: "Neural",    
    ENGINE_STANDARD: "Standard",
    NTTS_STYLE_NEURAL_NONE: "None",
    NTTS_STYLE_CONVERSATIONAL: "Conversational",
    NTTS_STYLE_NEWSCASTER: "Newscaster"
};
LilyContactFlow.SetLoggingBehaviorModuleDefaultValue = {
    LOGGING_BEHAVIOR: "Enable"
};

LilyContactFlow.AttributeContactDataStrings = {
    SYSTEM_TYPE: "System",
    USER_DEFINED_TYPE: "User Defined",
    CONTACT_NAME: "Name",
    CONTACT_DESCRIPTION: "Description",
    LANGUAGE_CODE: "Language",
    CONTACT_REFERENCES: "References",
    REFERENCE_URL: "URL",
    CUSTOMER_ID: "CustomerId"
};

LilyContactFlow.getTopBranchPositionY = function(includeLabel) {
    var headerHeight = LilyContactFlow.Sizes.HEADER_HEIGHT;
    var labelHeight = includeLabel ? LilyContactFlow.Sizes.LABEL_HEIGHT : 0;
    var initialBranchOffset = LilyContactFlow.Sizes.BRANCH_SPACING / 2;
    return headerHeight + labelHeight + initialBranchOffset;
};

LilyContactFlow.getModuleHeight = function(numberOfInitialBranches, includeLabel) {
    var labelHeight = includeLabel ? LilyContactFlow.Sizes.LABEL_HEIGHT : 0;
    return labelHeight + LilyContactFlow.Sizes.BRANCH_SPACING * (numberOfInitialBranches + 0.5);
};

LilyContactFlow.formatPhoneNumber = function(value, format){
    var phoneUtil = window.libphonenumber.PhoneNumberUtil.getInstance();
    format = format || window.libphonenumber.PhoneNumberFormat.INTERNATIONAL;
    var formattedNumber = value;
    try {
        var number = phoneUtil.parseAndKeepRawInput(value, '');
        var regionCode = phoneUtil.getRegionCodeForNumber(number);
        var phoneNumber = phoneUtil.parse(value, regionCode);
        formattedNumber = phoneUtil.format(phoneNumber, format);
    } catch (err) {
        console.log(err);
    }
    return formattedNumber;
};

LilyContactFlow.svgRectContainsPoint = function(element, domX, domY) {
    var svgRect = element.getBoundingClientRect();
    // Chrome doesn't automatically scale the svgRectangle (but only for foreignObject tags!)
    //  based on browser zoom level, see https://bugs.chromium.org/p/chromium/issues/detail?id=429140#c8
    if ((element.tagName === "foreignObject" || $(element).parents().get().some(function(elem){return elem.tagName === "foreignObject";})) &&
          navigator.userAgent.indexOf("Chrome") !== -1) {
        ["x", "y", "top", "bottom", "left", "right", "width", "height"].forEach(function(key) {
            svgRect[key] /= window.devicePixelRatio;
        });
    }
    var svgPosition = $("#paper>svg")[0].getBoundingClientRect();
    var svgX = (domX*LilyContactFlow.graphScale) + svgPosition.left;
    var svgY = (domY*LilyContactFlow.graphScale) + svgPosition.top;
    return svgRect.top <= svgY && svgRect.bottom >= svgY &&
           svgRect.left <= svgX && svgRect.right >= svgX;
};

LilyContactFlow.basicModuleOptions = function(x, y) {
    return {
        position: {x: x, y: y},
        inPorts: ['in'],
        attrs: {
            '.inPorts circle': { magnet: 'passive', type: 'input'},
            type: 'parent',
            '.label': { 'text': ''}
        },
        ports: {
            groups: {
                'in': {
                    attrs:{
                        '.port-body':{
                            fill: 'white',
                            stroke: 'white',
                            r: '5',
                            magnet: 'passive'
                        }
                    }

                }
            }
        },
        toAngular: function() {
        },
        fromAngular: function() {
        },
        getType: function() {
            return null;
        },
        getParameters: function() {
            return [];
        },
        getMetadata: function() {
            return {};
        }
    };
};

LilyContactFlow.combineModules = function(modules) {
    _.forEach(modules, function(module) {
        if (module) {
            switch (module.type) {
                case "SetAttributes":
                    // Combining all SetContactData modules into SetAttributes module
                    // If branch:Success is SetContactData
                    //          Add SetContactData parameters to SetAttribute
                    //          Change SetAttribute.branch.success to SetContactData.branch.success
                    //          Delete SetContactData module from modules.
                    var successBranch = module.branches.find(function (branch) {
                        return branch.condition === "Success";
                    });
                    var nextModuleIndex = modules.findIndex(function (module) {
                        return module.id === successBranch.transition;
                    });
                    var nextModule = modules[nextModuleIndex];
                    if (module.metadata.isSplitModule && nextModule && nextModule.type === "SetContactData") {
                        module.parameters.push.apply(module.parameters, nextModule.parameters);
                        successBranch.transition = nextModule.branches.find(function (branch) {
                            return branch.condition === "Success";
                        }).transition;
                        modules.splice(nextModuleIndex, 1);
                    }
                    break;
                case "SetContactData":
                    if(!module.metadata.isSplitModule) {
                        module.type = "SetAttributes";
                    }
                    break;
            }
        }
    });
};

LilyContactFlow.defragmentModule = function(module, fragments) {
    var defragmenter = LilyContactFlow.ModuleDefragmenterByType[module.type];
    if(defragmenter) {
        return defragmenter(module, fragments);
    }
    return module;
};

LilyContactFlow.defragmentContactFlow = function(contactFlow) {
    var clonedModules = _.clone(contactFlow.modules);
    var isIdInFragments = function(module) {
      return this.fragmentIds.includes(module.id);
    };

    _.forEach(clonedModules, function(module) {
        // if the module metadata indicates that it was fragmented, then de-fragment the module
        if (!_.isEmpty(module.metadata.fragments)) {
            var fragmentIds = _.values(module.metadata.fragments);
            var fragments = _.filter(contactFlow.modules, isIdInFragments, { fragmentIds: fragmentIds });
            var defragmentedModule = LilyContactFlow.defragmentModule(module, fragments);
            var otherModules = _.reject(contactFlow.modules, isIdInFragments, { fragmentIds: _.union(fragmentIds, [module.id]) });
            contactFlow.modules = _.union(otherModules, [defragmentedModule]);
        }
    });
    return contactFlow;
};

LilyContactFlow.deserializeContactFlow = function(data, callback, omitEntryPoint, checkInvalidModules) {
    callback = callback || function(){};
    var contactFlow = typeof data === "string"? JSON.parse(data):data;
    contactFlow = LilyContactFlow.defragmentContactFlow(contactFlow);
    LilyContactFlow.oldFlow = false;
    var invalidModule = false;
    if (!contactFlow.type) {
        // if the type field is not present, the user has not saved or published this flow recently
        // use this boolean to encourage them to re-save/publish
        LilyContactFlow.oldFlow = true;
    }
    var nodes = [];
    var links = [];
    LilyContactFlow.combineModules(contactFlow.modules);
    _.forEach(contactFlow.modules, function(module) {
        // in the v2 flow language modules are not required to have metadata
        // in order to get the block to render in the UI, create a dummy metadata object
        if (!module.metadata) {
            module.metadata = {};
        }
        if (!module.metadata.position) {
            module.metadata = _.extend(module.metadata, {
                position: {
                    x: 0,
                    y: 0
                }
            });
        }
        if (module.type === "DisableCallRecording") {
            // Legacy version 1
            LilyContactFlow.translateRecordingModuleToNewFromVersion1(module);
        } else if (LilyContactFlow.isParameterExist(module, "RecordingBehaviorOption", "Disable")) {
            // Legacy version 2 and new version with RecordingBehaviorOption===Disable
            LilyContactFlow.translateRecordingModuleToNewFromVersion2(module);
        }

        var createFunction = LilyContactFlow.ModuleDecompilerByType[module.type];
        if (!createFunction) {
            invalidModule = true;
            return !checkInvalidModules;
        }

        var newNodes = createFunction(module);
        var newLinks = [];
        // Set up connections
        _.forEach(module.branches, function(branch) { 
            var target = branch.transition;
            var source = null;
            _.forEach(newNodes, function(node) {
                if (node.attributes.type === "branch") {
                    var nodeCondition = node.attributes.getCondition();
                    var stringConditionMatches = !(_.isObject(nodeCondition)) && nodeCondition === branch.condition;
                    var objectConditionMatches = _.isObject(nodeCondition) && nodeCondition.conditionType === branch.conditionType && nodeCondition.conditionValue === branch.conditionValue;
                    if (stringConditionMatches || objectConditionMatches && 
                            source == null && // Use the first that matches 
                            !newLinks.some(function(n) { return node.id === n.attributes.source.id; })) { // Don't link to a node that's already hooked up
                        source = node;
                    }
                }
            });
            if (!target || !source) {
                return;
            }
            newLinks.push(LilyContactFlow.createLink(source.id, target));
        });
        nodes = nodes.concat(newNodes);
        links = links.concat(newLinks);
    });
    if(!omitEntryPoint){
        var entryPointPosition = LilyContactFlow.entryPointNode.get("position");
        _.each(contactFlow.metadata, function(metadata) {
            if (metadata && metadata.entryPointPosition) {
                entryPointPosition = metadata.entryPointPosition;
            }
        });
        if (contactFlow.metadata && contactFlow.metadata.entryPointPosition) {
            entryPointPosition = contactFlow.metadata.entryPointPosition;
        }
        LilyContactFlow.entryPointNode.set("position", entryPointPosition);
        var entryPointStartBranchId = null;
        _.each(LilyContactFlow.entryPointNode.getEmbeddedCells(), function(cell) {
            LilyContactFlow.updateChildPositions(cell);
            if (cell.attributes.getCondition() === "Start") {
                entryPointStartBranchId = cell.id;
            }
        });
        var snapToGrid = false;
        _.each(contactFlow.metadata, function(metadata) {
            if (metadata && metadata.snapToGrid) {
                snapToGrid = metadata.snapToGrid;
            }
        });
        if (contactFlow.metadata && contactFlow.metadata.snapToGrid) {
            snapToGrid = contactFlow.metadata.snapToGrid;
        }
        LilyContactFlow.enableSnapToGrid(snapToGrid);
        links.push(LilyContactFlow.createLink(entryPointStartBranchId, contactFlow.start));
    }
    if(!checkInvalidModules || !invalidModule){
        LilyContactFlow.graph.addCells(nodes);
    }
    // Give the nodes time to render before adding the links, so they are aligned properly
    _.defer(function() {
        if(!checkInvalidModules || !invalidModule){
            LilyContactFlow.graph.addCells(links);
        }
        callback(nodes, invalidModule);
    });
};

LilyContactFlow.createLink = function(source, target) {
    return new joint.dia.Link({
        source: {id: source, port:'out'},
        target: {id: target, port:'in'},
        // Only route against module types
        router: { name: 'manhattan', args: { excludeTypes: ['basic.Text','basic.Rect', 'link', 'branch'], startDirections: ['right'], endDirections: ['left', 'top', 'bottom'] } },
        connector: { name: 'rounded' },
        attrs: {
            '.marker-target': LilyContactFlow.linkTargetArrowSvg,
            '.connection': LilyContactFlow.linkConnectionSvg
        }
    });
};

LilyContactFlow.jsonifyModule = function(node, isFragment){
    var cell = isFragment ? node.attributes : node;
    if(cell.id === LilyContactFlow.entryPointNode.id){
        return false;
    }

    var type = null;
    // Transfer types are special
    if (cell.getType() === "CustomerInQueue" ||
        cell.getType() === "TransferToFlow" ||
        cell.getType() === "LockAgent") {
        type = "Transfer";
    }

    var moduleJson = {
        id: cell.id,
        type: type ? type : cell.getType(),
        branches: [],
        parameters: isFragment ? cell.getParameters(node) : cell.getParameters(),
        metadata: isFragment ? cell.getMetadata(node) : _.extend({
            position: cell.position
        }, cell.getMetadata())
    };

    if(cell.getTarget && cell.getTarget()){
        moduleJson.target = cell.getTarget();
    }

    return moduleJson;
};

LilyContactFlow.jsonifyBranch = function(cell){
    var branch;
    if (!_.isObject(cell.getCondition())) {
        branch = {
            condition: cell.getCondition(),
            transition: null,
            parent: cell.parent
        };
    } else {
        branch = _.extend(cell.getCondition(), {
            transition: null,
            parent: cell.parent
        });
    }

    return branch;
};
LilyContactFlow.serializedJsonsProcessor = function(modulesById, branches, type, excludeEntryPoint, viewPosition){
    var entryPointIncomingTarget = null;
    var modules = [];
    var entryPoint = LilyContactFlow.entryPointNode;
    var entryPointPosition = entryPoint.position();
    _.each(branches, function(branch) {
        var trimmedBranch = _.clone(branch);
        delete trimmedBranch.parent;

        if (branch.parent !== entryPoint.id) {
            modulesById[branch.parent].branches.push(trimmedBranch);
        } else if(!excludeEntryPoint){
            entryPointIncomingTarget = trimmedBranch.transition;
        }
    });

    _.each(modulesById, function(module) {
        var fragmenterFunction = LilyContactFlow.ModuleFragmenterByType[module.type];
        var splitModule = LilyContactFlow.SplitModuleByType[module.type];
        if (splitModule) {
            splitModule(module, modules);
        } else if(fragmenterFunction) {
            var fragments = fragmenterFunction(module);
            modules = _.union(modules, fragments);
        } else {
            modules.push(module);
        }
    });
    var serializedJSON = {
        modules:modules,
        version:"1",
        type: type,
        start: entryPointIncomingTarget || "",
        metadata: {
            "entryPointPosition": excludeEntryPoint? null:entryPointPosition,
            "snapToGrid": LilyContactFlow.shouldGridSnap()
        }
    };

    if(viewPosition){
        serializedJSON.metadata.viewPosition = viewPosition;
    }
    
    return JSON.stringify(serializedJSON);
};

LilyContactFlow.serializeContactFlow = function(isPublished, type) {
    var graphJson = LilyContactFlow.graph.toJSON();
    var modulesById = {};
    var branches = {};
    var links = [];
    _.forEach(graphJson.cells, function(cell) {
        if (cell.type === "module") {
            var moduleJson = LilyContactFlow.jsonifyModule(cell);
            if(!moduleJson){
                return;
            }
            modulesById[cell.id] = moduleJson;
        } else if (cell.type === "branch") {
            var branch = LilyContactFlow.jsonifyBranch(cell);
            branches[cell.id] = branch;
        } else if (cell.type === "link") {
            links.push(cell);
        }
    });
    _.each(links, function(link) {
        var target = link.target ? link.target.id : null;
        branches[link.source.id].transition = target;
    });

    return LilyContactFlow.serializedJsonsProcessor(modulesById, branches, type);
};

LilyContactFlow.sortOutputNodes = function(lhs, rhs) {
    return lhs.attr("offsetY") - rhs.attr("offsetY");
};

LilyContactFlow.isCellAttrType = function(cell, type) {
    return cell.model.attr("type") === type;
};
LilyContactFlow.isModelAttrType = function(model, type) {
    return model.attr("type") === type;
};

LilyContactFlow.initializePaper = function(interactive) {
    LilyContactFlow.initializedInteractive = interactive;
    LilyContactFlow.canvasOffset = null;
    LilyContactFlow.canvasBlankClicking = false;
    LilyContactFlow.curStartXPos = null;
    LilyContactFlow.curStartYPos = null;
    LilyContactFlow.graphScale = 1;
    LilyContactFlow.hasPaperChanged = false;
    LilyContactFlow.deleteWasDown = false; // Prevent deleting event from propagating to below module
    LilyContactFlow.errorCellIds = [];
    LilyContactFlow.errorBranchIds = [];
    LilyContactFlow.graph = new joint.dia.Graph();
    LilyContactFlow.paper = new joint.dia.Paper({
        el: $('#paper'),
        width: "100%",
        height: "100%",
        gridSize: 1,
        clickThreshold: 1, // Allow one pixel mouse movement before suppressing "click" event
        model: LilyContactFlow.graph,
        validateConnection: function(cellSource, magnetSource, cellTarget, magnetTarget) {
            if (magnetSource && magnetSource.getAttribute('port-group') === 'in') {
                return false;
            }
            if (cellSource.model.get(LilyContactFlow.ModuleType.parent) === cellTarget.model.id) {
                return false;
            }
            return magnetTarget && magnetTarget.getAttribute('port-group') === 'in';
        },
        snapLinks: {radius: 75},
        defaultLink: new joint.dia.Link({
            connector: { name: 'rounded' },
            router: { name: 'manhattan' },
            attrs: {
                '.marker-target': LilyContactFlow.linkTargetArrowSvg,
                '.connection': LilyContactFlow.linkConnectionSvg
            }
        }),
        interactive: function(cellView) {
            if(!interactive){
                return false;
            } else {
                if (cellView.model instanceof joint.dia.Link) {
                    return { vertexAdd: false };
                }
                return true;
            }
        },
        validateMagnet: function(cellView, magnet) {
            var port = magnet.getAttribute('port');
            var links = LilyContactFlow.graph.getConnectedLinks(cellView.model, { outbound: true });
            var portLinks = _.filter(links, function(o) {
                return o.get('source').port === port;
            });
            if(portLinks.length > 0) {return false;}
            return magnet.getAttribute('magnet') !== 'passive';
        }
    });
    // See https://developer.mozilla.org/en-US/docs/Web/SVG/Element/feGaussianBlur
    LilyContactFlow.getDropShadowFilter = function() {
        return LilyContactFlow.jointVectorizer([
            '<filter id="dropShadow">',
                '<feGaussianBlur in="SourceAlpha" stdDeviation="3" />',
                '<feOffset dx="2" dy="2" />',
                '<feComponentTransfer>',
                    '<feFuncA type="linear" slope="0.5"/>',
                '</feComponentTransfer>',
                '<feMerge>',
                    '<feMergeNode />',
                    '<feMergeNode in="SourceGraphic" />',
                '</feMerge>',
            '</filter>'
        ].join(''));
    };
    LilyContactFlow.jointVectorizer(LilyContactFlow.paper.svg).defs().append(LilyContactFlow.getDropShadowFilter());

    LilyContactFlow.getErrorDropShadowFilter = function() {
        return LilyContactFlow.jointVectorizer([
            '<filter id="errorDropShadow">',
              '<feComponentTransfer in="SourceAlpha" result="color">',
                '<feFuncR tableValues="1" type="discrete"/>',
                '<feFuncG tableValues="0" type="discrete"/>',
                '<feFuncB tableValues="0" type="discrete"/>',
              '</feComponentTransfer>',
              '<feGaussianBlur in="color" stdDeviation="3" result="blurFilter"/>',
              '<feMerge>',
                '<feMergeNode in="blurFilter"/>',
                '<feMergeNode in="SourceGraphic"/>',
              '</feMerge>',
            '</filter>'
        ].join(''));
    };
    LilyContactFlow.jointVectorizer(LilyContactFlow.paper.svg).defs().append(LilyContactFlow.getErrorDropShadowFilter());

    LilyContactFlow.getWarnDropShadowFilter = function() {
            return LilyContactFlow.jointVectorizer([
                '<filter id="warnDropShadow">',
                  '<feComponentTransfer in="SourceAlpha" result="color">',
                    '<feFuncR tableValues="0.3470" type="discrete"/>',
                    '<feFuncG tableValues="0.3361" type="discrete"/>',
                    '<feFuncB tableValues="0.3169" type="discrete"/>',
                  '</feComponentTransfer>',
                  '<feGaussianBlur in="color" stdDeviation="3" result="blurFilter"/>',
                  '<feMerge>',
                    '<feMergeNode in="blurFilter"/>',
                    '<feMergeNode in="SourceGraphic"/>',
                  '</feMerge>',
                '</filter>'
            ].join(''));
        };
    LilyContactFlow.jointVectorizer(LilyContactFlow.paper.svg).defs().append(LilyContactFlow.getWarnDropShadowFilter());

    LilyContactFlow.graph.on('change:position', function(model) {
        LilyContactFlow.updateChildPositions(model);
        LilyContactFlow.updateDropPosition(model);
        LilyContactFlow.cellPositionChange = true;
    });

    LilyContactFlow.retraceLines = _.debounce(function() {
        var links = LilyContactFlow.getAllLinks();

        _.each(links, function(link) {
            _.defer(function() {
                LilyContactFlow.paper.findViewByModel(link).update();
            });
        });
    }, 300);

    LilyContactFlow.getAllLinks = function() {
        return LilyContactFlow.graph.getCells().filter(function(c) {
            return c.attributes.type === "link";
        });
    };

    // Whenever a block moves, re-trace all the links
    LilyContactFlow.graph.on('change:position', function(cell) {
        // If it's just an output, don't retrace multiple times
        if ("module" === cell.attributes.type) {
            LilyContactFlow.retraceLines();
        }
    });

    // Move to front if clicked. Also move links to top front.
    LilyContactFlow.paper.on("cell:pointerdown", function(cell) {
        if (!interactive) {
            return;
        }
        if (LilyContactFlow.isModelAttrType(cell.model, LilyContactFlow.ModuleType.parent)) {
            LilyContactFlow.allToFront(cell.model);
        } else if (LilyContactFlow.isModelAttrType(cell.model, LilyContactFlow.ModuleType.child)) {
            LilyContactFlow.allToFront(LilyContactFlow.graph.getCell(cell.model.attributes.parent));
        }
    });

    LilyContactFlow.paper.on("cell:pointerdown", function(cell) {
        if (!interactive) {
            return;
        }
        LilyContactFlow.hasPaperChanged = true;
    });

    LilyContactFlow.toFront = function(model) {
        if (!model) {
            return;
        }
        model.toFront({deep: true});
    };

    LilyContactFlow.allToFront = function(model) {
        var links = LilyContactFlow.graph.getConnectedLinks(model, {inbound: true });
        var inboundCells = [];
        var outboundCells = [];
        _.each(links, function(link) {
            var sourceChildCell = LilyContactFlow.graph.getCell(link.attributes.source.id);
            inboundCells.push(LilyContactFlow.graph.getCell(sourceChildCell.attributes.parent));
        });
        // Outbound links and links's target
        _.each(model.getEmbeddedCells(), function(cell) {
            var outboundLinks = LilyContactFlow.graph.getConnectedLinks(cell, { outbound: true });
            links = links.concat(outboundLinks);
            _.each(outboundLinks, function(link) {
                outboundCells.push(LilyContactFlow.graph.getCell(link.attributes.target.id));
            });
        });
        // We want the moving cell to be in the front, then the related links, then the related cells
        // Note that this looks a little weird until we get our final design for
        // the output nodes
        _.forEach(outboundCells, LilyContactFlow.toFront);
        _.forEach(inboundCells, LilyContactFlow.toFront);
        _.forEach(links, LilyContactFlow.toFront);
        LilyContactFlow.toFront(model);
    };        
    LilyContactFlow.updateChildPositions = function(model) {
       // Move children along with parents
        if (LilyContactFlow.isModelAttrType(model, LilyContactFlow.ModuleType.child)) {
            var parent = LilyContactFlow.graph.getCell(model.get(LilyContactFlow.ModuleType.parent));
            var offsetX = model.attr('offsetX');
            var offsetY = model.attr('offsetY');
            model.set('position', {x: parent.position().x + offsetX, y: parent.position().y + offsetY});
        }
    };

    LilyContactFlow.shouldGridSnap = function() {
        return $('#gridSnap-check-box').is(':checked');
    };

    LilyContactFlow.enableSnapToGrid = function(snapState) {
        $('#gridSnap-check-box').prop('checked', snapState || false);
    };

    LilyContactFlow.updateDropPosition = function(model) {
        if (LilyContactFlow.isModelAttrType(model, LilyContactFlow.ModuleType.parent) && LilyContactFlow.shouldGridSnap()) {
            var snapPosition = LilyContactFlow.calculateGridSnapCoordinates(model.get('position'));
            var size = model.get('size');
            LilyContactFlow.shadow.set('position', snapPosition);
            var view = LilyContactFlow.shadow.findView(LilyContactFlow.paper);
            if (view) {
                view.$el.find("rect").attr("height", size.height + LilyContactFlow.Sizes.HEADER_HEIGHT);
                view.$el.find("rect").attr("width", size.width);
            }
        }
    };

    LilyContactFlow.elementClicked = function(cell, elementSelector, clickX, clickY) {
        var elementGroup = cell.$el.find(elementSelector + ":visible");
        if (!elementGroup || !elementGroup.length) {
            return false;
        }
        var element = elementGroup[0];
        return !element.hidden && LilyContactFlow.svgRectContainsPoint(element, clickX, clickY);
    };

    LilyContactFlow.multiSelectStatus = {};
    LilyContactFlow.setMultiSelectStatus = function(multiSelectStatus){
        LilyContactFlow.multiSelectStatus = multiSelectStatus;
    };

    LilyContactFlow.paper.on("cell:pointerup", function(cell, evt, x, y) { 
        LilyContactFlow.paper.mouseclick(evt, x, y); // Workaround for a weird behavior in chrome that doesn't trigger click events on SVG elements - trigger mouseclick events on pointerup
    });
    // Because of duplicating click events on browsers that DO send a click
    // event for SVGs, debounce this
    LilyContactFlow.paper.on("cell:pointerclick", _.debounce(function(cell, evt, x, y) {
        if(LilyContactFlow.multiSelectStatus.marqueeGroupRectExist || LilyContactFlow.multiSelectStatus.marqueeMode){
            return;
        }
        if(LilyContactFlow.deleteWasDown === true){
            LilyContactFlow.deleteWasDown = false;
            return;
        }
        if (!interactive) {
            return;
        }
        if(LilyContactFlow.errorDisplayActionPerformed){
            return;
        }
        if (LilyContactFlow.elementClicked(cell, ".header", x, y) &&
            typeof(cell.model.attributes.toAngular) === "function") {
            cell.model.attributes.toAngular.call(cell);
        }
    }, 10));

    LilyContactFlow.collapseErrorDetails = function(cell) {
        var collapseAnimationTime = "0.15s";
        var el = cell.$el;
        var closeButton = el.find(".closeErrorWarn");
        var heightAnimation = el.find(".animateHeight")[0];
        var widthAnimation = el.find(".animateWidth")[0];
        heightAnimation.setAttribute("to", LilyContactFlow.Sizes.ERROR_DETAIL_BASE_SIZE);
        heightAnimation.setAttribute("from", LilyContactFlow.getErrorDetailHeight(cell));
        heightAnimation.setAttribute("dur", collapseAnimationTime);
        widthAnimation.setAttribute("to", LilyContactFlow.Sizes.ERROR_DETAIL_BASE_SIZE);
        widthAnimation.setAttribute("from", LilyContactFlow.Sizes.ERROR_DETAIL_EXPANDED_WIDTH);
        widthAnimation.setAttribute("dur", collapseAnimationTime);
        cell.$el.find(".errorWarnHeader").hide();
        cell.$el.find(".errorWarnText").hide();
        heightAnimation.beginElement();
        widthAnimation.beginElement(); 
        closeButton.hide();
    };
    LilyContactFlow.getErrorDetailHeight = function(cell) {
        var errorHeight = cell.model.attributes.errorHeight;
        var moduleHeight = cell.getBBox().height;
        return Math.max(errorHeight, moduleHeight) + 15;
    };
    // Delete was clicked
    LilyContactFlow.paper.on("cell:pointerdown", function(cell, evt, x, y) {
        if (!interactive) {
            return;
        }
        var deleteButton = cell.$el.find(".delete");
        if (!deleteButton || !deleteButton.length) {
            return;
        }
        if (LilyContactFlow.svgRectContainsPoint(deleteButton[0], x, y)) {
            cell.model.remove();
            LilyContactFlow.deleteWasDown = true;
        }
    });

    LilyContactFlow.paper.on("blank:pointerclick", function(evt, x, y){
        LilyContactFlow.deleteWasDown = false;
    });

    // Show the drop shadow if grid snap is on when a cell is clicked
    LilyContactFlow.paper.on("cell:pointerdown", function(cell, evt, x, y) {
        if (!interactive) {
            return;
        }
        if (LilyContactFlow.isCellAttrType(cell, LilyContactFlow.ModuleType.parent) && LilyContactFlow.shouldGridSnap()) {
            LilyContactFlow.updateDropPosition(cell.model);
            LilyContactFlow.shadow.attr('rect/display', '');
        }
    });

    // Snap to grid
    LilyContactFlow.paper.on("cell:pointerup", function(cell) {
        if (!interactive) {
            return;
        }
        if (LilyContactFlow.isCellAttrType(cell, LilyContactFlow.ModuleType.parent) && LilyContactFlow.shouldGridSnap()) {
            LilyContactFlow.snapToGrid(cell);
        }
    });
    
    LilyContactFlow.paper.on("blank:pointerdown", function(evt, x, y){
        LilyContactFlow.blankClicking = true;
        if(!LilyContactFlow.multiSelectStatus.marqueeMode){
            LilyContactFlow.canvasOffset = $("#paper").offset();
            LilyContactFlow.curStartXPos = evt.clientX;
            LilyContactFlow.curStartYPos = evt.clientY;
        }
    });

    $(document).on("mousemove", function(evt) {
        if(LilyContactFlow.blankClicking === true){
            if(!LilyContactFlow.multiSelectStatus.dragMarqueeRectExist){
                $("#contact-flow-outer-area").scrollLeft($("#contact-flow-outer-area").scrollLeft() + LilyContactFlow.curStartXPos - evt.clientX);
                $("#contact-flow-outer-area").scrollTop($("#contact-flow-outer-area").scrollTop() + LilyContactFlow.curStartYPos - evt.clientY);
                LilyContactFlow.curStartXPos = evt.clientX;
                LilyContactFlow.curStartYPos = evt.clientY;
            }
        }
    });

    $(document).on("mouseup", function(evt) {
        if(!LilyContactFlow.blankClicking && LilyContactFlow.cellPositionChange){
            LilyContactFlow.resizePaperToFit();
        }
        
        LilyContactFlow.blankClicking = false;
        LilyContactFlow.cellPositionChange = false;
        LilyContactFlow.errorDisplayActionPerformed = false;
    });

    // to handle error/warn detail expand button and close detail button
    $('#paper').on("mouseup", function(evt) {
        var parentElement = evt.target.parentElement;
        if(parentElement){
            if(parentElement.classList.contains("errorDetailIconForeignObject")){
                LilyContactFlow.expandErrorMessage(parentElement.parentElement, true);
            }else if(parentElement.classList.contains("warnDetailIconForeignObject")){
                LilyContactFlow.expandErrorMessage(parentElement.parentElement, false);
            }else if(parentElement.classList.contains("closeErrorWarn")){
                LilyContactFlow.collapseErrorDetailsClicked(parentElement.parentElement);
            }
        }
    });
};

LilyContactFlow.errorDisplayActionPerformed = false;
// expand error display upon clicking error button
LilyContactFlow.expandErrorMessage = function(targetElement, isError){
    if(!LilyContactFlow.initializedInteractive){
        return;
    }

    LilyContactFlow.errorDisplayActionPerformed = true;
    var expandAnimationTime = "0.3s";
    var el = $(targetElement);
    var cell = LilyContactFlow.paper.findView(el);
    var type = isError ? "error" : "warn";
    var capType = type.charAt(0).toUpperCase() + type.slice(1);
    var detailType = "." + type + "Detail";
    var collapsed = cell.model.attributes.attrs[detailType].collapsed;
    
    if(collapsed && collapsed === "true"){
        var heightAnimation = el.find(".animateHeight")[0];
        var widthAnimation = el.find(".animateWidth")[0];
        heightAnimation.setAttribute("from", LilyContactFlow.Sizes.ERROR_DETAIL_BASE_SIZE);
        heightAnimation.setAttribute("to", LilyContactFlow.getErrorDetailHeight(cell));
        heightAnimation.setAttribute("dur", expandAnimationTime);
        widthAnimation.setAttribute("from", LilyContactFlow.Sizes.ERROR_DETAIL_BASE_SIZE);
        widthAnimation.setAttribute("to", LilyContactFlow.Sizes.ERROR_DETAIL_EXPANDED_WIDTH);
        widthAnimation.setAttribute("dur", expandAnimationTime);
        heightAnimation.beginElement();
        widthAnimation.beginElement();
        _.delay(function() {
            el.find("#close"+capType).show();
            el.find("#"+type+"Header").show();
            el.find("#"+type+"Text").show();
            cell.model.attr(detailType, {
                "collapsed": "false",
                "height": LilyContactFlow.getErrorDetailHeight(cell),
                "width": LilyContactFlow.Sizes.ERROR_DETAIL_EXPANDED_WIDTH
            });
            cell.model.findView(LilyContactFlow.paper).updateAttributeLabel(cell.model);
        }, 300);
    }
};
// close error display 
LilyContactFlow.collapseErrorDetailsClicked = function(targetElement){
    if(!LilyContactFlow.initializedInteractive){
        return;
    }

    LilyContactFlow.errorDisplayActionPerformed = true;
    var cell = LilyContactFlow.paper.findView($(targetElement));
    LilyContactFlow.collapseErrorDetails(cell);
    _.delay(function() {
        cell.model.attr(".errorDetail", {
            "collapsed": "true",
            "height": LilyContactFlow.Sizes.ERROR_DETAIL_BASE_SIZE,
            "width": LilyContactFlow.Sizes.ERROR_DETAIL_BASE_SIZE
        });
        cell.model.attr(".warnDetail", {
            "collapsed": "true",
            "height": LilyContactFlow.Sizes.ERROR_DETAIL_BASE_SIZE,
            "width": LilyContactFlow.Sizes.ERROR_DETAIL_BASE_SIZE
        });
        cell.model.findView(LilyContactFlow.paper).updateAttributeLabel(cell.model);
    }, 150);

};

LilyContactFlow.getForeignObjectSize = function(module, foreignObjectSelector, innerObject) {
    // Show the containing element in order to get the size
    var oldHeight = module.attributes.attrs[foreignObjectSelector].height;
    var view = module.findView(LilyContactFlow.paper);
    module.attr(foreignObjectSelector, {
        "height": 10000 // Arbitrarily large
    });
    view.$el.find(foreignObjectSelector).show();
    var size = innerObject.getBoundingClientRect();
    module.attr(foreignObjectSelector, {
        "height": oldHeight || null 
    });
    view.$el.find(foreignObjectSelector).hide();
    return size;
};

LilyContactFlow.showModuleErrorOrWarn = function(module, headerText, detailText, isError) {
    if (!module) {
        return;
    }

    var stroke = isError ? LilyContactFlow.Colors.ERROR_STROKE_COLOR : LilyContactFlow.Colors.WARN_STROKE_COLOR;
    var type = isError ? "error" : "warn";

    var view = module.findView(LilyContactFlow.paper);
    module.attr(".module", {
        'filter': 'url(#' + type + 'DropShadow)'
    });
    module.attr(".errorDetail", {
        "collapsed": "true"
    }); 
    module.attr(".outline", {
        'stroke-opacity': '1',
        'stroke': stroke
    });
    var headerDiv = view.$el.find("#" + type + "Header > div")[0];
    headerDiv.textContent = headerText;
    var headerSize = LilyContactFlow.getForeignObjectSize(module, ".errorWarnHeader", headerDiv);
    module.attr(".errorWarnHeader", {
        "height": headerSize.height,
        "width": "220"
    });
    var detailDiv = view.$el.find("#" + type + "Text > div")[0];
    detailDiv.textContent = detailText;
    var detailSize = LilyContactFlow.getForeignObjectSize(module, ".errorWarnText", detailDiv);
    module.attr(".errorWarnText", {
        "height": detailSize.height,
        "width": "220",
        "ref-y": LilyContactFlow.Sizes.HEADER_HEIGHT + headerSize.height
    });
    module.attributes.errorHeight = LilyContactFlow.Sizes.HEADER_HEIGHT + headerSize.height + detailSize.height + 25;
    view.updateAttributeLabel(module);
    view.$el.find("." + type + "Detail").show();
    view.$el.find("." + type + "DetailIconForeignObject").show();
    LilyContactFlow.errorCellIds.push(module.id);
};

LilyContactFlow.showModuleError = function(cell, headerText, detailText) {
    LilyContactFlow.showModuleErrorOrWarn(cell, headerText, detailText, true);
};

LilyContactFlow.showModuleWarn = function(cell, headerText, detailText) {
    LilyContactFlow.showModuleErrorOrWarn(cell, headerText, detailText, false);
};

LilyContactFlow.showParameterError = function(cellId, parameterName, headerText, detailText) {
    var errorCell = LilyContactFlow.graph.getCell(cellId);
    LilyContactFlow.showModuleError(errorCell, headerText, detailText);
};

LilyContactFlow.showBranchError = function(cellId, branchCondition, headerText, detailText, contactFlowContent) {
    var errorCell = null;
    // This is a hack until a new exception type is thrown for modules without ids. https://issues.amazon.com/issues/LilyGatekeepers-1152
    if (cellId === "Start") {
        errorCell = LilyContactFlow.entryPointNode;
    }
    if (!errorCell) {
        errorCell = LilyContactFlow.graph.getCell(cellId, headerText, detailText);
    }
    if (!errorCell) {
        var contactFlow = typeof contactFlowContent === "string"? JSON.parse(contactFlowContent):contactFlowContent;
        var foundParent = false;
        _.forEach(contactFlow.modules, function(module) {
            if (!foundParent && !_.isEmpty(module.metadata.fragments)) {
                if (_.values(module.metadata.fragments).includes(cellId)) {
                    errorCell = LilyContactFlow.graph.getCell(module.id, headerText, detailText);
                    foundParent = true;
                }
            }
        });
    }
    if (!errorCell) {
        return;
    }
    LilyContactFlow.showModuleError(errorCell, headerText, detailText);
};

LilyContactFlow.showInvalidModuleTypeError = function(cellId, headerText, detailText) {
    var errorCell = LilyContactFlow.graph.getCell(cellId);
    LilyContactFlow.showModuleError(errorCell, headerText, detailText);
};

LilyContactFlow.hideError = function() {
    _.forEach(LilyContactFlow.errorCellIds, function(errorCellId) {
        var errorCell = LilyContactFlow.graph.getCell(errorCellId);
        if (errorCell) {
            errorCell.removeAttr(".module/filter");
            errorCell.attr(".outline", {
                'stroke-opacity': '0'
            });
            var view = errorCell.findView(LilyContactFlow.paper);
            view.updateAttributeLabel(errorCell);
            view.$el.find(".errorDetail").hide();
            view.$el.find(".errorDetailIconForeignObject").hide();
            view.$el.find(".warnDetail").hide();
            view.$el.find(".warnDetailIconForeignObject").hide();
            LilyContactFlow.collapseErrorDetails(view);
        }
    });

    LilyContactFlow.errorCellIds = [];
    LilyContactFlow.errorBranchIds = [];
};

LilyContactFlow.snapToGrid = function(cell) {
    cell.model.set('position', LilyContactFlow.calculateGridSnapCoordinates(cell.model.get('position')));
    _.forEach(cell.model.getEmbeddedCells(), function(child) {
        LilyContactFlow.updateChildPositions(child);
    });
    // Hide the dropshadow
    _.defer(function() {
        LilyContactFlow.shadow.attr('rect/display', 'none');
    });
};

LilyContactFlow.calculateGridSnapCoordinates = function(pos) {
    var snapPos = {x: pos.x, y: pos.y};
    var gridHeight = 20;
    snapPos.x += gridHeight / 2;
    snapPos.y += gridHeight / 2;
    snapPos = {x : snapPos.x - snapPos.x % gridHeight, y: snapPos.y - snapPos.y % gridHeight};
    return snapPos;
};

LilyContactFlow.createDropShadow = function() {
    var shadow = new joint.shapes.basic.Rect({
        position: { x: 0, y: 0 },
        size: { width: 1, height: 1 },
        attrs: {
            type: 'shadow',
            rect: { style: { 'pointer-events': 'none'}, 'stroke': 'yellow', 'fill': 'yellow', 'display': 'none', 'height': 1, 'width': 1}
        }
    });
    return shadow;
};

LilyContactFlow.entryPointParams = {
    size: { width: LilyContactFlow.Sizes.ENTRY_POINT_MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(1, false) },
    getLabel: function(cell) { return LilyContactFlow.getString(LilyContactFlow.entityType === LilyContactFlow.entityTypes.MODULE ? 'lily-admin-flow-module-entry-point-label' : 'lily-admin-contact-flow-entry-point-label'); },
    getAttributeLabel: function(cell) {
        return "";
    },
    cannotDelete: true,
    toAngular: function() {},
    fromAngular: function(data) {},
    getType: function() {
        return "EntryPoint";
    },
    inPorts: [],
    getParameters: function() {},
    getMetadata: function() {},
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.ENTRY_POINT_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.ENTRY_POINT_MODULE_HEADER_FONT_COLOR,
        iconClass: "entryPoint"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-start'),
        condition: "Start"
    }]
};
LilyContactFlow.createEntryPoint = function() {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(20, 20), LilyContactFlow.entryPointParams));
    LilyContactFlow.entryPointNode = parent;
    var nodes = [parent];

    _.forEach(LilyContactFlow.entryPointParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};

LilyContactFlow.createChild = function(parentPosX, parentPosY, offsetX, offsetY, branchLabel, branchCondition, id, bodyWidth) {
    return new joint.shapes.branch({
        position: { x: parentPosX + offsetX, y: parentPosY + offsetY },
        size: { width: bodyWidth - 11, height: LilyContactFlow.Sizes.BRANCH_HEIGHT },
        outPorts: ['out'],
        branchLabel: branchLabel,
        condition: branchCondition,
        getCondition: function() {
            return this.condition;
        }, 
        attrs: {
            '.outPorts circle': { type: 'output' },
            type: 'child',
            offsetX: offsetX,
            offsetY: offsetY
        },
        ports: {
            groups: {
                'out': {
                    attrs:{
                        '.port-body':{
                            fill: 'white',
                            stroke: 'white',
                            r: '8',
                            transform: "matrix(1, 0, 0, 1, -10, 0)"
                         }
                    }
                }
            }
        },
        id: id ? id : null
    });
};

LilyContactFlow.deserializeWithConditions = function(moduleParameters) {
    var parent = new joint.shapes.module(moduleParameters);
    var nodes = [parent];
    _.forEach(moduleParameters.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};

LilyContactFlow.addOutputCondition = function(parent, displayName, conditionName, childNumber, id) {
    var hasLabel = parent.attributes.getAttributeLabel({model:parent}) ? true : false;
    var position = parent.attributes.position;
    var childLeftOffset = 10;
    var bodyWidth = parent.attributes.size.width;
    var child = LilyContactFlow.createChild(position.x, position.y, childLeftOffset, LilyContactFlow.getTopBranchPositionY(hasLabel) + childNumber * LilyContactFlow.Sizes.BRANCH_SPACING, displayName, conditionName, id ? id : null, bodyWidth);
    parent.embed(child);
    return child;
};

LilyContactFlow.addBaseCondition = function(parameters, condition) {
    if (parameters.baseConditions.some(function(baseCondition) { return baseCondition.condition === condition.condition; })) {
        return;
    }

    parameters.baseConditions.push(condition);
};

LilyContactFlow.updateModalSave = function(data) {
    var modelElement = LilyContactFlow.graph.getCell(data.id).attributes.fromAngular(data);
};

LilyContactFlow.zoom = function(zoomIn) {
    if (zoomIn) {
        LilyContactFlow.graphScale *= LilyContactFlow.Sizes.GRID_SCALE;
        LilyContactFlow.paper.scale(LilyContactFlow.graphScale, LilyContactFlow.graphScale);
    } else if (!zoomIn && LilyContactFlow.graphScale > 0.3){
        LilyContactFlow.graphScale *= (1/LilyContactFlow.Sizes.GRID_SCALE);
        LilyContactFlow.paper.scale(LilyContactFlow.graphScale, LilyContactFlow.graphScale);
    }
    LilyContactFlow.graphScale = Math.round(LilyContactFlow.graphScale*10000)/10000;
};

// Check if str is a string written from Right to Left. Eg: Arabic, Hebrew, Urdu ...
LilyContactFlow.isRTLString = function(str) {
    const rtlChar = /[\u0591-\u07FF]/;
    return rtlChar.test(str)
}

LilyContactFlow.getTrimmedString = function(str, width, style) {
    if (!str) {
        return str;
    }
    var trimmedString = "";
    var breakAndSplit = function(str, width, style) {
        return joint.util.breakText(str, {width: width}, style).split("\n");
    };
    // Trimming large strings which cannot be processed by joint.util.breakText
    if(str.length > 500) {
        str = str.substring(0, 500);
    }
    // These chars use more space, so adjusting the width
    const isRTL = LilyContactFlow.isRTLString(str);
    if(isRTL) {
        width = width - 15;
    }
    var splitStr = breakAndSplit(str, width, style);
    if (splitStr.length === 1) {
        return splitStr[0];
    }
    for (var i = 0 ; i < str.length ; ++i) {
        var builtUpString = trimmedString + str.charAt(i) + "...";
        splitStr = breakAndSplit(builtUpString, width, style);
        if (splitStr.length > 1) {
            return trimmedString + "...";
        } else {
            trimmedString = trimmedString + str.charAt(i);
        }
    }
    return trimmedString;
};

LilyContactFlow.getTrimmedLabelWithTitle = function(fullLabel, labelWidth, style) {
    var trimmedLabel = LilyContactFlow.getTrimmedString(fullLabel, labelWidth, style);
    return "<title>" + _.escape(fullLabel) + "</title>" + _.escape(trimmedLabel);
};

/*
Convert legacy instruction to our new version.
DisableCallRecording() -> SetRecordingBehavior()
*/
LilyContactFlow.translateRecordingModuleToNewFromVersion1 = function(module) {
    module.type = "SetRecordingBehavior";
    _.forEach(module.parameters, function(param) {
        if (param.name === "DisableOption") {
            if (param.value === "Both") {
                module.parameters.push({"name": "RecordingParticipantOption", "value": "None"});
            } else if (param.value === "Agent") {
                module.parameters.push({"name": "RecordingParticipantOption", "value": "Customer"});
            } else if (param.value === "Customer") {
                module.parameters.push({"name": "RecordingParticipantOption", "value": "Agent"});
            }
            param.name = "RecordingBehaviorOption";
            param.value = "Enable";
        }
    });
};

LilyContactFlow.translateInternalTransferToFlow = function (module) {
    _.forEach(module.parameters, function(param) {
        if (param.name === "IsInternal" && param.value === "True") {
            module.type = "TransferToFlow";
        }
    });
};

/*
Convert 'Disable Agent/Customer/Both' to 'Enable Customer/Agent/None'.

Voice has changed recording behavior to be disabled by default
https://issues.amazon.com/issues/Lily-Defect-484
There could be some contact flows that disable one side recording, which is actually
disabling recording on both sides. Thus we need this conversion for expected behavior.

Please put 'Disable Both -> Enable None' translation to ModuleDecompilerByType when removing this function.
*/
LilyContactFlow.translateRecordingModuleToNewFromVersion2 = function(module) {
    _.forEach(module.parameters, function(param) {
        if (param.name === "RecordingBehaviorOption") {
            param.value = "Enable";
        } else if (param.name === "RecordingParticipantOption") {
            if (param.value === "Agent") {
                param.value = "Customer";
            } else if (param.value === "Customer") {
                param.value = "Agent";
            } else if (param.value === "Both") {
                param.value = "None";
            }
        }
    });
};

LilyContactFlow.isParameterExist = function(module, nameToMatch, valueToMatch) {
    var exist = false;
    _.forEach(module.parameters, function(param) {
        if (param.name === nameToMatch && param.value === valueToMatch) {
            exist = true;
        }
    });
    return exist;
};

LilyContactFlow.clearConditionsId = function(conditions) {
    _.forEach(conditions,  function(condition) {
        condition.id = null;
    });
};

// Validates the presence of nodes within the other set
LilyContactFlow.isModuleTypePresent = function(nodeIds, nodeTypes) {
    return _.any(nodeIds,function(node){
      var type = LilyContactFlow.graph.getCell(node).attributes.getType();
      return _.contains(nodeTypes,type);
    });
};

LilyContactFlow.buildGraphAnalysis = function() {
    // Cell ID -> {precedingNodes: [], succeedingNodes: []}
    // Note that preceding and succeeding lists contain ALL nodes, not just
    // direct predecessors / successors
    var graph = {};
    function addCellToList(list, cellId) {
        if (list.indexOf(cellId) !== -1) {
            return false;
        }
        list.push(cellId);
        return true;
    }
    function recurseIntoNode (cellId, from) {
        // We've already seen this cell
        var stopRecursing = cellId in graph;
        var precedingNodes = from ? [from].concat(graph[from].precedingNodes) : [];
        if (stopRecursing) {
            precedingNodes = precedingNodes.concat(graph[cellId].precedingNodes);
        }
        graph[cellId] = {
            precedingNodes: precedingNodes,
            succeedingNodes: stopRecursing ? graph[cellId].succeedingNodes : []
        };
        if (from) {
            // Wherever we came from goes here
            addCellToList(graph[from].succeedingNodes, cellId);
            _.each(graph, function(value, key) {
                // If the node is before "from", it's also before this cell 
                if (value.succeedingNodes.indexOf(from) !== -1) {
                    addCellToList(value.succeedingNodes, cellId);
                }
            });
            var currentEntry = graph[cellId];
            // Anything that follows this node also follows all its predecessors
            _.each(precedingNodes, function(node) {
                var value = graph[node];
                if (value.precedingNodes.indexOf(cellId) !== -1) {
                    _.each(currentEntry.succeedingNodes, function(node) {
                        addCellToList(value.succeedingNodes, node);
                    });
                }
            });
            // And anything that comes before this cell also comes before its predecessors
            _.each(currentEntry.succeedingNodes, function(node) {
                var value = graph[node];
                if (value.succeedingNodes.indexOf(cellId) !== -1) {
                    _.each(currentEntry.precedingNodes, function(node) {
                        addCellToList(value.precedingNodes, node);
                    });
                }
            });
        }
        if (stopRecursing) {
            return;
        } else {
            var cell = LilyContactFlow.graph.getCell(cellId);
            var links = LilyContactFlow.graph.getCells().filter(function(c) {
                return c.attributes.type === "link";
            });
            _.each(cell.getEmbeddedCells(), function(cell) {
                var outputLinks = links.filter(function(c) {
                    return c.attributes.source && c.attributes.source.id === cell.id;
                });
                _.each(outputLinks, function(link) {
                    if (link.attributes.target && link.attributes.target.id) {
                        recurseIntoNode(link.attributes.target.id, cellId);
                    }
                });
            });
        }

    }
    recurseIntoNode(LilyContactFlow.entryPointNode.id);
    LilyContactFlow.graphAnalysis = graph;
};

// get min and max coordinates for given cells. 
LilyContactFlow.getMinAndMaxCoordinateOfCells = function(cells) {
    var minX,minY,maxX,maxY;
    _.forEach(cells, function(cell) {
        if (!minX || minX > cell.position.x) {
            minX = cell.position.x;
        }
        if (!minY || minY > cell.position.y) {
            minY = cell.position.y;
        }
        var cellMaxX = cell.position.x + cell.size.width;
        var cellMaxY = cell.position.y + cell.size.height;
        if (!maxX || maxX < cellMaxX) {
            maxX = cellMaxX;
        }

        if (!maxY || maxY < cellMaxY) {
            maxY = cellMaxY;
        }
    });

    return {
        minX: minX,
        minY: minY,
        maxX: maxX,
        maxY: maxY
    };
};

LilyContactFlow.resizePaperToFit = function(trimWhiteSpace){
    var modules = LilyContactFlow.graph.toJSON().cells || [];
    modules = modules.filter(function(cell) { 
        return cell.type === "module";
    });

    var minMaxCoord = LilyContactFlow.getMinAndMaxCoordinateOfCells(modules);

    var scrollLeft = $("#contact-flow-outer-area").scrollLeft() / LilyContactFlow.graphScale;
    var scrollTop = $("#contact-flow-outer-area").scrollTop() / LilyContactFlow.graphScale;

    var maxWidth = minMaxCoord.maxX - minMaxCoord.minX;
    var maxHeight = minMaxCoord.maxY - minMaxCoord.minY;
    var marginForScroll = 0, 
        xMove = 0,
        yMove = 0;
    if (minMaxCoord.minX < 0) {
        xMove = minMaxCoord.minX * -1;
        xMove += LilyContactFlow.Sizes.TRIM_MARGIN;
    } else if (trimWhiteSpace) {
        var newMinXPosition = Math.max(LilyContactFlow.Sizes.TRIM_MARGIN, minMaxCoord.minX - scrollLeft);
        xMove = newMinXPosition - minMaxCoord.minX;
        xMove = xMove < 0? xMove : 0;
    }

    if (minMaxCoord.minY < 0) {
        yMove = minMaxCoord.minY * -1;
        yMove += LilyContactFlow.Sizes.TRIM_MARGIN;
    } else if(trimWhiteSpace) {
        var newMinYPosition = Math.max(LilyContactFlow.Sizes.TRIM_MARGIN, minMaxCoord.minY - scrollTop);
        yMove = newMinYPosition - minMaxCoord.minY;
        yMove = yMove < 0? yMove : 0;
    }

    if (xMove !== 0 || yMove !== 0) {
        var xScroll = xMove * LilyContactFlow.graphScale;
        var yScroll = yMove * LilyContactFlow.graphScale;
        LilyContactFlow.graph.getElements().forEach(function(element) {
            element.position(element.attributes.position.x + xMove, element.attributes.position.y + yMove);
        });

        $("#contact-flow-outer-area").scrollLeft(scrollLeft + xScroll);
        $("#contact-flow-outer-area").scrollTop(scrollTop + yScroll);

        if (trimWhiteSpace) {
            maxWidth += xScroll;
            maxHeight += yScroll;
        }
    }


    if(!LilyContactFlow.paperWidth){
        LilyContactFlow.paperWidth = $('#paper').width();
        LilyContactFlow.paperHeight = $('#paper').height();
    }

    if (maxWidth > LilyContactFlow.paperWidth || trimWhiteSpace){
        maxWidth = maxWidth < LilyContactFlow.Sizes.PAPER_MIN_WIDTH? LilyContactFlow.Sizes.PAPER_MIN_WIDTH:maxWidth;
        $('#paper').width(maxWidth);
        LilyContactFlow.paperWidth = maxWidth;
    }

    if (maxHeight > LilyContactFlow.paperHeight || trimWhiteSpace){
        maxHeight = maxHeight < LilyContactFlow.Sizes.PAPER_MIN_HEIGHT? LilyContactFlow.Sizes.PAPER_MIN_HEIGHT:maxHeight;
        $('#paper').height(maxHeight);
        LilyContactFlow.paperHeight = maxHeight;
    }

};
joint.shapes.module = joint.shapes.devs.Model.extend({
    defaults: joint.util.deepSupplement({
        type: 'module',
        attrs: {
            'rect': { 'stroke-opacity': '0', 'fill-opacity': 1}
        }
    }, joint.shapes.devs.Model.prototype.defaults)
});
joint.shapes.moduleView = joint.shapes.devs.ModelView.extend({
    getMarkup: function() {
        var label = this.model.attributes.getLabel(this);
        var attributeLabel = this.model.attributes.getAttributeLabel(this);
        var cannotDelete = this.model.attributes.cannotDelete || false;
        var moduleHeaderIconClass = this.model.attributes.headerParameters.iconClass;
        return this.getWarnAndErrorMarkup(label, attributeLabel, cannotDelete, moduleHeaderIconClass).join('');
    },
    getWarnAndErrorMarkup: function(label, attributeLabel, cannotDelete, moduleHeaderIconClass) {
        var markupArray = ['<g>'];
        markupArray = markupArray.concat(['error', 'warn'].map(function (type) {
            var stroke = type === 'warn' ? LilyContactFlow.Colors.WARN_STROKE_COLOR : LilyContactFlow.Colors.ERROR_STROKE_COLOR;
            var fill = type === 'warn' ? LilyContactFlow.Colors.WARN_FILL_COLOR : LilyContactFlow.Colors.ERROR_FILL_COLOR;
            var capType = type.charAt(0).toUpperCase() + type.slice(1);
            return [
                '<rect class="' + type +'Detail collapsed" x="-15" y="-15" rx="2" ry="2" width="30" height="30" stroke="' + stroke + '" stroke-width="1" fill="' + fill + '" >',
                    '<animate class="animateWidth" attributeName="width" repeatCount="1" begin="indefinite" fill="freeze"/>',
                    '<animate class="animateHeight" attributeName="height" repeatCount="1" begin="indefinite" fill="freeze"/>',
                '</rect>',
                '<foreignObject class="errorWarnHeader" id="' + type + 'Header">',
                    '<div xmlns="http://www.w3.org/1999/xhtml"></div>',
                '</foreignObject>',
                '<foreignObject class="errorWarnText" id="' + type + 'Text">',
                    '<div xmlns="http://www.w3.org/1999/xhtml"></div>',
                '</foreignObject>',
                '<foreignObject class="closeErrorWarn" id="close' + capType + '" width="13" height="13"><div xmlns="http://www.w3.org/1999/xhtml" class="close' + capType + 'ModuleIcon"></div></foreignObject>',
            ].join('');
        }));
        markupArray = markupArray.concat([
            '<g class="rotatable module">',
                '<foreignObject class="shadowLayer"><div xmlns="http://www.w3.org/1999/xhtml" /></foreignObject>',
                '<rect class="header"/>',
                '<rect class="body"/>',
                '<rect class="outline"/>'
        ]);

        if (label) {
            markupArray = markupArray.concat([
                '<text class="label"/>'
            ]);
        }
        if (attributeLabel) {
            markupArray = markupArray.concat([
                '<text class="attribute-label"/>'
            ]);
        }

        markupArray = markupArray.concat([
            '<foreignObject x="9" y="11.5" width="25" height="25"><div xmlns="http://www.w3.org/1999/xhtml" class="ModuleHeaderIcon '+moduleHeaderIconClass+'"></div></foreignObject>'
        ]);

        if (!cannotDelete) {
            markupArray = markupArray.concat([
                '<text class="delete"/>'
            ]);
        }
        markupArray = markupArray.concat(['</g>']);
        markupArray = markupArray.concat(['error', 'warn'].map(function (type) {
            var coordinate = type === 'warn' ? '-15' : '-10';
            return '<foreignObject class="' + type +'DetailIconForeignObject" x="'+coordinate+'" y="'+coordinate+'" width="20" height="26"><div xmlns="http://www.w3.org/1999/xhtml" class="' + type + 'DetailIcon collapsed"></div></foreignObject>';
        }));
        markupArray = markupArray.concat(['</g>']);
        return markupArray;
    },
    getTrimmedLabel: function(self, view) {
        view = view || self.findView(LilyContactFlow.paper);
        var label = self.attributes.getLabel(view);
        if (!label) {
            return label;
        }
        var labelWidth = (self.attributes.size.width * 0.75) - 22;
        // Trim label if needed - note that labels can go to multiple lines, unlike attribute labels
        return joint.util.breakText(label, {width: labelWidth}, {'font-size': '12px', 'font-weight': 'bold'});
    },
    updateLabel: function(self) {
        var trimmedLabel = this.getTrimmedLabel(self);
        self.findView(LilyContactFlow.paper).$el.find(".label").text(trimmedLabel);
    },
    getAttributeLabelWithTitle: function(self, view) {
        var fullLabel = self.attributes.getAttributeLabel(view);
        var labelWidth = self.attributes.size.width - 36;
        var attributeLabelStyle= LilyContactFlow.labelStyle;
        return LilyContactFlow.getTrimmedLabelWithTitle(fullLabel, labelWidth, attributeLabelStyle);
    },
    updateAttributeLabel: function(self) {
        var view = self.findView(LilyContactFlow.paper);
        var innerHtml = view.getAttributeLabelWithTitle(self, view);
        view.$el.find(".attribute-label").html(innerHtml);
    },
    initialize: function() {
        this.model.markup = this.getMarkup();
        var headerHeight = LilyContactFlow.Sizes.HEADER_HEIGHT;
        var headerParameters = this.model.attributes.headerParameters;
        // Inlcude header height in the bounding box used for collision detection
        var oldBBox = this.model.getBBox.bind(this.model);
        var newBBox = function(a) {
            var bbox = oldBBox(a);
            bbox.height += headerHeight;
            return bbox;
        };
        this.model.getBBox = newBBox.bind(this.model);
        this.model.attr('.rotatable.module', {
            class: 'rotatable module backgroundColor-' + headerParameters.backGroundColor.substring(1, headerParameters.backGroundColor.length)
        });

        this.model.attr(".header", {
            'fill': headerParameters.backGroundColor,
            'width': this.model.attributes.size.width,
            'height': headerHeight
        });
        this.model.attr(".body", {
            'fill': '#FFFFFF',
            'y': headerHeight
        });
        this.model.attr(".outline", {
            'fill': 'none',
            'width': this.model.attributes.size.width,
            'height': this.model.attributes.size.height + headerHeight,
            'stroke-width': '1',
            'stroke': '#D0011B',
            'stroke-opacity': '0'
        });
        this.model.attr(".shadowLayer", {
            'width': this.model.attributes.size.width,
            'height': this.model.attributes.size.height + headerHeight
        });
        // Resize the outline when the cell changes size
        this.model.on("change:size", function() {
            this.attr(".outline", {
                'height': this.attributes.size.height + headerHeight
            });
            this.attr(".shadowLayer", {
                'height': this.attributes.size.height + headerHeight
            });
        });

        var standardLabelAttributes = {
            'text-anchor': 'left',
            'fill': '#000',
            'dominant-baseline': 'middle'
        };
        this.model.attr(".label", _.extend({}, standardLabelAttributes, {
            text: this.getTrimmedLabel(this.model, this),
            'ref-x': LilyContactFlow.Sizes.MODULE_ICON_WIDTH,
            'ref-y': 10,
            'fill': headerParameters.fontColor
        }));
        this.model.attr(".attribute-label", _.extend({}, standardLabelAttributes, {
            'ref-x': 0.1,
            'ref-y': LilyContactFlow.Sizes.HEADER_HEIGHT + 15,
            'fill': '#000',
            'html': this.getAttributeLabelWithTitle(this.model, this)
        }));
        this.model.attr(".errorWarnHeader", {
            'ref-x': this.model.attributes.size.width + 30,
            'ref-y': "15",
            'width': '220',
            'xml:space': 'default'
        });
        this.model.attr(".errorWarnText", _.extend({}, standardLabelAttributes, {
            "ref-x": this.model.attributes.size.width + 30,
            "ref-y": LilyContactFlow.Sizes.HEADER_HEIGHT,
            'width': '220'
        }));
        this.model.attr(".delete", _.extend({}, standardLabelAttributes, {
            text: 'x',
            'ref-x': 0.9,
            'ref-y': 1,
            'fill': '#000'
        }));
        this.model.attr(".closeErrorWarn", {
            "ref-x": "445",
            "ref-y": "-5"
        });
        this.model.attr(".errorDetail", {
            "fill-opacity": "0.8",
            "stroke-opacity": "1",
            "collapsed": "true"
        });
        this.model.attr(".warnDetail", {
            "fill-opacity": "0.8",
            "stroke-opacity": "1",
            "collapsed": "true"
        });
        joint.dia.ElementView.prototype.initialize.apply(this, arguments);
        this.model.attributes.toAngular = this.model.attributes.toAngular || function() {} ;
    },
    render: function() {
        joint.dia.ElementView.prototype.render.apply(this, arguments);
        return this;
    },
    mergeInConditions: function(self, conditions) {
        var allNewConditions = [];
        // If the input has no ID, we need to create it
        var nodesToCreate = [];
        // If the input node has an ID, we should keep it
        var nodeIdsToKeep = [];
        _.forEach(conditions, function(node) {
            // Update nodes that already exist
            if (node.id) {
                nodeIdsToKeep.push(node.id);
                var cell = LilyContactFlow.graph.getCell(node.id);
                cell.set("condition", self.attributes.getConditionData(node));
                var branchLabel = self.attributes.getBranchLabel(node);
                var branchLabelWidth = self.attributes.size.width - 60;
                cell.findView(LilyContactFlow.paper).$el.find(".label").html(LilyContactFlow.getTrimmedLabelWithTitle(branchLabel, branchLabelWidth, LilyContactFlow.labelStyle));
            } else {
                nodesToCreate.push(node);
                return;
            }
        });
        // Delete nodes that need to be removed - if they're embedded in the current markup and weren't passed in as
        // an input, they should be removed
        _.forEach(self.getEmbeddedCells(), function(cell) {
            if (nodeIdsToKeep.indexOf(cell.id) === -1 && self.attributes.staticConditionIds.indexOf(cell.id) === -1) {
                cell.findView(LilyContactFlow.paper).removeBranch();
            }
        });
        // Create new nodes that don't yet exist
        var view = self.findView(LilyContactFlow.paper);
        _.forEach(nodesToCreate, function(node) {
            LilyContactFlow.graph.addCell(view.createChildCondition(self, node));
        });
        self.attributes.sortConditions(self);
        self.attributes.conditions = conditions;
    },
    refreshBranchLabel: function(self, cell) {
        var branchLabel = self.attributes.getBranchLabel(cell.attributes.getCondition());
        var branchLabelWidth = self.attributes.size.width - 60;
        cell.findView(LilyContactFlow.paper).$el.find(".label").html(LilyContactFlow.getTrimmedLabelWithTitle(branchLabel, branchLabelWidth, LilyContactFlow.labelStyle));
    },
    moveCellToTopByCondition: function(self, condition) {
        var topCell = null;
        var numberCellsMoved = 0;
        var view = self.findView(LilyContactFlow.paper);
        _.forEach(self.getEmbeddedCells().sort(LilyContactFlow.sortOutputNodes), function(cell, i) {
            var cellCondition = cell.attributes.getCondition();
            if (_.isObject(cellCondition) && cellCondition.condition) {
                cellCondition = cellCondition.condition;
            }
            if (cellCondition === condition) {
                topCell = cell;
            } else if (topCell === null) {
                cell.findView(LilyContactFlow.paper).moveVertical(LilyContactFlow.Sizes.BRANCH_SPACING);
                ++numberCellsMoved;
                view.refreshBranchLabel(self, cell);
            }
        });
        if (topCell === null) {
            _.forEach(self.getEmbeddedCells().sort(LilyContactFlow.sortOutputNodes), function(cell, i) {
                cell.findView(LilyContactFlow.paper).moveVertical(-1 * LilyContactFlow.Sizes.BRANCH_SPACING);
                view.refreshBranchLabel(self, cell);
            });
            return;
        }
        topCell.findView(LilyContactFlow.paper).moveVertical(-1 * numberCellsMoved * LilyContactFlow.Sizes.BRANCH_SPACING);
        view.refreshBranchLabel(self, topCell);
    },
    moveCellToBottomByCondition: function(self, condition) {
        var bottomCell = null;
        var numberCellsMoved = 0;
        _.forEach(self.getEmbeddedCells().sort(LilyContactFlow.sortOutputNodes), function(cell, i) {
            var cellCondition = cell.attributes.getCondition();
            if (_.isObject(cellCondition) && cellCondition.condition) {
                cellCondition = cellCondition.condition;
            }
            if (cellCondition === condition) {
                bottomCell = cell;
            } else if (bottomCell !== null) {
                cell.findView(LilyContactFlow.paper).moveVertical(-1 * LilyContactFlow.Sizes.BRANCH_SPACING);
                ++numberCellsMoved;
            }
        });
        if (bottomCell === null) {
            return;
        }
        bottomCell.findView(LilyContactFlow.paper).moveVertical(numberCellsMoved * LilyContactFlow.Sizes.BRANCH_SPACING);
    },
    moveCellToBottomById: function(self, childId) {
        var bottomCell = null;
        var numberCellsMoved = 0;
        _.forEach(self.getEmbeddedCells().sort(LilyContactFlow.sortOutputNodes), function(cell, i) {
            if (cell.id === childId) {
                bottomCell = cell;
            } else if (bottomCell !== null) {
                cell.findView(LilyContactFlow.paper).moveVertical(-1 * LilyContactFlow.Sizes.BRANCH_SPACING);
                ++numberCellsMoved;
            }
        });
        if (bottomCell === null) {
            return;
        }
        bottomCell.findView(LilyContactFlow.paper).moveVertical(numberCellsMoved * LilyContactFlow.Sizes.BRANCH_SPACING);
    },
    createChildCondition: function(self, condition) {
        var lastChild = self.getEmbeddedCells().sort(LilyContactFlow.sortOutputNodes)[self.getEmbeddedCells().length - 1];
        var lastChildOffsetX = lastChild ? lastChild.attr("offsetX") : 10;
        var lastChildOffsetY = lastChild ? lastChild.attr("offsetY") : LilyContactFlow.getTopBranchPositionY(true) - LilyContactFlow.Sizes.BRANCH_SPACING;
        var newCell = LilyContactFlow.createChild(self.position().x, self.position().y, lastChildOffsetX,
            lastChildOffsetY + LilyContactFlow.Sizes.BRANCH_SPACING, self.attributes.getBranchLabel(condition), self.attributes.getConditionData(condition),
            undefined, self.attributes.size.width);
        condition.id = newCell.id;
        self.embed(newCell);
        self.resize(self.get("size").width, self.get("size").height + LilyContactFlow.Sizes.BRANCH_SPACING);
        return newCell;
    },
    sortConditions: function() {} 
});

joint.shapes.branch = joint.shapes.devs.Model.extend({
    defaults: joint.util.deepSupplement({
        type: 'branch',
        attrs: {
            rect: { 'stroke-opacity': '0', 'fill-opacity': 1, 'fill': '#E9F1F9' }
        }
    }, joint.shapes.devs.Model.prototype.defaults)
});
joint.shapes.branchView = joint.shapes.devs.ModelView.extend({
    initialize: function() {
        this.model.attr(".label", { 
            'html': this.getTrimmedBranchLabelWithTitle(this.model),
            'ref-x': 0.1, 
            'ref-y': 9,
            'text-anchor': 'left',
            'fill': '#000'
        });
        // We really don't want to turn off collisons against the source block
        //  See https://tt.amazon.com/0124965300
        //  TODO - is there a better hook for this? https://tiny.amazon.com/137aso2cw/codeamazpackJoinblob5ae0thir
        this.model.getAncestors = function() {
            return [];
        };
        joint.dia.ElementView.prototype.initialize.apply(this, arguments);
        var myOffset = this.model.attr("offsetY");
    },
    getTrimmedBranchLabelWithTitle: function(self) {
        var fullLabel = self.attributes.branchLabel;
        var labelWidth = self.attributes.size.width - 40;
        var branchLabelStyle = LilyContactFlow.labelStyle;
        return LilyContactFlow.getTrimmedLabelWithTitle(fullLabel, labelWidth, LilyContactFlow.labelStyle, branchLabelStyle);
    },
    removeBranch: function() {
        var parent = LilyContactFlow.graph.getCell(this.model.get('parent'));
        var myOffset = this.model.attr("offsetY");
        _.each(LilyContactFlow.graph.getConnectedLinks(this.model), function(l) {
            l.remove();
        });
        this.model.remove(this.model);
        parent.resize(parent.get("size").width, parent.get("size").height - LilyContactFlow.Sizes.BRANCH_SPACING);
        _.each(parent.getEmbeddedCells(), function(c, i) {
            if (c.attr("offsetY") > myOffset) {
                c.attr("offsetY", c.attr("offsetY") - LilyContactFlow.Sizes.BRANCH_SPACING);
                LilyContactFlow.graph.trigger("change:position", LilyContactFlow.graph.getCell(c.id));
            }
        });
    },
    moveVertical: function(pixels) {
        this.model.attr("offsetY", this.model.attr("offsetY") + pixels);
        LilyContactFlow.graph.trigger("change:position", LilyContactFlow.graph.getCell(this.model.id));
    },
    render: function() {
        joint.dia.ElementView.prototype.render.apply(this, arguments);
        return this;
    }
});

/**
 *  @desc: Directive to support multi select in contact flow
 */


LilyContactFlow.MultiSelectSupport = function(paper, graph, getGraphScale, onChangeListener) {
    var mac = navigator.platform.indexOf('Mac') > -1,
        selectedCellClassName = 'selectedCell',
        graphMargin = null,
        draggingMarquee = false,
        dragMouseMove = false,
        marqueeGroupRect = null,
        dragMarqueeRect = null,
        marqueeMode = false,
        blankClicking = false;

    // toggling between marquee mode and select mode
    var keyEventHandler = function(event) {    
        if(mac? (event.key === "Meta" || event.metaKey):(event.key === "Control" || event.ctrlKey)){ //metaKey for cmd
            setMarqueeMode(event.type === "keydown");
        }
    };

    var setMarqueeMode = function(mode){
        marqueeMode = mode;
        changeEmitter();
    };

    document.addEventListener('keyup', keyEventHandler, false);
    window.addEventListener('focus',function(){
        setMarqueeMode(false);
    });
    document.addEventListener('keydown', keyEventHandler, false);
    /**
     * Returns the most outer cell of given cell model and whether the given cell model was already selected for multi select or not
     * @param cellModel joint.dia.Cell.model
     * @return module: the cell that is on the top of the cell hierarchy of the given cellModel that is not multi select group cell
     *         isSelectedModule: boolean of whether the given cellModel is already selected for multi select or not
     */
    var getJointModule = function(cellModel){
        var parentCell = cellModel;
        var isSelected = false;
        while(parentCell.get('parent')){
            if(isMarqueeGroupRectCell(parentCell.get('parent'))){
                isSelected = true;
                break;
            }else {
                parentCell = graph.getCell(parentCell.get('parent'));
            }
        }

        return {
            module: parentCell,
            isSelectedModule: isSelected
        };

    };
    var changeEmitter = function(){
        onChangeListener({ 
            multiSelectStatus: {
                marqueeGroupRectExist: marqueeGroupRect? true:false,
                dragMarqueeRectExist: dragMarqueeRect? true:false,
                marqueeMode: marqueeMode
            }
        });
    };

    var isMarqueeGroupRectCell = function(cellId){
        return marqueeGroupRect && marqueeGroupRect.id === cellId;
    };

    // select cell if the given cell is not already selected for multi select, and unselect the cell if it was already selected
    var selectCell = function(cell){
        if(isMarqueeGroupRectCell(cell.model.id)){
            // no action taken if the selected cell is multi select group cell (invisible to user)
            return; 
        }

        var jointModule = getJointModule(cell.model);
        if(jointModule.isSelectedModule){
            unselectCell(jointModule.module);
            return ;
        }
        
        paper.findViewByModel(jointModule.module).highlight(null, {
            highlighter: {
                name: 'addClass',
                options: {
                    className: selectedCellClassName
                }
            }
        });
        var cellAttribute = jointModule.module.attributes;

        var newCellMarqueeAttribute = {
            position: {
                x: cellAttribute.position.x + 1, // + 1 on the positions to make sure the parent Cell for marquee mode is always hidden behind
                y: cellAttribute.position.y + 1
            },
            size: {
                width: 1,
                height: 1
            },
            attrs: { rect: { opacity: 0}}
        };

        if(!marqueeGroupRect){
            marqueeGroupRect = new joint.shapes.basic.Rect(newCellMarqueeAttribute);
            graph.addCells([marqueeGroupRect]);
            changeEmitter();

        }

        marqueeGroupRect.embed(jointModule.module);
        marqueeGroupRect.toBack();
    };

    var unselectAllCells = function(){
        if(marqueeGroupRect){
            marqueeGroupRect.getEmbeddedCells().map(function(embeddedCell){
                unselectCell(embeddedCell);
            });

        }

        removeMarqueeGroupRect();

        return;
    };

    var removeMarqueeGroupRect = function(){
        if(marqueeGroupRect && marqueeGroupRect.getEmbeddedCells().length === 0){
            marqueeGroupRect.remove();
            marqueeGroupRect = null;
            changeEmitter();
        }
    };

    var unselectCell = function(cell){
        paper.findViewByModel(cell).unhighlight(null, {
            highlighter: {
                name: 'addClass',
                options: {
                    className: selectedCellClassName
                }
            }
        });
        marqueeGroupRect.unembed(cell);
    };

    var pointerUpForMarqueeRect = false;
    var curPointerDownCell;
    var selectedOnPointerDown = false;

    var setToMoveMarquee = function(cell, evt){
        curPointerDownCell = cell;
        var marqueModel = paper.findViewByModel(marqueeGroupRect);
        pointerUpForMarqueeRect = true;
        cell.pointerup(evt);
        paper.sourceView = marqueModel;
        var localPoint = paper.snapToGrid({ x: evt.clientX, y: evt.clientY });
        marqueModel.pointerdown(evt, localPoint.x, localPoint.y);
    };

    paper.on("cell:pointerdown", function(cell, evt) {
        if(isMarqueeGroupRectCell(cell.model.id) || draggingMarquee){
            return;
        }else if(marqueeGroupRect || marqueeMode){
            if(getJointModule(cell.model).isSelectedModule){
                setToMoveMarquee(cell, evt);
            }else if(marqueeMode){
                selectedOnPointerDown = true;
                selectCell(cell);
                setToMoveMarquee(cell, evt);
            }
            
        }
    });

    paper.on("cell:pointermove", function(cell, evt){
        if(draggingMarquee){
            return;
        }
        
        if(isMarqueeGroupRectCell(cell.model.id)){
            draggingMarquee = true;
            return;
        }
        
        if(marqueeGroupRect && !getJointModule(cell.model).isSelectedModule && !marqueeMode){
            unselectAllCells();
        }
    });

    paper.on("cell:pointerup", function(cell, evt, x, y) { 
        if(pointerUpForMarqueeRect){
            pointerUpForMarqueeRect = false;
            return;
        }
        if(marqueeGroupRect && !draggingMarquee){
            if(marqueeMode){
                if(!selectedOnPointerDown){
                    selectCell(curPointerDownCell);
                }
            }else {
                unselectAllCells();
            }

        }
        selectedOnPointerDown = false;
        draggingMarquee = false;
    
    });

    paper.on("blank:pointerclick", function(evt, x, y){
        dragMouseMove = false;
    });

    paper.on("blank:pointerdown", function(evt, x, y){
        blankClicking = true;
        if(marqueeMode){
            var newCellMarqueeAttribute = {
                position: {
                    x: x,
                    y: y
                },
                size: {
                    width: 1,
                    height: 1
                },
                attrs: { rect: { opacity: 0.4, fill: '#FFFFFF', stroke: '#4A90E2', 'stroke-dasharray': '3 2'}}
            };
            dragMarqueeRect = new joint.shapes.basic.Rect(newCellMarqueeAttribute);
            changeEmitter();
            graph.addCells([dragMarqueeRect]);
            graphMargin = { x: evt.clientX - x, y: evt.clientY - y };


        }
    });

    $(document).on("mousemove", function(evt) {
        if(blankClicking === true){
            if(dragMarqueeRect){
                dragMouseMove = true;
                var dragMarqueePosition = dragMarqueeRect.attributes.position;
                var graphScale = getGraphScale();
                var newMarqueeSize = {
                    width: (evt.clientX- graphMargin.x - dragMarqueePosition.x) / graphScale,
                    height: (evt.clientY- graphMargin.y - dragMarqueePosition.y) / graphScale
                };
                dragMarqueeRect.resize(newMarqueeSize.width, newMarqueeSize.height);
            }else{
                if(marqueeGroupRect){
                    dragMouseMove = true;
                }
            }
        }
    });

    $(document).on("mouseup", function(evt) {
        if(blankClicking){
            if(dragMarqueeRect){
                var dragMarqueeRectAttr = dragMarqueeRect.attributes;
                var dragArea = {
                    x: dragMarqueeRectAttr.size.width < 0? (dragMarqueeRectAttr.position.x + dragMarqueeRectAttr.size.width):dragMarqueeRectAttr.position.x,
                    y: dragMarqueeRectAttr.size.height < 0? (dragMarqueeRectAttr.position.y + dragMarqueeRectAttr.size.height):dragMarqueeRectAttr.position.y,
                    width: Math.abs(dragMarqueeRectAttr.size.width),
                    height: Math.abs(dragMarqueeRectAttr.size.height)
                };
    
                graph.findModelsInArea(dragArea).map(function(el) {
                    var parentCell = el.get('parent');
                    if(el.id !== dragMarqueeRect.id && (!parentCell || parentCell=== marqueeGroupRect.id)){
                        selectCell(paper.findViewByModel(el));
                        LilyContactFlow.allToFront(el);
                    }
                });
                dragMarqueeRect.remove();
                dragMarqueeRect = null;
                changeEmitter();
            }else if(!dragMouseMove){
                unselectAllCells();
            }
        }
        blankClicking = false;
    });
    
    LilyContactFlow.MultiSelectSupport.prototype.getSelectedCells = function(){
        return marqueeGroupRect? marqueeGroupRect.getEmbeddedCells():null;
    };

    LilyContactFlow.MultiSelectSupport.prototype.selectCells = function(nodes, callback){
        callback = callback || function(){};

        unselectAllCells();
        _.forEach(nodes, function(node){
            if(node.attributes.type === "module"){
                node.model = node;
                selectCell(node);
            }
        });

        callback();
    };

    LilyContactFlow.MultiSelectSupport.prototype.getGroupMarqueeRect = function(){
        return marqueeGroupRect;
    };

    LilyContactFlow.MultiSelectSupport.prototype.unselectEntryCell = function(){
        unselectCell(LilyContactFlow.entryPointNode);
    };
};

/**
 *  @desc: Directive to support multi select in contact flow
 */


LilyContactFlow.CopyAndPasteSupport = function(multiSelect, displayError) {
    var pasteMargin = 10;
    var curPasteMargin = 10;
    var previousPasted;

    /**
     * Serialize selected blocks and branches connecting between selected blocks and save the serialized string on clipboard
     * if there are no text selected and user is not on the text area
     * @param {Event} event Event object passed from cut || copy eventlistener
     */
    var copyContactFlow = function(event){
        if(!onTextField()){
            var selectedCells = multiSelect.getSelectedCells();
            //checking that the entry point isn't the only selected cell
            if(selectedCells && (selectedCells.length > 1 || (selectedCells[0] && selectedCells[0].id !== LilyContactFlow.entryPointNode.id))){
                var modulesById = {};
                var branches = {};
                var links = [];
                _.forEach(multiSelect.getSelectedCells(), function(cell){
                    var json = LilyContactFlow.jsonifyModule(cell.attributes);

                    if(!json){
                        return;
                    }
                    modulesById[cell.id] = json;

                    //get branches
                    _.forEach(cell.getEmbeddedCells(), function(embeddedCell){
                        if(embeddedCell.attributes.type === "branch") {
                            branches[embeddedCell.id] = LilyContactFlow.jsonifyBranch(embeddedCell.attributes);
                            var link = LilyContactFlow.graph.getConnectedLinks(embeddedCell)[0];
                            if(link){
                                links.push(link.attributes);
                            }
                        }
                    });
                });

                _.each(links, function(link){
                    var target = link.target && modulesById[link.target.id] !== null? link.target.id : null;
                    branches[link.source.id].transition = target;
                });

                var viewPosition = {
                    x: $("#contact-flow-outer-area").scrollLeft() / LilyContactFlow.graphScale,
                    y: $("#contact-flow-outer-area").scrollTop() / LilyContactFlow.graphScale
                };

                var copyText = LilyContactFlow.serializedJsonsProcessor(modulesById, branches, null, true, viewPosition);

                event.clipboardData.setData('text',copyText);
                event.preventDefault();
                return true;
           }
        }
        return false;
    };

    document.body.addEventListener('cut', function(e){
        var copyDone = copyContactFlow(e);
        // deleting selected cells from current flow
        if(copyDone){
            _.forEach(multiSelect.getSelectedCells(), function(cell){
                if(cell.id !== LilyContactFlow.entryPointNode.id){
                    cell.remove();
                }
            });
        }

    });

    document.body.addEventListener('copy', function(e){
        copyContactFlow(e);
    });

    // when clicking on the joint element jointjs prevent default action of blurring previously focused element
    // this is to blur out previously selected element upon mousedown on joint element 
    document.getElementById('wholePaper').addEventListener('mousedown', function(e){
        document.activeElement.blur();
        document.getElementById('body').click();
        window.getSelection().removeAllRanges();
    });
    var onTextField = function(){
        var selection = window.getSelection();
        if(selection && selection.toString().length > 0){
            return true;
        }

        var activeElement = document.activeElement;
        if(activeElement.tagName !=="BODY" || activeElement.classList.contains("modal-open")){
            return true;
        }

        return false;
    };

    document.body.addEventListener('paste', function(e){
        if(!onTextField()){
            displayError(false); //hide any error that's currently being displayed regarding paste
            var clipboardData = e.clipboardData.getData('text');
            if(clipboardData === previousPasted){
                curPasteMargin += pasteMargin;
            }else {
                previousPasted = clipboardData;
                curPasteMargin = pasteMargin;
            }

            try {
                clipboardData = JSON.parse(clipboardData);
            }catch(error) {
                displayError(true);
                return;
            }
            if(!clipboardData.modules){
                displayError(true);
                return;
            }
            if(clipboardData.modules.length > 0){
                sanitizeJSON(clipboardData);
    
                LilyContactFlow.deserializeContactFlow(clipboardData, function(nodes, invalidModule){
                    if(invalidModule){
                        displayError(true);
                        return;
                    }else {
                        multiSelect.selectCells(nodes, function(){
                            LilyContactFlow.resizePaperToFit();
                        });
                    }
    
                }, true, true);

            }

        }
    });

    var sanitizeJSON = function(pastedJSON){
        var newPosition = getNewPosition(pastedJSON);
        var newUUIDMap = {};
        _.forEach(pastedJSON.modules, function(module) {
            var newId = joint.util.uuid();
            newUUIDMap[module.id] = newId;
            module.id = newId;
            // updating position
            module.metadata.position.x += newPosition.x;
            module.metadata.position.y += newPosition.y;
        });

        _.forEach(pastedJSON.modules, function(module) {
            _.forEach(module.branches, function(branch){
                branch.transition = newUUIDMap[branch.transition];
            });
            if(module.metadata.fragments) {
                _.forEach(_.keys(module.metadata.fragments), function(fragment){
                    module.metadata.fragments[fragment] = newUUIDMap[module.metadata.fragments[fragment]];
                });
            }
        });

    };

    var getNewPosition = function(pastedJSON){
        var currentlyVisibleCanvas= new g.Rect(
            $("#contact-flow-outer-area").scrollLeft() / LilyContactFlow.graphScale,
            $("#contact-flow-outer-area").scrollTop() / LilyContactFlow.graphScale,
            $('#contact-flow-outer-area').width() / LilyContactFlow.graphScale,
            $('#contact-flow-outer-area').height() / LilyContactFlow.graphScale);
        
        // check if there's visible block when pasted relative to viewable canvas of where copy was done
        var copiedViewPosition = pastedJSON.metadata.viewPosition || { x: 0, y: 0 };
        var translateCoordinate = {
            x: currentlyVisibleCanvas.x + curPasteMargin - copiedViewPosition.x,
            y: currentlyVisibleCanvas.y + curPasteMargin - copiedViewPosition.y
        };
        if(viewableInCanvas(pastedJSON.modules, currentlyVisibleCanvas, translateCoordinate)){
            return translateCoordinate;
        }

        // check if there's visible block when top left corner of the border of selected cells is moved to be on currently viewable canvas
        var minPositions = getMinPosition(pastedJSON.modules);
        translateCoordinate = {
            x: currentlyVisibleCanvas.x + curPasteMargin - minPositions.minXPosition.x,
            y: currentlyVisibleCanvas.y + curPasteMargin - minPositions.minYPosition.y
        };
        if(viewableInCanvas(pastedJSON.modules, currentlyVisibleCanvas, translateCoordinate)){
            return translateCoordinate;
        }

        // if both move cases don't place any of the pasted blocks on viewable canvas, set block with minXPosition to be on top left corner of currently viewable canvas
        return {
            x: currentlyVisibleCanvas.x + curPasteMargin - minPositions.minXPosition.x,
            y: currentlyVisibleCanvas.y + curPasteMargin - minPositions.minXPosition.y
        };
        
    };

    var viewableInCanvas = function(modules, currentlyViewableCanvasRect, translateCoordinate){
        var viewable = false;
        _.forEach(modules, function(module){
            if (!module.metadata.position) {
                module.metadata = _.extend(module.metadata, {
                    position: {
                        x: 0,
                        y: 0
                    }
                });
            }
            var moduleBbox = new g.Rect(
                module.metadata.position.x + translateCoordinate.x,
                module.metadata.position.y + translateCoordinate.y,
                LilyContactFlow.Sizes.MODULE_WIDTH,
                LilyContactFlow.getModuleHeight(module.parameters? module.parameters.length:0, true) + LilyContactFlow.Sizes.HEADER_HEIGHT
            );

            if(currentlyViewableCanvasRect.intersect(moduleBbox)){
                viewable = true;
                return;
            }
        });

        return viewable;

    };

    var getMinPosition = function(modules){
        var minXPosition,minYPosition;
        _.forEach(modules, function(module){
            var position = module.metadata.position;
            if(!minXPosition || minXPosition.x > position.x){
                minXPosition = position;
            }

            if(!minYPosition || minYPosition.y > position.y){
                minYPosition = position;
            }

        });

        return {
            minXPosition: minXPosition,
            minYPosition: minYPosition
        };
    };
};


/**
 *  @desc: Directive to support for set voice block in contact flow
 */


LilyContactFlow.VoiceService = function(isAutoResolveToBestSoundingVoiceEnabled) {
    var conversationalMap = {};
    
    var supportEngine = function(voice, engine){
        if(!conversationalMap || !conversationalMap[voice]){
            return false;
        }

        return  conversationalMap[voice].supportedEngines.indexOf(engine) !== -1;
    };

    var supportConversational = function(voice){
        if(!conversationalMap){
            return false;
        }

        return conversationalMap[voice].supportedSpeakingStyles && conversationalMap[voice].supportedSpeakingStyles.indexOf(LilyContactFlow.SetVoiceModuleDefaultValue.NTTS_STYLE_CONVERSATIONAL) !== -1;    
    };


    LilyContactFlow.VoiceService.prototype.initializeSupportNeuralConversationalMap = function(data){
        var ALLOWED_CONVERSATIONAL_VOICES = ["Joanna", "Matthew"];
        var ALLOWED_NEWSCASTER_VOICES = ["Joanna", "Matthew", "Lupe"];
        conversationalMap = {};
        data.forEach(function(voice){
            var supportedSpeakingStyles = [];
            conversationalMap[voice.id] = {
                supportedEngines: voice.supportedEngines
            };
            if(conversationalMap[voice.id].supportedEngines.indexOf(LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_NEURAL.toLowerCase()) !== -1){
                supportedSpeakingStyles.push(LilyContactFlow.SetVoiceModuleDefaultValue.NTTS_STYLE_NEURAL_NONE);
                if(ALLOWED_CONVERSATIONAL_VOICES.indexOf(voice.id) !== -1){
                    supportedSpeakingStyles.push(LilyContactFlow.SetVoiceModuleDefaultValue.NTTS_STYLE_CONVERSATIONAL);
                }
                if(ALLOWED_NEWSCASTER_VOICES.indexOf(voice.id) !== -1){
                    supportedSpeakingStyles.push(LilyContactFlow.SetVoiceModuleDefaultValue.NTTS_STYLE_NEWSCASTER);
                }
                conversationalMap[voice.id].supportedSpeakingStyles = supportedSpeakingStyles;
            }
        });
    };

    LilyContactFlow.VoiceService.prototype.allowNeural = function(voice){
        return supportEngine(voice, LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_NEURAL.toLowerCase());
    };

    LilyContactFlow.VoiceService.prototype.allowStandard = function(voice){
        return supportEngine(voice, LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_STANDARD.toLowerCase());
    };
    
    LilyContactFlow.VoiceService.prototype.allowConversational = function(voice){
        return supportConversational(voice);
    };

    LilyContactFlow.VoiceService.prototype.getSupportedSpeakingStyles = function(voice){
        return conversationalMap[voice].supportedSpeakingStyles;
    };
    
    LilyContactFlow.VoiceService.prototype.getDefaultVoiceStyle = function(voice){
        if(supportEngine(voice, LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_NEURAL.toLowerCase())){
            if(isAutoResolveToBestSoundingVoiceEnabled){
                if(supportConversational(voice)){
                    return LilyContactFlow.SetVoiceModuleDefaultValue.NTTS_STYLE_CONVERSATIONAL;
                }else {
                    return LilyContactFlow.SetVoiceModuleDefaultValue.NTTS_STYLE_NEURAL_NONE;
                }
            }
            if(!supportEngine(voice, LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_STANDARD.toLowerCase())){
                return LilyContactFlow.SetVoiceModuleDefaultValue.NTTS_STYLE_NEURAL_NONE;
            }
        }
    
        return LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_STANDARD;

    };

    LilyContactFlow.VoiceService.prototype.getDefaultVoiceEngine = function(voice){
        if(LilyContactFlow.VoiceService.prototype.getDefaultVoiceStyle(voice) === LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_STANDARD){
            return LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_STANDARD;
        } else {
            return LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_NEURAL;
        }
    };

};

angular.module('ContactFlowsModule', ['ngResource', 'tap.selectors', 'ui.bootstrap', 'ui.bootstrap.tooltip', 'ui.bootstrap.modal', 'AWS-UI-Components', 'phoneNumberModule', 'Lily.InputFieldVerifications','lily.widgets'])
.constant('LilyContactFlow', LilyContactFlow)
.controller("ContactFlowsController", function($scope, $modal, $timeout, $window, $location, $http, $document, LilyContactFlow, ContactFlowService, phoneNumberFormatterFactory, AvailableCountriesService, id, type, token, canEdit,
                                                               isOrgContactFlowLoggingEnabled, defaultLexRegion, status, versionTimestamp, canViewHistoricalChanges, entityType, SelectorService) {
    angular.extend($scope, {
        localizedContactFlowTypeMap: {
            agentHold: LilyContactFlow.getString('lily-admin-contact-flow-type-agent-hold'),
            agentWhisper: LilyContactFlow.getString('lily-admin-contact-flow-type-agent-whisper'),
            contactFlow: LilyContactFlow.getString('lily-admin-contact-flow-type-inbound'),
            customerHold: LilyContactFlow.getString('lily-admin-contact-flow-type-customer-hold'),
            customerQueue: LilyContactFlow.getString('lily-admin-contact-flow-type-customer-queue'),
            customerWhisper: LilyContactFlow.getString('lily-admin-contact-flow-type-customer-whisper'),
            outboundWhisper: LilyContactFlow.getString('lily-admin-contact-flow-type-outbound-whisper'),
            agentTransfer: LilyContactFlow.getString('lily-admin-contact-flow-type-agent-transfer'),
            queueTransfer: LilyContactFlow.getString('lily-admin-contact-flow-type-queue-transfer')

        },
        getLocalizedFlowType: function(){
            if(entityType === LilyContactFlow.entityTypes.MODULE){
                return LilyContactFlow.getString('lily-admin-flow-module');
            }else {
                return $scope.localizedContactFlowTypeMap[$scope.contactFlowType];
            }
        },
        pageHeader: LilyContactFlow.getString('lily-admin-contact-flow-page-header')
    });

    angular.extend($scope, {
        numericComparatorConditions: [
            {name: LilyContactFlow.getString('lily-admin-contact-flow-condition-equals'), value: "Equals", shortDisplay: "="},
            {name: LilyContactFlow.getString('lily-admin-contact-flow-condition-less-than'), value: "LessThan", shortDisplay: "<"},
            {name: LilyContactFlow.getString('lily-admin-contact-flow-condition-less-or-equal'), value: "LessThanOrEqualTo", shortDisplay: "<="},
            {name: LilyContactFlow.getString('lily-admin-contact-flow-condition-greater-than'), value: "GreaterThan", shortDisplay: ">"},
            {name: LilyContactFlow.getString('lily-admin-contact-flow-condition-greater-or-equal'), value: "GreaterThanOrEqualTo", shortDisplay: ">="}
        ],
        stringComparatorConditions: [
            {name: LilyContactFlow.getString('lily-admin-contact-flow-condition-equals'), value: "EQ", shortDisplay: "="},
            {name: LilyContactFlow.getString('lily-admin-contact-flow-condition-starts-with'), value: "StartsWith", shortDisplay: "starts with"},
            {name: LilyContactFlow.getString('lily-admin-contact-flow-condition-ends-with'), value: "EndsWith", shortDisplay: "ends with"},
            {name: LilyContactFlow.getString('lily-admin-contact-flow-condition-contains'), value: "Contains", shortDisplay: "contains"}
        ],
        statuses: [
            'Available',
            'Staffed',
            'Online'
        ],
        TextToSpeechType: [
            {name: LilyContactFlow.getString('lily-admin-contact-flow-tts-text'), value: "text"},
            {name: LilyContactFlow.getString('lily-admin-contact-flow-tts-ssml'), value: "ssml"}
        ],
        channelType:{
            VOICE: "voice",
            CHAT: "chat",
            TASK: "task"
        },
        checkQueueStatusAttributes: [
            { name: LilyContactFlow.getString('lily-admin-contact-flow-time-in-queue'), value: "Time in Queue" },
            { name: LilyContactFlow.getString('lily-admin-contact-flow-queue-capacity'), value: "Queue Capacity" }
        ],
        // See https://docs.aws.amazon.com/polly/latest/dg/SupportedLanguage.html
        ttsLanguages: [
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-arabic"), code: "arb"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-chinese-mandarin"), code: "cmn-CN"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-danish"), code: "da-DK"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-dutch"), code: "nl-NL"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-english-au"), code: "en-AU"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-english-br"), code: "en-GB"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-english-in"), code: "en-IN"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-english-us"), code: "en-US"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-english-we"), code: "en-GB-WLS"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-french"), code: "fr-FR"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-french-ca"), code: "fr-CA"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-german"), code: "de-DE"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-icelandic"), code: "is-IS"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-italian"), code: "it-IT"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-japanese"), code: "ja-JP"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-korean"), code: "ko-KR"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-norwegian"), code: "nb-NO"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-polish"), code: "pl-PL"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-portuguese"), code: "pt-PT"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-portuguese-br"), code: "pt-BR"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-romanian"), code: "ro-RO"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-russian"), code: "ru-RU"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-spanish-es"), code: "es-ES"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-spanish-mx"), code: "es-MX"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-spanish-us"), code: "es-US"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-swedish"), code: "sv-SE"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-turkish"), code: "tr-TR"},
            {name: LilyContactFlow.getString("lily-admin-contact-flow-tts-voice-welsh"), code: "cy-GB"}
        ],

        errorTypes: {
            INVALID_PARAMETER_VALUE: "invalidParameterValue",
            INVALID_PARAMETER_TYPE: "invalidParameterType",
            DUPLICATE_PARAMETER: "duplicateParameter",
            MISSING_PARAMETER: "missingParameter",
            BAD_TRANSITION: "badTransition",
            INVALID_BRANCH: "invalidBranch",
            DUPLICATE_BRANCH: "duplicateBranch",
            MISSING_BRANCH: "missingBranch",
            DUPLICATE_NAME: "duplicateName",
            INTERNAL_FAILURE: "internalFailure",
            QUOTA_LIMIT : "quotaLimit",
            INVALID_MODULE_TYPE : "invalidModuleType",
            INCORRECT_FLOW_TYPE: "incorrectFlowType",
            INVALID_JSON: "invalidJson",
            FILE_TOO_LARGE: "fileTooLarge",
            INVALID_RESOURCE: "invalidResource"
        },

        contactFlowTypes: LilyContactFlow.contactFlowTypes,
        entityTypes: LilyContactFlow.entityTypes,

        duplicateBlockErrorHeader:  LilyContactFlow.getString("lily-admin-contact-flow-error-duplicate-block-header"),
        duplicateDialBlockError:  LilyContactFlow.getString("lily-admin-contact-flow-error-duplicate-dial-block"),
        badDialBlockPlacementError:  LilyContactFlow.getString("lily-admin-contact-flow-error-bad-dial-block-placement"),
        badTransitionStringHeader: LilyContactFlow.getString('lily-admin-contact-flow-error-bad-transition-string-header'),
        badTransitionStringBody: LilyContactFlow.getString('lily-admin-contact-flow-error-bad-transition-string-body'),
        duplicateTransitionStringHeader: LilyContactFlow.getString('lily-admin-contact-flow-error-duplicate-transition-string-header'),
        duplicateTransitionStringBody: LilyContactFlow.getString('lily-admin-contact-flow-error-duplicate-transition-string-body'),
        badParameterStringHeader: LilyContactFlow.getString('lily-admin-contact-flow-error-bad-parameter-string-header'),
        badParameterStringBody: LilyContactFlow.getString('lily-admin-contact-flow-error-bad-parameter-string-body'),
        badBlockPlacementHeader: LilyContactFlow.getString('lily-admin-contact-flow-error-bad-block-placement-header'),
        badBlockPlacementLoopAfterLoopBody: LilyContactFlow.getString('lily-admin-contact-flow-error-bad-block-placement-loop-after-loop-body'),
        badBlockPlacementBeforeLoopBody: LilyContactFlow.getString('lily-admin-contact-flow-error-bad-block-placement-before-loop-body'),
        multipleProblemsStringHeader: LilyContactFlow.getString('lily-admin-contact-flow-error-multiple-problems-string-header'),
        multipleProblemsBadTransition: LilyContactFlow.getString('lily-admin-contact-flow-error-multiple-problems-bad-transition'),
        multipleProblemsDuplicateTransition: LilyContactFlow.getString('lily-admin-contact-flow-error-multiple-problems-duplicate-transition'),
        multipleProblemsBadParameter: LilyContactFlow.getString('lily-admin-contact-flow-error-multiple-problems-bad-parameter'),
        invalidModuleTypeStringHeader: LilyContactFlow.getString('lily-admin-contact-flow-error-invalid-module-type-string-header'),
        invalidModuleTypeStringBody: LilyContactFlow.getString('lily-admin-contact-flow-error-invalid-module-type-string-body')
    });

    //This do in more general way but mainly for removing duplicated "Equals" since the server side doesn't care if the value is number or string.
    $scope.allComparatorConditions = _.uniq($scope.numericComparatorConditions.concat($scope.stringComparatorConditions), 'name');

    angular.extend($scope, {
        featureAccess: {
            isSetContactFlowBlockFeatureEnabled: function() {
                return LilyContactFlow.isFeatureEnabled("isSetContactFlowBlockFeatureEnabled");
            },
            isSetRoutingProficiencyBlockFeatureEnabled: function() {
                return LilyContactFlow.isFeatureEnabled("isSetRoutingProficiencyBlockFeatureEnabled");
            },
            isFlowModuleEnabled: function() {
                return LilyContactFlow.isFeatureEnabled("isFlowModuleEnabled");
            },
            isUseVoiceAuthenticationEnabled: function() {
                return LilyContactFlow.isFeatureEnabled("isUseVoiceAuthenticationEnabled");
            },
            isCheckOutboundCallStatusEnabled: function() {
                return LilyContactFlow.isFeatureEnabled("isCheckOutboundCallStatusEnabled");
            },
            isLexV2Enabled: function() {
                return LilyContactFlow.isFeatureEnabled("isLexV2Enabled")
            }
        },
        isAutoResolveToBestSoundingVoiceEnabled: LilyContactFlow.isFeatureEnabled("isAutoResolveToBestSoundingVoiceEnabled"),
        isContinueBranchOnWaitBlockEnabled: LilyContactFlow.isFeatureEnabled("isContinueBranchOnWaitBlockEnabled"),
        isQueueMetricsChannelFilterEnabled: LilyContactFlow.isFeatureEnabled("isQueueMetricsChannelFilterEnabled"),
        isLexSentimentOverrideEnabled: LilyContactFlow.isFeatureEnabled("isLexSentimentOverrideEnabled"),
        isStoreCustomerInputTerminatorFeatureEnabled: LilyContactFlow.isFeatureEnabled("isStoreCustomerInputTerminatorFeatureEnabled"),
        isContactLensRealTimeEnabled: LilyContactFlow.isFeatureEnabled("isContactLensRealTimeEnabled")
    });

    angular.extend($scope, {
            hasContactFlowId: function() {
                if(id) {
                    return true;
                } else {
                    return false;
                }
            }

    });

    angular.extend($scope, {
        onInitError: function(data){
            $scope.loading = false;
            window.LILY_FLOWS_APP.app.onInitError(data);
        },
        initializeContactFlow: function() {
            LilyContactFlow.initializePaper(true);
            LilyContactFlow.initializeLeftPaper();
            $(document).ready(function() {
                $("#angularContainer").show();
                LilyContactFlow.shadow = LilyContactFlow.createDropShadow();
                LilyContactFlow.graph.addCells([LilyContactFlow.shadow]);
            });

            LilyContactFlow.defaultLexRegion = defaultLexRegion;

            $scope.token = token;
            $scope.isOrgContactFlowLoggingEnabled = isOrgContactFlowLoggingEnabled === "true";
            $scope.contactFlowType = type;
            $scope.contactFlowStatus = status || "";
            $scope.contactFlowId = id;
            LilyContactFlow.contactFlowType = type;
            LilyContactFlow.entityType = entityType;
            if (type) {
                $scope.supportedBlocks = LilyContactFlow.getSupportedBlocks(entityType, type);
            }
            $scope.entityType = entityType;
            $scope.contactFlow = {};
            $scope.showContactFlowData = false;
            $scope.showLeftPanel = true;
            $scope.editingStatus = {
                isEditingDescription: false,
                isEditingName: false
            };
            $scope.initializeTtsVoices();
            $scope.initializeAgentGroupLevels();
            if (!id) {
                // Defer to give JointJS time to finish booting up
                _.defer(function() {
                    LilyContactFlow.graph.addCells(LilyContactFlow.createEntryPoint());
                });
                window.LILY_FLOWS_APP.app.onInitComplete(null);
                return;
            }
            $scope.hasPaperChanged = false;
            $scope.mouseDown = false;
            $scope.marqueeMode = false;
            $scope.loading = true;
            $scope.saveAsModalVisible = false;
            $scope.exportModalVisible = false;
            $scope.revertPublishedModalVisible = false;
            $scope.revertSavedModalVisible = false;
            $scope.savePublishModalVisible = false;
            $scope.saveModalVisible = false;
            $scope.isAuditAvailable = false;
            ContactFlowService.get({
                id: id,
                status: status
            }, function success(data) {
                if(data.exceptionId && data.messageId){
                    $scope.onInitError(data);
                    return;
                }
                $scope.contactFlow = data;
                $scope.contactFlowStatus = $scope.contactFlow.contactFlowStatus;
                LilyContactFlow.contactFlowType = $scope.contactFlow.contactFlowType;
                $scope.contactFlowType = $scope.contactFlow.contactFlowType;
                $scope.supportedBlocks = LilyContactFlow.getSupportedBlocks(entityType, $scope.contactFlowType);
                 if (!versionTimestamp) {
                    // No need to get the version timestamp and status if CF Versioning is not enabled
                    // Instead display the latest version's status
                    var statusStringId = $scope.contactFlowStatus === "published" ? LilyContactFlow.getString('lily-admin-contact-flow-status-published') : LilyContactFlow.getString('lily-admin-contact-flow-status-saved');
                    $scope.currentVersionPlaceholder = LilyContactFlow.getString('lily-admin-contact-flow-latest-version-option')+": " +statusStringId;
                    $('#s2id_versionSelect  .select2-chosen').text($scope.currentVersionPlaceholder);
                    $scope.renderPaper();

                 } else {
                     ContactFlowService.getContactFlowAudit({
                         id: id,
                         versionTimestamp: versionTimestamp
                     }, function success(data) {
                         $scope.getAuditedContactFlowContent(data[0].fieldChanges);
                         $scope.getAuditedContactFlowStatus(data[0].fieldChanges);
                         $scope.auditUser = data[0].user;
                         $scope.isAuditAvailable = true;
                         $scope.auditTimeChanged = data[0].time;
                         var contactFlowStatus = $scope.contactFlow.contactFlowStatus;
                         // Version to be displayed as "version time: version Status"
                         var statusStringId = contactFlowStatus === "published" ? LilyContactFlow.getString('lily-admin-contact-flow-status-published') : LilyContactFlow.getString('lily-admin-contact-flow-status-saved');
                         $scope.currentVersionPlaceholder = data[0].time + ": " + statusStringId;
                         $('#s2id_versionSelect  .select2-chosen').text($scope.currentVersionPlaceholder);
                         $scope.renderPaper();
                     }, function failure(data) {
                         $scope.loading = false;
                         window.LILY_FLOWS_APP.app.onInitError(data);
                     });
                 }
                $scope.oldFlow = LilyContactFlow.oldFlow;
                // Set width only for new versioning changes
                if(canViewHistoricalChanges === "true"){
                    $scope.setHeaderWidth(true);
                }
                window.LILY_FLOWS_APP.app.onInitComplete($scope.contactFlow);
            }, function failure(data){
                LilyContactFlow.graph.addCells(LilyContactFlow.createEntryPoint());
                $scope.loading = false;
                window.LILY_FLOWS_APP.app.onInitError(data);
            });
        },
        renderPaper: function() {
            LilyContactFlow.graph.addCells(LilyContactFlow.createEntryPoint());

            LilyContactFlow.deserializeContactFlow($scope.contactFlow.contactFlowContent, function() {
                $scope.loading = false;
                LilyContactFlow.resizePaperToFit();
                // This is called from outside of the angular scope, so digest manually
                $scope.$digest();
            });
        },
        getAuditedContactFlowContent: function(changes) {
            angular.forEach(changes, function(change) {
                if (change.fieldName === "content") {
                    if (change.after != null) {
                        $scope.contactFlow.contactFlowContent = change.after;
                    } else {
                        $scope.contactFlow.contactFlowContent = change.before;
                    }
                }
            });
        },
        getAuditedContactFlowStatus: function(changes) {
            angular.forEach(changes, function(change) {
                if (change.fieldName === "status") {
                    if (change.after != null) {
                        $scope.contactFlow.contactFlowStatus = change.after;
                    } else {
                        $scope.contactFlow.contactFlowStatus = change.before;
                    }
                }
            });
        },
        createContactFlow: function(publish, canEdit) {
            if (!publish || publish && $scope.verifyGraphAnalysis()) { // verifyGraphAnalysis if publish is true
                $scope.saveContactFlow(ContactFlowService.create, publish, function(data) {
                    var windowPathPrefix = canEdit ? "edit" : "view";
                    $window.location = windowPathPrefix + "?id=" + data[0].arn;
                    $scope.ongoingUpdate = false;
                    $scope.saveAsModalVisible = false;
                });
            }
        },
        updateContactFlow: function(publish) {
            $scope.saveContactFlow(ContactFlowService.update, publish);
        },

        isValidPhoneNumber: function(value, isNonE164Number){
            var validNonE164NumberRegex = /^\+?[0-9]+$/;
            return isNonE164Number ? validNonE164NumberRegex.test(value) : phoneNumberFormatterFactory.phoneNumberValidator(value);
        },

        saveContactFlow: function(saveFunction, publish, postSuccess, postError) {
            postSuccess = postSuccess || function(){};
            postError = postError || function(){};
            LilyContactFlow.resizePaperToFit(true);
            $scope.saving = true;
            $scope.contactFlow.contactFlowType = $scope.contactFlowType;
            $scope.closeError();
            $scope.closeSuccess();
            $scope.contactFlow.contactFlowStatus = publish ? "published" : "saved";
            $scope.contactFlow.contactFlowContent = LilyContactFlow.serializeContactFlow(publish, $scope.contactFlow.contactFlowType);
            saveFunction({ token: $scope.token }, $scope.contactFlow,
                function success(data) {
                    $scope.saving = false;
                    $scope.saveFailure = false;
                    $scope.saveSuccess = true;
                    $scope.ongoingUpdate = false;
                    $scope.saveModalVisible = false;
                    $scope.savePublishModalVisible = false;
                    $scope.publishModalVisible = false;
                    if(canViewHistoricalChanges === "true"){
                        var statusStringId = publish ? LilyContactFlow.getString('lily-admin-contact-flow-status-published') : LilyContactFlow.getString('lily-admin-contact-flow-status-saved');
                        $scope.currentVersionPlaceholder = LilyContactFlow.getString('lily-admin-contact-flow-latest-version-option')+": " +statusStringId;
                        $('#s2id_versionSelect  .select2-chosen').text($scope.currentVersionPlaceholder);
                    }
                    postSuccess(data);
                }, function failure(data) {
                    $scope.handleSaveError(data.data);
                    $scope.saving = false;
                    $scope.saveSuccess = false;
                    $scope.ongoingUpdate = false;
                    $scope.saveAsModalVisible = false;
                    $scope.saveModalVisible = false;
                    $scope.savePublishModalVisible = false;
                    $scope.publishModalVisible = false;
                    postError(data);
            });
        },
        saveContactFlowName: function(isSubmit) {
            $scope.setHeaderWidth(false);
            var pageHeaderDoc = document.getElementById('page-header-id');
            if (pageHeaderDoc.createTextRange) {
                var part = pageHeaderDoc.createTextRange();
                part.move("character", 0);
                part.select();
            } else if (pageHeaderDoc.setSelectionRange) {
                pageHeaderDoc.setSelectionRange(0, 0);
            }
            //End: Adjusting cursor to point beginning
            pageHeaderDoc.blur();
            $scope.editingStatus.isEditingName=false;
            $scope.isNameHover=false;
        },
        handleSaveError: function(data) {
            $scope.errors = data;
            LilyContactFlow.hideError();
            var errorsForModules = $scope.errors.reduce(function(map, obj) { 
                if (!map[obj.moduleId]) { 
                    map[obj.moduleId] = []; 
                } 
                map[obj.moduleId].push(obj); 
                return map;
            }, {});
            angular.forEach(errorsForModules, function(errors, moduleId) {
                if (errors.length > 1) {
                    $scope.handleMultipleErrors(moduleId, errors);
                } else {
                    $scope.handleSingleError(errors[0]);
                }
            });
        },
        handleMultipleErrors: function(moduleId, errors) {
            var badParameter = false;
            var badTransition = false;
            var duplicateTransition = false;
            var invalidModule = false;
            angular.forEach(errors, function(error) {
                switch (error.errorType) {
                    case $scope.errorTypes.INVALID_PARAMETER_VALUE:
                    case $scope.errorTypes.INVALID_PARAMETER_TYPE:
                    case $scope.errorTypes.INVALID_RESOURCE:
                    case $scope.errorTypes.DUPLICATE_PARAMETER:
                    case $scope.errorTypes.MISSING_PARAMETER:
                        badParameter = true;
                        break;
                    case $scope.errorTypes.BAD_TRANSITION:
                    case $scope.errorTypes.INVALID_BRANCH:
                    case $scope.errorTypes.MISSING_BRANCH:
                        badTransition = true;
                        break;
                    case $scope.errorTypes.DUPLICATE_BRANCH:
                        duplicateTransition = true;
                        break;
                    case $scope.errorTypes.INVALID_MODULE_TYPE:
                        invalidModule = true;
                        break;
                    case $scope.errorTypes.DUPLICATE_NAME:
                        $scope.saveDuplicateFailure = true;
                        break;
                    case $scope.errorTypes.QUOTA_LIMIT:
                        $scope.saveQuotaFailure = true;
                        break;
                    case $scope.errorTypes.INTERNAL_FAILURE:
                        $scope.saveFailure = true;
                        break;
                    default:
                        break;
                  }
            });

            if (invalidModule) {
                LilyContactFlow.showInvalidModuleTypeError(moduleId, $scope.invalidModuleTypeStringHeader, $scope.invalidModuleTypeStringBody);
            } else {
                var errorMessages = [];
                if (badParameter) {
                    errorMessages.push($scope.multipleProblemsBadParameter);
                }
                if (badTransition) {
                    errorMessages.push($scope.multipleProblemsBadTransition);
                }
                if (duplicateTransition) {
                    errorMessages.push($scope.multipleProblemsDuplicateTransition);
                }
                LilyContactFlow.showModuleError(LilyContactFlow.graph.getCell(moduleId), $scope.multipleProblemsStringHeader, errorMessages.join("\n"));
            }
        },
        handleSingleError: function(error) {
            switch (error.errorType) {
                case $scope.errorTypes.INVALID_PARAMETER_VALUE:
                case $scope.errorTypes.INVALID_PARAMETER_TYPE:
                case $scope.errorTypes.INVALID_RESOURCE:
                case $scope.errorTypes.DUPLICATE_PARAMETER:
                case $scope.errorTypes.MISSING_PARAMETER:
                    LilyContactFlow.showParameterError(error.moduleId, error.errorDetails, $scope.badParameterStringHeader, $scope.badParameterStringBody);
                    break;
                case $scope.errorTypes.BAD_TRANSITION:
                case $scope.errorTypes.INVALID_BRANCH:
                case $scope.errorTypes.MISSING_BRANCH:
                    LilyContactFlow.showBranchError(error.moduleId, error.errorDetails, $scope.badTransitionStringHeader, $scope.badTransitionStringBody, $scope.contactFlow.contactFlowContent);
                    break;
                case $scope.errorTypes.DUPLICATE_BRANCH:
                    LilyContactFlow.showBranchError(error.moduleId, error.errorDetails, $scope.duplicateTransitionStringHeader, $scope.duplicateTransitionStringBody, $scope.contactFlow.contactFlowContent);
                    break;
                case $scope.errorTypes.INVALID_MODULE_TYPE:
                    LilyContactFlow.showInvalidModuleTypeError(error.moduleId, $scope.invalidModuleTypeStringHeader, $scope.invalidModuleTypeStringBody);
                    break;
                case $scope.errorTypes.DUPLICATE_NAME:
                    $scope.saveDuplicateFailure = true;
                    break;
                case $scope.errorTypes.QUOTA_LIMIT:
                    $scope.saveQuotaFailure = true;
                    break;
                case $scope.errorTypes.INTERNAL_FAILURE:
                    $scope.saveFailure = true;
                    break;
                default:
                    break;
            } 
        },
        anyError: function() {
            return  $scope.saveFailure ||
                    $scope.saveDuplicateFailure ||
                    $scope.saveQuotaFailure ||
                    $scope.exportFailure ||
                    $scope.importFailure ||
                    $scope.incorrectFlowTypeFailure ||
                    $scope.invalidImportJson ||
                    $scope.importTooLargeFailure ||
                    $scope.exportTooLargeFailure;
        },
        hasPasteError: function(){
            return $scope.pasteFailure;
        },
        hasAlert: function() {
            return $scope.anyError() || $scope.saveSuccess || $scope.hasPasteError();
        },
        close: function() {
            $scope.closeError();
            $scope.closeSuccess();
        },
        closeError: function() {
            LilyContactFlow.hideError();
            $scope.saveFailure = false;
            $scope.saveDuplicateFailure = false;
            $scope.saveQuotaFailure = false;
            $scope.exportFailure = false;
            $scope.importFailure = false;
            $scope.incorrectFlowTypeFailure = false;
            $scope.invalidImportJson = false;
            $scope.importTooLargeFailure = false;
            $scope.exportTooLargeFailure = false;
            $scope.pasteFailure = false;
        },
        closeSuccess: function() {
            $scope.saveSuccess = false;
        },
        invalidContactFlow: function(){
            if ($scope.contactFlow.name === '' || $scope.contactFlow.name === undefined) {
                return true;
            }
            return false;
        },
        disableVersionDropdown: function(){
            return !id;
        },
        createSideInstruction: function(event, createFunction){
            _.defer(function() {
                var parentElementRect = event.currentTarget.getBoundingClientRect();
                var position =  LilyContactFlow.jointVectorizer(LilyContactFlow.leftPaper.viewport).toLocalPoint(parentElementRect.left, parentElementRect.top);
                var cell = new joint.shapes.leftModule({
                    size: { width: parentElementRect.width, height: parentElementRect.height},
                    parentMarkup: event.currentTarget, position: {x: position.x, y: position.y},
                    createFunction: createFunction
                });
                LilyContactFlow.leftGraph.addCell(cell);
                LilyContactFlow.newInstruction = cell;
                LilyContactFlow.newLeftInstruction = true;
                LilyContactFlow.newInstructionDragging = true;
            });
        }, 
        showModal: function(data, additionalFunctions) {
            if($scope.closeModal) {
                //Modal is already open, don't open another one
                return;
            }
            
            // Make sure side sheet works on the copy of the original data.
            $scope.modalData = angular.copy(data);
            $scope.methods = angular.copy(additionalFunctions || {});
            if(data.templateUrl === "_setRoutingProficiency.html"){
                //Loading the AgentGroupLevel data while opening the modal as well for Set Routing Proficiency block
                //The user needn't refresh the page every time there is a change in group levels.
                $scope.initializeAgentGroupLevels();
                $scope.initializeAgentGroups();
            }
            var closeModal = $modal.open({
                templateUrl: data.templateUrl,
                windowClass: 'right-modal',
                backdrop: 'static', // Prevents clicking in the modal backdrop from closing the modal
                keyboard: false, // Prevents pressing esc from closing the modal
                scope: $scope
            }).close;
            $scope.closeModal = function() {
                closeModal();
                $scope.closeModal = null;
            };
            $scope.modelSpecificInitiate(data.initiateMethod);
        },
        saveTransferModal: function() {
            $scope.modalData.phoneNumber = $scope.selectedCountry.code + $scope.modalData.phoneNumber;
            $scope.saveModal();
        },
        saveModal: function() {
            LilyContactFlow.updateModalSave($scope.modalData);
            $scope.closeModal();
        },
        expand: function(moduleGroup) {
            moduleGroup.showModules = !moduleGroup.showModules;
        },
        expandContactFlowData: function() {
            $scope.showContactFlowData = !$scope.showContactFlowData;
        },
        changeLeftPanelView: function() {
            $scope.showLeftPanel = !$scope.showLeftPanel;
        },

        filterModulesOnFeatureAccess: function(module){
            return module.featureAccess === undefined || ($scope.featureAccess[module.featureAccess] && 
                angular.isFunction($scope.featureAccess[module.featureAccess]) && $scope.featureAccess[module.featureAccess]());
        },

        /**
        * This is used to filter a block based on flow type behind a fac.
        * For example, following key is configured in module A:
        * featureAccessFlowTypesFilter: {
        *    isAFeatureEnabled : [OUTBOUND_WHISPER, CUSTOMER_QUEUE]
        * }
        * In the above example, block A would be shown in OUTBOUND_WHISPER and CUSTOMER_QUEUE only when isAFeatureEnabled FAC is enabled.
        *
        * So while featureAccess (see filterModulesOnFeatureAccess), gives us the ability to put a complete block behind FAC, featureAccessFlowTypesFilter
        * provides more fine grained control.
        */
        filterModulesOnFeatureAccessFlowTypes: function(module) {
            if (!angular.isObject(module.featureAccessFlowTypesFilter)) {
                //featureAccessFlowTypesFilter is not defined as an object. Therefore simply ignore this filter and show the block.
                return true;
            }

            var featureAccessName;
            angular.forEach(module.featureAccessFlowTypesFilter, function(flows, featureAccess) {
                if (Array.isArray(flows) && _.contains(flows, $scope.contactFlowType)) {
                    //Contact flow is present in the flows array. Save the corresponding feature access name to be used later.
                    featureAccessName = featureAccess;
                }
            });

            if (featureAccessName && angular.isFunction($scope.featureAccess[featureAccessName]) && $scope.featureAccess[featureAccessName]()) {
                //Feature access is on. Therefore show the block.
                return true;
            } else if (!featureAccessName) {
                //None of the values in featureAccessFlowTypesFilter contains current contact flow type. Therefore nothing to filter. Simply show the block.
                return true;
            } else {
                //This means feature access is off OR the feature access control method is malformed. Therefore do not show the block.
                return false;
            }
        },
        modelSpecificInitiate: function(initiateMethod) {
            if(!initiateMethod) {
                return;
            }
            switch(initiateMethod) {
                case "initializeCountryDropDown":
                    $scope.initializeCountryDropDown();
                    break;
                case "initializeTransferE164":
                    $scope.initializeTransferE164();
                    break;
                default:
                    break;
            }
        },
        // Modal-specific methods
        getRemainingPercent: function(branches) {
            var remainingPercent = 100;
            angular.forEach(branches, function(branch) {
                if (branch.value) {
                    remainingPercent -= branch.value;
                }
            });
            return remainingPercent;
        },
        getAvailablePercent: function(branches, branch) {
            var availablePercent = $scope.getRemainingPercent(branches) - 1;
            if (branch.value) {
                availablePercent += branch.value;
            }
            return Array(availablePercent).fill(0).map(function (num, index) { return index + 1; });
        },
        isPublished: function(status) {
            return status === 'published';
        },
        getSideInstructionClass: function(moduleGroup){
            if(moduleGroup.name === LilyContactFlow.blockGroupTypes.terminate){
                return "sideInstructionForTT";
            } else if (moduleGroup.type === LilyContactFlow.blockGroupTypes.diagnose) {
                return "sideInstructionForDN";
            } else {
                return "sideInstruction";
            }
        },
        zoom: function(zoomIn) {
            LilyContactFlow.zoom(zoomIn);
        },
        onPaperClick: function() {
            $scope.hasPaperChanged = LilyContactFlow.hasPaperChanged;
            $scope.mouseDown = false;
        },
        onMouseDown: function() {
            $scope.mouseDown = true;
        },
        showCurrentStatus: function() {
            return id && !$scope.hasPaperChanged;
        },
        showArn: function() {
            return id;
        },
        verifyCreateContactFlow: function() {
            if ($scope.verifyGraphAnalysis()) {
                $scope.saveAsModalVisible = true;
            }
        },
        onSaveAsModalCancel: function() {
            $scope.saveAsModalVisible = false;
            $scope.saveAsModalDismiss();
        },
        verifyRevertPublished: function() {
            $scope.revertPublishedModalVisible = true;
        },
        revertPublishedModalCancel: function() {
            $scope.revertPublishedModalVisible = false;
            $scope.revertPublishedModalDismiss();
        },
        verifyRevertSaved: function() {
            $scope.revertSavedModalVisible = true;
        },
        revertToOlderVersion: function(isPublished) {
            var status = isPublished ? 'published' : 'saved';
            $window.location.href = 'edit?id=' + id + '&status=' + status;
        },
        revertSavedModalCancel: function() {
            $scope.revertSavedModalVisible = false;
            $scope.revertSavedModalDismiss();
        },
        verifySavePublish: function() {
            if ($scope.verifyGraphAnalysis()) {
                $scope.savePublishModalVisible = true;
            }
        },
        verifyPublish: function() {
            if ($scope.verifyGraphAnalysis()) {
                $scope.publishModalVisible = true;
            }
        },
        publishContactFlow: function(canEdit){
            if(!id){
                $scope.createContactFlow(true, canEdit);
            } else {
                $scope.updateContactFlow(true);
            }
        },
        verifyGraphAnalysis: function() {
            //In-depth analysis of some edge cases
            // Loop prompts cannot follow Loop prompts
            // Play audio / Get customer input / Store customer input must come after Loop prompts
            var graphAnalysisErrors = [];
            $scope.closeError();
            
            var allowedContactFlows = [LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE, LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER];

            var notAllowedBeforeLoopPromptsBlockTypes = [
                LilyContactFlow.disconnectParams.getType(),
                LilyContactFlow.playAudioParams.getType(),
                LilyContactFlow.storeUserInputParams.getType(),
                LilyContactFlow.getUserInputParams.getType(),
                "StoreCustomerInput",
                "InvokeLexBot",
                "PlayAudioAndFetchInput",
                LilyContactFlow.transferToPhoneNumberParams.getType(),
                LilyContactFlow.TransferToQueueModuleTypes.TRANSFER_TO_QUEUE,
                LilyContactFlow.TransferToQueueModuleTypes.CREATE_CALL_BACK,
                LilyContactFlow.startMediaStreamingParams.getType(),
                LilyContactFlow.stopMediaStreamingParams.getType()
            ];

            if(!_.contains(allowedContactFlows, $scope.contactFlowType)){
                return true;
            }

            LilyContactFlow.buildGraphAnalysis();

            //FIXME - Move this logic to flow type validators. 

            if($scope.contactFlowType === LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE){
                angular.forEach(LilyContactFlow.graphAnalysis, function(value, key) {
                    var cellType = LilyContactFlow.graph.getCell(key).attributes.getType();
                    if (cellType === LilyContactFlow.loopAudioParams.getType()) {
                        if (LilyContactFlow.isModuleTypePresent(value.succeedingNodes, [LilyContactFlow.loopAudioParams.getType()])) {
                            graphAnalysisErrors.push({moduleId: key, error: $scope.badBlockPlacementLoopAfterLoopBody});
                        }
                    }
                    if (!LilyContactFlow.isFeatureEnabled("isSupportCustomerQueueFlowWithoutLoopPromptsEnabled") && notAllowedBeforeLoopPromptsBlockTypes.indexOf(cellType) !== -1) {
                        // Check to see if LoopPrompts comes before also, because we
                        // don't need to show a double-error if there's a loop prompts loop
                        if (!LilyContactFlow.isModuleTypePresent(value.precedingNodes, [LilyContactFlow.loopAudioParams.getType()])) {
                            graphAnalysisErrors.push({moduleId: key, error: $scope.badBlockPlacementBeforeLoopBody});
                        }
                    }
                });
            }

            if($scope.contactFlowType === LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER){
                angular.forEach(LilyContactFlow.graphAnalysis, function(value, key) {
                    // Check if dial block exists
                    // if yes then check for duplicates
                    // if yes then check for a presence of media block (play promt for outbound whispher) 
                    var cellType = LilyContactFlow.graph.getCell(key).attributes.getType();
                    if (cellType === LilyContactFlow.dialBlockParams.getType()) {
                        if (LilyContactFlow.isModuleTypePresent(value.succeedingNodes, [LilyContactFlow.dialBlockParams.getType()])) {
                            graphAnalysisErrors.push({moduleId: key, error: $scope.duplicateDialBlockError, header: $scope.duplicateBlockErrorHeader});
                        }
                       var proccedingNodes = [LilyContactFlow.playAudioParams.getType(),
                                              LilyContactFlow.startMediaStreamingParams.getType(),
                                              LilyContactFlow.stopMediaStreamingParams.getType()];

                        if(LilyContactFlow.isModuleTypePresent(value.precedingNodes, proccedingNodes)){
                            graphAnalysisErrors.push({moduleId: key, error: $scope.badDialBlockPlacementError});
                        }
                    }
                });
            }

            angular.forEach(graphAnalysisErrors, function(error) {
                var errorHeader = error.header ? error.header : $scope.badBlockPlacementHeader;
                LilyContactFlow.showModuleError(LilyContactFlow.graph.getCell(error.moduleId), errorHeader, error.error);
            });
            return graphAnalysisErrors.length === 0;
        },
        savePublishModalCancel: function() {
            $scope.savePublishModalVisible = false;
            $scope.savePublishModalDismiss();
        },
        publishModalCancel: function() {
            $scope.publishModalVisible = false;
            $scope.publishModalDismiss();
        },
        verifySave: function() {
            $scope.saveModalVisible = true;
        },
        saveModalCancel: function() {
            $scope.saveModalVisible = false;
            $scope.saveModalDismiss();
        },
        verifyExport: function() {
            $scope.filename = $scope.contactFlow.name;
            $scope.exportModalVisible = true;
            $scope.exporting = false;
        },
        exportModalCancel: function() {
            $scope.exportModalVisible = false;
            $scope.exportModalDismiss();
        },
        exportContactFlow: function(filename) {
            $scope.filename = filename;
            $scope.exporting = true;
            $scope.closeError();
            ContactFlowService.export({
                    id: $scope.contactFlowId,
                    status: $scope.contactFlowStatus
                },
                function success(data) {
                    $scope.exporting = false;
                    $scope.exportFailure = false;
                    $scope.exportSuccess = true;
                    $scope.exportModalVisible = false;
                    $scope.downloadFlow(data[0]);
                }, function failure(data) {
                    $scope.exporting = false;
                    $scope.exportSuccess = false;
                    $scope.exportModalVisible = false;
                    if (!data.data) {
                        $scope.exportFailure = true;
                    } else {
                        switch(data.data[0].errorType) {
                        case($scope.errorTypes.FILE_TOO_LARGE):
                            $scope.exportTooLargeFailure = true;
                            break;
                        default:
                            $scope.exportFailure = true;
                            break;
                        }
                    }
            });
        },
        downloadFlow: function(data) {
            if (!data || !data.contactFlowContent) {
                $scope.exportFailure = true;
                $scope.exportSuccess = false;
            }

            var contactFlowContent = data.contactFlowContent;
            var obj = JSON.parse(contactFlowContent);
            // Backwards compatibility to ensure metadata is an object not an array
            if (Array.isArray(obj.metadata)) {
                var metadata = obj.metadata;
                obj.metadata = {};
                _.each(metadata, function(metadata) {
                    if (metadata.entryPointPosition) {
                        obj.metadata.entryPointPosition = metadata.entryPointPosition;
                    } else if (metadata.snapToGrid) {
                        obj.metadata.snapToGrid = metadata.snapToGrid;
                    }
                });
            }

            obj.metadata.name = $scope.contactFlow.name;
            obj.metadata.description = $scope.contactFlow.description;
            obj.metadata.type = $scope.contactFlow.contactFlowType;
            obj.metadata.status = data.contactFlowStatus;
            obj.metadata.hash = data.exportDataMap.structureHash;

            contactFlowContent = JSON.stringify(obj);

            $scope.filename = $scope.filename;
            var link = document.createElement("a");
            var blob = new Blob([contactFlowContent], {type: 'text/json;charset=utf-8'});
            link.setAttribute("href", $window.URL.createObjectURL(blob));
            link.setAttribute("download", $scope.filename);
            document.body.appendChild(link);
            link.click();
        },
        verifyImport: function() {
            $scope.importing = false;
            $scope.importModalVisible = true;
        },
        importModalCancel: function() {
            $scope.importModalVisible = false;
            $scope.importModalDismiss();
        },
        importContactFlow: function(selectedFile) {
            if (!selectedFile) {
                $scope.ajaxError = "No files selected";
                return;
            }

            var fileReader = new FileReader();
            $scope.importing = true;
            $scope.closeError();

            fileReader.onloadend = function(evt) {

                var fileData = fileReader.result.substr(fileReader.result.indexOf('base64') + 7);
                ContactFlowService.import(
                {
                    fileData: fileData,
                    contactFlowType: $scope.contactFlowType,
                    token: $scope.token
                },
                function success(data) {
                     // clear the graph before importing again or blocks will lay over one another
                     LilyContactFlow.graph.clear();
                     LilyContactFlow.graph.addCells(LilyContactFlow.createEntryPoint());
                     var importResult = data[0];

                     if (!$scope.contactFlow) {
                        // if importing in edit, dont erase all data in the contact flow object
                        $scope.contactFlow = {
                            contactFlowType: $scope.contactFlowType
                        };
                     }

                     $scope.contactFlow.contactFlowContent = importResult.contactFlowContent;

                     var metadata = JSON.parse(importResult.contactFlowContent).metadata;
                     if (metadata) {
                        $scope.contactFlow.name = metadata.name ? metadata.name : null;
                        $scope.contactFlow.description = metadata.description ? metadata.description : null;
                     }

                     LilyContactFlow.deserializeContactFlow($scope.contactFlow.contactFlowContent, function() {
                         // This is called from outside of the angular scope, so digest manually
                         $scope.$digest();
                     });

                     var modulesWithWarningsList = [];
                     _.forEach(importResult.resourceManifest, function(item) {
                        // replacedarn == originalarn, we didnt replace
                        // replacedarn != null, we did replace
                        // replacedarn == null, we cant find with the same name

                        if (_.contains(modulesWithWarningsList, item.moduleId) && (!item.replacedArn || (item.replacedArn !== item.originalArn))) {
                            LilyContactFlow.showModuleWarn(LilyContactFlow.graph.getCell(item.moduleId),
                                LilyContactFlow.getString('lily-admin-contact-flow-import-warning-multiple-header'),
                                LilyContactFlow.getString('lily-admin-contact-flow-import-warning-multiple-body'));
                                return;
                        }
                        if (!item.replacedArn) {
                            modulesWithWarningsList.push(item.moduleId);
                            LilyContactFlow.showModuleWarn(LilyContactFlow.graph.getCell(item.moduleId),
                                LilyContactFlow.getString('lily-admin-contact-flow-import-warning-missing-header'),
                                LilyContactFlow.getString('lily-admin-contact-flow-import-warning-missing-body'));
                        } else if (item.replacedArn !== item.originalArn) {
                            modulesWithWarningsList.push(item.moduleId);
                            LilyContactFlow.showModuleWarn(LilyContactFlow.graph.getCell(item.moduleId),
                                LilyContactFlow.getString('lily-admin-contact-flow-import-warning-replaced-header'),
                                LilyContactFlow.getString('lily-admin-contact-flow-import-warning-replaced-body'));
                        }
                     });

                     LilyContactFlow.resizePaperToFit();
                     $scope.importing = false;
                     $scope.importFailure = false;
                     $scope.importSuccess = true;
                     $scope.importModalVisible = false;
                }, function failure(data){
                     $scope.importing = false;
                     $scope.importSuccess = false;
                     $scope.importModalVisible = false;
                     if (!data.data) {
                         // this is hit if the file cannot be passed to the server side
                         $scope.invalidImportJson = true;
                     } else {
                         switch(data.data[0].errorType) {
                         case($scope.errorTypes.INCORRECT_FLOW_TYPE):
                            $scope.incorrectFlowTypeFailure = true;
                            break;
                         case($scope.errorTypes.INVALID_JSON):
                            $scope.invalidImportJson = true;
                            break;
                         case($scope.errorTypes.FILE_TOO_LARGE):
                            $scope.importTooLargeFailure = true;
                            break;
                         default:
                            $scope.importFailure = true;
                            break;
                         }
                     }
                });
            };
            fileReader.readAsDataURL(selectedFile);
        },
        getItemCountInCollection: function(collection, value) {
            return _.filter(collection, function(collectionValue) {
                return collectionValue === value;
            }).length;
        },
        isInvokeExternalSaveDisabled: function() {
            if (!$scope.modalData.timeoutSec || $scope.modalData.timeoutSec < 1 || $scope.modalData.timeoutSec > 8) {
                return true;
            }
            var variableKeys = $scope.modalData.variables.map(function(variable) {
                return variable.key;
            });
            angular.forEach($scope.modalData.variables, function(variable) {
                if (variable && $scope.getItemCountInCollection(variableKeys, variable) > 1) {
                    return true;
                }
            });
            return false;
        },
        getInvokeExternalKeyInputClass: function(key) {
            if (!key) {
                return '';
            }
            var variableKeys = $scope.modalData.variables.map(function(variable) {
                return variable.key;
            });
            if ($scope.getItemCountInCollection(variableKeys, key) > 1) {
                return 'duplicate';
            }
            return '';
        },
        isCallBackEnqueue: function() {
            return $scope.modalData.isCallBackEnqueue;
        },
        setIsCallBackEnqueue: function(isCallBackEnqueue) {
            $scope.modalData.isCallBackEnqueue = isCallBackEnqueue;
        },
        toggleCountryDropdown: function() {
            $scope.showCountryDropdown = !($scope.showCountryDropdown);
        },
        closeCountryDropdown: function() {
            $scope.showCountryDropdown = false;
        },
        setCountryCode: function(cc) {
            $scope.modalData.countryCode = cc.value;
            $scope.modalData.countryCodePrefix = cc.code;
            $scope.selectedCountry = cc;
            $scope.showCountryDropdown = false;
        },
        initializeCountryDropDown: function() {
            $scope.showCountryDropdown = false;

            $scope.countryList = phoneNumberFormatterFactory.getAllCountryList();
            //the selected country is needed for UI to pre populate. Check either already selected country present if not default to US
            // As a safe guard if US is not present in the list and no pre selected country then pull top country.
            var defaultCountry = ($scope.modalData && $scope.modalData.countryCode) ? $scope.modalData.countryCode : "US";
            $scope.selectedCountry = _.find($scope.countryList, function(country){ return country.value === defaultCountry; });
            $scope.selectedCountry = $scope.selectedCountry ? $scope.selectedCountry : $scope.countryList[0];
            $scope.setCountryCode($scope.selectedCountry);
        },
        initializeTransferE164: function() {
            $scope.showCountryDropdown = false;
            AvailableCountriesService.getDialableCountries(
                {},
                (function success(data) {
                    var countryNames = [];
                    _.forEach(data, function(d) {
                        countryNames.push(d.response);
                    });
                    $scope.countryList = phoneNumberFormatterFactory.getCountryListFromNames(countryNames);
                    //the selected country is needed for UI to pre populate. Check either already selected country present if not default to US
                    // As a safe guard if US is not present in the list and no pre selected country then pull top country.
                    var numberProperties = phoneNumberFormatterFactory.analyzeNumber($scope.modalData.phoneNumber);
                    var defaultCountry = $scope.modalData && $scope.modalData.countryCode && $scope.modalData.countryCode.toLowerCase();
                    if (!($scope.modalData && $scope.modalData.countryCode)) {
                        defaultCountry = (numberProperties && numberProperties.country) ? numberProperties.country : "us";
                    }

                    $scope.selectedCountry = _.find($scope.countryList, function(country){ return country.value === defaultCountry; });
                    $scope.selectedCountry = $scope.selectedCountry ? $scope.selectedCountry : "";
                    $scope.setCountryCode($scope.selectedCountry);
                    $scope.modalData.phoneNumber = numberProperties ? numberProperties.number : $scope.modalData.phoneNumber.replace($scope.selectedCountry.code, "");

                }),
                (function error(data) {
                })
            );
             
        },
        initializeNTTSVoices: function(data) {
            /*
             * supportedEngine is returned as array by getVoice()
             * creating an object for each engine a single voice has.
             * Currently we get - {additionalLanguageCodes: null, gender: "Female", id: "Emma", languageCode: "en-GB", languageName: "British English", name: "Emma", supportedEngines: (2) ["neural", "standard"]}
             * Converting it to :
             * {id: "{"voiceId":"Emma","engine":"Neural"}", languageCode: "en-GB", name: "Emma",  supportedEngines: "Neural"}
             * {id: "{"voiceId":"Emma","engine":"Standard"}", languageCode: "en-GB", name: "Emma",  supportedEngines: "Standard"}
            */
            var newVoices = [];
            data.forEach(function(voice){
                voice.supportedEngines.forEach(function(engine){
                    newVoices.push({
                        id : JSON.stringify({
                            voiceId: voice.id,
                            engine: engine.charAt(0).toUpperCase() + engine.slice(1) //Capitalizing the first letter in engine before storing
                        }),
                        languageCode : voice.languageCode,
                        name : voice.name,
                        supportedEngines : engine.charAt(0).toUpperCase() + engine.slice(1)
                    });
                });
            });
            return newVoices;
        },
        resetSelectedVoiceOptions: function(){
            if(LilyContactFlow.isFeatureEnabled("isSetVoiceBlockWithNTTSConversationalVoicesEnabled")){
                if(!LilyContactFlow.voiceService.allowNeural($scope.modalData.voice)){
                    $scope.modalData.engine = null;
                    $scope.modalData.speakingStyle = null;
                    $scope.modalData.overrideConsoleVoice = null;
                }else if($scope.modalData.speakingStyle && !LilyContactFlow.voiceService.allowConversational($scope.modalData.voice) && $scope.modalData.useVoiceStyle === LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_NEURAL){
                    // in case the speaking style was set to 
                    $scope.modalData.speakingStyle = LilyContactFlow.SetVoiceModuleDefaultValue.NTTS_STYLE_NEURAL_NONE;
                }else if($scope.modalData.speakingStyle && !LilyContactFlow.voiceService.allowStandard($scope.modalData.voice)){
                    // set speakingStyle to Neural if the voice selected doesn't support standard 
                    $scope.modalData.useVoiceStyle = LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_NEURAL;
                    $scope.modalData.speakingStyle = LilyContactFlow.SetVoiceModuleDefaultValue.NTTS_STYLE_NEURAL_NONE;
                }
            }
        },
        initializeTtsVoices: function(callback) {
            callback = callback || function(){};
            if ($scope.ttsVoices) {
                callback();
                return;
            }
            ContactFlowService.getVoices({
            }, function success(data) {
                if(LilyContactFlow.isFeatureEnabled("isSetVoiceBlockWithNTTSConversationalVoicesEnabled")){
                    $scope.ttsVoices = data;
                    LilyContactFlow.voiceService.initializeSupportNeuralConversationalMap(data);
                } else if(LilyContactFlow.isFeatureEnabled("isSetVoiceBlockWithNTTSVoicesEnabled")){
                    $scope.ttsVoices = $scope.initializeNTTSVoices(data);
                } else {
                    $scope.ttsVoices = data;
                }
                // Filter out any languages that have no voices - this way we can pre-translate before the voices come out
                $scope.ttsLanguages = $scope.ttsLanguages.filter(function(language) {
                    return $scope.ttsVoices.some(function(voice) {
                        return voice.languageCode === language.code;
                    });
                });
                callback();
            }, function error(data) {
                callback();
            });
        },
        storeUserInputModuleHasInputErrors : function() {
            if(!$.isNumeric($scope.modalData.timeoutSec) || +$scope.modalData.timeoutSec < 1) {
                return true;
            }
            if ($scope.modalData.customerInputType === LilyContactFlow.StoreUserInputType.CUSTOM) {
                if(!$.isNumeric($scope.modalData.maxDigits) || +$scope.modalData.maxDigits < 1) {
                    return true;
                }
                if($scope.modalData.encryptEntry) {
                    if($scope.isNullOrUndefinedOrEmpty($scope.modalData.encryptionKeyId) || $scope.isNullOrUndefinedOrEmpty($scope.modalData.encryptionKey)) {
                        return true;
                    }
                    if($scope.modalData.useDynamicForEncryptionKeys) {
                        if($scope.isNullOrUndefinedOrEmpty($scope.modalData.encryptionKeyIdNamespace) || $scope.isNullOrUndefinedOrEmpty($scope.modalData.encryptionKeyNamespace)) {
                            return true;
                        }
                    }
                }
            }

            return false;
        },

        dialBlockModuleHasInputErrors : function() {
            var hasErrors = false;
            if($scope.modalData.setOptionalCallerId) {
                if($scope.modalData.callerIdSource === "dynamic") {
                    if($scope.isNullOrUndefinedOrEmpty($scope.modalData.namespace) || $scope.isNullOrUndefinedOrEmpty($scope.modalData.value)) {
                        hasErrors = true;
                    }
                } else if($scope.modalData.callerIdSource === "claimed") {
                    if($scope.isNullOrUndefinedOrEmpty($scope.modalData.claimedPhoneNumber)) {
                        hasErrors = true;
                    }
                } else {

                    if($scope.isNullOrUndefinedOrEmpty($scope.modalData.callerId)) {
                        hasErrors = true;
                    }

                    if($scope.modalData.allowNonE164CallerId) {
                        hasErrors = $scope.modalData.invalidNonE164PhoneNumber = !$scope.isValidPhoneNumber($scope.modalData.callerId, true);
                    }else{
                        hasErrors = $scope.modalData.invalidPhoneNumber = !$scope.isValidPhoneNumber($scope.modalData.callerId);
                    }
                }
            }
            return hasErrors;
        },
        isLoopCountInvalid : function() {
            if(!$scope.modalData.useDynamic) {
                // + in front of $scope converts loop count value to integer
                if(!$.isNumeric($scope.modalData.loopCount) || +$scope.modalData.loopCount < 0 || +$scope.modalData.loopCount > 100) {
                    return true;
                }
            }
            return false;
        },
        isNonNegativeInteger: function(value) {
            value = Number(value);
            return Number.isInteger(value) && value >= 0;
        },
        isWaitTimeoutNumeric: function() {
            if (!$scope.modalData.timeout) {
                return false;
            }
            var timeout = $scope.modalData.timeout.value;
            return $.isNumeric(timeout);
        },
        isWaitTimeoutInvalid: function() {
            if ($scope.modalData.useDynamic) {
                return (!(_.isString($scope.modalData.timeout.value) && $scope.modalData.timeout.value.length > 0));
            }
            if (!$scope.isWaitTimeoutNumeric()) {
                return true;
            }
            var timeout = $scope.modalData.timeout.value;
            return $scope.isWaitTimeoutExceeded() || timeout < 1;
        },
        isWaitTimeoutExceeded : function() {
            var MAX_TIMEOUT_SECONDS = 604800; // One week
            if ($scope.modalData.useDynamic) {
                return false;
            }
            if (!$scope.isWaitTimeoutNumeric()) {
                return false;
            }
            var seconds = $scope.modalData.timeout.value; 
            switch ($scope.modalData.timeout.unit.value) {
                case LilyContactFlow.waitTimeUnits.day.value:
                    seconds *= 24;
                    /* falls through */
                case LilyContactFlow.waitTimeUnits.hour.value:
                    seconds *= 60;
                    /* falls through */
                case LilyContactFlow.waitTimeUnits.minute.value:
                    seconds *= 60;
                    /* falls through */
                default:
                    // Do nothing
            }
            return seconds > MAX_TIMEOUT_SECONDS;
        },

        enqueueModuleHasInputErrors : function() {
            var threeDaysInSec = 3 * 24 * 60 * 60; //3days
            if($scope.modalData.isCallBackEnqueue) {
                if(!$.isNumeric($scope.modalData.initialDelaySec) || +$scope.modalData.initialDelaySec <= 0 || +$scope.modalData.initialDelaySec > threeDaysInSec) {
                    return true;
                }
                if(!$.isNumeric($scope.modalData.maxAmountOfRetries) || +$scope.modalData.maxAmountOfRetries < 0) {
                    return true;
                }
                if(!$.isNumeric($scope.modalData.retryDelayMinPart) ||
                    !$.isNumeric($scope.modalData.retryDelaySecPart) ||
                    +$scope.modalData.retryDelayMinPart < 0 ||
                    +$scope.modalData.retryDelaySecPart < 0 ||
                    +$scope.modalData.retryDelaySecPart > 60 ||
                    ((+$scope.modalData.retryDelayMinPart) * 60 + (+$scope.modalData.retryDelaySecPart)) > threeDaysInSec ||
                    ((+$scope.modalData.retryDelayMinPart) * 60 + (+$scope.modalData.retryDelaySecPart)) <= 0) {
                    return true;
                }
            }
            return $scope.isQueueInvalid();
        },

        isQueueInvalid: function() {
            if($scope.modalData.setOptionalQueue) {
                if($scope.modalData.useDynamic) {
                    if($scope.isNullOrUndefinedOrEmpty($scope.modalData.namespace) || $scope.isNullOrUndefinedOrEmpty($scope.modalData.queueDynamic)) {
                        return true;
                    }
                } else {
                    if($scope.isNullOrUndefinedOrEmpty($scope.modalData.queue)) {
                        return true;
                    }
                }
            }
            return false;
        },

        areCheckQueueMetricsConditionsInvalid: function() {
            return $scope.modalData.conditions.some(function(c) {
                return !$scope.isNonNegativeInteger(c.value);
            });
        },

        isTransferTimeoutValid: function(val) {
            return $scope.isInputNumberInRange(val, 1, 600);
        },

        isInputNumberInRange: function(inputNumber, min, max) {
            if (_.isNumber(inputNumber) && inputNumber >= min && inputNumber <= max) {
                return true;
            }
            return false;
        },

        resetQueueValue: function() {
            $scope.modalData.queue = null;
        },

        resetChannelValue: function() {
            $scope.modalData.selectedChannel = $scope.channelType.VOICE;
            $scope.modalData.channelDynamic = null;
            $scope.modalData.channelNamespace = null;
        },

        isPromptInvalid: function() {
            if($scope.modalData.useDynamic) {
                if($scope.isNullOrUndefinedOrEmpty($scope.modalData.namespace) || $scope.isNullOrUndefinedOrEmpty($scope.modalData.attribute)) {
                    return true;
                }
            } else {
                if($scope.isNullOrUndefinedOrEmpty($scope.modalData.prompt)) {
                    return true;
                }
            }
            return false;
        },

        getMetricDataModuleHasInputError : function() {
            return $scope.isQueueInvalid();
        },
        isNullOrUndefinedOrEmpty : function(val) {
            if (typeof(val) !== "undefined" && val !== null && val !== "") {
                return false;
            }
            return true;
        },
        isValidDtmfDigits: function(val) {
            var regex = new RegExp("^[\\d,#\*]{1,50}$");
            return regex.test(val);
        },
        isGetCustomerInputSaveDisabled: function() {
            if(!$scope.checkDynamicVariablesNamespace()) { return true; }

            if(!$scope.modalData.useTts && $scope.isPromptInvalid()) { return true; } 

            if ($scope.modalData.useDtmf) {
                return $scope.modalData.timeoutSec < 1 || $scope.modalData.timeoutSec === undefined || !$scope.modalData.validateDtmfConditions($scope.modalData.dtmfConditions, $scope.modalData.maxDigits);
            } else {
                return !$scope.modalData.lexBot || !$scope.modalData.lexBotAlias || !$scope.modalData.validateLexConditions($scope.modalData.lexConditions) || !$scope.modalData.validateSentimentOverrideConditions($scope.modalData);
            }
        },
        checkDynamicVariablesNamespace: function() {
            if ($scope.modalData.variables){
                for (var i = 0 ; i < $scope.modalData.variables.length ; ++i) {
                    if ($scope.modalData.variables[i].useDynamic && !$scope.modalData.variables[i].namespace) {
                        return false;
                    }
                }
            }
            return true;
        },
        setVoiceOptions: function(language, onSelectLanguage) {
            $scope.initializeTtsVoices(function() {
                var voices = $scope.ttsVoices;
                $scope.voiceOptions = voices.filter(function(voice) {
                    return voice.languageCode === language;
                });
                if (onSelectLanguage) {
                    $scope.modalData.voice = $scope.voiceOptions[0].id;
                }
                $scope.resetSelectedVoiceOptions();
            });
        },
        initializeLanguage: function(voice) {
            if ($scope.modalData.language) {
                $scope.setVoiceOptions($scope.modalData.language, false);
                return;
            }
            $scope.initializeTtsVoices(function() {
                var voices = $scope.ttsVoices;
                angular.forEach(voices, function(v) {
                    if (_.isEqual(v.id,voice) ){
                        $scope.modalData.language = v.languageCode;
                        $scope.setVoiceOptions(v.languageCode, false);
                    }
                });
            });
        },
        isInputNumberGreaterThan0: function(val) {
            if (!_.isNumber(val) || val <= 0) {
                return false;
            }
            return true;
        },
        disableSaveStartMediaStreaming: function(){
            if(!$scope.modalData.fromCustomer && !$scope.modalData.toCustomer){
                return true;
            }
            return false;
        },
        disableSaveTransferBlockWithDtmfAndBlindTransferSupport: function() {
             if (!$scope.modalData.timeout.value) {
                 return true;
             }

             if($scope.modalData.useDynamic && !$scope.modalData.attribute) {
                 return true;
             } else if (!$scope.modalData.useDynamic && !$scope.modalData.phoneNumber) {
                 return true;
             }

             var requiredAttributeEmpty = false;
             [$scope.modalData.dtmf, $scope.modalData.callerIdName, $scope.modalData.callerIdNumber].forEach(function(item) {
                 if (item && item.checked && !item.value) {
                     requiredAttributeEmpty = true;
                 }
             });

             return requiredAttributeEmpty;
        },
        disableSaveExternalTransfer: function() {

            return !$scope.modalData.isInternal && $scope.modalData.timeoutSec <= 0;
        },
        initializeAgentGroupLevels: function() {
            ContactFlowService.getAgentHierarchyLevels({
                }, function success(data) {
                    $scope.groupLevels = data;
                }, function error(data) {
            });
        },
        initializeAgentGroups : function() {
            // Exposed to $scope for tracking Agent Hierarchy
            $scope.agentHierarchySelection = {
                l1Group: $scope.modalData.agentHierarchySelection.l1Group,
                l2Group: $scope.modalData.agentHierarchySelection.l2Group,
                levels: []
            };
            $scope.agentHierarchySelection.levels = $scope.groupLevels;
            $scope.levelToDisplay = [];
            $scope.optionalLevelPlaceholder = [];
        },
        initializeL1AgentGroup: function() {
           if ($scope.agentHierarchySelection.levels && $scope.agentHierarchySelection.levels.length > 0) {
                // Search level 1 agent groups using name and level Arn since Level 1 has no parent Arn
                SelectorService.setAgentGroupMetadataForLevel(
                    "level1",
                    $scope.agentHierarchySelection.levels[0].arn,
                    '');
                $scope.levelToDisplay[0] = ": " + $scope.groupLevels[0].name;
                $scope.optionalLevelPlaceholder[0] = LilyContactFlow.getString('lily-admin-contact-flow-set-routing-proficiency-required-placeholder');
           } else {
                //When level1 is not present, we want to pass an empty string to selector else it will take an empty object.
                //Empty object -> level and parent arns are "undefined" which causes exceptions while querying from db.
                SelectorService.setAgentGroupMetadataForLevel("level1",'','');
                $scope.levelToDisplay[0] = " ";
                $scope.optionalLevelPlaceholder[0] = LilyContactFlow.getString('lily-admin-contact-flow-set-routing-proficiency-level1-placeholder');
           }
        },
        initializeL2AgentGroup: function() {
            if ($scope.modalData.agentHierarchySelection.l1Group && $scope.agentHierarchySelection.levels.length > 1) {
                // Search level 2 agent groups using name, level Arn and parent Arn - level 1
                SelectorService.setAgentGroupMetadataForLevel(
                    "level2",
                    $scope.agentHierarchySelection.levels[1].arn,
                    $scope.modalData.agentHierarchySelection.l1Group.arn);
                $scope.levelToDisplay[1] = ": " + $scope.groupLevels[1].name;
                $scope.optionalLevelPlaceholder[1] = LilyContactFlow.getString('lily-admin-contact-flow-set-routing-proficiency-optional-placeholder');
            } else {
                //When level2 is not present, we want to pass an empty string to selector else it will take an empty object.
                //Empty object -> level and parent arns are "undefined" which causes exceptions while querying from db.
                SelectorService.setAgentGroupMetadataForLevel("level2",'','');
                $scope.levelToDisplay[1] = " ";
                $scope.optionalLevelPlaceholder[1] = LilyContactFlow.getString('lily-admin-contact-flow-set-routing-proficiency-level2-placeholder');
            }
        },
        // When there is a change in particular level, all the children level should be reinitialized
        // If Level 1 group changes from X -> Y, Level 2 should be reinitialized with children groups of Y
        reinitializeAgentGroupsOnChange: function(level) {
            if(level === 1){
                $scope.modalData.agentHierarchySelection.l2Group = null;
                $scope.initializeL2AgentGroup();
            }
        },
        isSetRoutingAttributeSaveDisabled : function() {
            if(!$scope.modalData.useDynamic && $scope.modalData.agentHierarchySelection.l1Group === null){
                return true;
            } else if($scope.modalData.useDynamic && !$scope.modalData.attribute){
                return true;
            }

            if($scope.isNullOrUndefinedOrEmpty($scope.modalData.expirationTime)){
                return true;
            }
            if(!$scope.modalData.useDynamicExpirationTime && (!$.isNumeric($scope.modalData.expirationTime) || $scope.modalData.expirationTime < 0 || $scope.modalData.expirationTime > 600)){
                return true;
            }
            return false;
        },
        // Shim for ng-options
        translateStatus: function(status) {
            return LilyContactFlow.translateStatus(status);
        },
        setHeaderWidth: function(onload) {
            // Setting header width dynamically wrt width of the text (for the same font and size)
            var pageHeaderDoc = document.getElementById('page-header-id');
            var hiddenDiv = document.getElementById('cf-name-header-id');
            // if length is 0 then add width just enough to show the placeholder
            var contactFlowName = "";
            if(onload) {
                contactFlowName = $scope.contactFlow.name;
            } else {
                contactFlowName = pageHeaderDoc.value;
            }
            if(!contactFlowName){
                pageHeaderDoc.style.width = '206px';
            } else {
                hiddenDiv.innerText = contactFlowName;
                var headerWidth = parseInt(hiddenDiv.clientWidth, 10)+25;
                pageHeaderDoc.style.width = headerWidth+'px';
            }
        },
        openContactFlowVersion: function(selectedTimestamp) {
            var openContactFlowURL = document.requestPathPrefix +"/contact-flows/edit?id=" + id;
            if(selectedTimestamp.id !== "latest"){
                openContactFlowURL += "&versionTimestamp=" + selectedTimestamp.id;
            }
            window.location.href = openContactFlowURL;
        },
        setMultiSelectStatus: function(multiSelectStatus) {
            $scope.marqueeMode = multiSelectStatus.marqueeMode;
            LilyContactFlow.setMultiSelectStatus(multiSelectStatus);
        },
        getGraphScale: function(){
            return LilyContactFlow.graphScale;
        }
    });

    // If the dismiss event is not handled like this,
    // the web page will fail to open the modal in the second time.
    $("#contactflowSaveAsModal").bind('awsui:dismiss', function () {
        $scope.$apply(function () {
            $scope.saveAsModalVisible = false;
        });
    });
    $("#contactflowRevertPublishedModal").bind('awsui:dismiss', function () {
        $scope.$apply(function () {
            $scope.revertPublishedModalVisible = false;
        });
    });
    $("#contactflowRevertSavedModal").bind('awsui:dismiss', function () {
        $scope.$apply(function () {
            $scope.revertSavedModalVisible = false;
        });
    });
    $("#contactflowPublishModal").bind('awsui:dismiss', function () {
        $scope.$apply(function () {
            $scope.publishModalVisible = false;
        });
    });
    $("#contactflowSavePublishModal").bind('awsui:dismiss', function () {
        $scope.$apply(function () {
            $scope.savePublishModalVisible = false;
        });
    });
    $("#contactflowSaveModal").bind('awsui:dismiss', function () {
        $scope.$apply(function () {
            $scope.saveModalVisible = false;
        });
    });
    $("#exportModal").bind('awsui:dismiss', function () {
        $scope.$apply(function () {
            $scope.exportModalVisible = false;
        });
    });
    $("#importModal").bind('awsui:dismiss', function () {
        $scope.$apply(function () {
            $scope.importModalVisible = false;
        });
    });
    $('#contactFlowName').on({
        'mouseenter': function() {
            $(this).tooltip({
                title: function() {
                    return $scope.contactFlow.name;
                },
                trigger: 'manual',
                placement: 'top'
            });

            if ($scope.contactFlow.name.length > 35) {
                $(this).tooltip('show');
            }
        },
        'mouseleave': function() {
            $(this).tooltip('hide');
        }
    });
    $('#contactFlowDescription').on({
        'mouseenter': function() {
            $(this).tooltip({
                title: function() {
                    return $scope.contactFlow.description;
                },
                trigger: 'manual',
                placement: 'top'
            });

            if ($scope.contactFlow.description.length > 35) {
                $(this).tooltip('show');
            }
        },
        'mouseleave': function() {
            $(this).tooltip('hide');
        }
    });

    var getGraphScale = function(){
        return LilyContactFlow.graphScale;
    };

    var onMultiSelectChange = function(change){
        $scope.$apply($scope.setMultiSelectStatus(change.multiSelectStatus));
    };

    $(document).ready(function() {
        var multiSelect = new LilyContactFlow.MultiSelectSupport(LilyContactFlow.paper, LilyContactFlow.graph, getGraphScale, onMultiSelectChange);
        var copyAndPaste = new LilyContactFlow.CopyAndPasteSupport(multiSelect, function(error){
            $scope.pasteFailure = error;
            $scope.$digest();
        });


    });
    
})
.factory('ContactFlowService', function ($rootScope) {

    function serviceInterface(method, args, withPayload=false) {
        if (!withPayload) {
            return function (params, success, failure) {
                const resolvedArgs = args.map(arg => params[arg]);
                return window.LILY_FLOWS_APP.flowService[method](...resolvedArgs)
                    .then(success, failure)
                    .finally(function () {
                        $rootScope.$apply();
                    });
            }
        } else {
            return function (params, data, success, failure) {
                const resolvedArgs = args.map(arg => params[arg]).concat([data]);
                return window.LILY_FLOWS_APP.flowService[method](...resolvedArgs)
                    .then(success, failure)
                    .finally(function () {
                        $rootScope.$apply();
                    });
            }
        }
    }

    return {
        get: serviceInterface('get', ['id', 'status']),
        update: serviceInterface('update', [], true),
        create: serviceInterface('create', [], true),
        export: serviceInterface('export', ['id', 'status']),
        import: serviceInterface('import', ['contactFlowType', 'fileData']),
        getVoices: serviceInterface('getVoices', []),
        listLexBots: serviceInterface('listLexBots', []),
        getContactFlowAudit: serviceInterface('getContactFlowAudit', ['id', 'versionTimestamp']),
        getAgentHierarchyLevels: serviceInterface('getAgentHierarchyLevels', [])
    };
})
.directive('setFocusIf', function() {
    return {
        link: function($scope, $element, $attr) {
            $scope.$watch($attr.setFocusIf, function(value) {
                if ( value ) { $element[0].focus(); }
            });
        }
    };
})
.directive('filemodel', ['$parse', function ($parse) {
    // Directive for uploading file
    return {
        restrict: 'A',
        link: function(scope, element, attrs) {
            var model = $parse(attrs.filemodel);
            var modelSetter = model.assign;

            element.bind('change', function(){
                scope.$apply(function(){
                    modelSetter(scope, element[0].files[0]);
                });
            });
        }
    };
}]);

// Enqueue
//TODO: remove once backfilled
LilyContactFlow.ModuleDecompilerByType.InitiateCallback = function(data) {
    return LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.TransferToQueueModuleTypes.CREATE_CALL_BACK](data);
};

// Basic queue utils 
LilyContactFlow.queueUtils = {
    /*
     * @method getLabelWithQueue
     * @description - fetch the formatted module labels along with the selected queue - Ex: Queue: selected_Queue
     * @param {object} attributes - module attributes
     */
    getLabelWithQueue : function(attributes, prefixString, defaultString) {
        prefixString = prefixString || LilyContactFlow.getString('lily-admin-contact-flow-set-queue-attribute-label-queue');
        defaultString = defaultString || "";
        var queueLabel;
        if (attributes.queue) {
            if (attributes.useDynamic) {
                queueLabel = attributes.queue;
                return prefixString + ": " + LilyContactFlow.getString('lily-admin-contact-flow-set-queue-attribute-label-dynamic') + "(" + queueLabel + ")";
            } else {
                queueLabel = attributes.queue.text;
                return prefixString + ": " + queueLabel;
            }
        }
        else {
            return defaultString; 
        }
    },

    /*
     * @method getLabelWithQueueChannel
     * @description - fetch the formatted module labels along with the selected queue channel - Ex: Channel: selected_QueueChannel
     * @param {object} attributes - module attributes
     */
    getLabelWithQueueChannel : function(attributes, defaultString) {
        var prefixString = LilyContactFlow.getString('lily-admin-contact-flow-get-metric-data-attribute-label-channel');
        defaultString = defaultString || "";
        var channelLabel;
        if (attributes.setOptionalChannel) {
            if (attributes.isChannelDynamic) {
                channelLabel = attributes.channelDynamic;
                return prefixString + ": " + LilyContactFlow.getString('lily-admin-contact-flow-get-metric-data-attribute-label-dynamic') + "(" + channelLabel + ")";
            } else {
                channelLabel = attributes.selectedChannel;
                return prefixString + ": " + channelLabel;
            }
        }
        else {
            return defaultString;
        }
    },
    /*
     * @method getQueueParams
     * @description - Retrieves the module parameters from the module attributes
     * @param {object} data - Module data
     */
    getQueueParams : function(attributes) {
        var queue = attributes.queue, byAgentQueue = attributes.byAgentQueue, parameters, resourceName = null;
        if (queue) {
            if (_.isObject(queue)) {
                resourceName = queue.text;
                queue = queue.id;
            }
            parameters = {
                name: byAgentQueue ? "Agent" : "Queue",
                value: queue,
                namespace: attributes.namespace,
                resourceName: resourceName
            };
        }
        return parameters;
    },

    /*
     * @method decompileQueue
     * @Description - retrieves the Queue related information from the module parameters.
     * @param {object} data - Module data
     */
    decompileQueue : function(data) {
        var source = {};
        source.useDynamic = data.metadata.useDynamic || false;
        _.forEach(data.parameters, function(param) {
            if ((param.name === "Queue" || param.name === "Agent") && param.value !== null) {
                source.byAgentQueue = param.name === "Agent";
                if (source.useDynamic) {
                    source.queue = param.value;
                } else {
                    source.queue = {
                        id: param.value,
                        text: param.resourceName ? param.resourceName :
                            (data.metadata.queue ? data.metadata.queue.text : null)
                    };
                }
                source.namespace = param.namespace || null;
            }
           
        });
        return source;
    },

    /*
     * @method decompileQueueChannel
     * @Description - retrieves the QueueChannel related information from the module parameters.
     * @param {object} data - Module data
     */
    decompileQueueChannel : function(data) {
        var source = {};
        _.forEach(data.parameters, function(param) {
            if (param.name === "QueueChannel" && param.value) {
                source.setOptionalChannel = true;
                source.isChannelDynamic = param.namespace !== undefined && param.namespace !== null;
                 if (source.isChannelDynamic) {
                    source.channelDynamic = param.value;
                 } else {
                    source.selectedChannel = param.value;
                 }
                source.channelNamespace = param.namespace || null;
            }

        });
        return source;
    },


    /*
     * @method setQueueParams
     * @description - sets the queueParams from the module attributes for the UI
     * @param {object} source -  serialized Object for the modal
     * @param {object} attributes - module attributes
     */
    setQueueParams : function(source, attributes) {
        var queueParams = {
            namespace: attributes.namespace || null,
            useDynamic: attributes.useDynamic || false,
            queue: attributes.useDynamic ? null : attributes.queue,
            queueDynamic: attributes.useDynamic ? attributes.queue : null,
            byAgentQueue: attributes.byAgentQueue || false
        };
        return _.extend(source,queueParams);
    }
};


function isCustomerInQueueFlowTransfer(){
    return LilyContactFlow.contactFlowType === "customerQueue";
}

function getTransferToQueueBaseConditions(){
    var branches = [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-at-capacity'),
        condition: "AtCapacity"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
    }];

    if(isCustomerInQueueFlowTransfer()){
        branches.unshift({
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
            condition: "Success"
        });
    }
    return branches;
}


LilyContactFlow.enqueueParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-transfer-queue-label'); },
    getAttributeLabel: function(cell) {
        var prefixLabel = LilyContactFlow.getString('lily-admin-contact-flow-set-queue-attribute-label-queue'),
        defaultLabel = LilyContactFlow.getString('lily-admin-contact-flow-transfer-queue-attribute-label');
        if (cell.model.attributes.isCallBackEnqueue) {
            prefixLabel = defaultLabel = LilyContactFlow.getString('lily-admin-contact-flow-transfer-queue-attribute-label-callback');
        }
        return LilyContactFlow.queueUtils.getLabelWithQueue(cell.model.attributes, prefixLabel, defaultLabel);
    },
    isCallBackEnqueue: false,
    initialDelaySec: 99,
    retryDelaySec: 600,
    maxAmountOfRetries: 1,
    useDynamic: false,
    queue: null,
    namespace: null,
    setOptionalQueue: false,
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_enqueueModal.html",
            isCallBackEnqueue: this.model.attributes.isCallBackEnqueue,
            initialDelaySec: this.model.attributes.initialDelaySec,
            retryDelayMinPart: Math.floor(this.model.attributes.retryDelaySec / 60),
            retryDelaySecPart: this.model.attributes.retryDelaySec - Math.floor(this.model.attributes.retryDelaySec / 60) * 60,
            maxAmountOfRetries: this.model.attributes.maxAmountOfRetries,
            setOptionalQueue: this.model.attributes.queue !== null
        };

        if(!serializedData.isCallBackEnqueue && isCustomerInQueueFlowTransfer()){
            // set explicitly
            serializedData.setOptionalQueue = true;
        }

        serializedData = LilyContactFlow.queueUtils.setQueueParams(serializedData, this.model.attributes);
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        var isEnqueueTypeChanged = self.attributes.isCallBackEnqueue !== data.isCallBackEnqueue;
        self.attributes.isCallBackEnqueue = data.isCallBackEnqueue;
        self.attributes.initialDelaySec = data.initialDelaySec;
        self.attributes.retryDelaySec = data.retryDelayMinPart * 60 + data.retryDelaySecPart;
        self.attributes.maxAmountOfRetries = data.maxAmountOfRetries;
        self.attributes.useDynamic = data.setOptionalQueue ? data.useDynamic : false;
        self.attributes.namespace = data.setOptionalQueue ? (data.useDynamic ? data.namespace : null) : null;
        self.attributes.queue = data.setOptionalQueue ? (data.useDynamic ? data.queueDynamic : data.queue) : null;
        self.attributes.setOptionalQueue = data.setOptionalQueue || false;
        self.attributes.byAgentQueue = data.byAgentQueue || false;

        if(!self.attributes.isCallBackEnqueue && !isCustomerInQueueFlowTransfer()){
            // set explicitly to make sure reflect the same in parameter and label.
            self.attributes.queue = null;
        }

        // Required to make sure modules are connected if we do not change the type
        if(isEnqueueTypeChanged) {
            var view = self.findView(LilyContactFlow.paper);
            if (self.attributes.isCallBackEnqueue) {
                view.mergeInConditions(self, [{
                        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
                        condition: "Success"
                    }, {
                        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
                        condition: "Error"
                }]);
            } else {
                view.mergeInConditions(self, getTransferToQueueBaseConditions());
            }

            self.attributes.size.height = LilyContactFlow.getModuleHeight(self.attributes.conditions.length, true);
        }
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        if (self.attributes.isCallBackEnqueue) {
            return LilyContactFlow.TransferToQueueModuleTypes.CREATE_CALL_BACK;
        } else {
            if (isCustomerInQueueFlowTransfer()) {
                return LilyContactFlow.TransferToQueueModuleTypes.TRANSFER_TO_QUEUE;
            } else {
                return LilyContactFlow.TransferToQueueModuleTypes.CUSTOMER_IN_QUEUE;
            }
        }
    },

    getTarget: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        if (!self.attributes.isCallBackEnqueue) {
            return "Queue";
        }
        return null;
    },

    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var parameters = [];        

        var queueParam = LilyContactFlow.queueUtils.getQueueParams(self.attributes);
        if (queueParam) {
            parameters.push(queueParam);
        }

        if (self.attributes.isCallBackEnqueue) {
            parameters.push({
                name: "InitialDelaySeconds",
                value: self.attributes.initialDelaySec,
            }, {
                name: "RetryDelaySeconds",
                value: self.attributes.retryDelaySec,
            }, {
                name: "MaxRetryAttempts",
                value: self.attributes.maxAmountOfRetries,
            });
        }

        return parameters;
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return {
            "useDynamic": self.attributes.useDynamic,
            "queue":  self.attributes.queue  // TODO remove https://cr.amazon.com/r/7815548/
        };
    },

    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.TT_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.TT_MODULE_HEADER_FONT_COLOR,
        iconClass: "transferToQueue"
    },

    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-at-capacity'),
        condition: "AtCapacity"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
    }],

    sortConditions: function(self) {
        return;
    },
    getBranchLabel: function(node) {
        return node.display;
    },
    getConditionData: function(branch) {
        return {
            condition: branch.condition
        };
    },
    staticConditionIds: []
};

LilyContactFlow.createEnqueueModule = function(x, y) {
    var params = _.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.enqueueParams, {
        baseConditions: getTransferToQueueBaseConditions()
    });

    params.size.height = LilyContactFlow.getModuleHeight(params.baseConditions.length, true);

    var parent = new joint.shapes.module(params);
    var nodes = [parent];
    _.forEach(params.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.TransferToQueueModuleTypes.CUSTOMER_IN_QUEUE] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.enqueueParams);
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.TransferToQueueModuleTypes.TRANSFER_TO_QUEUE] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.enqueueParams, LilyContactFlow.queueUtils.decompileQueue(data),{
        baseConditions: getTransferToQueueBaseConditions()
    });
    baseParams.size.height = LilyContactFlow.getModuleHeight(baseParams.baseConditions.length, true);
    baseParams.id = data.id;
    baseParams.setOptionalQueue = baseParams.queue !== null;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.TransferToQueueModuleTypes.CREATE_CALL_BACK] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.enqueueParams,  LilyContactFlow.queueUtils.decompileQueue(data),
    LilyContactFlow.queueUtils.decompileQueueChannel(data));
    baseParams.id = data.id;
    baseParams.isCallBackEnqueue = true;
    _.forEach(data.parameters, function(param) {
        if (param.name === "InitialDelaySeconds") {
            baseParams.initialDelaySec = Number(param.value);
        } else if (param.name === "RetryDelaySeconds") {
            baseParams.retryDelaySec = Number(param.value);
        } else if (param.name === "MaxRetryAttempts") {
            baseParams.maxAmountOfRetries = Number(param.value);
        }
    });

    baseParams.baseConditions = [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
        condition: "Success"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
    }];

    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Set Queue
LilyContactFlow.setQueueParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-set-queue-label'); },
    getAttributeLabel: function(cell) {
        var queueLabel;
        var attributeLabel = cell.model.attributes.byAgentQueue ? LilyContactFlow.getString('lily-admin-contact-flow-set-queue-attribute-label-agent') : LilyContactFlow.getString('lily-admin-contact-flow-set-queue-attribute-label-queue');
        if (cell.model.attributes.useDynamic) {
            queueLabel = cell.model.attributes.queue ? cell.model.attributes.queue : LilyContactFlow.getString('lily-admin-contact-flow-set-queue-attribute-label-none');
            return attributeLabel + ": " + LilyContactFlow.getString('lily-admin-contact-flow-set-queue-attribute-label-dynamic') + "(" + queueLabel + ")";
        } else {
            queueLabel = cell.model.attributes.queue ? cell.model.attributes.queue.text : "(" + LilyContactFlow.getString('lily-admin-contact-flow-set-queue-attribute-label-none-selected') + ")";
            return attributeLabel + ": " + queueLabel;
        }
    },
    queue: null,
    byAgentQueue: null,
    namespace: null,
    useDynamic: false,
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_setQueueModal.html"
        };
        serializedData = LilyContactFlow.queueUtils.setQueueParams(serializedData, this.model.attributes);
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.queue = data.useDynamic ? data.queueDynamic : data.queue;
        self.attributes.namespace = data.useDynamic ? data.namespace : null;
        self.attributes.useDynamic = data.useDynamic;
        self.attributes.byAgentQueue = data.byAgentQueue || false;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "SetQueue";
    },
    
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var parameters = [];

        var queueParam = LilyContactFlow.queueUtils.getQueueParams(self.attributes);
        if (queueParam) {
            parameters.push(queueParam); 
        }
        
        return parameters;
    },

    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return {
            "useDynamic": self.attributes.useDynamic,
            "queue":  self.attributes.queue // TODO remove https://cr.amazon.com/r/7815548/
        };
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setQueue"
    },
    baseConditions: [{
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
            condition: "Success"
        }, {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
            condition: "Error"
    }]
};
LilyContactFlow.createSetQueueModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.setQueueParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.setQueueParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.setQueueParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.setQueueParams, LilyContactFlow.queueUtils.decompileQueue(data));
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Check queue attributes
LilyContactFlow.ModuleDecompilerByType.CheckQueueAttribute = function(data) {
    return LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.checkQueueStatusParams.getType()](data);
};

LilyContactFlow.checkQueueStatusParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-check-queue-label'); },
    getAttributeLabel: function(cell) { 
        var defaultLabel = LilyContactFlow.getString('lily-admin-contact-flow-check-queue-attribute-label');
        return LilyContactFlow.queueUtils.getLabelWithQueue(cell.model.attributes, null, defaultLabel);
    },
    conditions: [],
    staticConditionIds: [],
    setOptionalQueue: false,
    queue: null,
    useDynamic: false,
    toAngular: function() {
        _.each(this.model.attributes.conditions, function(cond) {
            if (cond.attribute && !cond.attribute.value) {
                var name = cond.attribute;
                cond.attribute = {
                    name: name,
                    value: name
                };
            }
        });
        var serializedData = {
            id: this.model.id,
            templateUrl: "_checkQueueStatusModal.html",
            conditions: this.model.attributes.conditions,
            setOptionalQueue: this.model.attributes.queue !== null
        };

        serializedData = LilyContactFlow.queueUtils.setQueueParams(serializedData, this.model.attributes);

        angular.element($("#angularContainer")).scope().showModal(serializedData, {
            validateConditions: function (conditions) {
                return conditions.every(function (condition) {
                    return condition.value && condition.attribute && condition.operator;
                });
            }
        });
        return serializedData;
    },

    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var parameters = [];

        var queueParam = LilyContactFlow.queueUtils.getQueueParams(self.attributes);
        if (queueParam) {
            parameters.push(queueParam); 
        }
        
        return parameters;
    },

    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.useDynamic = data.setOptionalQueue ? data.useDynamic : false;
        self.attributes.namespace = data.setOptionalQueue ? (data.useDynamic ? data.namespace : null) : null;
        self.attributes.queue = data.setOptionalQueue ? (data.useDynamic ? data.queueDynamic : data.queue) : null;
        self.attributes.setOptionalQueue = data.setOptionalQueue || false;
        self.attributes.byAgentQueue = data.byAgentQueue || false;
        self.findView(LilyContactFlow.paper).mergeInConditions(self, data.conditions);
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },

    sortConditions: function(self) {
        var view = self.findView(LilyContactFlow.paper);
        // Reorder all of the branches such that the bottom two branches are NoMatch and Error
        _.forEach(["NoMatch", "Error"], function(condition) {
            view.moveCellToBottomByCondition(self, condition);
        });
    },
    getBranchLabel: function(node) {
        var shortDisplay = node.operator === null ? "" : node.operator.shortDisplay;
        var nodeValue = node.value == null ? "" : node.value;
        var name = node.attribute.name ? node.attribute.name : node.attribute;
        return name + " " + shortDisplay + " " + nodeValue;
    },
    getType: function() {
        return "CheckQueueStatus";
    },
    getConditionData: function(branch) {
        var conditionData = {};
        if (branch === null) {
            _.extend(conditionData, {"condition": null});
        } else if (branch.attribute.value === "Queue Capacity") {
            _.extend(conditionData, {"condition": "CheckQueueSize"});
        } else if (branch.attribute.value === "Time in Queue") {
            _.extend(conditionData, {"condition": "CheckQueueTime"});
        } else {
            _.extend(conditionData, {"condition": null});
        }

        var value = branch.value;
        switch (branch.time) {
            case 'hrs.':
                value = value*60;
                /* falls through */
            case 'min.':
                value = value*60;
                /* falls through */
            case 'sec.' :
                value = value*1000;
                /* falls through */
            case 'millisec.':
                /* falls through */
            default:
                break;
        }

        return _.extend(conditionData, {
            "conditionType": branch.operator === null ? null : branch.operator.value,
            "conditionValue": value
        });
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var conditionMetadata = [];
        _.forEach(self.attributes.conditions, function(condition) {
            conditionMetadata.push(condition);
        });
        return {
            conditionMetadata: conditionMetadata,
            queue: self.attributes.queue,
            useDynamic: self.attributes.useDynamic
        };
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "checkQueueStatus"
    },
    baseConditions: [{
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-no-match'),
            condition: "NoMatch"
        }, {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
            condition: "Error"
     }]
};
LilyContactFlow.createCheckQueueStatusModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.checkQueueStatusParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.checkQueueStatusParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        parent.attributes.staticConditionIds = _.union(parent.attributes.staticConditionIds, [child.id]);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.checkQueueStatusParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.checkQueueStatusParams, LilyContactFlow.queueUtils.decompileQueue(data));
    baseParams.id = data.id;
    var parent = new joint.shapes.module(baseParams);
    var nodes = [parent];
    // Fill in the other conditions
    var conditions = [];
    _.forEach(data.branches, function(branch, i) {
        if (branch.condition === "NoMatch" || branch.condition === "Error") {
            return;
        }
        var matchingConditionMetadata = [];
        if (data.metadata.conditionMetadata) {
            matchingConditionMetadata = data.metadata.conditionMetadata.filter(function(metadata) {
                var userValue = branch.conditionValue;
                if (metadata.time) {
                    switch (metadata.time) {
                        case 'hrs.':
                            userValue = userValue/60;
                            /* falls through */
                        case 'min.':
                            userValue = userValue/60;
                            /* falls through */
                        case 'sec.' :
                            userValue = userValue/1000;
                            /* falls through */
                        case 'millisec.':
                            userValue = userValue/1;
                            /* falls through */
                        default:
                            break;
                    }

                    return parseInt(metadata.value) === userValue && (metadata.operator === null ? null : metadata.operator.value) === branch.conditionType;
                } else {
                    return metadata.value === branch.conditionValue && (metadata.operator === null ? null : metadata.operator.value) === branch.conditionType;
                }
            });
        }
        if (matchingConditionMetadata.length === 0) {
            return;
        }
        var conditionMetadata = matchingConditionMetadata[0];
        var condition = {};
        var value = conditionMetadata.value;

        _.extend(condition, {
            "condition": branch.condition,
            "conditionType": branch.conditionType,
            "conditionValue": branch.conditionValue
        });

        var newCell = LilyContactFlow.addOutputCondition(parent, parent.attributes.getBranchLabel(conditionMetadata), condition, conditions.length);
        conditionMetadata.id = newCell.id;
        nodes.push(newCell);
        conditions.push(conditionMetadata);
    });
    var noMatch = LilyContactFlow.addOutputCondition(parent, LilyContactFlow.getString('lily-admin-contact-flow-condition-no-match'), "NoMatch", conditions.length);
    var error = LilyContactFlow.addOutputCondition(parent, LilyContactFlow.getString('lily-admin-contact-flow-condition-error'), "Error", conditions.length+1);
    parent.attributes.staticConditionIds = _.union([noMatch.id], [error.id]);
    nodes.push(noMatch);
    nodes.push(error);
    parent.attributes.conditions = conditions;
    parent.resize(parent.get("size").width, parent.get("size").height + LilyContactFlow.Sizes.BRANCH_SPACING * conditions.length);
    return nodes;
};

// Adjust Queue Priority
// TODO: remove once backfill is complete
LilyContactFlow.ModuleDecompilerByType.QueuePriority = function(data) {
    return LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.updateRoutingPriorityParams.getType()](data);
};

LilyContactFlow.updateRoutingPriorityParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(1, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-change-routing-age-label'); },
    getAttributeLabel: function(cell) {
        var label = cell.model.attributes.isAdjustPriority ?
            LilyContactFlow.getString('lily-admin-contact-flow-change-routing-age-attribute-label-priority') + ": " :
            LilyContactFlow.getString('lily-admin-contact-flow-change-routing-age-attribute-label-time') + ": ";
        if (cell.model.attributes.adjustSign) {
            label = label + " " + cell.model.attributes.adjustSign;
        }
        label = label + " " + cell.model.attributes.adjustValue;
        if (cell.model.attributes.adjustUnit) {
            label = label + " " + cell.model.attributes.adjustUnit;
        }
        return label;
    },
    adjustSign: null,
    adjustValue: 1,
    adjustUnit: null,
    isAdjustPriority: true,
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_updateRoutingPriorityModal.html",
            adjustSign: this.model.attributes.adjustSign,
            adjustValue: this.model.attributes.adjustValue,
            adjustUnit: this.model.attributes.adjustUnit,
            isAdjustPriority: this.model.attributes.isAdjustPriority
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.isAdjustPriority = data.isAdjustPriority;
        self.attributes.adjustSign = data.isAdjustPriority ? null : data.adjustSign;
        self.attributes.adjustValue = data.adjustValue;
        self.attributes.adjustUnit = data.isAdjustPriority ? null : data.adjustUnit;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "UpdateRoutingPriority";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        if (self.attributes.isAdjustPriority) {
            return [{
                name: "AbsolutePosition",
                value: self.attributes.adjustValue
            }];
        } else {
            var timeOffset = self.attributes.adjustValue;
            if (self.attributes.adjustSign === "-") {
                timeOffset = timeOffset * -1;
            }
            if (self.attributes.adjustUnit === "minutes") {
                timeOffset *= 60;
            }
            return [{
                name: "TimeOffset",
                value: timeOffset
            }];
        }
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return {
            adjustUnit: self.attributes.adjustUnit
        };

    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setRoutingAgeQueuePosition"
    },
    baseConditions: [{
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
            condition: "Success"
    }]
};
LilyContactFlow.createUpdateRoutingPriorityModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.updateRoutingPriorityParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.updateRoutingPriorityParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.updateRoutingPriorityParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.updateRoutingPriorityParams);
    _.forEach(data.parameters, function(param) {
        if (param.name === "AbsolutePosition" && param.value != null) {
            baseParams.isAdjustPriority = true;
            baseParams.adjustSign = null;
            baseParams.adjustUnit = null;
            baseParams.adjustValue = param.value;
        } else if (param.name === "TimeOffset" && param.value != null) {
            baseParams.isAdjustPriority = false;
            baseParams.adjustSign = param.value < 0 ? "-" : "+";
            baseParams.adjustUnit = data.metadata.adjustUnit;
            baseParams.adjustValue = Math.abs(param.value);
            if (baseParams.adjustUnit === "minutes") {
                baseParams.adjustValue = baseParams.adjustValue / 60;
            }
        }
    });
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Set Metric Data
LilyContactFlow.getMetricDataParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-get-metric-data-label'); },
    getAttributeLabel: function(cell) {
        var defaultQueueLabel = LilyContactFlow.getString('lily-admin-contact-flow-get-metric-data-attribute-label-queue') + ": " + LilyContactFlow.getString('lily-admin-contact-flow-get-metric-data-attribute-label-none-selected');
        var defaultChannelLabel = LilyContactFlow.getString('lily-admin-contact-flow-get-metric-data-attribute-label-channel') + ": " + LilyContactFlow.getString('lily-admin-contact-flow-get-metric-data-attribute-label-default');
        if(LilyContactFlow.isFeatureEnabled("isQueueMetricsChannelFilterEnabled")){
            return LilyContactFlow.queueUtils.getLabelWithQueue(cell.model.attributes, null, defaultQueueLabel) + ", " + LilyContactFlow.queueUtils.getLabelWithQueueChannel(cell.model.attributes, defaultChannelLabel);
        }else{
            return LilyContactFlow.queueUtils.getLabelWithQueue(cell.model.attributes, null, defaultQueueLabel);
        }
    },
    queue: null,
    namespace: null,
    channelDynamic: null,
    channelNamespace: null,
    selectedChannel: null,
    useDynamic: false,
    isChannelDynamic: false,
    setOptionalChannel: false,
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            channelNamespace: this.model.attributes.channelNamespace,
            selectedChannel: this.model.attributes.selectedChannel,
            channelDynamic: this.model.attributes.channelDynamic,
            setOptionalChannel: this.model.attributes.setOptionalChannel || false,
            isChannelDynamic: this.model.attributes.isChannelDynamic,
            templateUrl: "_getMetricDataModal.html",
            setOptionalQueue: this.model.attributes.queue !== null,
        };
        LilyContactFlow.queueUtils.setQueueParams(serializedData, this.model.attributes);
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.isChannelDynamic = data.isChannelDynamic;
        self.attributes.useDynamic = data.setOptionalQueue ? data.useDynamic : false;
        self.attributes.namespace = data.setOptionalQueue ? (data.useDynamic ? data.namespace : null) : null;
        self.attributes.queue = data.setOptionalQueue ? (data.useDynamic ? data.queueDynamic : data.queue) : null;
        self.attributes.setOptionalChannel = data.setOptionalChannel || false;
        self.attributes.channelNamespace = data.isChannelDynamic ? data.channelNamespace : null;
        self.attributes.channelDynamic =  data.channelDynamic;
        self.attributes.selectedChannel = data.selectedChannel;
        self.attributes.byAgentQueue = data.byAgentQueue || false;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "GetMetricData";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var parameters = [];
        var queueParam = LilyContactFlow.queueUtils.getQueueParams(self.attributes);
        if (queueParam) {
            parameters.push(queueParam);
        }

        if(self.attributes.setOptionalChannel && LilyContactFlow.isFeatureEnabled("isQueueMetricsChannelFilterEnabled")){
            var channelValue = self.attributes.isChannelDynamic ? self.attributes.channelDynamic : self.attributes.selectedChannel;
            parameters.push({
                 name: "QueueChannel",
                 value: channelValue,
                 namespace: self.attributes.channelNamespace
             });
        }

        return parameters;
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return {
            "useDynamic": self.attributes.useDynamic,
            "queue":  self.attributes.queue
        };
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "getMetricData"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
        condition: "Success"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
    }]
};
LilyContactFlow.createGetMetricDataModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.getMetricDataParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.getMetricDataParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.getMetricDataParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.getMetricDataParams,  LilyContactFlow.queueUtils.decompileQueue(data),
    LilyContactFlow.queueUtils.decompileQueueChannel(data));
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

//Set routing proficiency
LilyContactFlow.setRoutingProficiencyParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    getLabel: function(cell) {return LilyContactFlow.getString('lily-admin-contact-flow-set-routing-proficiency-label');},
    namespace: null,
    value: "",
    useDynamic: false,
    useDynamicExpirationTime: false,
    namespaceExpirationTime: null,
    agentHierarchySelection: {
        l1Group: null,
        l2Group: null,
    },
    expirationTime: null,
    getAttributeLabel: function(cell) {
        var labelHierarchy, labelExpirationTime;
        if (!cell.model.attributes.useDynamic && cell.model.attributes.agentHierarchySelection.l1Group != null) {
            if(cell.model.attributes.agentHierarchySelection.l1Group != null) {
                labelHierarchy = cell.model.attributes.agentHierarchySelection.l1Group.text;
            }
            if (cell.model.attributes.agentHierarchySelection.l2Group != null){
                labelHierarchy += ": " + cell.model.attributes.agentHierarchySelection.l2Group.text;
            }
        } else if(cell.model.attributes.useDynamic && cell.model.attributes.attribute != null){
            labelHierarchy = cell.model.attributes.namespace + ": " + cell.model.attributes.attribute;
        } else {
            labelHierarchy = LilyContactFlow.getString('lily-admin-contact-flow-module-set-routing-proficiency-label-none');
        }

        if (cell.model.attributes.useDynamicExpirationTime) {
            labelExpirationTime = LilyContactFlow.getString('lily-admin-contact-flow-wait-attribute-label-dynamic') + "(" + cell.model.attributes.expirationTime + ")";
        } else if(cell.model.attributes.expirationTime === null){
            labelExpirationTime = 0;
        } else{
            labelExpirationTime = cell.model.attributes.expirationTime;
        }

        return labelHierarchy + ", " + labelExpirationTime + " " + LilyContactFlow.getString('lily-admin-contact-flow-module-set-routing-proficiency-label-sec');
    },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_setRoutingProficiency.html",
            useDynamic: this.model.attributes.useDynamic,
            namespace: this.model.attributes.useDynamic? this.model.attributes.namespace : null,
            attribute: this.model.attributes.useDynamic? this.model.attributes.attribute : null,
            useDynamicExpirationTime: this.model.attributes.useDynamicExpirationTime,
            expirationTime: this.model.attributes.expirationTime,
            namespaceExpirationTime: this.model.attributes.useDynamicExpirationTime ? this.model.attributes.namespaceExpirationTime : null,
            agentHierarchySelection: {
                l1Group: this.model.attributes.agentHierarchySelection.l1Group,
                l2Group: this.model.attributes.agentHierarchySelection.l2Group
            }
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data){
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.attribute = data.attribute;
        self.attributes.expirationTime = data.expirationTime;
        self.attributes.useDynamic = data.useDynamic;
        self.attributes.namespace = data.namespace;
        self.attributes.useDynamicExpirationTime = data.useDynamicExpirationTime;
        self.attributes.namespaceExpirationTime = data.namespaceExpirationTime;
        self.attributes.agentHierarchySelection.l1Group = data.agentHierarchySelection.l1Group;
        self.attributes.agentHierarchySelection.l2Group = data.agentHierarchySelection.l2Group;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "SetRoutingAttribute";
    },
    getParameters: function() {
        var setRoutingProficiencyParameters = [];
        var self = LilyContactFlow.graph.getCell(this.id);

        setRoutingProficiencyParameters.push({
            name: "AgentHierarchyArn",
            value: self.attributes.useDynamic ? self.attributes.attribute : ( self.attributes.agentHierarchySelection.l2Group ? self.attributes.agentHierarchySelection.l2Group.arn : ( self.attributes.agentHierarchySelection.l1Group? self.attributes.agentHierarchySelection.l1Group.arn : null )),
            namespace: self.attributes.useDynamic ? self.attributes.namespace : null
        });
        setRoutingProficiencyParameters.push({
            name: "AgentHierarchyArnExpirationTimeSeconds",
            value: self.attributes.expirationTime? self.attributes.expirationTime.toString() : null,
            namespace: self.attributes.useDynamicExpirationTime ? self.attributes.namespaceExpirationTime : null
        });

        return setRoutingProficiencyParameters;
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var metaData = {};
        metaData.useDynamic = self.attributes.useDynamic;
        metaData.useDynamicExpirationTime = self.attributes.useDynamicExpirationTime;
        metaData.agentHierarchySelectionL1 = self.attributes.agentHierarchySelection.l1Group;
        metaData.agentHierarchySelectionL2 = self.attributes.agentHierarchySelection.l2Group;
        return metaData;
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setRoutingProficiency"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
        condition: "Success"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
    }]
};

LilyContactFlow.createSetRoutingProficiency = function(x,y){
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x,y), LilyContactFlow.setRoutingProficiencyParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.setRoutingProficiencyParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};

LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.setRoutingProficiencyParams.getType()] = function(data){
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.setRoutingProficiencyParams);
    baseParams.id = data.id;
    _.forEach(data.parameters, function(param) {
        switch(param.name) {
            case "AgentHierarchyArn":
                baseParams.namespace = param.namespace;
                baseParams.attribute = baseParams.namespace ? param.value : null;
                baseParams.agentHierarchySelection = {
                    l1Group: data.metadata.agentHierarchySelectionL1,
                    l2Group: data.metadata.agentHierarchySelectionL2
                };
                baseParams.useDynamic = data.metadata.useDynamic;
                break;
            case "AgentHierarchyArnExpirationTimeSeconds":
                baseParams.expirationTime = data.metadata.useDynamicExpirationTime? param.value : Number(param.value);
                baseParams.namespaceExpirationTime = param.namespace;
                baseParams.useDynamicExpirationTime = data.metadata.useDynamicExpirationTime;
                break;
            default:
                break;
        }
    });
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Check staffing
LilyContactFlow.checkStaffingParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(3, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-check-staffing-label'); },
    getAttributeLabel: function(cell) {
        var status = LilyContactFlow.getString('lily-admin-contact-flow-check-staffing-attribute-label-status') + ": " + LilyContactFlow.translateStatus(cell.model.attributes.status);
        var attributes =  cell.model.attributes;
        if (attributes.queue) {
            if (attributes.useDynamic) {
                return status + " (" + LilyContactFlow.getString('lily-admin-contact-flow-set-queue-attribute-label-dynamic') + ": " + attributes.queue + ")";
            } else {
                return status + " (" + attributes.queue.text + ")";
            }
        }
        return status;
    },
    status: "Available",
    queue: null,
    useDynamic: false,
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_checkStaffingModal.html",
            status: this.model.attributes.status,
            setOptionalQueue: this.model.attributes.queue !== null
        };

        serializedData = LilyContactFlow.queueUtils.setQueueParams(serializedData, this.model.attributes);

        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.status = data.status;

        self.attributes.useDynamic = data.setOptionalQueue ? data.useDynamic : false;
        self.attributes.namespace = data.setOptionalQueue ? (data.useDynamic ? data.namespace : null) : null;
        self.attributes.queue = data.setOptionalQueue ? (data.useDynamic ? data.queueDynamic : data.queue) : null;
        self.attributes.setOptionalQueue = data.setOptionalQueue || false;
        self.attributes.byAgentQueue = data.byAgentQueue || false;


        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "CheckStaffing";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var parameters = [{name: "Status",
                         value: self.attributes.status}];

        var queueParam = LilyContactFlow.queueUtils.getQueueParams(self.attributes);
        if (queueParam) {
            parameters.push(queueParam);
        }

        return parameters;
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return {
            "useDynamic": self.attributes.useDynamic,
            "queue":  self.attributes.queue 
        };
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "checkStaffing"
    },
    baseConditions: [{
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-true'),
            condition: "True"
        }, {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-false'),
            condition: "False"
        }, {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
            condition: "Error"
        }]
};
LilyContactFlow.createCheckStaffingModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.checkStaffingParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.checkStaffingParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.checkStaffingParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.checkStaffingParams, LilyContactFlow.queueUtils.decompileQueue(data));
    _.forEach(data.parameters, function(param) {
        switch (param.name) {
            case "Status":
                baseParams.status = param.value;
                break;
            default:
                break;
        }
    });
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Check hours
//TODO: remove after backfilling
LilyContactFlow.ModuleDecompilerByType.InHours = function(data) {
    return LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.checkHoursParams.getType()](data);
};

LilyContactFlow.checkHoursParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(3, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-check-hours-label'); },
    getAttributeLabel: function(cell) {
        var checking = LilyContactFlow.getString('lily-admin-contact-flow-check-hours-attribute-label-checking') + ": ";
        if (!cell.model.attributes.hours) {
            return checking + LilyContactFlow.getString('lily-admin-contact-flow-check-hours-attribute-label-current-queue');
        } else {
            return checking + cell.model.attributes.hours.text;
        }
    },
    hours: null,
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_checkHoursModal.html",
            hours: this.model.attributes.hours,
            customHours: !!this.model.attributes.hours
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.hours = data.customHours && data.hours ? data.hours : null;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "CheckHoursOfOperation";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
            if (self.attributes.hours) {return [{
                name: "Hours",
                value: self.attributes.hours.id,
                resourceName: self.attributes.hours.text
            }];
        }
        return [];
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id); // TODO remove https://cr.amazon.com/r/7815548/
        if (self.attributes.hours) {
            return {
                "Hours": self.attributes.hours
            };
        }
        return {};
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "checkHours"
    },
    baseConditions: [{
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-in-hours'),
            condition: "True"
        }, {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-out-of-hours'),
            condition: "False"
        }, {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
            condition: "Error"
        }]
};
LilyContactFlow.createCheckHoursModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.checkHoursParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.checkHoursParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.checkHoursParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.checkHoursParams);
    _.forEach(data.parameters, function(param) {
        if (param.name === "Hours") {
            baseParams.hours = {
                id: data.parameters[0].value,
                text: data.parameters[0].resourceName ? data.parameters[0].resourceName :
                    (data.metadata.Hours ? data.metadata.Hours.text : null)
            };
        }
    });
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Check contact attribute
LilyContactFlow.ModuleDecompilerByType.CheckCallAttribute = function(data) {
    return LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.checkAttributesParams.getType()](data);
};

LilyContactFlow.checkAttributesParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(1, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-check-attr-label'); },
    namespace: "",
    attribute: "",
    conditions: [],
    getAttributeLabel: function(cell) {
        var namespace = LilyContactFlow.translateNamespace(cell.model.attributes.namespace) || "";
        var attribute = cell.model.attributes.attribute || "";
        if (cell.model.attributes.namespace === "System") {
            attribute = LilyContactFlow.translateSystemAttribute(attribute);
        }
        if (!namespace || !attribute) {
            return LilyContactFlow.getString('lily-admin-contact-flow-check-attr-attribute-label-checking-nothing');
        }
        return LilyContactFlow.getString('lily-admin-contact-flow-check-attr-attribute-label-checking') + ": " + namespace + ", " + attribute;
    },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            namespace: this.model.attributes.namespace,
            category: null,
            attribute: this.model.attributes.attribute,
            conditions: this.model.attributes.conditions,
            templateUrl: "_checkContactAttributesModal.html"
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    sortConditions: function(self) {
        var view = self.findView(LilyContactFlow.paper);
        // Reorder all of the branches such that the bottom branch is NoMatch
        view.moveCellToBottomByCondition(self, "NoMatch");
    },
    getBranchLabel: function(node) {
        var shortDisplay = node.operator === null ? "" : node.operator.shortDisplay;
        var nodeValue = node.value == null ? "" : node.value;
        return shortDisplay + " " + nodeValue;
    },
    getConditionData: function(branch) {
        var conditionData = {};
        return {
            "condition": "Evaluate",
            "conditionType": branch.operator === null ? null : branch.operator.value,
            "conditionValue": branch.value ? branch.value : null
        };
    },
    getMetadata: function(cell) {
        var self = cell ? cell : LilyContactFlow.graph.getCell(this.id);
        var conditionMetadata = [];
        _.forEach(self.attributes.conditions, function(condition) {
            conditionMetadata.push(condition);
        });
        return {
            conditionMetadata: conditionMetadata
        };
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.namespace = data.namespace;
        self.attributes.attribute = data.attribute;
        self.attributes.category = data.category;
        self.findView(LilyContactFlow.paper).mergeInConditions(self, data.conditions);
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "CheckAttribute";
    },
    getParameters: function(cell) {
        var self = cell ? cell : LilyContactFlow.graph.getCell(this.id);
        return [{
            name: "Attribute",
            value: self.attributes.attribute
        }, {
            name: "Namespace",
            value: self.attributes.namespace
        }];
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "checkContactAttributes"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-no-match'),
        condition: "NoMatch"
    }]
};
LilyContactFlow.createCheckContactAttributesModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.checkAttributesParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.checkAttributesParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        parent.attributes.staticConditionIds = _.union(parent.attributes.staticConditionIds, [child.id]);
        nodes.push(child);
    });
    return nodes;
};

LilyContactFlow.createCheckContactAttributesModuleJson = function() {
    var nodes = LilyContactFlow.createCheckContactAttributesModule(0,0);
    var fragmentNode = _.find(nodes, function (node) {
        return node.attributes.type === "module";
    });
    var branchNode = _.find(nodes, function (node) {
        return node.attributes.type === "branch";
    });
    var moduleJson = LilyContactFlow.jsonifyModule(fragmentNode, true);
    var branchJson = LilyContactFlow.jsonifyBranch(branchNode.attributes);
    delete branchJson.parent;
    moduleJson.branches.push(branchJson);
    return moduleJson;
};

LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.checkAttributesParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.checkAttributesParams);
    baseParams.id = data.id;

    _.forEach(data.parameters, function(param) {
        if (param.name === "Attribute" && param.value !== null) {
            baseParams.attribute = param.value;
        } else if (param.name === "Namespace" && param.value != null) {
            baseParams.namespace = param.value;
        }
    });

    var parent = new joint.shapes.module(baseParams);
    var nodes = [parent];

    // Fill in the other conditions
    var conditions = [];
    _.forEach(data.branches, function(branch, i) {
        if (branch.condition === "NoMatch") {
            return;
        }
        var matchingConditionMetadata = [];
        if (data.metadata.conditionMetadata) {
            matchingConditionMetadata = data.metadata.conditionMetadata.filter(function(metadata) {
                return metadata.value === branch.conditionValue && (metadata.operator ? metadata.operator.value : null ) === branch.conditionType;
            });
        }
        if (matchingConditionMetadata.length === 0) {
            return;
        }
        var conditionMetadata = matchingConditionMetadata[0];
        var condition = {};
        _.extend(condition, {
            "condition": branch.condition,
            "conditionType": branch.conditionType,
            "conditionValue": branch.conditionValue
        });
        var newCell = LilyContactFlow.addOutputCondition(parent, parent.attributes.getBranchLabel(conditionMetadata), condition, conditions.length);
        conditionMetadata.id = newCell.id;
        nodes.push(newCell);
        conditions.push(conditionMetadata);
    });
    var noMatch = LilyContactFlow.addOutputCondition(parent, LilyContactFlow.getString('lily-admin-contact-flow-condition-no-match'), "NoMatch", conditions.length);
    parent.attributes.staticConditionIds = _.union([noMatch.id]);
    nodes.push(noMatch);
    parent.attributes.conditions = conditions;
    parent.resize(parent.get("size").width, parent.get("size").height + LilyContactFlow.Sizes.BRANCH_SPACING * conditions.length);
    return nodes;
};

// Percentile routing
//TODO: remove after bacfilling
LilyContactFlow.ModuleDecompilerByType.PercentileBranching = function(data) {
    return LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.percentileBasedBranchingParams.getType()](data);
};

LilyContactFlow.percentileBasedBranchingParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(1, false) },
    getLabel: function(cell) { return LilyContactFlow.getString("lily-admin-contact-flow-check-percent-routing-label"); },
    getAttributeLabel: function(cell) {
        return "";
    },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            conditions: this.model.attributes.conditions,
            templateUrl: "_distributeByPercentage.html"
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    conditions: [],
    getConditionData: function(branch) {
        return {
            "condition": "Evaluate",
            "conditionType": "Equals",
            "conditionValue": _.isNumber(branch.value) ? branch.value.toString() : null
        };
    },
    getBranchLabel: function(node) {
        return node.value + "%: " + node.name;
    },
    sortConditions: function(self) {
        var view = self.findView(LilyContactFlow.paper);
        view.moveCellToBottomById(self, self.attributes.defaultBranchId);
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.conditions = data.conditions;
        var view = self.findView(LilyContactFlow.paper);
        view.mergeInConditions(self, data.conditions);
        var defaultWeight = 100;
        _.forEach(data.conditions, function(condition) {
            if (condition.value) {
                defaultWeight -= condition.value;
            }
        });
        var defaultCell = LilyContactFlow.graph.getCell(self.attributes.defaultBranchId);
        defaultCell.attributes.condition.conditionValue = defaultWeight.toString();
        defaultCell.findView(LilyContactFlow.paper).$el.find(".label").text(defaultWeight.toString() + "%: " + LilyContactFlow.getString('lily-admin-contact-flow-condition-default'));
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var conditionMetadata = [];
        _.forEach(self.attributes.conditions, function(condition) {
            // Note: clone first, since _.extend mutates
            var conditionClone = _.clone(condition);
            conditionClone.value = condition.value.toString();
            conditionMetadata.push(conditionClone);
        });
        return {
            "conditionMetadata": conditionMetadata
        };
    },
    getType: function() {
        return "DistributeByPercentage";
    },
    getParameters: function() {
        return [];
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "distributeRandomly"
    },
    baseConditions: [{
        display: "100%: " + LilyContactFlow.getString("lily-admin-contact-flow-condition-default"),
        condition: {
            "conditionType": "Equals",
            "conditionValue": "100",
            "condition": "NoMatch"
        }
    }]
};
LilyContactFlow.createPercentileBasedRoutingModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.percentileBasedBranchingParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.percentileBasedBranchingParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        parent.attributes.defaultBranchId = child.id;
        parent.attributes.staticConditionIds = [child.id];
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.percentileBasedBranchingParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.percentileBasedBranchingParams);
    baseParams.id = data.id;
    var parent = new joint.shapes.module(baseParams);
    var nodes = [parent];
    // Fill in the other conditions
    var defaultWeight = 100;
    var conditions = [];
    if (data.metadata.conditionMetadata) {
        _.forEach(data.metadata.conditionMetadata, function(metadata, i) {
            var condition = {
                "condition": "Evaluate",
                "conditionType": "Equals",
                "conditionValue": metadata.value
            };
            defaultWeight -= condition.conditionValue;
            var newCell = LilyContactFlow.addOutputCondition(parent, parent.attributes.getBranchLabel(metadata), condition, conditions.length);
            metadata.id = newCell.id;
            metadata.value = Number(metadata.value);
            nodes.push(newCell);
            conditions.push(metadata);
        });
    }
    _.forEach(LilyContactFlow.percentileBasedBranchingParams.baseConditions, function(label, i) {
        label.condition.conditionValue = defaultWeight.toString();
        var child = LilyContactFlow.addOutputCondition(parent, defaultWeight.toString() + "%: " + LilyContactFlow.getString('lily-admin-contact-flow-condition-default'), label.condition, conditions.length + i);
        parent.attributes.defaultBranchId = child.id;
        parent.attributes.staticConditionIds = [child.id];
        nodes.push(child);
    });
    parent.attributes.conditions = conditions;
    parent.resize(parent.get("size").width, parent.get("size").height + LilyContactFlow.Sizes.BRANCH_SPACING * conditions.length + 1);
    return nodes;
};

// Loop
LilyContactFlow.loopParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-loop-label'); },
    getAttributeLabel: function(cell) { 
        var loopCountLabel = LilyContactFlow.getString('lily-admin-contact-flow-loop-attribute-label-loops') + ": ";
        var attributes =  cell.model.attributes;
        if (attributes.value && attributes.useDynamic) {
            return loopCountLabel + LilyContactFlow.getString('lily-admin-contact-flow-loop-attribute-label-dynamic') + "(" + attributes.value + ")";
        } else {
            return loopCountLabel + attributes.loopCount;
        }
    },
    loopCount: 3,
    useDynamic: false,
    namespace: "",
    value: null,
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_loopModal.html",
            loopCount: this.model.attributes.loopCount,
            namespace: this.model.attributes.namespace,
            useDynamic: this.model.attributes.useDynamic,
            value: this.model.attributes.value
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.loopCount = data.loopCount;
        self.attributes.useDynamic = data.useDynamic;
        self.attributes.namespace = data.namespace;
        self.attributes.value = data.value;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "Loop";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        if (!self.attributes.useDynamic) {
            return [{
                name: "LoopCount",
                value: self.attributes.loopCount.toString()
            }];
        } else if (self.attributes.useDynamic) {
            return [{
                name: "LoopCount",
                namespace: self.attributes.namespace,
                value: self.attributes.value
            }];
        }
        return [];
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return {
            "useDynamic": self.attributes.useDynamic
        };
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "loop"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-looping'),
        condition: "Looping"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-complete'),
        condition: "Complete"
    }]
};
LilyContactFlow.createLoopModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.loopParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.loopParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.loopParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.loopParams);
    baseParams.useDynamic = data.metadata.useDynamic || false;
    _.forEach(data.parameters, function(param){
        if (param.name === "LoopCount") {
            if (baseParams.useDynamic) {
                baseParams.value = param.value;
                baseParams.namespace = param.namespace;
            } else {
                baseParams.loopCount = parseInt(param.value);
            }
        }
    });
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Wait
LilyContactFlow.waitParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-wait-label'); },
    getAttributeLabel: function(cell) {
        var timeoutLabel = LilyContactFlow.getString('lily-admin-contact-flow-wait-attribute-label-timeout') + ": ";
        var attributes =  cell.model.attributes;
        if (attributes.timeout.value && attributes.useDynamic) {
            return timeoutLabel + LilyContactFlow.getString('lily-admin-contact-flow-wait-attribute-label-dynamic') + "(" + attributes.timeout.value + ")";
        } else if (_.isObject(attributes.timeout) && _.isObject(attributes.timeout.unit)) {
            return timeoutLabel + attributes.timeout.value + " " + attributes.timeout.unit.display;
        } else {
            return timeoutLabel;
        }
    },
    conditions: [],
    staticConditionIds: [],
    timeout: {
        value: null,
        unit: null
    },
    continueExecuting: false,
    interruptOnCustomerReturn: false,
    useDynamic: false,
    namespace: "",
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_waitModal.html",
            namespace: this.model.attributes.namespace,
            useDynamic: this.model.attributes.useDynamic,
            timeout: this.model.attributes.timeout,
            continueExecuting: this.model.attributes.continueExecuting,
            interruptOnCustomerReturn: this.model.attributes.interruptOnCustomerReturn,
            units: Object.keys(LilyContactFlow.waitTimeUnits).reverse().map(function(key) { return LilyContactFlow.waitTimeUnits[key];})
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.useDynamic = data.useDynamic;
        self.attributes.namespace = data.namespace;
        self.attributes.timeout = data.timeout;

        var conditions = [];
        var matchingConditions;
        if (data.continueExecuting) {
            matchingConditions = self.attributes.conditions.filter(function(condition) {
                return condition.condition === "Continue";
            });
            if (matchingConditions.length > 0) {
                conditions.push(matchingConditions[0]);
            } else {
                conditions.push({
                    display: LilyContactFlow.getString('lily-admin-contact-flow-condition-continue'),
                    condition: "Continue"
                });
            }
        }
        if (data.interruptOnCustomerReturn) {
            matchingConditions = self.attributes.conditions.filter(function(condition) {
                return condition.condition === "CustomerReturn";
            });
            if (matchingConditions.length > 0) {
                conditions.push(matchingConditions[0]);
            } else {
                conditions.push({
                    display: LilyContactFlow.getString('lily-admin-contact-flow-condition-customer-return'),
                    condition: "CustomerReturn"
                });
            }
        }
        self.findView(LilyContactFlow.paper).mergeInConditions(self, conditions);

        self.attributes.continueExecuting = data.continueExecuting;
        self.attributes.interruptOnCustomerReturn = data.interruptOnCustomerReturn;
        if (self.attributes.useDynamic) {
            self.attributes.timeout.unit = LilyContactFlow.waitTimeUnits.second;
        }
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    sortConditions: function(self) {
        var view = self.findView(LilyContactFlow.paper);
        // Normalized order of conditions
        _.forEach(["CustomerReturn", "Continue", "Timeout", "Error"], function(condition) {
            view.moveCellToBottomByCondition(self, condition);
        });
    },
    getBranchLabel: function(node) {
        return node.display;
    },
    getConditionData: function(branch) {
        return {
            condition: branch.condition
        };
    },
    getType: function() {
        return "Wait";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var attributes = [];
        if (self.attributes && !self.attributes.useDynamic && _.isObject(self.attributes.timeout) && _.isNumber(self.attributes.timeout.value) && _.isObject(self.attributes.timeout.unit)) {
            var timeout = self.attributes.timeout;
            var timeoutSeconds = timeout.value;
            switch (timeout.unit.value) {
                case LilyContactFlow.waitTimeUnits.day.value:
                    timeoutSeconds *= 24;
                    /* falls through */
                case LilyContactFlow.waitTimeUnits.hour.value:
                    timeoutSeconds *= 60;
                    /* falls through */
                case LilyContactFlow.waitTimeUnits.minute.value:
                    timeoutSeconds *= 60;
                    /* falls through */
                default:
                    // Do nothing
            }
            attributes.push({
                name: "TimeoutSeconds",
                value: timeoutSeconds.toString()
            });
        } else if (self.attributes.useDynamic) {
            attributes.push({
                name: "TimeoutSeconds",
                namespace: self.attributes.namespace,
                value: self.attributes.timeout.value
            });
        }
        if (self.attributes) {
            if (self.attributes.continueExecuting) {
                attributes.push({
                    name: "ContinueExecution",
                    value: "true"
                });
            }
            if (self.attributes.interruptOnCustomerReturn) {
                attributes.push({
                    name: "InterruptOnCustomerReturn",
                    value: "true"
                });
            }
        }
        return attributes;
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var timeoutUnit = self.attributes.timeout && self.attributes.timeout.unit ? self.attributes.timeout.unit : null;
        return {
            "useDynamic": self.attributes.useDynamic,
            "timeoutUnit": timeoutUnit
        };
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "wait"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-time-expired'),
        condition: "Timeout"
     }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
      }]
};
LilyContactFlow.waitTimeUnits = {
    day: {
        display: LilyContactFlow.getString('lily-admin-contact-flow-wait-time-days'),
        value: "day"
    },
    hour: {
        display: LilyContactFlow.getString('lily-admin-contact-flow-wait-time-hours'),
        value: "hour"
    },
    minute: {
        display: LilyContactFlow.getString('lily-admin-contact-flow-wait-time-minutes'),
        value: "minute"
    },
    second: {
        display: LilyContactFlow.getString('lily-admin-contact-flow-wait-time-seconds'),
        value: "second"
    }
};
LilyContactFlow.createWaitModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.waitParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.waitParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        parent.attributes.staticConditionIds = _.union(parent.attributes.staticConditionIds, [child.id]);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.waitParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.waitParams);
    baseParams.useDynamic = data.metadata.useDynamic || false;
    _.forEach(data.parameters, function(param){
        if (param.name === "TimeoutSeconds") {
            if (baseParams.useDynamic) {
                baseParams.timeout.value = param.value;
                baseParams.namespace = param.namespace;
            } else {
                var timeoutUnit = data.metadata.timeoutUnit || LilyContactFlow.waitTimeUnits.second;
                var timeoutValue = param.value;
                switch (timeoutUnit.value) {
                    case LilyContactFlow.waitTimeUnits.day.value:
                        timeoutValue /= 24;
                        /* falls through */
                    case LilyContactFlow.waitTimeUnits.hour.value:
                        timeoutValue /= 60;
                        /* falls through */
                    case LilyContactFlow.waitTimeUnits.minute.value:
                        timeoutValue /= 60;
                        /* falls through */
                    default:
                        // Do nothing
                        timeoutValue = Math.floor(timeoutValue); // Just in case we get something odd like 3.5 days after conversion
                }
                baseParams.timeout = {
                    value: timeoutValue,
                    unit: timeoutUnit
                };
            }
        } else if (param.name === "InterruptOnCustomerReturn") {
            baseParams.interruptOnCustomerReturn = true;
        } else if (LilyContactFlow.isFeatureEnabled("isContinueBranchOnWaitBlockEnabled") && param.name === "ContinueExecution") {
            baseParams.continueExecuting = true;
        }
    });
    baseParams.id = data.id;
    var parent = new joint.shapes.module(baseParams);
    var nodes = [parent];
    var conditions = [];
    var staticConditions = baseParams.baseConditions.map(function(condition) {
        return condition.condition;
    });
    _.forEach(data.branches, function(branch, i) {
        if (staticConditions.indexOf(branch.condition) !== -1) {
            return;
        }
        if(branch.condition === "Continue" && !LilyContactFlow.isFeatureEnabled("isContinueBranchOnWaitBlockEnabled")) {
            return;
        }
        var condition = {
            condition: branch.condition,
            transition: branch.transition
        };
        switch (branch.condition) {
            case "CustomerReturn":
                condition.display = LilyContactFlow.getString('lily-admin-contact-flow-condition-customer-return');
                break;
            case "Continue":
                condition.display = LilyContactFlow.getString('lily-admin-contact-flow-condition-continue');
                break;
            default:
                return; //Ignore invalid conditions
        }
        var newCell = LilyContactFlow.addOutputCondition(parent, condition.display, condition.condition, conditions.length);
        condition.id = newCell.id;
        nodes.push(newCell);
        conditions.push(condition);
    });
    _.forEach(parent.attributes.baseConditions, function(condition, i) {
        var staticCondition = LilyContactFlow.addOutputCondition(parent, condition.display, condition.condition, nodes.length - 1);
        parent.attributes.staticConditionIds.push(staticCondition.id);
        nodes.push(staticCondition);
    });
    parent.attributes.conditions = conditions;
    parent.resize(parent.get("size").width, parent.get("size").height + LilyContactFlow.Sizes.BRANCH_SPACING * (conditions.length));
    return nodes;
};


// Disconnect
LilyContactFlow.disconnectParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(0, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-disconnect-label'); },
    getAttributeLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-disconnect-attribute-label'); },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_disconnectModal.html"
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) { },
    getType: function() {
        return "Disconnect";
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.TT_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.TT_MODULE_HEADER_FONT_COLOR,
        iconClass: "disconnectHangUp"
    },
    baseConditions: []
};
LilyContactFlow.createDisconnectModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.disconnectParams));
    var nodes = [parent];
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.disconnectParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.disconnectParams);
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// End flow / return from interrupt
LilyContactFlow.resumeParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(0, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-end-flow-label'); },
    getAttributeLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-end-flow-attribute-label'); },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_resumeModal.html"
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) { },
    getType: function() {
        return "Resume";
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.TT_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.TT_MODULE_HEADER_FONT_COLOR,
        iconClass: "endFlow"
    },
    baseConditions: []
};

LilyContactFlow.createResumeModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.resumeParams));
    var nodes = [parent];
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.resumeParams.getType()] = function(data) {
    // Special logic: for backwards compatibility, this block used to be autogenerated without position data
    // If the position data isn't present, just put it at (400,400) - this won't overlap with the default flows created
    if (!data.metadata) {
        data.metadata = { };
    }
    if (!data.metadata.position) {
        data.metadata.position = {
            x: 400,
            y: 400
        };
    }
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.resumeParams);
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Set screenpop data
// TODO: remove once backfill is complete
LilyContactFlow.ModuleDecompilerByType.SetScreenPop = function(data) {
    return LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.setAttributesParams.getType()](data);
};

LilyContactFlow.setAttributesParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-set-attr-label'); },
    attributes: [],
    getAttributeLabel: function(cell) {
        var attributeCount = cell.model.attributes.attributes.length;
        var value;
        if (attributeCount === 0) {
            return LilyContactFlow.getString('lily-admin-contact-flow-set-attr-attribute-label-output') + ": = ";
        } else if (attributeCount === 1) {
            var key = cell.model.attributes.attributes[0].key || "";
            if (cell.model.attributes.attributes[0].destinationType === LilyContactFlow.AttributeContactDataStrings.SYSTEM_TYPE) {
                if(cell.model.attributes.attributes[0].destinationAttribute === LilyContactFlow.AttributeContactDataStrings.CONTACT_REFERENCES) {
                    key = LilyContactFlow.translateSystemAttribute(LilyContactFlow.AttributeContactDataStrings.CONTACT_REFERENCES) + "['" + key + "']";
                } else {
                    key = LilyContactFlow.translateSystemAttribute(cell.model.attributes.attributes[0].destinationAttribute);
                }
            }
            if (cell.model.attributes.attributes[0].useDynamic) {
                var attrValue = cell.model.attributes.attributes[0].value;
                if (cell.model.attributes.attributes[0].namespace === "System") {
                    attrValue = LilyContactFlow.translateSystemAttribute(attrValue);
                }
                value = LilyContactFlow.getString('lily-admin-contact-flow-set-attr-attribute-label-dynamic') + "(" + attrValue + ")";
            } else {
                value = cell.model.attributes.attributes[0].value || "";
            }
            return LilyContactFlow.getString('lily-admin-contact-flow-set-attr-attribute-label-output') + ": " + key + " = " + value;
        } else {
            return LilyContactFlow.getString('lily-admin-contact-flow-set-attr-attribute-label-multiple') + " (" + attributeCount + ")" ;
        }
    },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            attributes: this.model.attributes.attributes,
            templateUrl: "_setAttributesModal.html"
        };
        if (this.model.attributes.attributes.length === 0) {
            serializedData.attributes = [{
                useDynamic: false
            }];
        }
        angular.element($("#angularContainer")).scope().showModal(serializedData, {setAttributesBlockHasInputErrors: LilyContactFlow.setAttributesBlockHasInputErrors});
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.attributes = data.attributes;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "SetAttributes";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var params = [];
        _.forEach(self.attributes.attributes, function(attribute) {
            if(attribute.destinationType === LilyContactFlow.AttributeContactDataStrings.SYSTEM_TYPE){
                var contactParam = {
                    name: "ContactData",
                    namespace: attribute.useDynamic ? attribute.namespace : null
                };
                switch (attribute.destinationAttribute) {
                    case LilyContactFlow.AttributeContactDataStrings.CONTACT_NAME:
                        contactParam.contactName = attribute.value;
                        break;
                    case LilyContactFlow.AttributeContactDataStrings.CONTACT_DESCRIPTION:
                        contactParam.contactDescription = attribute.value;
                        break;
                    case LilyContactFlow.AttributeContactDataStrings.LANGUAGE_CODE:
                        contactParam.languageCode = attribute.value;
                        break;
                    case LilyContactFlow.AttributeContactDataStrings.CONTACT_REFERENCES:
                        contactParam.contactReference = {
                            key: attribute.key,
                            value: attribute.value,
                            type: attribute.referenceType
                        };
                        break;
                    case LilyContactFlow.AttributeContactDataStrings.CUSTOMER_ID:
                        contactParam.customerId = attribute.value;
                        break;
                }
                params.push(contactParam);
            } else {
                params.push({
                    name: "Attribute",
                    value: attribute.value,
                    key: attribute.key,
                    namespace: attribute.useDynamic ? attribute.namespace : null
                });
            }

        });
        return params;
    },
    getMetadata: function() {
    var self = LilyContactFlow.graph.getCell(this.id);
        return {};
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setContactAttributes"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
        condition: "Success"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
    }]
};
// Split SetAttributes to SetAttributes (User-defined destination type) and SetContactData (System destination type)
LilyContactFlow.SplitModuleByType[LilyContactFlow.setAttributesParams.getType()] = function(module, modules) {
    var contactDataParams = [];
    var attributeParams = [];
    _.each(module.parameters, function(parameter) {
        if (parameter.name === "ContactData") {
            contactDataParams.push(parameter);
        } else {
            attributeParams.push(parameter);
        }
    });
    if (contactDataParams.length > 0) {
        var moduleContactData = angular.copy(module);
        moduleContactData.type = "SetContactData";
        moduleContactData.parameters = contactDataParams;
        if (attributeParams.length === 0) {
            // No SetAttributes present.
            // Push the ContactDataModule only.
            modules.push(moduleContactData);
        } else {
            // SetAttributes and SetContactData present.
            // Create new cellId for SetContactData.
            // Connect SetAttribute:success branch ---> SetContactData
            moduleContactData.id = joint.util.uuid();
            _.each(module.branches, function(branch) {
                if (branch.condition === "Success") {
                    branch.transition = moduleContactData.id;
                }
            });
            module.metadata.isSplitModule = true;
            moduleContactData.metadata.isSplitModule = true;
            module.parameters = attributeParams;
            modules.push(module);
            modules.push(moduleContactData);
        }
    } else {
        // No parameters or SetContactData present.
        // Push SetAttributes module.
        modules.push(module);
    }
};
LilyContactFlow.createSetAttributesModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.setAttributesParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.setAttributesParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.setAttributesParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.setAttributesParams);
    baseParams.id = data.id;
    // backwards compatibility
    baseParams.attributes = [];
    var key, value, namespace;
    _.forEach(data.parameters, function(param) {
        if (param.name === "key") {
            key = param.value;
        } else if (param.name === "value") {
            value = param.value;
            namespace = param.namespace;
        }
    });
    // check if key is present because the key param is only used for the updated version with more than one attribute
    if (key) {
        baseParams.attributes.push({
            name: "Attribute",
            value: value,
            key: key,
            namespace: data.metadata.useDynamic ? namespace : null,
            useDynamic: data.metadata.useDynamic
        });
    }
    if (baseParams.attributes.length === 0) {
        baseParams.attributes = data.parameters;
        _.forEach(baseParams.attributes, function(attribute) {
            attribute.useDynamic = attribute.namespace ? true : false;
            if (attribute.name === "ContactData") {
                if(attribute.contactName) {
                    attribute.destinationAttribute = "Name";
                    attribute.value = attribute.contactName;
                } else if (attribute.contactDescription) {
                    attribute.destinationAttribute = "Description";
                    attribute.value = attribute.contactDescription;
                } else if (attribute.languageCode) {
                    attribute.destinationAttribute = "Language";
                    attribute.value = attribute.languageCode;
                } else if (attribute.contactReference) {
                    attribute.destinationAttribute = "References";
                    attribute.value = attribute.contactReference.value;
                    attribute.key = attribute.contactReference.key;
                    attribute.referenceType = attribute.contactReference.type;
                } else if (attribute.customerId) {
                    attribute.destinationAttribute = "CustomerId";
                    attribute.value = attribute.customerId;
                }
                attribute.destinationType = "System";
            }
        });
    }
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

LilyContactFlow.setAttributesBlockHasInputErrors = function(attributes) {
    var hasErrors = false;
    attributes.forEach(function(attribute){
        // Validation to verify the URL format when the attribute is Contact Attribute - References - URL
        // This validation won't hold true when the attribute is set via a dynamic attribute.
        if(attribute.useDynamic === false && attribute.destinationAttribute &&  attribute.destinationAttribute === LilyContactFlow.AttributeContactDataStrings.CONTACT_REFERENCES && attribute.referenceType === LilyContactFlow.AttributeContactDataStrings.REFERENCE_URL) {
            if(!LilyContactFlow.isValidURL(attribute.value)){
                hasErrors = true;
            }
        }
    });
    return hasErrors;
};
LilyContactFlow.isValidURL = function(url) {
    try{
        var u = new URL(url);
    } catch (_) {
        return false;
    }
    return true;
};

// Dial Block
LilyContactFlow.dialBlockParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(1, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-dial-block-label'); },
    getAttributeLabel: function(cell) {
        var label = LilyContactFlow.getString('lily-admin-contact-flow-dial-block-caller-id') + ": ",
            attributes = cell.model.attributes;
        if(attributes.callerId && attributes.callerIdSource === "custom") {
            return label + cell.model.attributes.callerId;
        } else if(attributes.callerIdSource === "claimed") {
            if(_.isObject(cell.model.attributes.claimedPhoneNumber)) {
                return label + LilyContactFlow.formatPhoneNumber(cell.model.attributes.claimedPhoneNumber.text);
            }
        } else if(attributes.value) {
            return label + LilyContactFlow.getString("lily-admin-contact-flow-set-attr-attribute-label-dynamic") + "(" +attributes.value+ ")";
        }
        return label;
    },

    setOptionalCallerId: false,
    callerIdSource: "claimed",
    namespace : "",
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_dialBlockModal.html",
            setOptionalCallerId: this.model.attributes.setOptionalCallerId,
            callerIdSource: this.model.attributes.callerIdSource
        };

        if(this.model.attributes.setOptionalCallerId) {
            if(this.model.attributes.callerIdSource === "dynamic") {
                serializedData.namespace = this.model.attributes.namespace;
                serializedData.value = this.model.attributes.value;
            } else if (this.model.attributes.callerIdSource === "claimed") {
                serializedData.claimedPhoneNumber = this.model.attributes.claimedPhoneNumber;
            } else {
                serializedData.callerId = this.model.attributes.callerId;
            }
        }
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.setOptionalCallerId = data.setOptionalCallerId;
        self.attributes.callerIdSource = data.callerIdSource;

        if(self.attributes.setOptionalCallerId) {
            if(self.attributes.callerIdSource === "dynamic") {
                self.attributes.namespace = data.namespace;  
                self.attributes.value = data.value;  
            } else if (self.attributes.callerIdSource === "claimed") {
                self.attributes.claimedPhoneNumber = data.claimedPhoneNumber;
            } else {
                self.attributes.callerId = data.callerId;
            }
        } else {
            self.attributes.callerIdSource = "claimed";
            self.attributes.value = ""; 
            self.attributes.callerId = "";
            self.attributes.claimedPhoneNumber = "";
        }

        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    
    getType: function() {
        return "Dial";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var parameters = [];

        if(self.attributes.setOptionalCallerId) {
            if(self.attributes.callerIdSource === "dynamic") {
                 parameters.push({
                    name: "CallerId",
                    namespace: self.attributes.namespace,
                    value: self.attributes.value
                });
            } else if(self.attributes.callerIdSource === "claimed") {
                parameters.push({
                    name: "CallerId",
                    value: self.attributes.claimedPhoneNumber.text
                });
            } else {
                parameters.push({
                    name: "CallerId",
                    value: self.attributes.callerId
                });
            }
        }        
        return parameters;
    },

    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);

        var metaData = {
            "setOptionalCallerId": self.attributes.setOptionalCallerId || false,
            "callerIdSource":  self.attributes.callerIdSource || "claimed"
        };

        if(self.attributes.setOptionalCallerId) {
            if(self.attributes.callerIdSource === "dynamic") {
                metaData.namespace =  self.attributes.namespace;  
                metaData.value =  self.attributes.value;  
            } else if (self.attributes.callerIdSource === "claimed") {
                metaData.claimedPhoneNumber = self.attributes.claimedPhoneNumber;
            } else {
                metaData.callerId =  self.attributes.callerId;
            }
        }
        return metaData;
    },

    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "dial-block"
    },

    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
        condition: "Success"
    }]
};

LilyContactFlow.createDialBlockModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.dialBlockParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.dialBlockParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};


LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.dialBlockParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.dialBlockParams, data.metadata);
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Set Voice
LilyContactFlow.setVoiceParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(1, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-set-voice-label'); },
    voice: LilyContactFlow.SetVoiceModuleDefaultValue.VOICE,
    language: LilyContactFlow.SetVoiceModuleDefaultValue.LANGUAGE,
    getAttributeLabel: function(cell) {
        var label;
        
        if(LilyContactFlow.isFeatureEnabled("isSetVoiceBlockWithNTTSConversationalVoicesEnabled")){
            var speakingType = cell.model.attributes.speakingStyle;
            var attributes = cell.model.attributes;
            label = attributes.voice;

            if(!speakingType){
                if(LilyContactFlow.voiceService){
                    speakingType = LilyContactFlow.voiceService.getDefaultVoiceStyle(attributes.voice);
                }else {
                    //in case the getVoice response didn't come back before getAttributelabel gets called
                    // set the label with just the voice id and reset the label once the getVoice response comes back
                    angular.element($("#angularContainer")).scope().initializeTtsVoices(function() {
                        cell.model.findView(LilyContactFlow.paper).updateAttributeLabel(cell.model);
                    });
                }
            }
            
            if(speakingType){
                label = label + " (" + LilyContactFlow.getString('lily-admin-contact-flow-speaking-style-block-' + speakingType.toLowerCase()) + ")";
            }

        } else if(LilyContactFlow.isFeatureEnabled("isSetVoiceBlockWithNTTSVoicesEnabled")){
            if (cell.model.attributes.voice === "Joanna") {
                cell.model.attributes.voice = LilyContactFlow.SetVoiceModuleDefaultValue.NTTS_VOICE;
            }
            label = JSON.parse(cell.model.attributes.voice);
            if (_.isEqual(cell.model.attributes.voice, LilyContactFlow.SetVoiceModuleDefaultValue.NTTS_VOICE)) {
                label = label.voiceId + " (" + LilyContactFlow.getString('lily-admin-contact-flow-set-voice-attribute-label-default') + ")";
            } else {
                label = label.voiceId + " (" + label.engine + ")";
            }
        } else {
            label = cell.model.attributes.voice;
            if (label === LilyContactFlow.SetVoiceModuleDefaultValue.VOICE) {
                label = label + " (" + LilyContactFlow.getString('lily-admin-contact-flow-set-voice-attribute-label-default') + ")";
            }
        }

        return LilyContactFlow.getString('lily-admin-contact-flow-set-voice-attribute-label-voice') + ": " + label;
    },
    toAngular: function() {
        var currentThis = this; //setting a variable to current this to access the data in the callback function for initializeTtsVoices if supportsNeuralConversational is undefied at the moment
        var serializedData = {
            id: currentThis.model.id,
            voice: currentThis.model.attributes.voice,
            language: currentThis.model.attributes.language
        };
        if(LilyContactFlow.isFeatureEnabled("isSetVoiceBlockWithNTTSConversationalVoicesEnabled")){
            serializedData.templateUrl = "_setVoiceModalWithNTTSConversationalVoices.html";
            serializedData.engine = currentThis.model.attributes.engine;
            serializedData.overrideConsoleVoice = currentThis.model.attributes.overrideConsoleVoice;
            serializedData.speakingStyle = currentThis.model.attributes.speakingStyle;
            serializedData.useVoiceStyle = currentThis.model.attributes.engine;
            
            if (!serializedData.engine) {
                if(!LilyContactFlow.voiceService){
                    return angular.element($("#angularContainer")).scope().initializeTtsVoices(function() {
                        angular.element($("#angularContainer")).scope().showModal(serializedData);
                    });
                }
            }
        } else if(LilyContactFlow.isFeatureEnabled("isSetVoiceBlockWithNTTSVoicesEnabled")){
            serializedData.templateUrl = "_setVoiceModalWithNTTSVoices.html";
            if (serializedData.voice === "Joanna") {
                serializedData.voice = LilyContactFlow.SetVoiceModuleDefaultValue.NTTS_VOICE;
            }
        } else {
            serializedData.templateUrl = "_setVoiceModal.html";
        }
        angular.element($("#angularContainer")).scope().showModal(serializedData, {
            allowNeural: LilyContactFlow.voiceService.allowNeural,
            allowConversational: LilyContactFlow.voiceService.allowConversational,
            allowStandard: LilyContactFlow.voiceService.allowStandard,
            getSupportedSpeakingStyles: LilyContactFlow.voiceService.getSupportedSpeakingStyles,
            getDefaultSpeakingLabel: function(voice){
                var defaultStyle = LilyContactFlow.voiceService.getDefaultVoiceStyle(voice);
                if(defaultStyle === LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_STANDARD){
                    return LilyContactFlow.getString('lily-admin-contact-flow-set-voice-standard');
                }else {
                    return LilyContactFlow.getString('lily-admin-contact-flow-speaking-style-block-' + defaultStyle.toLowerCase());
                }
            },
            speakingStyleStrings: {
                None: LilyContactFlow.getString('lily-admin-contact-flow-speaking-style-dropdown-none'),
                Conversational: LilyContactFlow.getString('lily-admin-contact-flow-speaking-style-dropdown-conversational'),
                Newscaster: LilyContactFlow.getString('lily-admin-contact-flow-speaking-style-dropdown-newscaster')
            },
            initializeSpeakingStyle: function(modalData){
                modalData.speakingStyle = (modalData.speakingStyle && modalData.speakingStyle !== 'Standard'? modalData.speakingStyle:'None');
            }

        });
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.voice = data.voice;
        self.attributes.language = data.language;
        if(LilyContactFlow.isFeatureEnabled("isSetVoiceBlockWithNTTSConversationalVoicesEnabled")){
            self.attributes.overrideConsoleVoice = data.overrideConsoleVoice;
            if(data.overrideConsoleVoice){
                self.attributes.engine = data.useVoiceStyle;
                if(data.useVoiceStyle === "Standard"){
                    self.attributes.speakingStyle = "Standard";
                }else {
                    self.attributes.speakingStyle = data.speakingStyle;
                }
            }else {
                self.attributes.speakingStyle  = null;
                self.attributes.engine  = null;
            }
        }
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "SetVoice";
    },
    getMetadata: function(){
        var self = LilyContactFlow.graph.getCell(this.id);

        var metaData = {
            "overrideConsoleVoice": self.attributes.overrideConsoleVoice || false,
            "defaultVoice":  LilyContactFlow.voiceService.getDefaultVoiceStyle(self.attributes.voice)
        };

        return metaData;

    },
    getParameters: function() {
        var setVoiceParameters = [];
        var self = LilyContactFlow.graph.getCell(this.id);
        if(LilyContactFlow.isFeatureEnabled("isSetVoiceBlockWithNTTSConversationalVoicesEnabled")){
            setVoiceParameters.push({
                name: "GlobalVoice",
                value: self.attributes.voice
            });

            var globalEngine = self.attributes.engine;
            var speakingStyle = self.attributes.speakingStyle;
            if(self.attributes.overrideConsoleVoice){
                if(!globalEngine) {
                    globalEngine = self.attributes.speakingStyle === LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_STANDARD ? 
                        LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_STANDARD : LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_NEURAL;
                }
            }else {
                globalEngine = null;
                // if user didn't select override console voice but the voice doesn't support standard, send Neural for engine and None for speaking style
                if(!LilyContactFlow.voiceService.allowStandard(self.attributes.voice)){
                    globalEngine = LilyContactFlow.SetVoiceModuleDefaultValue.ENGINE_NEURAL;
                    speakingStyle = null;
                }
            }
            if (globalEngine){
                setVoiceParameters.push({
                    name:"GlobalEngine",
                    value: globalEngine
                });
                // if the voice only supports Neral Engine type, pass globalEngine but not speaking style unless user chose speaking style
                if(speakingStyle){
                    setVoiceParameters.push({
                        name: "SpeakingStyle",
                        value: speakingStyle
                    });
                }
            }


        } else if(LilyContactFlow.isFeatureEnabled("isSetVoiceBlockWithNTTSVoicesEnabled")){
            var voiceSelected = JSON.parse(self.attributes.voice);
            setVoiceParameters.push({
                name: "GlobalVoice",
                value: voiceSelected.voiceId
            });

            setVoiceParameters.push({
                name: "GlobalEngine",
                value: voiceSelected.engine
            });
        } else {
            setVoiceParameters.push({
                name: "GlobalVoice",
                value: self.attributes.voice
            });
        }

        return setVoiceParameters;
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setVoice"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
        condition: "Success"
    }]
};
LilyContactFlow.createSetVoiceModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.setVoiceParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.setVoiceParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};

LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.setVoiceParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.setVoiceParams);
    baseParams.id = data.id;

    var voice, engine, speakingStyle;
    var hasGlobalEngine = false;
    var hasSpeakingStyle = false;
    baseParams.overrideConsoleVoice = data.metadata.overrideConsoleVoice;

    _.forEach(data.parameters, function(param) {
        if (param.name === "GlobalVoice") {
            voice = param.value;
            baseParams.language = null;
        }else if (param.name === "GlobalEngine") {
            engine = param.value;
            hasGlobalEngine = true;
        } else if (param.name === "SpeakingStyle") {
            speakingStyle = param.value;
            hasSpeakingStyle = true;
        }
    });
    if(LilyContactFlow.isFeatureEnabled("isSetVoiceBlockWithNTTSConversationalVoicesEnabled")){
        baseParams.voice = voice;
        baseParams.engine = engine;
        var overrideNull = baseParams.overrideConsoleVoice === null || baseParams.overrideConsoleVoice === undefined;
        
        if(hasSpeakingStyle){
            if(overrideNull){
                baseParams.overrideConsoleVoice =  true;
            }
            baseParams.speakingStyle = speakingStyle;
            
        }else if(hasGlobalEngine){
            if(engine.toLowerCase() === "neural"){
                if(overrideNull){
                    baseParams.overrideConsoleVoice =  true;
                }
                baseParams.speakingStyle = LilyContactFlow.SetVoiceModuleDefaultValue.NTTS_STYLE_NEURAL_NONE;
            }else {
                // if speaking style is null, set the engine to null so that the override consolevoice is false
                baseParams.engine = null;
            }
        }

        if(baseParams.overrideConsoleVoice){
            baseParams.useVoiceStyle = engine;
        }
    } else if(LilyContactFlow.isFeatureEnabled("isSetVoiceBlockWithNTTSVoicesEnabled")) {
        if(!hasGlobalEngine){
            engine = "Standard"; //For backward Compatibility - the engine parameter for existing set voice block will be Standard
        }
        baseParams.voice = JSON.stringify({
            voiceId : voice,
            engine : engine
        });
    } else {
        baseParams.voice = voice;
    }
    return LilyContactFlow.deserializeWithConditions(baseParams);
};


LilyContactFlow.transferToPhoneNumberParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(4, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-transfer-number-label'); },
    phoneNumber: "",
    countryCode: null,
    blindTransfer: false,
    namespace: null,
    useDynamic: false,
    attribute: null,
    callerIdName: {},
    callerIdNumber: {},
    timeout: { value: 30 },
    dtmf: {},
    getAttributeLabel: function(cell) {

        var phoneNumber;

        var attributes = cell.model.attributes;
        if (attributes.useDynamic && attributes.attribute) {
            phoneNumber =  LilyContactFlow.getString('lily-admin-contact-flow-transfer-agent-attribute-label-dynamic') + "(" + attributes.attribute + ")";
        } else if (attributes.phoneNumber){
            phoneNumber = attributes.phoneNumber;
        } else {
            phoneNumber = "(" + LilyContactFlow.getString('lily-admin-contact-flow-transfer-number-attribute-label-none-selected') + ")";
        }
        return LilyContactFlow.getString('lily-admin-contact-flow-transfer-number-attribute-label-output') + ": " + phoneNumber;
    },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            countryCode: this.model.attributes.countryCode,
            templateUrl: "_transferToPhoneNumberWithBlindTransferAndDtmfSupportModal.html",
            initiateMethod: "initializeTransferE164",
            blindTransfer: this.model.attributes.blindTransfer,
            useDynamic: this.model.attributes.useDynamic,
            namespace: this.model.attributes.namespace,
            phoneNumber: this.model.attributes.phoneNumber,
            attribute: this.model.attributes.attribute,
            dtmf: this.model.attributes.dtmf,
            callerIdName: this.model.attributes.callerIdName,
            callerIdNumber: this.model.attributes.callerIdNumber,
            timeout: this.model.attributes.timeout
        };

        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },

    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);

        self.attributes.countryCode = data.countryCode;

        if (data.useDynamic) {
            self.attributes.namespace = data.namespace;
            self.attributes.attribute = data.attribute;
        } else {
            self.attributes.phoneNumber = data.phoneNumber;
        }
        self.attributes.useDynamic = data.useDynamic;

        var conditions = [];

        if (data.blindTransfer !== self.attributes.blindTransfer) {
            //blind transfer checkbox was toggled.

            if (!data.blindTransfer) {
                conditions.push(
                             {
                                 display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
                                 condition: "Success"
                             },
                             {
                                  display: LilyContactFlow.getString('lily-admin-contact-flow-condition-call-failure'),
                                  condition: "CallFailure"
                             },
                             {
                                 display: LilyContactFlow.getString('lily-admin-contact-flow-condition-timeout'),
                                 condition: "Timeout"
                             });
            }

            conditions.push({
                               display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
                               condition: "Error"
                            });

            self.attributes.blindTransfer = data.blindTransfer;
            self.findView(LilyContactFlow.paper).mergeInConditions(self, conditions);
        }
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
        self.attributes.dtmf = data.dtmf;
        self.attributes.callerIdName = data.callerIdName;
        self.attributes.callerIdNumber = data.callerIdNumber;
        self.attributes.timeout = data.timeout;
    },
    getType: function() {
        return "Transfer";
    },
    getTarget: function() {
        return "PhoneNumber";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var parameters = [];

        parameters.push({
            name: "TimeLimit",
            value: self.attributes.timeout.value.toString(),
            namespace: self.attributes.timeout.namespace
        });

        if (self.attributes.callerIdName.checked) {
            parameters.push({
                name: "SourceName",
                value: self.attributes.callerIdName.value,
                namespace: self.attributes.callerIdName.namespace
            });
        }
        if (self.attributes.callerIdNumber.checked) {
            parameters.push({
                name: "SourceNumber",
                value: self.attributes.callerIdNumber.value,
                namespace: self.attributes.callerIdNumber.namespace
            });
        }

        parameters.push({
            name: "BlindTransfer",
            value: self.attributes.blindTransfer
        });

        if (self.attributes.dtmf.checked) {
            parameters.push({
                name: "DtmfValue",
                value: self.attributes.dtmf.value,
                namespace: self.attributes.dtmf.namespace
            });
        }
        if (self.attributes.useDynamic && self.attributes.attribute && self.attributes.namespace) {
            parameters.push({
                name: "PhoneNumber",
                value: self.attributes.attribute,
                namespace: self.attributes.namespace
            });
        } else if (!self.attributes.useDynamic && self.attributes.phoneNumber) {
            parameters.push({
                name: "PhoneNumber",
                value: self.attributes.phoneNumber
            });
        }

        return parameters;
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);

        var metaData = {};

        if (self.attributes.callerIdNumber.checked) {
            metaData.callerIdSource = self.attributes.callerIdNumber.source;
        }

        if (!self.attributes.useDynamic) {
            metaData.CountryCode = self.attributes.countryCode;
        }

        return metaData;
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.TT_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.TT_MODULE_HEADER_FONT_COLOR,
        iconClass: "transferToPhoneNumber"
    },
    baseConditions: [
    {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
            condition: "Success"
    },
    {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-call-failure'),
            condition: "CallFailure"
    },
    {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-timeout'),
            condition: "Timeout"
    },
    {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
    }],
    staticConditionIds: [],
    getBranchLabel: function(node) {
        return node.display;
    },
    getConditionData: function(branch) {
        return {
            condition: branch.condition
        };
    },
    sortConditions: function(self) {
        return;
    }
};


LilyContactFlow.createTransferToPhoneNumberModule = function(x, y) {

    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.transferToPhoneNumberParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.transferToPhoneNumberParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};


LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.transferToPhoneNumberParams.getType()] = function(data) {
    var target = data.target ? data.target : "PhoneNumber";

    switch (target) {
        case "Flow":
            return LilyContactFlow.ModuleDecompilerByType.TransferToFlow(data);
        case "Queue":
            return LilyContactFlow.ModuleDecompilerByType.CustomerInQueue(data);
        case "Agent":
            return LilyContactFlow.ModuleDecompilerByType.LockAgent(data);
        case "PhoneNumber":

            var baseParams = _.merge({}, LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.transferToPhoneNumberParams);
            //Search for blind transfer param.
            var blindTransferParamArr = data.parameters && data.parameters.filter(function(param) { return "BlindTransfer"  === param.name;});
            if (blindTransferParamArr.length === 0 || window.LilyUtils.toBoolean(blindTransferParamArr[0].value)) {
                // 1. Blind transfer param is not present
                // Contact flows that were published using previous version of transfer block would not contain this param. To ensure that
                // their behavior is same, backfill the param value to true.
                // OR
                // 2. it is present and is equal to true.
                baseParams.blindTransfer = true;
                //When blind transer is checked, show only 1 branch.
                baseParams.baseConditions =  [{
                   display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
                   condition: "Error"
                }];
                baseParams.size = { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(1, true) };
            }

           baseParams.id = data.id;
           _.forEach(data.parameters, function(param) {
               switch(param.name) {
                   case "PhoneNumber":
                       if (param.namespace) {
                            baseParams.namespace = param.namespace;
                            baseParams.useDynamic = true;
                            baseParams.attribute = param.value;
                       } else {
                            baseParams.countryCode = data.metadata.CountryCode;
                            baseParams.phoneNumber = param.value;
                            baseParams.useDynamic = false;
                       }
                       break;
                   case "SourceName" :
                        baseParams.callerIdName.value = param.value;
                        baseParams.callerIdName.namespace = param.namespace;
                        baseParams.callerIdName.checked = true;
                        break;
                   case "SourceNumber":
                         baseParams.callerIdNumber.value = param.value;
                         baseParams.callerIdNumber.namespace = param.namespace;
                         baseParams.callerIdNumber.checked = true;
                         baseParams.callerIdNumber.source = data.metadata.callerIdSource;
                       break;
                   case "TimeLimit":
                        baseParams.timeout.namespace = param.namespace;
                        if (!param.namespace) {
                            //if namespace is undef, this means timeout is custom entered and should be a number.
                            baseParams.timeout.value = Number(param.value);
                        } else {
                            baseParams.timeout.value = param.value;
                        }
                       break;
                   case "BlindTransfer":
                        //Will the BlindTransfer param value be ever string?
                        //In case of import export, the imported file content is parsed by backend systems and then returned back to front end.
                        //Since parameter's value is always treated as a string in backend, a primitive boolean would be converted into string.
                        baseParams.blindTransfer = window.LilyUtils.toBoolean(param.value);
                       break;
                   case "DtmfValue":
                        baseParams.dtmf.namespace = param.namespace;
                        baseParams.dtmf.value = param.value;
                        baseParams.dtmf.checked = true;
                        break;
                   default:
                       break;
               }
           });

           return LilyContactFlow.deserializeWithConditions(baseParams);
        default:
            return;
    }
};

// Set logging behavior
LilyContactFlow.setLoggingBehaviorParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(1, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-set-logging-behavior-label'); },
    behavior: LilyContactFlow.SetLoggingBehaviorModuleDefaultValue.LOGGING_BEHAVIOR,
    getAttributeLabel: function(cell) {
        var label = cell.model.attributes.behavior;
        return (label === "Enable") ? LilyContactFlow.getString('lily-admin-contact-flow-set-logging-behavior-attribute-label-enabled') :
            LilyContactFlow.getString('lily-admin-contact-flow-set-logging-behavior-attribute-label-disabled');
    },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            behavior: this.model.attributes.behavior,
            templateUrl: "_setLoggingBehaviorModal.html"
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.behavior = data.behavior;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "SetLoggingBehavior";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return [{
            name: "LoggingBehavior",
            value: self.attributes.behavior
        }];
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setLoggingBehavior"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
        condition: "Success"
    }]
};

LilyContactFlow.createSetLoggingBehaviorModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.setLoggingBehaviorParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.setLoggingBehaviorParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};

LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.setLoggingBehaviorParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.setLoggingBehaviorParams);
    baseParams.id = data.id;
    _.forEach(data.parameters, function(param) {
        if (param.name === "LoggingBehavior") {
            baseParams.behavior = param.value;
        }
    });
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Set callback number
LilyContactFlow.setCallbackNumberParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(3, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-set-callback-label'); },
    getAttributeLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-set-callback-attribute-label'); },
    value: null,
    namespace: null,
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            value: this.model.attributes.value,
            namespace: this.model.attributes.namespace,
            templateUrl: "_setCallBackNumberModal.html"
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.value = data.value;
        self.attributes.namespace = data.namespace;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "SetCallBackNumber";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return [{
            name: "CallBackNumber",
            value: self.attributes.value,
            namespace: self.attributes.namespace
        }];
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setCallbackNumber"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
        condition: "Success"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-invalid-number'),
        condition: "InvalidPhoneNumber"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-not-dialable'),
        condition: "NonDialableNumber"
    }]
};
LilyContactFlow.createSetCallbackNumberModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.setCallbackNumberParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.setCallbackNumberParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.setCallbackNumberParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.setCallbackNumberParams);
    baseParams.id = data.id;
    _.forEach(data.parameters, function(param) {
        if (param.name === "CallBackNumber" ) {
            baseParams.value = param.value;
            baseParams.namespace = param.namespace;
        }
    });
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Set agent status
// TODO: remove once backfilled
LilyContactFlow.ModuleDecompilerByType.SetAgentStatus = function(data) {
    return LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.updateAgentStateParams.getType()](data);
};

LilyContactFlow.updateAgentStateParams = {
    agentStatusMap: {
        "AgentOnHold": LilyContactFlow.getString('lily-admin-contact-flow-set-agent-status-attribute-label-agent-hold'),
        "ConferenceAll": LilyContactFlow.getString('lily-admin-contact-flow-set-agent-status-attribute-label-conference'),
        "CustomerOnHold": LilyContactFlow.getString('lily-admin-contact-flow-set-agent-status-attribute-label-customer-hold')
    },
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-set-agent-status-label'); },
    getAttributeLabel: function(cell) {
        var status = '(' + LilyContactFlow.getString('lily-admin-contact-flow-set-agent-status-attribute-label-none') + ')';
        if(cell.model.attributes.agentStatus) {
            status = cell.model.attributes.agentStatusMap[cell.model.attributes.agentStatus];
        }
        return LilyContactFlow.getString('lily-admin-contact-flow-set-agent-status-attribute-label-status') + ': '+status;
    },
    agentStatus: null,
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            agentStatus: this.model.attributes.agentStatus,
            agentStatusMap: this.model.attributes.agentStatusMap,
            templateUrl: "_updateAgentStateModal.html"
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.agentStatus = data.agentStatus;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "UpdateAgentState";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return [{
            name: "AgentStatus",
            value: self.attributes.agentStatus
        }];
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setAgentStatus"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
        condition: "Success"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
    }]
};
LilyContactFlow.createUpdateAgentStateModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.updateAgentStateParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.updateAgentStateParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.updateAgentStateParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.updateAgentStateParams);
    baseParams.id = data.id;
    _.forEach(data.parameters, function(param) {
        if (param.name === "AgentStatus" ) {
            baseParams.agentStatus = param.value;
        }
    });
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Transfer to agent
LilyContactFlow.transferToAgentParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(0, true)},
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-transfer-agent-label'); },
    agent: null,
    namespace: "",
    value: "",
    useDynamic: false,
    customAgent: false,
    getAttributeLabel: function(cell) {
        var to = LilyContactFlow.getString('lily-admin-contact-flow-transfer-agent-attribute-label-to') + " ";
        if (!cell.model.attributes.customAgent) {
            return LilyContactFlow.getString('lily-admin-contact-flow-transfer-agent-attribute-label-transferred');
        } else if (cell.model.attributes.useDynamic) {
            return to + LilyContactFlow.getString('lily-admin-contact-flow-transfer-agent-attribute-label-dynamic') + " (" + cell.model.attributes.value + ")";
        } else {
            return to + cell.model.attributes.agent.text;
        }
    },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_transferToAgentModal.html",
            agent: this.model.attributes.agent,
            customAgent: this.model.attributes.customAgent,
            namespace: this.model.attributes.namespace,
            value: this.model.attributes.value,
            useDynamic: this.model.attributes.useDynamic
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.agent = data.customAgent && data.agent ? data.agent : null;
        self.attributes.value = data.useDynamic && data.value ? data.value : null;
        self.attributes.namespace = data.useDynamic && data.namespace ? data.namespace : null;
        self.attributes.useDynamic = data.useDynamic;
        self.attributes.customAgent = data.customAgent;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "LockAgent";
    },
    getTarget: function() {
        return "Agent";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        if (self.attributes.customAgent && !self.attributes.useDynamic) {
            return [{
                name: "AgentId",
                value: self.attributes.agent.id
            }];
        } else if (self.attributes.customAgent && self.attributes.useDynamic) {
            return [{
                name: "AgentId",
                namespace: self.attributes.namespace,
                value: self.attributes.value
            }];
        }
        return [];
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var metadata = {
            "useDynamic": self.attributes.useDynamic
        };
        if (self.attributes.agent) {
            return _.extend(metadata, {
                "Agent": self.attributes.agent
            });
        }
        return metadata;
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.TT_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.TT_MODULE_HEADER_FONT_COLOR,
        iconClass: "transferToAgent"
    },
    baseConditions: []
};

LilyContactFlow.createTransferToAgentModule = function(x,y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.transferToAgentParams));
        var nodes = [parent];
        _.forEach(LilyContactFlow.transferToAgentParams.baseConditions, function(label, i) {
            var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
            nodes.push(child);
        });
        return nodes;
};

LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.transferToAgentParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.transferToAgentParams);
    baseParams.customAgent = false;
    baseParams.useDynamic = data.metadata.useDynamic || false;
    _.forEach(data.parameters, function(param){
        if (param.name === "AgentId") {
            baseParams.customAgent = true;
            if (baseParams.useDynamic) {
                baseParams.value = param.value;
                baseParams.namespace = param.namespace;
            }
        }
    });
    if (baseParams.customAgent && !baseParams.useDynamic) {
        baseParams.agent = data.metadata.Agent;
    }
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Transfer to flow
LilyContactFlow.transferToFlowParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(1, true)},
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-transfer-flow-label'); },
    contactFlow: null,
    namespace: "",
    value: "",
    useDynamic: false,
    getAttributeLabel: function(cell) {
        var to = LilyContactFlow.getString('lily-admin-contact-flow-transfer-flow-attribute-label-to') + " ";
        if (cell.model.attributes.useDynamic) {
            return to + LilyContactFlow.getString('lily-admin-contact-flow-transfer-flow-attribute-label-dynamic') + " (" + cell.model.attributes.value + ")";
        } else if (cell.model.attributes.contactFlow) {
            return to + cell.model.attributes.contactFlow.text;
        } else {
            return to + "(" + LilyContactFlow.getString('lily-admin-contact-flow-transfer-flow-attribute-label-none-selected') + ")";
        }
    },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_transferToFlowModal.html",
            contactFlow: this.model.attributes.contactFlow,
            namespace: this.model.attributes.namespace,
            value: this.model.attributes.value,
            useDynamic: this.model.attributes.useDynamic
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.contactFlow = data.contactFlow ? data.contactFlow : null;
        self.attributes.value = data.useDynamic && data.value ? data.value : null;
        self.attributes.namespace = data.useDynamic && data.namespace ? data.namespace : null;
        self.attributes.useDynamic = data.useDynamic;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "TransferToFlow";
    },
    getTarget: function() {
        return "Flow";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        if (!self.attributes.useDynamic) {
            return [{
                name: "ContactFlowId",
                value: self.attributes.contactFlow ? self.attributes.contactFlow.id : null,
                resourceName: self.attributes.contactFlow ? self.attributes.contactFlow.text : null
            }];
        } else if (self.attributes.useDynamic) {
            return [{
                name: "ContactFlowId",
                namespace: self.attributes.namespace,
                value: self.attributes.value
            }];
        }
        return [];
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var metadata = {
            "useDynamic": self.attributes.useDynamic
        };
        if (self.attributes.contactFlow) { // TODO remove https://cr.amazon.com/r/7815548/
            return _.extend(metadata, {
                "ContactFlow": self.attributes.contactFlow
            });
        }
        return metadata;
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.TT_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.TT_MODULE_HEADER_FONT_COLOR,
        iconClass: "transferToFlow"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
    }]
};

LilyContactFlow.createTransferToFlowModule = function(x,y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.transferToFlowParams));
        var nodes = [parent];
        _.forEach(LilyContactFlow.transferToFlowParams.baseConditions, function(label, i) {
            var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
            nodes.push(child);
        });
        return nodes;
};

LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.transferToFlowParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.transferToFlowParams);
    baseParams.useDynamic = data.metadata.useDynamic || false;
    _.forEach(data.parameters, function(param){
        if (param.name === "ContactFlowId") {
            if (baseParams.useDynamic) {
                baseParams.value = param.value;
                baseParams.namespace = param.namespace;
            } else {
                baseParams.contactFlow = {
                    id: param.value,
                    text: param.resourceName ? param.resourceName :
                        (data.metadata.ContactFlow ? data.metadata.ContactFlow.text : null)
                };
            }
        }
    });
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Media Streaming
var stopMediaStreamingParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    fromAngular: function(data) { },
    getParameters: function() {
        var stopStreamParameters = [
            {
                name:"Track",
                value:"FromCustomer"
            },{
                name:"Track",
                value:"ToCustomer"
            },{
                name:"MediaStreamTypes",
                value:"Audio"
            }
        ];
        return stopStreamParameters;
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
        condition: "Success"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
    }]
};

var startMediaStreamingParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        if(typeof data.fromCustomer === "boolean"){
            self.attributes.fromCustomer=data.fromCustomer;
        }
        if(typeof data.toCustomer === "boolean"){
            self.attributes.toCustomer=data.toCustomer;
        }
    },
    getParameters: function() {
        var startStreamParameters = [];
        var self = LilyContactFlow.graph.getCell(this.id);
        if(self.attributes.fromCustomer){
            startStreamParameters.push({
                name:"Track",
                value:"FromCustomer"
            });
        }
        if(self.attributes.toCustomer){
            startStreamParameters.push({
                name:"Track",
                value:"ToCustomer"
            });
        }

        startStreamParameters.push({
            name:"MediaStreamTypes",
            value:"Audio"
        });
        return startStreamParameters;
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var metaData = {};

        if (typeof self.attributes.fromCustomer === "boolean") {
            metaData.fromCustomer = self.attributes.fromCustomer;
        }
        if (typeof self.attributes.toCustomer === "boolean") {
            metaData.toCustomer = self.attributes.toCustomer;
        }

        return metaData;
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
        condition: "Success"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
    }]
};

LilyContactFlow.startMediaStreamingParams = _.extend({
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-start-media-streaming-label'); },
    getAttributeLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-start-media-streaming-attribute-label'); },
    fromCustomer: true,
    toCustomer: true,
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
        };
        serializedData.templateUrl = "_startMediaStreamingModalWithFromAndToCustomer.html";
        serializedData.fromCustomer = this.model.attributes.fromCustomer;
        serializedData.toCustomer = this.model.attributes.toCustomer;

        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    getType: function() {
        return "StartMediaStreaming";
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "ico-start-media-streaming"
    }
}, startMediaStreamingParams);

LilyContactFlow.createStartMediaStreamingModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.startMediaStreamingParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.startMediaStreamingParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.startMediaStreamingParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.startMediaStreamingParams);
    baseParams.id = data.id;

    // For backward compatibility - if existing contact flow has start media streaming block, only from customer should be checked
    // New block uses "Track" parameter, previously was "ParticipantTypes"
    var hasTrack = false;
    _.forEach(data.parameters, function(param) {
        if(param.name === "Track"){
            hasTrack = true;
        }
    });
    if(hasTrack === false){
        baseParams.fromCustomer = true;
        baseParams.toCustomer = false;
    } else {
        if(typeof data.metadata.fromCustomer === "boolean"){
            baseParams.fromCustomer = data.metadata.fromCustomer;
        }
        if(typeof data.metadata.toCustomer === "boolean"){
            baseParams.toCustomer = data.metadata.toCustomer;
        }
    }

    return LilyContactFlow.deserializeWithConditions(baseParams);
};
LilyContactFlow.stopMediaStreamingParams = _.extend({
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-stop-media-streaming-label'); },
    getAttributeLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-stop-media-streaming-attribute-label'); },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_stopMediaStreamingModal.html"
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    getType: function() {
        return "StopMediaStreaming";
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "ico-stop-media-streaming"
    }
}, stopMediaStreamingParams);
LilyContactFlow.createStopMediaStreamingModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.stopMediaStreamingParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.stopMediaStreamingParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.stopMediaStreamingParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.stopMediaStreamingParams);
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};
// Basic shared stuff between all the "set flow" modules
LilyContactFlow.setFlowBaseParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(1, true) },
    getAttributeLabel: function(cell) {
        if (cell.model.attributes.contactFlow) {
            return cell.model.attributes.contactFlow.text;
        } else {
            return LilyContactFlow.getString('lily-admin-contact-flow-set-flow-none-selected');
        }
    },
    getType: function() {
        return "SetContactFlow";
    },
    customerOrAgent: false,      // true for customer, and false for agent. set customer queue flow doesn't use this value since it only has customer
    contactFlow: null,
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: this.model.attributes.templateUrl,
            contactFlow: this.model.attributes.contactFlow,
            eventType: this.model.attributes.eventType,
            customerOrAgent: this.model.attributes.customerOrAgent
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.contactFlow = data.contactFlow;
        self.attributes.eventType = data.eventType;
        self.attributes.customerOrAgent = data.customerOrAgent;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return [{
            name: "ContactFlowId",
            value: self.attributes.contactFlow ? self.attributes.contactFlow.id : null,
            resourceName: self.attributes.contactFlow ? self.attributes.contactFlow.text : null
        }, {
            name: "Type",
            value: self.attributes.eventType
        }];
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id); // TODO remove https://cr.amazon.com/r/7815548/
        return {
            "contactFlow": self.attributes.contactFlow,
            "customerOrAgent": self.attributes.customerOrAgent
        };
    },
    baseConditions: [{
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
            condition: "Success"
        }
    ]
};

// Create new setFlowBaseParams module setFlowBaseParamsV2 for the new set hold flow, set whisper flow and set customer queue flow.
LilyContactFlow.setFlowBaseParamsV2 = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    getAttributeLabel: function(cell) {
        var attributes =  cell.model.attributes;
        if (!attributes.contactFlow || attributes.contactFlow.id === null) {
            return LilyContactFlow.getString('lily-admin-contact-flow-set-flow-none-selected');
        } else if (attributes.contactFlow && attributes.useDynamic) {
            return LilyContactFlow.getString('lily-admin-contact-flow-loop-attribute-label-dynamic') + "(" + attributes.contactFlow + ")";
        } else {
            return attributes.contactFlow.text;
        }
    },
    contactFlow: null,
    useDynamic: false,
    namespace: "",
    customerOrAgent: false,       // true for customer, and false for agent. set customer queue flow doesn't use this value since it only has customer
    getType: function() {
        return "SetEventHook";
    },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: this.model.attributes.templateUrl,
            contactFlow: this.model.attributes.contactFlow,
            eventType: this.model.attributes.eventType,
            namespace: this.model.attributes.namespace,
            useDynamic: this.model.attributes.useDynamic,
            customerOrAgent: this.model.attributes.customerOrAgent
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.contactFlow = data.contactFlow;
        self.attributes.eventType = data.eventType;
        self.attributes.useDynamic = data.useDynamic;
        self.attributes.namespace = data.namespace;
        self.attributes.customerOrAgent = data.customerOrAgent;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var parameters = [{
            name: "Type",
            value: self.attributes.eventType
        }];
        if (!self.attributes.useDynamic) {
            parameters.push({
                name: "ContactFlowId",
                value: self.attributes.contactFlow ? self.attributes.contactFlow.id : null,
                resourceName: self.attributes.contactFlow ? self.attributes.contactFlow.text : null
            });
        } else if (self.attributes.useDynamic) {
            parameters.push({
                name: "ContactFlowId",
                value: self.attributes.contactFlow,
                namespace: self.attributes.namespace,
            });
        }
        return parameters;
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return {
            "contactFlow": self.attributes.contactFlow,
            "customerOrAgent": self.attributes.customerOrAgent,
            "useDynamic": self.attributes.useDynamic
        };
    },
    baseConditions: [{
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
            condition: "Success"
        }, {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
            condition: "Error"
        }
    ]
};

LilyContactFlow.baseCreateSetFlowModule = function(x, y, baseParams) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), baseParams));
    var nodes = [parent];

    _.forEach(LilyContactFlow.setHoldFlowParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};

// create new setFlow module for set hold flow, set whisper flow and set customer queue flow
LilyContactFlow.baseCreateSetFlowModuleV2 = function(x, y, baseParams) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), baseParams));
    var nodes = [parent];

    _.forEach(LilyContactFlow.setHoldFlowParamsV2.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};

LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.setFlowBaseParams.getType()] = function(data) {

    if (LilyContactFlow.isFeatureEnabled("isSetContactFlowBlockFeatureEnabled")) {
        return LilyContactFlow.decompileSetFlowBlockV2(data);
    } else {
        return LilyContactFlow.decompileSetFlowBlock(data);
    }
};

LilyContactFlow.decompileSetFlowBlock = function(data) {
    var typeParam;
    var baseParams = {};
    _.forEach(data.parameters, function(param) {
        if (param.name === "Type") {
            typeParam = param;
        } else if (param.name === "ContactFlowId") {
            baseParams.contactFlow = {
                id: param.value,
                text: param.resourceName ? param.resourceName :
                    (data.metadata.contactFlow ? data.metadata.contactFlow.text : null)
            };
        }
    });
    switch(typeParam.value) {
        case "CustomerWhisper":
            baseParams = _.extend({}, LilyContactFlow.setWhisperFlowParams, baseParams);
            break;
        case "CustomerHold":
            baseParams = _.extend({}, LilyContactFlow.setHoldFlowParams, baseParams);
            break;
        case "AgentWhisper":
            baseParams = _.extend({}, LilyContactFlow.setWhisperFlowParams, baseParams);
            break;
        case "AgentHold":
            baseParams = _.extend({}, LilyContactFlow.setHoldFlowParams, baseParams);
            break;
        case "CustomerQueue":
            baseParams = _.extend({}, LilyContactFlow.setCustomerQueueFlowParams, baseParams);
            break;
        default:
            break;
    }
    if (!baseParams) {
        return [];
    }
    baseParams.eventType = typeParam.value;
    baseParams.id = data.id;
    baseParams = _.extend({}, LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), baseParams);
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// This method contains set hold flow, set whisper flow, set customer queue flow, and set disconnect flow
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.setFlowBaseParamsV2.getType()] = function(data) {
    return LilyContactFlow.decompileSetFlowBlockV2(data);
};

LilyContactFlow.decompileSetFlowBlockV2 = function(data) {

    // When customer re-publish the old contact flow, the new error branch will show and it will be linked to where the success
    // branch links to automatically
    // do this by adding the error branch to data which only has success branch
    // and the transition is the same as success branch
    if (data.branches.length === 1) {
        var tran;
        _.forEach(data.branches, function(branch) {
            if (branch.condition === "Success") {
                tran = branch.transition;
            }
        });
        var temp = {condition: "Error", transition: tran};
        data.branches.push(temp);
    }

    var typeParam;
    var baseParams = {};
    baseParams.useDynamic = data.metadata.useDynamic || false;
    _.forEach(data.parameters, function(param) {
        if (param.name === "Type") {
            typeParam = param;
        } else if (param.name === "ContactFlowId") {
            if (baseParams.useDynamic) {
                baseParams.contactFlow = param.value;
                baseParams.namespace = param.namespace;
            } else {
                baseParams.contactFlow = {
                    id: param.value,
                    text: param.resourceName ? param.resourceName :
                    (data.metadata.contactFlow ? data.metadata.contactFlow.text : null)
                };
            }
        }
    });
    switch(typeParam.value) {
        case "CustomerWhisper":
            baseParams = _.extend({}, LilyContactFlow.setWhisperFlowParamsV2, baseParams, { customerOrAgent: true });
            break;
        case "CustomerHold":
            baseParams = _.extend({}, LilyContactFlow.setHoldFlowParamsV2, baseParams, { customerOrAgent: true });
            break;
        case "AgentWhisper":
            baseParams = _.extend({}, LilyContactFlow.setWhisperFlowParamsV2, baseParams, { customerOrAgent: false });
            break;
        case "AgentHold":
            baseParams = _.extend({}, LilyContactFlow.setHoldFlowParamsV2, baseParams, { customerOrAgent: false });
            break;
        case "CustomerQueue":
            baseParams = _.extend({}, LilyContactFlow.setCustomerQueueFlowParamsV2, baseParams, { customerOrAgent: true });
            break;
        case "CustomerRemaining":
            baseParams = _.extend({}, LilyContactFlow.setDisconnectFlowParams, baseParams, { customerOrAgent: true });
            break;
        default:
            break;
    }
    if (!baseParams) {
        return [];
    }
    baseParams.useDynamic = data.metadata.useDynamic || false;
    baseParams.eventType = typeParam.value;
    baseParams.id = data.id;
    baseParams = _.extend({}, LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), baseParams);
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Set hold flow
LilyContactFlow.setHoldFlowParams = _.extend({}, LilyContactFlow.setFlowBaseParams, {
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-set-hold-flow-label'); },
    templateUrl: "_setHoldFlowModal.html",
    eventType: "AgentHold",
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setHoldFlow"
    }
});

LilyContactFlow.setHoldFlowParamsV2 = _.extend({}, LilyContactFlow.setFlowBaseParamsV2, {
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-set-hold-flow-label'); },
    templateUrl: "_setHoldFlowModalV2.html",
    eventType: "AgentHold",
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setHoldFlow"
    }
});

LilyContactFlow.createSetHoldFlowModule = function(x, y) {
    return LilyContactFlow.baseCreateSetFlowModule(x, y, LilyContactFlow.setHoldFlowParams);
};

// new module for set hold flow
LilyContactFlow.createSetHoldFlowModuleV2 = function(x, y) {
    return LilyContactFlow.baseCreateSetFlowModuleV2(x, y, LilyContactFlow.setHoldFlowParamsV2);
};

// Set whisper flow
LilyContactFlow.setWhisperFlowParams = _.extend({}, LilyContactFlow.setFlowBaseParams, {
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-set-whisper-flow-label'); },
    templateUrl: "_setWhisperFlowModal.html",
    eventType: "AgentWhisper",
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setWhisperFlow"
    }
});

LilyContactFlow.setWhisperFlowParamsV2 = _.extend({}, LilyContactFlow.setFlowBaseParamsV2, {
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-set-whisper-flow-label'); },
    templateUrl: "_setWhisperFlowModalV2.html",
    eventType: "AgentWhisper",
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setWhisperFlow"
    }
});

LilyContactFlow.createSetWhisperFlowModule = function(x, y) {
    return LilyContactFlow.baseCreateSetFlowModule(x, y, LilyContactFlow.setWhisperFlowParams);
};

// new module for set whisper flow
LilyContactFlow.createSetWhisperFlowModuleV2 = function(x, y) {
    return LilyContactFlow.baseCreateSetFlowModuleV2(x, y, LilyContactFlow.setWhisperFlowParamsV2);
};

// Set customer queue flow
LilyContactFlow.setCustomerQueueFlowParams = _.extend({}, LilyContactFlow.setFlowBaseParams, {
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-set-cust-queue-flow-label'); },
    templateUrl: "_setCustomerQueueFlowModal.html",
    eventType: "CustomerQueue",
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setCustomerQueueFlow"
    }
});

LilyContactFlow.setCustomerQueueFlowParamsV2 = _.extend({}, LilyContactFlow.setFlowBaseParamsV2, {
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-set-cust-queue-flow-label'); },
    templateUrl: "_setCustomerQueueFlowModalV2.html",
    eventType: "CustomerQueue",
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setCustomerQueueFlow"
    }
});


LilyContactFlow.createSetCustomerQueueFlowModule = function(x, y) {
    return LilyContactFlow.baseCreateSetFlowModule(x, y, LilyContactFlow.setCustomerQueueFlowParams);
};

// new module for set customer queue flow
LilyContactFlow.createSetCustomerQueueFlowModuleV2 = function(x, y) {
    return LilyContactFlow.baseCreateSetFlowModuleV2(x, y, LilyContactFlow.setCustomerQueueFlowParamsV2);
};

// Set disconnect contact flow
LilyContactFlow.setDisconnectFlowParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-set-disconnect-flow-label'); },
    getAttributeLabel: function(cell) {
        var customerLabel = LilyContactFlow.getString('lily-admin-contact-flow-set-disconnect-flow-attribute-label-customer') + ": ";
        var attributes =  cell.model.attributes;
        if (!attributes.contactFlow || attributes.contactFlow.id === null) {
            return customerLabel + LilyContactFlow.getString('lily-admin-contact-flow-set-flow-none-selected');
        } else if (attributes.contactFlow && attributes.useDynamic) {
            return customerLabel + LilyContactFlow.getString('lily-admin-contact-flow-loop-attribute-label-dynamic') + "(" + attributes.contactFlow + ")";
        } else {
            return customerLabel + attributes.contactFlow.text;
        }
    },
    eventType: "CustomerRemaining",
    templateUrl: "_setDisconnectFlowModal.html",
    contactFlow: null,
    useDynamic: false,
    namespace: "",
    getType: function() {
        return "SetEventHook";
    },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: this.model.attributes.templateUrl,
            contactFlow: this.model.attributes.contactFlow,
            eventType: this.model.attributes.eventType,
            namespace: this.model.attributes.namespace,
            useDynamic: this.model.attributes.useDynamic
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.contactFlow = data.contactFlow;
        self.attributes.eventType = data.eventType;
        self.attributes.useDynamic = data.useDynamic;
        self.attributes.namespace = data.namespace;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var parameters = [{
            name: "Type",
            value: self.attributes.eventType
        }];
        if (!self.attributes.useDynamic) {
            parameters.push({
                name: "ContactFlowId",
                value: self.attributes.contactFlow ? self.attributes.contactFlow.id : null,
                resourceName: self.attributes.contactFlow ? self.attributes.contactFlow.text : null
            });
        } else if (self.attributes.useDynamic) {
            parameters.push({
                name: "ContactFlowId",
                value: self.attributes.contactFlow,
                namespace: self.attributes.namespace,
            });
        }
        return parameters;
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return {
            "useDynamic": self.attributes.useDynamic
        };
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setDisconnectFlow"
    },
    baseConditions: [{
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
            condition: "Success"
        }, {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
            condition: "Error"
        }
    ]
};

LilyContactFlow.createSetDisconnectFlowModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.setDisconnectFlowParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.setDisconnectFlowParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};


// Play audio
//TODO: remove after backfilling
LilyContactFlow.ModuleDecompilerByType.PlayAudio = function(data) {
    return LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.playAudioParams.getType()](data);
};

LilyContactFlow.getBasicAudioAttributeLabel = function(cell) {
    var text, promptName;
    if (cell.model.attributes.useTts) {
        if (cell.model.attributes.useDynamic) {
            text = cell.model.attributes.tts ? cell.model.attributes.tts : LilyContactFlow.getString('lily-admin-contact-flow-play-audio-attribute-label-none');
            return LilyContactFlow.getString('lily-admin-contact-flow-play-audio-attribute-label-text') + ": " + LilyContactFlow.getString('lily-admin-contact-flow-play-audio-attribute-label-dynamic')+ "(" + text + ")";
        } else {
            text = cell.model.attributes.tts ? cell.model.attributes.tts : "(" + LilyContactFlow.getString('lily-admin-contact-flow-play-audio-attribute-label-none-entered') + ")";
            return LilyContactFlow.getString('lily-admin-contact-flow-play-audio-attribute-label-text') + ": " + text;
        }
    } else {
        if (cell.model.attributes.useDynamic) {
            promptName = cell.model.attributes.prompt ? cell.model.attributes.prompt : LilyContactFlow.getString('lily-admin-contact-flow-play-audio-attribute-label-none');
            return LilyContactFlow.getString('lily-admin-contact-flow-play-audio-attribute-label-prompt') + ": " + LilyContactFlow.getString('lily-admin-contact-flow-play-audio-attribute-label-dynamic') + "(" + promptName + ")";
        } else {
            promptName = cell.model.attributes.prompt ? cell.model.attributes.prompt.text : "(" + LilyContactFlow.getString('lily-admin-contact-flow-play-audio-attribute-label-none-selected') + ")";
            return LilyContactFlow.getString('lily-admin-contact-flow-play-audio-attribute-label-prompt') + ": " + promptName;
        }
    }
};

/**
 * Simple helper to extract appropriate dynamic attribute
 * espects model object of form: {  useDynamic: [true|false], useTts: [true|false], tts: '', prompt: '' }
 */
LilyContactFlow.extractDynamicAudioAttribute = function(attributes) {
    if (attributes.useDynamic) {
        return attributes.useTts ? attributes.tts : attributes.prompt;
    }
    return null;
};

LilyContactFlow.fillCommonPromptAttributes = function(data, attributes) {
    attributes.useTts = data.useTts;
    if (!data.useTts) {
        attributes.prompt = data.useDynamic ? data.attribute : data.prompt;
    } else {
        attributes.ttsType = data.ttsType;
        attributes.prompt = null;
    }
    var tts = data.useDynamic ? data.attribute : data.tts;
    attributes.tts = data.useTts && tts ? tts : null;
    attributes.useDynamic = data.useDynamic;
    attributes.namespace = data.useDynamic ? data.namespace : null;
};

LilyContactFlow.playAudioParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(1, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-play-audio-label'); },
    getAttributeLabel: function(cell) {
        return LilyContactFlow.getBasicAudioAttributeLabel(cell);
    },
    useTts: false,
    tts: null,
    namespace: null,
    prompt: null,
    useDynamic: false,
    ttsType: "text",
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_playAudioModal.html",
            useTts: this.model.attributes.useTts,
            tts: this.model.attributes.tts,
            namespace: this.model.attributes.namespace,
            attribute: LilyContactFlow.extractDynamicAudioAttribute(this.model.attributes),
            prompt: this.model.attributes.useDynamic ? null : this.model.attributes.prompt,
            useDynamic: this.model.attributes.useDynamic,
            ttsType: this.model.attributes.ttsType
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        LilyContactFlow.fillCommonPromptAttributes(data, self.attributes);
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "PlayPrompt";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        if (self.attributes.useTts) {
            // TODO: voice selector
            return [{
                name: "Text",
                value: self.attributes.tts,
                namespace: self.attributes.namespace
            }, {
                name: "TextToSpeechType",
                value: self.attributes.ttsType
            }];
        } else {
            var prompt = self.attributes.prompt;
            var resourceName = null;
            if (_.isObject(prompt)) {
                resourceName = prompt.text;
                prompt = prompt.id;
            }
            return [{
                name: "AudioPrompt",
                value: prompt,
                namespace: self.attributes.namespace,
                resourceName: resourceName
            }];
        }
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var metadata = {
            "useDynamic": self.attributes.useDynamic
        };
        if (!self.attributes.useTts && self.attributes.prompt) { // TODO remove https://cr.amazon.com/r/7815548/
            _.extend(metadata, {
                "promptName": self.attributes.prompt.text
            });
        }
        return metadata;
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "playPrompt"
    },
    baseConditions: [{
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-okay'),
            condition: "Success"
        }
    ]
};
LilyContactFlow.createPlayAudioModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.playAudioParams));
    var nodes = [parent];

    _.forEach(LilyContactFlow.playAudioParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.playAudioParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.playAudioParams);
    baseParams.useDynamic = data.metadata.useDynamic || false;
    _.forEach(data.parameters, function(param) {
        switch(param.name) {
            case "Text": 
                baseParams.tts = param.value;
                baseParams.useTts = true;
                baseParams.namespace = param.namespace || null;
                break;
            case "AudioPrompt":
                if (param.value) {
                    if (baseParams.useDynamic) {
                        baseParams.prompt = param.value;
                    } else {
                        baseParams.prompt = {
                            id: param.value,
                            text: param.resourceName ? param.resourceName : data.metadata.promptName
                        };
                    }
                } else {
                    baseParams.prompt = null;
                }
                baseParams.useTts = false;
                baseParams.tts = null;
                baseParams.namespace = param.namespace || null;
                break;
            case "TextToSpeechType":
                baseParams.ttsType = param.value;
                break;
            default:
                break;
        }
    });
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

// Play looping audio
// TODO: remove once backfilled
LilyContactFlow.ModuleDecompilerByType.AddToPlayLoop = function(data) {
    return LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.loopAudioParams.getType()](data);
};

LilyContactFlow.loopAudioTimeunits = {
    sec: {display: LilyContactFlow.getString('lily-admin-contact-flow-loop-audio-seconds'), value: "sec"},
    min: {display: LilyContactFlow.getString('lily-admin-contact-flow-loop-audio-minutes'), value: "min"}
};
LilyContactFlow.loopAudioTimeunitList = Object.keys(LilyContactFlow.loopAudioTimeunits).map(function(key) {
    return LilyContactFlow.loopAudioTimeunits[key];
});
LilyContactFlow.loopAudioParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(0, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-loop-audio-label'); },
    getAttributeLabel: function(cell) {
        var promptCount = cell.model.attributes.audio.length;
        if (promptCount === 0) {
            return LilyContactFlow.getString('lily-admin-contact-flow-play-audio-attribute-label-prompt') + ": (" + LilyContactFlow.getString('lily-admin-contact-flow-play-audio-attribute-label-none') + ")";
        } else if (promptCount === 1) {
            if (cell.model.attributes.audio[0].type === "Text") {
                return LilyContactFlow.getString('lily-admin-contact-flow-play-audio-attribute-label-text') + ": " + cell.model.attributes.audio[0].tts;
            } else {
                var val = cell.model.attributes.audio[0].prompt ? cell.model.attributes.audio[0].prompt.text : cell.model.attributes.audio[0].text;
                return LilyContactFlow.getString('lily-admin-contact-flow-loop-audio-attribute-label-audio-rec') + ": " + val;
            }
        } else {
            return LilyContactFlow.getString('lily-admin-contact-flow-loop-audio-attribute-label-multiple-prompts') + " (" + promptCount.toString() + ")";
        }
    },
    conditions: [],
    audio: [],
    useTimeout: false,
    timeout: 2,
    timeoutUnit: LilyContactFlow.loopAudioTimeunits.min,
    toAngular: function() {
        _.forEach(this.model.attributes.audio, function(audio) {
            if (!audio.prompt) {
                audio.prompt = {
                    id: audio.id,
                    text: audio.text
                };
            }
        });
        var serializedData = {
            id: this.model.id,
            templateUrl: "_loopAudioModal.html",
            audio: this.model.attributes.audio,
            useTimeout: this.model.attributes.useTimeout,
            timeout: this.model.attributes.timeout,
            timeoutUnit: this.model.attributes.timeoutUnit,
            timeoutUnits: LilyContactFlow.loopAudioTimeunitList
        };
        angular.element($("#angularContainer")).scope().showModal(angular.copy(serializedData));
        return serializedData;
    },
    fromAngular: function(data) {
        _.forEach(data.audio, function(audio) {
            if (audio.prompt) {
                audio.id = audio.prompt.id;
                audio.text = audio.prompt.text;
                audio.prompt = null;
            }
        });
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.audio = data.audio;
        self.attributes.useTimeout = data.useTimeout;
        self.attributes.timeout = data.timeout;
        self.attributes.timeoutUnit = data.timeoutUnit;

        var conditions = [];
        var matchingConditions;
        if (data.useTimeout) {
            matchingConditions = self.attributes.conditions.filter(function(condition) {
                return condition.condition === "Timeout";
            });
            if (matchingConditions.length > 0) {
                conditions.push(matchingConditions[0]);
            } else {
                conditions.push({
                    display: LilyContactFlow.getString('lily-admin-contact-flow-condition-timeout'),
                    condition: "Timeout"
                });
            }
        }

        self.findView(LilyContactFlow.paper).mergeInConditions(self, conditions);
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "LoopPrompts";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        // TODO: voice selector
        var parameters = [];
        var hasTts = false;
        _.forEach(self.attributes.audio, function(audio) {
            if (audio.type === "Text") {
                hasTts = true;
                parameters.push({
                    name: "Text",
                    value: audio.tts ? audio.tts : "",
                    key: audio.ttsType ? audio.ttsType : null
                });
            } else {
                parameters.push({
                    name: "AudioPrompt",
                    value: audio.prompt ? audio.prompt.id : audio.id,
                    resourceName: audio.prompt ? audio.prompt.text : audio.text
                });
            }
        });
        if (self.attributes.useTimeout) {
            var interruptSeconds = null;
            if (self.attributes.timeoutUnit) {
                interruptSeconds = self.attributes.timeoutUnit.value === "sec" ? self.attributes.timeout : self.attributes.timeout * 60;
            }
            parameters.push({
                name: "InterruptSeconds",
                value: interruptSeconds
            });
        }
        return parameters;
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return {
            audio: self.attributes.audio, // TODO: remove https://cr.amazon.com/r/7815548/
            timeoutUnit: self.attributes.timeoutUnit
        };
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "loopPrompts"
    },
    baseConditions: [],
    sortConditions: function(self) {
        var view = self.findView(LilyContactFlow.paper);
        // Reorder all of the branches such that the bottom are Timeout, Error
        _.forEach(["Timeout", "Error"], function(condition) {
            view.moveCellToBottomByCondition(self, condition);
        });
    },
    getBranchLabel: function(node) {
        return node.display;
    },
    getConditionData: function(branch) {
        return {
            condition: branch.condition
        };
    },
    staticConditionIds: []
};
LilyContactFlow.createLoopAudioModule = function(x, y) {
    // enable error branch on new loop prompt blocks
    var params = angular.copy(LilyContactFlow.loopAudioParams);
    if (LilyContactFlow.contactFlowType === "customerQueue") {
        LilyContactFlow.addBaseCondition(params, {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
            condition: "Error"
        });

        params.size.height = LilyContactFlow.getModuleHeight(params.baseConditions.length, true);
    }

    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), params));
    var nodes = [parent];

    _.forEach(params.baseConditions, function(condition, i) {
        var staticCondition = LilyContactFlow.addOutputCondition(parent, condition.display, condition.condition, nodes.length - 1);
        parent.attributes.staticConditionIds.push(staticCondition.id);
        nodes.push(staticCondition);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.loopAudioParams.getType()] = function(data) {
    var baseParams = _.extend({}, LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.loopAudioParams);
    if (data.metadata.timeoutUnit) {
        baseParams.timeoutUnit = data.metadata.timeoutUnit;
    }
    baseParams.id = data.id;
    baseParams.audio = [];
    _.forEach(data.parameters, function(param) {
        if (param.name === "InterruptSeconds") {
            baseParams.timeout = param.value;
            if (baseParams.timeoutUnit.value === LilyContactFlow.loopAudioTimeunits.min.value) {
                baseParams.timeout = baseParams.timeout / 60;
            }
            baseParams.useTimeout = true;
        } else {
            if (param.key || param.name === "Text") { // text
                baseParams.audio.push({
                    tts: param.value,
                    useTts: true,
                    ttsType: param.key,
                    type: "Text"
                });
            } else {
                if (param.resourceName) {
                    baseParams.audio.push({
                        id: param.value,
                        text: param.resourceName,
                        type: "Prompt"
                    });
                } else if (param.value) {
                    if (!data.metadata.audio || data.metadata.audio.length === 0) {
                        baseParams.audio.push({
                            id: param.value,
                            text: "",
                            type: "Prompt"
                        });
                    } else {
                        _.forEach(data.metadata.audio, function(audio) {
                            var promptIdMatchesValue = (audio.prompt && audio.prompt.id === param.value) || (audio.id && audio.id === param.value);
                            if (audio.type === "Prompt" && promptIdMatchesValue) {
                                baseParams.audio.push(audio);
                            }
                        });
                    }
                } else {
                    // Otherwise, this is a saved prompt with nothing selected, just insert an empty prompt just like the button does
                    baseParams.audio.push({type: 'Prompt', prompt: null, text: null, ttsType: 'text'});
                }
            }
        }
    });

    var parent = new joint.shapes.module(baseParams);
    var nodes = [parent];
    var conditions = [];

    var hasErrorBranch = false;
    _.forEach(data.branches, function(branch, i) {
        if (branch.condition === "Error") {
            hasErrorBranch = true;
        } else {
            var condition = {
                condition: branch.condition,
                transition: branch.transition
            };
            switch (branch.condition) {
                case "Timeout":
                    condition.display = LilyContactFlow.getString('lily-admin-contact-flow-condition-timeout');
                    break;
                default:
                    return; //Ignore invalid conditions
            }
            var newCell = LilyContactFlow.addOutputCondition(parent, condition.display, condition.condition, conditions.length);
            condition.id = newCell.id;
            nodes.push(newCell);
            conditions.push(condition);
        }
    });

    if (hasErrorBranch) {
        LilyContactFlow.addBaseCondition(baseParams, {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
            condition: "Error"
        });
    }
    _.forEach(baseParams.baseConditions, function(condition, i) {
        var staticCondition = LilyContactFlow.addOutputCondition(parent, condition.display, condition.condition, nodes.length - 1);
        parent.attributes.staticConditionIds.push(staticCondition.id);
        nodes.push(staticCondition);
    });

    parent.attributes.conditions = conditions;
    parent.resize(LilyContactFlow.Sizes.MODULE_WIDTH, LilyContactFlow.getModuleHeight(data.branches.length, true));
    return nodes;
};

// Play audio and get DTMF/LEX
// TODO: remove once backfilled
LilyContactFlow.ModuleDecompilerByType.InvokeLexBot = function(data) {
    return LilyContactFlow.ModuleDecompilerByType.PlayAudioAndFetchInput(data);
};

LilyContactFlow.ModuleDecompilerByType.PlayAudioAndFetchInput = function(data) {
    return LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.getUserInputParams.getType()](data);
};

LilyContactFlow.getUserInputParams = {
    lexDefaultAlias: "$LATEST",
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(3, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-get-customer-input-label'); },
    getBranchLabel: function(node, isDtmf) {
        if (node.condition === "Timeout"){ return node.condition; }
        var self = LilyContactFlow.graph.getCell(this.id);
        //when initializing, self is still undefined
        var staticConditions = _.union(LilyContactFlow.getUserInputParams.baseConditions, [LilyContactFlow.getUserInputParams.dtmfOnlyCondition]);
        if (self && _.pluck(staticConditions, "condition").includes(node)){ return _.findWhere(staticConditions, {condition: node}).display; }
        var value = node.value ? node.value : node.conditionValue;
        var condition = node.type ? node.type : node.condition;
        if (isDtmf || (self && self.attributes.useDtmf)) {
            return LilyContactFlow.getString('lily-admin-contact-flow-get-customer-input-branch-label-pressed') + " " + value;
        } else {
            var suffix = node.namespace ? "" : "%";
            value = node.namespace ? LilyContactFlow.getTrimmedNamespace(value, node.namespace) : value;
            if (condition === "NegativeOverride" || condition === "PositiveOverride") {
                var conditionLabel = _.findWhere(LilyContactFlow.getUserInputParams.sentimentConditions, {condition: condition}).display;
                return conditionLabel + " >= " + value + suffix;
            }
            return value;
        }
    },
    getAttributeLabel: function(cell) {
        if (cell.model.attributes.useDtmf) {
            return LilyContactFlow.getBasicAudioAttributeLabel(cell);
        } else {
            var label = cell.model.attributes.lexBotName;
            
            if(cell.model.attributes.lexBotRegion) {
                label = label + " (" +LilyContactFlow.getString("lily-admin-region-name-" + cell.model.attributes.lexBotRegion) + ")";
            }
            
            return label;
        }
    },
    useTts: false,
    tts: null,
    prompt: null,
    useDynamic: false,
    namespace: null,
    lexConditions: [],
    dtmfConditions: [],
    conditions: [],
    staticConditionIds: [],
    timeoutSec: 5,
    maxDigits: 1,
    useDtmf: true,
    lexBotName: null,
    lexBotAlias: null,
    useLexSentimentOverride: false,
    hasNegativeOverride: false,
    hasPositiveOverride: false,
    useDynamicNegativeThreshold: false,
    useDynamicPositiveThreshold: false,
    negativeThresholdNamespace: null,
    positiveThresholdNamespace: null,
    negativeThreshold: null,
    positiveThreshold: null,
    variables: [],
    ttsType: "text",
    validateDtmfConditions: function(conditionList, maxLength) {
        var allowedConditionReg = /^[0-9*#]+$/;
        for (var i = 0; i < conditionList.length; i++) {
            if (!conditionList[i].value  || (conditionList[i].value && !conditionList[i].value.match(allowedConditionReg)) || conditionList[i].value.length > maxLength) {
                return false;
            }
        }
        return true;
    },
    validateLexConditions: function(conditionList) {
        for (var i = 0; i < conditionList.length; i++) {
            if (!conditionList[i].value) {
                return false;
            }
        }
        return true;
    },
    validateSentimentOverrideConditions: function(data) {
        if (data.hasNegativeOverride) {
            if ((data.negativeThresholdDynamic && !data.negativeThresholdNamespace) || (!data.negativeThreshold && !data.negativeThresholdDynamic)) {
                return false;
            }
        }
        if (data.hasPositiveOverride) {
            if ((data.positiveThresholdDynamic && !data.positiveThresholdNamespace) || (!data.positiveThreshold && !data.positiveThresholdDynamic)) {
                return false;
            }
        }
        return true;
    },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_getUserInputModal.html",
            useTts: this.model.attributes.useTts,
            tts: this.model.attributes.tts,
            useDynamic: this.model.attributes.useDynamic,
            namespace: this.model.attributes.namespace,
            attribute: LilyContactFlow.extractDynamicAudioAttribute(this.model.attributes),
            prompt: this.model.attributes.useDynamic ? null : this.model.attributes.prompt,
            promptDynamic: this.model.attributes.useDynamic ? this.model.attributes.prompt : null,
            conditions: this.model.attributes.conditions,
            timeoutSec: this.model.attributes.timeoutSec,
            validateDtmfConditions: this.model.attributes.validateDtmfConditions,
            validateLexConditions: this.model.attributes.validateLexConditions,
            validateSentimentOverrideConditions: this.model.attributes.validateSentimentOverrideConditions,
            useDtmf: this.model.attributes.useDtmf,
            negativeThresholdNamespace: this.model.attributes.negativeThresholdNamespace || null,
            positiveThresholdNamespace: this.model.attributes.positiveThresholdNamespace || null,
            useDynamicNegativeThreshold: this.model.attributes.negativeThresholdNamespace !== null,
            useDynamicPositiveThreshold: this.model.attributes.positiveThresholdNamespace !== null,
            hasNegativeOverride: this.model.attributes.negativeThreshold !== null,
            hasPositiveOverride: this.model.attributes.positiveThreshold !== null,
            lexBotName: this.model.attributes.lexBotName,
            lexBotAlias: this.model.attributes.lexBotAlias || LilyContactFlow.getUserInputParams.lexDefaultAlias,
            lexBotRegion: this.model.attributes.lexBotRegion,
            lexBotArn: "",
            lexBotDropdownSelect: true,
            useDynamicLexBotArn: false,
            variables: this.model.attributes.variables,
            lexConditions: this.model.attributes.lexConditions,
            dtmfConditions: this.model.attributes.dtmfConditions,
            ttsType: this.model.attributes.ttsType
        };
        serializedData.useLexSentimentOverride = serializedData.hasNegativeOverride || serializedData.hasPositiveOverride;
        serializedData = _.extend(serializedData, {
            negativeThreshold: serializedData.useDynamicNegativeThreshold ? null : parseInt(this.model.attributes.negativeThreshold),
            negativeThresholdDynamic: serializedData.useDynamicNegativeThreshold ? LilyContactFlow.getTrimmedNamespace(this.model.attributes.negativeThreshold, serializedData.negativeThresholdNamespace) : null,
            positiveThreshold: serializedData.useDynamicPositiveThreshold ? null : parseInt(this.model.attributes.positiveThreshold),
            positiveThresholdDynamic: serializedData.useDynamicPositiveThreshold ? LilyContactFlow.getTrimmedNamespace(this.model.attributes.positiveThreshold, serializedData.positiveThresholdNamespace) : null
        });

        if(serializedData.lexBotRegion && serializedData.lexBotName) {
            serializedData.lexBot = {
                id: serializedData.lexBotName + "|" + serializedData.lexBotRegion,
                text: serializedData.lexBotName
            };
        } else if(serializedData.lexBotName) {
            serializedData.lexBot = serializedData.lexBotName;
        }

        serializedData.percentOptions = Array(100).fill(0).map(function (num, index) {
            return { value: index + 1, display: (index + 1) + '%' };
        });

        angular.element($("#angularContainer")).scope().showModal(angular.copy(serializedData));
        return serializedData;
    },
    getConditionData: function(branch) {
        if (branch.condition === "Timeout") {
            return branch.condition;
        }
        if (branch.type) {
            return {
                "condition": branch.type,
                "conditionType": "GreaterThanOrEqualTo",
                "namespace": branch.namespace,
                "conditionValue": branch.value.toString()
            };
        }
        return {
            "condition": "Evaluate",
            "conditionType": "Equals",
            "conditionValue": branch.value.toString()
        };
    },
    clearNegativeSentiment: function(self) {
        self.attributes.negativeThresholdNamespace = null;
        self.attributes.negativeThreshold = null;
    },
    clearPositiveSentiment: function(self) {
        self.attributes.positiveThresholdNamespace = null;
        self.attributes.positiveThreshold = null;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        var isDtmfChange = self.attributes.useDtmf !== data.useDtmf;

        LilyContactFlow.fillCommonPromptAttributes(data, self.attributes);

        var lexbot = LilyContactFlow.isFeatureEnabled("isLexV2Enabled") ?
            LilyContactFlow.getUserInputParams.deserializeLexbotV2(data.lexBot) :
            LilyContactFlow.getUserInputParams.deserializeLexbot(data.lexBot);

        self.attributes.timeoutSec = data.timeoutSec;
        self.attributes.useDtmf = data.useDtmf;
        self.attributes.lexBotName = lexbot.lexBotName;
        self.attributes.lexBotAlias = data.lexBotAlias || LilyContactFlow.getUserInputParams.lexDefaultAlias;
        self.attributes.lexBotRegion = lexbot.lexBotRegion;
        self.attributes.variables = data.variables;
        self.attributes.lexConditions = data.lexConditions;
        self.attributes.dtmfConditions = data.dtmfConditions;

        if (data.useLexSentimentOverride) {
            if (data.hasNegativeOverride) {
                if (data.useDynamicNegativeThreshold) {
                    self.attributes.negativeThresholdNamespace = data.negativeThresholdNamespace;
                    self.attributes.negativeThreshold = "$." + data.negativeThresholdNamespace + "." + data.negativeThresholdDynamic;
                } else {
                    self.attributes.negativeThresholdNamespace = null;
                    self.attributes.negativeThreshold = data.negativeThreshold;
                }
            } else {
                LilyContactFlow.getUserInputParams.clearNegativeSentiment(self);
            }

            if (data.hasPositiveOverride) {
                if (data.useDynamicPositiveThreshold) {
                    self.attributes.positiveThresholdNamespace = data.positiveThresholdNamespace;
                    self.attributes.positiveThreshold = "$." + data.positiveThresholdNamespace + "." + data.positiveThresholdDynamic;
                } else {
                    self.attributes.positiveThresholdNamespace = null;
                    self.attributes.positiveThreshold = data.positiveThreshold;
                }
            } else {
                LilyContactFlow.getUserInputParams.clearPositiveSentiment(self);
            }
        } else {
            LilyContactFlow.getUserInputParams.clearNegativeSentiment(self);
            LilyContactFlow.getUserInputParams.clearPositiveSentiment(self);
        }

        var sentimentOverrideConditions = [];

        if(self.attributes.negativeThreshold) {
            var negativeCondition = _.findWhere(self.attributes.sentimentOverrideConditions, {type: "NegativeOverride"}) || {};
            sentimentOverrideConditions.push({
                id: negativeCondition.id || null,
                value: self.attributes.negativeThreshold,
                namespace: self.attributes.negativeThresholdNamespace,
                type: "NegativeOverride"
            });
        }
        if(self.attributes.positiveThreshold) {
            var positiveCondition = _.findWhere(self.attributes.sentimentOverrideConditions, {type: "PositiveOverride"}) || {};
            sentimentOverrideConditions.push({
                id: positiveCondition.id || null,
                value: self.attributes.positiveThreshold,
                namespace: self.attributes.positiveThresholdNamespace,
                type: "PositiveOverride"
            });
        }
        self.attributes.sentimentOverrideConditions = sentimentOverrideConditions;



        var view = self.findView(LilyContactFlow.paper);

        var mergingConditions = data.useDtmf ? data.dtmfConditions.concat(self.attributes.dtmfOnlyCondition) : sentimentOverrideConditions.concat(data.lexConditions);
        if (data.useDtmf) {
            if (data.dtmfConditions && data.dtmfConditions.length > 0) {
                self.attributes.maxDigits = data.dtmfConditions.reduce(function(lhs,rhs) { return lhs.value.length > rhs.value.length ? lhs : rhs; }).value.length;
            } else {
                self.attributes.maxDigits = 1;
            }
        }
        // Switching between GetDTMF and Lex, clear the conditions' IDs
        if (isDtmfChange) {
            LilyContactFlow.clearConditionsId(data.conditions);
            // Switching from Lex to DTMF doesn't have the "condition" in the data object
            LilyContactFlow.clearConditionsId([self.attributes.dtmfOnlyCondition]);
        }

        view.mergeInConditions(self, mergingConditions);
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },

    sortConditions: function(self) {
        var view = self.findView(LilyContactFlow.paper);
        // Reorder all of the branches such that the bottom three branches are Timeout, Default, Error
        _.forEach(["Timeout", "NoMatch", "Error"], function(condition) {
            view.moveCellToBottomByCondition(self, condition);
        });
        // Reorder all of the branches such that the sentiment override branches are in the top
        _.forEach(["PositiveOverride", "NegativeOverride"], function(condition) {
            view.moveCellToTopByCondition(self, condition);
        });
    },
    getType: function() {
        return "GetUserInput";
    },
    getTarget: function() {
       var self = LilyContactFlow.graph.getCell(this.id);
       if (self.attributes.useDtmf) {
          return LilyContactFlow.GetUserInputModelTargets.DIGITS;
       } else {
          return LilyContactFlow.GetUserInputModelTargets.LEX;
       }
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var baseOptions = [];
        if (self.attributes.useTts) {
            // TODO: voice selector
            baseOptions = baseOptions.concat([{
                    name: "Text",
                    value: self.attributes.tts,
                    namespace: self.attributes.namespace || null
                }, {
                    name: "TextToSpeechType",
                    value: self.attributes.ttsType
                }]);
        } else {
            var prompt = self.attributes.prompt;
            var resourceName = null;
            if (_.isObject(prompt)) {
                resourceName = prompt.text;
                prompt = prompt.id;
            }
            baseOptions.push({
                name: "AudioPrompt",
                value: prompt,
                namespace: self.attributes.namespace || null,
                resourceName: resourceName
            });
        }

        if (!self.attributes.useDtmf) {
            baseOptions = baseOptions.concat([{
                name: "BotName",
                value: self.attributes.lexBotName
            },{
                name: "BotAlias",
                value: self.attributes.lexBotAlias
            }]);

            if(self.attributes.lexBotRegion) {
               baseOptions =  baseOptions.concat([{
                    name: "BotRegion",
                    value: self.attributes.lexBotRegion
                }]);
            }

            _.forEach(self.attributes.variables, function(param) {
                baseOptions.push({
                    name: "Parameter",
                    key: param.key,
                    value: param.value,
                    namespace: param.useDynamic ? param.namespace : null
                });
            });
        } else {
            baseOptions = baseOptions.concat([{
                name: "Timeout",
                value: self.attributes.timeoutSec.toString()
             },{
                name: "MaxDigits",
                value: self.attributes.maxDigits.toString()
            }]);
        }
        return baseOptions;
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var conditionMetadata = [];
        var metadata;
        _.forEach(self.attributes.conditions, function(condition) {
            if(condition.condition !== "Timeout" ){
                conditionMetadata.push(_.extend(condition, {
                    value: condition.value.toString()
                }));
            }
        });
        if (!self.attributes.useTts && self.attributes.prompt) {
            metadata = {
                "promptName": self.attributes.prompt.text, // TODO: remove https://cr.amazon.com/r/7815548/
                "conditionMetadata": conditionMetadata,
                "useDynamic": self.attributes.useDynamic || false
            };
        } else {
            metadata =  {
                "conditionMetadata": conditionMetadata,
                "useDynamic": self.attributes.useDynamic || false
            };
        }
        if (!self.attributes.useDtmf) {
            metadata.dynamicMetadata = {};
            _.forEach(self.attributes.variables, function(param) {
                metadata.dynamicMetadata[param.key] = param.useDynamic;
            });
        }
        return metadata;
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "getCustomerInput"
    },
    baseConditions: [ {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-default'),
            condition: "NoMatch"
        }, {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
            condition: "Error"
    }],
    dtmfOnlyCondition: {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-timeout'),
        condition: "Timeout"
    },
    sentimentConditions: [{
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-negative-override'),
            condition: "NegativeOverride"
        }, {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-positive-override'),
            condition: "PositiveOverride"
    }]
};


LilyContactFlow.getUserInputParams.deserializeLexbot = function(lexbot) {
    if(angular.isObject(lexbot)){
        var lexbotId = lexbot.id.split("|");
        var region = lexbotId[1] || null;
        return {
            lexBotName: lexbot.text,
            lexBotRegion: region
        };
    } else {
        return {
            lexBotName: lexbot
        };
    }
};

LilyContactFlow.getUserInputParams.deserializeLexbotV2 = function(lexbot) {
    return {
        lexBotName: lexbot.name,
        lexBotRegion: lexbot.region
    };
}

LilyContactFlow.getTrimmedNamespace = function(value, namespace) {
    var keyStartIndex = value.indexOf(namespace) + namespace.length + 1;
    return value.substring(keyStartIndex);
};

LilyContactFlow.createGetUserInputModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.getUserInputParams));
    var nodes = [parent];

    var nonStaticCondition = LilyContactFlow.addOutputCondition(parent, parent.attributes.dtmfOnlyCondition.display, parent.attributes.dtmfOnlyCondition.condition, 0 );
    nodes.push(nonStaticCondition);
    parent.attributes.dtmfOnlyCondition.id = nonStaticCondition.id;
    _.forEach(LilyContactFlow.getUserInputParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i+1);
        parent.attributes.staticConditionIds.push(child.id);
        nodes.push(child);
    });
    return nodes;
};

LilyContactFlow.translateSentimentBranch = function(branch) {
    var clonedBranch = _.clone(branch);
    clonedBranch.condition = "Evaluate";
    return [clonedBranch];
};

LilyContactFlow.getSentimentMetadata = function(conditionMetadata, conditionType) {
    var matchingConditionMetadata = _.find(conditionMetadata, function(condition){ return condition.type === conditionType; });
    matchingConditionMetadata.operator = _.find(angular.element($("#angularContainer")).scope().numericComparatorConditions, function (operator) {
        return operator.name === LilyContactFlow.getString('lily-admin-contact-flow-condition-greater-or-equal');
    });
    return {
        "conditionMetadata": [matchingConditionMetadata],
        "condition": conditionType
    };
};

LilyContactFlow.getIntentMetadata = function(conditionMetadata) {
    var overrideConditions = ["NegativeOverride", "PositiveOverride"];
    var metadata = _.reject(conditionMetadata, function(condition){ return overrideConditions.includes(condition.type); });
    var operator = _.find(angular.element($("#angularContainer")).scope().numericComparatorConditions, function (operator) {
        return operator.name === LilyContactFlow.getString('lily-admin-contact-flow-condition-equals');
    });
    metadata.forEach(function (branch) {
        branch.operator = operator;
    });
    return {
        "conditionMetadata": metadata,
        "condition": "Intents"
    };
};

LilyContactFlow.getSentimentParameters = function(sentiment) {
    return [{
        "name": "Namespace",
        "value": "Lex.SentimentResponse.Scores"
    }, {
        "name": "Attribute",
        "value": sentiment
    }];
};

LilyContactFlow.getIntentParameters = function() {
    return [{
        "name": "Attribute",
        "value": "Lex.IntentName"
    }, {
        "name": "Namespace",
        "value": "System"
    }];
};

LilyContactFlow.ModuleFragmenterByType[LilyContactFlow.getUserInputParams.getType()] = function(module) {
    var conditions = _.pluck(module.branches, "condition");
    var hasNegativeOverride = conditions.includes("NegativeOverride");
    var hasPositiveOverride = conditions.includes("PositiveOverride");
    var hasIntentBranches = conditions.includes("Evaluate");
    if (!(hasNegativeOverride || hasPositiveOverride)) {
        return [module];
    }

    var noMatchBranch = _.find(module.branches, function (branch) { return branch.condition === "NoMatch"; });
    var errorBranch = _.find(module.branches, function(branch){ return branch.condition === "Error"; });

    var createSentimentFragment = function (sentiment) {
        var conditionType = sentiment + "Override";
        var sentimentFragment = LilyContactFlow.createCheckContactAttributesModuleJson();
        var sentimentBranch = _.find(module.branches, function(branch){ return branch.condition === conditionType; });
        sentimentFragment.metadata = LilyContactFlow.getSentimentMetadata(module.metadata.conditionMetadata, conditionType);
        // Set no match branch transition to next fragment
        if (sentiment === "Negative") {
            sentimentFragment.branches[0].transition = hasPositiveOverride ? positiveFragment.id : hasIntentBranches ? intentsFragment.id : noMatchBranch.transition;
        } else if (sentiment === "Positive") {
            sentimentFragment.branches[0].transition = hasIntentBranches ? intentsFragment.id : noMatchBranch.transition;
        }
        sentimentFragment.branches = _.union(sentimentFragment.branches, LilyContactFlow.translateSentimentBranch(sentimentBranch));
        sentimentFragment.parameters = LilyContactFlow.getSentimentParameters(sentiment);
        return sentimentFragment;
    };

    var createIntentFragment = function () {
        var intentFragment = LilyContactFlow.createCheckContactAttributesModuleJson();
        var intentBranches = _.filter(module.branches, function (branch) { return branch.condition === "Evaluate"; });
        intentFragment.metadata =  LilyContactFlow.getIntentMetadata(module.metadata.conditionMetadata);
        // Set no match branch transition
        intentFragment.branches[0].transition = noMatchBranch.transition;
        intentFragment.branches = _.union(intentFragment.branches, intentBranches);
        intentFragment.parameters = LilyContactFlow.getIntentParameters();
        return intentFragment;
    };

    var fragments = [];
    var intentsFragment, positiveFragment, negativeFragment;

    if (hasIntentBranches) {
        intentsFragment = createIntentFragment();
        fragments.push(intentsFragment);
    }

    if (hasPositiveOverride) {
        positiveFragment = createSentimentFragment("Positive");
        fragments.push(positiveFragment);
    }

    if (hasNegativeOverride) {
        negativeFragment = createSentimentFragment("Negative");
        fragments.push(negativeFragment);
    }

    noMatchBranch.transition = hasNegativeOverride ? negativeFragment.id : positiveFragment.id;
    module.metadata = _.extend(module.metadata, {
        "conditionMetadata" : [],
        "fragmentationType": "LexSentimentOverride",
        "fragments": {
            "PositiveOverride": hasPositiveOverride ? positiveFragment.id : null,
            "NegativeOverride": hasNegativeOverride ? negativeFragment.id : null,
            "Intents": hasIntentBranches ? intentsFragment.id : null
        }
    });
    module.branches = _.union([errorBranch], [noMatchBranch]);
    fragments.push(module);

    return fragments;
};

LilyContactFlow.ModuleDefragmenterByType[LilyContactFlow.getUserInputParams.getType()] = function(module, fragments) {

    var findBranches = function (branches, condition) {
        return _.filter(branches, function (branch) {
            return branch.condition === condition;
        });
    };

    module.branches = findBranches(module.branches, "Error");
    module.metadata.conditionMetadata = [];
    delete module.metadata.fragmentationType;
    delete module.metadata.fragments;

    // Do not change this order.
    var defragmentationOrder = ["Intents", "PositiveOverride", "NegativeOverride"];
    var lastFragment = true;

    _.forEach(defragmentationOrder, function (conditionType) {
        var fragment = _.find(fragments, function (fragment) {
            return fragment.metadata.condition === conditionType;
        });
        if (!fragment) {
            return;
        }
        var branches = findBranches(fragment.branches, "Evaluate");
        branches[0].condition = fragment.metadata.condition === "Intents" ? "Evaluate" : fragment.metadata.condition;
        module.metadata.conditionMetadata = _.union(module.metadata.conditionMetadata, fragment.metadata.conditionMetadata);
        module.branches = _.union(branches, module.branches);
        if(lastFragment) {
            var noMatchBranch = findBranches(fragment.branches, "NoMatch");
            module.branches = _.union(module.branches, noMatchBranch);
            lastFragment = false;
        }
    });

    return module;
};

LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.getUserInputParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.getUserInputParams);
    var dynamicMetadata = data.metadata.dynamicMetadata || {};
    baseParams.useDynamic = data.metadata.useDynamic;
    baseParams.useDtmf = true;
    // This line is very important because of how _.extend() works
    baseParams.variables = [];
    _.forEach(data.parameters, function(param) {
        if (param.name === "Text") {
            baseParams.tts = param.value;
            baseParams.namespace = param.namespace;
            baseParams.useTts = true;
        } else if (param.name === "AudioPrompt") {
            if (param.value) {
                if (baseParams.useDynamic) {
                    baseParams.prompt = param.value;
                } else {
                    baseParams.prompt = {
                        id: param.value,
                        text: param.resourceName ? param.resourceName : data.metadata.promptName
                    };
                }
            } else {
                baseParams.prompt = null;
            }
            baseParams.namespace = param.namespace;
            baseParams.tts = false;
        } else if (param.name === "TextToSpeechType") {
            baseParams.ttsType = param.value;
        }
        else if (param.name === "Timeout") {
            baseParams.timeoutSec = Number(param.value);
        } else if (param.name === "MaxDigits") {
            baseParams.maxDigits = Number(param.value);
        } else if (param.name === "BotName") {
            baseParams.useDtmf = false;
            baseParams.lexBotName = param.value;
        } else if (param.name === "BotAlias") {
            baseParams.lexBotAlias = param.value;
        } else if (param.name === "BotRegion") {
            baseParams.lexBotRegion = param.value;
        } else if (param.name === "Parameter") {
            baseParams.variables.push({
                key: param.key,
                value: param.value,
                namespace: param.namespace,
                useDynamic: param.key ? dynamicMetadata[param.key] || false : false
            });
        }
    });

    baseParams.lexBotRegion  = baseParams.lexBotRegion || LilyContactFlow.defaultLexRegion;

    

    baseParams.id = data.id;
    var parent = new joint.shapes.module(baseParams);
    var nodes = [parent];
    // Fill in the other conditions
    var conditions = [];
    var sentimentOverrideConditions = [];
    var staticConditions = LilyContactFlow.getUserInputParams.baseConditions.map(function(condition) {
        return condition.condition;
    });
    var sentimentConditions = _.pluck(LilyContactFlow.getUserInputParams.sentimentConditions, 'condition');
    _.forEach(data.branches, function(branch, i) {
        if (staticConditions.indexOf(branch.condition) !== -1) {
            return;
        }
        var matchingConditionMetadata = [];
        if (data.metadata.conditionMetadata) {
            matchingConditionMetadata = data.metadata.conditionMetadata.filter(function(metadata) {
                if(sentimentConditions.includes(branch.condition)) {
                    return metadata.type === branch.condition;
                }
                return metadata.value === branch.conditionValue;
            });
        }
        if (matchingConditionMetadata.length === 0) {
            return;
        }
        var conditionMetadata = matchingConditionMetadata[0];
        var condition = {};
        if (sentimentConditions.includes(branch.condition)) {
            if(!LilyContactFlow.isFeatureEnabled("isLexSentimentOverrideEnabled")) {
                return;
            }
            branch.namespace = conditionMetadata.namespace || null;
            condition = {
                "condition": branch.condition,
                "conditionType": "GreaterThanOrEqualTo",
                "namespace": branch.namespace,
                "conditionValue": branch.conditionValue
            };
            if (branch.condition === "NegativeOverride") {
                parent.attributes.negativeThreshold = branch.conditionValue;
                parent.attributes.negativeThresholdNamespace = branch.namespace;
            } else {
                parent.attributes.positiveThreshold = branch.conditionValue;
                parent.attributes.positiveThresholdNamespace = branch.namespace;
            }
        } else {
            condition = {
                "condition": "Evaluate",
                "conditionType": "Equals",
                "conditionValue": branch.conditionValue
            };
        }
        var newCell = LilyContactFlow.addOutputCondition(parent, parent.attributes.getBranchLabel(conditionMetadata, baseParams.useDtmf), condition, conditions.length + sentimentOverrideConditions.length);
        conditionMetadata.id = newCell.id;
        nodes.push(newCell);
        if (sentimentConditions.includes(branch.condition)) {
            sentimentOverrideConditions.push(conditionMetadata);
        } else {
            conditions.push(conditionMetadata);
        }
    });
    parent.attributes.sentimentOverrideConditions = sentimentOverrideConditions;

    var extraBaseCondition = -1;
    if(baseParams.useDtmf){
        var nonStaticCondition = LilyContactFlow.addOutputCondition(parent, baseParams.dtmfOnlyCondition.display, baseParams.dtmfOnlyCondition.condition, nodes.length - 1);
        nodes.push(nonStaticCondition);
        parent.attributes.dtmfOnlyCondition.id = nonStaticCondition.id;
        extraBaseCondition = 0;
    }

    _.each(parent.attributes.baseConditions, function(condition, i) {
        var staticCondition = LilyContactFlow.addOutputCondition(parent, condition.display, condition.condition, nodes.length - 1);
        parent.attributes.staticConditionIds.push(staticCondition.id);
        nodes.push(staticCondition);
    });

    if (baseParams.useDtmf) {
        parent.attributes.dtmfConditions = conditions;
    } else {
        parent.attributes.lexConditions = conditions;
    }
    parent.attributes.conditions = conditions.concat(sentimentOverrideConditions);

    parent.resize(parent.get("size").width, parent.get("size").height + LilyContactFlow.Sizes.BRANCH_SPACING * (conditions.length + sentimentOverrideConditions.length + extraBaseCondition));
    return nodes;
};

// Store customer input
//TODO: remove once backfilled
LilyContactFlow.ModuleDecompilerByType.StoreCustomerInput = function(data) {
    return LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.storeUserInputParams.getType()](data);
};

LilyContactFlow.storeUserInputParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-store-customer-input-label'); },
    getAttributeLabel: function(cell) {
        if(cell.model.attributes.customerInputType === LilyContactFlow.StoreUserInputType.PHONE_NUMBER) {
            var type = LilyContactFlow.getString('lily-admin-contact-flow-store-customer-input-attribute-label-phone-number');
            var phoneFormat;
            if(cell.model.attributes.phoneNumberFormat === LilyContactFlow.PhoneNumberFormat.LOCAL) {
                var countryPrefix = cell.model.attributes.countryCode ? cell.model.attributes.countryCodePrefix : LilyContactFlow.getString('lily-admin-contact-flow-store-customer-input-attribute-label-none-selected');
                phoneFormat = LilyContactFlow.getString('lily-admin-contact-flow-store-customer-input-attribute-label-local') + '('+ countryPrefix +')';
            } else if(cell.model.attributes.phoneNumberFormat === LilyContactFlow.PhoneNumberFormat.INTERNATIONAL){
                phoneFormat = LilyContactFlow.getString('lily-admin-contact-flow-store-customer-input-attribute-label-international');
            }
            return type + ', ' + phoneFormat;
        } else if(cell.model.attributes.customerInputType === LilyContactFlow.StoreUserInputType.CUSTOM) {
            return LilyContactFlow.getString('lily-admin-contact-flow-store-customer-input-attribute-label-custom');
        }
    },
    useTts: false,
    tts: null,
    namespace: null,
    prompt: null,
    useDynamic: false,
    customerInputType: LilyContactFlow.StoreUserInputType.CUSTOM,
    timeoutSec: 5,
    enableTerminator: false,
    terminatorDigits: null,
    disableCancel: false,
    useDynamicForTerminatorDigits: false,
    terminatorDigitsNamespace: null,
    phoneNumberFormat: LilyContactFlow.PhoneNumberFormat.LOCAL,
    countryCode: null,
    countryCodePrefix: null,
    maxDigits: 20,
    encryptEntry: false,
    encryptionKeyId: null,
    encryptionKey: null,
    useDynamicForEncryptionKeys: true,
    encryptionKeyIdNamespace: null,
    encryptionKeyNamespace: null,
    ttsType: "text",
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_storeUserInputModule.html",
            initiateMethod: "initializeCountryDropDown",
            useTts: this.model.attributes.useTts,
            tts: this.model.attributes.tts,
            ttsType: this.model.attributes.ttsType,
            namespace: this.model.attributes.namespace,
            attribute: LilyContactFlow.extractDynamicAudioAttribute(this.model.attributes),
            prompt: this.model.attributes.useDynamic ? null : this.model.attributes.prompt,
            promptDynamic: this.model.attributes.useDynamic ? this.model.attributes.prompt : null,
            useDynamic: this.model.attributes.useDynamic,
            customerInputType: this.model.attributes.customerInputType,
            timeoutSec: this.model.attributes.timeoutSec,
            enableTerminator: this.model.attributes.enableTerminator,
            terminatorDigits: this.model.attributes.terminatorDigits,
            disableCancel: this.model.attributes.disableCancel,
            useDynamicForTerminatorDigits: this.model.attributes.useDynamicForTerminatorDigits,
            terminatorDigitsNamespace: this.model.attributes.terminatorDigitsNamespace,
            phoneNumberFormat: this.model.attributes.phoneNumberFormat,
            countryCode: this.model.attributes.countryCode,
            countryCodePrefix: this.model.attributes.countryCodePrefix,
            maxDigits: this.model.attributes.maxDigits,
            encryptEntry: (this.model.attributes.encryptEntry === "true" || this.model.attributes.encryptEntry === true) ? true : false,
            encryptionKeyId: this.model.attributes.encryptionKeyId,
            encryptionKey: this.model.attributes.encryptionKey,
            useDynamicForEncryptionKeys: this.model.attributes.useDynamicForEncryptionKeys,
            encryptionKeyIdNamespace: this.model.attributes.encryptionKeyIdNamespace,
            encryptionKeyNamespace: this.model.attributes.encryptionKeyNamespace
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        var isCustomerInputTypeChanged = self.attributes.customerInputType !== data.customerInputType;

        LilyContactFlow.fillCommonPromptAttributes(data, self.attributes);

        self.attributes.customerInputType = data.customerInputType;
        self.attributes.timeoutSec = data.timeoutSec;
        self.attributes.enableTerminator = data.enableTerminator;
        if (data.enableTerminator) {
            self.attributes.terminatorDigits = data.terminatorDigits;
            self.attributes.useDynamicForTerminatorDigits = data.useDynamicForTerminatorDigits;
            self.attributes.terminatorDigitsNamespace = data.useDynamicForTerminatorDigits ? data.terminatorDigitsNamespace : null;
        }
        self.attributes.disableCancel = data.disableCancel;
        self.attributes.phoneNumberFormat = data.phoneNumberFormat;
        self.attributes.countryCode = data.countryCode;
        self.attributes.countryCodePrefix = data.countryCodePrefix;
        self.attributes.maxDigits = data.maxDigits;
        self.attributes.encryptEntry = data.encryptEntry;
        if(data.encryptEntry) {
            self.attributes.encryptionKeyId = data.encryptionKeyId;
            self.attributes.encryptionKey = data.encryptionKey;
            self.attributes.useDynamicForEncryptionKeys = data.useDynamicForEncryptionKeys;
            self.attributes.encryptionKeyIdNamespace = data.useDynamicForEncryptionKeys ? data.encryptionKeyIdNamespace : null;
            self.attributes.encryptionKeyNamespace = data.useDynamicForEncryptionKeys ? data.encryptionKeyNamespace : null;
        }

        if(isCustomerInputTypeChanged) {
            var view = self.findView(LilyContactFlow.paper);
            var moduleConditions = [];
            if (self.attributes.customerInputType === LilyContactFlow.StoreUserInputType.PHONE_NUMBER) {
               moduleConditions.push({
                    display: "Invalid number",
                    condition: "InvalidNumber"
               });
            }
            view.mergeInConditions(self, moduleConditions);
        }

        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "StoreUserInput";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var parameters = [];
        if (self.attributes.useTts) {
            // TODO: voice selector
            parameters.push({
                name: "Text",
                value: self.attributes.tts,
                namespace: self.attributes.namespace
            }, {
                name: "TextToSpeechType",
                value: self.attributes.ttsType
            });
        } else {
            var prompt = self.attributes.prompt;
            var resourceName = null;
            if (_.isObject(prompt)) {
                resourceName = prompt.text;
                prompt = prompt.id;
            }
            parameters.push({
                name: "AudioPrompt",
                value: prompt,
                namespace: self.attributes.namespace,
                resourceName: resourceName
            });
        }

        parameters.push({
            name: "CustomerInputType",
            value: self.attributes.customerInputType
        }, {
            name: "Timeout",
            value: self.attributes.timeoutSec.toString()
        });

        if(self.attributes.customerInputType === LilyContactFlow.StoreUserInputType.PHONE_NUMBER) {
            parameters.push({
                name: "PhoneNumberFormat",
                value: self.attributes.phoneNumberFormat
            });
            if(self.attributes.phoneNumberFormat === LilyContactFlow.PhoneNumberFormat.LOCAL) {
                parameters.push({
                    name: "CountryCode",
                    value: self.attributes.countryCode
                });
            }
        } else if(self.attributes.customerInputType === LilyContactFlow.StoreUserInputType.CUSTOM) {
            parameters.push({
                name: "MaxDigits",
                value: self.attributes.maxDigits
            }, {
                name: "EncryptEntry",
                value: self.attributes.encryptEntry
            });

            //Set it only if FAC is enabled and terminator is enabled
            if (LilyContactFlow.isFeatureEnabled("isStoreCustomerInputTerminatorFeatureEnabled") && self.attributes.enableTerminator) {
                parameters.push({
                    name: "TerminatorDigits",
                    value: self.attributes.terminatorDigits,
                    namespace: self.attributes.terminatorDigitsNamespace
                });
            }

            //Set it only if FAC is enabled
            if (LilyContactFlow.isFeatureEnabled("isStoreCustomerInputTerminatorFeatureEnabled")) {
                parameters.push({
                    name: "DisableCancel",
                    value: self.attributes.disableCancel
                });
            }

            //Set them only if encryption is enabled
            if(self.attributes.encryptEntry === "true" || self.attributes.encryptEntry === true) {
                parameters.push({
                    name: "EncryptionKeyId",
                    value: self.attributes.encryptionKeyId,
                    namespace: self.attributes.encryptionKeyIdNamespace
                }, {
                    name: "EncryptionKey",
                    value: self.attributes.encryptionKey,
                    namespace: self.attributes.encryptionKeyNamespace
                });
            }
        }
        return parameters;
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var metadata = {
            "useDynamic": self.attributes.useDynamic,
            "useDynamicForEncryptionKeys": self.attributes.useDynamicForEncryptionKeys,
            "useDynamicForTerminatorDigits": self.attributes.useDynamicForTerminatorDigits
        };
        if (!self.attributes.useTts && self.attributes.prompt) {
            _.extend(metadata, {
                "promptName": self.attributes.prompt.text
            });
        }
        if (self.attributes.countryCodePrefix) {
            _.extend(metadata, {
                "countryCodePrefix": self.attributes.countryCodePrefix
            });
        }
        return metadata;
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "storeCustomerInput"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
        condition: "Success"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
    }],
    sortConditions: function(self) {
        var view = self.findView(LilyContactFlow.paper);
        // Reorder error branch such that the bottom one is Error branch
        view.moveCellToBottomByCondition(self, "Error");
    },
    getBranchLabel: function(node) {
        return node.display;
    },
    getConditionData: function(branch) {
        return {
            condition: branch.condition
        };
    },
    staticConditionIds: []
};
LilyContactFlow.createStoreUserInputModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.storeUserInputParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.storeUserInputParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        parent.attributes.staticConditionIds = _.union(parent.attributes.staticConditionIds, [child.id]);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.storeUserInputParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.storeUserInputParams);
    baseParams.useDynamic = data.metadata.useDynamic;
    baseParams.useDynamicForEncryptionKeys = data.metadata.useDynamicForEncryptionKeys || false;
    baseParams.useDynamicForTerminatorDigits = data.metadata.useDynamicForTerminatorDigits;
    baseParams.countryCodePrefix = data.metadata.countryCodePrefix;
    _.forEach(data.parameters, function(param) {
        switch(param.name) {
            case "Text":
                baseParams.tts = param.value;
                baseParams.namespace = param.namespace;
                baseParams.useTts = true;
                break;
            case "AudioPrompt":
                if (param.value) {
                    if (baseParams.useDynamic) {
                        baseParams.prompt = param.value;
                    } else {
                        baseParams.prompt = {
                            id: param.value,
                            text: param.resourceName ? param.resourceName : data.metadata.promptName
                        };
                    }
                } else {
                    baseParams.prompt = null;
                }
                baseParams.namespace = param.namespace;
                baseParams.tts = false;
                break;
            case "TextToSpeechType":
                baseParams.ttsType = param.value;
                break;
            case "CustomerInputType":
                baseParams.customerInputType = param.value;
                break;
            case "Timeout":
                baseParams.timeoutSec = Number(param.value);
                break;
            case "PhoneNumberFormat":
                baseParams.phoneNumberFormat = param.value;
                break;
            case "CountryCode":
                baseParams.countryCode = param.value;
                break;
            case "MaxDigits":
                baseParams.maxDigits = Number(param.value);
                break;
            case "EncryptEntry":
                if (typeof param.value === "string") {
                    if (param.value.toLowerCase() === "true") {
                        baseParams.encryptEntry = true;
                    } else if (param.value.toLowerCase() === "false") {
                        baseParams.encryptEntry = false;
                    } else {
                        baseParams.encryptEntry = param.value;
                    }
                } else {
                    baseParams.encryptEntry = param.value;
                }
                break;
            case "EncryptionKeyId":
                baseParams.encryptionKeyId = param.value;
                baseParams.encryptionKeyIdNamespace = param.namespace;
                break;
            case "EncryptionKey":
                baseParams.encryptionKey = param.value;
                baseParams.encryptionKeyNamespace = param.namespace;
                break;
            case "TerminatorDigits":
                baseParams.enableTerminator = true;
                baseParams.terminatorDigits = param.value;
                baseParams.terminatorDigitsNamespace = param.namespace;
                break;
            case "DisableCancel":
                if (typeof param.value === "string") {
                    if (param.value.toLowerCase() === "true") {
                        baseParams.disableCancel = true;
                    } else if (param.value.toLowerCase() === "false") {
                        baseParams.disableCancel = false;
                    } else {
                        baseParams.disableCancel = param.value;
                    }
                } else {
                    baseParams.disableCancel = param.value;
                }
                break;
            default:
                break;
        }
    });
    baseParams.id = data.id;
    var parent = new joint.shapes.module(baseParams);
    var nodes = [parent];
    var conditions = 0;
    var success = LilyContactFlow.addOutputCondition(parent, LilyContactFlow.getString('lily-admin-contact-flow-condition-success'), "Success", conditions);
    conditions++;
    nodes.push(success);
    if(baseParams.customerInputType === LilyContactFlow.StoreUserInputType.PHONE_NUMBER) {
        var invalidNumber = LilyContactFlow.addOutputCondition(parent, LilyContactFlow.getString('lily-admin-contact-flow-condition-invalid-number'), "InvalidNumber", conditions);
        conditions++;
        nodes.push(invalidNumber);
        parent.attributes.staticConditionIds = _.union([invalidNumber.id]);
    }
    var error = LilyContactFlow.addOutputCondition(parent, LilyContactFlow.getString('lily-admin-contact-flow-condition-error'), "Error", conditions);
    nodes.push(error);
    parent.attributes.staticConditionIds = _.union([success.id], [error.id]);
    parent.resize(parent.get("size").width, parent.get("size").height + LilyContactFlow.Sizes.BRANCH_SPACING * (conditions - 1));
    return nodes;
};

// Invoke external
// TODO: remove once flows are backfilled
LilyContactFlow.ModuleDecompilerByType.InvokeExternal = function(data) {
    return LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.invokeExternalResourceParams.getType()](data);
};

LilyContactFlow.invokeExternalResourceParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-invoke-lambda-label'); },
    getAttributeLabel: function(cell) { 
        return LilyContactFlow.getString('lily-admin-contact-flow-invoke-lambda-attribute-label-invoke') + ": " + (
            cell.model.attributes.useDynamic ? LilyContactFlow.getString('lily-admin-contact-flow-play-audio-attribute-label-dynamic')+ "(" + cell.model.attributes.attribute + ")" : cell.model.attributes.name || cell.model.attributes.arn
        );
    },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            arn: this.model.attributes.arn,
            name: this.model.attributes.name,
            lambdaFunction: {
                id: this.model.attributes.arn,
                text: this.model.attributes.name || this.model.attributes.arn
            },
            namespace: this.model.attributes.namespace,
            attribute: this.model.attributes.useDynamic ? this.model.attributes.attribute : null,
            useDynamic: !!this.model.attributes.useDynamic,
            timeoutSec: this.model.attributes.timeoutSec,
            variables: this.model.attributes.variables,
            templateUrl: "_invokeExternalModal.html"
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    arn: null,
    variables: [],
    timeoutSec: 3,
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);

        self.attributes.arn = data.lambdaFunction.id;
        self.attributes.name = data.lambdaFunction.text;
        self.attributes.namespace = data.namespace;
        self.attributes.attribute = data.attribute;
        self.attributes.useDynamic = data.useDynamic;
        self.attributes.variables = data.variables;
        self.attributes.timeoutSec = data.timeoutSec;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "InvokeExternalResource";
    },
    getTarget: function() {
        return "Lambda";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var baseParameters = [{
            name: "FunctionArn",
            value: self.attributes.useDynamic ? self.attributes.attribute : self.attributes.arn || null,
            namespace: self.attributes.useDynamic ? self.attributes.namespace : null
        }, {
            name: "TimeLimit",
            value: self.attributes.timeoutSec.toString()
        }];
        _.forEach(self.attributes.variables, function(param) {
            baseParameters.push({
                name: "Parameter",
                key: param.key,
                value: param.value,
                namespace: param.useDynamic ? param.namespace : null
            });
        });
        return baseParameters;
    },
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var metadata = {dynamicMetadata: {}};
        _.forEach(self.attributes.variables, function(param) {
            metadata.dynamicMetadata[param.key] = param.useDynamic;
        });
        metadata.useDynamic = self.attributes.useDynamic || false;
        return metadata;
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "invokeExternalFunction"
    },
    baseConditions: [{
        display: "Success",
        condition: "Success"
    }, {
        display: "Error",
        condition: "Error"
    }]
};
LilyContactFlow.createInvokeExternalModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.invokeExternalResourceParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.invokeExternalResourceParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
 };
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.invokeExternalResourceParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.invokeExternalResourceParams);
    baseParams.id = data.id;
    // _.extend is bringing this empty list over by reference, which causes
    // problems when we start putting entries in it
    baseParams.variables = [];
    var dynamicMetadata = data.metadata.dynamicMetadata || {};
    _.forEach(data.parameters, function(param) {
        switch(param.name) {
            case "FunctionArn":
                baseParams.arn = param.value;
                baseParams.attribute = param.value;
                baseParams.namespace = param.namespace;
                baseParams.useDynamic = data.metadata.useDynamic;
                break;
            case "TimeLimit":
                baseParams.timeoutSec = Number(param.value);
                break;
            case "Parameter":
                baseParams.variables.push({
                    key: param.key,
                    value: param.value,
                    namespace: param.namespace,
                    useDynamic: param.key ? dynamicMetadata[param.key] || false : false
                });
                break;
            default:
                break;
        }
    });
    var parent = new joint.shapes.module(baseParams);
    var nodes = [parent];
    _.forEach(LilyContactFlow.invokeExternalResourceParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};

/**
 * Defines blocks to support flow-modules
 */

// Invoke Module 
LilyContactFlow.invokeModuleParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-invoke-module-label'); },
    flowModule: null,
    getAttributeLabel: function(cell) {
        return LilyContactFlow.getString('lily-admin-contact-flow-invoke-module-attribute-label') + ": " + (
            cell.model.attributes.flowModule? (cell.model.attributes.flowModule.text || cell.model.attributes.flowModule.arn):null
        );
    },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_invokeModuleModal.html",
            flowModule: {
                id: this.model.attributes.flowModule? this.model.attributes.flowModule.id : null,
                text: this.model.attributes.flowModule? this.model.attributes.flowModule.text : null
            }
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.flowModule = data.flowModule ? data.flowModule : null;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "InvokeModule";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);            
        return [{
            name: "FlowModuleId",
            value: self.attributes.flowModule ? self.attributes.flowModule.id : null,
            resourceName: self.attributes.flowModule ? self.attributes.flowModule.text : null
        }];
    },
    getMetadata: function() {
        var metadata = {};
        return metadata;
    },
    //TODO: change to invoke module icon and the color
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.TT_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.TT_MODULE_HEADER_FONT_COLOR,
        iconClass: "transferToFlow"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-default'),
        condition: "Default"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
}]
};

LilyContactFlow.createInvokeModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.invokeModuleParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.invokeModuleParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
 };

LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.invokeModuleParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.invokeModuleParams);
    _.forEach(data.parameters, function(param){
        if (param.name === "FlowModuleId") {
            baseParams.flowModule = {
                id: param.value,
                text: param.resourceName
            };

        }
    });
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};


// Return Block
LilyContactFlow.returnParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(0, true) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-flow-module-return-label'); },
    getAttributeLabel: function(cell) { return LilyContactFlow.getString('lily-admin-flow-module-return-description'); },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_returnModal.html"
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    fromAngular: function(data) { },
    getType: function() {
        return "Return";
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.TT_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.TT_MODULE_HEADER_FONT_COLOR,
        iconClass: "disconnectHangUp" //TODO: update iconClass
    },
    baseConditions: []
};
LilyContactFlow.createReturnModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.returnParams));
    var nodes = [parent];
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.returnParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.returnParams);
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};
/**
 *  Sigma - 'Set security behavior' Block
 *  Created by guanloq on 09/16/2020
 */

// parameters and base function for Sigma - 'Set security behaviour' block
LilyContactFlow.setSecurityBehaviorParams = {

    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(2, true) },

    // get name of cell
    getLabel: function(cell) {
        return LilyContactFlow.getString('lily-admin-contact-flow-module-set-security-behavior-name');
    },

    // get attribute label of cell
    getAttributeLabel: function(cell) {
        var label = "";
        var attributes =  cell.model.attributes;
        if(attributes.enableFlag){
            label = LilyContactFlow.getString('lily-admin-contact-flow-module-set-security-behavior-attribute-label-recording-on');
            if(attributes.useDynamic){
                label = label + attributes.attributeValue;
            }
            else{
                label = label + attributes.percentage.toString();
            }
        }
        else{
            label = LilyContactFlow.getString('lily-admin-contact-flow-module-set-security-behavior-attribute-label-recording-off');
        }
        return label;
    },

    behaviorFlag: "Enable", // parameter to record the current status of On/Off input box, two valid values: 'Enable' and 'Disable'
    enableFlag: true, // parameter for On/Off input box in side sheet
    useDynamic: false, // parameter for 'Use Attribute'
    namespace: "", // parameter for 'Type' of 'Use Attribute'
    attributeValue: null, // parameter for 'Attribute' of 'Use Attribute'
    percentage: 90, // parameter for authenticated threshold

    // pass parameters to side sheet when opening side sheet
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_setSecurityBehaviorModule.html",
            behaviorFlag: this.model.attributes.behaviorFlag,
            enableFlag: this.model.attributes.behaviorFlag === 'Enable' ? true : false,
            namespace: this.model.attributes.namespace,
            useDynamic: this.model.attributes.useDynamic,
            attributeValue: this.model.attributes.attributeValue,
            percentage: this.model.attributes.percentage,
            thresholdScores: Array(100).fill(0).map(function (num, index) {
                return { value: index + 1, display: (index + 1) + '%' };
            })
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData, {
            // function that disables or enables the save button
            isSetSecurityBehaviorSaveDisabled: function(enableFlag, useDynamic, percentage, namespace, attributeValue) {
                if(enableFlag){
                    if(!useDynamic){
                        if (typeof(percentage) !== "undefined" && percentage !== null && percentage !== "") {
                            return false;
                        }
                        return true;
                    }
                    else{
                        if (typeof(namespace) !== "undefined" && namespace !== null && namespace !== "" && typeof(attributeValue) !== "undefined" && attributeValue !== null && attributeValue !== "") {
                            return false;
                        }
                        return true;
                    }
                }
                return false;
            }
        });
        return serializedData;
    },

    // save parameters from side sheet when saving side sheet
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.percentage = data.percentage;
        self.attributes.useDynamic = data.useDynamic;
        self.attributes.namespace = data.namespace;
        self.attributes.attributeValue = data.attributeValue;
        self.attributes.behaviorFlag = data.enableFlag ? 'Enable' : 'Disable';
        self.attributes.enableFlag = data.enableFlag;
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },

    // get the type of cell
    getType: function() {
        return "SetSecurityBehavior";
    },

    // get parameters when serializing or deserializing the JSON file, there are two params for this block
    // @param1 is SecurityBehaviorOption, which indicates the status of sigma authentication (Enable or Disable)
    // @param2 is VoiceAuthentication, which records the threshold score
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var attributes = [];
        if (self.attributes.behaviorFlag === "Enable") {
            attributes.push({
                name: "SecurityBehaviorOption",
                value: self.attributes.behaviorFlag
            });
        }
        else if (self.attributes.behaviorFlag === "Disable") {
            attributes.push({
                name: "SecurityBehaviorOption",
                value: self.attributes.behaviorFlag
            });
        }
        if (!self.attributes.useDynamic) {
            var percentValue = self.attributes.percentage;
            attributes.push({
                name: "VoiceAuthentication",
                value: percentValue.toString()
            });
        }
        if (self.attributes.useDynamic) {
            attributes.push({
                name: "VoiceAuthentication",
                namespace: self.attributes.namespace,
                value: self.attributes.attributeValue
            });
        }
        return attributes;
    },

    // get metadata of cell
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return {
            "useDynamic": self.attributes.useDynamic
        };
    },

    // style of cell and icon
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setSecurityBehavior"
    },

    // base conditions of branches (Only Success and Error branches)
    baseConditions: [
        {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
        condition: "Success"
        },
        {
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
        condition: "Error"
        }
    ]
};

// create a new cell for Sigma - 'Set security behavior' block(drag the block to the paper)
LilyContactFlow.createSetSecurityBehaviorModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.setSecurityBehaviorParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.setSecurityBehaviorParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};

// pass the parameters to cell when deserializing JSON (open saved contact flow)
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.setSecurityBehaviorParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.setSecurityBehaviorParams);
    baseParams.id = data.id;
    baseParams.useDynamic = data.metadata.useDynamic || false;
    _.forEach(data.parameters, function(param){
        if (param.name === "SecurityBehaviorOption") {
            baseParams.behaviorFlag = param.value;
            baseParams.enableFlag = param.value === 'Enable' ? true : false;
        }
        if (param.name === "VoiceAuthentication") {
            if (baseParams.useDynamic) {
                baseParams.namespace = param.namespace;
                baseParams.attributeValue = param.value;
            }
            else{
                baseParams.percentage = parseInt(param.value);
            }
        }
    });
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

/*
 * Sigma - 'Check Security Status' Block
 */
LilyContactFlow.invokeCheckSecurityStatusParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(6, false) },
    getLabel: function(cell) { return LilyContactFlow.getString('lily-admin-contact-flow-module-check-security-status-name'); },
    getAttributeLabel: function(cell) {
        return "";
    },
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_invokeCheckSecurityStatusModal.html"
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },
    getType: function() {
        return "CheckSecurityStatus";
    },

    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "checkSecurityStatus"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-module-check-security-status-condition-authenticated'),
        condition: "Authenticated"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-module-check-security-status-condition-not-authenticated'),
        condition: "NotAuthenticated"
    }, {
        display: LilyContactFlow.getString('lily-admin-contact-flow-module-check-security-status-condition-inconclusive'),
        condition: "Inconclusive"
    },{
        display: LilyContactFlow.getString('lily-admin-contact-flow-module-check-security-status-condition-not-enrolled'),
        condition: "NotEnrolled"
    },{
        display: LilyContactFlow.getString('lily-admin-contact-flow-module-check-security-status-condition-opted-out'),
        condition: "OptedOut"
    },{
        display: "Error",
        condition: "Error"
    }]
};

LilyContactFlow.createInvokeCheckSecurityStatusParams = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.invokeCheckSecurityStatusParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.invokeCheckSecurityStatusParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.invokeCheckSecurityStatusParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.invokeCheckSecurityStatusParams);
    baseParams.id = data.id;

    var parent = new joint.shapes.module(baseParams);
    var nodes = [parent];
    _.forEach(LilyContactFlow.invokeCheckSecurityStatusParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
/*
 * AMD - 'Check Call Progress' Block
 * internal name of this block is 'Check Outbound Call Status'
 */

// parameters and base function
LilyContactFlow.checkOutboundCallStatusParams = {

    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(5, false) },

    // get name of cell
    getLabel: function(cell) {
        return LilyContactFlow.getString('lily-admin-contact-flow-module-check-outbound-call-status-name');
    },

    // get attribute label of cell, no label for now
    getAttributeLabel: function(cell) {
        var label = "";
        return label;
    },

    // pass parameters to side sheet when opening side sheet
    toAngular: function() {
        var serializedData = {
            id: this.model.id,
            templateUrl: "_checkOutboundCallStatusModule.html"
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData);
        return serializedData;
    },

    // save parameters from side sheet when saving side sheet
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },

    // get the type of cell
    getType: function() {
        return "CheckOutboundCallStatus";
    },

    // get parameters when serializing or deserializing the JSON file
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var parameters = [];
        return parameters;
    },

    // get metadata of cell
    getMetadata: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        return {};
    },

    // style of cell and icon
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "checkOutboundCallStatus"
    },

    // base conditions of branches
    baseConditions: [
        {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-call-answered'),
            condition: "CallAnswered"
        },
        {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-voicemail-beep'),
            condition: "VoicemailBeep"
        },
        {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-voicemail-no-beep'),
            condition: "VoicemailNoBeep"
        },
        {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-not-detected'),
            condition: "NotDetected"
        },
        {
            display: LilyContactFlow.getString('lily-admin-contact-flow-condition-error'),
            condition: "Error"
        }
    ]
};

// create a new cell
LilyContactFlow.createCheckOutboundCallStatusModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.checkOutboundCallStatusParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.checkOutboundCallStatusParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};

// pass the parameters to cell when deserializing JSON (open saved contact flow)
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.checkOutboundCallStatusParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.checkOutboundCallStatusParams);
    baseParams.id = data.id;
    return LilyContactFlow.deserializeWithConditions(baseParams);
};

/**
 * The logic here is a bit complex so here's a summary:
 * There is a second jointJS paper on the left ~350px of the screen. Underneath
 * that paper, there's an HTML div, maintained by angularjs. When the cursor
 * clicks on (mousedown) an angularJS markup element, a duplicate, draggable, node is made
 * in the paper. When that node is dragged far enough to the right to overlap
 * with the main paper, it's destroyed and a new module is created on the right paper
 */

LilyContactFlow.initializeLeftPaper = function() {
    LilyContactFlow.newInstructionDragging = false;
    LilyContactFlow.newLeftInstruction = null;
    LilyContactFlow.newInstruction = null;
    LilyContactFlow.leftGraph = new joint.dia.Graph();
    LilyContactFlow.leftPaper = new joint.dia.Paper({
        el: $('#leftPaper'),
        width: "600px",
        height: "100%",
        gridSize: 1,
        clickThreshold: 1, // Allow one pixel of mouse movement before suppressing click event
        model: LilyContactFlow.leftGraph
    });
    // When the cursor is lifted, regardless of where, we should destroy all the nodes in the left paper
    $(document).on("mouseup", function(evt) {
        LilyContactFlow.deleteSideInstructions();
        LilyContactFlow.newInstructionDragging = false;
        LilyContactFlow.newInstruction = null;
    });
    $(document).on("mousemove", function(evt) {
        if (!LilyContactFlow.newInstructionDragging) {
            return;
        }
        // If instruction hasn't been dragged to the right yet, keep dragging the left instruction
        if (LilyContactFlow.newLeftInstruction) {
            LilyContactFlow.moveInstructionToCursor($("#leftPaper>svg")[0].getBoundingClientRect(),
                LilyContactFlow.leftPaper,
                {x: evt.clientX, y: evt.clientY},
                LilyContactFlow.newInstruction,
                -10,
                -10
            );
            LilyContactFlow.checkForNewInstructionMigration(evt);
        } else {
            // If we're in "new instruction drag" mode, move the instruction along with the cursor
            LilyContactFlow.moveInstructionToCursor($("#paper>svg")[0].getBoundingClientRect(),
                LilyContactFlow.paper,
                {x: evt.clientX, y: evt.clientY},
                LilyContactFlow.newInstruction,
                -10,
                -10
            );
        }
    });
    LilyContactFlow.moveInstructionToCursor = function(svgPosition, paper, cursorPosition, instruction, offsetX, offsetY) {
        var xClipped = Math.min(Math.max(cursorPosition.x + offsetX, svgPosition.left), svgPosition.right);
        var yClipped = Math.min(Math.max(cursorPosition.y + offsetY, svgPosition.top), svgPosition.bottom);
        var svgCursorPos = LilyContactFlow.jointVectorizer(paper.viewport).toLocalPoint(xClipped, yClipped);
        instruction.set("position", {x: svgCursorPos.x, y: svgCursorPos.y});
        _.forEach(instruction.getEmbeddedCells(), function(child) {
            LilyContactFlow.updateChildPositions(child);
        });
    };
    LilyContactFlow.deleteSideInstructions = function(includeDragging) {
        includeDragging = (typeof includeDragging !== 'undefined') ?  includeDragging : true;
        _.each(LilyContactFlow.leftGraph.getCells(), function(cell) {
            if (!includeDragging && cell.changedAttributes().position) {
                return;
            }
            cell.remove();
        });
    };

    // Watch for dragging elements into the main canvas
    LilyContactFlow.checkForNewInstructionMigration = function(evt) {
        var cursorPos = LilyContactFlow.jointVectorizer(LilyContactFlow.leftPaper.viewport).toLocalPoint(evt.clientX, evt.clientY);
        if (cursorPos.x < 360) {
            return;
        }
        _.forEach(LilyContactFlow.leftGraph.getCells(), function(cell) {
            if (cell.changedAttributes().position) {
                // Cell is being dragged in
                var newCells = LilyContactFlow[cell.attributes.createFunction](cursorPos.x - 10, cursorPos.y - 10);
                LilyContactFlow.newInstruction = newCells[0];
                LilyContactFlow.newLeftInstruction = false;
                LilyContactFlow.graph.addCells(newCells);
                LilyContactFlow.deleteSideInstructions();
            }
        });
    };
};



joint.shapes.leftModule = joint.shapes.devs.Model.extend({
    defaults: joint.util.deepSupplement({
        type: 'leftModule',
        attrs: {
            'rect': { 'stroke-opacity': '0', 'fill-opacity': 1}
        }
    }, joint.shapes.devs.Model.prototype.defaults)
});
joint.shapes.leftModuleView = joint.shapes.devs.ModelView.extend({
    getTemplate: function() {
        return this.model.attributes.parentMarkup.outerHTML;
    },
    initialize: function() {
        this.$box = $(_.template(this.getTemplate())());
        // Update the box position whenever the underlying model changes.
        this.model.on('change', this.updateBox, this);
        // Remove the box when the model gets removed from the graph.
        this.model.on('remove', this.removeBox, this);
        this.updateBox();
        joint.dia.ElementView.prototype.initialize.apply(this, arguments);
    },
    render: function() {
        joint.dia.ElementView.prototype.render.apply(this, arguments);
        this.paper.$el.prepend(this.$box);
        this.updateBox();
        return this;
    },
    updateBox: function() {
        // Set the position and dimension of the box so that it covers the JointJS element.
        var bbox = this.model.getBBox(); 
        this.$el.css("pointer-events", "all");
        this.$box.css({
            width: bbox.width,
            height: bbox.height,
            left: bbox.x,
            top: bbox.y,
            position: "absolute",
            "z-index": 2,
            transform: 'rotate(' + (this.model.get('angle') || 0) + 'deg)'
        });
    },
    removeBox: function(evt) {
        this.$box.remove();
    }
});

LilyContactFlow.blockTypes = {
    playPrompt: "play-prompt",
    getCustomerInput: "get-customer-input",
    storeCustomerInput: "store-customer-input",
    loopPrompts: "loop-prompts",
    holdAgent: "hold-agent",
    dial: "dial",
    startMediaStreaming: "start-media-streaming",
    stopMediaStreaming: "stop-media-streaming",
    setQueue: "set-queue",
    setAttributes: "set-attributes",
    changeRoutingPriority: "change-routing-priority",
    setRoutingProficiency: "set-routing-proficiency",
    setLoggingBehavior: "set-logging-behavior",
    setRecordingBehavior: "set-recording-behavior",
    setHoldFlow: "set-hold-flow",
    setCustomerQueueFlow: "set-customer-queue-flow",
    setWhisperFlow: "set-whisper-flow",
    setDisconnectFlow: "set-disconnect-flow",
    setCallbackNumber: "set-callback-number",
    setVoice: "set-voice",
    setSecurityBehavior: "set-security-behavior",
    getQueueMetrics: "get-queue-metrics",
    checkQueueStatus: "check-queue-status",
    checkStaffing: "check-staffing",
    checkHours: "check-hours",
    checkAttributes: "check-attributes",
    checkOutboundCallStatus: "check-outbound-call-status",
    checkSecurityStatus: "check-security-status",
    distributeByPercentage: "distribute-by-percentage",
    loop: "loop",
    wait: "wait",
    invokeLambda: "invoke-lambda",
    invokeModule: "invoke-module",
    disconnect: "disconnect",
    resume: "resume",
    transferToQueue: "transfer-to-queue",
    transferToPhoneNumber: "transfer-to-phone-number",
    transferToAgent: "transfer-to-agent",
    transferToFlow: "transfer-to-flow",
    return: "return"
};
LilyContactFlow.contactFlowTypes = {
    AGENT_HOLD: "agentHold",
    AGENT_WHISPER: "agentWhisper",
    CONTACT_FLOW: "contactFlow",
    CUSTOMER_HOLD: "customerHold",
    CUSTOMER_QUEUE: "customerQueue",
    CUSTOMER_WHISPER: "customerWhisper",
    OUTBOUND_WHISPER: "outboundWhisper",
    AGENT_TRANSFER: "agentTransfer",
    QUEUE_TRANSFER: "queueTransfer"
};

LilyContactFlow.flowModuleTypes = {
    CONTACT_FLOW: "contactFlow"
};

LilyContactFlow.entityTypes = {
    FLOW: "contactFlow",
    MODULE: "flowModule"
};

LilyContactFlow.blockGroupTypes = {
    interact: "Interact",
    set: "Set",
    branch: "Branch",
    integrate: "Integrate",
    terminate: "Terminate",
    diagnose: "Diagnose"
};

LilyContactFlow.blockId = {
    LOGGING: "contactFlowLogging"
};

LilyContactFlow.blockGroups = [];

LilyContactFlow.initializeBlockDefinition = function(){

    LilyContactFlow.blockGroups = [
        {
            name: LilyContactFlow.getString('lily-admin-contact-flow-module-group-interact'),
            type: LilyContactFlow.blockGroupTypes.interact,
            modules: [
                {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-play-prompt-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-play-prompt-description-including-chat'),
                    type: LilyContactFlow.blockTypes.playPrompt,
                    createFunction: "createPlayAudioModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.CUSTOMER_WHISPER,
                                LilyContactFlow.contactFlowTypes.AGENT_WHISPER, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER,
                                LilyContactFlow.contactFlowTypes.AGENT_TRANSFER, LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE,
                                LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-get-customer-input-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-get-customer-input-description'),
                    type: LilyContactFlow.blockTypes.getCustomerInput,
                    createFunction: "createGetUserInputModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER,
                                LilyContactFlow.contactFlowTypes.AGENT_TRANSFER, LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                },
                {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-store-customer-input-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-store-customer-input-description'),
                    type: LilyContactFlow.blockTypes.storeCustomerInput,
                    createFunction: "createStoreUserInputModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER,
                                LilyContactFlow.contactFlowTypes.AGENT_TRANSFER, LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                },
                {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-loop-prompts-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-loop-prompts-description'),
                    type: LilyContactFlow.blockTypes.loopPrompts,
                    createFunction: "createLoopAudioModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CUSTOMER_HOLD, LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE, LilyContactFlow.contactFlowTypes.AGENT_HOLD],
                    moduleTypes: []
                },
                {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-hold-agent-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-hold-agent-description'),
                    type: LilyContactFlow.blockTypes.holdAgent,
                    createFunction: "createUpdateAgentStateModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                },{
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-dial-block-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-dial-block-description'),
                    type: LilyContactFlow.blockTypes.dial,
                    createFunction: "createDialBlockModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER],
                    moduleTypes: []
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-start-media-streaming-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-start-media-streaming-description'),
                    type: LilyContactFlow.blockTypes.startMediaStreaming,
                    createFunction: "createStartMediaStreamingModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.CUSTOMER_WHISPER,
                        LilyContactFlow.contactFlowTypes.AGENT_WHISPER, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER,
                        LilyContactFlow.contactFlowTypes.AGENT_TRANSFER, LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE,
                        LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ],
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-stop-media-streaming-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-stop-media-streaming-description'),
                    type: LilyContactFlow.blockTypes.stopMediaStreaming,
                    createFunction: "createStopMediaStreamingModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.CUSTOMER_WHISPER,
                        LilyContactFlow.contactFlowTypes.AGENT_WHISPER, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER,
                        LilyContactFlow.contactFlowTypes.AGENT_TRANSFER, LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE,
                        LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ],
                }
            ]
        }, {
            name: LilyContactFlow.getString('lily-admin-contact-flow-module-group-set'),
            type: LilyContactFlow.blockGroupTypes.set,
            modules: [
                {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-set-queue-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-set-queue-description'),
                    type: LilyContactFlow.blockTypes.setQueue,
                    createFunction: "createSetQueueModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER,
                                LilyContactFlow.contactFlowTypes.AGENT_TRANSFER],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-set-attr-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-set-attr-description'),
                    type: LilyContactFlow.blockTypes.setAttributes,
                    createFunction: "createSetAttributesModule"
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-change-routing-age-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-change-routing-age-description'),
                    type: LilyContactFlow.blockTypes.changeRoutingPriority,
                    createFunction: "createUpdateRoutingPriorityModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                                LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-set-routing-proficiency-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-set-routing-proficiency-description'),
                    type: LilyContactFlow.blockTypes.setRoutingProficiency,
                    createFunction: "createSetRoutingProficiency",
                    featureAccess: "isSetRoutingProficiencyBlockFeatureEnabled",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-set-logging-behavior-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-set-logging-behavior-description'),
                    type: LilyContactFlow.blockTypes.setLoggingBehavior,
                    createFunction: "createSetLoggingBehaviorModule",
                    id: LilyContactFlow.blockId.LOGGING
                }, {
                    name: (LilyContactFlow.isFeatureEnabled("isContactLensGAEnabled") || LilyContactFlow.isFeatureEnabled("isContactAnalyticsFeatureEnabled")) ?
                        LilyContactFlow.getString('lily-admin-contact-flow-module-set-recording-analytics-name')
                        : LilyContactFlow.getString('lily-admin-contact-flow-module-set-recording-name'),
                    description: (LilyContactFlow.isFeatureEnabled("isContactLensGAEnabled") || LilyContactFlow.isFeatureEnabled("isContactAnalyticsFeatureEnabled")) ?
                        LilyContactFlow.getString("lily-admin-contact-flow-module-set-recording-description-with-analytics")
                        : LilyContactFlow.getString('lily-admin-contact-flow-module-set-recording-description'),
                    type: LilyContactFlow.blockTypes.setRecordingBehavior,
                    createFunction: "createSetRecordingBehaviorModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                                LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER, LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-set-hold-flow-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-set-hold-flow-description'),
                    type: LilyContactFlow.blockTypes.setHoldFlow,
                    createFunction: LilyContactFlow.isFeatureEnabled("isSetContactFlowBlockFeatureEnabled") ? "createSetHoldFlowModuleV2" : "createSetHoldFlowModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                                LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER, LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-set-cust-queue-flow-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-set-cust-queue-flow-description'),
                    type: LilyContactFlow.blockTypes.setCustomerQueueFlow,
                    createFunction: LilyContactFlow.isFeatureEnabled("isSetContactFlowBlockFeatureEnabled") ? "createSetCustomerQueueFlowModuleV2" : "createSetCustomerQueueFlowModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-set-whisper-flow-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-set-whisper-flow-description'),
                    type: LilyContactFlow.blockTypes.setWhisperFlow,
                    createFunction: LilyContactFlow.isFeatureEnabled("isSetContactFlowBlockFeatureEnabled") ? "createSetWhisperFlowModuleV2" : "createSetWhisperFlowModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                                LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-set-disconnect-flow-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-set-disconnect-flow-description'),
                    type: LilyContactFlow.blockTypes.setDisconnectFlow,
                    createFunction: "createSetDisconnectFlowModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                        LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE, LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER, LilyContactFlow.contactFlowTypes.CUSTOMER_HOLD,
                        LilyContactFlow.contactFlowTypes.AGENT_HOLD, LilyContactFlow.contactFlowTypes.CUSTOMER_WHISPER, LilyContactFlow.contactFlowTypes.AGENT_WHISPER],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-set-callback-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-set-callback-description'),
                    type: LilyContactFlow.blockTypes.setCallbackNumber,
                    createFunction: "createSetCallbackNumberModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                                LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-set-voice-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-set-voice-description'),
                    type: LilyContactFlow.blockTypes.setVoice,
                    createFunction: "createSetVoiceModule"
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-get-metric-data-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-get-metric-data-description'),
                    type: LilyContactFlow.blockTypes.getQueueMetrics,
                    createFunction: "createGetMetricDataModule"
                },
                // TODO: Remove FAC once finished
                {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-set-security-behavior-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-set-security-behavior-description'),
                    type: LilyContactFlow.blockTypes.setSecurityBehavior,
                    createFunction: "createSetSecurityBehaviorModule",
                    featureAccess: "isUseVoiceAuthenticationEnabled",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.CUSTOMER_WHISPER,
                        LilyContactFlow.contactFlowTypes.AGENT_WHISPER, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER,
                        LilyContactFlow.contactFlowTypes.AGENT_TRANSFER, LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE,
                        LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }
            ]
        }, {
            name: LilyContactFlow.getString('lily-admin-contact-flow-module-group-branch'),
            type: LilyContactFlow.blockGroupTypes.branch,
            modules: [
                {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-check-queue-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-check-queue-description'),
                    type: LilyContactFlow.blockTypes.checkQueueStatus,
                    createFunction: "createCheckQueueStatusModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                                LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-check-staffing-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-check-staffing-description'),
                    type: LilyContactFlow.blockTypes.checkStaffing,
                    createFunction: "createCheckStaffingModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                                LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-check-hours-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-check-hours-description'),
                    type: LilyContactFlow.blockTypes.checkHours,
                    createFunction: "createCheckHoursModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                                LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-check-attr-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-check-attr-description'),
                    type: LilyContactFlow.blockTypes.checkAttributes,
                    createFunction: "createCheckContactAttributesModule"
                },
                // TODO: Remove FAC once finished, the FAC name is isCheckOutboundCallStatusEnabled.
                // For the block - 'Check Call Progress', the internal name of it is 'Check Outbound Call Status'
                {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-check-outbound-call-status-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-check-outbound-call-status-description'),
                    type: LilyContactFlow.blockTypes.checkOutboundCallStatus,
                    createFunction: "createCheckOutboundCallStatusModule",
                    featureAccess: "isCheckOutboundCallStatusEnabled",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                        LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE, LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER, LilyContactFlow.contactFlowTypes.CUSTOMER_HOLD,
                        LilyContactFlow.contactFlowTypes.AGENT_HOLD, LilyContactFlow.contactFlowTypes.CUSTOMER_WHISPER, LilyContactFlow.contactFlowTypes.AGENT_WHISPER],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString("lily-admin-contact-flow-module-check-security-status-name"),
                    description: LilyContactFlow.getString("lily-admin-contact-flow-module-check-security-status-description"),
                    type: LilyContactFlow.blockTypes.checkSecurityStatus,
                    featureAccess: "isUseVoiceAuthenticationEnabled",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.CUSTOMER_WHISPER,
                        LilyContactFlow.contactFlowTypes.AGENT_WHISPER, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER,
                        LilyContactFlow.contactFlowTypes.AGENT_TRANSFER, LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE,
                        LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ],
                    createFunction: "createInvokeCheckSecurityStatusParams",
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-percent-routing-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-percent-routing-description'),
                    type: LilyContactFlow.blockTypes.distributeByPercentage,
                    createFunction: "createPercentileBasedRoutingModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                                LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE, LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-loop-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-loop-description'),
                    type: LilyContactFlow.blockTypes.loop,
                    createFunction: "createLoopModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                                LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE, LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER, LilyContactFlow.contactFlowTypes.CUSTOMER_HOLD,
                                LilyContactFlow.contactFlowTypes.AGENT_HOLD, LilyContactFlow.contactFlowTypes.CUSTOMER_WHISPER, LilyContactFlow.contactFlowTypes.AGENT_WHISPER],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-wait-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-wait-description'),
                    type: LilyContactFlow.blockTypes.wait,
                    createFunction: "createWaitModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE], // for now
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ] 
                }
            ]
        }, {
            name: LilyContactFlow.getString('lily-admin-contact-flow-module-group-integrate'),
            type: LilyContactFlow.blockGroupTypes.integrate,
            modules: [
                {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-invoke-lambda-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-invoke-lambda-description'),
                    type: LilyContactFlow.blockTypes.invokeLambda,
                    createFunction: "createInvokeExternalModule"
                },
                // TODO: move to it's actual group once finalized.
                {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-invoke-module-label'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-invoke-module-description'),
                    type: LilyContactFlow.blockTypes.invokeModule,
                    createFunction: "createInvokeModule",
                    featureAccess: "isFlowModuleEnabled",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }
            ]
        }, {
            name: LilyContactFlow.getString('lily-admin-contact-flow-module-group-terminate'),
            type: LilyContactFlow.blockGroupTypes.terminate,
            modules: [
                {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-disconnect-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-disconnect-description'),
                    type: LilyContactFlow.blockTypes.disconnect,
                    createFunction: "createDisconnectModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                                LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-resume-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-resume-description'),
                    type: LilyContactFlow.blockTypes.resume,
                    createFunction: "createResumeModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CUSTOMER_WHISPER, LilyContactFlow.contactFlowTypes.AGENT_WHISPER, LilyContactFlow.contactFlowTypes.OUTBOUND_WHISPER,
                                LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE],
                    moduleTypes: []
                }, {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-transfer-queue-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-transfer-queue-description'),
                    type: LilyContactFlow.blockTypes.transferToQueue,
                    createFunction: "createEnqueueModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                                LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                },
                {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-transfer-number-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-transfer-title-with-blind-transfer-support-description'),
                    type: LilyContactFlow.blockTypes.transferToPhoneNumber,
                    createFunction: "createTransferToPhoneNumberModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER,
                                LilyContactFlow.contactFlowTypes.CUSTOMER_QUEUE],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]
                },
                {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-transfer-agent-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-transfer-agent-description'),
                    type: LilyContactFlow.blockTypes.transferToAgent,
                    createFunction: "createTransferToAgentModule",
                    flowTypes: [LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER],
                    moduleTypes: []
                },  {
                    name: LilyContactFlow.getString('lily-admin-contact-flow-module-transfer-flow-name'),
                    description: LilyContactFlow.getString('lily-admin-contact-flow-module-transfer-flow-description'),
                    type: LilyContactFlow.blockTypes.transferToFlow,
                    createFunction: "createTransferToFlowModule",
                    // Note: if you update this list, you must update it in the corresponding LAMS call instruction!
                    flowTypes: [LilyContactFlow.contactFlowTypes.CONTACT_FLOW, LilyContactFlow.contactFlowTypes.QUEUE_TRANSFER, LilyContactFlow.contactFlowTypes.AGENT_TRANSFER],
                    moduleTypes: []
                },
                {
                    name: LilyContactFlow.getString('lily-admin-flow-module-return-label'),
                    description: LilyContactFlow.getString('lily-admin-flow-module-return-description'),
                    type: LilyContactFlow.blockTypes.return,
                    createFunction: "createReturnModule",
                    flowTypes: [],
                    moduleTypes: [
                        LilyContactFlow.flowModuleTypes.CONTACT_FLOW
                    ]

                }
            ]
        }, {
            name: LilyContactFlow.getString('lily-admin-contact-flow-module-group-diagnose'),
            type: LilyContactFlow.blockGroupTypes.diagnose,
            modules:[]
        }
    ];
};

LilyContactFlow.getSupportedBlocks = function(entityType, flowType){
    var supportedGroups = [];
    var typeProperty = entityType === LilyContactFlow.entityTypes.MODULE ? "moduleTypes" : "flowTypes";

    LilyContactFlow.blockGroups.forEach(function (blockGroup){
        var filteredBlockGroup;

        if(blockGroup.modules){
            blockGroup.modules.forEach(function (module){
                if(module[typeProperty] === undefined || _.contains(module[typeProperty], flowType)){
                    if(!filteredBlockGroup){
                        filteredBlockGroup = angular.copy(blockGroup);
                        filteredBlockGroup.modules = [];
                    }

                    filteredBlockGroup.modules.push(module);

                }

            });

            if(filteredBlockGroup){
                supportedGroups.push(filteredBlockGroup);
            }
        }
    });

    return supportedGroups;
};
(function() {
    'use strict';

    /**
     * @desc Widget used to present an attribute selector for contact flows.
     * @example <flow-attribute-selector ng-model="object" exclude-system-attributes="true"></flow-attribute-selector>
     * where the model object will have the following:
     *  { category: , // optional: Such as 'QueueMetrics'
     *    namespace: , // Such as 'System'
     *    attribute:   // Such as 'Metrics.Queue.Name'
     *  }
     * exclude-system-attributes is optional, if set then no system attributes will be present. (system, queue metrics, agent, etc..)
     */
    angular
        .module("ContactFlowsModule")
        .constant('LilyContactFlow', LilyContactFlow)
        .directive("flowAttributeSelector", flowAttributeSelector);

    function flowAttributeSelector() {
        return {
            restrict: 'E',
            replace: true,
            templateUrl: '_flow_attribute_selector.html',
            scope: {
                attribute: '=',
                namespace: '=',
                category: '=?',
                excludeSystemAttributes: '=?'
            },
            controller: flowAttributeSelectorCtrl
        };
    }

    // inject dependencies
    flowAttributeSelectorCtrl.$inject = ['$scope', 'LilyContactFlow'];
    
    function flowAttributeSelectorCtrl($scope, LilyContactFlow) {
        if ($scope.category === undefined) {
            $scope.category = null;
        }

        var CONSOLIDATED_LEX_ATTRIBUTES_FAC = "isConsolidatedLexAttributesEnabled";
        var TASK_ATTRIBUTES_FAC = "isTaskContactAttributesEnabled";
        var VOICE_AUTHENTICATION_FAC = "isUseVoiceAuthenticationEnabled";

        var isFeatureEnabled = function(obj) {
            if (obj.featureAccess && !LilyContactFlow.isFeatureEnabled(obj.featureAccess)) {
                return false;
            }
            return true;
        };

        var attributeNamespaces = [
            {value: "System"},
            {value: "Agent", namespace: "System"},
            {value: "QueueMetrics", namespace: "System"},
            {value: "User Defined"},
            {value: "External"},
            {value: "MediaStreams", namespace: "System"}
        ];
        if (LilyContactFlow.isFeatureEnabled(CONSOLIDATED_LEX_ATTRIBUTES_FAC)) {
            attributeNamespaces.push({value: "Lex", namespace: "System"});
        }else {
            attributeNamespaces.push({value: "Lex.Slots"});
            attributeNamespaces.push({value: "Lex.SessionAttributes"});
        }
        attributeNamespaces.map(function(namespace) {
            namespace.name = LilyContactFlow.translateNamespace(namespace.value);
            return namespace;
        });

        var systemAttributes = [
            {value: 'Customer Number', category: 'System'},
            {value: 'Dialed Number', category: 'System'},
            {value: 'Customer callback number', category: 'System'},
            {value: 'Stored customer input', category: 'System'},
            {value: 'Queue.Name', category: 'System'},
            {value: 'Queue.ARN', category: 'System'},
            {value: 'Queue.OutboundCallerId.Address', category: 'System'},
            {value: 'TextToSpeechVoiceId', category: 'System'},
            {value: 'ContactId', category: 'System'},
            {value: 'InitialContactId', category: 'System'},
            {value: 'PreviousContactId', category: 'System'},
            {value: 'Channel', category: 'System'},
            {value: 'InstanceARN', category: 'System'},
            {value: 'InitiationMethod', category: 'System'},
            {value: 'Agent.UserName', category: 'Agent'},
            {value: 'Agent.FirstName', category: 'Agent'},
            {value: 'Agent.LastName', category: 'Agent'},
            {value: 'Agent.ARN', category: 'Agent'},
            {value: 'Metrics.Queue.Name', category: 'QueueMetrics'},
            {value: 'Metrics.Queue.ARN', category: 'QueueMetrics'},
            {value: 'Metrics.Queue.Size', category: 'QueueMetrics'},
            {value: 'Metrics.Queue.OldestContactAge', category: 'QueueMetrics'},
            {value: 'Metrics.Agents.Online.Count', category: 'QueueMetrics'},
            {value: 'Metrics.Agents.Available.Count', category: 'QueueMetrics'},
            {value: 'Metrics.Agents.Staffed.Count', category: 'QueueMetrics'},
            {value: 'Metrics.Agents.AfterContactWork.Count', category: 'QueueMetrics'},
            {value: 'Metrics.Agents.Busy.Count', category: 'QueueMetrics'},
            {value: 'Metrics.Agents.Missed.Count', category: 'QueueMetrics'},
            {value: 'Metrics.Agents.NonProductive.Count', category: 'QueueMetrics'},
            {value: 'MediaStreams.Customer.Audio.StreamARN', category: 'MediaStreams'},
            {value: 'MediaStreams.Customer.Audio.StartTimestamp', category: 'MediaStreams'},
            {value: 'MediaStreams.Customer.Audio.StopTimestamp', category: 'MediaStreams'},
            {value: 'MediaStreams.Customer.Audio.StartFragmentNumber', category: 'MediaStreams'},
            {value: 'Name', category: 'System', featureAccess: TASK_ATTRIBUTES_FAC},
            {value: 'Description', category: 'System', featureAccess: TASK_ATTRIBUTES_FAC},
            {value: 'References', category: 'System', featureAccess: TASK_ATTRIBUTES_FAC},
            {value: 'Language', category: 'System', featureAccess: TASK_ATTRIBUTES_FAC}
        ];
        if (LilyContactFlow.isFeatureEnabled(VOICE_AUTHENTICATION_FAC)) {
            systemAttributes.push({value: 'CustomerId', category: 'System'});
        }
        if (LilyContactFlow.isFeatureEnabled(CONSOLIDATED_LEX_ATTRIBUTES_FAC)) {
            systemAttributes.push({value: 'Lex.AlternativeIntents', category: 'Lex', namespaceOverride: true});
            systemAttributes.push({value: 'Lex.IntentConfidence.Score', category: 'Lex'});
            systemAttributes.push({value: 'Lex.IntentName', category: 'Lex'});
            systemAttributes.push({value: 'Lex.SentimentResponse.Label', category: 'Lex'});
            systemAttributes.push({value: 'Lex.SentimentResponse.Scores', category: 'Lex', namespaceOverride: true});
            systemAttributes.push({value: 'Lex.SessionAttributes', category: 'Lex', namespaceOverride: true});
            systemAttributes.push({value: 'Lex.Slots', category: 'Lex', namespaceOverride: true});
        }
        else {
            systemAttributes.push({value: 'Lex.IntentName', category: 'System'});
        }
        systemAttributes.map(function(attr) {
            attr.name = LilyContactFlow.translateSystemAttribute(attr.value);
            return attr;
        });

        function isSystemNamespace(namespace) {
            return namespace === "System";
        }

        function isSystemCategory(category) {
            if (category === null) {
                return false;
            }
            return isSystemNamespace(getCategoryNamespace(category));
        }

        function findSystemAttribute(namespace, value) {
            if (isSystemNamespace(namespace)) {
                if (LilyContactFlow.isFeatureEnabled(TASK_ATTRIBUTES_FAC)) {
                    var attribute = systemAttributes.find(function (attribute) {
                        return value ? value.startsWith(attribute.value) : false;
                    });

                    if (attribute) {
                        attribute.value = value;
                        return attribute;
                    }
                    return null;
                } else {
                    return systemAttributes.find(function (attribute) {
                        return attribute.value === value;
                    });
                }
            }
            return null;
        }

        // given the namespace and potential value of a system attribute, return the category
        function getAttributeCategory(namespace, value) {
            var categoryValue = namespace;

            // need to check for namespace override in attributes to get correct category value
            var attrWithNamespaceOverride = systemAttributes.find(function (attribute) {
                return namespace === attribute.value && attribute.namespaceOverride;
            });
            if (attrWithNamespaceOverride) {
                categoryValue = attrWithNamespaceOverride.category;
            }

            if (isSystemNamespace(namespace)) {
                var attribute = findSystemAttribute(namespace, value);
                if (attribute) {
                    categoryValue = attribute.category;
                }
            }
            var category = attributeNamespaces.find(function (category) {
                return category.value === categoryValue;
            });
            return category === undefined ? null : category;
        }

        function updateAvailableAttributes() {
            var attributes = [];
            if ($scope.model.category !== null) {
                attributes = systemAttributes.filter(function (attribute) {
                    return attribute.category === $scope.model.category.value;
                });
            }
            attributes = attributes.filter(isFeatureEnabled);
            $scope.model.attributesList = attributes;
            $scope.model.attributesAvailable = attributes.length > 0;
        }

        function sanitizeAttributeValue() {
            if ($scope.model.attributesAvailable) {
                // switched from custom or system attribute to system attribute
                var currentAttributeValue = _.isObject($scope.model.attribute) ? $scope.model.attribute.value : $scope.model.attribute;
                var matchingAttribute = $scope.model.attributesList.find(function (attribute) { 
                    return attribute.value === currentAttributeValue;
                });
                $scope.model.attribute = matchingAttribute || "";
                $scope.onSystemAttributeChanged();
            } else if (_.isObject($scope.model.attribute)) {
                // switched from system attribute to custom attribute
                $scope.model.attribute = $scope.model.attribute.value || "";
                $scope.onCustomAttributeChanged();
            }
        }

        function getCategoryNamespace(category) {
            if (category.namespace !== undefined) {
                return category.namespace;
            }
            return category.value;
        }

        function getInitialAttribute() {
            // attributes with namespace override set the namespace to their value so this must be checked
            var attrWithNamespaceOverride = systemAttributes.find(function (attribute) {
                return $scope.namespace === attribute.value && attribute.namespaceOverride;
            });
            if (attrWithNamespaceOverride) {
                return attrWithNamespaceOverride;
            }

            if (isSystemNamespace($scope.namespace)) {
                return findSystemAttribute($scope.namespace, $scope.attribute);
            }
            else {
                return $scope.attribute;
            }
        }

        angular.extend($scope, {
            model: {
                attributeNamespaces: attributeNamespaces.filter(function (category) {
                    if ($scope.excludeSystemAttributes && isSystemCategory(category) && !LilyContactFlow.isFeatureEnabled("isExpandedNamespaceDropdownEnabled")) {
                        return false;
                    }
                    return true;
                })
                    .filter(isFeatureEnabled),
                systemAttributes: systemAttributes,
                category:  getAttributeCategory($scope.namespace, $scope.attribute),
                attribute: getInitialAttribute(),
                attributesList: [],
                attributesAvailable: false
            },

            isConsolidatedLexAttributesEnabled: function() {
                return LilyContactFlow.isFeatureEnabled(CONSOLIDATED_LEX_ATTRIBUTES_FAC);
            },

            onCategoryChanged: function() {
                // if changing from a system category, wipe out attributes. Otherwise preserve so users can change category
                // without losing attribute name
                if ($scope.category !== $scope.model.category.value && isSystemCategory($scope.category)) {
                    $scope.attribute = null;
                    $scope.model.attribute = null;
                }
                $scope.category = $scope.model.category.value;
                $scope.namespace = getCategoryNamespace($scope.model.category);
                updateAvailableAttributes();
                sanitizeAttributeValue();
            },

            onSystemAttributeChanged: function() {
                $scope.$broadcast('flowAttributeSelectorAttributeChanged');
                if ($scope.model.attribute.namespaceOverride) {
                    $scope.namespace = $scope.model.attribute.value;
                }
                else {
                    $scope.attribute = $scope.model.attribute.value;
                    $scope.namespace = getCategoryNamespace($scope.model.category);
                }
            },

            onCustomAttributeChanged: function() {
                $scope.attribute = $scope.model.attribute;
            },

            onLexAttributeInputChanged: function(lexAttributeInput) {
                $scope.attribute = lexAttributeInput;
            },
            
            onReferenceKeyChanged: function(referenceKey) {
                $scope.model.attribute.value = "References[\'" + referenceKey + "\'].Value";
                $scope.attribute = $scope.model.attribute.value;
            }
        });

        updateAvailableAttributes();
    }
})();


(function() {
    'use strict';

    /**
     * @desc Widget used to present / manage a list of attributes.
     * @example <flow-attribute-list attributes="modalData.variables" text-add-an-attribute="Add a parameter" text-add-another-attribute="Add another parameter"></flow-attribute-list>
     * where the attributes object will be a list with the following structure:
     *  [{ key: ,
     *     value: ,
     *    namespace: ,
     *    useDynamic:
     *  }, ... ]
     */
    angular
        .module("ContactFlowsModule")
        .directive("flowAttributeList", flowAttributeList);

    function flowAttributeList() {
        return {
            restrict: 'E',
            replace: true,
            templateUrl: '_flow_attribute_list.html',
            scope: {
                attributes: '=',
                addAnAttributeString: '@textAddAnAttribute',
                addAnotherAttributeString: '@textAddAnotherAttribute',
                isExternalIntegration: '=?'
            }
        };
    }
})();


(function() {
    'use strict';

    /**
     *
     * @desc Directive to provide support for input caller id number.
     * This directive gives three options to input caller id number namely:
     * 1. Custom
     * 2. dynamic
     * 3. claimed (automatically pre-populates the claimed numbers)
     *
     * @example:         <caller-id-input source="source" namespace="namespace" value="value" ></caller-id-input>
     */
    angular
        .module("ContactFlowsModule")
        .directive("callerIdInput", callerIdInput);

    function callerIdInput() {
        return {
            restrict: 'E',
            replace: true,
            templateUrl: '_caller_id_input.html',
            scope: {
                source: '=', //source could be custom, dynamic or claimed number
                namespace: '=', //namespace used when dynamic number source is selected.
                value: '=' //used to store the value of the dynamic number attribute in case of dynamic attributes. Custom or selected claimed number otherwise.
            },
            controller: callerIdInputCtrl
        };
    }
    callerIdInputCtrl.$inject = ["$scope", "phoneNumberFormatterFactory"];

    function callerIdInputCtrl($scope, phoneNumberFormatterFactory) {

        var CLAIMED_SOURCE = "claimed";
        var DYNAMIC_SOURCE = "dynamic";
        var CUSTOM_SOURCE = "custom";

        $scope.ctrl = {
            source: $scope.source || CLAIMED_SOURCE,
            claimedPhoneNumber: {},
            onSourceChange:  function() {
                                var source = $scope.ctrl.source;
                                $scope.source = source;
                                if (source === CLAIMED_SOURCE) {
                                    $scope.value = $scope.ctrl.claimedPhoneNumber.text;
                                    $scope.namespace = null;
                                } else if (source === DYNAMIC_SOURCE) {
                                    $scope.value = $scope.ctrl.attribute;
                                    $scope.namespace = $scope.ctrl.namespace;
                                } else {
                                    $scope.namespace = null;
                                    $scope.value = $scope.ctrl.customCallerId;
                                }
                            },
            isNumberInE164Format: function(val) {
                return phoneNumberFormatterFactory.phoneNumberValidator(val);
            },
            isNumberInNonE164Format: function(val) {
                var validNonE164NumberRegex = /^\+?[0-9]+$/;
                return validNonE164NumberRegex.test(val);
            }
        };

        if ($scope.ctrl.source === CLAIMED_SOURCE) {
            $scope.ctrl.claimedPhoneNumber.text = $scope.value;
        } else if($scope.ctrl.source === DYNAMIC_SOURCE) {
            $scope.ctrl.namespace = $scope.namespace;
            $scope.ctrl.attribute = $scope.value;
        } else {
            $scope.ctrl.customCallerId = $scope.value;
        }

        //Should avoid using $watch.
        //However ctrl.attribute and ctrl.namespace are an input to flow-attribute-selector directive. This directive does not support an input onchange function on them.
        //Therefore there is currently no way to use ng-change on ctrl.attribute and ctrl.namespace.
        $scope.$watch("ctrl.attribute", function(newValue) {
	        if ($scope.ctrl.source === DYNAMIC_SOURCE) {
	            $scope.value = newValue;
	        }
	    });
        $scope.$watch("ctrl.namespace", function(newValue) {
            if ($scope.ctrl.source === DYNAMIC_SOURCE) {
                $scope.namespace = newValue;
            }
        });

        //Should avoid using $watch.
        //However ctrl.claimedPhoneNumber is an input to claimednumberarnselect directive. This directive does not support an input onchange function on it.
        //Therefore there is currently no way to use ng-change on ctrl.claimedPhoneNumber.
        $scope.$watch("ctrl.claimedPhoneNumber", function(claimedPhoneNumber) {
            if ($scope.ctrl.source === CLAIMED_SOURCE && claimedPhoneNumber) {
                $scope.value = claimedPhoneNumber.text;
            }
        });

        $scope.$watch("ctrl.customCallerId", function(customCallerId) {
            if ($scope.ctrl.source === CUSTOM_SOURCE) {
                $scope.value = customCallerId;
            }
        });
    }

})();


(function() {
    'use strict';

    angular
        .module("ContactFlowsModule")
        .directive('lexAttributeInput', lexAttributeInput);

    function lexAttributeInput() {
        return {
            restrict: 'E',
            replace: true,
            templateUrl: '_lex_attribute_input.html',
            scope: {
                attribute: '=',
                namespace: '=',
                update: '='
            },
            controller: lexAttributeInputCtrl
        };
    }

    lexAttributeInputCtrl.$inject = ['$scope'];

    function lexAttributeInputCtrl($scope) {

        function getLexAttributeInput() {
            if ($scope.namespace === 'Lex.AlternativeIntents') {
                if ($scope.model.lexAlternativeIntentAttribute === 'Slots') {
                    return $scope.model.lexAlternativeIntentName + '.' + $scope.model.lexAlternativeIntentAttribute + '.' + $scope.model.lexAttributeInput;
                }
                return $scope.model.lexAlternativeIntentName + '.' + $scope.model.lexAlternativeIntentAttribute;
            }
            return $scope.model.lexAttributeInput;
        }

        function setLexAlternativeIntentName() {
            if ($scope.namespace === 'Lex.AlternativeIntents') {
                return $scope.attribute.split('.')[0];
            }
            return '';
        }

        function setLexAlternativeIntentAttribute() {
            if ($scope.namespace === 'Lex.AlternativeIntents') {
                var attrSplitArr = $scope.attribute.split('.');
                if (attrSplitArr[1] === 'Slots') {
                    return attrSplitArr[1];
                }
                return attrSplitArr[1] + '.' + attrSplitArr[2];
            }
            return '';
        }

        function setLexAttributeInput() {
            if ($scope.namespace && $scope.namespace.startsWith('Lex')) {
                var attrSplitArr = $scope.attribute.split('.');
                if (attrSplitArr.length > 1 && attrSplitArr[1] === 'Slots') {
                    return attrSplitArr.slice(2).join('.');
                }
                return $scope.attribute;
            }
            return '';
        }

        $scope.$on('flowAttributeSelectorAttributeChanged', function () {
            $scope.model.lexAttributeInput = '';
        });

        angular.extend($scope, {
            model: {
                lexAttributeInput: setLexAttributeInput(),
                lexAlternativeIntentName: setLexAlternativeIntentName(),
                lexAlternativeIntentAttribute: setLexAlternativeIntentAttribute()
            },

            onLexAlternativeAttributeChanged: function () {
                $scope.model.lexAttributeInput = '';
                $scope.onLexAttributeInputChanged();
            },

            onLexAttributeInputChanged: function() {
               $scope.update(getLexAttributeInput());
            }
        });
    }

})();
(function() {
    'use strict';

    angular
        .module("ContactFlowsModule")
        .directive('contactReferenceInput', contactReferenceInput);

    function contactReferenceInput() {
        return {
            restrict: 'E',
            replace: true,
            templateUrl: '_contact_reference_input.html',
            scope: {
                attribute: '=',
                update: '=', // a function used to update the attribute when the reference key changes
                setAttributes: '=?' // TODO: reuse this component in the SetAttributes block
            },
            controller: contactReferenceInputCtrl
        };
    }

    contactReferenceInputCtrl.$inject = ['$scope'];

    function contactReferenceInputCtrl($scope) {
        function getInitialReferenceKey(path) {
            var re = /References\[\'(.*)\'\]\.Value/;
            var matches = re.exec(path);
            if (matches) {
                return matches[1];
            } else {
                return "";
            }
        }

        function getInitialReferenceType() {
            return {value: "URL"}; // initially, URL will be the only Reference Type
        }

        angular.extend($scope, {
            model: {
                referenceKey: getInitialReferenceKey($scope.attribute.value),
                referenceType: getInitialReferenceType(),
                referenceTypes: [{value: "URL"}]
            },

            onReferenceKeyChanged: function() {
                $scope.update($scope.model.referenceKey);
            },
            onReferenceTypeChanged: function() {
                return; // initially, URL will be the only Reference Type
            }
        });
    }
})();
(function() {
    'use strict';

    /**
     * Directory to show input field.
     * It also support showing/hiding corresponding error message based on validation.
     * The validator needs to return boolean true or false.
    */
    angular
        .module("ContactFlowsModule")
        .directive("flowInput", flowInput);

    function flowInput() {
        return {
            restrict: 'E',
            replace: true,
            templateUrl: '_flow_input.html',
            scope: {
                input: '=', //the value of the input.
                validator: '&?', //Validator, which is called every time the value changes. Validator need to have the first argument as val.
                validationErrorMessage: "@?", // error message to be shown below the input text incase the validation fails.
                inputType: "@?" // html input type. Text/number etc.
            },
            controller: flowInputCtrl
        };
    }
    flowInputCtrl.$inject = ["$scope"];

    function flowInputCtrl($scope) {

        var isInputValid = function(input) {
            //Is it possible that validator is not a function? From angularJS documentations, it seems that its impossible (angularJs creates proxy functions for input functions).
            //But keeping this extra return just in case.
            if (typeof $scope.validator === "function") {
                var isValid = $scope.validator({val: input});
                if (isValid || typeof isValid === "undefined") {
                    //validator can return undef in only 2 cases.
                    //1. the validator is not provided in the input to directive since it is optional.
                    //2. the implementation of validator actually returns undefined.
                    //For both of these cases we assume treat the validation as true.
                    return true;
                }
                return false;
            }
            return true;
        };

        $scope.ctrl = {
            inputType: $scope.inputType || "text",
            validationErrorMessage: $scope.validationErrorMessage || "",
            onInputChange: function() {
                if (isInputValid($scope.ctrl.input)) {
                    $scope.input = $scope.ctrl.input;
                    $scope.ctrl.isInputValid = true;
                } else {
                    $scope.input = null;
                    $scope.ctrl.isInputValid = false;
                }
            }
        };

        if (isInputValid($scope.input)) {
            $scope.ctrl.input = $scope.input;
            $scope.ctrl.isInputValid = true;
        } else {
            $scope.input = null;
            $scope.ctrl.isInputValid = false;
        }
    }

})();


(function() {
    'use strict';

    /**
     *
     * @desc Directive to provide support for input caller id number in E164 format.
     * Created a new directive instead of using flowInput directive because its validation error message
     * contains special chars.
     */
    angular
        .module("ContactFlowsModule")
        .directive("customCallerIdE164FormatInput", customCallerIdE164FormatInput);

    function customCallerIdE164FormatInput() {
        return {
            restrict: 'E',
            replace: true,
            templateUrl: '_custom_caller_id_e164_format_input.html',
            scope: {
                input: '=',
                validator: '&'
            },
            controller: customCallerIdE164FormatInputCtrl
        };
    }
    customCallerIdE164FormatInputCtrl.$inject = ["$scope"];

    function customCallerIdE164FormatInputCtrl($scope) {

        var isInputValid = function(input) {
            //Is it possible that validator is not a function? From angularJS documentations, it seems that its impossible (angularJs creates proxy functions for input functions).
            //But keeping this extra return just in case.
            if (typeof $scope.validator === "function") {
                var isValid = $scope.validator({val: input});
                if (isValid || typeof isValid === "undefined") {
                    //validator can return undef in only 2 cases.
                    //1. the validator is not provided in the input to directive since it is optional.
                    //2. the implementation of validator actually returns undefined.
                    //For both of these cases we assume treat the validation as true.
                    return true;
                }
                return false;
            }
            return true;
        };

        var onInputChange = function() {
            if (isInputValid($scope.ctrl.input)) {
                $scope.input = $scope.ctrl.input;
                $scope.ctrl.isInputValid = true;
            } else {
                $scope.input = null;
                $scope.ctrl.isInputValid = false;
            }
        };

        $scope.ctrl = {
            onInputChange: onInputChange
        };

        if(isInputValid($scope.input)) {
            $scope.ctrl.input = $scope.input;
            $scope.ctrl.isInputValid = true;
        } else {
            $scope.input = null;
            $scope.ctrl.isInputValid = false;
        }
    }

})();


(function() {
    'use strict';

    /**
     *  @desc: Directive to provide an input template, with following input support:
     * 1. Custom (Where the user can enter values)
     * 2. Dynamic (where the user select the namespace and then enters the attribute name)
     * It also provides support for customizing validation.
     */
    angular
        .module("ContactFlowsModule")
        .directive("textInputWithCustomAndDynamicSupport", textInputWithCustomAndDynamicSupport);

    function textInputWithCustomAndDynamicSupport() {
        return {
            restrict: 'E',
            replace: true,
            templateUrl: '_text_input_with_custom_and_dynamic_support.html',
            scope: {
                namespace: '=', // used when dynamic attributes is chosen
                value: '=', // stores the dynamic attribute name in case dynamic attribute is selected otherwise stores the custom entered value.
                useCustomLabel: '@', // The label to show on the use custom radio button.
                customInputValidationErrorMessage: '@?',
                useDynamicLabel: '@',
                customInputValidator: '&?', // This function should input a single argument whose name should be "val". If this condition is not met, validation will not work.
                customInputDefault: "@?",
                customInputType: "@?"// could be number, text.
            },
            controller: textInputWithCustomAndDynamicSupportCtrl
        };
    }

    textInputWithCustomAndDynamicSupportCtrl.$inject = ['$scope'];

    function textInputWithCustomAndDynamicSupportCtrl($scope) {

        $scope.ctrl = {
            useDynamic: false,
            useCustomLabel: $scope.useCustomLabel || "",
            useDynamicLabel: $scope.useDynamicLabel || "",
            customInputValidationErrorMessage: $scope.customInputValidationErrorMessage || "",
            customInputType: $scope.customInputType || "text",
            isCustomInputValid: false,
            customInput: "",
            customInputValidator: function() {

                                              if (typeof $scope.customInputValidator !== "function") {
                                                  $scope.ctrl.isCustomInputValid = true;
                                              } else {
                                                  var validatorOutput = $scope.customInputValidator({val: $scope.ctrl.customInput});
                                                  if (validatorOutput) {
                                                      $scope.ctrl.isCustomInputValid = true;
                                                  } else if(validatorOutput === false) {
                                                       $scope.ctrl.isCustomInputValid = false;
                                                  } else {
                                                      //If the validatorOutput is undefined, then assume that the input is valid.
                                                      //validatorOutput will be undefined, if the user did not pass customInputValidator function in input or the input function actually returned undef.
                                                      //This is done because we don't have a way to identify if user has passed optional parameter customInputValidator. More details: https://github.com/angular/angular.js/issues/6404
                                                      $scope.ctrl.isCustomInputValid = true;
                                                  }
                                              }

                                              return $scope.ctrl.isCustomInputValid;
                                          },
            onCustomInputChange: function() {
                                             if (!$scope.ctrl.useDynamic) {
                                                 if ($scope.ctrl.customInputValidator()) {
                                                     $scope.value = $scope.ctrl.customInput;
                                                 } else {
                                                     $scope.value = null;
                                                 }
                                             }
                                         },
            onUseDynamicChange: function() {
                                            var useDynamic = $scope.ctrl.useDynamic;
                                            if (!useDynamic) {
                                                $scope.namespace = null;
                                                $scope.value = $scope.ctrl.customInput;
                                            } else {
                                                $scope.namespace = $scope.ctrl.namespace;
                                                $scope.value = $scope.ctrl.attribute;
                                            }
                                        }


        };

        if ($scope.namespace) {
            //initialize dynamic html properties
            $scope.ctrl.useDynamic = true;
            $scope.ctrl.attribute = $scope.value;
            $scope.ctrl.namespace = $scope.namespace;
        } else if($scope.value){
            //initialize custom html properties.
            //if namespace is not defined then we assume that it must be custom.
            $scope.ctrl.customInput = $scope.value;
        } else if ($scope.customInputType === "number" && !isNaN(parseInt($scope.customInputDefault))){
            //If the input type is a number then convert the customInputDefault string into a number before assigning
            $scope.ctrl.customInput = parseInt($scope.customInputDefault);
        } else {
             $scope.ctrl.customInput = $scope.customInputDefault || "";
        }


        if (!$scope.ctrl.useDynamic) {
            //At the time of importing a contact flow, user may change the value.
            //Hence verify the value once.
            if ($scope.ctrl.customInputValidator()) {
                $scope.value = $scope.ctrl.customInput;
            } else {
                $scope.value = null;
            }
        }

        //Should avoid using $watch.
        //However ctrl.attribute and ctrl.namespace are an input to flow-attribute-selector directive. This directive does not support an input onchange function on them.
        //Therefore there is currently no way to use ng-change on ctrl.attribute and ctrl.namespace.
        $scope.$watch("ctrl.namespace", function(newValue) {
            if ($scope.ctrl.useDynamic) {
                $scope.namespace = newValue;
            }
        });
        $scope.$watch("ctrl.attribute", function(newValue) {
            if ($scope.ctrl.useDynamic) {
                $scope.value = newValue;
            }
        });
    }

})();


(function() {
    'use strict';

    /**
     * @desc Widget used to present / manage a list of attributes.
     * @example <flow-attribute-top-level-selector attribute="modalData.variables" attributes=""></flow-attribute-list>
     * where the attributes object will be a list of all the attributes with the following structure:
     *  [{ key: ,
     *     value: ,
     *     namespace: ,
     *     useDynamic: ,
     *     destinationType: ,
     *     destinationAttribute:
     *  }, ... ]
     *  and attribute is the current attribute
     */
    angular
        .module("ContactFlowsModule")
        .directive("flowAttributeContactDataSelector", flowAttributeContactDataSelector);

    var VOICE_AUTHENTICATION_FAC = "isUseVoiceAuthenticationEnabled";

    function flowAttributeContactDataSelector() {
        return {
            restrict: 'E',
            replace: true,
            templateUrl: '_flow_attribute_contact_data_selector.html',
            scope: {
                attributes: '=',
                attribute: '='
            },
            controller: flowAttributeContactDataSelectorCtrl
        };
    }

    flowAttributeContactDataSelectorCtrl.$inject = ['$scope'];

    function flowAttributeContactDataSelectorCtrl($scope) {
        // Setting default values (with backwards compatibility)
        function setDestinationType(attr) {
            if(attr.destinationType === LilyContactFlow.AttributeContactDataStrings.SYSTEM_TYPE) {
                return {value: attr.destinationType};
            } else {
                //Default all values to User Defined for backwards compatibility
                return {value: LilyContactFlow.AttributeContactDataStrings.USER_DEFINED_TYPE};
            }
        }
        function setDestinationAttribute(attr) {
            if(attr.destinationType === LilyContactFlow.AttributeContactDataStrings.SYSTEM_TYPE) {
                return {value: attr.destinationAttribute};
            }
        }
        function setReferenceType(attr) {
            if(attr.destinationAttribute === LilyContactFlow.AttributeContactDataStrings.CONTACT_REFERENCES && attr.referenceType) {
                return {value: attr.referenceType};
            } else {
                $scope.attribute.referenceType = LilyContactFlow.AttributeContactDataStrings.REFERENCE_URL;
                return {value: LilyContactFlow.AttributeContactDataStrings.REFERENCE_URL};
            }
        }
        var destinationTypes = [
            {value: LilyContactFlow.AttributeContactDataStrings.SYSTEM_TYPE},
            {value: LilyContactFlow.AttributeContactDataStrings.USER_DEFINED_TYPE}
        ].map(function(type) {
            type.name = LilyContactFlow.translateNamespace(type.value);
            return type;
        });
        var destinationAttributes = [
            {value: LilyContactFlow.AttributeContactDataStrings.CONTACT_NAME},
            {value: LilyContactFlow.AttributeContactDataStrings.CONTACT_DESCRIPTION},
            {value: LilyContactFlow.AttributeContactDataStrings.LANGUAGE_CODE},
            {value: LilyContactFlow.AttributeContactDataStrings.CONTACT_REFERENCES}
        ];
        if (LilyContactFlow.isFeatureEnabled(VOICE_AUTHENTICATION_FAC)) {
            destinationAttributes.push({value: LilyContactFlow.AttributeContactDataStrings.CUSTOMER_ID});
        }
        destinationAttributes.map(function(attr) {
            attr.name = LilyContactFlow.translateSystemAttribute(attr.value);
            return attr;
        });
        var referenceTypes = [
            {value: "URL"}
        ].map(function(type) {
            type.name = LilyContactFlow.translateNamespace(type.value);
            return type;
        });

        angular.extend($scope, {
            model: {
                destinationTypes: destinationTypes,
                destinationAttributes: destinationAttributes,
                referenceTypes: referenceTypes,
                showDestinationAttributes: $scope.attribute !== undefined && $scope.attribute.destinationType === "System" ? true : false,
                showReferences: $scope.attribute !== undefined && $scope.attribute.destinationAttribute === "References" ? true : false,
                destinationType: setDestinationType($scope.attribute),
                destinationAttribute: setDestinationAttribute($scope.attribute),
                referenceType: setReferenceType($scope.attribute)
            },
            onDestinationTypeChanged: function() {
                $scope.model.showDestinationAttributes = false;
                $scope.model.showReferences = false;
                if ($scope.model.destinationType !== undefined && $scope.model.destinationType.value === LilyContactFlow.AttributeContactDataStrings.SYSTEM_TYPE) {
                    $scope.model.showDestinationAttributes = true;
                }
                $scope.attribute.destinationType = $scope.model.destinationType.value;
            },
            onDestinationAttributeChange: function() {
                $scope.model.showReferences = false;
                var destAttr = $scope.model.destinationAttribute;
                if (destAttr !==undefined && destAttr.value === LilyContactFlow.AttributeContactDataStrings.CONTACT_REFERENCES) {
                    $scope.model.showReferences = true;
                }
                $scope.attribute.destinationAttribute = destAttr.value;
                $scope.model.destinationAttribute = destAttr;
            },
            onReferenceTypeChanged: function() {
                $scope.attribute.referenceType = $scope.model.referenceType.value;
            }
        });
    }
})();


// Set Recording Behavior and Analysis block

LilyContactFlow.analysisLanguages = {
    RealTime: ['en-US', 'en-GB', 'en-AU', 'es-US'],
    PostCall: ['en-US','en-GB','en-AU','en-IN','es-US', 'en-IE', 'en-AB', 'en-WL', 'es-ES',
    'fr-CA','fr-FR','pt-PT','pt-BR','de-DE','de-CH','it-IT','ar-AE','ar-SA','hi-IN']
};

LilyContactFlow.allowRedaction = function(useDynamicLanguage, language, analyticsMode){
    if(useDynamicLanguage){
        return true;
    }

    if(typeof language !== "string"){
        language = language? language.id:"";
    }
    analyticsMode = analyticsMode || "PostCall";
    var redactAllowedLanguages = {
        PostCall: ["en-US", "en-GB", "en-AU", "en-IN", "en-IE", "en-AB", "en-WL"],
        RealTime: ["en-US", "en-GB", "en-AU"]
    };

    return language && redactAllowedLanguages[analyticsMode].includes(language);
};

// TODO: Remove after isContactLensRealTimeEnabled GAs
LilyContactFlow.getLanguageObject = function(language){
    var id = typeof language === "string"? language : language.id;

    var languageMap = {
        "en-US": "English (United States)",
        "en-GB": "English (Great Britain)",
        "en-IN": "English (India)",
        "en-AU": "English (Australia)",
        "es-ES": "Spanish (Spain)",
        "es-US": "Spanish (United States)"
    };
    return {
        id: id,
        text: languageMap[id]
    };
};

LilyContactFlow.getSupportedAnalysisLanguages = function(analyticsMode){
    return LilyContactFlow.analysisLanguages[analyticsMode || 'PostCall'];
};

LilyContactFlow.setRecordingBehaviorParams = {
    size: { width: LilyContactFlow.Sizes.MODULE_WIDTH, height: LilyContactFlow.getModuleHeight(1, true) },
    getLabel: function(cell) {
        if (LilyContactFlow.isFeatureEnabled("isContactLensGAEnabled") || LilyContactFlow.isFeatureEnabled("isContactAnalyticsFeatureEnabled")) {
            return LilyContactFlow.getString('lily-admin-contact-flow-set-recording-and-analytics-label');
        }
        return LilyContactFlow.getString('lily-admin-contact-flow-set-recording-label');
    },
    getAttributeLabel: function(cell) {
        var side;
        switch (cell.model.attributes.side) {
        case "Both":
            side = LilyContactFlow.getString('lily-admin-contact-flow-set-recording-attribute-label-both');
            break;
        case "Agent":
            side = LilyContactFlow.getString('lily-admin-contact-flow-set-recording-attribute-label-agent');
            break;
        case "Customer":
            side = LilyContactFlow.getString('lily-admin-contact-flow-set-recording-attribute-label-customer');
            break;
        case "None":
            side = LilyContactFlow.getString('lily-admin-contact-flow-set-recording-attribute-label-none');
            break;
        default:
            side = cell.model.attributes.side;
            break;
        }
        var analyticsEnabled = (LilyContactFlow.isFeatureEnabled("isContactLensGAEnabled") || LilyContactFlow.isFeatureEnabled("isContactAnalyticsFeatureEnabled")) && cell.model.attributes.analyticsEnabled;
        var analyticsString = analyticsEnabled ? "Enable: Analytics, " : "";
        return analyticsString + LilyContactFlow.getString('lily-admin-contact-flow-set-recording-attribute-label-enable') + ": " + side;
    },
    toAngular: function() {
        var analyticsEnabled = this.model.attributes.side === 'Both' && this.model.attributes.analyticsEnabled;
        var analysisLanguage = this.model.attributes.useDynamicLanguage ? null : this.model.attributes.analysisLanguage;
        var serializedData = {
            id: this.model.id,
            behavior: this.model.attributes.behavior,
            side: this.model.attributes.side,
            on:  this.model.attributes.side !== 'None' ? true : false,
            analyticsEnabled : analyticsEnabled,
            analyticsMode : this.model.attributes.analyticsMode,
            useDynamicLanguage : this.model.attributes.useDynamicLanguage,
            analysisLanguage : analysisLanguage,
            analysisLanguageDynamicKey : this.model.attributes.analysisLanguageDynamicKey,
            analysisLanguageNamespace : this.model.attributes.analysisLanguageNamespace,
            redactionEnabled : this.model.attributes.redactionEnabled && analyticsEnabled && LilyContactFlow.allowRedaction(this.model.attributes.useDynamicLanguage, analysisLanguage, this.model.attributes.analyticsMode),
            analyticsRedactionOption: this.model.attributes.useDynamicAnalyticsRedaction? "UseDynamic":this.model.attributes.analyticsRedactionOption,
            useDynamicAnalyticsRedaction: this.model.attributes.useDynamicAnalyticsRedaction,
            analyticsRedactionOptionKey: this.model.attributes.useDynamicAnalyticsRedaction? this.model.attributes.analyticsRedactionOptionKey: null,
            analyticsRedactionOptionNamespace: this.model.attributes.useDynamicAnalyticsRedaction? this.model.attributes.analyticsRedactionOptionNamespace:null,
            templateUrl: "_setRecordingBehaviorModal.html"
        };
        angular.element($("#angularContainer")).scope().showModal(serializedData, { 
            allowRedaction: LilyContactFlow.allowRedaction, 
            initializeRedactionOption: LilyContactFlow.initializeRedactionOption,
            analyticsLanguageChange: function(modalData){
                if(!LilyContactFlow.allowRedaction(modalData.useDynamicLanguage, modalData.analysisLanguage, modalData.analyticsMode)){
                    modalData.redactionEnabled = false;
                }
            },
            analyticsModeChange: function(modalData){
                if(modalData.useDynamicLanguage){
                    return;
                }

                var supportedLanguages = LilyContactFlow.analysisLanguages[modalData.analyticsMode];
                
                if(!modalData.analysisLanguage){
                    // preselecting language
                    modalData.analysisLanguage = LilyContactFlow.setRecordingBehaviorParams.analysisLanguage;
                    return;
                }

                if(supportedLanguages && supportedLanguages.includes(modalData.analysisLanguage)){
                    if(!LilyContactFlow.allowRedaction(modalData.useDynamicLanguage, modalData.analysisLanguage, modalData.analyticsMode)){
                        modalData.redactionEnabled = false;
                    }
                }else {
                    modalData.analysisLanguage = LilyContactFlow.setRecordingBehaviorParams.analysisLanguage;
                }

            },
            getSupportedAnalysisLanguage: LilyContactFlow.getSupportedAnalysisLanguages,
            getLanguageStringName: function(id){
                return LilyContactFlow.getString('lily-admin-contact-flow-analysis-language-' + id.toLowerCase());
            }
        });
        return serializedData;
    },
    behavior: "Enable",
    side: "None",
    on: false,
    analyticsEnabled: false,
    useDynamicLanguage : false,
    analysisLanguage :"en-US",
    analysisLanguageNamespace : null,
    analyticsMode : 'PostCall',
    analyticsRedactionOption: "RedactedAndOriginal",
    fromAngular: function(data) {
        var self = LilyContactFlow.graph.getCell(this.id);
        self.attributes.behavior = data.behavior;
        var on = data.on === true || (!LilyContactFlow.isFeatureEnabled("isContactLensGAEnabled") && !LilyContactFlow.isFeatureEnabled("isContactAnalyticsFeatureEnabled"));
        self.attributes.side = on ? data.side : 'None';
        self.attributes.on = String(on);
        self.attributes.analyticsEnabled = self.attributes.side === 'Both' && data.analyticsEnabled;
        self.attributes.useDynamicLanguage = data.useDynamicLanguage;
        if(self.attributes.analyticsEnabled){
            self.attributes.redactionEnabled = data.redactionEnabled;
            self.attributes.analyticsMode = data.analyticsMode;
            if (data.useDynamicLanguage) {
                self.attributes.analysisLanguageDynamicKey = data.analysisLanguageDynamicKey;
                self.attributes.analysisLanguageNamespace = data.analysisLanguageNamespace;
            } else {
                self.attributes.analysisLanguage = data.analysisLanguage;
            }
    
            if(self.attributes.redactionEnabled && LilyContactFlow.allowRedaction(data.useDynamicLanguage, data.analysisLanguage, data.analyticsMode)){
                self.attributes.analyticsRedactionOption = data.analyticsRedactionOption;
                self.attributes.useDynamicAnalyticsRedaction = data.analyticsRedactionOption === "UseDynamic";
                if(self.attributes.useDynamicAnalyticsRedaction){
                    self.attributes.analyticsRedactionOptionKey = data.analyticsRedactionOptionKey;
                    self.attributes.analyticsRedactionOptionNamespace = data.analyticsRedactionOptionNamespace;
                }
            }
        }
        self.findView(LilyContactFlow.paper).updateAttributeLabel(self);
    },
    getType: function() {
        return "SetRecordingBehavior";
    },
    getParameters: function() {
        var self = LilyContactFlow.graph.getCell(this.id);
        var parameters;
        if ((LilyContactFlow.isFeatureEnabled("isContactLensGAEnabled") || LilyContactFlow.isFeatureEnabled("isContactAnalyticsFeatureEnabled")) && self.attributes.analyticsEnabled && self.attributes.side === "Both") {
            var manualLanguageCode = self.attributes.analysisLanguage ? self.attributes.analysisLanguage : null;
            manualLanguageCode = typeof manualLanguageCode === 'string'? manualLanguageCode : manualLanguageCode.id;

            var languageCode = self.attributes.useDynamicLanguage ? self.attributes.analysisLanguageDynamicKey : manualLanguageCode,
                analyticsEnabled = self.attributes.analyticsEnabled && self.attributes.side === "Both";

            parameters = [
                 {
                     name: "RecordingBehaviorOption",
                     value: (self.attributes.behavior === "Enable" && self.attributes.side === "None") ? "Disable" : self.attributes.behavior
                 },
                 {
                     name: "RecordingParticipantOption",
                     value: (self.attributes.behavior === "Enable" && self.attributes.side === "None") ? "Both" : self.attributes.side
                 },
                 {
                     name: "AnalyticsBehaviorOption",
                     value:  analyticsEnabled? "Enable" : "Disable"
                 },
                 {
                     name: "AnalyticsLanguageLocaleCode",
                     value: (languageCode && self.attributes.side === "Both") ? languageCode : null,
                     namespace : self.attributes.useDynamicLanguage ? self.attributes.analysisLanguageNamespace : null
                 },
                 {
                     name: "AnalyticsCustomVocabulary",
                     value: (self.attributes.customVocab && self.attributes.side === "Both") ? self.attributes.customVocab : "None"
                 }
            ];

            if(LilyContactFlow.isFeatureEnabled('isContactLensGAEnabled') && analyticsEnabled){
                var enableRedaction = self.attributes.redactionEnabled && LilyContactFlow.allowRedaction(self.attributes.useDynamicLanguage, manualLanguageCode, self.attributes.analyticsMode);
                parameters = parameters.concat([
                    {
                        name: "AnalyticsRedactionOption",
                        value: enableRedaction? "Enable":"Disable"
                    },
                    {
                        name:"AnalyticsRedactionPolicy",
                        value: enableRedaction? (self.attributes.useDynamicAnalyticsRedaction? self.attributes.analyticsRedactionOptionKey:self.attributes.analyticsRedactionOption):'None',
                        namespace: enableRedaction && self.attributes.useDynamicAnalyticsRedaction? self.attributes.analyticsRedactionOptionNamespace: null
                    }
                ]);

                if(LilyContactFlow.isFeatureEnabled('isContactLensRealTimeEnabled')){
                    parameters = parameters.concat([
                        {
                            name: "AnalyticsMode",
                            value: self.attributes.analyticsMode
                        }
                    ]);
                }
            }

        } else {
            parameters = [
                {
                    name: "RecordingBehaviorOption",
                    value: (self.attributes.behavior === "Enable" && self.attributes.side === "None") ? "Disable" : self.attributes.behavior
                },
                {
                    name: "RecordingParticipantOption",
                    value: (self.attributes.behavior === "Enable" && self.attributes.side === "None") ? "Both" : self.attributes.side
                }
            ];
        }
        return parameters;
    },
    headerParameters: {
        backGroundColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_BACKGROUND_COLOR,
        fontColor: LilyContactFlow.Colors.GENERAL_MODULE_HEADER_FONT_COLOR,
        iconClass: "setCallRecordingBehavior"
    },
    baseConditions: [{
        display: LilyContactFlow.getString('lily-admin-contact-flow-condition-success'),
        condition: "Success"
    }]
};


LilyContactFlow.initializeRedactionOption = function(modalData){
    if(modalData.redactionEnabled){
        if(!modalData.analyticsRedactionOption || modalData.analyticsRedactionOption === "None"){
            modalData.analyticsRedactionOption = "RedactedAndOriginal";
        }
    }
};

LilyContactFlow.createSetRecordingBehaviorModule = function(x, y) {
    var parent = new joint.shapes.module(_.extend(LilyContactFlow.basicModuleOptions(x, y), LilyContactFlow.setRecordingBehaviorParams));
    var nodes = [parent];
    _.forEach(LilyContactFlow.setRecordingBehaviorParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};
LilyContactFlow.ModuleDecompilerByType[LilyContactFlow.setRecordingBehaviorParams.getType()] = function(data) {
    var baseParams = _.extend(LilyContactFlow.basicModuleOptions(data.metadata.position.x, data.metadata.position.y), LilyContactFlow.setRecordingBehaviorParams);
    baseParams.id = data.id;
    _.forEach(data.parameters, function(param) {
        if (param.name === "RecordingBehaviorOption" ) {
            baseParams.behavior = param.value;
        } else if (param.name === "RecordingParticipantOption" ) {
            baseParams.side = param.value;
        }
        if (LilyContactFlow.isFeatureEnabled("isContactLensGAEnabled") || LilyContactFlow.isFeatureEnabled("isContactAnalyticsFeatureEnabled")) {
             if (param.name === "AnalyticsBehaviorOption") {
                baseParams.analyticsEnabled = param.value === "Enable";
            } else if (param.name === "AnalyticsLanguageLocaleCode") {
                if (param.namespace == null) {
                    if(LilyContactFlow.isFeatureEnabled('isContactLensRealTimeEnabled')){
                        baseParams.analysisLanguage = param.value;
                    }else {
                        baseParams.analysisLanguage = LilyContactFlow.getLanguageObject(param.value);
                    }
                } else {
                    baseParams.useDynamicLanguage = true;
                    baseParams.analysisLanguageNamespace = param.namespace;
                    baseParams.analysisLanguageDynamicKey = param.value;
                }
            } else if (param.name === "AnalyticsBehaviorOption") {
                baseParams.customVocab = param.value;
            }
        }

        if(LilyContactFlow.isFeatureEnabled("isContactLensGAEnabled")){
            if(param.name === "AnalyticsRedactionOption"){
                baseParams.redactionEnabled = param.value === "Enable";
            }else if (param.name === "AnalyticsRedactionPolicy"){
                if (param.namespace == null) {
                    baseParams.analyticsRedactionOption = param.value;
                } else {
                    baseParams.useDynamicAnalyticsRedaction = true;
                    baseParams.analyticsRedactionOption = "UseDynamic";
                    baseParams.analyticsRedactionOptionNamespace = param.namespace;
                    baseParams.analyticsRedactionOptionKey = param.value;
                }

            }

            if(LilyContactFlow.isFeatureEnabled('isContactLensRealTimeEnabled')){
                if(param.name === "AnalyticsMode"){
                    baseParams.analyticsMode = param.value;
                }
            }
        }
    });

    if(LilyContactFlow.isFeatureEnabled('isContactLensRealTimeEnabled') && baseParams.analyticsEnabled ){
        baseParams.analyticsMode = baseParams.analyticsMode || "PostCall";
    }

    var parent = new joint.shapes.module(baseParams);
    var nodes = [parent];
    _.forEach(LilyContactFlow.setRecordingBehaviorParams.baseConditions, function(label, i) {
        var child = LilyContactFlow.addOutputCondition(parent, label.display, label.condition, i);
        nodes.push(child);
    });
    return nodes;
};


};

angular.module("Lily.InputFieldVerifications", [])
   //Directive to allow only numbers within range and prevent entering negative numbers, spaces, alphabets
   .directive('nonNegativeNumber', function() {
   	   return {
           restrict: 'A',
           require: '?ngModel',
           link: function (scope, element, attrs, ngModel) {
               var pattern = null;
               if (!ngModel) { return; }

               ngModel.$parsers.push(function(val) {

               var lastVal = ngModel.$modelValue;
               if(attrs.rangeMin === "1") {
                   pattern = /(^0$)|([^0-9]$)/;
               }
               else {
                   pattern = /[^0-9]+/g;
               }
               var parsed = val.replace(pattern, '');
               if (parseInt(parsed) > parseInt(attrs.rangeMax) || parseInt(parsed) < parseInt(attrs.rangeMin)) {
                   parsed = lastVal;
               }
               if (val !== parsed) {
                   ngModel.$setViewValue(parsed);
                   ngModel.$render();
               }
               return parsed;
           });
               element.bind('keypress', function(event) {
                   //Check for spaces
                   if(event.charCode === 32) {
                       event.preventDefault();
                   }
               });
           }
   	   };
   })
   //Directive to prevent input if number of characters are more than the specified limit
   .directive('maximumCharactersLength', function() {
       return {
           restrict: 'A',
           require: 'ngModel',
           link: function (scope, element, attrs, ngModelCtrl) {
               var maxlength = Number(attrs.maximumCharactersLength);
               function userInput(text) {
                   if (text.length > maxlength) {
                       var transformedInput = text.substring(0, maxlength);
                       ngModelCtrl.$setViewValue(transformedInput);
                       ngModelCtrl.$render();
                       return transformedInput;
                   }
                   return text;
               }
               ngModelCtrl.$parsers.push(userInput);
           }
       };
   });


(function(){
  'use strict';
  
  /**
   * @desc Copy to clipbpard widget which uses the browser execCommand to copy text
   * @example <copy-to-clipboard value={}></copy-to-clipboard>
   */
  angular
    .module("lily.widgets", ["lily.utils"])
    .directive("copyToClipboard", copyToClipboard);

  // Inject the selection util dependency
  copyToClipboard.$inject = ["selectionUtils"];

  function copyToClipboard(selectionUtils){
    var directive = {
      restrict: "E",
      replace: true,
      templateUrl: "_copy-to-clipboard.html",
      scope: {
        value: '@'
      },
      link: linkFn
    };

    return directive;

    function linkFn(scope, element, attr, ctrl){
      if (!selectionUtils.isCopyToClipboardSupported()) {
        // hide the icon
        element.css("display", "none");
        return;
      }
      var message = element.find(".message");
      //attach click handler
      element.on("click", function(){
        var isCopied = selectionUtils.copyToClipboard(scope.value);

        if (isCopied) {
          message.addClass("copied");
          message.on("animationend", function(){message.removeClass("copied");});
        }
      });
    }

  }
})();
(function () {

    'use strict';

    angular
        .module('lily.widgets')
        .directive('lambdaFunctionSelect', lambdaFunctionSelect);

    lambdaFunctionSelect.$inject = [];
    function lambdaFunctionSelect() {

        LambdaFunctionSelectCtrl.$inject = ["$http", "$scope"];
        function LambdaFunctionSelectCtrl($http, $scope) {

            var self = this;

            self.loading = false;
            self.fetchPromise = null;
            self.lambda = $scope.ngModel.text || '';

            self.onChange = function (text, item) {
                $scope.ngModel = item || {
                    id: text,
                    text: text
                };
            };

            self.isArn = function (text) {
                return text.indexOf('arn:aws:lambda') === 0;
            };

            self.fetchData = function (query) {
                // We only fetch the results once and then do filtering and sorting on the front end
                if (!self.fetchPromise) {
                    self.fetchPromise = $http.get(document.requestPathPrefix + '/selector-search/lambda-functions');
                }
                var lowerCaseQuery = query.toLowerCase();
                return self.fetchPromise.then(function (response) {
                    return (response.data.results || []).filter(function (lambda) {
                        return lambda.text.toLowerCase().indexOf(lowerCaseQuery) > -1;
                    }).sort(sortByExactMatch(lowerCaseQuery));
                }, function () {
                    // reset the fetchPromise to ensure a new request will be send if this one failed
                    self.fetchPromise = null;
                    return [];
                });
            };

            // Lambdas are sorted with exact matches at the top
            function sortByExactMatch(query) {
                return function (a, b) {
                    if (a.text.toLowerCase() === query && b.text.toLowerCase() !== query) {
                        return -1;
                    }
                    if (b.text.toLowerCase() === query && a.text.toLowerCase() !== query) {
                        return 1;
                    }
                    return 0;
                };
            }
        }
        
        return {
            restrict: 'E',
            scope: {
                ngModel: '='
            },
            controller: LambdaFunctionSelectCtrl,
            controllerAs: '$ctrl',
            templateUrl: '_lambda-function-select.html'
        };
    }
} ());


(function () {
    'use strict';

    angular.module('lily.widgets').directive('lilyTypeahead', typeahead);

    typeahead.$inject = ["$timeout", "$compile", "$templateCache"];
    function typeahead($timeout, $compile, $templateCache) {

        TypeaheadCtrl.$inject = ["$scope", "$element"];
        function TypeaheadCtrl($scope, $element) {

            var self = this;

            var DEBOUNCE_MS = 300;

            self.items = [];
            self.ngModel = null;
            self.typeaheadElement = null;
            self.dropdownMenuElement = null;
            self.focusableElements = null;
            self.visible = false;
            self.currentItemIndex = 0;
            self.searchValue = '';
            self.skipViewValue = null;
            self.isForcedOpen = false;
            self.fetchPromise = null;

            self.init = init;
            self.select = select;
            self.setCurrentIndex = setCurrentIndex;
            self.toggleForceOpen = toggleForceOpen;

            function init(ngModel, typeaheadElement) {
                self.ngModel = ngModel;
                self.typeaheadElement = typeaheadElement;
                self.dropdownMenuElement = $(typeaheadElement).find('.cf-dropdown-menu');
                var toggleButtonElement = $(typeaheadElement).find('.lily-typeahead-toggle button');
                self.focusableElements = $element.add(self.dropdownMenuElement).add(toggleButtonElement);
                ngModel.$viewChangeListeners.push(update);
                setEventHandlers();
                $scope.$on('$destroy', removeEventHandlers);
                fetchData(true);
            }

            function setEventHandlers() {
                // Event handler for when focus is on the input field
                $element.on('keydown.typeahead', function (e) {
                    switch (e.key) {
                    case 'ArrowUp':
                        $scope.$apply(function () {
                            previousItem();
                        });
                        // When an item is selected but the focus was set manually back to the input,
                        // this rules ensures that keyboard navigation with 'up' still works
                        if (self.currentItemIndex > -1) {
                            self.dropdownMenuElement[0].focus();
                        }                             
                        break;
                    case 'ArrowDown':
                        $scope.$apply(function () {
                            nextItem();
                        });
                        self.dropdownMenuElement[0].focus();
                        break;
                    }
                    stopEventOnKey(e, ['ArrowUp', 'ArrowDown']);
                });

                // Event handler for when focus is on the dropdown menu
                self.dropdownMenuElement.on('keydown.typeahead', function (e) {
                    switch (e.key) {
                    case 'ArrowUp':
                        $scope.$apply(function () {
                            previousItem();
                        });
                        // Clicking 'up' while the first element is selected will set the focus back
                        // to the input field
                        if (self.currentItemIndex === -1) {
                            $element[0].focus();
                        }
                        break;
                    case 'ArrowDown':
                        $scope.$apply(function () {
                            nextItem();
                        });
                        break;
                    case 'Enter':
                        $scope.$apply(function () {
                            selectCurrent();
                        });
                        $element[0].focus();
                        break;
                    }
                    stopEventOnKey(e, ['ArrowUp', 'ArrowDown', 'Enter']);
                });

                self.focusableElements.on('blur.typeahead', function (e) {
                    $timeout(function () {
                        self.isForcedOpen = false;
                        updateVisibility();
                    });
                });
                self.focusableElements.on('focus.typeahead', function (e) {
                    $timeout(function () {
                        updateVisibility();
                    });
                });
            }

            function removeEventHandlers() {
                $element.off('.typeahead');
                self.dropdownMenuElement.off('.typeahead');
                self.focusableElements.off('.typeahead');
                self.typeaheadElement.remove();
            }

            function isDescendantOf(targetEl, parentEl) {
                return targetEl.closest(parentEl).length > 0;
            }

            function isVisible() {
                // dropdown menu has focus
                if (isDescendantOf($(document.activeElement), self.dropdownMenuElement)) {
                    return true;
                }

                if (self.isForcedOpen) {
                    return true;
                }

                // input has focus
                if (isDescendantOf($(document.activeElement), $element)) {
                    return !!self.searchValue;
                }

                return false;
            }

            function updateVisibility() {
                self.visible = isVisible();
            }

            function toggleForceOpen() {
                self.isForcedOpen = !self.isForcedOpen;
                // In case that the dropdown is manually opened we have to wait for ongoing fetch to resolve
                if (self.isForcedOpen && self.fetchPromise) {
                    $scope.loading = true;
                } else {
                    updateVisibility();
                }
            }

            function fetchData(skipLoadingState) {
                // Loading state will not be set when fetching the unfiltered results
                // for instance when input is emptied or when a selection took place
                $scope.loading = !skipLoadingState;
                self.fetchPromise = $scope.dataSource({
                    query: self.searchValue
                }).then(function (items) {
                    self.items = items;
                    autoSelectExactMatch();
                }).catch(function () {
                    self.item = [];
                }).finally(function () {
                    $scope.loading = false;
                    updateVisibility();
                    self.fetchPromise = null;
                });
            }
            var debouncedFetchData = _.debounce(fetchData, DEBOUNCE_MS);

            function update() {
                if (self.searchValue === self.ngModel.$viewValue) {
                    return;
                }
                // prevent update if change was triggered by selecting a typeahead item
                if (self.skipViewValue === self.ngModel.$viewValue) {
                    self.skipViewValue = null;
                    return;
                }
                self.isForcedOpen = false;
                self.currentItemIndex = -1;
                self.searchValue = $scope.ignoreInput({text: self.ngModel.$viewValue}) ? '' : self.ngModel.$viewValue;
                debouncedFetchData();
                $scope.onChange({text: self.ngModel.$viewValue, item: null});
            }

            // If the user enters a string that matches exactly with the only found match,
            // we automatically select this item.
            function autoSelectExactMatch() {
                var items = self.items.filter(function (item) {
                    return item[$scope.textAttr].toLowerCase() === self.searchValue.toLowerCase();
                });
                if (items.length === 1) {
                    $scope.onChange({text: self.searchValue, item: items[0]});
                }
            }

            function select(item) {
                self.searchValue = '';
                // This part is a bit ugly. We have to set skipViewValue in order to avoid
                // triggering an update action
                self.skipViewValue = item[$scope.textAttr];
                self.isForcedOpen = false;
                $scope.onChange({text: item[$scope.textAttr], item: item});
                $scope.onSelect({item: item});
                self.ngModel.$setViewValue(item[$scope.textAttr], 'typeahead');
                self.ngModel.$render();
                updateVisibility();
                // Reset result set to full set when item was selected
                fetchData(true);
            }

            function selectCurrent() {
                var item = self.items[self.currentItemIndex];
                if (item) {
                    select(item);
                }
            }

            function setCurrentIndex(itemIndex) {
                self.currentItemIndex = itemIndex;
            }

            function nextItem() {
                if (self.currentItemIndex >= self.items.length - 1) {
                    self.currentItemIndex = self.items.length - 1;
                    return;
                }
                self.currentItemIndex = self.currentItemIndex + 1;
            }

            function previousItem() {
                if (self.currentItemIndex <= 0) {
                    self.currentItemIndex = -1;
                    return;
                }
                self.currentItemIndex = self.currentItemIndex - 1;
            }
            
            function stopEventOnKey(e, keys) {
                if (keys.includes(e.key)) {
                    e.stopPropagation();
                    e.preventDefault();
                }
            }        
        }


        return {
            restrict: 'A',
            scope: {
                // A function that returns the dataset as a promise
                dataSource: '&lilyTypeahead',
                // On change event handler (will be fired on every input change)
                onChange: '&lilyTypeaheadOnChange',
                // On select event handler (will be fired only if an item was (auto)selected)
                onSelect: '&lilyTypeaheadOnSelect',
                // Predicate that returns if a given value should be ignored.
                // If the user enters a value that is 'ignored' that value will show in the input
                // as a normal input but the typeahead/popover will treat this value as an empty string.
                // This means the dropdown will not open automatically and will show an unfiltered list,
                // when opened manually.
                ignoreInput: '&lilyTypeaheadIgnoreInput',
                // Is set to true while results are fetching
                loading: '=lilyTypeaheadLoading',
                // The attribute name that holds the text value
                textAttr: '@lilyTypeaheadTextAttr'
                
            },
            require: '?ngModel',
            link: link,
            controller: TypeaheadCtrl,
            controllerAs: '$ctrl'
        };

        function link(scope, element, attrs, ngModel) {
            var template = $templateCache.get('_typeahead.html');
            var preCompileElement = angular.element(template);

            // Insert element before compile to play nice with aws components
            // https://code.amazon.com/packages/AWS-UI-Components-Angular/blobs/fc1f02d0845a7b973c25eaac4279b09b2e7eb739/--/src/directives/component.ts#L301
            element.after(preCompileElement);

            var typeaheadElement = $compile(preCompileElement)(scope);
            var toggleElement = $(typeaheadElement).find('.lily-typeahead-toggle');

            positionTypeaheadElements(element, typeaheadElement, toggleElement);
            scope.$ctrl.init(ngModel, typeaheadElement);
        }

        function positionTypeaheadElements(inputElement, typeaheadElement, toggleElement) {
            var pos = inputElement.position();
            inputElement.css({
                width: inputElement.outerWidth() - 30,
                paddingRight: 30
            });
            typeaheadElement.css({
                left: pos.left,
                // Should be placed directly under the input with 1px overlap to avoid double border
                top: pos.top + inputElement.outerHeight() - 1,
                minWidth: inputElement.outerWidth()
            });
            toggleElement.css({
                right: 0,
                top: -inputElement.outerHeight(),
                height: inputElement.outerHeight()
            });
        }
    }
}());

(function () {

    'use strict';

    angular
        .module('lily.widgets')
        .directive('alertBanner', alertDirective);

    function alertDirective() {
        return {
            restrict: 'E',
            scope: {
                alertheader: '@alertheader',
                alertlinklabel: '@alertlinklabel',
                alertlinkurl: '@alertlinkurl'
            },
            replace: true,
            templateUrl: 'alert-banner.html'
        };
    }

})();

(function(){
  'use strict';

  angular
    .module("lily.utils", []) // [] param needed because this is the FIRST lily.utils file listed in catalogue
    .factory("asyncUtils", asyncUtils);

  asyncUtils.$inject = ['$q', '$timeout'];

  function asyncUtils($q, $timeout){

    function rateLimit(items, limit, action) {
        var interval = 1000 / limit;
        var startedActions = [];
        var startTime = Date.now();

        function startFrom(index) {
            if (index < items.length) {
                // keep track of started actions, but don't wait for them to finish yet
                startedActions.push(action(items[index]));
                // just wait for interval, then start the next action
                return $timeout(function () {
                    return startFrom(index + 1);
                }, interval);
            }
            else {
                return $q.when(); // we're done
            }
        }

        // start from 0, wait for all actions to be started, then wait for them all to finish
        return startFrom(0).then(function () {
            return $q.all(startedActions);
        });
    }

    return{
      rateLimit: rateLimit
    };
  }
})();
(function(){
  'use strict';

  /**
   * @desc selectionUtils provides the useful function for selecting the html element text
   */
  angular
    .module("lily.utils")
    .factory("selectionUtils", selectionUtils);

  selectionUtils.$inject = ['$document'];

  function selectionUtils($document){
    var documentRef = $document.get(0);
    return{
      isCopyToClipboardSupported: function(){
        try{
          return documentRef.queryCommandSupported("copy") && typeof documentRef.execCommand === "function" ;
        }catch(err){
          //To handle all the security exceptions 
          return false;
        }
      },
      copyToClipboard: function(value){
        if(this.isCopyToClipboardSupported()){
          // TODO add support for element query 
          var isCopied, input = documentRef.createElement("input");
          input.value = value;
          input.className = "lily-hidden-input";
          documentRef.body.appendChild(input);
          input.select();

          try {
            // using the DOM API  - 'execCommand' to copy the selected content.
            // Refer - https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand#Specifications
            isCopied = documentRef.execCommand("copy");
          } catch (err) {
            isCopied = false;
          }
          documentRef.body.removeChild(input);
          return isCopied;
        }
      }
    };
  }

})();
(function(){
  'use strict';

  angular
    .module("lily.utils")
    .factory("lilyLocalization", lilyLocalization);

  lilyLocalization.$inject = [];

  function lilyLocalization(name){    

    var localizedStrings = window.localizedStrings;

    function get(name, module){
      var result = "";
      if(module === undefined){
        for(var key in localizedStrings){
          if(localizedStrings[key][name]){
            
            return localizedStrings[key][name];
          }
        }
      }else{
        var moduleStrings = localizedStrings[module];
        result =  moduleStrings ? moduleStrings[name] : "";
      } 
      return result;
    }
    return{
      getString: get
    };
  }
})();
window.LilyUtils = window.LilyUtils || {};
window.LilyUtils.toBoolean = function(value) {

    if (_.isBoolean(value)) {
        return value;
    } else if (value === "true") {
        return true;
    } else {
        return false;
    }
};

angular.module('Search.SearchController',['EntitySearch.SearchService'])
.controller("SearchController", function SearchController($scope, SearchService, urlEntity, $location) {
    var widget = this;
    this._search = function(callback) {
        var searchCount = ++widget.currentSearch;
        $scope.ongoingSearch = true;
        $scope.isExceptionReturned = false;
        $scope.tokenStack = $scope.tokenStack && $scope.tokenStack.length > 0 ? $scope.tokenStack : [];
        SearchService.search({
                filter: $scope.filter,
                pageSize: $scope.pagination.pageSize,
                nextToken: $scope.pagination.nextToken,
                startIndex: Math.max(0, $scope.pagination.pageSize * ($scope.pagination.pageNumber - 1)),
                urlEntity: urlEntity
            },
            (function success(data) {
                $scope.ongoingSearch = false; // stop spinner before return
                $scope.error = false;
                $scope.errorCount = 0;
                if (searchCount !== widget.currentSearch) {
                    return;
                }
                // If exception returned with status 200, show warning alert
                if (data.exceptionId && data.messageId) {
                    $scope.isExceptionReturned = true;
                    $scope.exceptionWarningMessageId = data.messageId;
                    return;
                }
                var startIndex = ($scope.pagination.pageNumber - 1) * $scope.pagination.pageSize;
                $scope.entities = data.results || [];
                $scope.selection = [];
                $scope.totalEntities = data.searchLength || 0;
                $scope.display = {
                        firstEntity: $scope.totalEntities === 0 ? 0 : startIndex + 1,
                        lastEntity: Math.min(startIndex + $scope.entities.length, $scope.totalEntities),
                        totalEntities: $scope.totalEntities,
                        totalPages: Math.ceil($scope.totalEntities / $scope.pagination.pageSize)
                };
                $scope.pageNumbers = _.range(0,$scope.display.totalPages);
                if ($scope.totalEntities < $scope.display.firstEntity) {
                    $scope.pagination.pageNumber = Math.floor($scope.display.totalEntities / $scope.pagination.pageSize) + 1;
                }

                $scope.tokenStack.push(data.nextToken);

                $location.search($scope.filter);

                if(callback && typeof callback === "function") {
                    callback();
                }
            }),
            (function failure(data) {
                $scope.error = true;
                $scope.ongoingSearch = false;
                ++$scope.errorCount;
                if ($scope.errorCount <= 3) {
                    _.delay(function() {
                        $scope.search();
                    }, 2000);
                }
            })
        );
    };

    angular.extend($scope || {}, {
        search: _.debounce(this._search, 100),
        delaySearch: _.debounce(function(after, before) {
            if(!_.isEqual(after, before)) {
                $scope.ongoingSearch = true;
                $scope.tokenStack = [];
                $scope.pagination.pageNumber = 1;
                $scope.pagination.nextToken = null;
                widget._search();
            }
        }, 500),
        onPageSizeChange: function(after,before) {
            var pageNumber = $scope.pagination.pageNumber - 1;
            var newPageNumber = Math.floor(pageNumber * before / after);
            $scope.pagination.pageNumber = newPageNumber + 1;
            $scope.pagination.nextToken = null;
            if (pageNumber === newPageNumber) {
                $scope.search();
            }
        },
        goToLastPage: function() {
            $scope.pagination.pageNumber--;
        },
        goToNextPage: function() {
            $scope.pagination.pageNumber++;
        },
        setPageSize: function(size) {
            $scope.pagination.pageSize = size;
        },
        getLastToken: function() {
            return $scope.tokenStack && $scope.tokenStack.length > 0 ? $scope.tokenStack[$scope.tokenStack.length-1]: null ;
        },
        goToNextPageWithToken: function() {
            $scope.pagination.pageNumber++;
            $scope.pagination.nextToken = $scope.getLastToken();
            $scope.search();
        },
        goToPreviousWithToken: function() {
            $scope.pagination.pageNumber--;
            $scope.tokenStack.pop();
            $scope.tokenStack.pop();
            $scope.pagination.nextToken = $scope.getLastToken();
            $scope.search();
        },
        retrySearch: function() {
            // Retry one time per button click
            $scope.errorCount -= 1;
            $scope.search();
        },
        isFirstPage: function() {
            return $scope.pagination.pageNumber <= 1;
        },
        isLastPage: function() {
            return $scope.pagination.pageNumber >= $scope.display.totalPages;
        },
        isLastPageWithToken: function() {
            return $scope.getLastToken() === null;
        },
        pagination: {
                pageNumber: 1,
                pageSize: 25,
                pageSizes: [25,50,100],
                nextToken: null
        },
        display: {},
        filter: {},
        recentContacts: {},
        situationalSupportedIds: [],
        ongoingSearch: false,
        pageNumbers: [],
        errorCount: 0,
        isExceptionReturned: false, // exception returned with status code 200
        exceptionWarningMessageId: "" 
    });
    this.currentSearch = 0;
    $scope.$watch("pagination.pageSize", $scope.onPageSizeChange);
    $scope.$watch("pagination.pageNumber", $scope.search);
    $scope.$watch("filter", $scope.delaySearch, true);




    _.extend($scope.filter, $location.search());
});

angular.module("EntitySearch.SearchService", []).factory('SearchService', function($rootScope){
    function search(options, success, failure) {
        var filter = options.filter ? (options.filter.name || "") : "";
        return window.LILY_FLOWS_APP.flowService.list(filter, options.pageSize, options.startIndex)
            .then(success, failure)
            .finally(function () {
                $rootScope.$apply();
            });
    }
    return {
        search: search
    };
});
angular.module("Search.SearchDirectives", [])
.directive("paginationWidget", function() {
    return {
        restrict: 'E',
        replace: true,
        templateUrl: '_paginationWidget.html'
    };
})
.directive("paginationWidgetWithToken", function() {
    return {
        restrict: 'E',
        replace: true,
        templateUrl: '_paginationWidgetWithNextToken.html'
    };
});
$(document).ready(function() {
    function resizePagination() {
        var widget = $('.paginationWidget');
        widget.width(widget.parent().width());
    }
    $(window).resize(resizePagination);
    _.defer(function() { resizePagination(); } );
});
angular.module('Search.PromptSearchController', ['Search.SearchController', 'EntitySearch.SearchService'])
.controller("PromptSearchController", function PromptSearchController($scope, SearchService, urlEntity, $controller) {
    $controller('SearchController', {$scope: $scope, SearchService: SearchService, urlEntity: urlEntity});
    
    SearchService.search(
        {
            filter: "",
            pageSize: $scope.pagination.pageSize,
            startIndex: 0,
            urlEntity: urlEntity
        },
        function success(data){
            if(data.results.length !== 0) {
                $("#angularContainer").show();
            } else {
                $("#ftuMessage").show();
            }
        }
    );
});

angular.module('Search.OwnerAccessSearchController', ['Search.SearchController', 'EntitySearch.SearchService', 'EntitySearch.OwnerAccessSearchService'])
.controller("OwnerAccessSearchController", function OwnerAccessSearchController($scope, $controller, $modal, SearchService, OwnerAccessSearchService, urlEntity) {
    $controller('SearchController', {$scope: $scope, SearchService: SearchService, urlEntity: urlEntity});
    var widget = this;

    angular.extend($scope || {}, {
        toggleSelection: function(ownerAccessId) {
            var idx = $scope.selection.indexOf(ownerAccessId);
            if(idx > -1) {
                $scope.selection.splice(idx, 1);
            } else {
                $scope.selection.push(ownerAccessId);
            }
        },
        deleteModal: function() {
            $scope.cancelDelete = $modal.open({
                templateUrl: '_ownerAccessDeleteModal.html',
                scope: $scope
            }).close;
        },
        deleteOwnerAccess: function() {
            OwnerAccessSearchService.deleteOwnerAccess({deleteIds: $scope.getCheckedAccess()},
                (function success(data) {
                    $scope.cancelDelete();
                    $scope.search();
                    $scope.deleteSuccess = true;
                    $scope.deleteFailure = false;
                }),
                (function failure(data) {
                    $scope.cancelDelete();
                    $scope.deleteFailure = true;
                    $scope.deleteSuccess = false;
                }));
        },
        getCheckedAccess: function() {
            var access = [];
            angular.forEach($scope.entities, function(entity) {
                if ($scope.selection.indexOf(entity.id) > -1) {
                    access.push(entity.id);
                }
            });
            return access.join(",");
        },
        selection: {}
    });
});

angular.module("EntitySearch.OwnerAccessSearchService", ['ngResource']).factory('OwnerAccessSearchService', function($resource, token){
    return $resource('', {}, {
        deleteOwnerAccess: {
            url: document.requestPathPrefix + "/owner-access/delete",
            method: 'POST',
            params: {
                token: token
            }
        }
    });
});
angular.module('Search.SearchController')
.controller("RelatedContactSearchController", function RelatedContactSearchController($scope, $controller, SearchService, urlEntity, recentContactEntityType) {
    $controller('SearchController', {$scope: $scope, SearchService: SearchService, urlEntity: urlEntity});
    angular.extend($scope || {}, {
        recentContactSearch: function(entities) {
            var entityIds = [];
            entities.forEach(function(entity) {
                if (recentContactEntityType === 'entrypoint') {
                    entityIds.push(entity.address);
                    $scope.recentContacts[entity.address] = angular.extend($scope.recentContacts[entity.address] || {}, {
                        ongoingQuery: true
                    });
                } else {
                    entityIds.push(entity.id);
                    $scope.recentContacts[entity.id] = angular.extend($scope.recentContacts[entity.id] || {}, {
                        ongoingQuery: true
                    });
                }
            });
            ++$scope.ongoingContactQueryCount;
            SearchService.searchRecentContacts({
                    entityKeys: entityIds,
                    entityType: recentContactEntityType
                },
                (function success(data) {
                    entities.forEach(function(entity) {
                        if (recentContactEntityType === 'entrypoint') {
                            $scope.recentContacts[entity.address] = {
                                recentContactCount: data[entity.address] || "0",
                                ongoingQuery: false,
                                error: false
                            };
                        } else {
                            $scope.recentContacts[entity.id] = {
                                recentContactCount: data[entity.id] || "0",
                                ongoingQuery: false,
                                error: false
                            };
                        }
                    });
                    --$scope.ongoingContactQueryCount;
                }),
                (function failure(data) {
                    entities.forEach(function(entity) {
                        $scope.recentContacts[entity.id] = angular.extend($scope.recentContacts[entity.id] || {}, {
                            ongoingQuery: false,
                            error: true
                        });
                    });
                    --$scope.ongoingContactQueryCount;
                })
            );
        }
    });
});
angular.module('Search.SearchController')
.controller("NumberSearchController", function NumberSearchController($scope, $controller, $window, SearchService, urlEntity) {
    $controller('RelatedContactSearchController', {$scope: $scope, SearchService: SearchService, urlEntity: urlEntity, recentContactEntityType: 'entrypoint'});
    angular.extend($scope || {}, {
        situationalMessagingClick: function() {
            if ($scope.situationalSupportedIds.length > 0) {
                $window.location = document.requestPathPrefix + '/numbers/' + $scope.situationalSupportedIds.join() + '/emergency';
            }
        },
        onSearchCallback: function() {
            var numbers = $scope.entities;
            $scope.situationalSupportedIds = [];
            for (var i in numbers) {
                for (var j in numbers[i].attributes) {
                    if (numbers[i].attributes[j].key === "SupportedEmergencyFlags") {
                        $scope.situationalSupportedIds.push(numbers[i].id);
                        numbers[i].supportsSituationalMessaging = true;
                    }
                }
            }
        },

        entities: {},
        recentContacts: {},
        ongoingContactQueries: {},
        ongoingContactQueryCount: 0
    });
    $scope.$watch("entities", $scope.onSearchCallback, true);
});

angular.module('Search.SearchController')
.controller("SkillSearchController", function SkillSearchController($scope, $controller, $window, SearchService, urlEntity, $http, token) {
    $controller('SearchController', {$scope: $scope, SearchService: SearchService, urlEntity: urlEntity});
    angular.extend($scope || {}, {
       situationalMessagingClick: function() {
          if ($scope.situationalSupportedIds.length > 0) {
             $window.location = document.requestPathPrefix + '/skills/' + $scope.situationalSupportedIds.join() + '/emergency';
          }
       },
       onSearchCallback: function() {
          var skills = $scope.entities;
          $scope.situationalSupportedIds = [];
          for (var i in skills) {
             for (var j in skills[i].attributes) {
                if (skills[i].attributes[j].key === "SupportedEmergencyFlags") {
                    $scope.situationalSupportedIds.push(skills[i].id);
                    skills[i].supportsSituationalMessaging = true;
                }
             }
          }
       },
       ERRORS : {
          NONE : "OK",
          POST_FAIL : "POST_FAIL",
          QUEUES_OVER_QUOTA : "QUEUES_OVER_QUOTA",
          CAPACITY_OVER_QUOTA : "CAPACITY_OVER_QUOTA"
       },
       entities: {},
       recentContacts: {},
       ongoingContactQueries: {},
       ongoingContactQueryCount: 0,
       ajaxSpinnerVisible: false,
       onflipActive : function(skill) {
          $scope.queueObject = skill;

          if($scope.queueObject.online) {
             $scope.deleteModalVisible = true;
          }
          if(!$scope.queueObject.online) {
             $scope.ajaxSpinnerVisible = true;
             $scope.deleteModalVisible = false;
             $scope.postError = $scope.ERRORS.NONE;
                // Activate
                $http.post(
                   document.requestPathPrefix + "/queues/activate",
                      {id : $scope.queueObject.id, token: token, offlineReason: ""}
                ).then(
                   function(response) {
                      $scope.queueObject.online = true;
                      $scope.ajaxSpinnerVisible = false;
                      $scope.ongoingOperation = false;
                   },
                   function(response) {
                      $scope.ajaxSpinnerVisible = false;
                      $scope.postError = $scope.ERRORS.POST_FAIL;
                      $scope.ongoingOperation = false;
                   }
                );
          }
       },
       onDeleteModalConfirm : function() {
          $scope.ajaxSpinnerVisible = true;
          $scope.postError = $scope.ERRORS.NONE;
          $scope.ongoingOperation = true;

          // Deactivate
          $http.post(
             document.requestPathPrefix + "/queues/deactivate",
             {id : $scope.queueObject.id, token: token, offlineReason: ""}
          ).then(
             function(response) {
                $scope.queueObject.online = false;
                $scope.ajaxSpinnerVisible = false;
                $scope.ongoingOperation = false;
             },
             function(response) {
                $scope.ajaxSpinnerVisible = false;
                $scope.postError = $scope.ERRORS.POST_FAIL;
                $scope.ongoingOperation = false;
             }
          );
          $scope.onCloseDeleteModal();
       },
       onDeleteBack : function() {
          $scope.onDeleteModalCancel();
       },
       onDeleteModalCancel : function() {
          $scope.onCloseDeleteModal();
       },
       onCloseDeleteModal : function() {
          $scope.deleteModalVisible = false;
       }
    });
});
angular.module('Search.BlockAuditSearchController', ['Search.SearchController'])
.controller("BlockAuditSearchController", function BlockAuditSearchController($scope, $controller, $filter, SearchService, urlEntity, startDate) {
    $controller('SearchController', {$scope: $scope, SearchService: SearchService, urlEntity: urlEntity});
    // Don't override the stuff provided by $location in the base controller
    angular.extend($scope.filter, {
        startDate: $scope.filter.startDate || startDate,
        endDate: $scope.filter.endDate || startDate
    });
    angular.extend($scope, {
        verifyStartAndEnd: function() {
            // start - end > 0 -> start is after end
            $scope.invalidRange = (new Date($scope.filter.startDate) - new Date($scope.filter.endDate) > 0);
        }
    });
    $scope.$watch("filter.startDate", function() {
        $scope.filter.startDate = $filter('date')($scope.filter.startDate, 'yyyy-MM-dd');
        $scope.verifyStartAndEnd();
    });
    $scope.$watch("filter.endDate", function() {
        $scope.filter.endDate = $filter('date')($scope.filter.endDate, 'yyyy-MM-dd');
        $scope.verifyStartAndEnd();
    });
});

!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){/*! Portions adapted from tether v1.1.0 | MIT License | github.com/HubSpot/tether */
"use strict";function d(a,b){if("undefined"!=typeof a.classList)b.split(" ").forEach(function(b){b.trim()&&a.classList.add(b)});else if(!f(a,b)){var c=a.className+(" "+b);g(a,c)}}function e(a,b){if("undefined"!=typeof a.classList)b.split(" ").forEach(function(b){b.trim()&&a.classList.remove(b)});else{var c=new RegExp("(^| )"+b.split(" ").join("|")+"( |$)","gi"),d=a.className.replace(c," ");g(a,d)}}function f(a,b){return"undefined"!=typeof a.classList?a.classList.contains(b):new RegExp("(^| )"+b+"( |$)","gi").test(a.className)}function g(a,b){a.setAttribute("class",b)}c.addClass=d,c.removeClass=e,c.hasClass=f},{}],2:[function(a,b,c){"use strict";function d(a,b){if(!a||""===a.trim()||!b)throw new Error("Expect a component name and custom element definition");if(k[a])throw new Error("A component with the name "+a+" is already registered (AWS-init)");var d=h.createComponentPrototype(a,b);k[a]=d,c.__componentDefinitions[a]=b}function e(a){if(!g.isNodeOrCollection(a))throw new Error("Expect an array of Nodes or a single Node");a instanceof Node&&(a=[a]);for(var b=0,c=a;b<c.length;b++){var d=c[b],e=k[d.nodeName.toLowerCase()];d.component=Object.create(e),d.component.node=d,d.component.hasBeenCreated()}}function f(a){if(void 0===a||""===a.trim())throw new Error("No name given");if(!k[a])throw new Error("There is no component with the name "+a);this.__internalCreate=!0;var b=document.createElement(a);return this.__internalCreate=!1,e(b),b}var g=a("./utils"),h=a("./BasePrototype"),i=a("./Metrics"),j=a("./AwsUi.DomUtils"),k={};c.__componentDefinitions={},c.__addComponent=d,c.activate=e,c.createComponent=f,c.__Metrics=i.publicAPI,c.__DomUtils=j},{"./AwsUi.DomUtils":1,"./BasePrototype":3,"./Metrics":13,"./utils":15}],3:[function(a,b,c){"use strict";function d(){for(var a={},b=0,c=m;b<c.length;b++){var d=c[b];d.prototypeAdditions&&f.mixin(a,d.prototypeAdditions)}return a}function e(a,b){var c=Object.create(n);c.__componentName=a;for(var d=0,e=m;d<e.length;d++){var f=e[d];f.extendComponent&&f.extendComponent(c,b)}return c}var f=a("./utils"),g=a("./BasePrototype/PropertyHandling"),h=a("./BasePrototype/EventHandling"),i=a("./BasePrototype/FunctionHandling"),j=a("./BasePrototype/LifecycleHandling"),k=a("./BasePrototype/RegionHandling"),l=a("./BasePrototype/RenderHandling"),m=[i,j,h,k,g,l],n=d();c.createComponentPrototype=e},{"./BasePrototype/EventHandling":4,"./BasePrototype/FunctionHandling":5,"./BasePrototype/LifecycleHandling":6,"./BasePrototype/PropertyHandling":7,"./BasePrototype/RegionHandling":9,"./BasePrototype/RenderHandling":10,"./utils":15}],4:[function(a,b,c){"use strict";function d(a,b){a.__events=b.events||{}}var e,f=a("../utils");!function(a){function b(a,b){void 0===b&&(b={});var c=this.__events[a];if(!c)throw new Error("No such event defined: "+a);return e(this,a,b,c.bubbles,c.cancelable)}function c(a){var b=g(a),c={newValue:this[a]};e(this,b,c,!0,!1)}function d(a,b){var c=g(a);this.node.addEventListener("awsui:"+c,function(a){return b(a.detail.newValue,a.target)})}function e(a,b,c,d,e){var g="awsui:",h=f.createCustomEvent(g+b,c,d,e);return a.node.dispatchEvent(h),h}var g=function(a){return"__"+a.toLowerCase()+"change"};a.__fireEvent=b,a.__firePropertyChangeEvent=c,a.__listenToPropertyChanges=d}(e=c.prototypeAdditions||(c.prototypeAdditions={})),c.extendComponent=d},{"../utils":15}],5:[function(a,b,c){"use strict";function d(a,b){var c=b.functions||{};e.mixin(a,c)}var e=a("../utils");c.extendComponent=d},{"../utils":15}],6:[function(a,b,c){"use strict";function d(a,b){var c=["initialized","attached","detached"],d=b.callbacks||{};for(var e in d)if(c.indexOf(e)===-1)throw new Error("Undefined callback "+e+" for component");a.__callbacks=d}var e,f=a("../Metrics"),g=function(a){var b=a.__propertiesDefinition;for(var c in b)b[c].announceValue&&a.__firePropertyChangeEvent(c)};!function(a){function b(){this.__created=!1,this.__defineRegions(),this.__defineProperties(),this.__created=!0,this.__callbacks.initialized&&this.__callbacks.initialized.apply(this),this.__update()}function c(){if("detached"===this.__componentState)throw new Error("Detach called while component is already detached");this.__componentState="detached",this.__callbacks.detached&&this.__callbacks.detached.apply(this)}function d(){if("attached"===this.__componentState)throw new Error("Attach called while component is already attached");if(!document.body.contains(this.node))throw new Error("Node should be part of DOM when calling attached!");g(this),this.__componentState="attached",this.node.setAttribute("initialized",!0),this.__callbacks.attached&&this.__callbacks.attached.apply(this),f.__logComponentUsed(this.node.tagName)}a.hasBeenCreated=b,a.hasBeenDetached=c,a.hasBeenAttached=d}(e=c.prototypeAdditions||(c.prototypeAdditions={})),c.extendComponent=d},{"../Metrics":13}],7:[function(a,b,c){"use strict";function d(a,b){var c=b.properties||{};a.__propertiesDefinition=c;var d=b.regions?Object.keys(b.regions):[];d.forEach(function(a){c[a]={type:"region",onChange:function(b,c){this.__setRegion(a,c)}}});var e=function(b,c){var d=a.__propertiesDefinition[b];return function(){var a=this;if(!d.__readable)throw new Error('Tried to access write-only property "'+b+'"');return c.call(this,function(){return a.__properties[b]})}},g=function(b,c){var d=a.__propertiesDefinition[b];return function(a){var e=this;if(!d.__writable)throw new Error('Tried to modify read-only property "'+b+'"');var g=f[d.type];g.validate(a,b,d);var h;d.__readable&&(h=this[b],!g.complexType&&h===a)||(c.call(this,a,function(a){e.__properties[b]=a}),this.__created&&("function"==typeof d.onChange&&d.onChange.call(this,h,a),this.__update(),d.announceValue===!0&&this.__firePropertyChangeEvent(b)))}},h=function(a){return function(){return this.__properties[a]}},i=function(a){return function(b){this.__properties[a]=b}};for(var j in a.__propertiesDefinition){var k=a.__propertiesDefinition[j],l={};k.type=k.type||"string";var m=f[k.type];if(!m)throw new Error('No such type "'+k.type+'" for property '+j);var n=k.setter,o=k.getter;n||o||(n=i(j),o=h(j)),k.__writable=Boolean(n),k.__readable=Boolean(o),l.get=e(j,o),l.set=g(j,n),Object.defineProperty(a,j,l)}}var e,f=a("./PropertyTypes");!function(a){function b(){this.__properties={};for(var a in this.__propertiesDefinition){var b=this.__propertiesDefinition[a],c=f[b.type],d=c.getDefaultValue(b);b.__writable&&(this[a]=d)}}function c(a,b){var c=this.__propertiesDefinition[a],d=f[c.type];if(d.fromAttribute){var e;e=null===b?d.getDefaultValue(c):d.fromAttribute(b,a),this[a]!==e&&(this[a]=e)}}a.__defineProperties=b,a.__setFromString=c}(e=c.prototypeAdditions||(c.prototypeAdditions={})),c.extendComponent=d},{"./PropertyTypes":8}],8:[function(a,b,c){"use strict";var d;!function(a){function b(a){return a}function c(a,b,c){if(void 0===a||null===a){if(c.nullable!==!1)return;throw new Error("Property "+b+" cannot be null or undefined")}if("string"!=typeof a)throw new Error('Property "'+b+'" must be a string, got "'+a+'" ('+typeof a+") instead");if(c.valid&&c.valid.indexOf(a)===-1)throw new TypeError(b+" can only have the following values: "+c.valid.join(", ")+' (was "'+a+'")')}function d(a){return a.defaultValue}a.fromAttribute=b,a.validate=c,a.getDefaultValue=d}(d||(d={}));var e;!function(a){function b(a,b){if("true"===a)return!0;if("false"===a)return!1;throw new Error('Attribute "'+b+'" must be "true" or "false", got "'+a+'" ('+typeof a+") instead")}function c(a,b){if("boolean"!=typeof a)throw new Error('Property "'+b+'" must be true or false, got "'+a+'" ('+typeof a+") instead")}function d(a){return Boolean(a.defaultValue)}a.fromAttribute=b,a.validate=c,a.getDefaultValue=d}(e||(e={}));var f;!function(a){function b(a){if(isNaN(a))return!1;var b=a.match(/^[0-9\.-]+$/);return!!b}function c(a,c){if(null===a)return null;if(!b(a))throw new Error('Attribute "'+c+'" does not specify a valid number, was "'+a+'"');return parseFloat(a)}function d(a,b){if(null===a||void 0===a)return null;if("number"!=typeof a)throw new Error('Property "'+b+'" must be a number, was "'+a+'" ('+typeof a+")");if(!isFinite(a))throw new Error('Property "'+b+'" only allows for finite numbers, got "'+a+'" instead')}function e(a){return a.defaultValue}a.fromAttribute=c,a.validate=d,a.getDefaultValue=e}(f||(f={}));var g;!function(a){function b(a){return a}function c(a){}function d(a){return a.defaultValue}a.fromAttribute=b,a.validate=c,a.getDefaultValue=d}(g||(g={}));var h;!function(a){function b(a,b){throw new Error('Attribute "'+b+"\" can't be set as string.")}function c(a){}function d(a){}a.complexType=!0,a.fromAttribute=b,a.validate=c,a.getDefaultValue=d}(h||(h={}));var i;!function(a){function b(a,b){throw new Error('Attribute "'+b+"\" can't be set as string.")}function c(a,b){if(!Array.isArray(a))throw new Error('Property "'+b+'" must be an array'+(", was "+a+" ("+typeof a+")"))}function d(a){return[]}a.complexType=!0,a.fromAttribute=b,a.validate=c,a.getDefaultValue=d}(i||(i={})),c.string=d,c.boolean=e,c.region=g,c.object=h,c.array=i,c.integer=f,c.float=f},{}],9:[function(a,b,c){"use strict";function d(a,b){var c=b.regions||{};a.__regionDefinition=c}var e;!function(a){function b(){this.__regions={};for(var a in this.__regionDefinition){var b=this.__regionDefinition[a];b.isDefault&&(this.__defaultRegionName=a),this.__regions[a]={isDefault:b.isDefault}}return this.__regions}function c(a,b){return h(this,a),"string"==typeof b&&(b=document.createTextNode(b)),b?(this.__regions[a].innerContent=b,this.__update()):this.__removeRegion(a),this.__regions[a].innerContent}function d(a,b){if(0===Object.keys(this.__regions).length)throw new Error('Trying to set a region "'+a+'" on the component '+('"'+this.__componentName+'" but it does not have regions'));h(this,a),this[a]=b}function e(a){if(!this.__defaultRegionName)throw new Error("Trying to set a default region on the component "+('"'+this.__componentName+'" but it does not have a default region'));this.setRegion(this.__defaultRegionName,a)}function f(a){this.__regions[a]&&(this.__regions[a].innerContent=void 0,this.__update())}function g(a){var b=this;b[a]=void 0}function h(a,b){if(!a.__regions[b])throw new TypeError("The component has no region called: "+b)}function i(a,b){return h(this,a),this[a]}a.__defineRegions=b,a.__setRegion=c,a.setRegion=d,a.setDefaultRegion=e,a.__removeRegion=f,a.removeRegion=g,a.getRegion=i}(e=c.prototypeAdditions||(c.prototypeAdditions={})),c.extendComponent=d},{}],10:[function(a,b,c){"use strict";function d(a,b){a.__render=b.render}function e(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];return g(a,b,c)}var f,g=a("mithril"),h=a("../MithrilHelpers");!function(a){function b(){var a=new h.default(this);g.render(this.node,this.__render(g,a))}a.__update=b}(f=c.prototypeAdditions||(c.prototypeAdditions={})),c.extendComponent=d,c.__createElement=e},{"../MithrilHelpers":14,mithril:16}],11:[function(a,b,c){"use strict";function d(){c.isIE=Boolean(navigator.userAgent.match(/MSIE|Trident/)),c.inputEvent=!c.isIE}c.detect=d,d()},{}],12:[function(a,b,c){"use strict";var d=function(){function a(a){this.classNameSet={},this.component=a}return a.prototype.addClass=function(a,b){var c;return c=arguments.length<2||!!b,a&&c&&(this.classNameSet[a]=!0),this},a.prototype.addPropertyValueClass=function(a,b){var c=this.component,d=c[a];if(d){var e=c.__componentName+"-"+a+"-"+d;arguments.length<2?this.addClass(e):this.addClass(e,b)}return this},a.prototype.toClassName=function(){var a=Object.keys(this.classNameSet);return a.sort(),a.join(" ")},a}();c.ClassBuilder=d},{}],13:[function(a,b,c){"use strict";function d(a,b,c){if("object"==typeof window.AWSC&&"object"==typeof window.AWSC.Clog&&"function"==typeof window.AWSC.Clog.log){if(window.AwsUi.debug&&!/^[a-zA-Z0-9_-]{1,32}$/.test(a))throw new Error("Invalid metric name: "+a);window.AWSC.Clog.log(a,b,c)}}function e(a,b,c){g[a]||(d(a,b,c),g[a]=!0)}function f(a){c.publicAPI.sendMetricOnce(a.toLowerCase()+"-used",1)}c.sendMetric=d;var g={};c.sendMetricOnce=e,c.__logComponentUsed=f,c.publicAPI={sendMetric:d,sendMetricOnce:e}},{}],14:[function(a,b,c){"use strict";function d(a,b){b&&Object.keys(b).forEach(function(c){return a[c]=b[c]})}function e(a,b){b&&Object.keys(b).forEach(function(c){return a.setRegion(c,b[c])})}function f(a,b){b&&Object.keys(b).forEach(function(c){return a.node.addEventListener(c,b[c])})}function g(a,b){d(a,b.properties),e(a,b.regions)}function h(a,b){AwsUi.activate(a),g(a.component,b),f(a.component,b.events),a.component.hasBeenAttached()}var i=a("mithril"),j=a("./ClassBuilder"),k=a("./BrowserCapabilities"),l=function(){function a(a){this.browserCapabilities=k,this.ClassBuilder=j.ClassBuilder,this.component=a}return a.prototype.createComponent=function(a,b,c){var d={config:function(a,c,d){return c||"true"===a.getAttribute("initialized")?void g(a.component,b):(h(a,b),void(d.onunload=function(){return a.component.hasBeenDetached()}))}};return i(a,d,c)},a.prototype.region=function(a,b,c){void 0===b&&(b="div"),void 0===c&&(c={});var d=this.component.getRegion(a);if(d)return c["region-container"]=a,"string"==typeof d?i(b,c,d):(c.config=function(a,b,c){a.childNodes[0]!==d&&(a.innerHTML="",a.appendChild(d))},i(b,c))},a.prototype.copyDefined=function(a,b){function c(b,c){var d=a[c];return"undefined"!=typeof d&&(b[c]=d),b}return void 0===b&&(b=Object.keys(a)),b.reduce(c,{})},a.prototype.newEventHandler=function(a,b){var c=this;return function(d){if(!b||b.call(c.component,d)!==!1){var e=c.component.__fireEvent(a);e.defaultPrevented&&d.preventDefault()}}},a.prototype.newDeferredEventHandler=function(a,b){var c=this.newEventHandler(a,b);return function(a){setTimeout(function(){return c(a)},0)}},a}();Object.defineProperty(c,"__esModule",{value:!0}),c.default=l},{"./BrowserCapabilities":11,"./ClassBuilder":12,mithril:16}],15:[function(a,b,c){"use strict";function d(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}function e(a,b,c,d){if(void 0===c&&(c=!0),void 0===d&&(d=!0),"function"==typeof CustomEvent)return new CustomEvent(a,{detail:b,bubbles:c,cancelable:d});var e=document.createEvent("CustomEvent");e.initCustomEvent(a,c,d,b);var f=e.preventDefault;return e.preventDefault=function(){if(e.cancelable){f.call(e);try{Object.defineProperty(e,"defaultPrevented",{get:function(){return!0}})}catch(a){}}},e}function f(a){return a instanceof Node||a instanceof NodeList||Array.isArray(a)||a instanceof HTMLCollection}c.mixin=d,c.createCustomEvent=e,c.isNodeOrCollection=f},{}],16:[function(a,b,c){/*! mithril.js v0.1.34 | MIT License | github.com/lhorie/mithril.js */
var d=function a(b,c){
// self invoking function needed because of the way mocks work
function d(a){C=a.document,D=a.location,F=a.cancelAnimationFrame||a.clearTimeout,E=a.requestAnimationFrame||a.setTimeout}/**
	 * @typedef {String} Tag
	 * A string that looks like -> div.classname#id[param=one][param2=two]
	 * Which describes a DOM node
	 */
/**
	 *
	 * @param {Tag} The DOM node tag
	 * @param {Object=[]} optional key-value pairs to be mapped to DOM attrs
	 * @param {...mNode=[]} Zero or more Mithril child nodes. Can be an array, or splat (optional)
	 *
	 */
function e(){var a,b=[].slice.call(arguments),c=!(null==b[1]||K.call(b[1])!==G||"tag"in b[1]||"subtree"in b[1]),d=c?b[1]:{},e="class"in d?"class":"className",f={tag:"div",attrs:{}},g=[];if(K.call(b[0])!=I)throw new Error("selector in m(selector, attrs, children) should be a string");for(;a=L.exec(b[0]);)if(""===a[1]&&a[2])f.tag=a[2];else if("#"===a[1])f.attrs.id=a[2];else if("."===a[1])g.push(a[2]);else if("["===a[3][0]){var h=M.exec(a[3]);f.attrs[h[1]]=h[3]||!h[2]||""}g.length>0&&(f.attrs[e]=g.join(" "));var i=c?b.slice(2):b.slice(1);1===i.length&&K.call(i[0])===H?f.children=i[0]:f.children=i;for(var j in d)if(j===e){var k=f.attrs[j];f.attrs[j]=(k&&d[j]?k+" ":k||"")+d[j]}else f.attrs[j]=d[j];return f}function f(a,b,d,j,l,m,n,o,p,q,r){
//`build` is a recursive function that manages creation/diffing/removal of DOM elements based on comparison between `data` and `cached`
//the diff algorithm can be summarized as this:
//1 - compare `data` and `cached`
//2 - if they are different, copy `data` to `cached` and update the DOM based on what the difference is
//3 - recursively apply this algorithm for every array and for the children of every virtual element
//the `cached` data structure is essentially the same as the previous redraw's `data` data structure, with a few additions:
//- `cached` always has a property called `nodes`, which is a list of DOM elements that correspond to the data represented by the respective virtual element
//- in order to support attaching `nodes` as a property of `cached`, `cached` is *always* a non-primitive object, i.e. if the data was a string, then cached is a String instance. If data was `null` or `undefined`, cached is `new String("")`
//- `cached also has a `configContext` property, which is the state storage object exposed by config(element, isInitialized, context)
//- when `cached` is an Object, it represents a virtual element; when it's an Array, it represents a list of elements; when it's a String, Number or Boolean, it represents a text node
//`parentElement` is a DOM element used for W3C DOM API calls
//`parentTag` is only used for handling a corner case for textarea values
//`parentCache` is used to remove nodes in some multi-node cases
//`parentIndex` and `index` are used to figure out the offset of nodes. They're artifacts from before arrays started being flattened and are likely refactorable
//`data` and `cached` are, respectively, the new and old nodes being diffed
//`shouldReattach` is a flag indicating whether a parent node was recreated (if so, and if this node is reused, then this node must reattach itself to the new parent)
//`editable` is a flag that indicates whether an ancestor is contenteditable
//`namespace` indicates the closest HTML namespace as it cascades down from an ancestor
//`configs` is a list of config functions to run after the topmost `build` call finishes running
//there's logic that relies on the assumption that null and undefined data are equivalent to empty strings
//- this prevents lifecycle surprises from procedural helpers that mix implicit and explicit return statements (e.g. function foo() {if (cond) return m("div")}
//- it simplifies diffing code
//data.toString() is null if data is the return value of Console.log in Firefox
try{null!=l&&null!=l.toString()||(l="")}catch(a){l=""}if("retain"===l.subtree)return m;var s=K.call(m),t=K.call(l);if(null==m||s!==t){if(null!=m)if(d&&d.nodes){var u=o-j,v=u+(t===H?l:m.nodes).length;i(d.nodes.slice(u,v),d.slice(u,v))}else m.nodes&&i(m.nodes,m);m=new l.constructor,m.tag&&(m={}),//if constructor creates a virtual dom element, use a blank object as the base cached node instead of copying the virtual el (#277)
m.nodes=[]}if(t===H){
//recursively flatten array
for(var w=0,x=l.length;w<x;w++)K.call(l[w])===H&&(l=l.concat.apply([],l),w--,//check current index again and flatten until there are no more nested arrays at that index
x=l.length);for(var y=[],z=m.length===l.length,A=0,B=1,D=2,E=3,F={},L=!1,w=0;w<m.length;w++)m[w]&&m[w].attrs&&null!=m[w].attrs.key&&(L=!0,F[m[w].attrs.key]={action:B,index:w});for(var M=0,w=0,x=l.length;w<x;w++)if(l[w]&&l[w].attrs&&null!=l[w].attrs.key){for(var O=0,x=l.length;O<x;O++)l[O]&&l[O].attrs&&null==l[O].attrs.key&&(l[O].attrs.key="__mithril__"+M++);break}if(L){var P=!1;if(l.length!=m.length)P=!0;else for(var Q,R,w=0;Q=m[w],R=l[w];w++)if(Q.attrs&&R.attrs&&Q.attrs.key!=R.attrs.key){P=!0;break}if(P){for(var w=0,x=l.length;w<x;w++)if(l[w]&&l[w].attrs&&null!=l[w].attrs.key){var S=l[w].attrs.key;F[S]?F[S]={action:E,index:w,from:F[S].index,element:m.nodes[F[S].index]||C.createElement("div")}:F[S]={action:D,index:w}}var T=[];for(var U in F)T.push(F[U]);var V=T.sort(g),W=new Array(m.length);W.nodes=m.nodes.slice();for(var X,w=0;X=V[w];w++){if(X.action===B&&(i(m[X.index].nodes,m[X.index]),W.splice(X.index,1)),X.action===D){var Y=C.createElement("div");Y.key=l[X.index].attrs.key,a.insertBefore(Y,a.childNodes[X.index]||null),W.splice(X.index,0,{attrs:{key:l[X.index].attrs.key},nodes:[Y]}),W.nodes[X.index]=Y}X.action===E&&(a.childNodes[X.index]!==X.element&&null!==X.element&&a.insertBefore(X.element,a.childNodes[X.index]||null),W[X.index]=m[X.from],W.nodes[X.index]=X.element)}m=W}}
//end key algorithm
for(var w=0,Z=0,x=l.length;w<x;w++){
//diff each item in the array
var $=f(a,b,m,o,l[w],m[Z],n,o+A||A,p,q,r);$!==c&&($.nodes.intact||(z=!1),
//fix offset of next element if item was a trusted string w/ more than one html element
//the first clause in the regexp matches elements
//the second clause (after the pipe) matches text nodes
A+=$.$trusted?($.match(/<[^\/]|\>\s*[^<]/g)||[0]).length:K.call($)===H?$.length:1,m[Z++]=$)}if(!z){
//diff the array itself
//update the list of DOM nodes by collecting the nodes from each item
for(var w=0,x=l.length;w<x;w++)null!=m[w]&&y.push.apply(y,m[w].nodes);
//remove items from the end of the array if the new array is shorter than the old one
//if errors ever happen here, the issue is most likely a bug in the construction of the `cached` data structure somewhere earlier in the program
for(var _,w=0;_=m.nodes[w];w++)null!=_.parentNode&&y.indexOf(_)<0&&i([_],[m[w]]);l.length<m.length&&(m.length=l.length),m.nodes=y}}else if(null!=l&&t===G){l.attrs||(l.attrs={}),m.attrs||(m.attrs={});var aa=Object.keys(l.attrs),ba=aa.length>("key"in l.attrs?1:0);if(
//if an element is different enough from the one in cache, recreate it
(l.tag!=m.tag||aa.join()!=Object.keys(m.attrs).join()||l.attrs.id!=m.attrs.id||"all"==e.redraw.strategy()&&m.configContext&&m.configContext.retain!==!0||"diff"==e.redraw.strategy()&&m.configContext&&m.configContext.retain===!1)&&(m.nodes.length&&i(m.nodes),m.configContext&&typeof m.configContext.onunload===J&&m.configContext.onunload()),K.call(l.tag)!=I)return;var _,ca=0===m.nodes.length;
//schedule configs to be called. They are called after `build` finishes running
if(l.attrs.xmlns?q=l.attrs.xmlns:"svg"===l.tag?q="http://www.w3.org/2000/svg":"math"===l.tag&&(q="http://www.w3.org/1998/Math/MathML"),ca?(_=l.attrs.is?q===c?C.createElement(l.tag,l.attrs.is):C.createElementNS(q,l.tag,l.attrs.is):q===c?C.createElement(l.tag):C.createElementNS(q,l.tag),m={tag:l.tag,
//set attributes first, then create children
attrs:ba?h(_,l.tag,l.attrs,{},q):l.attrs,children:null!=l.children&&l.children.length>0?f(_,l.tag,c,c,l.children,m.children,!0,0,l.attrs.contenteditable?_:p,q,r):l.children,nodes:[_]},m.children&&!m.children.nodes&&(m.children.nodes=[]),
//edge case: setting value on <select> doesn't work before children exist, so set it again after children have been created
"select"===l.tag&&l.attrs.value&&h(_,l.tag,{value:l.attrs.value},{},q),a.insertBefore(_,a.childNodes[o]||null)):(_=m.nodes[0],ba&&h(_,l.tag,l.attrs,m.attrs,q),m.children=f(_,l.tag,c,c,l.children,m.children,!1,0,l.attrs.contenteditable?_:p,q,r),m.nodes.intact=!0,n===!0&&null!=_&&a.insertBefore(_,a.childNodes[o]||null)),typeof l.attrs.config===J){var da=m.configContext=m.configContext||{retain:"diff"==e.redraw.strategy()||c},ea=function(a,b){return function(){return a.attrs.config.apply(a,b)}};r.push(ea(l,[_,!ca,da,m]))}}else if(typeof l!=J){
//handle text nodes
var y;0===m.nodes.length?(l.$trusted?y=k(a,o,l):(y=[C.createTextNode(l)],a.nodeName.match(N)||a.insertBefore(y[0],a.childNodes[o]||null)),m="string number boolean".indexOf(typeof l)>-1?new l.constructor(l):l,m.nodes=y):m.valueOf()!==l.valueOf()||n===!0?(y=m.nodes,p&&p===C.activeElement||(l.$trusted?(i(y,m),y=k(a,o,l)):
//corner case: replacing the nodeValue of a text node that is a child of a textarea/contenteditable doesn't work
//we need to update the value property of the parent textarea or the innerHTML of the contenteditable element instead
"textarea"===b?a.value=l:p?p.innerHTML=l:((1===y[0].nodeType||y.length>1)&&(//was a trusted string
i(m.nodes,m),y=[C.createTextNode(l)]),a.insertBefore(y[0],a.childNodes[o]||null),y[0].nodeValue=l)),m=new l.constructor(l),m.nodes=y):m.nodes.intact=!0}return m}function g(a,b){return a.action-b.action||a.index-b.index}function h(a,b,c,d,e){for(var f in c){var g=c[f],h=d[f];if(f in d&&h===g)"value"===f&&"input"===b&&a.value!=g&&(a.value=g);else{d[f]=g;try{
//`config` isn't a real attributes, so ignore it
if("config"===f||"key"==f)continue;if(typeof g===J&&0===f.indexOf("on"))a[f]=l(g,a);else if("style"===f&&null!=g&&K.call(g)===G){for(var i in g)null!=h&&h[i]===g[i]||(a.style[i]=g[i]);for(var i in h)i in g||(a.style[i]="")}else null!=e?"href"===f?a.setAttributeNS("http://www.w3.org/1999/xlink","href",g):"className"===f?a.setAttribute("class",g):a.setAttribute(f,g):f in a&&"list"!==f&&"style"!==f&&"form"!==f&&"type"!==f&&"width"!==f&&"height"!==f?
//#348 don't set the value if not needed otherwise cursor placement breaks in Chrome
"input"===b&&a[f]===g||(a[f]=g):a.setAttribute(f,g)}catch(a){
//swallow IE's invalid argument errors to mimic HTML's fallback-to-doing-nothing-on-invalid-attributes behavior
if(a.message.indexOf("Invalid argument")<0)throw a}}}return d}function i(a,b){for(var c=a.length-1;c>-1;c--)if(a[c]&&a[c].parentNode){try{a[c].parentNode.removeChild(a[c])}catch(a){}//ignore if this fails due to order of events (see http://stackoverflow.com/questions/21926083/failed-to-execute-removechild-on-node)
b=[].concat(b),b[c]&&j(b[c])}0!=a.length&&(a.length=0)}function j(a){if(a.configContext&&typeof a.configContext.onunload===J&&(a.configContext.onunload(),a.configContext.onunload=null),a.children)if(K.call(a.children)===H)for(var b,c=0;b=a.children[c];c++)j(b);else a.children.tag&&j(a.children)}function k(a,b,c){var d=a.childNodes[b];if(d){var e=1!=d.nodeType,f=C.createElement("span");e?(a.insertBefore(f,d||null),f.insertAdjacentHTML("beforebegin",c),a.removeChild(f)):d.insertAdjacentHTML("beforebegin",c)}else a.insertAdjacentHTML("beforeend",c);for(var g=[];a.childNodes[b]!==d;)g.push(a.childNodes[b]),b++;return g}function l(a,b){return function(c){c=c||event,e.redraw.strategy("diff"),e.startComputation();try{return a.call(b,c)}finally{aa()}}}function m(a){var b=Q.indexOf(a);return b<0?Q.push(a)-1:b}function n(a){var b=function(){return arguments.length&&(a=arguments[0]),a};return b.toJSON=function(){return a},b}function o(){for(var a,b=0;a=T[b];b++)V[b]&&e.render(a,U[b].view?U[b].view(V[b]):$());
//after rendering within a routed context, we need to scroll back to the top, and fetch the document title for history.pushState
Y&&(Y(),Y=null),W=null,X=new Date,e.redraw.strategy("diff")}function p(a){return a.slice(da[e.route.mode].length)}function q(a,b,c){ba={};var d=c.indexOf("?");d!==-1&&(ba=u(c.substr(d+1,c.length)),c=c.substr(0,d));
// Get all routes and check if there's
// an exact match for the current path
var f=Object.keys(b),g=f.indexOf(c);if(g!==-1)return e.module(a,b[f[g]]),!0;for(var h in b){if(h===c)return e.module(a,b[h]),!0;var i=new RegExp("^"+h.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(i.test(c))return c.replace(i,function(){for(var c=h.match(/:[^\/]+/g)||[],d=[].slice.call(arguments,1,-2),f=0,g=c.length;f<g;f++)ba[c[f].replace(/:|\./g,"")]=decodeURIComponent(d[f]);e.module(a,b[h])}),!0}}function r(a){if(a=a||event,!a.ctrlKey&&!a.metaKey&&2!==a.which){a.preventDefault?a.preventDefault():a.returnValue=!1;for(var b=a.currentTarget||a.srcElement,c="pathname"===e.route.mode&&b.search?u(b.search.slice(1)):{};b&&"A"!=b.nodeName.toUpperCase();)b=b.parentNode;e.route(b[e.route.mode].slice(da[e.route.mode].length),c)}}function s(){"hash"!=e.route.mode&&D.hash?D.hash=D.hash:b.scrollTo(0,0)}function t(a,b){var d={},e=[];for(var f in a){var g=b?b+"["+f+"]":f,h=a[f],i=K.call(h),j=null===h?encodeURIComponent(g):i===G?t(h,g):i===H?h.reduce(function(a,b){return d[g]||(d[g]={}),d[g][b]?a:(d[g][b]=!0,a.concat(encodeURIComponent(g)+"="+encodeURIComponent(b)))},[]).join("&"):encodeURIComponent(g)+"="+encodeURIComponent(h);h!==c&&e.push(j)}return e.join("&")}function u(a){for(var b=a.split("&"),c={},d=0,e=b.length;d<e;d++){var f=b[d].split("="),g=decodeURIComponent(f[0]),h=2==f.length?decodeURIComponent(f[1]):null;null!=c[g]?(K.call(c[g])!==H&&(c[g]=[c[g]]),c[g].push(h)):c[g]=h}return c}function v(a){var b=m(a);i(a.childNodes,R[b]),R[b]=c}function w(a,b){var c=e.prop(b);return a.then(c),c.then=function(c,d){return w(a.then(c,d),b)},c}
//Promiz.mithril.js | Zolmeister | MIT
//a modified version of Promiz.js, which does not conform to Promises/A+ for two reasons:
//1) `then` callbacks are called synchronously (because setTimeout is too slow, and the setImmediate polyfill is too big
//2) throwing subclasses of Error cause the error to be bubbled up instead of triggering rejection (because the spec does not account for the important use case of default browser error handling, i.e. message w/ line number)
function x(a,b){function c(a){l=a||j,n.map(function(a){l===i&&a.resolve(m)||a.reject(m)})}function d(a,b,c,d){if((null!=m&&K.call(m)===G||typeof m===J)&&typeof a===J)try{
// count protects against abuse calls from spec checker
var f=0;a.call(m,function(a){f++||(m=a,b())},function(a){f++||(m=a,c())})}catch(a){e.deferred.onerror(a),m=a,c()}else d()}function f(){
// check if it's a thenable
var j;try{j=m&&m.then}catch(a){return e.deferred.onerror(a),m=a,l=h,f()}d(j,function(){l=g,f()},function(){l=h,f()},function(){try{l===g&&typeof a===J?m=a(m):l===h&&"function"==typeof b&&(m=b(m),l=g)}catch(a){return e.deferred.onerror(a),m=a,c()}m===k?(m=TypeError(),c()):d(j,function(){c(i)},c,function(){c(l===g&&i)})})}var g=1,h=2,i=3,j=4,k=this,l=0,m=0,n=[];k.promise={},k.resolve=function(a){return l||(m=a,l=g,f()),this},k.reject=function(a){return l||(m=a,l=h,f()),this},k.promise.then=function(a,b){var c=new x(a,b);return l===i?c.resolve(m):l===j?c.reject(m):n.push(c),c.promise}}function y(a){return a}function z(a){if(!a.dataType||"jsonp"!==a.dataType.toLowerCase()){var d=new b.XMLHttpRequest;if(d.open(a.method,a.url,!0,a.user,a.password),d.onreadystatechange=function(){4===d.readyState&&(d.status>=200&&d.status<300?a.onload({type:"load",target:d}):a.onerror({type:"error",target:d}))},a.serialize===JSON.stringify&&a.data&&"GET"!==a.method&&d.setRequestHeader("Content-Type","application/json; charset=utf-8"),a.deserialize===JSON.parse&&d.setRequestHeader("Accept","application/json, text/*"),typeof a.config===J){var e=a.config(d,a);null!=e&&(d=e)}var f="GET"!==a.method&&a.data?a.data:"";if(f&&K.call(f)!=I&&f.constructor!=b.FormData)throw"Request data should be either be a string or FormData. Check the `serialize` option in `m.request`";return d.send(f),d}var g="mithril_callback_"+(new Date).getTime()+"_"+Math.round(1e16*Math.random()).toString(36),h=C.createElement("script");b[g]=function(d){h.parentNode.removeChild(h),a.onload({type:"load",target:{responseText:d}}),b[g]=c},h.onerror=function(d){return h.parentNode.removeChild(h),a.onerror({type:"error",target:{status:500,responseText:JSON.stringify({error:"Error making jsonp request"})}}),b[g]=c,!1},h.onload=function(a){return!1},h.src=a.url+(a.url.indexOf("?")>0?"&":"?")+(a.callbackKey?a.callbackKey:"callback")+"="+g+"&"+t(a.data||{}),C.body.appendChild(h)}function A(a,b,c){if("GET"===a.method&&"jsonp"!=a.dataType){var d=a.url.indexOf("?")<0?"?":"&",e=t(b);a.url=a.url+(e?d+e:"")}else a.data=c(b);return a}function B(a,b){var c=a.match(/:[a-z]\w+/gi);if(c&&b)for(var d=0;d<c.length;d++){var e=c[d].slice(1);a=a.replace(c[d],b[e]),delete b[e]}return a}var C,D,E,F,G="[object Object]",H="[object Array]",I="[object String]",J="function",K={}.toString,L=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,M=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/,N=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/;d(b);var O,P={appendChild:function(a){O===c&&(O=C.createElement("html")),C.documentElement&&C.documentElement!==a?C.replaceChild(a,C.documentElement):C.appendChild(a),this.childNodes=C.childNodes},insertBefore:function(a){this.appendChild(a)},childNodes:[]},Q=[],R={};e.render=function(a,b,d){var e=[];if(!a)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var g=m(a),h=a===C,j=h||a===C.documentElement?P:a;h&&"html"!=b.tag&&(b={tag:"html",attrs:{},children:b}),R[g]===c&&i(j.childNodes),d===!0&&v(a),R[g]=f(j,null,c,c,b,R[g],!1,0,null,c,e);for(var k=0,l=e.length;k<l;k++)e[k]()},e.trust=function(a){return a=new String(a),a.$trusted=!0,a},e.prop=function(a){
//note: using non-strict equality check here because we're checking if store is null OR undefined
//note: using non-strict equality check here because we're checking if store is null OR undefined
return(null!=a&&K.call(a)===G||typeof a===J)&&typeof a.then===J?w(a):n(a)};var S,T=[],U=[],V=[],W=null,X=0,Y=null,Z=16;//60 frames per second = 1 call per 16 ms
e.module=function(a,b){if(!a)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var c=T.indexOf(a);c<0&&(c=T.length);var d=!1;if(V[c]&&typeof V[c].onunload===J){var f={preventDefault:function(){d=!0}};V[c].onunload(f)}if(!d){e.redraw.strategy("all"),e.startComputation(),T[c]=a;var g=S=b=b||{},h=new(b.controller||function(){});
//controllers may call m.module recursively (via m.route redirects, for example)
//this conditional ensures only the last recursive m.module call is applied
return g===S&&(V[c]=h,U[c]=b),aa(),V[c]}},e.redraw=function(a){
//lastRedrawId is a positive number if a second redraw is requested before the next animation frame
//lastRedrawID is null if it's the first redraw and not an event handler
W&&a!==!0?
//when setTimeout: only reschedule redraw if time between now and previous redraw is bigger than a frame, otherwise keep currently scheduled timeout
//when rAF: always reschedule redraw
(new Date-X>Z||E===b.requestAnimationFrame)&&(W>0&&F(W),W=E(o,Z)):(o(),W=E(function(){W=null},Z))},e.redraw.strategy=e.prop();var $=function(){return""},_=0;e.startComputation=function(){_++},e.endComputation=function(){_=Math.max(_-1,0),0===_&&e.redraw()};var aa=function(){"none"==e.redraw.strategy()?(_--,e.redraw.strategy("diff")):e.endComputation()};e.withAttr=function(a,b){return function(c){c=c||event;var d=c.currentTarget||this;b(a in d?d[a]:d.getAttribute(a))}};
//routing
var ba,ca,da={pathname:"",hash:"#",search:"?"},ea=function(){};
//testing API
//for internal testing only, do not use `m.deps.factory`
return e.route=function(){
//m.route()
if(0===arguments.length)return ca;if(3===arguments.length&&K.call(arguments[1])===I){var a=arguments[0],c=arguments[1],d=arguments[2];ea=function(b){var f=ca=p(b);q(a,d,f)||e.route(c,!0)};var f="hash"===e.route.mode?"onhashchange":"onpopstate";b[f]=function(){var a=D[e.route.mode];"pathname"===e.route.mode&&(a+=D.search),ca!=p(a)&&ea(a)},Y=s,b[f]()}else if(arguments[0].addEventListener||arguments[0].attachEvent){var g=arguments[0];arguments[1],arguments[2];g.href=("pathname"!==e.route.mode?D.pathname:"")+da[e.route.mode]+this.attrs.href,g.addEventListener?(g.removeEventListener("click",r),g.addEventListener("click",r)):(g.detachEvent("onclick",r),g.attachEvent("onclick",r))}else if(K.call(arguments[0])===I){var h=ca;ca=arguments[0];var i=arguments[1]||{},j=ca.indexOf("?"),k=j>-1?u(ca.slice(j+1)):{};for(var l in i)k[l]=i[l];var m=t(k),n=j>-1?ca.slice(0,j):ca;m&&(ca=n+(n.indexOf("?")===-1?"?":"&")+m);var o=(3===arguments.length?arguments[2]:arguments[1])===!0||h===arguments[0];b.history.pushState?(Y=function(){b.history[o?"replaceState":"pushState"](null,C.title,da[e.route.mode]+ca),s()},ea(da[e.route.mode]+ca)):(D[e.route.mode]=ca,ea(da[e.route.mode]+ca))}},e.route.param=function(a){if(!ba)throw new Error("You must call m.route(element, defaultRoute, routes) before calling m.route.param()");return ba[a]},e.route.mode="search",e.route.buildQueryString=t,e.route.parseQueryString=u,e.deferred=function(){var a=new x;return a.promise=w(a.promise),a},e.deferred.onerror=function(a){if("[object Error]"===K.call(a)&&!a.constructor.toString().match(/ Error/))throw a},e.sync=function(a){function b(a,b){return function(e){return g[a]=e,b||(c="reject"),0===--f&&(d.promise(g),d[c](g)),e}}var c="resolve",d=e.deferred(),f=a.length,g=new Array(f);if(a.length>0)for(var h=0;h<a.length;h++)a[h].then(b(h,!0),b(h,!1));else d.resolve([]);return d.promise},e.request=function(a){a.background!==!0&&e.startComputation();var b=new x,c=a.dataType&&"jsonp"===a.dataType.toLowerCase(),d=a.serialize=c?y:a.serialize||JSON.stringify,f=a.deserialize=c?y:a.deserialize||JSON.parse,g=a.extract||function(a){return 0===a.responseText.length&&f===JSON.parse?null:a.responseText};return a.url=B(a.url,a.data),a=A(a,a.data,d),a.onload=a.onerror=function(c){try{c=c||event;var d=("load"===c.type?a.unwrapSuccess:a.unwrapError)||y,h=d(f(g(c.target,a)),c.target);if("load"===c.type)if(K.call(h)===H&&a.type)for(var i=0;i<h.length;i++)h[i]=new a.type(h[i]);else a.type&&(h=new a.type(h));b["load"===c.type?"resolve":"reject"](h)}catch(a){e.deferred.onerror(a),b.reject(a)}a.background!==!0&&e.endComputation()},z(a),b.promise=w(b.promise,a.initialValue),b.promise},e.deps=function(a){return d(b=a||b),b},e.deps.factory=a,e}("undefined"!=typeof window?window:{});"undefined"!=typeof b&&null!==b&&b.exports?b.exports=d:"function"==typeof define&&define.amd&&define(function(){return d})},{}],17:[function(a,b,c){"use strict";var d=a("./AwsUi");window.AwsUi=d,d.__Metrics.sendMetricOnce("awsui-runtime-loaded",1),d.__Metrics.sendMetricOnce("awsui-viewport-width",window.innerWidth||0),d.__Metrics.sendMetricOnce("awsui-viewport-height",window.innerHeight||0);var e=a("./BasePrototype/RenderHandling");window._AwsUiJsxHelpers={createElement:e.__createElement}},{"./AwsUi":2,"./BasePrototype/RenderHandling":10}]},{},[17]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d=350,e=function(){function a(a){this.component=a}return a.prototype.updateState=function(a,b){this.component.__animationState[a]=b,this.component.__animationState=this.component.__animationState},a.prototype.animate=function(a){var b=this,c=this.component.node.querySelector(".awsui-accordion-section-content-container"),e="1px";if(c){this.component.__animationState={isAnimating:!1};var f=c.scrollHeight+"px";this.updateState("height",a?e:f),setTimeout(function(){b.updateState("isAnimating",!0),setTimeout(function(){return b.updateState("height",a?f:e)})}),setTimeout(function(){return b.component.__animationState=void 0},d)}},a}();Object.defineProperty(c,"__esModule",{value:!0}),c.default=e},{}],2:[function(a,b,c){"use strict";function d(a){return a.component&&"awsui-accordion-section"===a.component.__componentName}function e(a,b,c){for(var d=0,e=b;d<e.length;d++){var f=e[d];if(f.component.sectionId===c)return f}}function f(a){if(!a.__expandedSection||a.__expandedSection.sectionId!==a.expandedSectionId){var b,c=a.node.querySelectorAll("awsui-accordion-section");b=a.expandedSectionId?e(a,c,a.expandedSectionId):c[0],b&&g(a,b.component)}}function g(a,b,c){void 0===c&&(c=!1),a.__expandedSection=b;for(var d=a.node.querySelectorAll("awsui-accordion-section"),e=0,f=d;e<f.length;e++){var g=f[e];g.component&&g.component.__toggle(g.component===a.__expandedSection,c)}}var h=a("./AccordionAnimator");AwsUi.__addComponent("awsui-accordion-section",{releaseStatus:"preview",events:{expand:{bubbles:!0,cancelable:!1},collapse:{bubbles:!0,cancelable:!1},__expand:{bubbles:!0,cancelable:!0}},properties:{header:{type:"string"},sectionId:{type:"string",announceValue:!0},__expanded:{type:"boolean"},__animationState:{type:"object"}},functions:{expand:function(){this.__expanded||this.__fireEvent("__expand")},__toggle:function(a,b){a!==this.__expanded&&(this.__expanded=a,b&&(this.__animator||(this.__animator=new h.default(this)),this.__animator.animate(a)))}},regions:{content:{isDefault:!0}},render:function(a,b){var c=this,d=function(){var d=new b.ClassBuilder(c);return d.addClass("awsui-accordion-section-header"),d.addClass("awsui-accordion-section-header-expandable",!c.__expanded),d.addClass("awsui-icon"),d.addClass("caret-down",c.__expanded),d.addClass("caret-up",!c.__expanded),a("h3",{className:d.toClassName(),onclick:function(){c.__expanded||(c.__fireEvent("__expand",{fromUser:!0}),c.__fireEvent("expand"))}},c.header)},e=function(){var d=new b.ClassBuilder(c);d.addClass("awsui-accordion-section-content-container"),d.addClass("awsui-accordion-section-animating",c.__animationState&&c.__animationState.isAnimating),d.addClass("awsui-accordion-section-expanded",c.__expanded||c.__animationState);var e={};c.__animationState&&c.__animationState.height&&(e.height=c.__animationState.height);var f={className:d.toClassName(),style:e};return a("div",f,b.region("content","div",{className:"awsui-accordion-section-content"}))};return[d(),e()]}}),AwsUi.__addComponent("awsui-accordion-group",{releaseStatus:"preview",callbacks:{initialized:function(){var a=this;this.__listenToPropertyChanges("sectionId",function(b,c){d(c)&&(a.expandedSectionId||a.__expandedSection?a.expandedSectionId&&(c.component.__expanded=c.component.sectionId===a.expandedSectionId):g(a,c.component))}),this.node.addEventListener("awsui:__expand",function(b){d(b.target)&&(a.__expandedSection&&b.detail.fromUser&&a.__expandedSection.__fireEvent("collapse"),g(a,b.target.component,b.detail.fromUser),a.expandedSectionId=b.target.component.sectionId,a.__fireEvent("change"))})}},properties:{expandedSectionId:{type:"string",onChange:function(){f(this)}}},events:{change:{bubbles:!0,cancelable:!1}},regions:{content:{isDefault:!0}},render:function(a,b){return b.region("content","div",{className:"awsui-accordion-group-container"})},wrapperSupport:{ngModel:{value:"expandedSectionId",event:"change"}}})},{"./AccordionAnimator":1}]},{},[2]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){AwsUi.__addComponent("awsui-alert",{releaseStatus:"stable",events:{dismiss:{cancelable:!0},show:{cancelable:!1},hide:{cancelable:!1}},properties:{type:{nullable:!1,valid:["success","error","warning","info"],defaultValue:"info"},visible:{type:"boolean",defaultValue:!0,onChange:function(a,b){var c="awsui-alert-hidden";b?(this.node.removeAttribute(c),this.__fireEvent("show")):(this.node.setAttribute(c,c),this.__fireEvent("hide"))}},dismissible:{type:"boolean"}},regions:{header:{},content:{isDefault:!0}},functions:{dismiss:function(){var a=this.__fireEvent("dismiss");a.defaultPrevented||(this.visible=!1)}},render:function(a,b){function c(){var a=new b.ClassBuilder(f);return a.addClass("awsui-alert-inside").addClass("awsui-alert-type-"+f.type).addClass("awsui-alert-has-dismiss",f.dismissible).addClass("awsui-alert-has-header",f.getRegion("header")),a.toClassName()}function d(){if(f.dismissible){var c=new b.ClassBuilder(f);return c.addClass("awsui-button-as-link").addClass("awsui-icon").addClass("awsui-alert-times-"+f.type).addClass("awsui-alert-dismiss-control"),a("button",{className:c.toClassName(),"aria-label":"close",type:"button",onclick:function(){return f.dismiss()}})}}function e(){if(f.getRegion("header")){var c={success:"alert-check-circle",warning:"alert-exclamation-triangle",info:"alert-info-circle",error:"alert-exclamation-circle"},d=new b.ClassBuilder(f);d.addClass("awsui-alert-icon").addClass("awsui-icon").addClass("awsui-icon-big").addClass(c[f.type]);var e=a("span",{className:d.toClassName()});return[e,b.region("header","div",{className:"awsui-alert-header awsui-text-big"})]}}var f=this;return a("div",{className:c(),"aria-hidden":!this.visible,role:"alert"},[e(),b.region("content"),d()])}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){AwsUi.__addComponent("awsui-breadcrumb-item",{releaseStatus:"preview",properties:{text:{type:"string"},href:{type:"string"}},events:{click:{bubbles:!0,cancelable:!0},follow:{bubbles:!0,cancelable:!0}},render:function(a,b){var c=this,d=b.copyDefined({class:"awsui-breadcrumb-link",href:c.href||"#",onclick:b.newEventHandler("click",function(a){if(!(0!==a.button||a.ctrlKey||a.altKey||a.shiftKey||a.metaKey)){var b=this.__fireEvent("follow");b.defaultPrevented&&a.preventDefault()}})}),e=a("a",d,c.text);return e}}),AwsUi.__addComponent("awsui-breadcrumb-group",{releaseStatus:"preview",regions:{content:{isDefault:!0}},render:function(a,b){return b.region("content","nav",{class:"awsui-breadcrumb-list",role:"list"})}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){return"download"in document.createElement("a")||!e()}function e(){return"undefined"!=typeof window.navigator.msSaveBlob}function f(a){if(a.download&&a.href){var b=g(a.href)?i:h;b(a.download,a.href)}}function g(a){return"data:"===a.substr(0,5)}function h(a,b){var c=new XMLHttpRequest,d=function(){window.navigator.msSaveBlob(this.response,a)};c.addEventListener("load",d,!1),c.open("get",b,!0),c.responseType="blob",c.send()}function i(a,b){window.navigator.msSaveBlob(j(b),a)}function j(a){for(var b=atob(a.split(",")[1]),c=new ArrayBuffer(b.length),d=new Uint8Array(c),e=0;e<b.length;e++)d[e]=255&b.charCodeAt(e);return new Blob([c],{type:"application/octet-stream"})}c.supportsDownloadAttribute=d,c.forceDownload=f},{}],2:[function(a,b,c){"use strict";var d=a("./polyfills/download");AwsUi.__addComponent("awsui-button",{releaseStatus:"stable",properties:{disabled:{type:"boolean"},loading:{type:"boolean"},icon:{type:"string",valid:["angle-double-left","angle-double-right","angle-down","angle-left","angle-right","angle-up","area-chart","arrow-down","arrow-up","arrows-alt","bell-o","bolt","calendar","caret-down","caret-left","caret-right","caret-up","check-circle","caret-square-o-down","check","circle","clipboard","clock-o","cog","compress","download","ellipsis-v","envelope","exchange","exclamation-circle","exclamation-triangle","expand","external-link","files-o","filter","folder-open","font","hashtag","info-circle","line-chart","list","minus","pause-circle-o","pencil","play-circle-o","plus-circle","plus","print","question-circle","refresh","search","search-minus","search-plus","star-o","star","tag","th-large","times-circle","times","trash","upload","view-full","view-horizontal","view-vertical"]},iconAlign:{type:"string",nullable:!1,defaultValue:"left",valid:["left","right"]},formAction:{type:"string",nullable:!1,defaultValue:"submit",valid:["submit","none"]},label:{type:"string"},href:{type:"string"},download:{type:"string"},target:{type:"string"},size:{nullable:!1,type:"string",valid:["normal","small"],defaultValue:"normal"},variant:{nullable:!1,type:"string",valid:["normal","primary","danger","link","standalone-icon"],defaultValue:"normal"}},functions:{click:function(){this.__isDisabled()||this.__fireEvent("click"),this.__useCustomDownload()&&d.forceDownload(this)},__isDisabled:function(){return this.loading||this.disabled},__useCustomDownload:function(){return!d.supportsDownloadAttribute()&&this.download}},events:{click:{}},regions:{text:{isDefault:!0}},render:function(a,b){function c(){var a=new b.ClassBuilder(j);return a.addClass("awsui-spinner").addClass("awsui-spinner-disabled",!p).addClass("awsui-spinner-light",p).addClass("awsui-button-icon").addClass("awsui-button-icon-left"),a.toClassName()}function d(){var a=!p&&j.__isDisabled(),c=m&&!a,d="link"===j.variant&&!a,e=new b.ClassBuilder(j);return e.addClass(n).addClass("awsui-icon").addClass("awsui-icon-disabled",a).addClass("awsui-icon-has-hover",c).addClass("awsui-icon-light",p).addClass("awsui-icon-link",d).addClass("awsui-button-icon").addClass("awsui-button-icon-"+o),e.toClassName()}function e(){var a=new b.ClassBuilder(j);return a.addClass("awsui-button").addPropertyValueClass("size").addPropertyValueClass("variant").addClass("awsui-hover-child-icons").addClass("awsui-button-no-text",!i()).addClass("awsui-button-disabled",j.__isDisabled()).addClass("awsui-button-as-link",m),a.toClassName()}function f(a){return k&&j.__isDisabled()?a.preventDefault():(j.__useCustomDownload()&&a.preventDefault(),void j.click())}function g(){return j.loading?a("span",{className:c()}):n&&"left"===o?a("span",{className:d()}):void 0}function h(){if(n&&"right"===o)return a("span",{className:d()})}function i(){return b.region("text","span")||""}var j=this,k=Boolean(j.href),l=k?"a":"button",m="standalone-icon"===j.variant,n=j.icon,o=m?"left":j.iconAlign,p="primary"===j.variant||"danger"===j.variant,q=[g(),i(),h()],r="none"===j.formAction?"button":"submit",s=a(l,b.copyDefined({className:e(),"aria-label":j.label,onclick:f,href:j.href,download:j.href?j.download:void 0,role:k?"button":void 0,type:k?void 0:r,target:j.href&&j.target?j.target:void 0,disabled:!(!j.__isDisabled()||k)||void 0,"aria-disabled":!(!j.__isDisabled()||!k)||void 0}),q);return s}}),AwsUi.__addComponent("awsui-button-group",{releaseStatus:"stable",regions:{content:{isDefault:!0}},render:function(a,b){return b.region("content","div",{className:"awsui-button-group-content"})}});var e="awsui-button-dropdown",f=27,g=40,h=38;AwsUi.__addComponent("awsui-button-dropdown",{releaseStatus:"experimental",callbacks:{initialized:function(){var a=this;this.__keydownHandler=function(b){if(a.__expanded)switch(b.keyCode){case f:b.preventDefault(),a.__toggleDropdown();break;case g:b.preventDefault(),a.__switchItem(1);break;case h:b.preventDefault(),a.__switchItem(-1)}},this.__globalCloseClickHandler=function(b){a.__expanded&&!a.node.contains(b.target)&&(a.__expanded=!1)}},attached:function(){document.addEventListener("mouseup",this.__globalCloseClickHandler),document.addEventListener("keydown",this.__keydownHandler)},detached:function(){document.removeEventListener("mouseup",this.__globalCloseClickHandler),document.removeEventListener("keydown",this.__keydownHandler)}},properties:{items:{type:"array",itemType:"Item"},disabled:{type:"boolean"},loading:{type:"boolean"},__expanded:{type:"boolean"},__focusedItem:{type:"object",itemType:"Item"}},regions:{text:{isDefault:!0}},functions:{__toggleDropdown:function(){this.__expanded=!this.__expanded,this._expanded||(this.__focusedItem=null)},__isDisabled:function(){return this.loading||this.disabled},__focusItem:function(a){if(a!=this.__focusedItem){this.__focusedItem=a;var b=this.node.querySelector("."+e+"-item-focus");b&&b.focus()}},__findAllEnabledItems:function(){var a=[];return this.items?(this.items.forEach(function(b){if(!b.disabled)return b.items?void(a=a.concat(b.items.filter(function(a){return!a.disabled}))):void a.push(b)}),a):a},__switchItem:function(a){var b=this.__findAllEnabledItems(),c=b.indexOf(this.__focusedItem),d=c===-1?0:c+a;d>b.length-1&&(d=0),d<0&&(d=b.length-1),this.__focusItem(b[d])}},events:{itemClick:{bubbles:!0,cancelable:!1,detailTypeName:"ItemClick"}},render:function(a,b){function c(){function c(){var a=new b.ClassBuilder(f);return a.addClass("awsui-button").addClass("awsui-button-size-normal").addClass("awsui-button-variant-normal").addClass("awsui-button-disabled",g),a.toClassName()}function d(a){f.__isDisabled()||f.__toggleDropdown(),a.preventDefault()}function e(){var c=new b.ClassBuilder(f);return c.addClass("awsui-icon").addClass("awsui-button-icon").addClass("awsui-button-icon-right").addClass(f.loading?"awsui-spinner":"angle-down").addClass(f.loading?"awsui-spinner-disabled":"awsui-icon-disabled",g),a("span",{className:c.toClassName()})}function h(){return b.region("text","span")||""}return a("button",b.copyDefined({className:c(),onclick:d,type:"button",role:"button",disabled:g||void 0,"aria-disabled":g||void 0}),[h(),e()])}function d(){function c(){function c(c,g){void 0===g&&(g=!1);var h=g||c.disabled,i=new b.ClassBuilder(f);i.addClass(e+"-item").addClass(e+"-item-separator-bottom","bottom"===c.separator).addClass(e+"-item-disabled",h);var j=i.toClassName();return a("li",{className:j},d(c,h))}function d(c,d){var g=new b.ClassBuilder(f);if(g.addClass(e+"-item-content"),d){var h={className:g.toClassName(),"aria-disabled":!0};return a("span",h,c.text)}g.addClass(e+"-item-focus",c===f.__focusedItem);var i={href:"#",className:g.toClassName(),onmouseover:function(a){f.__focusItem(c)},onfocus:function(a){f.__focusItem(c)},onclick:function(a){a.preventDefault(),f.__fireEvent("itemClick",{id:c.id}),f.__toggleDropdown()}};return a("a",i,c.text)}function g(d){var g=d.items.map(function(a){return c(a,d.disabled)}),h=a("ul",{className:e+"-content"},g),i=new b.ClassBuilder(f);return i.addClass(e+"-category-heading").addClass(e+"-item-disabled",d.disabled),a("li",{className:e+"-category"},[a("p",{className:i.toClassName()},d.text),h])}function h(a){return a.items?g(a):c(a)}var i=f.items.map(h);return a("ul",{className:e+"-content"},i)}if(f.items&&0!==f.items.length&&!f.__isDisabled()&&f.__expanded)return a("div",{className:e},c())}var f=this,g=f.__isDisabled();return a("div",[c(),d()])}})},{"./polyfills/download":1}]},{},[2]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){return"awsui-checkbox-"+f++}var e=function(a){return a.node.querySelector("input")},f=0;AwsUi.__addComponent("awsui-checkbox",{releaseStatus:"stable",callbacks:{initialized:function(){this.controlId||(this.controlId=d())}},properties:{checked:{type:"boolean"},disabled:{type:"boolean"},controlId:{type:"string"}},events:{focus:{bubbles:!0,cancelable:!1},blur:{bubbles:!0,cancelable:!1},check:{bubbles:!0,cancelable:!0},uncheck:{bubbles:!0,cancelable:!0},change:{bubbles:!0,cancelable:!0}},render:function(a,b){function c(){if(e.label){var c=b.region("label","label",{for:e.controlId});return a("span",{className:"awsui-checkbox-label"},c)}}var d=this,e=this,f=["checked","disabled"],g=b.copyDefined(this,f),h=new b.ClassBuilder(this);h.addClass("awsui-checkbox-styled-box").addClass("awsui-checkbox-styled-box-disabled",this.disabled).addClass("awsui-checkbox-styled-box-checked",this.checked),g.id=this.controlId,g.className="awsui-native-internal-checkbox",g.type="checkbox",g.onchange=a.withAttr("checked",function(a){d.checked=a,d.__fireEvent("change"),d.__fireEvent(d.checked?"check":"uncheck")}),g.onfocus=b.newEventHandler("focus"),g.onblur=b.newEventHandler("blur");var i={className:"awsui-checkbox-wrapper-label"},j=a("div",{className:h.toClassName()});return[a("label",i,a("input",g),j),c()]},functions:{focus:function(){e(this).focus()},blur:function(){e(this).blur()}},regions:{label:{isDefault:!0}},wrapperSupport:{ngModel:{value:"checked",event:"change"}}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";AwsUi.__addComponent("awsui-control-group",{releaseStatus:"stable",callbacks:{initialized:function(){var a=this;this.__listenToPropertyChanges("controlId",function(b){return a.__discoveredControlId=b})}},functions:{__isValid:function(){return!this.validationMessage}},render:function(a,b){var c=this,d=new b.ClassBuilder(c).addClass("awsui-control-group-inside").addClass("awsui-control-group-invalid",!c.__isValid()).addPropertyValueClass("layoutVariant"),e=function(){return a("div",{className:"awsui-control-group-label-with-tooltip"},[g(),k()])},f=function(){return g()},g=function(){var b=c.controlId||c.__discoveredControlId,d={className:"awsui-control-group-label"};return b&&(d.for=b),a("label",d,c.label)},h=function(){return a("div",{className:"awsui-control-group-controls"},[j(),k(),n(),o()])},i=function(){return a("div",{className:"awsui-control-group-controls"},[j(),n(),o()])},j=function(){return b.region("control","div",{className:"awsui-control-group-control"})},k=function(){if(c.detail)return a("div",{className:"awsui-control-group-tooltip"},a("div",{className:"awsui-control-group-tooltip-inner"},[l(),m()]))},l=function(){return a("span",{className:"awsui-control-group-tooltip-icon awsui-icon info-circle awsui-icon-has-hover"})},m=function(){return b.region("detail","span",{className:"awsui-control-group-tooltip-text"})},n=function(){if(c.instructional)return b.region("instructional","div",{className:"awsui-control-group-instructional-message"})},o=function(){if(!c.__isValid())return b.region("validationMessage","div",{className:"awsui-control-group-validation-message"})},p="stacked"===c.layoutVariant?[e(),i()]:[f(),h()];return a("div",{className:d.toClassName()},p)},properties:{label:{},controlId:{type:"string"},layoutVariant:{type:"string",valid:["default","stacked"],defaultValue:"default"},__discoveredControlId:{type:"string"}},regions:{control:{isDefault:!0},detail:{},instructional:{},validationMessage:{}}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){return"awsui-expandable-section-"+e++}var e=0;AwsUi.__addComponent("awsui-expandable-section",{releaseStatus:"stable",callbacks:{initialized:function(){this.controlId=d()}},properties:{header:{type:"string"},expanded:{type:"boolean"}},regions:{content:{isDefault:!0}},events:{expand:{bubbles:!0,cancelable:!1},collapse:{bubbles:!0,cancelable:!1}},render:function(a,b){function c(){var c=new b.ClassBuilder(e);c.addClass("awsui-expandable-section-header").addClass("awsui-icon").addClass(e.expanded?"caret-down":"caret-right");var d={class:c.toClassName(),"aria-controls":e.controlId,onclick:function(){e.expanded=!e.expanded,e.__fireEvent(e.expanded?"expand":"collapse")}};return a("h3",d,e.header)}function d(){var a=new b.ClassBuilder(e);a.addClass("awsui-expandable-section-content").addClass("awsui-expandable-section-expanded",e.expanded);var c={class:a.toClassName(),role:"region",id:e.controlId,"aria-expanded":e.expanded};return b.region("content","div",c)}var e=this;return[c(),d()]}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){AwsUi.__addComponent("awsui-label",{releaseStatus:"stable",properties:{type:{type:"string",nullable:!1,valid:["success","error","warning","info","disabled"],defaultValue:"info"},label:{type:"string"}},render:function(a,b){var c=new b.ClassBuilder(this);return c.addPropertyValueClass("type"),c.addClass("awsui-label-content"),_AwsUiJsxHelpers.createElement("span",{className:c.toClassName()},this.label)}}),AwsUi.__addComponent("awsui-badge",{releaseStatus:"stable",properties:{type:{type:"string",nullable:!1,valid:["success","error","warning","info","disabled"],defaultValue:"info"},value:{type:"integer",nullable:!1,defaultValue:0}},render:function(a,b){var c=new b.ClassBuilder(this);return c.addPropertyValueClass("type"),c.addClass("awsui-badge-content"),_AwsUiJsxHelpers.createElement("span",{className:c.toClassName()},this.value)}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){f(),k.addClass(document.body,l)}function e(){k.removeClass(document.body,l),h()}function f(){if(j()){m=document.body.style.paddingRight;var a=g(),b=i(),c=a+b;document.body.style.paddingRight=c+"px"}}function g(){return parseInt(window.getComputedStyle(document.body).paddingRight,10)}function h(){m?document.body.style.paddingRight=m:document.body.style.removeProperty("padding-right"),m=null}function i(){var a=document.createElement("div");a.className="awsui-modal-scrollbar-measure",document.body.appendChild(a);var b=a.offsetWidth-a.clientWidth;return document.body.removeChild(a),b}function j(){return document.body.clientWidth<window.innerWidth}var k=AwsUi.__DomUtils,l="awsui-modal-open",m=null;c.disableBodyScrolling=d,c.enableBodyScrolling=e},{}],2:[function(a,b,c){"use strict";function d(a,b){a.__state=b?"fadeIn":"fadeOut",b?g(a):h(a)}function e(a,b){function c(a,b){d.__timeoutID&&clearTimeout(d.__timeoutID),d.__timeoutID=setTimeout(function(){d.__state===a&&(d.__state=b),d.__timeoutID=void 0},j)}var d=this;"fadeOut"===b?c("fadeOut","hidden"):"fadeIn"===b&&c("fadeIn","showing"),f(this)}function f(a){var b="attached"===a.__componentState,c=b&&"hidden"!==a.__state;c?i.disableBodyScrolling():i.enableBodyScrolling()}function g(a){var b=a.node.querySelector(".awsui-modal-dialog");b&&b.focus?(a.__initiallyFocusedElement=document.activeElement,b.focus()):a.__initiallyFocusedElement=void 0}function h(a){a.__initiallyFocusedElement&&a.__initiallyFocusedElement.focus&&a.__initiallyFocusedElement.focus(),a.__initiallyFocusedElement=void 0}var i=a("./BodyScroll"),j=450,k=27;AwsUi.__addComponent("awsui-modal",{releaseStatus:"stable",callbacks:{attached:function(){this.visible&&(this.__state="hidden",d(this,!0))},detached:function(){i.enableBodyScrolling(),this.__initiallyFocusedElement=void 0}},properties:{header:{type:"string"},size:{type:"string",valid:["small","medium","large","max"],defaultValue:"medium"},visible:{type:"boolean",onChange:function(a,b){d(this,b)}},__state:{type:"string",defaultValue:"hidden",valid:["hidden","fadeIn","showing","fadeOut"],onChange:e}},events:{dismiss:{bubbles:!0,cancelable:!0}},functions:{dismiss:function(){this.visible=!1},__UIDismiss:function(){var a=this.__fireEvent("dismiss");a.defaultPrevented||this.dismiss()}},regions:{content:{isDefault:!0},footer:{}},render:function(a,b){function c(a){a.keyCode===k&&e.__UIDismiss()}function d(a){a.target===this&&e.__UIDismiss()}var e=this,f=new b.ClassBuilder(e).addClass("awsui-modal-dialog").addPropertyValueClass("size").toClassName(),h=new b.ClassBuilder(e).addClass("awsui-modal-container").addPropertyValueClass("__state").toClassName(),i=new b.ClassBuilder(e).addClass("awsui-modal-overlay").addPropertyValueClass("__state").toClassName(),j=_AwsUiJsxHelpers.createElement("div",{className:"awsui-modal-tabtrap",tabindex:e.visible?"0":"-1",onfocus:function(){g(e)}}),l=_AwsUiJsxHelpers.createElement("div",{className:h,onclick:d},_AwsUiJsxHelpers.createElement("div",{className:f,onkeydown:c,tabindex:"-1"},_AwsUiJsxHelpers.createElement("div",{className:"awsui-modal-content"},_AwsUiJsxHelpers.createElement("div",{className:"awsui-modal-header"},_AwsUiJsxHelpers.createElement("button",{className:"awsui-modal-dismiss-control awsui-button-as-link awsui-icon times",onclick:d}),e.header),_AwsUiJsxHelpers.createElement("div",{className:"awsui-modal-body"},b.region("content")),_AwsUiJsxHelpers.createElement("div",{className:"awsui-modal-footer"},b.region("footer"))))),m=_AwsUiJsxHelpers.createElement("div",{className:i});return[j,l,m,j]}})},{"./BodyScroll":1}]},{},[2]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d=0,e=function(){return"awsui-radio-button-"+d++},f=function(){return"awsui-radio-group-"+d++},g=function(a){return a.node.querySelector("input")};AwsUi.__addComponent("awsui-radio-button",{releaseStatus:"stable",callbacks:{attached:function(){this.controlId=this.controlId||e()}},events:{__selected:{bubbles:!0,cancelable:!0},focus:{bubbles:!0,
cancelable:!0},blur:{bubbles:!0,cancelable:!0}},properties:{value:{type:"string",announceValue:!0},disabled:{type:"boolean"},controlId:{type:"string"},__checked:{type:"boolean"},__name:{type:"string"}},functions:{focus:function(){g(this).focus()},blur:function(){g(this).blur()},click:function(){g(this).click()}},regions:{label:{isDefault:!0}},render:function(a,b){function c(){var c=new b.ClassBuilder(d);return c.addClass("awsui-radio-button-label"),c.addClass("awsui-radio-button-checked",d.__checked),a("label",{for:d.controlId||null,className:c.toClassName()},b.region("label"))}var d=this,e=new b.ClassBuilder(this);e.addClass("awsui-radio-button-wrapper-label"),e.addClass("awsui-radio-button-disabled",d.disabled);var f=["disabled","value"],g=b.copyDefined(this,f);this.controlId&&(g.id=this.controlId),this.__name&&(g.name=this.__name),g.checked=this.__checked,g.type="radio",g.className="awsui-radio-button-input",g.onblur=b.newEventHandler("blur"),g.onfocus=b.newEventHandler("focus"),g.onchange=function(){d.__checked=!0,d.__fireEvent("__selected")};var h=a("input",g),i=a("div",{className:"awsui-radio-button-styled-button"}),j=a("label",{className:e.toClassName()},h,i);return[j,c()]}}),AwsUi.__addComponent("awsui-radio-group",{releaseStatus:"stable",callbacks:{initialized:function(){function a(a){return a.component&&"awsui-radio-button"===a.component.__componentName}var b=this;this.name=f(),this.__listenToPropertyChanges("value",function(c,d){a(d)&&(d.component.__name=b.name,d.component.__checked=d.component.value===b.value)}),this.node.addEventListener("awsui:__selected",function(c){a(c.target)&&(b.value=c.target.component.value,b.__fireEvent("change"))})}},functions:{__updateSelectedButton:function(){for(var a=this.node.querySelectorAll("awsui-radio-button"),b=0,c=a;b<c.length;b++){var d=c[b];d.component.__checked=d.component.value===this.value}}},properties:{value:{type:"string",onChange:function(){this.__updateSelectedButton()}}},events:{change:{bubbles:!0,cancelable:!0}},regions:{content:{isDefault:!0}},render:function(a,b){return b.region("content")},wrapperSupport:{ngModel:{value:"value",event:"change"}}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){/*! select v1.1.0 | MIT License | github.com/HubSpot/select */
"use strict";function d(a){return Array.prototype.reduce.call(a,function(a,b){return a===b&&b})}var e=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},f=a("tether"),g=f.Utils,h=g.extend,i=g.addClass,j=g.removeClass,k=g.hasClass,l=g.getBounds,m=13,n=27,o=32,p=38,q=40,r=9,s="awsui-select-target-focused",t=function(a){function b(c,d){var e=this;a.call(this,c),this.clearWidth=function(){return e.setWidth("auto")},this.setDefaultWidth=function(){return e.setWidth("100%")},this.options=h({},b.defaults,c),this.items=d||[],this.setupTarget(),this.setupDrop(),this.bindClick(),this.bindKeys(),this.value=void 0,this.searchText="",this.attached&&this.update()}return e(b,a),b.prototype.setupTarget=function(){var a=this;this.target=document.createElement("span"),this.addClass(this.target,"target"),this.valueContainer=document.createElement("span"),this.addClass(this.valueContainer,"value"),this.target.appendChild(this.valueContainer);var b=0;this.target.setAttribute("tabindex",b),this.target.setAttribute("role","combobox"),this.target.setAttribute("aria-autocomplete","list"),this.options.className&&i(this.target,this.options.className),this.target.selectInstance=this,this.target.addEventListener("mousedown",function(){a.isOpen()?a.target.blur():a.target.focus()}),this.target.addEventListener("focus",function(){i(a.target,s)}),this.target.addEventListener("blur",function(b){b.relatedTarget;j(a.target,s)})},b.prototype.prefixedClassname=function(a){return this.options.classPrefix+"-"+a},b.prototype.find=function(a,b){return a.querySelector("."+this.prefixedClassname(b))},b.prototype.findAll=function(a,b){return a.querySelectorAll("."+this.prefixedClassname(b))},b.prototype.addClass=function(a,b){i(a,this.prefixedClassname(b))},b.prototype.removeClass=function(a,b){j(a,this.prefixedClassname(b))},b.prototype.hasClass=function(a,b){return k(a,this.prefixedClassname(b))},b.prototype.setupDrop=function(){var a=this;this.drop=document.createElement("div"),this.addClass(this.drop,"dropdown"),i(this.drop,"awsui"),this.options.className&&i(this.drop,this.options.className),this.drop.addEventListener("click",function(b){a.hasClass(b.target,"option")&&a.pickOption(b.target),b.stopPropagation()}),this.drop.addEventListener("mousemove",function(b){a.hasClass(b.target,"option")&&a.highlightOption(b.target)}),this.content=document.createElement("div"),this.addClass(this.content,"content"),this.drop.appendChild(this.content)},b.prototype.open=function(){var a=this;if(!this.options.disabled){this.addClass(this.target,"open"),this.addClass(this.drop,"open");var b=this.find(this.drop,"option-selected");if(b){this.highlightOption(b),this.scrollDropContentToOption(b);var c=function(){if(a.hasClass(a.drop,"abutted-left")||a.hasClass(a.drop,"abutted-bottom")){var c=l(a.drop),d=l(b),e=c.top-(d.top+d.height);a.drop.style.top=(parseFloat(a.drop.style.top)||0)+e+"px"}},d=this.options.alignToHighlighted,e=this.content,f=e.scrollHeight,g=e.clientHeight;("always"===d||"auto"===d&&f<=g)&&setTimeout(function(){c()}),this.trigger("open")}}},b.prototype.close=function(){this.isOpen()&&(this.removeHighlight(),this.removeClass(this.target,"open"),this.removeClass(this.drop,"open"),this.trigger("close"))},b.prototype.toggle=function(){this.isOpen()?this.close():this.open()},b.prototype.focus=function(){this.target.focus()},b.prototype.blur=function(){this.target.blur()},b.prototype.isOpen=function(){return this.hasClass(this.drop,"open")},b.prototype.attach=function(){this.attached=!0,document.addEventListener("mousedown",this.globalClickListener)},b.prototype.detach=function(){this.attached=!1,this.close(),document.removeEventListener("mousedown",this.globalClickListener)},b.prototype.bindClick=function(){var a=this;this.target.addEventListener("mousedown",function(b){b.preventDefault(),a.toggle()}),this.globalClickListener=function(b){a.isOpen()&&(b.target===a.drop||a.drop.contains(b.target)||b.target===a.target||a.target.contains(b.target)||a.close())}},b.prototype.getSelectedItem=function(){if(void 0!==this.value)for(var a=0,b=this.items;a<b.length;a++){var c=b[a];if(c.items){var d=c,e=this.getSelectedItemFromOptionsGroup(d);if(e)return e}else if(c.value===this.value)return c}},b.prototype.getSelectedItemFromOptionsGroup=function(a){for(var b=0,c=a.items;b<c.length;b++){var d=c[b];if(d.value===this.value)return d}return null},b.prototype.renderTarget=function(){var a=this.getSelectedItem();a?(this.valueContainer.textContent=this.getSelectedItem().text,this.removeClass(this.valueContainer,"placeholder")):this.options.placeholder?(this.valueContainer.textContent=this.options.placeholder,this.addClass(this.valueContainer,"placeholder")):(this.valueContainer.textContent=" ",this.removeClass(this.valueContainer,"placeholder")),this.options.adjustWidth?this.adjustAllWidths():this.setDefaultWidth()},b.prototype.adjustAllWidths=function(){this.clearWidth();var a=45,b=this.getTargetWidth(),c=this.getDropWidth(),d=Math.max(b,c)+a;this.drop.setAttribute("style","width: "+d+"px;"),this.target.setAttribute("style","width: "+d+"px;")},b.prototype.setWidth=function(a){this.drop.setAttribute("style","width: "+a+";"),this.target.setAttribute("style","width: "+a+";")},b.prototype.getTargetWidth=function(){var a=10,b=this.valueContainer.offsetWidth-a;if(this.value){var c=document.createElement("span");c.textContent=this.options.placeholder,this.target.appendChild(c),b=c.offsetWidth,this.target.removeChild(c)}return b},b.prototype.getDropWidth=function(){this.addClass(this.drop,"hidden");var a=30,b=this.drop.offsetWidth-a;return this.removeClass(this.drop,"hidden"),b},b.prototype.renderDrop=function(){var a=document.createElement("ul");this.addClass(a,"options");for(var b=0,c=this.items;b<c.length;b++){var d=c[b],e=void 0;e=d.items?this.createDropdownOptionsGroup(d):this.createDropdownOption(d),a.appendChild(e)}this.content.innerHTML="",this.content.appendChild(a)},b.prototype.createDropdownOptionsGroup=function(a){var b=document.createElement("li");this.addClass(b,"options-group"),this.isOptionsGroupDisabled(a)&&this.addClass(b,"options-group-disabled");var c=document.createElement("p");this.addClass(c,"options-group-header"),c.textContent=a.text,b.appendChild(c);var d=document.createElement("ul");this.addClass(d,"options");for(var e=0,f=a.items;e<f.length;e++){var g=f[e];d.appendChild(this.createDropdownOption(g,a.disabled))}return b.appendChild(d),b},b.prototype.isOptionsGroupDisabled=function(a){if(a.disabled)return a.disabled;if(0===a.items.length)return!1;for(var b=0,c=a.items;b<c.length;b++){var d=c[b];if(!d.disabled)return!1}return!0},b.prototype.createDropdownOption=function(a,b){void 0===b&&(b=!1);var c=document.createElement("li");return this.addClass(c,"option"),c.setAttribute("data-value",a.value),c.setAttribute("title",a.text),c.textContent=a.text,this.value===a.value&&this.addClass(c,"option-selected"),(b||a.disabled)&&this.addClass(c,"option-disabled"),a.separator&&this.addClass(c,"option-separator"),c},b.prototype.update=function(){this.renderDrop(),this.renderTarget()},b.prototype.findOptionsByPrefix=function(a){var b=this.findAll(this.drop,"option");return a=a.toLowerCase(),Array.prototype.filter.call(b,function(b){return b.innerHTML.toLowerCase().substr(0,a.length)===a})},b.prototype.getChosen=function(){return this.isOpen()?this.find(this.drop,"option-highlight"):this.find(this.drop,"option-selected")},b.prototype.selectOption=function(a){this.isOpen()?(this.highlightOption(a),this.scrollDropContentToOption(a)):this.pickOption(a,!1)},b.prototype.setDisabled=function(a){this.options.disabled=a,a?(this.close(),this.addClass(this.target,"disabled"),this.target.removeAttribute("tabindex")):(this.target.setAttribute("tabindex",0),this.removeClass(this.target,"disabled"))},b.prototype.resetSelection=function(){this.selectOption(this.find(this.drop,"option"))},b.prototype.highlightOption=function(a){this.removeHighlight(),this.hasClass(a,"option-disabled")||(this.addClass(a,"option-highlight"),this.trigger("highlight",{option:a}))},b.prototype.removeHighlight=function(){var a=this.find(this.drop,"option-highlight");a&&this.removeClass(a,"option-highlight")},b.prototype.moveHighlight=function(a){var b=this,c=this.find(this.drop,"option-highlight");if(!c)return void this.highlightOption(this.find(this.drop,"option"));var d=this.findAll(this.drop,"option"),e=Array.prototype.filter.call(d,function(a){return!b.hasClass(a,"option-disabled")}),f=e.indexOf(c);if(!(f<0)){var g=f+(a===p?-1:1),h=e[g];h&&(this.highlightOption(h),this.scrollDropContentToOption(h))}},b.prototype.scrollDropContentToOption=function(a){var b=this.content,c=b.scrollHeight,d=b.clientHeight,e=b.scrollTop;if(c>d){var f=l(this.content),g=l(a);this.content.scrollTop=g.top-(f.top-e)}},b.prototype.selectHighlightedOption=function(){var a=this.find(this.drop,"option-highlight");a?this.pickOption(a):this.closeWithDelay()},b.prototype.closeWithDelay=function(){var a=this;setTimeout(function(){a.close(),a.target.focus()})},b.prototype.pickOption=function(a,b){void 0===b&&(b=!0),this.hasClass(a,"option-disabled")||(this.setAttr("value",a.getAttribute("data-value")),this.trigger("change",{value:this.value}),b&&this.closeWithDelay())},b.prototype.setAttr=function(a,b){this[a]=b,this.update()},b.prototype.setOption=function(a,b){this.options[a]=b,this.update()},b.prototype.bindKeys=function(){var a=this;a.target.addEventListener("keypress",function(b){if(0!==b.charCode){b.keyCode===o&&b.preventDefault(),clearTimeout(a.searchTextTimeout),a.searchTextTimeout=setTimeout(function(){a.searchText=""},500),a.searchText+=String.fromCharCode(b.charCode);var c=a.findOptionsByPrefix(a.searchText);if(1===c.length&&a.selectOption(c[0]),a.searchText.length>1&&d(a.searchText)){var e=a.findOptionsByPrefix(a.searchText[0]);if(e.length){var f=e.indexOf(a.getChosen());return f+=1,f%=e.length,void a.selectOption(e[f])}}return c.length?void a.selectOption(c[0]):void 0}}),a.target.addEventListener("keydown",function(b){if(b.keyCode===r&&setTimeout(function(){document.activeElement!==a.target&&a.close()}),[p,q,n].indexOf(b.keyCode)>=0&&b.preventDefault(),a.isOpen())switch(b.keyCode){case p:case q:a.moveHighlight(b.keyCode);break;case m:case o:a.selectHighlightedOption();break;case n:a.close(),a.target.focus()}else[p,q,o].indexOf(b.keyCode)>=0&&a.open()})},b}(f.Utils.Evented);Object.defineProperty(c,"__esModule",{value:!0}),c.default=t,t.defaults={alignToHighlighed:"auto",className:"select-theme-default",classPrefix:"select"}},{tether:2}],2:[function(a,b,c){/*! tether v1.1.0 | MIT License | github.com/HubSpot/tether */
!function(d,e){"function"==typeof define&&define.amd?define(e):"object"==typeof c?b.exports=e(a,c,b):d.Tether=e()}(this,function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a){var b=void 0;a===document?(b=document,a=document.documentElement):b=a.ownerDocument;var c=b.documentElement,d={},e=a.getBoundingClientRect();for(var f in e)d[f]=e[f];var g=n(b);return d.top-=g.top,d.left-=g.left,"undefined"==typeof d.width&&(d.width=document.body.scrollWidth-d.left-d.right),"undefined"==typeof d.height&&(d.height=document.body.scrollHeight-d.top-d.bottom),d.top=d.top-c.clientTop,d.left=d.left-c.clientLeft,d.right=b.body.clientWidth-d.width-d.left,d.bottom=b.body.clientHeight-d.height-d.top,d}function f(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],b=[];return Array.prototype.push.apply(b,arguments),b.slice(1).forEach(function(b){if(b)for(var c in b)({}).hasOwnProperty.call(b,c)&&(a[c]=b[c])}),a}var g=window.AwsUi.__DomUtils,h=g.removeClass,i=g.addClass,j=g.hasClass,k=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),l=function(){var a=0;return function(){return++a}}(),m={},n=function(a){
// getBoundingClientRect is unfortunately too accurate.  It introduces a pixel or two of
// jitter as the user scrolls that messes with our ability to detect if two positions
// are equivilant or not.  We place an element at the top left of the page that will
// get the same jitter, so we can cancel the two out.
var b=a._tetherZeroElement;"undefined"==typeof b&&(b=a.createElement("div"),b.setAttribute("data-tether-id",l()),f(b.style,{top:0,left:0,position:"absolute"}),a.body.appendChild(b),a._tetherZeroElement=b);var c=b.getAttribute("data-tether-id");if("undefined"==typeof m[c]){m[c]={};var d=b.getBoundingClientRect();for(var e in d)
// Can't use extend, as on IE9, elements don't resolve to be hasOwnProperty
m[c][e]=d[e];
// Clear the cache when this position call is done
p(function(){delete m[c]})}return m[c]},o=[],p=function(a){o.push(a)},q=function(){function a(){d(this,a)}return k(a,[{key:"on",value:function(a,b,c){var d=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];"undefined"==typeof this.bindings&&(this.bindings={}),"undefined"==typeof this.bindings[a]&&(this.bindings[a]=[]),this.bindings[a].push({handler:b,ctx:c,once:d})}},{key:"once",value:function(a,b,c){this.on(a,b,c,!0)}},{key:"off",value:function(a,b){if("undefined"==typeof this.bindings||"undefined"==typeof this.bindings[a])if("undefined"==typeof b)delete this.bindings[a];else for(var c=0;c<this.bindings[a].length;)this.bindings[a][c].handler===b?this.bindings[a].splice(c,1):++c}},{key:"trigger",value:function(a){if("undefined"!=typeof this.bindings&&this.bindings[a])for(var b=0;b<this.bindings[a].length;){var c=this.bindings[a][b],d=c.handler,e=c.ctx,f=c.once,g=e;"undefined"==typeof g&&(g=this);for(var h=arguments.length,i=Array(h>1?h-1:0),j=1;j<h;j++)i[j-1]=arguments[j];d.apply(g,i),f?this.bindings[a].splice(b,1):++b}}}]),a}(),r={};return r.Utils={getBounds:e,extend:f,addClass:i,removeClass:h,hasClass:j,Evented:q},r})},{}],3:[function(a,b,c){"use strict";function d(a){return function(){this.__select.setOption(a,this[a])}}function e(a,b){return void 0===b&&(b=void 0),function(){var c=this[a];void 0!==b&&(c=this[a]||b),this.__select.setAttr(a,c)}}var f=a("./select");AwsUi.__addComponent("awsui-select",{releaseStatus:"preview",callbacks:{initialized:function(){var a=this;this.__select=new f.default({className:"",classPrefix:"awsui-select"},[]),this.__select.on("change",function(b){a.value=b.value,a.__fireEvent("change")}),this.__handleFocus=function(){return a.__fireEvent("focus")},this.__handleBlur=function(){return a.__fireEvent("blur")}},attached:function(){this.__select.attach(),this.__select.target.addEventListener("focus",this.__handleFocus),this.__select.target.addEventListener("blur",this.__handleBlur)},detached:function(){this.__select.detach(),this.__select.target.removeEventListener("focus",this.__handleFocus),this.__select.target.removeEventListener("blur",this.__handleBlur)}},properties:{items:{type:"array",itemType:"Option",onChange:e("items",[])},placeholder:{type:"string",onChange:d("placeholder")},value:{type:"string",onChange:e("value")},disabled:{type:"boolean",onChange:function(){this.__select.setDisabled(this.disabled)}},adjustWidth:{type:"boolean",onChange:d("adjustWidth")}},events:{change:{bubbles:!0,cancelable:!1},focus:{bubbles:!1,cancelable:!1},blur:{bubbles:!1,cancelable:!1}},functions:{focus:function(){this.__select.focus()},blur:function(){this.node.contains(document.activeElement)&&this.__select.blur()}},render:function(a,b){var c=this;return a("span",{config:function(a,b){b||(a.appendChild(c.__select.target),a.appendChild(c.__select.drop))}})},wrapperSupport:{ngModel:{value:"value",event:"change"}}})},{"./select":1}]},{},[3]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){AwsUi.__addComponent("awsui-tabs",{releaseStatus:"preview",properties:{tabs:{type:"array",itemType:"Tab"},activeTabId:{type:"string"},variant:{type:"string",valid:["borderless","bordered"],defaultValue:"bordered",nullable:!1}},regions:{content:{isDefault:!0}},events:{change:{bubbles:!0,cancelable:!1}},render:function(a,b){var c=this,d=function(d){var e=new b.ClassBuilder(c);e.addClass("awsui-tabs-tab-link"),e.addClass("awsui-tabs-tab-active",c.activeTabId===d.id),e.addClass("awsui-tabs-tab-disabled",d.disabled);var f={className:e.toClassName(),onclick:function(a){a.preventDefault(),d.disabled||d.id!==c.activeTabId&&(c.activeTabId=d.id,c.__fireEvent("change"))}};d.disabled?f["aria-disabled"]=!0:f.href="#";var g=a("a",f,d.label);return a("li",{className:"awsui-tabs-tab"},g)},e=a("ul",{className:"awsui-tabs-container"},(this.tabs||[]).map(d)),f=a("div",{className:"awsui-tabs-panel"},b.region("content","div",{className:"awsui-tabs-content-container"})),g=new b.ClassBuilder(this);return g.addPropertyValueClass("variant"),a("div",{className:g.toClassName()},e,f)},wrapperSupport:{ngModel:{value:"activeTabId",event:"change"}}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){return"awsui-textarea-"+f++}var e=function(a){return a.node.firstChild},f=0;AwsUi.__addComponent("awsui-textarea",{releaseStatus:"stable",callbacks:{initialized:function(){this.controlId||(this.controlId=d())}},events:{blur:{bubbles:!0,cancelable:!1},change:{bubbles:!0,cancelable:!0},focus:{bubbles:!0,cancelable:!1},input:{bubbles:!0,cancelable:!0},keydown:{bubbles:!0,cancelable:!0,detailTypeName:"KeyEvent"},keyup:{bubbles:!0,cancelable:!0,detailTypeName:"KeyEvent"}},render:function(a,b){var c=this,d=this,e=b.browserCapabilities.inputEvent,f=["placeholder","disabled","rows"],g=b.copyDefined(d,f),h=function(a){return a.target.value!==c.value},i=a.withAttr("value",function(a){return c.value=a}),j=b.newEventHandler("input",i);g.config=function(a){a.value!==d.value&&(a.value=d.value||"")},d.controlId&&(g.id=d.controlId),g.className="awsui-textarea",g.onblur=b.newEventHandler("blur"),g.onfocus=b.newEventHandler("focus");var k=function(a){return d.__fireEvent("keydown",{keyCode:a.keyCode,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey})};if(g.onkeydown=k,g.onkeyup=function(a){return d.__fireEvent("keyup",{keyCode:a.keyCode,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey})},e)g.oninput=j,g.onchange=b.newEventHandler("change",i);else{var l=function(a){return!!h(a)&&void(c.value=a.target.value)},m=b.newDeferredEventHandler("input",l);g.onkeydown=function(a){k(a),m(a)},g.oncut=m,g.onpaste=m,g.onchange=function(a){return function(b){a(b)!==!1&&d.__fireEvent("change")}}(b.newEventHandler("input",l))}return a("textarea",g)},functions:{focus:function(){e(this).focus()},blur:function(){e(this).blur()}},properties:{value:{type:"string"},placeholder:{type:"string"},disabled:{type:"boolean"},controlId:{type:"string",announceValue:!0},rows:{type:"integer",defaultValue:3}},wrapperSupport:{ngModel:{value:"value",event:"input"}}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){return"awsui-textfield-"+f++}var e=function(a){return a.node.querySelector("input")},f=0;AwsUi.__addComponent("awsui-textfield",{releaseStatus:"stable",callbacks:{initialized:function(){this.controlId||(this.controlId=d())}},events:{blur:{bubbles:!0,cancelable:!1},change:{bubbles:!0,cancelable:!0},focus:{bubbles:!0,cancelable:!1},input:{bubbles:!0,cancelable:!0},keydown:{bubbles:!0,cancelable:!0,detailTypeName:"KeyEvent"},keyup:{bubbles:!0,cancelable:!0,detailTypeName:"KeyEvent"}},render:function(a,b){function c(){if("search"===e.type)return a("span",{className:"awsui-textfield-icon awsui-icon search awsui-icon-subtle"})}var d=this,e=this,f=b.browserCapabilities.inputEvent,g=["placeholder","disabled","type"],h=b.copyDefined(e,g),i=function(a){return a.target.value!==d.value},j=a.withAttr("value",function(a){return d.value=a}),k=b.newEventHandler("input",j);h.value=this.value||"",h.autocomplete=this.autocomplete?"on":"off",h.autofocus=this.autofocus,e.controlId&&(h.id=e.controlId);var l=new b.ClassBuilder(this);l.addClass("awsui-textfield"),l.addPropertyValueClass("type"),h.className=l.toClassName(),h.onblur=b.newEventHandler("blur"),h.onfocus=b.newEventHandler("focus");var m=function(a){return{keyCode:a.keyCode,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey}},n=function(a){return e.__fireEvent("keydown",m(a))};if(h.onkeydown=n,h.onkeyup=function(a){return e.__fireEvent("keyup",m(a))},f)h.oninput=k,h.onchange=b.newEventHandler("change",j);else{var o=function(a){return!!i(a)&&void(d.value=a.target.value)},p=b.newDeferredEventHandler("input",o);h.onkeydown=function(a){n(a),p(a)},h.oncut=p,h.onpaste=p,h.onchange=function(a){return function(b){a(b)!==!1&&e.__fireEvent("change")}}(b.newEventHandler("input",o))}return[c(),a("input",h)]},functions:{focus:function(){e(this).focus()},blur:function(){e(this).blur()}},properties:{value:{type:"string"},type:{type:"string",defaultValue:"text",valid:["text","password","search"]},placeholder:{type:"string"},disabled:{type:"boolean"},autocomplete:{type:"boolean",defaultValue:!0},autofocus:{type:"boolean"},controlId:{type:"string",announceValue:!0}},wrapperSupport:{ngModel:{value:"value",event:"input"}}})},{}]},{},[1]),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";AwsUi.__addComponent("awsui-tooltip",{releaseStatus:"experimental",properties:{text:{type:"string"},position:{type:"string",nullable:!0,valid:["top","right","bottom","left"]},size:{type:"string",defaultValue:"auto",nullable:!1,valid:["auto","small","medium","large"]}},regions:{trigger:{isDefault:!0}},render:function(a,b){var c={"aria-label":this.text};if(!this.position||!this.text)return b.region("trigger","span",c);var d=new b.ClassBuilder(this);return d.addClass("awsui-tooltip").addClass("awsui-tooltip-rounded").addClass("awsui-tooltip-no-slide").addClass("awsui-tooltip-wrap","auto"!==this.size).addClass("awsui-tooltip-"+this.position).addPropertyValueClass("size"),c["data-awsui-tooltip-text"]=this.text,c.className=d.toClassName(),b.region("trigger","span",c)}})},{}]},{},[1]);(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
var component = require("./directives/component");
var domRegion = require("./directives/dom-region");
angular.module('AWS-UI-Components', [domRegion.name, component.name]);
function registerComponent(componentName) {
    var componentDef = AwsUi.__componentDefinitions[componentName];
    component.defineComponent(componentName, componentDef);
}
exports.registerComponent = registerComponent;
function registerAllComponents() {
    for (var componentName in AwsUi.__componentDefinitions) {
        registerComponent(componentName);
    }
}
exports.registerAllComponents = registerAllComponents;

},{"./directives/component":2,"./directives/dom-region":3}],2:[function(require,module,exports){
"use strict";
var utils = require("../utils");
exports.name = 'components';
var module = angular.module(exports.name, []);
function toPropValue(component, propertyName, value) {
    var propertyDefinition = component.__propertiesDefinition[propertyName];
    return convertValueToPropertyType(value, propertyDefinition.type);
}
function convertValueToPropertyType(value, targetType) {
    switch (targetType) {
        case 'string':
            return (typeof value === 'undefined' || value === null) ? value : '' + value;
        case 'boolean':
            return Boolean(value);
    }
    return value;
}
function handleProperties(component, properties, attributes, scope) {
    utils.objectKeys(properties).forEach(function (attr) {
        if (!(attr in attributes))
            return;
        function setDefault() {
            component.__setFromString(attr, null);
        }
        function templateHandler(newVal) {
            if (newVal === '') {
                setDefault();
            }
            else {
                component[attr] = newVal;
            }
        }
        function handler(newVal) {
            var propValue = toPropValue(component, attr, newVal);
            if (angular.isDefined(propValue)) {
                component[attr] = propValue;
            }
            else {
                setDefault();
            }
        }
        var type = properties[attr].type || 'string';
        if (type === 'string' || type === 'region') {
            attributes.$observe(attr, templateHandler);
        }
        else {
            scope.$watch(attributes[attr], handler, ['object', 'array'].indexOf(type) >= 0);
        }
    });
}
function handleEvents(component, events, attributes, scope, element) {
    utils.objectKeys(events).forEach(function (eventName) {
        if (eventName in attributes) {
            element.on("awsui:" + eventName, function (event) {
                if (event.target === this) {
                    scope.$apply(function () {
                        scope.$eval(attributes[eventName], {
                            '$event': event,
                            'event': event,
                        });
                    });
                }
            });
        }
    });
}
function handleFunctions(component, functions, attributes, scope, $parse) {
    utils.objectKeys(functions).forEach(function (functionName) {
        var attribute = attributes[functionName + "Fn"];
        if (!attribute) {
            return;
        }
        var parsedFn = $parse(attributes[functionName + "Fn"]);
        if (parsedFn.assign) {
            var fn = function () { return component[functionName].apply(component, arguments); };
            parsedFn.assign(scope, fn);
        }
    });
}
function handleRegionsAsElements(transcludeFn, scope, component) {
    transcludeFn(scope, function (childNodes, childScope) {
        var looseNodes = [];
        var regionsDefined = false;
        for (var i = 0; i < childNodes.length; i++) {
            var node = childNodes[i];
            if (node.nodeType == Node.TEXT_NODE && node.textContent.match(/^\s*$/)) {
                continue;
            }
            if (node.getAttribute && node.getAttribute('dom-region')) {
                regionsDefined = true;
                continue;
            }
            looseNodes.push(node);
        }
        if (looseNodes.length === 0) {
            return;
        }
        if (regionsDefined) {
            for (var _i = 0, looseNodes_1 = looseNodes; _i < looseNodes_1.length; _i++) {
                var node_1 = looseNodes_1[_i];
                if (node_1.nodeType !== Node.COMMENT_NODE) {
                    throw new Error("Nodes outside a dom-region are not allowed when a dom-region has been explicitly defined");
                }
            }
            return;
        }
        var defaultRegion = angular.element('<span>');
        defaultRegion.append(looseNodes);
        component.setDefaultRegion(defaultRegion[0]);
    });
}
function addNgModelSupport(ngModelSupport, component, element, ngModelController, scope) {
    var propertyName = ngModelSupport.value;
    element.on('awsui:' + ngModelSupport.event, function (event) {
        if (event.target !== element[0]) {
            return;
        }
        scope.$apply(function () {
            return ngModelController.$setViewValue(component[propertyName], event);
        });
    });
    ngModelController.$render = function () {
        return component[ngModelSupport.value] = toPropValue(component, propertyName, ngModelController.$viewValue);
    };
    element.on('awsui:blur', function () {
        scope.$evalAsync(function () {
            ngModelController.$setTouched();
        });
    });
}
function defineComponent(componentName, def) {
    module.directive(utils.toCamelCase(componentName), ['$parse', function ($parse) {
            var ngModelSupport = def.wrapperSupport && def.wrapperSupport.ngModel;
            return {
                restrict: 'E',
                transclude: true,
                require: ngModelSupport ? '?ngModel' : undefined,
                link: function (scope, $element, iAttrs, ngModelController, transcludeFn) {
                    $element.html('');
                    AwsUi.activate($element[0]);
                    var component = $element[0].component;
                    var childScope = scope.$new();
                    childScope.component = component;
                    handleProperties(component, def.properties, iAttrs, scope);
                    handleRegionsAsElements(transcludeFn, childScope, component);
                    handleFunctions(component, def.functions, iAttrs, scope, $parse);
                    if (ngModelSupport && ngModelController) {
                        addNgModelSupport(ngModelSupport, component, $element, ngModelController, scope);
                    }
                    $element.removeAttr('disabled');
                    handleEvents(component, def.events, iAttrs, scope, $element);
                    if (document.body.contains($element[0])) {
                        component.hasBeenAttached();
                    }
                    else {
                        console.error('Element was not in DOM when linked, cannot call hasBeenAttached() properly:', $element[0]);
                    }
                    $element.on('$destroy', function () {
                        component.hasBeenDetached();
                    });
                }
            };
        }]);
}
exports.defineComponent = defineComponent;

},{"../utils":4}],3:[function(require,module,exports){
"use strict";
exports.name = 'domRegion';
var module = angular.module(exports.name, []);
module.directive('domRegion', function () {
    return {
        restrict: 'A',
        link: {
            pre: function ($scope, $element, $attrs) {
                var component = $scope.component;
                component.setRegion($attrs.domRegion, $element[0]);
                $element.on('$destroy', function () {
                    component.removeRegion($attrs.domRegion);
                });
            }
        }
    };
});

},{}],4:[function(require,module,exports){
"use strict";
var SPECIAL_CHARS_REGEXP = /([\:\-\_]+(.))/g;
function toCamelCase(string) {
    return string.replace(SPECIAL_CHARS_REGEXP, function (_, separator, letter, offset) {
        return offset ? letter.toUpperCase() : letter;
    });
}
exports.toCamelCase = toCamelCase;
function objectKeys(object) {
    return Object.keys(object || {});
}
exports.objectKeys = objectKeys;

},{}],5:[function(require,module,exports){
"use strict";
var angularComponents = require("./angular-components");
angularComponents.registerAllComponents();
AwsUi.__angular = angularComponents;

},{"./angular-components":1}]},{},[5]);

!(function (global, app) {

  const NGINX_DOMAIN_PARTS = ['.connect.aws', '.my.gamma.', '.my.dev.'];

  function isNginxDomain() {
    return NGINX_DOMAIN_PARTS.some(part => global.location.hostname.includes(part));
  }

  function getPathPrefix() {
    if (isNginxDomain()) {
      return ''
    }
    return '/' + global.location.pathname.split('/').filter(x => x)[0];
  }

  app.helpers = {
    getPathPrefix: getPathPrefix
  };
}(
  window,
  window.LILY_FLOWS_APP || (window.LILY_FLOWS_APP = {})
));

(function (global, globalApp) {

  const PATHS = {
    // LFEW APIS
    BOOTSTRAP: () => `/bootstrap`,
    GET: (id, status) => `/flows?contactFlowArn=${id}${status ? `&contactFlowStatus=${status}` : ''}`,
    LIST: (nameFilter, maxResults, startingIndex) => `/flows-summary?nameFilter=${nameFilter}&startingIndex=${startingIndex}&maxResults=${maxResults}`,
    UPDATE: () => `/flows/edit`,
    CREATE: () => `/flows/create`,
    EXPORT: (id, status) => `/flows/export?contactFlowArn=${id}&contactFlowStatus=${status}`,
    IMPORT: () => `/flows/import`,
    AUDIT: (id, timestamp) => `/flows-audit?contactFlowArn=${id}&versionTimestamp=${timestamp}`,
    VOICES: () => `/voices`,
    LEXBOTS: () => `/lexbots`,
    // LAW APIS
    AGENT_HIERARCHY: () => `/agent-grouping/group-level/get-all`
  };

  const API_ENDPOINT = '/contact-flows/api';
  const REFRESH_ENDPOINT = '/auth/refresh';
  const LOGIN_ENDPOINT = '/login';

  const CONF = {
    token: '',
    apiDomain: ''
  };

  function getFullPath(path) {
    return CONF.apiDomain ? `${CONF.apiDomain}${path}` : `${globalApp.helpers.getPathPrefix()}${path}`;
  }

  function getFullLAWPath(path) {
    return `${globalApp.helpers.getPathPrefix()}${path}`;
  }

  function baseRequest(url, method, payload, headers = {}) {
    const config = {
      method: method,
      headers: {
        'Content-Type': 'application/json',
        ...headers
      },
      credentials: 'include'
    };
    if (method !== 'GET') {
      config.body = JSON.stringify(payload);
    }
    return global.fetch(url, config);
  }

  function withRefreshAttemptOnAuthError(requestFn) {
    return requestFn().then(response => {
      // Not authorized => try to refresh cookie once
      if (!response.ok && response.status === 403) {
        return fetch(getFullLAWPath(REFRESH_ENDPOINT)).then(() => {
          return requestFn();
        });
      }
      return response;
    });
  }

  function request(path, method, payload) {
    const url = `${getFullPath(API_ENDPOINT)}${path}`;
    const headers = ['POST', 'PUT'].includes(method)
      ? { 'csrf-token': CONF.token }
      : {};
    return withRefreshAttemptOnAuthError(() => baseRequest(url, method, payload, headers))
      .then(response => {
        // Still no authorized after one refresh attempt => redirect to login page
        if (!response.ok) {
          if (response.status === 403) {
            global.location.replace(getFullLAWPath(LOGIN_ENDPOINT));
          }
          try {
            return response.json().then((value) => Promise.reject({ data: value, status: response.status }));
          } catch (e) {
            return Promise.reject(response);
          }
        }
        return response;
      })
      .then(response => response.json());
  }

  function lawRequest(path, method, payload) {
    return baseRequest(getFullLAWPath(path), method, payload)
      .then(response => response.json());
  }

  function configure(apiDomain) {
    CONF.apiDomain = apiDomain;
  }

  function bootstrap() {
    return request(PATHS.BOOTSTRAP(), 'GET', {}).then(response => {
      CONF.token = response.csrfToken;
      return response;
    });
  }

  function get(id, status) {
    return request(PATHS.GET(id, status), 'GET');
  }

  function list(nameFilter, maxResults, startingIndex) {
    return request(PATHS.LIST(nameFilter, maxResults, startingIndex), 'GET').then(response => {
      return {
        results: response.contactFlows,
        searchLength: response.totalCount
      };
    });
  }

  function update(flow) {
    return request(PATHS.UPDATE(), 'POST', flow).then(response => {
      return [response];
    }).catch(response => {
      return Promise.reject({ ...response, data: response.data.errors });
    });
  }

  function create(flow) {
    return request(PATHS.CREATE(), 'PUT', flow).then(response => {
      return [response];
    }).catch(response => {
      return Promise.reject({ ...response, data: response.data.errors });
    });
  }

  function exportFlow(id, status) {
    return request(PATHS.EXPORT(id, status), 'GET').then(response => {
      return [response];
    }).catch(response => {
      return Promise.reject({ ...response, data: response.data.errors });
    });
  }

  function importFlow(flowType, data) {
    return request(PATHS.IMPORT(), 'POST', {
      fileData: data,
      contactFlowType: flowType
    }).then(response => {
      return [response];
    }).catch(response => {
      return Promise.reject({ ...response, data: response.data.errors });
    });
  }

  function getVoices() {
    return request(PATHS.VOICES(), 'GET').then(response => {
      return response.voiceList;
    });
  }

  function listLexBots() {
    return request(PATHS.LEXBOTS(), 'GET').then(response => {
      return response.lexBots;
    });
  }

  function getContactFlowAudit(id, versionTimestamp) {
    return request(PATHS.AUDIT(id, versionTimestamp), 'GET').then(response => {
      return [{
        fieldChanges: [{
          fieldName: "content",
          before: response.contactFlowContent.before,
          after: response.contactFlowContent.after
        }, {
          fieldName: "status",
          before: response.contactFlowStatus.before,
          after: response.contactFlowStatus.after
        }],
        user: response.user,
        time: response.time
      }];
    });
  }

  function getAgentHierarchyLevels() {
    return lawRequest(PATHS.AGENT_HIERARCHY(), 'GET', {});
  }

  const service = {
    configure: configure,
    bootstrap: bootstrap,
    get: get,
    list: list,
    update: update,
    create: create,
    export: exportFlow,
    import: importFlow,
    getVoices: getVoices,
    listLexBots: listLexBots,
    getContactFlowAudit: getContactFlowAudit,
    getAgentHierarchyLevels: getAgentHierarchyLevels
  };

  globalApp.flowService = service;

}(
  window,
  window.LILY_FLOWS_APP || (window.LILY_FLOWS_APP = {})
));

!(function (global, globalApp, globalStrings) {
  var elementName = 'lily-contact-flows';
  var ContactFlowsView = {
    EDIT: "EDIT",
    CREATE: "CREATE",
    VIEW: "VIEW",
    SEARCH: "SEARCH"
  };

  var Permissions = {
    VIEW: "ContactFlows.View",
    PUBLISH: "ContactFlows.Publish",
    EDIT: "ContactFlows.Edit",
    CREATE: "ContactFlows.Create",
    HISTORICAL_CHANGES: "HistoricalChanges.View"
  };

  var ContactFlowType = {
    CONTACT_FLOW: "contactFlow",
    CUSTOMER_QUEUE_FLOW: "customerQueue",
    CUSTOMER_HOLD_FLOW: "customerHold",
    CUSTOMER_WHISPER_FLOW: "customerWhisper",
    OUTBOUND_WHISPER_FLOW: "outboundWhisper",
    AGENT_HOLD_FLOW: "agentHold",
    AGENT_WHISPER_FLOW: "agentWhisper",
    AGENT_TRANSFER_FLOW: "agentTransfer",
    QUEUE_TRANSFER_FLOW: "queueTransfer"
  };

  var FlowTypeSuffix = {};
  FlowTypeSuffix[ContactFlowType.CONTACT_FLOW] = "";
  FlowTypeSuffix[ContactFlowType.CUSTOMER_QUEUE_FLOW] = "-customer-queue";
  FlowTypeSuffix[ContactFlowType.CUSTOMER_HOLD_FLOW] = "-customer-hold";
  FlowTypeSuffix[ContactFlowType.CUSTOMER_WHISPER_FLOW] = "-customer-whisper";
  FlowTypeSuffix[ContactFlowType.OUTBOUND_WHISPER_FLOW] = "-outbound-whisper";
  FlowTypeSuffix[ContactFlowType.AGENT_HOLD_FLOW] = "-agent-hold";
  FlowTypeSuffix[ContactFlowType.AGENT_WHISPER_FLOW] = "-agent-whisper";
  FlowTypeSuffix[ContactFlowType.AGENT_TRANSFER_FLOW] = "-transfer-to-agent";
  FlowTypeSuffix[ContactFlowType.QUEUE_TRANSFER_FLOW] = "-transfer-to-queue";

  var errorTemplates = {
    'UnauthorizedAccessException':"access-denied",
    'AccessDeniedException':"access-denied",
    'NotFoundException':"not-found-error",
    'UnknownEntityException':"not-found-error",
    'ThrottlingError': "throttling-error",
    'lily-admin-resource-not-found-error':"not-found-error"
  }
  function arrayToBooleanMap(arr) {
    return arr.reduce(function (acc, item) {
      acc[item] = true;
      return acc;
    }, {});
  }

  function getView() {
    var path = global.location.pathname;
    if (/\/edit$/.test(path)) {
      return ContactFlowsView.EDIT;
    } else if (/\/create$/.test(path)) {
      return ContactFlowsView.CREATE;
    } else if (/\/view$/.test(path)) {
      return ContactFlowsView.VIEW;
    }
    return ContactFlowsView.SEARCH;
  }

  function setStrings(strings) {
    global.localizedStrings = Object.assign(global.localizedStrings || {}, {'contact-flow-js': strings});
  }

  class ContactFlowsApp {
    constructor(region, token, strings, features, lcsFeatures, organization, organizationQuota, permissions, requestPathPrefix) {
      this.lexRealm = region.indexOf("us-west-2") === 0 ? "us-west-2" : "us-east-1";
      this.canTtsLeaveRegion = false;
      this.token = token;
      this.strings = strings;
      this.features = arrayToBooleanMap(features);
      this.lcsFeatures = arrayToBooleanMap(lcsFeatures);
      this.organization = organization;
      this.organizationQuota = organizationQuota;
      this.permissions = arrayToBooleanMap(permissions);
      var searchParams = new URLSearchParams(global.location.search);
      this.id = searchParams.get("id") || "";
      this.type = searchParams.get("type") || "";
      this.status = searchParams.get("status") || "";
      this.versionTimestamp = searchParams.get("versionTimestamp") || "";
      this.requestPathPrefix = requestPathPrefix || globalApp.helpers.getPathPrefix();
      document.requestPathPrefix = document.requestPathPrefix || this.requestPathPrefix;
      this.view = getView();
    }

    onInitComplete(contactFlow) {
      var titleElement = document.querySelector("head > title");
      var prefix = global.localizedStrings['contact-flow-js']['lily-admin-title'];
      var subtitle;
      if (this.view === ContactFlowsView.SEARCH) {
        subtitle = global.localizedStrings['contact-flow-js']['lily-admin-page-type-title-contact-flow-editor'];
      } else if (this.view === ContactFlowsView.VIEW) {
        subtitle = global.localizedStrings['contact-flow-js']['lily-admin-page-type-title-contact-flow-editor-view'];
      } else {
        var type = this.view === ContactFlowsView.EDIT ? contactFlow.contactFlowType : this.type;
        var typeSuffix = FlowTypeSuffix[type];
        var actionSuffix = this.view === ContactFlowsView.EDIT ? "-edit" : "-create";
        subtitle = global.localizedStrings['contact-flow-js']['lily-admin-page-type-title-contact-flow-editor' + actionSuffix + typeSuffix];
      }
      titleElement.innerHTML = `${prefix} - ${subtitle}`;
    }
    
    onInitError(data) {
      var app = angular.module('ContactFlowsError', []);
      var errorType = data.messageId;

      app.run(['$rootScope', function ($rootScope) {
        $rootScope.localizedStrings = global.localizedStrings['contact-flow-js'];      
        $rootScope.data = data;
        $rootScope.getLocalizationStringWithVariable = function(stringName, variableObject){
          var localizedString = $rootScope.localizedStrings[stringName];
          localizedString = localizedString? localizedString:"";
          for(var key of Object.keys(variableObject)){
            localizedString = localizedString.replace(new RegExp('\\\${\\s*' + key + '\\s*}','g'), variableObject[key]);
          }
          return localizedString          
        }
        
      }]);

      if(!errorType && data.status > 400){
        if(data.status === 404){
          errorType = 'NotFoundException';
        } else if (data.status === 429) {
          errorType = 'ThrottlingError';
        } else {
          errorType = 'InternalError';
        }
      }

      angular.element(elementName)[0].innerHTML = this.getErrorTemplate(errorType, data.exceptionId);
      angular.bootstrap($('#errorBodyContainer'), ['ContactFlowsError']);
      $('#errorBodyContainer').show();
      
    }
  

    getErrorTemplate(errorType, exceptionId){
      if(Object.keys(this.permissions).length > 0 && !this.hasSufficientPermissions()){
        return global.GLOBAL_TEMPLATES["src/error-pages/access-denied.html"];
      }
      var templateName = errorTemplates[errorType];
      if(!templateName){
        templateName = exceptionId? 'general-error':'exception-resolver-error';
      }
      
      return global.GLOBAL_TEMPLATES["src/error-pages/" + templateName + '.html'];
    }

    startApp() {
      setStrings(this.strings);
      if (!this.hasSufficientPermissions()) {
        this.initErrorApp();
      } else if (this.view === ContactFlowsView.SEARCH) {
        this.initSearchApp();
      } else {
        globalApp.LilyContactFlowINIT();
        var features = {
          isConsolidatedLexAttributesEnabled: this.features.contactFlowConsolidatedLexAttributes,
          isTaskContactAttributesEnabled: this.features.taskContactAttribute,
          isLexSentimentOverrideEnabled: this.features.lexSentimentOverride,
          isExpandedNamespaceDropdownEnabled: this.features.contactFlowExpandedNamespaceDropdown,
          isContactFlowHistoricalChangeEnabled: this.features.contactFlowHistoricalChange,
          isSetContactFlowBlockFeatureEnabled: this.features.setContactFlowBlock,
          isSetVoiceBlockWithNTTSVoicesEnabled: this.features.setVoiceBlockWithNTTSVoices,
          isSetVoiceBlockWithNTTSConversationalVoicesEnabled: this.features.setVoiceBlockWithNTTSConversationalVoices,
          isContinueBranchOnWaitBlockEnabled: this.features.continueBranchOnWaitBlock,
          isSupportCustomerQueueFlowWithoutLoopPromptsEnabled: this.features.supportCustomerQueueFlowWithoutLoopPrompts,
          isContactLensRealTimeEnabled: this.features.contactLensRealTime,
          isContactLensGAEnabled: this.lcsFeatures.CONTACT_LENS_GA,
          isContactAnalyticsFeatureEnabled: this.features.contactAnalyticsFeature,
          isSetRoutingProficiencyBlockFeatureEnabled: this.features.setRoutingBehaviorBlock,
          isStoreCustomerInputTerminatorFeatureEnabled: this.features.storeCustomerInputTerminator,
          isFlowModuleEnabled: this.features.flowModule,
          isUseVoiceAuthenticationEnabled: this.features.useVoiceAuthentication,
          isCheckOutboundCallStatusEnabled: this.features.checkOutboundCallStatus,
          isAutoResolveToBestSoundingVoiceEnabled: this.features.setVoiceBlockWithNTTSConversationalVoices ? this.lcsFeatures.AUTO_RESOLVE_TO_BEST_SOUNDING_POLLY_VOICES : false,
          isQueueMetricsChannelFilterEnabled: this.features.getQueueMetricsChannelFilter,
          isLexV2Enabled: this.features.contactFlowLexBotV2
        };
        features = Object.entries(features).reduce((a,[k,v]) => (v !== true? a : (a[k]=v, a)), {});

        global.LilyContactFlow.initializeFeatureAccess(features);
        this.initEditApp();
      }
    }

    /**
     * Initialization of search app. Mostly unchanged from original implementation within LilyAdminWebsiteContent.
     * Additional variables on $rootScope to give access to gobal configuration (previously handled within JSP)
     * 
     * Original code:
     * https://code.amazon.com/packages/LilyAdminWebsiteContent/blobs/fd87fcf052547b0b1b78a8e4a33b4433e5c67281/--/webapp/WEB-INF/jsp/admin/contact-flows/search.jsp#L17
     */
    initSearchApp() {
      var initData = this.getInitData();
      var app = angular.module('contactflow', [
        'ui.bootstrap.pagination', 'template/pagination/pagination.html',  // pagination
        'ui.bootstrap', //dropdown
        'Search.SearchDirectives', // directives
        'Search.SearchController', // controllers
        'AWS-UI-Components'
      ]);
      app.constant("urlEntity", "contact-flows");
    
      // define variables on rootScope to cover
      app.run(['$rootScope', function ($rootScope) {
        $rootScope.localizedStrings = global.localizedStrings['contact-flow-js'];
        $rootScope.globals = initData;
      }]);
    
      $(document).ready(function() {
        angular.bootstrap($('#angularContainer'), ['contactflow']);
        $('#angularContainer').show();
      });
      this.onInitComplete();
    }
  
    /**
     * Initialization of edit app. Mostly unchanged from original implementation within LilyAdminWebsiteContent.
     * Additional variables on $rootScope to give access to gobal configuration (previously handled within JSP)
     * 
     * Original code:
     * https://code.amazon.com/packages/LilyAdminWebsiteContent/blobs/e5c7658d9d4f9d0b151d8c869589402567e745ee/--/webapp/WEB-INF/jsp/admin/contact-flows/edit.jsp#L28
     */
    initEditApp() {
      var initData = this.getInitData();
      $(document).ready(function() {
          var app = angular.module('ContactFlowsMain', [
            'ContactFlowsModule',
            'tap.selectors', // selector widgets
            'ui.bootstrap', 'ui.bootstrap.progressbar', 'ui.select2', // progress bar, select2, etc
            'AWS-UI-Components', //Chocolate factory
            'Lily.InputFieldVerifications'
          ]);
          app.constant("id", initData.contactFlowId);
          app.constant("type", initData.contactFlowType);
          app.constant("token", initData.token);
          app.constant("canEdit", initData.canEdit);
          app.constant("isOrgContactFlowLoggingEnabled", "" + initData.isOrgContactFlowLoggingEnabled);
          app.constant("defaultLexRegion", initData.lexRealm);
          app.constant("status", initData.contactFlowStatus);
          app.constant("versionTimestamp", initData.timeStamp);
          app.constant("canViewHistoricalChanges", "" + initData.canViewHistoricalChanges);
          app.constant("entityType", initData.entityType);
    
          app.run(['$rootScope', function ($rootScope) {
            $rootScope.localizedStrings = global.localizedStrings['contact-flow-js'];
            $rootScope.globals = initData;
          }]);
    
          angular.bootstrap($('#angularContainer'), ['ContactFlowsMain']);
          $('#angularContainer').show();
      });
    }

    initErrorApp() {
      var app = angular.module('ContactFlowsError', []);
      app.run(['$rootScope', function ($rootScope) {
        $rootScope.localizedStrings = global.localizedStrings['contact-flow-js'];
      }]);
      angular.bootstrap($('#errorBodyContainer'), ['ContactFlowsError']);
      $('#errorBodyContainer').show();
    }
  
    getHtml() {
      if (!this.hasSufficientPermissions()) {
        return global.GLOBAL_TEMPLATES["src/error-pages/access-denied.html"]
      }
      if (this.view === ContactFlowsView.SEARCH) {
        return global.GLOBAL_TEMPLATES["src/html/admin/contact-flows/search.html"];
      } else {
        return global.GLOBAL_TEMPLATES["src/html/admin/contact-flows/edit.html"];
      }
    }
  
    hasSufficientPermissions() {
      return (
        (this.view === ContactFlowsView.SEARCH && this.permissions[Permissions.VIEW]) ||
        (this.view === ContactFlowsView.CREATE && this.permissions[Permissions.CREATE]) ||
        (this.view === ContactFlowsView.EDIT && this.permissions[Permissions.EDIT]) ||
        (this.view === ContactFlowsView.VIEW && this.permissions[Permissions.VIEW])
      );
    }
  
    getInitData() {
      if (this.view === ContactFlowsView.SEARCH) {
        return {
          requestPathPrefix: this.requestPathPrefix,
          canCreate: this.permissions[Permissions.CREATE],
          canEdit: this.permissions[Permissions.EDIT],
          canViewHistoricalChanges: this.permissions[Permissions.HISTORICAL_CHANGES]
        };
      } else {
        var initData = {
          requestPathPrefix: this.requestPathPrefix,
          token: this.token,
          canTtsLeaveRegion: this.canTtsLeaveRegion,
          lexRealm: this.lexRealm,
    
          allowNonE164CallerId: this.organizationQuota.allowNonE164CallerId,
          allowCustomCallerId: this.organizationQuota.allowCustomCallerId,
          isOrgContactFlowLoggingEnabled: this.organization.isContactFlowLoggingEnabled,
    
          isLexSentimentOverrideEnabled: this.features.lexSentimentOverride,
          canViewHistoricalChanges: this.features.contactFlowHistoricalChange,
          isContinueBranchOnWaitBlockEnabled: this.features.continueBranchOnWaitBlock,
          isContactAnalyticsFeatureEnabled: this.features.contactAnalyticsFeature,
          isStoreCustomerInputTerminatorFeatureEnabled: this.features.storeCustomerInputTerminator,
          isQueueMetricsChannelFilterEnabled: this.features.getQueueMetricsChannelFilter,
          isQueueMetricsTaskChannelEnabled: this.features.getQueueMetricsTaskChannel,
          isContactLensGAEnabled: this.lcsFeatures.CONTACT_LENS_GA,
          isTaskContactAttributesEnabled: this.features.taskContactAttribute,

          contactFlowId: this.id,
          contactFlowType: this.type,
          contactFlowStatus: this.status,
          timeStamp: this.versionTimestamp,
          entityType: "contactFlow"
        };
    
        if (this.view === ContactFlowsView.VIEW) {
          initData = Object.assign(initData, {
            canEdit: false
          });
        } else if (this.view === ContactFlowsView.EDIT) {
          initData = Object.assign(initData, {
            canEdit: true,
            canEditAfterCreate: true,
            canPublish: this.permissions[Permissions.PUBLISH]
          });
        } else if (this.view === ContactFlowsView.CREATE) {
          initData = Object.assign(initData, {
            canEdit: true,
            canEditAfterCreate: this.permissions[Permissions.EDIT],
            canPublish: this.permissions[Permissions.PUBLISH]
          });
        }
        return initData;
      }
    }
  
  }
  
  
  class ContactFlowsElement extends HTMLElement {

    init(initData) {
      globalApp.flowService.configure(initData.apiDomain);
      return globalApp.flowService.bootstrap().then(response => {
        const data = {
          ...initData,
          features: response.features,
          lcsFeatures: response.lcsFeatures,
          permissions: response.permissions,
          organization: response.organizationProperties,
          organizationQuota: response.organizationQuota
        };
        globalApp.app = this.createApp(data);
        this.innerHTML = globalApp.app.getHtml();
        globalApp.app.startApp();
      }, (response) => {
        const app = this.createApp({});
        app.startApp();
        app.onInitError({
          status: response.status >= 400 && response.status < 500 ? 429 : 500
        });
      });
    }

    createApp(initData) {
      return new ContactFlowsApp(
        initData.region || "",
        initData.token || "",
        globalStrings,
        initData.features || [],
        initData.lcsFeatures || [],
        initData.organization || {},
        initData.organizationQuota || {},
        initData.permissions || [],
        initData.requestPathPrefix || ""
      );
    }
  }

  global.customElements.define(elementName, ContactFlowsElement);

  // Only needed for testing with Jest
  if (typeof module !== "undefined") {
    module.exports.Permissions = Permissions;
    module.exports.ContactFlowsView = ContactFlowsView;
    module.exports.ContactFlowsApp = ContactFlowsApp;
    module.exports.ContactFlowsElement = ContactFlowsElement;
  }
  
}(
  window,
  window.LILY_FLOWS_APP || (window.LILY_FLOWS_APP = {}),
  {
    "lily-admin-contact-flow-entry-point-label": "Entry point",
    "lily-admin-flow-module-entry-point-label": "Module entry",
    "lily-admin-contact-flow-check-staffing-label": "Check staffing",
    "lily-admin-contact-flow-check-staffing-attribute-label-status": "Status",
    "lily-admin-contact-flow-check-hours-label": "Check hours of operation",
    "lily-admin-contact-flow-check-hours-attribute-label-checking": "Checking",
    "lily-admin-contact-flow-check-hours-attribute-label-current-queue": "Current queue",
    "lily-admin-contact-flow-check-attr-label": "Check contact attributes",
    "lily-admin-contact-flow-check-attr-attribute-label-checking": "Checking",
    "lily-admin-contact-flow-check-attr-attribute-label-checking-nothing": "Checking: nothing",
    "lily-admin-contact-flow-check-percent-routing-label": "Distribute by percentage",
    "lily-admin-contact-flow-loop-label": "Loop",
    "lily-admin-contact-flow-loop-attribute-label-loops": "Loops",
    "lily-admin-contact-flow-loop-attribute-label-dynamic": "dynamic",
    "lily-admin-contact-flow-wait-label": "Wait",
    "lily-admin-contact-flow-wait-attribute-label-timeout": "Timeout",
    "lily-admin-contact-flow-wait-attribute-label-dynamic": "dynamic",
    "lily-admin-contact-flow-wait-time-days": "Days",
    "lily-admin-contact-flow-wait-time-hours": "Hours",
    "lily-admin-contact-flow-wait-time-minutes": "Minutes",
    "lily-admin-contact-flow-wait-time-seconds": "Seconds",
    "lily-admin-contact-flow-module-wait-name": "Wait",
    "lily-admin-contact-flow-module-wait-description": "Waits for a specified period of time, and optionally for specified events. This block is supported for chat and tasks only.",
    "lily-admin-contact-flow-disconnect-label": "Disconnect",
    "lily-admin-contact-flow-disconnect-attribute-label": "Termination event",
    "lily-admin-contact-flow-end-flow-label": "End flow / Resume",
    "lily-admin-contact-flow-end-flow-attribute-label": "Termination event",
    "lily-admin-contact-flow-set-attr-label": "Set contact attributes",
    "lily-admin-contact-flow-set-attr-attribute-label-dynamic": "dynamic",
    "lily-admin-contact-flow-set-attr-attribute-label-output": "Output",
    "lily-admin-contact-flow-set-attr-attribute-label-multiple": "Multiple attributes",
    "lily-admin-contact-flow-set-voice-label": "Set voice",
    "lily-admin-contact-flow-set-voice-attribute-label-voice": "Voice",
    "lily-admin-contact-flow-set-voice-attribute-label-default": "default",
    "lily-admin-contact-flow-set-logging-behavior-label": "Set logging behavior",
    "lily-admin-contact-flow-set-logging-behavior-attribute-label-enabled": "Enable",
    "lily-admin-contact-flow-set-logging-behavior-attribute-label-disabled": "Disable",
    "lily-admin-contact-flow-transfer-number-label": "Transfer to phone number",
    "lily-admin-contact-flow-transfer-title-with-blind-transfer-support-description": "Transfers the customer to a phone number.",
    "lily-admin-contact-flow-transfer-number-attribute-label-none-selected": "None selected",
    "lily-admin-contact-flow-transfer-number-attribute-label-output": "Output",
    "lily-admin-contact-flow-set-recording-label": "Set call recording behavior",
    "lily-admin-contact-flow-set-recording-and-analytics-label": "Set recording and analytics behavior",
    "lily-admin-contact-flow-set-recording-attribute-label-both": "Agent and Customer",
    "lily-admin-contact-flow-set-recording-attribute-label-agent": "Agent",
    "lily-admin-contact-flow-set-recording-attribute-label-customer": "Customer",
    "lily-admin-contact-flow-set-recording-attribute-label-none": "None",
    "lily-admin-contact-flow-set-recording-attribute-label-enable": "Enable",
    "lily-admin-contact-flow-set-callback-label": "Set callback number",
    "lily-admin-contact-flow-set-callback-attribute-label": "Caller ID validation",
    "lily-admin-contact-flow-set-agent-status-label": "Hold customer or agent",
    "lily-admin-contact-flow-set-agent-status-attribute-label-none": "None selected",
    "lily-admin-contact-flow-set-agent-status-attribute-label-status": "Status",
    "lily-admin-contact-flow-set-agent-status-attribute-label-agent-hold": "Agent on hold",
    "lily-admin-contact-flow-set-agent-status-attribute-label-conference": "Conference all",
    "lily-admin-contact-flow-set-agent-status-attribute-label-customer-hold": "Customer on hold",
    "lily-admin-contact-flow-transfer-agent-label": "Transfer to agent (beta)",
    "lily-admin-contact-flow-transfer-agent-attribute-label-to": "To",
    "lily-admin-contact-flow-transfer-agent-attribute-label-transferred": "Transferred",
    "lily-admin-contact-flow-transfer-agent-attribute-label-dynamic": "dynamic",
    "lily-admin-contact-flow-transfer-flow-label": "Transfer to flow",
    "lily-admin-contact-flow-transfer-flow-attribute-label-to": "To",
    "lily-admin-contact-flow-transfer-flow-attribute-label-none-selected": "None selected",
    "lily-admin-contact-flow-transfer-flow-attribute-label-dynamic": "dynamic",
    "lily-admin-contact-flow-set-flow-none-selected": "Nothing selected",
    "lily-admin-contact-flow-set-hold-flow-label": "Set hold flow",
    "lily-admin-contact-flow-set-whisper-flow-label": "Set whisper flow",
    "lily-admin-contact-flow-set-cust-queue-flow-label": "Set customer queue flow",
    "lily-admin-contact-flow-set-disconnect-flow-label": "Set disconnect flow",
    "lily-admin-contact-flow-set-disconnect-flow-attribute-label-agent": "Agent",
    "lily-admin-contact-flow-set-disconnect-flow-attribute-label-customer": "Customer",
    "lily-admin-contact-flow-set-disconnect-flow-attribute-label-dynamic": "dynamic",
    "lily-admin-contact-flow-invoke-lambda-label": "Invoke AWS Lambda function",
    "lily-admin-contact-flow-invoke-lambda-attribute-label-invoke": "Invoke function",
    "lily-admin-contact-flow-invoke-module-label": "Invoke module",
    "lily-admin-contact-flow-invoke-module-attribute-label": "Module",
    "lily-admin-contact-flow-invoke-module-description": "Select a module to invoke in a contact flow.",
    "lily-admin-contact-flow-invoke-module-title": "Select a module to invoke in a contact flow.",
    "lily-admin-contact-flow-invoke-module-module-name": "Module name",
    "lily-admin-contact-flow-module-set-security-behavior-name": "Set security behavior",
    "lily-admin-contact-flow-module-set-security-behavior-description": "Enables or disables voice-based security and sets a threshold for authentication.",
    "lily-admin-contact-flow-module-set-security-behavior-attribute-label-recording-on": "Voice recording: On,",
    "lily-admin-contact-flow-module-set-security-behavior-attribute-label-recording-off": "Voice recording: Off.",
    "lily-admin-contact-flow-module-check-security-status-name": "Check security status",
    "lily-admin-contact-flow-module-check-security-status-description": "Branches based on the Set security behavior block.",
    "lily-admin-contact-flow-module-check-security-status-condition-authenticated": "Authenticated",
    "lily-admin-contact-flow-module-check-security-status-condition-not-authenticated": "Not authenticated",
    "lily-admin-contact-flow-module-check-security-status-condition-inconclusive": "Inconclusive",
    "lily-admin-contact-flow-module-check-security-status-condition-not-enrolled": "Not enrolled",
    "lily-admin-contact-flow-module-check-security-status-condition-opted-out": "Opted out",
    "lily-admin-contact-flow-module-check-outbound-call-status-name": "Check call progress",
    "lily-admin-contact-flow-module-check-outbound-call-status-description": "Branches on AMD (Automatic Machine Detection) to determine the next steps for handling outbound calls.",
    "lily-admin-flow-module-return-label": "Return",
    "lily-admin-flow-module-return-description": "Exit module",
    "lily-admin-contact-flow-play-audio-label": "Play prompt",
    "lily-admin-contact-flow-play-audio-attribute-label-none": "None",
    "lily-admin-contact-flow-play-audio-attribute-label-none-selected": "None selected",
    "lily-admin-contact-flow-play-audio-attribute-label-none-entered": "None entered",
    "lily-admin-contact-flow-play-audio-attribute-label-text": "Text",
    "lily-admin-contact-flow-play-audio-attribute-label-prompt": "Prompt",
    "lily-admin-contact-flow-play-audio-attribute-label-dynamic": "dynamic",
    "lily-admin-contact-flow-loop-audio-label": "Loop prompts",
    "lily-admin-contact-flow-loop-audio-attribute-label-audio-rec": "Audio recording",
    "lily-admin-contact-flow-loop-audio-attribute-label-multiple-prompts": "Multiple prompts",
    "lily-admin-contact-flow-loop-audio-minutes": "Minutes",
    "lily-admin-contact-flow-loop-audio-seconds": "Seconds",
    "lily-admin-contact-flow-get-customer-input-label": "Get customer input",
    "lily-admin-contact-flow-get-customer-input-branch-label-pressed": "Pressed",
    "lily-admin-contact-flow-get-customer-input-lex-sentiment-override": "Use sentiment override",
    "lily-admin-contact-flow-get-customer-input-lex-branch-negative-sentiment": "Branch on negative sentiment score",
    "lily-admin-contact-flow-get-customer-input-lex-branch-positive-sentiment": "Branch on positive sentiment score",
    "lily-admin-contact-flow-get-customer-input-lex-set-threshold-manual-label": "Set manually",
    "lily-admin-contact-flow-get-customer-input-lex-set-threshold-dynamic-label": "Use attribute",
    "lily-admin-contact-flow-store-customer-input-label": "Store customer input",
    "lily-admin-contact-flow-store-customer-input-attribute-label-custom": "Custom",
    "lily-admin-contact-flow-store-customer-input-attribute-label-phone-number": "Phone number",
    "lily-admin-contact-flow-store-customer-input-attribute-label-local": "local",
    "lily-admin-contact-flow-store-customer-input-attribute-label-international": "international",
    "lily-admin-contact-flow-store-customer-input-attribute-label-none-selected": "international",
    "lily-admin-contact-flow-transfer-queue-label": "Transfer to queue",
    "lily-admin-contact-flow-transfer-queue-to-check-label": "Queue to check (optional)",
    "lily-admin-contact-flow-transfer-queue-select-queue-label": "Select a queue",
    "lily-admin-contact-flow-transfer-queue-attribute-label-callback": "Callback",
    "lily-admin-contact-flow-transfer-queue-attribute-label": "Transfer to queue",
    "lily-admin-contact-flow-set-queue-label": "Set working queue",
    "lily-admin-contact-flow-set-queue-attribute-label-queue": "Queue",
    "lily-admin-contact-flow-set-queue-attribute-label-agent": "Agent",
    "lily-admin-contact-flow-set-queue-attribute-label-dynamic": "dynamic",
    "lily-admin-contact-flow-set-queue-attribute-label-none": "None",
    "lily-admin-contact-flow-set-queue-attribute-label-none-selected": "None selected",
    "lily-admin-contact-flow-check-queue-label": "Check queue status",
    "lily-admin-contact-flow-check-queue-attribute-label": "Checks queue status",
    "lily-admin-contact-flow-change-routing-age-label": "Change routing priority / age",
    "lily-admin-contact-flow-change-routing-age-attribute-label-priority": "Queue priority",
    "lily-admin-contact-flow-change-routing-age-attribute-label-time": "Queue time",
    "lily-admin-contact-flow-time-in-queue": "Time in Queue",
    "lily-admin-contact-flow-queue-capacity": "Queue capacity",
    "lily-admin-contact-flow-get-metric-data-label": "Get queue metrics",
    "lily-admin-contact-flow-get-metric-data-attribute-label-none": "None",
    "lily-admin-contact-flow-get-metric-data-attribute-label-dynamic": "dynamic",
    "lily-admin-contact-flow-get-metric-data-attribute-label-none-selected": "Current queue",
    "lily-admin-contact-flow-get-metric-data-attribute-label-queue": "Queue",
    "lily-admin-contact-flow-get-metric-data-attribute-label-channel": "Channel",
    "lily-admin-contact-flow-get-metric-data-attribute-label-default": "All Channels",
    "lily-admin-contact-flow-module-group-interact": "Interact",
    "lily-admin-contact-flow-module-group-set": "Set",
    "lily-admin-contact-flow-module-group-branch": "Branch",
    "lily-admin-contact-flow-module-group-integrate": "Integrate",
    "lily-admin-contact-flow-module-group-terminate": "Terminate / Transfer",
    "lily-admin-contact-flow-module-group-diagnose": "Diagnose",
    "lily-admin-contact-flow-module-play-prompt-name": "Play prompt",
    "lily-admin-contact-flow-module-play-prompt-description": "Plays audio.",
    "lily-admin-contact-flow-module-play-prompt-description-including-chat": "Delivers an audio or chat message.",
    "lily-admin-contact-flow-module-get-customer-input-name": "Get customer input",
    "lily-admin-contact-flow-module-get-customer-input-description": "Branches based on customer intent.",
    "lily-admin-contact-flow-module-store-customer-input-name": "Store customer input",
    "lily-admin-contact-flow-module-store-customer-input-description": "Stores numerical input to contact attribute.",
    "lily-admin-contact-flow-module-loop-prompts-name": "Loop prompts",
    "lily-admin-contact-flow-module-loop-prompts-description": "Loops a sequence of prompts while a customer or agent is on hold or in queue.",
    "lily-admin-contact-flow-module-hold-agent-name": "Hold customer or agent",
    "lily-admin-contact-flow-module-hold-agent-description": "Places a customer or agent on or off hold.",
    "lily-admin-contact-flow-module-set-queue-name": "Set working queue",
    "lily-admin-contact-flow-module-set-queue-description": "Specify the queue that the contact will be transferred to.",
    "lily-admin-contact-flow-module-set-attr-name": "Set contact attributes",
    "lily-admin-contact-flow-module-set-attr-description": "Define and store key-value pairs as contact attributes.",
    "lily-admin-contact-flow-module-change-routing-age-name": "Change routing priority / age",
    "lily-admin-contact-flow-module-change-routing-age-description": "Alters the priority of the contact in queue.",
    "lily-admin-contact-flow-module-set-recording-name": "Set call recording behavior",
    "lily-admin-contact-flow-module-set-recording-analytics-name": "Set recording and analytics behavior",
    "lily-admin-contact-flow-module-set-recording-description": "Enables or disables call recording for the agent, customer, or both.",
    "lily-admin-contact-flow-module-set-recording-description-with-analytics": "Specify call recording behavior and set up speech analytics. You must set up recording to use speech analytics.",
    "lily-admin-contact-flow-module-set-logging-behavior-name": "Set logging behavior",
    "lily-admin-contact-flow-module-set-logging-behavior-description": "Enables or disables Contact Flow Logs.",
    "lily-admin-contact-flow-module-set-hold-flow-name": "Set hold flow",
    "lily-admin-contact-flow-module-set-hold-flow-description": "Specify the flow to invoke when a customer or agent is put on hold during phone call.",
    "lily-admin-contact-flow-module-set-cust-queue-flow-name": "Set customer queue flow",
    "lily-admin-contact-flow-module-set-cust-queue-flow-description": "Specifies the flow to run when a customer is transferred to a queue.",
    "lily-admin-contact-flow-module-set-whisper-flow-name": "Set whisper flow",
    "lily-admin-contact-flow-module-set-whisper-flow-description": "Specifies the whisper played to a customer or agent for contacts.",
    "lily-admin-contact-flow-module-set-callback-name": "Set callback number",
    "lily-admin-contact-flow-module-set-callback-description": "Specify an attribute to set the customer callback number.",
    "lily-admin-contact-flow-module-set-voice-name": "Set voice",
    "lily-admin-contact-flow-module-set-voice-description": "Specify the language and voice that the customer hears during text-to-speech interactions.",
    "lily-admin-contact-flow-module-get-metric-data-name": "Get queue metrics",
    "lily-admin-contact-flow-module-get-metric-data-description": "Loads queue metrics for flow to use",
    "lily-admin-contact-flow-module-set-disconnect-flow-name": "Set disconnect flow",
    "lily-admin-contact-flow-module-set-disconnect-flow-description": "Specifies the contact flow to run when an agent disconnects the contact and the customer remains on the call.",
    "lily-admin-contact-flow-module-dial-block-name": "Call phone number",
    "lily-admin-contact-flow-dial-block-label": "Call phone number",
    "lily-admin-contact-flow-module-dial-block-description": "Initiates a call to a customer. You can optionally set the caller ID number to display to the recipient.",
    "lily-admin-contact-flow-dial-block-caller-id": "Caller ID",
    "lily-admin-contact-flow-module-check-queue-name": "Check queue status",
    "lily-admin-contact-flow-module-check-queue-description": "Check the amount of time the oldest contact or task has been in queue, the queue capacity, and branch. If no match is found, the contact is routed down the No Match branch.",
    "lily-admin-contact-flow-module-check-staffing-name": "Check staffing",
    "lily-admin-contact-flow-module-check-staffing-description": " Branches based on whether agents are available, staffed (for example, available, on call, or after call work), or online.",
    "lily-admin-contact-flow-module-check-hours-name": "Check hours of operation",
    "lily-admin-contact-flow-module-check-hours-description": "Checks the hours of operation, then branches based on whether it is in hours or out of hours.",
    "lily-admin-contact-flow-module-check-attr-name": "Check contact attributes",
    "lily-admin-contact-flow-module-check-attr-description": "Branches based on a comparison to the value of a contact attribute.",
    "lily-admin-contact-flow-module-percent-routing-name": "Distribute by percentage",
    "lily-admin-contact-flow-module-percent-routing-description": "Routes customers randomly based on specified percentage.",
    "lily-admin-contact-flow-module-loop-name": "Loop",
    "lily-admin-contact-flow-module-loop-description": "Repeats the looping branch for the specified number of times. After which, the complete branch is followed.",
    "lily-admin-contact-flow-module-invoke-lambda-name": "Invoke AWS Lambda function",
    "lily-admin-contact-flow-module-invoke-lambda-description": "Makes a call to AWS Lambda and optionally returns key/value pairs, which can be used to set contact attributes.",
    "lily-admin-contact-flow-module-disconnect-name": "Disconnect",
    "lily-admin-contact-flow-module-disconnect-description": "Ends the interaction.",
    "lily-admin-contact-flow-module-resume-name": "End flow / Resume",
    "lily-admin-contact-flow-module-resume-description": "Ends the flow without disconnecting the contact. However, resumes looping when the Loop prompts block is interrupted.",
    "lily-admin-contact-flow-module-transfer-queue-name": "Transfer to queue",
    "lily-admin-contact-flow-module-transfer-queue-description": "Ends the current contact flow and transfers the contact to a queue.",
    "lily-admin-contact-flow-module-transfer-number-name": "Transfer to phone number",
    "lily-admin-contact-flow-module-transfer-number-description": "Ends the current contact flow and transfers the customer to a phone number.",
    "lily-admin-contact-flow-module-transfer-agent-name": "Transfer to agent (beta)",
    "lily-admin-contact-flow-module-transfer-agent-description": "Ends the current contact flow and transfers the customer to an agent.",
    "lily-admin-contact-flow-module-transfer-flow-name": "Transfer to flow",
    "lily-admin-contact-flow-module-transfer-flow-description": "Ends the current flow and transfers the customer to a flow of type contact flow.",
    "lily-admin-contact-flow-module-start-media-streaming-description": "Starts streaming media to Kinesis.",
    "lily-admin-contact-flow-module-start-media-streaming-name": "Start media streaming",
    "lily-admin-contact-flow-module-stop-media-streaming-description": "Stops streaming media to Kinesis.",
    "lily-admin-contact-flow-module-stop-media-streaming-name": "Stop media streaming",
    "lily-admin-contact-flow-start-media-streaming-attribute-label": "Start streaming",
    "lily-admin-contact-flow-start-media-streaming-label": "Start media streaming",
    "lily-admin-contact-flow-stop-media-streaming-attribute-label": "Stop streaming",
    "lily-admin-contact-flow-stop-media-streaming-label": "Stop media streaming",
    "lily-admin-contact-flow-set-routing-proficiency-label": "Set routing proficiency",
    "lily-admin-contact-flow-module-set-routing-proficiency-description": "Temporarily route a contact within a queue to an agent with the appropriate location, expertise, or proficiency.",
    "lily-admin-contact-flow-module-set-routing-proficiency-name": "Set routing proficiency",
    "lily-admin-contact-flow-module-set-routing-proficiency-label-none": "None",
    "lily-admin-contact-flow-module-set-routing-proficiency-label-sec": "sec",
    "lily-admin-contact-flow-set-routing-proficiency-level1-placeholder": "Level One has not been created",
    "lily-admin-contact-flow-set-routing-proficiency-level2-placeholder": "Level Two has not been created",
    "lily-admin-contact-flow-set-routing-proficiency-optional-placeholder": "Optional",
    "lily-admin-contact-flow-set-routing-proficiency-required-placeholder": "Required",
    "lily-admin-contact-flow-error-bad-transition-string-header": "Connections missing",
    "lily-admin-contact-flow-error-bad-transition-string-body": "All outputs need to be connected to another block's input in order to be published.",
    "lily-admin-contact-flow-error-duplicate-transition-string-header": "Duplicate connection",
    "lily-admin-contact-flow-error-duplicate-transition-string-body": "You have an output condition present two or more times. This might lead to unexpected behavior, and you will need to remove duplicates before you can save.",
    "lily-admin-contact-flow-error-bad-parameter-string-header": "Invalid or missing parameter data",
    "lily-admin-contact-flow-error-bad-parameter-string-body": "One or more parameters are invalid or missing. Click on the block header to edit the block and fix the problematic parameters before publishing.",
    "lily-admin-contact-flow-error-bad-block-placement-header": "Invalid block placement",
    "lily-admin-contact-flow-error-bad-block-placement-audio-before-loop-body": "Placing blocks that contain prompts before a Loop prompts block is not supported in a Customer queue flow. Note: If you want to play a prompt before using Loop prompts, place it before the Customer queue flow is invoked.",
    "lily-admin-contact-flow-error-bad-block-placement-loop-after-loop-body": "Loop prompt blocks are not supported as part of an interrupt. Note: To return to the previously looping audio, use the End flow / Return from interruption block.",
    "lily-admin-contact-flow-error-bad-block-placement-before-loop-body": "This block cannot be placed before a Loop prompts block in a Customer queue flow. To use this block before a Loop prompts block, include it in another flow before using a Transfer to queue block to invoke a Customer queue flow.",
    "lily-admin-contact-flow-error-multiple-problems-string-header": "Multiple problems",
    "lily-admin-contact-flow-error-multiple-problems-bad-transition": "All outputs must be connected.",
    "lily-admin-contact-flow-error-multiple-problems-duplicate-transition": "An output condition is present more than once.",
    "lily-admin-contact-flow-error-multiple-problems-bad-parameter": "One or more parameters are invalid or missing.",
    "lily-admin-contact-flow-error-invalid-module-type-string-header": "Unsupported block type",
    "lily-admin-contact-flow-error-invalid-module-type-string-body": "Blocks of this type are not allowed in this type of flow.",
    "lily-admin-contact-flow-error-duplicate-block-header": "Duplicate block detected",
    "lily-admin-contact-flow-error-duplicate-dial-block": "You can use only one Call phone number block in a contact flow. If the contact flow includes a Play prompt block, the Call phone number block must be placed before it in the flow.",
    "lily-admin-contact-flow-error-bad-dial-block-placement": "A Call phone number block must be placed before any Play prompt, Start media streaming, or Stop media streaming blocks in the flow.",
    "lily-admin-contact-flow-condition-no-match": "No Match",
    "lily-admin-contact-flow-condition-in-hours": "In Hours",
    "lily-admin-contact-flow-condition-out-of-hours": "Out of Hours",
    "lily-admin-contact-flow-condition-okay": "Okay",
    "lily-admin-contact-flow-condition-success": "Success",
    "lily-admin-contact-flow-condition-error": "Error",
    "lily-admin-contact-flow-condition-true": "True",
    "lily-admin-contact-flow-condition-false": "False",
    "lily-admin-contact-flow-condition-default": "Default",
    "lily-admin-contact-flow-condition-invalid-number": "Invalid number",
    "lily-admin-contact-flow-condition-not-dialable": "Not dialable",
    "lily-admin-contact-flow-condition-call-failure": "Call Failed",
    "lily-admin-contact-flow-condition-timeout": "Timeout",
    "lily-admin-contact-flow-condition-at-capacity": "At capacity",
    "lily-admin-contact-flow-condition-start": "Start",
    "lily-admin-contact-flow-condition-looping": "Looping",
    "lily-admin-contact-flow-condition-complete": "Complete",
    "lily-admin-contact-flow-condition-resume": "Resume",
    "lily-admin-contact-flow-condition-continue": "Continue",
    "lily-admin-contact-flow-condition-customer-return": "Customer returned",
    "lily-admin-contact-flow-condition-time-expired": "Time expired",
    "lily-admin-contact-flow-condition-negative-override": "Negative",
    "lily-admin-contact-flow-condition-positive-override": "Positive",
    "lily-admin-contact-flow-condition-call-answered": "Call answered",
    "lily-admin-contact-flow-condition-voicemail-beep": "Voicemail (beep)",
    "lily-admin-contact-flow-condition-voicemail-no-beep": "Voicemail (no beep)",
    "lily-admin-contact-flow-condition-not-detected": "Not detected",
    "lily-admin-contact-flow-status-available": "Available",
    "lily-admin-contact-flow-status-staffed": "Staffed",
    "lily-admin-contact-flow-status-online": "Online",
    "lily-admin-contact-flow-namespace-user-defined": "User Defined",
    "lily-admin-contact-flow-namespace-external": "External",
    "lily-admin-contact-flow-namespace-system": "System",
    "lily-admin-contact-flow-namespace-queuemetrics": "Queue metrics",
    "lily-admin-contact-flow-namespace-agent": "Agent",
    "lily-admin-contact-flow-namespace-lex": "Lex",
    "lily-admin-contact-flow-namespace-lex-slots": "Lex slots",
    "lily-admin-contact-flow-namespace-lex-sessionattributes": "Lex attributes",
    "lily-admin-contact-flow-namespace-mediastreams": "Media streams",
    "lily-admin-contact-flow-namespace-url": "URL",
    "lily-admin-contact-flow-condition-equals": "Equals",
    "lily-admin-contact-flow-condition-less-than": "Is less than",
    "lily-admin-contact-flow-condition-less-or-equal": "Is less or equal",
    "lily-admin-contact-flow-condition-greater-than": "Is greater than",
    "lily-admin-contact-flow-condition-greater-or-equal": "Is greater or equal",
    "lily-admin-contact-flow-condition-starts-with": "Starts with",
    "lily-admin-contact-flow-condition-ends-with": "Ends with",
    "lily-admin-contact-flow-condition-contains": "Contains",
    "lily-admin-contact-flow-tts-text": "Text",
    "lily-admin-contact-flow-tts-ssml": "SSML",
    "lily-admin-contact-flow-attr-cust-number": "Customer Number",
    "lily-admin-contact-flow-attr-dialed-number": "Dialed Number",
    "lily-admin-contact-flow-attr-customer-callback": "Customer callback number",
    "lily-admin-contact-flow-attr-customerid": "Customer ID",
    "lily-admin-contact-flow-attr-stored-input": "Stored customer input",
    "lily-admin-contact-flow-attr-queue-name": "Queue name",
    "lily-admin-contact-flow-attr-queue-arn": "Queue ARN",
    "lily-admin-contact-flow-attr-queue-outboundcallerid-address": "Queue outbound number",
    "lily-admin-contact-flow-attr-texttospeechvoiceid": "Text to speech voice",
    "lily-admin-contact-flow-attr-contactid": "Contact id",
    "lily-admin-contact-flow-attr-initialcontactid": "Initial Contact id",
    "lily-admin-contact-flow-attr-previouscontactid": "Previous Contact id",
    "lily-admin-contact-flow-attr-channel": "Channel",
    "lily-admin-contact-flow-attr-name": "Name",
    "lily-admin-contact-flow-attr-description": "Description",
    "lily-admin-contact-flow-attr-references": "References",
    "lily-admin-contact-flow-attr-language": "Language",
    "lily-admin-contact-flow-attr-instancearn": "Instance ARN",
    "lily-admin-contact-flow-attr-initiationmethod": "Initiation method",
    "lily-admin-contact-flow-attr-lex-intentname-system": "Lex intent",
    "lily-admin-contact-flow-attr-lex-intentname": "Intent Name",
    "lily-admin-contact-flow-attr-lex-slots": "Slots",
    "lily-admin-contact-flow-attr-lex-intentconfidence-score": "Intent Confidence Score",
    "lily-admin-contact-flow-attr-lex-sentimentresponse-label": "Sentiment Label",
    "lily-admin-contact-flow-attr-lex-alternativeintents": "Alternative Intents",
    "lily-admin-contact-flow-attr-lex-sentimentresponse-scores": "Sentiment Score",
    "lily-admin-contact-flow-attr-lex-sessionattributes": "Session Attributes",
    "lily-admin-contact-flow-attr-agent-username": "User name",
    "lily-admin-contact-flow-attr-agent-firstname": "First name",
    "lily-admin-contact-flow-attr-agent-lastname": "Last name",
    "lily-admin-contact-flow-attr-agent-arn": "ARN",
    "lily-admin-contact-flow-attr-metrics-queue-name": "Queue name",
    "lily-admin-contact-flow-attr-metrics-queue-arn": "Queue ARN",
    "lily-admin-contact-flow-attr-metrics-queue-size": "Contacts in queue",
    "lily-admin-contact-flow-attr-metrics-queue-oldestcontactage": "Oldest contact in queue",
    "lily-admin-contact-flow-attr-metrics-agents-online-count": "Agents online",
    "lily-admin-contact-flow-attr-metrics-agents-available-count": "Agents available",
    "lily-admin-contact-flow-attr-metrics-agents-staffed-count": "Agents staffed",
    "lily-admin-contact-flow-attr-metrics-agents-aftercontactwork-count": "Agents after contact work",
    "lily-admin-contact-flow-attr-metrics-agents-busy-count": "Agents busy",
    "lily-admin-contact-flow-attr-metrics-agents-missed-count": "Agents missed",
    "lily-admin-contact-flow-attr-metrics-agents-nonproductive-count": "Agents non-productive",
    "lily-admin-contact-flow-attr-mediastreams-customer-audio-streamarn": "Customer audio stream ARN",
    "lily-admin-contact-flow-attr-mediastreams-customer-audio-starttimestamp": "Customer audio start timestamp",
    "lily-admin-contact-flow-attr-mediastreams-customer-audio-stoptimestamp": "Customer audio stop timestamp",
    "lily-admin-contact-flow-attr-mediastreams-customer-audio-startfragmentnumber": "Customer audio start fragment number",
    "lily-admin-contact-flow-tts-voice-arabic": "Arabic",
    "lily-admin-contact-flow-tts-voice-chinese-mandarin": "Chinese, Mandarin",
    "lily-admin-contact-flow-tts-voice-danish": "Danish",
    "lily-admin-contact-flow-tts-voice-dutch": "Dutch",
    "lily-admin-contact-flow-tts-voice-english-au": "English (Australian)",
    "lily-admin-contact-flow-tts-voice-english-br": "English (British)",
    "lily-admin-contact-flow-tts-voice-english-in": "English, Indian",
    "lily-admin-contact-flow-tts-voice-english-us": "English, US",
    "lily-admin-contact-flow-tts-voice-english-we": "English, Welsh",
    "lily-admin-contact-flow-tts-voice-french": "French",
    "lily-admin-contact-flow-tts-voice-french-ca": "French, Canadian",
    "lily-admin-contact-flow-tts-voice-german": "German",
    "lily-admin-contact-flow-tts-voice-hindi": "Hindi",
    "lily-admin-contact-flow-tts-voice-icelandic": "Icelandic",
    "lily-admin-contact-flow-tts-voice-italian": "Italian",
    "lily-admin-contact-flow-tts-voice-japanese": "Japanese",
    "lily-admin-contact-flow-tts-voice-korean": "Korean",
    "lily-admin-contact-flow-tts-voice-norwegian": "Norwegian",
    "lily-admin-contact-flow-tts-voice-polish": "Polish",
    "lily-admin-contact-flow-tts-voice-portuguese": "Portuguese",
    "lily-admin-contact-flow-tts-voice-portuguese-br": "Portuguese, Brazilian",
    "lily-admin-contact-flow-tts-voice-romanian": "Romanian",
    "lily-admin-contact-flow-tts-voice-russian": "Russian",
    "lily-admin-contact-flow-tts-voice-spanish-es": "Spanish, Castilian",
    "lily-admin-contact-flow-tts-voice-spanish-mx": "Spanish, Mexican",
    "lily-admin-contact-flow-tts-voice-spanish-us": "Spanish, US",
    "lily-admin-contact-flow-tts-voice-swedish": "Swedish",
    "lily-admin-contact-flow-tts-voice-turkish": "Turkish",
    "lily-admin-contact-flow-tts-voice-welsh": "Welsh",
    "lily-admin-contact-flow-analysis-language-en-us": "English (United States)",
    "lily-admin-contact-flow-analysis-language-en-gb": "English (Great Britain)",
    "lily-admin-contact-flow-analysis-language-en-au": "English (Australia)",
    "lily-admin-contact-flow-analysis-language-en-in": "English (India)",
    "lily-admin-contact-flow-analysis-language-es-us": "Spanish (United States)",
    "lily-admin-contact-flow-analysis-language-en-ie": "English (Ireland)",
    "lily-admin-contact-flow-analysis-language-en-wl": "English (Wales)",
    "lily-admin-contact-flow-analysis-language-en-ab": "English (Scotland)",
    "lily-admin-contact-flow-analysis-language-es-es": "Spanish (Spain)",
    "lily-admin-contact-flow-analysis-language-fr-ca": "French (Canada)",
    "lily-admin-contact-flow-analysis-language-fr-fr": "French (France)",
    "lily-admin-contact-flow-analysis-language-pt-pt": "Portuguese (Portugal)",
    "lily-admin-contact-flow-analysis-language-pt-br": "Portuguese (Brazil)",
    "lily-admin-contact-flow-analysis-language-de-de": "German (Germany)",
    "lily-admin-contact-flow-analysis-language-de-ch": "German (Switzerland)",
    "lily-admin-contact-flow-analysis-language-it-it": "Italian (Italy)",
    "lily-admin-contact-flow-analysis-language-ar-ae": "Arabic (Gulf)",
    "lily-admin-contact-flow-analysis-language-ar-sa": "Arabic (Modern Standard)",
    "lily-admin-contact-flow-analysis-language-hi-in": "Hindi (India)",
    "lily-admin-contact-flow-analysis-language-zh-cn": "Mandarin (Mainland China)",
    "lily-admin-contact-flow-analysis-language-ko-kr": "Korean (South Korea)",
    "lily-admin-contact-flow-analysis-language-ja-jp": "Japanese (Japan)",
    "lily-admin-contact-flow-import-warning-multiple-header": "Multiple Resources",
    "lily-admin-contact-flow-import-warning-multiple-body": "This block contains multiple resolved or unresolved resources. Open the block to select different resources.",
    "lily-admin-contact-flow-import-warning-replaced-header": "Resolved Resource",
    "lily-admin-contact-flow-import-warning-replaced-body": "Could not resolve this resource by ARN, so the resource was resolved to a resource with the same name.",
    "lily-admin-contact-flow-import-warning-missing-header": "Unresolved Resource",
    "lily-admin-contact-flow-import-warning-missing-body": " Could not resolve a resource with the Name or ARN specified. Open the block to select a different resource.",
    "lily-admin-contact-flow-type-inbound": "Contact flow (inbound)",
    "lily-admin-contact-flow-type-agent-whisper": "Agent whisper",
    "lily-admin-contact-flow-type-agent-hold": "Agent hold",
    "lily-admin-contact-flow-type-customer-whisper": "Customer whisper",
    "lily-admin-contact-flow-type-customer-hold": "Customer hold",
    "lily-admin-contact-flow-type-customer-queue": "Customer queue",
    "lily-admin-contact-flow-type-agent-transfer": "Agent transfer",
    "lily-admin-contact-flow-type-outbound-whisper": "Outbound whisper",
    "lily-admin-contact-flow-type-queue-transfer": "Queue transfer",
    "lily-admin-flow-module": "Module",
    "lily-admin-contact-flow-page-header": "Contact flow designer",
    "lily-admin-contact-flow-audit-header": "by",
    "lily-admin-contact-flow-audit-latest-version": "Latest Version",
    "lily-admin-region-name-us-east-1": "US East: N. Virginia",
    "lily-admin-region-name-us-west-2": "US West: Oregon",
    "lily-admin-region-name-ap-southeast-2": "Asia Pacific: Sydney",
    "lily-admin-region-name-ap-southeast-1": "Asia Pacific: Singapore",
    "lily-admin-region-name-ap-northeast-1": "Asia Pacific: Tokyo",
    "lily-admin-region-name-eu-central-1": "EU: Frankfurt",
    "lily-admin-region-name-eu-west-1": "EU: Ireland",
    "lily-admin-region-name-eu-west-2": "EU: London",
    "lily-admin-region-name-us-gov-west-1": "GovCloud: West",
    "lily-admin-contact-flow-type-header": "Type",
    "lily-admin-contact-flow-change-time-header": "Change time",
    "lily-admin-contact-flow-user-name-header": "Changed by (user)",
    "lily-admin-contact-flow-latest-version-option": "Latest",
    "lily-admin-contact-flow-status-saved": "Saved",
    "lily-admin-contact-flow-status-published": "Published",
    "lily-admin-contact-flow-marquee-mode-button-tooltip-string": "Marquee",
    "lily-admin-contact-flow-toggle-mode-button-tooltip-string": "Pointer",
    "lily-admin-contact-flow-set-voice-override-console-voice-settings": "Override default speaking style -",
    "lily-admin-contact-flow-set-voice-speaking-style": "Neural speaking style",
    "lily-admin-contact-flow-set-voice-standard": "Standard (Legacy)",
    "lily-admin-contact-flow-speaking-style-dropdown-none": "None",
    "lily-admin-contact-flow-speaking-style-dropdown-conversational": "Conversational",
    "lily-admin-contact-flow-speaking-style-dropdown-newscaster": "Newscaster",
    "lily-admin-contact-flow-speaking-style-block-standard": "Standard",
    "lily-admin-contact-flow-speaking-style-block-none": "Neural: None",
    "lily-admin-contact-flow-speaking-style-block-conversational": "Neural: Conversational",
    "lily-admin-contact-flow-speaking-style-block-newscaster": "Neural: Newscaster",
    "lily-admin-contact-flow-check-queue-attr-header": "Check queue status",
    "lily-admin-contact-flow-store-customer-input-header": "Store customer input",
    "lily-admin-contact-flow-enqueue-transfer-to-queue": "Transfer to queue",
    "lily-admin-contact-flow-set-recording-behavior-agent-side": "Agent",
    "lily-admin-contact-flow-invoke-external-detail": "The returned key value pairs can be used to set contact attributes.",
    "lily-admin-contact-flow-get-dtmf-header": "Get customer input",
    "lily-admin-contact-flow-sentiment-override-detail": "Branch based on sentiment score, before the Lex intent.",
    "lily-admin-contact-flow-store-customer-input-encrypt-entry": "Encrypt entry (recommended)",
    "lily-admin-contact-flow-set-queue-detail": "Select a queue to perform actions on, such as transferring a contact to it or retrieving metrics about it.",
    "lily-admin-contact-flow-resume-desc-bottom": "When End flow / return from interruption is invoked, the customer will remain connected to the system.",
    "lily-admin-contact-flow-enqueue-transfer-to-callback-queue": "Transfer to callback queue",
    "lily-admin-contact-flow-resume-title": "Ends the flow without disconnecting the contact. However, resumes looping when the Loop prompts block is interrupted.",
    "lily-admin-contact-flow-loop-audio-header": "Loop prompts",
    "lily-admin-contact-flow-transfer-flow-type": "Type",
    "lily-admin-contact-flow-prompts-label": "Prompts",
    "lily-admin-contact-flow-use-attributes": "Use attribute",
    "lily-admin-contact-flow-set-whisper-flow-title": "Specifies the whisper played to a customer or agent for contacts.",
    "lily-admin-contact-flow-set-flow-customer-label": "Customer",
    "lily-admin-contact-flow-set-flow-whisper-to-customer-label": "To Customer",
    "lily-admin-contact-flow-enqueue-at-capacity-label": "At capacity",
    "lily-admin-contact-flow-enqueue-transfer-to-queue-label": "Queue",
    "lily-admin-contact-flow-store-customer-input-detail": "Plays an interruptible audio prompt and stores digits via DTMF as a contact attribute.",
    "lily-admin-contact-flow-invoke-external-header": "Invoke AWS Lambda function",
    "lily-admin-contact-flow-add-another-condition": "Add another condition",
    "lily-admin-contact-flow-add-another-percentage": "Add another percentage",
    "lily-admin-contact-flow-add-an-attribute": "Add an attribute",
    "lily-admin-contact-flow-add-another-attribute": "Add another attribute",
    "lily-admin-contact-flows-transfer-timeout-sec": "Timeout (in seconds)",
    "lily-admin-contact-flows-transfer-resume-flow-after-disconnect": "Resume contact flow after disconnect",
    "lily-admin-contact-flows-transfer-add-timeout-call-failed-and-success-branches": "Adds success, call failed and timeout output branches.",
    "lily-admin-contact-flows-transfer-set-timeout": "Set timeout",
    "lily-admin-contact-flow-transfer-optional-parameters-label": "Optional parameters:",
    "lily-admin-contact-flow-transfer-dtmf-digits-label": "DTMF input",
    "lily-admin-contact-flow-transfer-transfer-via": "Transfer to",
    "lily-admin-contact-flow-transfer-send-dtmf": "Send DTMF",
    "lily-admin-contact-flow-adjust-queue-priority-detail": "Contacts are routed by priority. 1 is highest priority and 5 is lowest. They are further ordered by time / age in queue.",
    "lily-admin-contact-flow-parameters-label": "Parameters:",
    "lily-admin-contact-flow-check-contact-attributes-add-another-condition": "Add another condition",
    "lily-admin-contact-flow-set-contact-attribute-source-attribute": "Source attribute",
    "lily-admin-contact-flow-set-queue-title": "Specify the queue that the contact will be transferred to.",
    "lily-admin-contact-flow-get-metric-data-title": "Retrieves real-time metrics for a queue.",
    "lily-admin-contact-flow-get-metric-data-header": "Get queue metrics",
    "lily-admin-contact-flow-get-metric-data-detail": "Retrieve metrics from a queue so you can make routing decisions. You can route contacts based on queue status, such as number of contacts in queue or agents available. Queue metrics are aggregated across all channels by default and are returned as attributes. The current queue is used by default.",
    "lily-admin-contact-flow-get-metric-data-optional-parameters-label": "Optional parameters:",
    "lily-admin-contact-flow-get-metric-data-set-queue-label": "Set queue",
    "lily-admin-contact-flow-get-metric-data-set-channel-label": "Set channel",
    "lily-admin-contact-flow-get-metric-data-set-channel-manually-label": "Filter by",
    "lily-admin-contact-flow-get-metric-data-voice-channel-label": "Voice",
    "lily-admin-contact-flow-get-metric-data-chat-channel-label": "Chat",
    "lily-admin-contact-flow-get-metric-data-task-channel-label": "Task",
    "lily-admin-contact-flow-tts-override": "Text to speech (Ad hoc)",
    "lily-admin-contact-flow-tts-override-including-chat": "Text-to-speech or chat text",
    "lily-admin-contact-flow-store-customer-input-maximum-digits": "Maximum Digits",
    "lily-admin-contact-flow-store-customer-input-terminatorDigits": "Specify terminating keypress",
    "lily-admin-contact-flow-store-customer-input-disableCancel": "Disable cancel key",
    "lily-admin-contact-flow-store-customer-input-enterTerminator": "Set manually",
    "lily-admin-contact-flow-store-customer-input-allowedCharacters": "Allowed characters: 0-9, #, *",
    "lily-admin-contact-flow-set-voice-header": "Set Voice",
    "lily-admin-contact-flow-disconnect-header": "Disconnect",
    "lily-admin-contact-flows-get-dtmf-timeout": "Set timeout (Minimum one second)",
    "lily-admin-contact-flow-check-queue-attr-title": "Check the amount of time the oldest contact or task has been in queue, the queue capacity, and branch. If no match is found, the contact is routed down the No Match branch.",
    "lily-admin-contact-flow-not-non-negative-integer-input": "Value must be a non-negative integer.",
    "lily-admin-contact-flow-set-recording-behavior-header": "Set call recording behavior",
    "lily-admin-contact-flow-play-audio-title": "Plays audio.",
    "lily-admin-contact-flow-play-audio-title-including-chat": "Delivers an audio or chat message.",
    "lily-admin-contact-flow-set-recording-behavior-both-sides-customer": "Customer",
    "lily-admin-contact-flow-transfer-header": "Transfer to phone number",
    "lily-admin-contact-flow-set-voice-voice": "Voice",
    "lily-admin-contact-flow-check-contact-attributes-title": "Branches based on a comparison to the value of a contact attribute.",
    "lily-admin-contact-flow-queue-select-dynamically": "Use attribute",
    "lily-admin-contact-flow-dynamic-queue-by-agent-label": "By agent",
    "lily-admin-contact-flow-dynamic-queue-by-agent-selector-label": "Select an agent",
    "lily-admin-contact-flow-dynamic-queue-by-queue-label": "By queue",
    "lily-admin-contact-flows-play-loop-interrupt-every": "Interrupt every",
    "lily-admin-contact-flow-set-screenpop-header": "Set contact attributes",
    "lily-admin-contact-flow-save-contact-attribute-value": "Value",
    "lily-admin-contact-flow-invoke-lambda-parameter-key": "Paramater name",
    "lily-admin-contact-flow-tts-link": "Learn more about Amazon Connect's TTS capabilities",
    "lily-admin-contact-flow-check-contact-attributes-source-attribute": "Attribute to check",
    "lily-admin-contact-flow-set-callback-number-attribute": "Attribute",
    "lily-admin-contact-flow-loop-audio-detail": "When Loop prompts is used in a queue flow, audio playback can be interrupted at preset times.",
    "lily-admin-contact-flow-enqueue-select-a-queue-label": "Select a queue",
    "lily-admin-contact-flow-enter-a-key": "Enter a key",
    "lily-admin-contact-flow-set-hold-flow-title": "Specify the flow to invoke when a customer or agent is put on hold during phone call.",
    "lily-admin-contact-flow-dynamic-value-namespace": "Type",
    "lily-admin-contact-flow-dynamic-value-reference-key": "Reference key",
    "lily-admin-contact-flow-dynamic-value-reference-type": "Reference type",
    "lily-admin-contact-flow-set-recording-behavior-title": "Configures call recordings for the agent, customer, or both.",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-header": "Set recording and analytics behavior",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-details": "Specify call recording behavior and set up speech analytics. You must set up recording to use speech analytics.",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-contact-lens-details": "Specify call recording behavior and configure Contact Lens speech analytics.",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-recording-header": "Call recording",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-recording-info": "Enable or disable call recording for the agent, customer, or both.",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-contact-lens-recording-info": "Enables or disables call recording for the agent, customer, or both. Agent and customer call recordings are required to enable Contact Lens.",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-info": "Agent and customer call recordings are required to use speech analytics.",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-enable-checkbox": "Enable analytics",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-contact-lens-analytics-enable-checkbox": "Enable Contact Lens for speech analytics.",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-enable-description": "Contact Lens is a speech analytics that provides transcripts and analysis about the customer experience. You can specify the language manually or by using an attribute.",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-enable-description-real-time": "Contact Lens provides ML-based speech analytics such as call transcript and sentiment to identify customer issues and trends. Use post-call analytics to get speech analysis for transcripts, sentiment, and other data, after customer interaction. Use real-time analytics to get access to transcripts and sentiment analysis during the customer interaction.",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-language": "Language",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-manually": "Set manually",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-dynamic": "Use attribute",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-recording-on": "On",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-recording-off": "Off",
    "lily-admin-contact-flow-analytics-label": "Analytics",
    "lily-admin-contact-flow-contact-lens-analytics": "Contact Lens speech analytics",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-redact-sensitive-data": "Redact sensitive data",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-redact-sensitive-data-description": "Redact sensitive data, such as personal information, in the Contact Lens output file and get a redacted audio recording. Sensitive data redaction is currently available for certain languages only.",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-redact-sensitive-data-description-real-time": "Redact sensitive data, such as personal information, in the Contact Lens output file and get a redacted audio recording. Sensitive data redaction is applied after the call disconnects, and is currently available for certain languages only.",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-redact-get-redact-and-original": "Generate both redacted and original transcripts and audio",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-redact-get-redact-only": "Generate redacted transcript only, and both redacted and original audio",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-mode-post-call": "Post-call analytics",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-mode-post-call-description": "Recommended for best transcription accuracy.",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-mode-real-time": "Real-time and post-call analytics",
    "lily-admin-contact-flow-set-recording-and-analytics-behavior-analytics-mode-real-time-description": "Enables real-time alerts and speech analytics on live calls.",
    "lily-admin-contact-flow-save-contact-attribute-set-dynamically": "Use attribute",
    "lily-admin-contact-flow-queue-priority-subtitle": "Set priority or routing age",
    "lily-admin-contact-flow-outputs-label": "Outputs:",
    "lily-admin-contact-flow-lex-intent-label": "Intents",
    "lily-admin-contact-flow-queue-dynamic-value-namespace": "Type",
    "lily-admin-contact-flow-resume-desc-top": "For example, this can be used to return to Loop prompts when it has been interrupted.",
    "lily-admin-contact-flow-add-another-prompt-to-sequence": "Add another prompt to the loop",
    "lily-admin-contact-flow-loop-audio-title": "Loops a sequence of prompts while a customer or agent is on hold or in queue.",
    "lily-admin-contact-flow-invoke-external-add-a-parameter": "Add a parameter",
    "lily-admin-contact-flow-set-flow-agent-label": "Agent",
    "lily-admin-contact-flow-set-flow-whisper-to-agent-label": "To Agent",
    "lily-admin-contact-flow-lex-tab": "Amazon Lex",
    "lily-admin-contact-flow-check-staffing-queue-label": "Specific hours (optional). If not specified, the current queue's hours are checked.",
    "lily-admin-contact-flow-check-staffing-title": " Branches based on whether agents are available, staffed (for example, available, on call, or after call work), or online.",
    "lily-admin-contact-flow-check-contact-attributes-detail": "Examples of supported comparisons include: \"equal to\", \"greater than\", \"less than\" \"starts with\", \"ends with\", \"contains\".",
    "lily-admin-contact-flow-set-queue-header": "Set working queue",
    "lily-admin-contact-flow-tts-label": "Enter text to be spoken",
    "lily-admin-contact-flow-no-match-option": "No Match",
    "lily-admin-contact-flow-invoke-external-function-arn": "Function ARN",
    "lily-admin-contact-flow-invoke-external-select-function": "Select a function",
    "lily-admin-contact-flow-invoke-external-use-attributes": "Use attributes",
    "lily-admin-contat-flow-invoke-lamba-invalid-timeout": "Timeout must be between one and eight seconds!",
    "lily-admin-contact-flow-enqueue-minimum-time-between-attempts": "Minimum time between attempts",
    "lily-admin-contact-flow-set-agent-status-detail": "Useful scenarios include putting the agent on hold to enable the customer to interact with the contact flow in private.",
    "lily-admin-contact-flow-transfer-to-flow-header": "Transfer to flow",
    "lily-admin-contact-flow-transfer-block-caller-id-number-label": "Caller ID number",
    "lily-admin-contact-flow-select-flow-dynamic-prompt": "Use attribute",
    "lily-admin-contact-flows-transfer-caller-id-hint": "Caller ID settings. Leave this unchecked to inherit off the active queue.",
    "lily-admin-contact-flow-set-callback-number-header": "Set callback number",
    "lily-admin-contact-flow-set-agent-status": "Status",
    "lily-admin-contact-flow-in-seconds": "in seconds",
    "lily-admin-contact-flow-set-agent-status-header": "Hold customer or agent",
    "lily-admin-contact-flow-invoke-lambda-timeout": "Timeout (max 8 seconds)",
    "lily-admin-contact-flow-set-whisper-flow-header": "Set whisper flow",
    "lily-admin-contact-flow-dynamic-value-key": "Attribute",
    "lily-admin-contact-flow-store-customer-input-select-local-format": "Local format",
    "lily-admin-contact-flow-hold-flow-label": "Hold flow",
    "lily-admin-contact-flow-enqueue-set-queue-label": "Set working queue",
    "lily-admin-contact-flow-transfer-to-agent-title": "Ends the current contact flow and transfers the customer to an agent. Available only for voice interactions.",
    "lily-admin-contact-flow-enqueue-maximum-amount-of-attempts-label": "Max number of retries",
    "lily-admin-contact-flow-lex-header-label": "Lex bot",
    "lily-admin-contact-flow-lex-bot-select": "Select a Lex bot",
    "lily-admin-contact-flow-enter-arn": "Enter an ARN",
    "lily-admin-contact-flow-distribute-by-percentage-branches": "Percentages to branch",
    "lily-admin-contact-flow-queue-dynamic-value-key": "Attribute",
    "lily-admin-contact-flow-store-customer-input-select-custom": "Custom",
    "lily-admin-contact-flow-store-customer-input-custom-label": "Customer input",
    "lily-admin-contact-flow-play-audio-header": "Play prompt",
    "lily-admin-contact-flow-store-customer-input-country-code": "Country code",
    "lily-admin-contact-flow-set-screenpop-title": "Define and store key-value pairs as contact attributes.",
    "lily-admin-contact-flow-set-recording-behavior-none-side": "None",
    "lily-admin-contact-flow-select-dynamically": "Select dynamically",
    "lily-admin-contact-flows-transfer-caller-id-number": "Caller ID number",
    "lily-admin-contact-flow-set-recording-behavior-both-sides-and": "and",
    "lily-admin-contact-flow-enqueue-and-callback-title": "Ends the current contact flow and transfers the contact to a queue.",
    "lily-admin-contact-flow-enqueue-and-callback-with-queue-selector-title": "Transfers a call already in a queue to a different queue, or to a callback queue.",
    "lily-admin-contact-flow-adjust-queue-priority-title": "Alters the priority or age of the contact in queue.",
    "lily-admin-contact-flow-lex-attributes-label": "Session attributes",
    "lily-admin-contact-flow-lex-add-an-attribute": "Add an attribute",
    "lily-admin-contact-flow-lex-add-another-attribute": "Add another attribute",
    "lily-admin-contact-flow-lex-add-an-intent": "Add an intent",
    "lily-admin-contact-flow-lex-add-another-intent": "Add another intent",
    "lily-admin-contact-flow-lex-attr-alternative-intent-attr": "Intent Attribute",
    "lily-admin-contact-flow-lex-attr-sentiment-label": "Sentiment",
    "lily-admin-contact-flow-lex-attr-sentiment-positive": "Positive",
    "lily-admin-contact-flow-lex-attr-sentiment-negative": "Negative",
    "lily-admin-contact-flow-lex-attr-sentiment-mixed": "Mixed",
    "lily-admin-contact-flow-lex-attr-sentiment-neutral": "Neutral",
    "lily-admin-contact-flow-lex-attr-session-attribute-key": "Session Attribute Key",
    "lily-admin-contact-flow-lex-attr-slot-name": "Slot Name",
    "lily-admin-contact-flow-prompt-parameters-label": "Prompt",
    "lily-admin-contact-flow-recording-label": "Record:",
    "lily-admin-contact-flows-lex-alias": "Alias",
    "lily-admin-contact-flow-adjust-queue-priority-header": "Change routing priority / age",
    "lily-admin-contact-flow-set-customer-queue-flow-title": "Specifies the flow to run when a customer is transferred to a queue.",
    "lily-admin-contact-flow-set-customer-queue-flow-header": "Set customer queue flow",
    "lily-admin-contact-flow-set-callback-number-use-attributes": "Use attribute",
    "lily-admin-contact-flow-get-dtmf-option": "Option:",
    "lily-admin-contact-flow-whisper-flow-label": "Whisper flow",
    "lily-admin-contact-flow-enter-dynamically": "Enter dynamically",
    "lily-admin-contact-flow-select-a-prompt": "Select a prompt",
    "lily-admin-contact-flow-invoke-lambda-input-parameters": "Function input parameters",
    "lily-admin-contact-flow-resume-header": "End flow / Resume",
    "lily-admin-contact-flow-transfer-label": "Transfer",
    "lily-admin-contact-flow-tts-interpret": "Interpret as",
    "lily-admin-contact-flow-check-staffing-header": "Check staffing",
    "lily-admin-contact-flow-set-hold-flow-header": "Set hold flow",
    "lily-admin-contact-flow-check-staffing-status-to-check": "Status to check",
    "lily-admin-contact-flow-set-recording-behavior-customer-side": "Customer",
    "lily-admin-contact-flow-distribute-by-percentage-detail": "Like flipping a coin, contacts are distributed randomly, which doesn't guarantee exact percentage splits.",
    "lily-admin-contact-flow-invoke-external-send-text": "Send text",
    "lily-admin-contact-flow-invoke-lambda-parameter-value": "Value",
    "lily-admin-contact-flow-invoke-external-add-another-parameter": "Add another parameter",
    "lily-admin-contact-flow-store-customer-input-key": "Key",
    "lily-admin-contact-flow-customer-queue-flow-label": "Customer queue flow",
    "lily-admin-contact-flow-enqueue-header": "Transfer to queue",
    "lily-admin-contact-flow-distribute-by-percentage-title": "Routes customers randomly based on specified percentage.",
    "lily-admin-contact-flow-save-contact-attribute-attribute-to-save": "Attribute to save",
    "lily-admin-contact-flow-prompt-label": "Audio prompt",
    "lily-admin-contact-flow-seconds": "seconds",
    "lily-admin-contact-flows-play-loop-interrupt": "Interrupt",
    "lily-admin-contact-flow-set-voice-language": "Language",
    "lily-admin-contact-flow-enqueue-initial-delay": "Initial delay",
    "lily-admin-contact-flow-error-option": "Error",
    "lily-admin-contact-flows-lex-name": "Name",
    "lily-admin-contact-flow-play-audio-detail": "Prompts can be an audio file, stored in the prompt library, or text-to-speech, which can optionally be specified in a flow via a contact attribute.",
    "lily-admin-contact-flow-play-prompt-detail": "Enter text for voice or chat responses. You can personalize messages by using attributes.",
    "lily-admin-contact-flow-play-prompt-detail-learn-more": "Learn more",
    "lily-admin-contact-flow-transfer-to-flow-title": "Ends the current flow and transfers the customer to a flow of type contact flow.",
    "lily-admin-contact-flow-check-contact-attributes-header": "Check contact attributes",
    "lily-admin-contact-flows-transfer-caller-id-name": "Caller ID name",
    "lily-admin-contact-flow-store-customer-input-delay-between-entry": "Timeout before first entry",
    "lily-admin-contact-flow-set-recording-behavior-custmer-side-only": "only",
    "lily-admin-contact-flow-save-contact-attribute-key": "Destination key",
    "lily-admin-contact-flow-distribute-by-percentage-percent-remaining": "remaining (default branch)",
    "lily-admin-contact-flow-transfer-to-agent-header": "Transfer to agent (beta)",
    "lily-admin-contact-flow-set-recording-behavior-both-sides-agent": "Agent",
    "lily-admin-contact-flow-enter-text": "Enter text",
    "lily-admin-contact-flow-get-dtmf-detail-dtmf": "Plays an interruptible audio prompt and branches based on DTMF.",
    "lily-admin-contact-flow-enqueue-optional-parameters-label": "Optional parameters:",
    "lily-admin-contact-flow-distribute-by-percentage-header": "Distribute by percentage",
    "lily-admin-contact-flow-check-hours-title": "Checks the hours of operation, then branches based on whether it is in hours or out of hours.",
    "lily-admin-contact-flow-check-hours-description": "If you do not select an Hours of operation, the Hours of operation for the current working queue is checked. If there is no current working queue, or that queue has no Hours of operation set, the Error branch is followed.",
    "lily-admin-contact-flow-set-voice-title": "Specify the language and voice that the customer hears during text-to-speech interactions.",
    "lily-admin-contact-flow-dtmf-tab": "DTMF",
    "lily-admin-contact-flow-invoke-external-send-dynamically": "Send attribute",
    "lily-admin-contact-flow-set-contact-attribute-key": "Destination key",
    "lily-admin-contact-flow-set-contact-attribute-destination-type": "Destination Type",
    "lily-admin-contact-flow-set-contact-attribute-destination-attribute": "Destination Attribute",
    "lily-admin-contact-flow-disconnect-title": "Ends the interaction.",
    "lily-admin-contact-flow-set-agent-status-title": "Places a customer or agent on or off hold.",
    "lily-admin-contact-flow-check-hours-header": "Check hours of operation",
    "lily-admin-contact-flow-save-contact-attribute-as-text": "Use text",
    "lily-admin-contact-flow-get-dtmf-title": "Configure the branches that a customer can choose based on their intent.",
    "lily-admin-contact-flow-get-dtmf-chat-title": "Delivers an audio or chat message to solicit customer input.",
    "lily-admin-contact-flow-set-screenpop-detail": "Contact attributes are accessible by other areas of Amazon Connect, such as the Contact Control Panel (CCP) and Contact Trace Records (CTRs).",
    "lily-admin-contact-flow-transfer-flow-attribute": "Attribute",
    "lily-admin-contact-flow-invoke-lambda-parameter-attribute": "Attribute",
    "lily-admin-contact-flow-get-dtmf-detail-both-chat": "Based on response, the contact flow branches.",
    "lily-admin-contact-flow-get-dtmf-detail-both": "Plays an audio prompt and branches based on DTMF or Amazon Lex intents. The audio prompt is interruptible when using DTMF.",
    "lily-admin-contact-flow-get-dtmf-detail-learn-more": "Learn more.",
    "lily-admin-contact-flow-enqueue-error-label": "Error",
    "lily-admin-contact-flow-enqueue-success-label": "Success",
    "lily-admin-contact-flow-set-callback-number-title": "Specify an attribute to set the customer callback number.",
    "lily-admin-contact-flow-set-recording-behavior-agent-side-only": "only",
    "lily-admin-contact-flow-store-customer-input-select-international-format": "International format/ Enforce E.164",
    "lily-admin-contact-flow-store-customer-input-key-id": "Key ID",
    "lily-admin-contact-flow-invoke-external-title": "Makes a call to AWS Lambda and optionally returns key/value pairs, which can be used to set contact attributes.",
    "lily-admin-contact-flow-transfer-to-agent-detail": "This should be used with warm transfers. If the target agent is on a call or unavailable, the transfer will fail and the customer will remain with the original agent.",
    "lily-admin-contact-flow-enqueue-with-queue-selector-description": "When you use Transfer to queue, a 'Loop prompt' block must be used in the flow prior to this block. You must also connect the 'Success' branch to another block to create a successful flow, such as an 'End flow / Resume' block.",
    "lily-admin-contact-flow-enqueue-description": "When you use Transfer to queue, you must use a 'Set working queue' block to set the active queue before this block.",
    "lily-admin-contact-flow-callback-description": "When you use Transfer to callback queue, you must use a 'Set customer callback number' block before this block in the flow to set the callback number for the customer.",
    "lily-admin-contact-flow-select-from-prompt-library": "Select from the prompt library (audio)",
    "lily-admin-contact-flow-store-customer-input-title": "Stores numerical input to contact attribute.",
    "lily-admin-contact-flow-select-flow-prompt": "Select a flow",
    "lily-admin-contact-flow-check-contact-attributes-conditions": "Conditions to check",
    "lily-admin-contact-flow-store-customer-input-select-phone-number": "Phone number",
    "lily-admin-contact-flow-transfer-title": "Ends the current contact flow and transfers the customer to a phone number.",
    "lily-admin-contact-flow-transfer-title-withBlindTransfer-support": "Transfer a call to a phone number for voice interactions.",
    "lily-admin-contact-flow-transfer-valid-dtmf-digits-warn": "Allowed characters include: numeric digits, comma, asterisk, and pound sign. Max 50 characters.",
    "lily-admin-contact-flow-Field-Cannot-be-empty-message": "Field cannot be empty.",
    "lily-admin-contact-flow-timeout-input-error-message": "Must be a value between 1 - 600",
    "lily-admin-contact-flow-transfer-external-country-code": "Country code",
    "lily-admin-contact-flow-transfer-external-phone-number": "Phone number",
    "lily-admin-out-of-region-tts-summary": "Note: this may use a different Region than your Amazon Connect Instance.",
    "lily-admin-contact-flow-minutes": "minutes",
    "lily-admin-contact-flow-set-logging-behavior-header": "Set logging behavior",
    "lily-admin-contact-flow-set-logging-behavior-title": "When logging is enabled, data for each block in your contact flow is sent to Amazon CloudWatch Logs.",
    "lily-admin-contact-flow-set-logging-behavior-learn-more-about-logs": "Learn more about Contact Flow Logs",
    "lily-admin-contact-flow-set-logging-behavior-learn-more-how-to-enable-logs": "Learn how to enable Contact Flow Logs",
    "lily-admin-contact-flow-set-logging-behavior-reminder": "Contact Flow Logs are not enabled for this Amazon Connect instance.",
    "lily-admin-contact-flow-set-logging-behavior-option": "Logging behavior",
    "lily-admin-contact-flow-set-logging-behavior-option-enable": "Enable",
    "lily-admin-contact-flow-set-logging-behavior-option-disable": "Disable",
    "lily-admin-contact-flow-dial-block-modal-header": "Call phone number",
    "lily-admin-contact-flow-dial-block-description": "Initiates a call to a phone number for voice interactions. Specify a caller ID or the caller ID set for the queue is displayed.",
    "lily-admin-contact-flow-dial-block-note": "If you do not specify a caller ID number, the caller ID number for the queue is displayed.",
    "lily-admin-contact-flow-dial-block-learn-more": "Learn more",
    "lily-admin-contact-flow-dial-block-caller-id-label": "Caller ID number to display (optional)",
    "lily-admin-contact-flow-dial-block-phone-number-header": "Select a number from your instance",
    "lily-admin-contact-flow-dial-block-phone-number-label": "Number",
    "lily-admin-contact-flow-dial-block-custom-phone-number-header": "Custom phone number",
    "lily-admin-contact-flow-dial-block-custom-phone-number-format-error": "Phone numbers must use E.164 format.",
    "lily-admin-contact-flow-dial-block-custom-non-e164-phone-number-error": "Custom phone number can only contain the following characters: 0-9, and +(plus).",
    "lily-admin-contact-flow-use-attribute-label": "Use attribute",
    "lily-admin-contact-flow-start-media-streaming-additional-info": "Only customer audio is supported.",
    "lily-admin-contact-flow-start-media-streaming-header": "Start media streaming",
    "lily-admin-contact-flow-start-media-streaming-learn-more": "Learn more",
    "lily-admin-contact-flow-start-media-streaming-title": "Starts streaming audio to Kinesis.",
    "lily-admin-contact-flow-stop-media-streaming-header": "Stop media streaming",
    "lily-admin-contact-flow-stop-media-streaming-title": "Stops streaming audio to Kinesis.",
    "lily-admin-contact-flow-loop-header": "Loop",
    "lily-admin-contact-flow-loop-title": "Repeats the looping branch for the specified number of times. After which, the complete branch is followed.",
    "lily-admin-contact-flow-loop-detail": "If you enter 0 for the loop count, the Complete branch is followed the first time this block executes.",
    "lily-admin-contact-flow-loop-numbers": "Number of loops",
    "lily-admin-contact-flow-loop-count-range": "0-100",
    "lily-admin-contact-flow-wait-too-large-timeout": "Maximum of 7 days exceeded.",
    "lily-admin-contact-flow-wait-optional-branches": "Optional branches",
    "lily-admin-contact-flow-wait-optional-branch-customer-return": "Customer has returned",
    "lily-admin-contact-flow-wait-optional-branch-continue-execution": "Keep running while waiting",
    "lily-admin-contact-flow-timeout-number": "Number",
    "lily-admin-contact-flow-timeout-unit": "Unit of time",
    "lily-admin-contact-flow-yes": "Yes",
    "lily-admin-contact-flow-no": "No",
    "lily-admin-contact-flow-set-manually": "Set manually",
    "lily-admin-contact-flow-set-disconnect-flow-header": "Set disconnect flow",
    "lily-admin-contact-flow-set-disconnect-flow-title": "Specifies the contact flow to run when an agent disconnects the contact and the customer remains on the call.",
    "lily-admin-contact-flow-set-disconnect-flow-remaining-participants": "Remaining participants",
    "lily-admin-contact-flow-set-disconnect-flow-agent-only": "Agent only",
    "lily-admin-contact-flow-set-disconnect-flow-customer-only": "Customer only",
    "lily-admin-contact-flow-set-disconnect-flow-select-a-flow": "Select a flow",
    "lily-admin-contact-flow-start-media-streaming-to-customer": "To the customer",
    "lily-admin-contact-flow-start-media-streaming-from-customer": "From the customer",
    "lily-admin-contact-flow-start-media-streaming-audio-support-info": "Only audio is supported",
    "lily-admin-contact-flow-start-media-streaming-streams-to-start": "Start streaming:",
    "lily-admin-contact-flow-set-routing-proficiency-header": "Set routing proficiency",
    "lily-admin-contact-flow-set-routing-proficiency-title": "Temporarily route a contact within a queue to an agent with the appropriate location, expertise, or proficiency.",
    "lily-admin-contact-flow-set-routing-proficiency-section-title-hierarchy": "Route by agent hierarchy",
    "lily-admin-contact-flow-set-routing-proficiency-section-title-expiration-time": "Expiration Time",
    "lily-admin-contact-flow-set-routing-proficiency-maximum-time": "600 seconds maximum",
    "lily-admin-contact-flow-set-routing-proficiency-expiration-time-title": "Set an expiration time for the routing attribute.",
    "lily-admin-contact-flow-block-learn-more": "Learn more",
    "lily-admin-contact-flow-set-security-behavior-title-part-one": "Enables or disables voice-based security and sets a threshold for authentication.",
    "lily-admin-contact-flow-set-security-behavior-title-part-two": "This block is best placed at the beginning of a flow to start capturing a caller’s voice. It can be used again in the same flow to toggle voice authentication or modify the threshold for agents who turn it on.",
    "lily-admin-contact-flow-set-security-behavior-form-label": "Voice ID caller authentication",
    "lily-admin-contact-flow-set-security-behavior-enable-label": "Voice authentication",
    "lily-admin-contact-flow-set-security-behavior-enable-description": "Voice ID analyzes a caller’s voiceprint against historical ones to verify their identity, and returns a score of 1-100.",
    "lily-admin-contact-flow-set-security-behavior-enable-checkbox": "On",
    "lily-admin-contact-flow-set-security-behavior-disable-checkbox": "Off",
    "lily-admin-contact-flow-set-security-behavior-authentication-threshold-label": "Authentication threshold",
    "lily-admin-contact-flow-set-security-behavior-authentication-threshold-description": "Set a minimum score between 1-100 to verify a caller’s identity. The threshold set remains active for agents who turn voice authentication on. The Check security status block uses this score along with caller enrollment status to make a decision.",
    "lily-admin-contact-flow-set-security-behavior-authenticated-threshold": "Threshold",
    "lily-admin-contact-flow-check-security-status-header": "Check security status",
    "lily-admin-contact-flow-check-security-status-title-part-one": "Branches based on the",
    "lily-admin-contact-flow-check-security-status-title-part-two": "block.",
    "lily-admin-contact-flow-check-security-status-partials-title": "Glossary",
    "lily-admin-contact-flow-check-security-status-partials-authenticated-description": "A caller's identity has been verified.",
    "lily-admin-contact-flow-check-security-status-partials-not-authenticated-description": "The authentication score did not meet its set threshold.",
    "lily-admin-contact-flow-check-security-status-partials-inconclusive-description": "Unable to analyze a caller's voice for authentication.",
    "lily-admin-contact-flow-check-security-status-partials-not-enrolled-description": "A caller that has not yet been enrolled in voice authentication.",
    "lily-admin-contact-flow-check-security-status-partials-opted-out-description": "A caller has opted out of voice authentication.",
    "lily-admin-contact-flow-check-outbound-call-status-title": "Branches on AMD (Automatic Machine Detection) to determine the next steps for handling outbound calls.",
    "lily-admin-contact-flow-revert-to-published-message-2": "Your changes will not be saved if you revert to the last published flow.",
    "lily-admin-add-new-customer-hold-flow": "Create customer hold flow",
    "lily-admin-contact-flow-type": "Type",
    "lily-admin-save-as": "Save as",
    "lily-admin-contact-flow-customer-whisper": "Customer whisper",
    "lily-admin-contact-flow-new-name": "New name",
    "lily-admin-contact-flow-revert-to-saved-message-1": "Are you sure that you want to revert to the last saved flow?",
    "lily-admin-contact-flow-agent-transfer": "Transfer to agent",
    "lily-admin-add-new-customer-queue-flow": "Create customer queue flow",
    "lily-admin-contact-flow-not-published": "Saved",
    "lily-admin-contact-flow-save-message-1": "Are you sure you want to save this version of your flow?",
    "lily-admin-contact-flow-save-message-2": "Saving this flow will not republish it. In order to publish this flow, select 'Save & publish' from the Save dropdown menu.",
    "lily-admin-contact-flow-save-message-2-general": "Saving this flow will not publish it.",
    "lily-admin-contact-flow-save-publish-message-1": "Are you sure you want to publish this version of your flow?",
    "lily-admin-contact-flow-save-publish-message-2": "This action will effectively overwrite the last published flow.",
    "lily-admin-contact-flow-publish-message-1": "Are you sure you want to publish this contact flow?",
    "lily-admin-contact-flow-publish-message-2": "Publishing a contact flow makes it active. This may impact your live traffic.",
    "lily-admin-contact-flow-published": "Published",
    "lily-admin-contact-flow-status-header": "Status",
    "lily-admin-revert-save": "Revert to last saved",
    "lily-admin-add-new-queue-transfer-flow": "Create transfer to queue flow",
    "lily-admin-contact-flow-revert-to-published-message-3": "To save your changes, choose Cancel to return to the current view and then select Save.",
    "lily-admin-revert": "Revert",
    "lily-admin-name-required": "Name is required and must not be more than 127 characters.",
    "lily-admin-add-new-agent-hold-flow": "Create agent hold flow",
    "lily-admin-add-new-outbound-whisper-flow": "Create outbound whisper flow",
    "lily-admin-contact-flow-description": "Description",
    "lily-admin-contact-flow-search-by-name": "Search by name",
    "lily-admin-contact-flow-revert-to-published-message-1": "Are you sure that you want to revert to the last published flow?",
    "lily-admin-contact-flow-outbound-whisper": "Outbound whisper",
    "lily-admin-note": "Note:",
    "lily-admin-contact-flow-customer-queue": "Customer queue",
    "lily-admin-contact-flow-save-failure": "Failed to save contact flow",
    "lily-admin-contact-flow-agent-whisper": "Agent whisper",
    "lily-admin-contact-flow-snap-to-grid": "Snap to grid",
    "lily-admin-publish-save": "Save & publish",
    "lily-admin-contact-flow-publish": "Publish",
    "lily-admin-contact-flow-duplicate-failure": "Name already exists. Enter a unique name.",
    "lily-admin-contact-flow-description-placeholder": "Enter a description",
    "lily-admin-contact-flow-save-success": "Contact flow saved successfully!",
    "lily-admin-contact-flow-revert-to-saved-message-3": "Select Revert to return to the last saved contact flow.",
    "lily-admin-contact-flow-revert-to-saved-message-2": "This will revert to your last saved flow and will overwrite your changes.",
    "lily-admin-revert-published": "Revert to last published",
    "lily-admin-contact-flow-name": "Name",
    "lily-admin-contact-flow-contact-flow": "Contact flow",
    "lily-admin-add-new-contact-flow": "Create contact flow",
    "lily-admin-add-new-customer-whisper-flow": "Create customer whisper flow",
    "lily-admin-contact-flow-quota-failure": "You have reached the limit of Contact Flows.",
    "lily-admin-contact-flow-customer-hold": "Customer hold",
    "lily-admin-contact-flow-name-placeholder": "Enter a name",
    "lily-admin-contact-flow-queue-transfer": "Transfer to queue",
    "lily-admin-contact-flow-agent-hold": "Agent hold",
    "lily-admin-add-new-agent-whisper-flow": "Create agent whisper flow",
    "lily-admin-add-new-agent-transfer-flow": "Create transfer to agent flow",
    "lily-admin-export": "Export",
    "lily-admin-export-flow": "Export flow (beta)",
    "lily-admin-export-message": "When you export a flow, the most recently saved version is exported. Any unsaved changes to the flow will not be exported. If you modify the exported file it may not import correctly.",
    "lily-admin-cf-import-export-link": "Learn more about Contact Flow Import/Export.",
    "lily-admin-republish-flow": "For best results, please re-save or publish your flow before exporting.",
    "lily-admin-export-file-name": "Name your exported file",
    "lily-admin-json-extension": "json",
    "lily-admin-save-header": "Save flow",
    "lily-admin-import": "Import",
    "lily-admin-import-flow": "Import flow (beta)",
    "lily-admin-import-message": "Select the contact flow file you want to import. You can only import a flow of the same type as the flow you have open. The file must be a valid JSON document.",
    "lily-admin-import-select-file": "Select a contact flow.",
    "lily-admin-contact-flow-export-failure": "Failed to export contact flow.",
    "lily-admin-contact-flow-import-failure": "Failed to import contact flow.",
    "lily-admin-contact-flow-paste-failure-header": "Failed to paste contact flow.",
    "lily-admin-contact-flow-paste-failure": "The contact flow blocks you are pasting cannot be rendered.",
    "lily-admin-contact-flow-incorrect-flow-type-failure": "Failed to import the contact flow because it is not the same type of flow as the one it is being imported into. Create or edit a flow of the same type to import it.",
    "lily-admin-contact-flow-invalid-import-json-failure": "The imported file cannot be read.",
    "lily-admin-contact-flow-file-too-large-failure": "The number of blocks or resources in the flow exceeds the maximum allowed, or the file exceeds 1MB.",
    "lily-admin-contact-flow-show-additional-info": "Show additional flow information",
    "lily-admin-contact-flow-hide-additional-info": "Hide additional flow information",
    "lily-admin-flow-module-show-additional-info": "Show additional module information",
    "lily-admin-flow-module-hide-additional-info": "Hide additional module information",
    "lily-admin-contact-flow-learn-more": "Learn more",
    "lily-admin-contact-flow-arn-field-title": "ARN",
    "lily-admin-http-error": "Error ${code}!",
    "lily-admin-unauthorized-error": "You do not have access to that resource.",
    "lily-admin-exception-id-message": "The ID of this error is ${exceptionId}. Please provide this ID if you report this error.",
    "lily-admin-resource-not-found-error": "That resource was not found.",
    "lily-admin-resource-not-found-error-title": "Resource not found",
    "lily-admin-session-expired-error-title": "Session expired",
    "lily-admin-session-expired-error-message": "Your session has expired. Please log in again to continue.",
    "lily-admin-access-denied-error-title": "Access denied",
    "lily-admin-access-denied-error-message": "You do not have permission to access this page.",
    "lily-admin-user-not-onboarded-error-message": "Your user account has not been added to Amazon Connect. Please ask your admin to add you, and then try again.",
    "lily-admin-login-error-title": "Login error",
    "lily-admin-cross-region-federation-error": "An error occurred logging in to the instance. This can happen when you delete an instance and then create an instance with the same alias in a different AWS Region, and then attempt to log in before the deleted instance is completely removed from Amazon Connect. Please wait at least 15 minutes and try to log in again.",
    "lily-admin-throttle-exception-id-message": "If the problem persists, please contact customer support to report the error and provide error ID ${exceptionId} for reference.",
    "lily-admin-gis-exception-id-message": "If the problem persists, please contact customer support to report the error and provide error ID ${exceptionId} for reference.",
    "lily-admin-access-denied-error-message-alt": "You don't have permissions to do this action. For further help, contact your administrator.",
    "lily-admin-old-domain-access-denied-error-message": "The URL for your instance has changed. Please contact your administrator.",
    "lily-admin-rows-per-page": "Rows per page:",
    "lily-admin-click-to-try-again": "Try again",
    "lily-admin-agent-security-profile-search-error": "We're having difficulty loading data. Use the login name, routing profile, and agent group filters to narrow your search before applying security profile filters.",
    "lily-admin-ajax-error": "An error occurred, we'll try again in a bit.",
    "lily-admin-ajax-consistent-error": "We're having difficulty loading data.",
    "lily-admin-search-page-size": "View ${pageSize} results at a time",
    "lily-admin-unsupported-browser-warning-line-2": "See the list of",
    "lily-admin-supported-browser-document-link": "supported browsers.",
    "lily-admin-product-name": "Amazon Connect",
    "lily-admin-title": "Amazon Connect",
    "lily-admin-unsupported-browser-warning-line-1": "The browser you are using is currently not supported by Amazon Connect. Some functionality may not work.",
    "lily-admin-unsupported-browser-warning-header": "Your browser is not supported",
    "lily-admin-publish": "Publish",
    "lily-admin-name": "Name",
    "lily-admin-description": "Description",
    "lily-admin-save": "Save",
    "lily-admin-create": "Create",
    "lily-admin-cancel": "Cancel",
    "lily-admin-delete": "Remove",
    "lily-admin-delete-button": "Delete",
    "lily-admin-edit": "Edit",
    "lily-admin-yes": "Yes",
    "lily-admin-no": "No",
    "lily-admin-search-by-name": "Filter by name",
    "lily-admin-general-error": "An error occurred, and has been logged.",
    "lily-admin-search-page-of": "of",
    "lily-admin-search-no-results": "No results were found",
    "lily-admin-home-welcome": "Welcome to Amazon Connect",
    "lily-admin-historical-changes": "View historical changes",
    "lily-admin-month-january": "January",
    "lily-admin-month-february": "February",
    "lily-admin-month-march": "March",
    "lily-admin-month-april": "April",
    "lily-admin-month-may": "May",
    "lily-admin-month-june": "June",
    "lily-admin-month-july": "July",
    "lily-admin-month-august": "August",
    "lily-admin-month-september": "September",
    "lily-admin-month-october": "October",
    "lily-admin-month-november": "November",
    "lily-admin-month-december": "December",
    "lily-admin-log-out-title": "Log out",
    "lily-admin-done": "Done",
    "lily-admin-select": "Select",
    "lily-admin-copy-to-clipboard": "Copy to clipboard",
    "lily-admin-copy-to-clipboard-copied": "Copied",
    "lily-admin-no-matches": "No more matches",
    "lily-admin-feature-come-soon-warning": "Coming soon",
    "lily-admin-throttle-error": "An error occurred while processing your request. Please try again in a few minutes.",
    "lily-admin-gis-error": "An error occurred while processing your request. Please make sure you are authenticated.",
    "lily-admin-learn-more": "Learn more",
    "lily-admin-next-page-aria": "Next Page",
    "lily-admin-previous-page-aria": "Previous Page",
    "lily-admin-back": "Back",
    "lily-admin-permission-publish": "Publish",
    "lily-admin-audit-contact-flow-type": "Type",
    "lily-admin-phone-number-number": "Phone number",
    "lily-admin-page-type-title-contact-flow-editor": "Contact flows",
    "lily-admin-page-type-header-contact-flow-editor": "Contact flows",
    "lily-admin-page-type-title-contact-flow-editor-view": "View contact flow",
    "lily-admin-page-type-header-contact-flow-editor-view": "View contact flow",
    "lily-admin-page-type-title-contact-flow-editor-edit": "Edit contact flow",
    "lily-admin-page-type-header-contact-flow-editor-edit": "Edit contact flow",
    "lily-admin-page-type-title-contact-flow-editor-edit-customer-hold": "Edit customer hold flow",
    "lily-admin-page-type-header-contact-flow-editor-edit-customer-hold": "Edit customer hold flow",
    "lily-admin-page-type-title-contact-flow-editor-edit-customer-queue": "Edit customer queue flow",
    "lily-admin-page-type-header-contact-flow-editor-edit-customer-queue": "Edit customer queue flow",
    "lily-admin-page-type-title-contact-flow-editor-edit-agent-hold": "Edit agent hold flow",
    "lily-admin-page-type-header-contact-flow-editor-edit-agent-hold": "Edit agent hold flow",
    "lily-admin-page-type-title-contact-flow-editor-edit-customer-whisper": "Edit customer whisper flow",
    "lily-admin-page-type-header-contact-flow-editor-edit-customer-whisper": "Edit customer whisper flow",
    "lily-admin-page-type-title-contact-flow-editor-edit-agent-whisper": "Edit agent whisper flow",
    "lily-admin-page-type-header-contact-flow-editor-edit-agent-whisper": "Edit agent whisper flow",
    "lily-admin-page-type-title-contact-flow-editor-edit-outbound-whisper": "Edit outbound whisper flow",
    "lily-admin-page-type-header-contact-flow-editor-edit-outbound-whisper": "Edit outbound whisper flow",
    "lily-admin-page-type-title-contact-flow-editor-edit-transfer-to-agent": "Edit transfer to agent flow",
    "lily-admin-page-type-header-contact-flow-editor-edit-transfer-to-agent": "Edit transfer to agent flow",
    "lily-admin-page-type-title-contact-flow-editor-edit-transfer-to-queue": "Edit transfer to queue flow",
    "lily-admin-page-type-header-contact-flow-editor-edit-transfer-to-queue": "Edit transfer to queue flow",
    "lily-admin-page-type-title-contact-flow-editor-create": "Create contact flow",
    "lily-admin-page-type-header-contact-flow-editor-create": "Create contact flow",
    "lily-admin-page-type-title-contact-flow-editor-create-customer-hold": "Create customer hold flow",
    "lily-admin-page-type-header-contact-flow-editor-create-customer-hold": "Create customer hold flow",
    "lily-admin-page-type-title-contact-flow-editor-create-customer-queue": "Create customer queue flow",
    "lily-admin-page-type-header-contact-flow-editor-create-customer-queue": "Create customer queue flow",
    "lily-admin-page-type-title-contact-flow-editor-create-agent-hold": "Create agent hold flow",
    "lily-admin-page-type-header-contact-flow-editor-create-agent-hold": "Create agent hold flow",
    "lily-admin-page-type-title-contact-flow-editor-create-customer-whisper": "Create customer whisper flow",
    "lily-admin-page-type-header-contact-flow-editor-create-customer-whisper": "Create customer whisper flow",
    "lily-admin-page-type-title-contact-flow-editor-create-agent-whisper": "Create agent whisper flow",
    "lily-admin-page-type-header-contact-flow-editor-create-agent-whisper": "Create agent whisper flow",
    "lily-admin-page-type-title-contact-flow-editor-create-outbound-whisper": "Create outbound whisper flow",
    "lily-admin-page-type-header-contact-flow-editor-create-outbound-whisper": "Create outbound whisper flow",
    "lily-admin-page-type-title-contact-flow-editor-create-transfer-to-agent": "Create transfer to agent flow",
    "lily-admin-page-type-header-contact-flow-editor-create-transfer-to-agent": "Create transfer to agent flow",
    "lily-admin-page-type-title-contact-flow-editor-create-transfer-to-queue": "Create transfer to queue flow",
    "lily-admin-page-type-header-contact-flow-editor-create-transfer-to-queue": "Create transfer to queue flow",
    "lily-admin-page-group-title-contactFlows": "Contact flows"
}
));
